<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>WriteProcessMemory - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14487" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14487">WriteProcessMemory</a></p>
   <div class="post" id="post-112066">
    <div class="subject"><a href="#post-112066">WriteProcessMemory</a></div>
    <div class="body">I am trying to write a string that i have in one app to a buffer in another app. The other app is mines so i know the buffer name which is b_String_1.  It don't seem to work. I can do MapView but i want try Read and WriteProcessMemory. <br /><br />Here it say &quot;address to start writing to&quot; .  Don't that mean My Buffer that has the string i want to send.<br /><br />And the other line say &quot;address of buffer to write data to&quot; <br /><br />THIS IS VERY CONFUSSING ... if it what i thought it mean than where is or why not the words &quot;The Receiving Buffer&quot; <br /><br />If my code is correct than my next qestion is how do i define the buffer in App1 to match the one in App2 the receiver.  I can't say b_String_1 db 40 dup(?) ... or can i.<br /><br />Do i have to write it like this just like a button or something<br /> <br />b_String_1 equ 100<br /><br />If it is my own app do i still have to call OpenProcess, ReadProcessMemory.  I don't think so but i could be wrong.<br /><br />Thanks in advance<br /><br /><br />;BOOL WriteProcessMemory(<br /><br />;    HANDLE  hProcess,	// handle of process whose memory is written to  <br />;    LPVOID  lpBaseAddress,	// address to start writing to <br />;    LPVOID  lpBuffer,	// address of buffer to write data to<br />;    DWORD  cbWrite,	// number of bytes to write<br />;    LPDWORD  lpNumberOfBytesWritten 	// actual number of bytes written <br /><br /><br />;BOOL WriteProcessMemory(<br /><br />;    HANDLE  App_Two_hand,	// handle of process whose memory is written to  <br />;    LPVOID  send_String_1,	// address to start writing to <br />;    LPVOID  b_String_1,	// address of buffer to write data to<br />;    DWORD  40,	// number of bytes to write<br />;    LPDWORD  40 	// actual number of bytes written <br /><br /><br /><br />&quot;actual number of bytes written&quot;  Suppose I you always know<br /><br />;;;;;;;;;;;;;;;;;;;;;;;;;  This is what i tried with changes<br />PUSH 40<br />PUSH 40<br />PUSH offset b_String_1<br />PUSH offset send_String_1<br />PUSH App_Two_hand<br />CALL WriteProcessMemory<br />;;;;;;;;;;;;;;;;;;;;;;;;</div>
    <div class="meta">Posted on 2003-07-27 15:52:00 by cmax</div>
   </div>
   <div class="post" id="post-112077">
    <div class="subject"><a href="#post-112077">WriteProcessMemory</a></div>
    <div class="body">lpNumberOfBytesWritten <br /> Pointer to a variable that receives the number of bytes transferred into the specified process. This parameter is optional. If lpNumberOfBytesWritten is NULL, the parameter is ignored. <br /><br />So lets say you created process and want to write something to that one.<br /><pre><code><br />.data<br />fname db &quot;test.exe&quot;,0<br />mydata db 90,90 ;buffer which will be written o process<br />myaddress EQU 12345 ;address of process<br />prinfo PROCESS_INFORMATION &lt;&gt;<br />stinfo STARTUPINFO &lt;&gt;<br />numofbwrited dd 0 ;this will be filled after WPM call by the number of bytes written.<br />.code<br /><br /> invoke     CreateProcess, 0,  addr fname, 0, 0, 0,\ ;create the process suspended<br />                              CREATE_SUSPENDED, 0, 0,\            <br />                              addr stinfo, addr prinfo<br /><br />invoke WriteProcessMemory,prinfo.hProcess,myaddress,addr mydata,sizeof mydata,addr numofbwrited ;write it<br /></code></pre><br />Hope it helps</div>
    <div class="meta">Posted on 2003-07-27 16:37:58 by LaptoniC</div>
   </div>
   <div class="post" id="post-112093">
    <div class="subject"><a href="#post-112093">WriteProcessMemory</a></div>
    <div class="body">Thanks  LaptoniC, <br /> <br />I tried some of this in my app but i could not see th light.  Here is a better idea of what i am trying to do.  I tried to change things according to your example but i got all twisted up mentally.<br /><br />Receiver_Buffer: I put DD value in app1 cause i don't know what to do.  The real Receiveing buffer is a  db buffer in app2<br /><br />This is where i want to set the string (not in hex) just a plain string and i need to do it quite often.<br /><br />It's not a one shot deal. I need to use the same buffer from time to time sending difference strings for app2 to operate on.<br /><br />I don't know where the Receiver_Buffer decaration goes in either app.<br /><br />Both apps are my and are running without createprocess.  I just don't know how to declare stuff for in each app<br /><br />.data &amp; const with same word (Receiver_Buffer) give error but how is app1 to know where app2 buffer is without a equ.<br /><br /><br /><br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; MyApp1.exe<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; MyApp1.exe<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; MyApp1.exe<br />.const<br /> Receiver_Buffer   EQU 12345<br /><br />.data<br /> b_String_1         db &quot;This String has 39 letters&quot;,0<br /><br />.data?<br />numofbwrited DWORD ?<br />Receiver_Buffer DWORD ?    ............   but where about app2 reciver<br />My_App_2_handle DWORD ?<br /><br /><br />.code<br /><br />PUSH offset numofbwrited<br />PUSH SIZEOF b_String_1      ; sizeof mydata  mydata db 90,90.. Sending<br />PUSH offset Receiver_Buffer ; myaddress EQU 12345 ;Somethings wrong<br />PUSH i_don't_ have_a_clue   ; myaddress... where is app2 address ?<br />PUSH My_App_2_handle<br />CALL WriteProcessMemory<br /><br /><br /><br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; MyApp2.exe<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; MyApp2.exe<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; MyApp2.exe<br /><br />.const<br /><br />.data<br /><br />.data?<br /><br />Receiver_Buffer	db 40 dup(?)<br /><br />.code</div>
    <div class="meta">Posted on 2003-07-27 19:33:00 by cmax</div>
   </div>
  </div>
 </body>
</html>