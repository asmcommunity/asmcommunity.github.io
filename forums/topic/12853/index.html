<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>.xls and masm - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12853" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12853">.xls and masm</a></p>
   <div class="post" id="post-99705">
    <div class="subject"><a href="#post-99705">.xls and masm</a></div>
    <div class="body">hi is there any way to convert a Excel 2000 file to a .csv (; separator file) fully with pure asm win32<br />i need to compute datas from xls files and right for now have done the job for the .csv ones (converted by ecxel) so if i can convert thies .xls into .csv my prog will be faster than manualy convert files into the good format for my prog<br /><br />thanks for helping<br /><br />Win32 asm is just too much cool !</div>
    <div class="meta">Posted on 2003-04-27 15:41:02 by Thor0Asgard</div>
   </div>
   <div class="post" id="post-99712">
    <div class="subject"><a href="#post-99712">.xls and masm</a></div>
    <div class="body">Weeh, nice avatar... good old link :)<br /><br />I'd say forget parsing the .xls files manually. Afaik, there's no conclusive documentation on them (except perhaps in subscriber-only MSDN (that's the FULL deal, not just PlatformSDK or the MSDN CDs you get with visual studio)) - besides, it will be a lot of work.<br /><br />Your best bet is probably to make excel do the work for you. Either by manually sending windows messages (ick :P), or by some OLE Automation (which I never worked with).</div>
    <div class="meta">Posted on 2003-04-27 15:54:34 by f0dder</div>
   </div>
   <div class="post" id="post-99717">
    <div class="subject"><a href="#post-99717">.xls and masm</a></div>
    <div class="body">I dont know what the .csv file is... but if Excel can convert it, it very likely you can also automate Excel to do the same thing.<br /><br />I have sucessfully automated both Excel and AutoCad together under one MASM application.  I can help you design your own if you like, but i would take your questions to the COM section, cause there is alot of COM work to do this.   Dont fret too much to, Japheth's COMView tool will save you 80% of the hardwork ;)<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-04-27 16:07:54 by NaN</div>
   </div>
   <div class="post" id="post-99719">
    <div class="subject"><a href="#post-99719">.xls and masm</a></div>
    <div class="body">NaN, .csv's are those comma separated files (Comma Separated Values?).<br />Pretty easy to parse text format :-)</div>
    <div class="meta">Posted on 2003-04-27 16:15:28 by f0dder</div>
   </div>
   <div class="post" id="post-99727">
    <div class="subject"><a href="#post-99727">.xls and masm</a></div>
    <div class="body">Useful infos here : <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=11894&amp;highlight=BIFF">http://www.asmcommunity.net/board/index.php?topic=11894&amp;highlight=BIFF</a><br /><br />NaN's example is very nice and works flawlessly...<br /><br />May the Triforce be with you. ;)</div>
    <div class="meta">Posted on 2003-04-27 17:21:11 by JCP</div>
   </div>
   <div class="post" id="post-99819">
    <div class="subject"><a href="#post-99819">I seem to remember ...</a></div>
    <div class="body">That there is a ODBC data link to Excel.  And with the help of the ODBC MASM programming on this board, You should be able to skip the csv step altegether.<br /><br />Regards,  P1<br /><br />PS:  You do need to have your own copy of Excel on your system to do this.</div>
    <div class="meta">Posted on 2003-04-28 09:15:52 by Pone</div>
   </div>
   <div class="post" id="post-100278">
    <div class="subject"><a href="#post-100278">.xls and masm</a></div>
    <div class="body">Thor0Asgard,<br /><br />If you really intend to work directly with any MS Office file format be prepare to spend at least couple of month to collect and arrange existent information. I mean there is &quot;official&quot; documentation, but it cover no more than 25% and have many incorrectness (I know what I'm talking about :))<br />You have 3 choice:<br />1. Dig inside binary format (I suggest you download filter sources from OpenOffice.org) - spend at least 3-4 month<br />2. Try to use Microsoft's converters available in \Common Files\Microsoft Shared\TEXTCONV\ - about couple of hours<br />3. Try suggestions above - couple of hours too<br /><br />Choice is yours :)</div>
    <div class="meta">Posted on 2003-04-30 03:50:31 by masquer</div>
   </div>
   <div class="post" id="post-100396">
    <div class="subject"><a href="#post-100396">.xls and masm</a></div>
    <div class="body">Actually Excel fully support DDE, that might be the best way to transfer data to and from Excel and your program. It allows you to use the functionality of Excel within your asm program. Never really implemented it before but it would be cool to see it though.</div>
    <div class="meta">Posted on 2003-04-30 17:13:03 by donkey</div>
   </div>
   <div class="post" id="post-100399">
    <div class="subject"><a href="#post-100399">.xls and masm</a></div>
    <div class="body">IMHO, masquer is being a bit extreme in his budget... it took me roughly a week to hack out and understand the XLS file format with BIFF8.<br /><br />Im not saying it was easy.  Its not, its actually kinda complicated, but if i had to, i could start writing my own file generator tomorrow...  (I posted all my sources in the link Readiosys has shown).<br /><br />I dont think this is the way to go, but i dont think the above estimate was entirely accurate as well.<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-04-30 18:15:44 by NaN</div>
   </div>
   <div class="post" id="post-100459">
    <div class="subject"><a href="#post-100459">.xls and masm</a></div>
    <div class="body">NaN, how much of the xls file format is that though? And which version?</div>
    <div class="meta">Posted on 2003-05-01 02:15:43 by f0dder</div>
   </div>
   <div class="post" id="post-100481">
    <div class="subject"><a href="#post-100481">.xls and masm</a></div>
    <div class="body">NaN,<br /><br />maybe I'm exaggerate a little bit, but I do it with purpose. From Thor0Asgard's post it is not clear about complexity of his task. If xls file to process is simple enough or in some earlier version (f0dder is right - less version less complex) it could be done within couple of weeks.<br />Simple enough I mean no formatting, no merging, no formulas and many others no.<br />Actually I'm currently working with one of the office format, not xls but roots are the same :)</div>
    <div class="meta">Posted on 2003-05-01 03:28:12 by masquer</div>
   </div>
   <div class="post" id="post-100627">
    <div class="subject"><a href="#post-100627">.xls and masm</a></div>
    <div class="body"><div class="quote"><br />NaN, how much of the xls file format is that though? And which version? </div><br /><br />Excel BIFF8.  Which represents Excel97/2000 (etc).  To my knowledge there isnt any higher BIFF formats than 8.  (Could be wrong tho).<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-05-01 17:27:00 by NaN</div>
   </div>
   <div class="post" id="post-100704">
    <div class="subject"><a href="#post-100704">What i Want To Do With Biff</a></div>
    <div class="body">i have a simple .xls file with a unique Sheet<br />i need to export values from my sheets cells,compute them and then write back the<br />computed data into a new .xls file<br />i haven't had the time to watch NaN's sample but it seems to be very interresting and powerfull<br /><br />what i have understand is that .xls is BIFF 8 (for Office 97/2000)<br />and the BOF is 0809 (remember the byte order)<br />but when i hex view my .xls it is not the start of my file.....<br />NAN maybe you can adjust your code to do a .xls Converter<br />it will be usefull to Convert Data From/To .xls files<br /><br />anyway thanks all for your work and hope i'll can do something nearly aproaching what i had in mind (with your help i have 99% more chance to do it)</div>
    <div class="meta">Posted on 2003-05-02 03:52:17 by Thor0Asgard</div>
   </div>
   <div class="post" id="post-100715">
    <div class="subject"><a href="#post-100715">.xls and masm</a></div>
    <div class="body">Then you certainly have to look at DDE samples at this board. Try to search with DDE keyword. To read and moreover to write correct binary data almost imposible, except there's plenty of time...</div>
    <div class="meta">Posted on 2003-05-02 04:20:08 by masquer</div>
   </div>
   <div class="post" id="post-102574">
    <div class="subject"><a href="#post-102574">Excel File Format</a></div>
    <div class="body"><a target="_blank" href="http://www.wotsit.org">http://www.wotsit.org</a> is a great place for all your file format needs, including Excel's many formats.  As a programmer, this site will be a place you will go to frequently.<br /><br />Paul</div>
    <div class="meta">Posted on 2003-05-12 01:57:48 by PBrennick</div>
   </div>
   <div class="post" id="post-102578">
    <div class="subject"><a href="#post-102578">.xls and masm</a></div>
    <div class="body">pbrennick,<br /><br />Uhm, please, read my first post in this thread, it is about completeness of official documentation :grin: :grin: :grin:</div>
    <div class="meta">Posted on 2003-05-12 02:13:51 by masquer</div>
   </div>
   <div class="post" id="post-102675">
    <div class="subject"><a href="#post-102675">Re: What i Want To Do With Biff</a></div>
    <div class="body"><div class="quote"><br />i have a simple .xls file with a unique Sheet<br />i need to export values from my sheets cells,compute them and then write back the<br />computed data into a new .xls file<br />i haven't had the time to watch NaN's sample but it seems to be very interresting and powerfull<br /><br />what i have understand is that .xls is BIFF 8 (for Office 97/2000)<br />and the BOF is 0809 (remember the byte order)<br />but when i hex view my .xls it is not the start of my file.....<br />NAN maybe you can adjust your code to do a .xls Converter<br />it will be usefull to Convert Data From/To .xls files<br /><br />anyway thanks all for your work and hope i'll can do something nearly aproaching what i had in mind (with your help i have 99% more chance to do it) </div><br /><br />I dont know how i can impress upon you that to manually extract BIFF data is a very tall order to ask for.  Like you, when i came to this topic, i thought the same. I didnt want to waste time in learning more than i need, i simply wanted to modify raw data and replace it.  But BIFF8 is complicated, and not well documented.  It took me a couple weeks to figure it out (on paper) and just what i would need to code up to do anything with it..  Thats when i discovered VBA interfaces.  They allow me to skip all the BULL and allow excell to do all the low level dirty work.  I promise you the overhead is 2/3 less than raw BIFF8 coding (im assuming you never touched COM before).  I would be glad to answer questions if you do take the COM route with VBA interfaces.  Between Japheth's COMView tool, and my time spent piddling with Excel and AutoCad, im sure i can help you to what ever your aiming to do..  Alternately, i would need to brush up on my BIFF8 stuff (it *IS* complicated ~ many layers of abstraction in the file ~ even floats are encoded with a special compression).<br /><br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2003-05-12 18:35:18 by NaN</div>
   </div>
  </div>
 </body>
</html>