<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Environment Variables Auto-Parseing? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10055" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10055">Environment Variables Auto-Parseing?</a></p>
   <div class="post" id="post-75188">
    <div class="subject"><a href="#post-75188">Environment Variables Auto-Parseing?</a></div>
    <div class="body">Lately I have been programming with the windows registry. Alot of<br />the strings use system environment variables(%systemroot%/etc.)<br />Ofcourse I could maually parse these things. I was just curious if <br />there is something I can call(api) wich will automatically parse strings<br />wich use them? (&quot;%systemroot%\blah.exe&quot;)<br /><br />Any information appreciated as always! :alright:</div>
    <div class="meta">Posted on 2003-01-08 22:33:57 by natas</div>
   </div>
   <div class="post" id="post-75198">
    <div class="subject"><a href="#post-75198">Environment Variables Auto-Parseing?</a></div>
    <div class="body"><pre><code><br />DWORD ExpandEnvironmentStrings&#40;<br />  LPCTSTR lpSrc,<br />  LPTSTR lpDst,<br />  DWORD nSize<br />&#41;;<br /><br />Parameters<br />lpSrc <br />&#91;in&#93; Pointer to a null-terminated string that contains environment-variable strings of the form&#58; %variableName%. For each such reference, the %variableName% portion is replaced with the current value of that environment variable. <br />The replacement rules are the same as those used by the command interpreter. Case is ignored when looking up the environment-variable name. If the name is not found, the %variableName% portion is left undisturbed.<br /><br />lpDst <br />&#91;out&#93; Pointer to a buffer to receive a copy of the source buffer after all environment-variable name substitutions have been performed. <br />nSize <br />&#91;in&#93; Maximum number of TCHARs that can be stored in the buffer pointed to by the lpDst parameter. When using ANSI strings, the buffer size should be the string length, plus terminating null character, plus one. When using Unicode strings, the buffer size should be the string length plus the terminating null character. <br />Return Values<br />If the function succeeds, the return value is the number of TCHARs stored in the destination buffer, including the terminating null character. If the destination buffer is too small to hold the expanded string, the return value is the required buffer size, in TCHARs.<br /><br />If the function fails, the return value is zero. To get extended error information, call GetLastError.<br /></code></pre></div>
    <div class="meta">Posted on 2003-01-09 01:19:51 by gfalen</div>
   </div>
   <div class="post" id="post-75243">
    <div class="subject"><a href="#post-75243">Environment Variables Auto-Parseing?</a></div>
    <div class="body"><strong>Thanks!</strong> Excactly what I needed. :alright:</div>
    <div class="meta">Posted on 2003-01-09 06:52:32 by natas</div>
   </div>
  </div>
 </body>
</html>