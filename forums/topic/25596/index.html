<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Property Windows. Do your bit for charity! :D - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25596" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25596">Property Windows. Do your bit for charity! :D</a></p>
   <div class="post" id="post-186875">
    <div class="subject"><a href="#post-186875">Property Windows. Do your bit for charity! :D</a></div>
    <div class="body">Hi guys,<br /><br />Im currently writing a stock handling program for a company that deals with recycling computers for 3rd world countries.<br />However im having a bit of trouble with the property windows of my &#39;Add new stock&#39; wizard. <br />I cant seem to prevent a change to the next tab. (When required data is not entered for example.)<br /><br />~This is my notify code so far.... (Buillt from an example)<br /><br /><strong>	mov eax,uMsg<br />	.if eax==WM_NOTIFY<br />		mov edx,lParam<br />		mov eax,NMHDR.code<br />		.if eax==PSN_SETACTIVE ; page gaining focus<br />			m2m hPropSheet,NMHDR.hwndFrom<br />			__ PostMessage,hPropSheet,PSM_SETWIZBUTTONS,0,PSWIZB_FINISH or PSWIZB_BACK<br />			__ SetWindowLong,hWin,DWL_MSGRESULT,0<br />		.elseif eax==PSN_KILLACTIVE<br />			;page loosing focus<br />			__ SetWindowLong,hWin,DWL_MSGRESULT,0<br />		.elseif eax==PSN_WIZFINISH<br />			 <br />		.elseif eax==PSN_RESET<br />			;Add own cancel code here<br />		.endif<br /></strong><br /><br />Im missing a vital peice of information here i think. Please help. :)<br /></div>
    <div class="meta">Posted on 2006-12-05 19:14:19 by Nice Eddie</div>
   </div>
   <div class="post" id="post-186876">
    <div class="subject"><a href="#post-186876">Re: Property Windows. Do your bit for charity! :D</a></div>
    <div class="body">Doh!<br />Ive done it again!&nbsp; :lol:<br /><br />Answer is use <br /><br />			__ SetWindowLong,hWin,DWL_MSGRESULT,TRUE<br /><br />when conditions aren&#39;t met.<br />The Property sheet will ignore users button&nbsp; press and you can throw up a messagebox like this <br /><br />__ MessageBox,hWin,&quot;Please try again&quot;,&quot;Error stock number not entered correctly&quot;,MB_ICONERROR<br /><br />Thx anyways guys </div>
    <div class="meta">Posted on 2006-12-05 19:35:46 by Nice Eddie</div>
   </div>
   <div class="post" id="post-186881">
    <div class="subject"><a href="#post-186881">Re: Property Windows. Do your bit for charity! :D</a></div>
    <div class="body">Why not disable the &quot;next&quot; button until valid data is entered?<br /></div>
    <div class="meta">Posted on 2006-12-06 08:32:37 by f0dder</div>
   </div>
   <div class="post" id="post-186902">
    <div class="subject"><a href="#post-186902">Re: Property Windows. Do your bit for charity! :D</a></div>
    <div class="body">thanks fodder<br /><br />Im using your method now , its smarter.<br /><br />thanks</div>
    <div class="meta">Posted on 2006-12-09 13:00:44 by Nice Eddie</div>
   </div>
  </div>
 </body>
</html>