<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ICMP problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1168" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=1168">ICMP problem</a></p>
   <div class="post" id="post-7678">
    <div class="subject"><a href="#post-7678">ICMP problem</a></div>
    <div class="body">I've got some problem when I send the icmp packet and with my sniffer I know that packet was sent to the host (I know that this host is ON) but I don't receive any answer... but when I set paket's length to be a little big, I see (on sniffer) that mine PC is sending few ECHO_REPLYs to the host that i send ECHO_REPLY<br />here is a source of my sending proc<br /><pre><code><br />Mov 	sin_out.sin_family, AF_INET<br />Push 	IPAddr<br />Pop 	sin_out.sin_addr<br />Mov 	icmphdr_out.icmp_type, ICMP_ECHOREQ<br />Mov 	icmphdr_out.icmp_code, 0<br />Invoke 	htons, ID<br />Mov 	icmphdr_out.icmp_id, Ax<br />Invoke 	htons, SEQ<br />Mov 	icmphdr_out.icmp_seq, Ax<br />Mov 	icmphdr_out.icmp_cksum, 0<br />Invoke 	StrLen, ADDR ICMPSendBuff<br />Mov 	ICMPSendBuffLen, Eax<br />Invoke 	icmp_checksum, ADDR icmphdr_out, ADDR ICMPSendBuff, Eax<br />Mov 	icmphdr_out.icmp_cksum, Ax<br />Mov 	Eax, ICMPSendBuffLen<br />Add 	Eax, 9<br />Invoke 	sendto, hsocket, ADDR icmphdr_out, Eax,\<br />	0, ADDR sin_out, SIZEOF sin_out<br /><br /></code></pre><br />I don't know why it doesn't work... maybe I'm too stupid...<br />:stupid:<br /><br />Thanks...</div>
    <div class="meta">Posted on 2001-09-21 06:16:43 by NEMO</div>
   </div>
   <div class="post" id="post-8951">
    <div class="subject"><a href="#post-8951">C'mon guys!</a></div>
    <div class="body">C'mon Guys! Someone has to know the answer or just some info...<br />Maybe i have to post a source code of my prog or something...<br />And for any help that can point me how to send ping-&gt;ECHO_REQUEST properly i'll be VERY glad!<br /><br />Thanx, and pleas post something:alright:</div>
    <div class="meta">Posted on 2001-10-08 11:35:31 by NEMO</div>
   </div>
  </div>
 </body>
</html>