<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Hangup an existing internet connection - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10738" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=10738">Hangup an existing internet connection</a></p>
   <div class="post" id="post-80746">
    <div class="subject"><a href="#post-80746">Hangup an existing internet connection</a></div>
    <div class="body">Hi,<br /><br />After much searching, I am at a loss here. <br /><br />How do I hangup an internet connection that my program did not create. I don't know what the connection number is; so I can't put a value in dwconnection and call InternetHangUp. InternetAutoDialHangup does not work. So, what else is there out there?<br /><br />Send an AT command to the modem, somehow? Surely not?<br /><br /><br />:confused:</div>
    <div class="meta">Posted on 2003-02-09 17:52:15 by GreenScreenAlternator</div>
   </div>
   <div class="post" id="post-80838">
    <div class="subject"><a href="#post-80838">Hangup an existing internet connection</a></div>
    <div class="body">This snippet has worked well for over a year now.  It's part of a program that drops the dial-up and Internet browsers on a keyboard shortcut.  <br /><br />Enjoy your work,  P1<br /><br /><br />include \MASM32\INCLUDE\rasapi32.inc<br /><br />.data?<br />l_RASCONN RASCONN 0FFh dup ({})<br />l_Buffer_Size dd ?<br />l_Conn_Count  dd ?       <br /><br />Close_RAS:<br />        ;Find Active Connections.<br />        mov l_RASCONN.dwSize, sizeof RASCONN + 1<br />        mov l_Buffer_Size, sizeof l_RASCONN<br />        invoke RasEnumConnections, addr l_RASCONN, addr l_Buffer_Size, addr l_Conn_Count<br />        .if eax != 0<br />            jmp TheEnd       <br />        .endif<br />        invoke RasHangUp, l_RASCONN.hrasconn<br />        <br />TheEnd:</div>
    <div class="meta">Posted on 2003-02-10 08:49:02 by Pone</div>
   </div>
   <div class="post" id="post-80895">
    <div class="subject"><a href="#post-80895">Hangup an existing internet connection</a></div>
    <div class="body">Thank you Pone<br /><br />This is exactly what I have been searching for. <br /><br />I thought I must be missing something and that something is the RAS functions.<br /><br />So much to learn. So little time........</div>
    <div class="meta">Posted on 2003-02-10 13:37:49 by GreenScreenAlternator</div>
   </div>
  </div>
 </body>
</html>