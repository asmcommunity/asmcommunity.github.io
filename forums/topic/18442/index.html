<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Icon on MessageBox - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18442" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18442">Icon on MessageBox</a></p>
   <div class="post" id="post-142798">
    <div class="subject"><a href="#post-142798">Icon on MessageBox</a></div>
    <div class="body">I have this MessageBox, and I wan't my own icon on the titlebar.<br />I have done this several times before, but not with the MessageBox api.<br />The minimized icon and alt+tab icon works ok.<br /><br />What have I missed here :confused:</div>
    <div class="meta">Posted on 2004-06-03 13:22:49 by The SharK</div>
   </div>
   <div class="post" id="post-142799">
    <div class="subject"><a href="#post-142799">Icon on MessageBox</a></div>
    <div class="body"><pre><code><br />use MessageBoxIndirect, with <br />mov mbp.lpszIcon,eax ; loaded icon...<br />mov mbp.dwStyle, MB_OK or &#91;b&#93;MB_USERICON&#91;/b&#93;<br /></code></pre></div>
    <div class="meta">Posted on 2004-06-03 14:13:39 by Ultrano</div>
   </div>
   <div class="post" id="post-142802">
    <div class="subject"><a href="#post-142802">Icon on MessageBox</a></div>
    <div class="body">oh, that's why :) <br /><br /><br />Thanks Ultrano :alright:</div>
    <div class="meta">Posted on 2004-06-03 14:42:00 by The SharK</div>
   </div>
   <div class="post" id="post-142806">
    <div class="subject"><a href="#post-142806">Icon on MessageBox</a></div>
    <div class="body">Hi the Shark,<br /><br />The MessageBoxIndirect function just displays that in the icon-box not in the caption, I thought you wanted it in the caption ?</div>
    <div class="meta">Posted on 2004-06-03 15:06:54 by donkey</div>
   </div>
   <div class="post" id="post-142807">
    <div class="subject"><a href="#post-142807">Icon on MessageBox</a></div>
    <div class="body">you're right donkey,<br />I wanted the icon in the titlebar.....<br /><br />So what can I do about it then....:(</div>
    <div class="meta">Posted on 2004-06-03 15:11:10 by The SharK</div>
   </div>
   <div class="post" id="post-142809">
    <div class="subject"><a href="#post-142809">Icon on MessageBox</a></div>
    <div class="body">As far as I can tell you will have to make your own dialog and have it act like a message box, I could not find a way to do it with a standard message box.</div>
    <div class="meta">Posted on 2004-06-03 15:24:51 by donkey</div>
   </div>
   <div class="post" id="post-142811">
    <div class="subject"><a href="#post-142811">Icon on MessageBox</a></div>
    <div class="body">okay, so I'll just keep it as it is, thanks anyway :)</div>
    <div class="meta">Posted on 2004-06-03 15:44:10 by The SharK</div>
   </div>
   <div class="post" id="post-142816">
    <div class="subject"><a href="#post-142816">Icon on MessageBox</a></div>
    <div class="body">Hmm, I know of a way to do this with the standard MessageBox.<br /><br />Its a little unorthodox, but I dont think I will have that much trouble<br />drumming up a demo or code snip or something.  I dont have the<br />time right now (taking kids to the park), but gimme about three hours<br />and I will see if I can locate the base code...</div>
    <div class="meta">Posted on 2004-06-03 18:28:06 by Graebel</div>
   </div>
   <div class="post" id="post-142823">
    <div class="subject"><a href="#post-142823">Icon on MessageBox</a></div>
    <div class="body">Ok as promised, here ya go.  Full example :cool:<br />Just left click anywhere in the client area to get a new message box...<br /><br />For the most part it should be self explanitory, but if you have any questions<br />about it just let me know</div>
    <div class="meta">Posted on 2004-06-03 22:00:55 by Graebel</div>
   </div>
   <div class="post" id="post-142825">
    <div class="subject"><a href="#post-142825">Icon on MessageBox</a></div>
    <div class="body">Crud, just realized I was sending a file chop full of macros most people wouldnt<br />have.  Modified the file so everyone would be able to re-compile it... my bad</div>
    <div class="meta">Posted on 2004-06-03 22:32:19 by Graebel</div>
   </div>
   <div class="post" id="post-142855">
    <div class="subject"><a href="#post-142855">Icon on MessageBox</a></div>
    <div class="body">Hi  Graebel <br /> <br />Thanks for the example,<br />but you use CreateWindowEx.<br />As I mentioned I have done this several times before, using<br />other api's, but I was looking for a way to make use of<br />the MessageBox or the like api.<br /><br />But what the heck, it's no big deal.<br /><br /><br />Thanks anyway ;)</div>
    <div class="meta">Posted on 2004-06-04 10:27:13 by The SharK</div>
   </div>
   <div class="post" id="post-142860">
    <div class="subject"><a href="#post-142860">Icon on MessageBox</a></div>
    <div class="body">I just glanced at his code, but didn't he use createwindowex for the main window and MessageBox (or maybe it was MessageBoxEx) for the message box?  It looked like he did a cbt hook and changed the icon from the MessageBox that way.  Unless I'm crazy I don't see what the problem is.</div>
    <div class="meta">Posted on 2004-06-04 11:56:45 by Will</div>
   </div>
   <div class="post" id="post-142862">
    <div class="subject"><a href="#post-142862">Icon on MessageBox</a></div>
    <div class="body"><div class="quote">Unless I'm crazy I don't see what the problem is</div> <br /><br />Hi Will<br /><br />Seems I was to quick in judging the code.<br />You're right, it seems like you have got the<br />&quot;picture&quot; of his code - at least I guess.<br />My problem was/is, that I didn't/don't quite understand<br />everything in the Template example, so I guess<br />I have to study it a little closer :notsure:<br /><br />Sorry for that :( <br />And Will - You're NOT crazy :tongue: <br /><br /><br />Hi Graebel,<br /><br />Your skill in Win32Asm is beyond me, so I'M the apprentice here :alright:</div>
    <div class="meta">Posted on 2004-06-04 12:16:58 by The SharK</div>
   </div>
   <div class="post" id="post-142879">
    <div class="subject"><a href="#post-142879">Icon on MessageBox</a></div>
    <div class="body">basically that example isn't too complicated (although it may look it at first)....<br /><br />;)<br /><br /><pre><code><br />			invoke	SetWindowsHookEx, WH_CBT, ADDR CBTProc, hInstance, 0<br />			mov		hHook, eax<br />			invoke	MessageBox, hWnd, ADDR szDisplayName, ADDR szDisplayName, MB_OK<br /></code></pre> <br /><br />When left mouse button is pressed, this code gets called.  You just start a cbt hook and then call MessageBox function.  The cbt hook proc then loads the IDI_ASTERISK system icon, subclasses the messagebox, and sets the new icon with a WM_SETICON message.  Then the hook is unloaded.<br /><br /><br />hope that helps,<br />will</div>
    <div class="meta">Posted on 2004-06-04 18:25:27 by Will</div>
   </div>
   <div class="post" id="post-143149">
    <div class="subject"><a href="#post-143149">Icon on MessageBox</a></div>
    <div class="body">There's a lot easier way, you just need at least one window with the default class (any dialog box will do). All you have to do is change the small icon for the default class. (Of course this will affect all message boxes and most dialogs in your process). For a small app you might find it useful. :)</div>
    <div class="meta">Posted on 2004-06-07 17:38:43 by QvasiModo</div>
   </div>
   <div class="post" id="post-143151">
    <div class="subject"><a href="#post-143151">Icon on MessageBox</a></div>
    <div class="body">Hi  QvasiModo <br /> <br />you mean changing the small icon in the WNDCLASSEX: HICON hIconSm<br />with my own.<br /><br />So I have to Register the WNDCLASSEX first, then create a main window,<br />with the hIconSm changed, and then create the MessageBox ?</div>
    <div class="meta">Posted on 2004-06-07 17:49:36 by The SharK</div>
   </div>
   <div class="post" id="post-143311">
    <div class="subject"><a href="#post-143311">Icon on MessageBox</a></div>
    <div class="body">If you create your main window using a custom class, you'll not be affecting message boxes at all! I meant to change the default class :)<br /><br />Message boxes are supposed to be of the same class than dialog boxes. If your app has a dialog box as it's main window, just change the hIconSm using the SetClassLong API. This will also affect other dialogs in your app, like the &quot;open file&quot; dialog (GetOpenFileName).<br /><br />The trick won't work if the dialog box has a custom class, or if you use CreateWindowEx with your own class. If you must use CreateWindowEx, you have to use the default class. I don't remember it's name right now but it should be trivial to write a test program to find out.</div>
    <div class="meta">Posted on 2004-06-09 15:06:28 by QvasiModo</div>
   </div>
  </div>
 </body>
</html>