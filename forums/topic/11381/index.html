<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>second Window can't open - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=11381" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=11381">second Window can't open</a></p>
   <div class="post" id="post-86017">
    <div class="subject"><a href="#post-86017">second Window can't open</a></div>
    <div class="body"><pre><code><br /><br />.386 <br />.model flat,stdcall <br />option casemap&#58;none<br /><br />include windows.inc<br />include kernel32.inc<br />include user32.inc<br /><br />includelib kernel32.lib<br />includelib user32.lib<br /><br />.data<br />_title 	    db 'First Window',0<br />_class 	    db 'first',0<br />sectitle    db 'second Window',0<br />secclass    db 'sec',0<br />ButtonClass db 'button',0<br />ButtonText  db 'OPEN',0<br /><br /><br />.data?<br />msg MSG &lt;?&gt;<br />wc  WNDCLASS &lt;?&gt;<br /><br />hWnd       dd ?<br />hwndButton dd ?<br />hSecWnd    dd ?<br />hInstance HINSTANCE ?<br /><br />.const <br />ButtonID equ 401<br /><br />.code <br />start&#58;<br />	push 0<br />	call GetModuleHandle<br />	mov hInstance,eax<br />	<br />	mov wc.style,CS_HREDRAW or CS_VREDRAW<br />	mov wc.lpfnWndProc,offset WndProc<br />	mov wc.cbClsExtra,0<br />	mov wc.cbWndExtra,0<br />	mov eax,hInstance<br />	mov wc.hInstance,eax<br />	mov wc.hbrBackground,COLOR_WINDOW<br />	mov wc.lpszMenuName,0<br />	mov wc.lpszClassName,offset _class<br />	<br />	push IDI_WINLOGO<br />	push 0<br />	call LoadIcon<br />	mov wc.hIcon,eax<br />	<br />	push IDC_ARROW<br />	push 0<br />	call LoadCursor<br />	mov wc.hCursor,eax<br />	<br />	push offset wc<br />	call RegisterClass<br />	<br />	mov wc.lpszClassName,offset secclass<br />	mov wc.lpfnWndProc,offset SecWndProc<br />	push offset wc<br />	call RegisterClass<br />	<br />	push 0<br />	push hInstance<br />	push 0<br />	push 0<br />	push 200<br />	push 300<br />	push CW_USEDEFAULT<br />	push CW_USEDEFAULT<br />	push WS_OVERLAPPEDWINDOW<br />	push offset _title<br />	push offset _class<br />	push 0<br />	call CreateWindowEx<br />	mov hWnd,eax<br />	<br />	push 0<br />	push hInstance<br />	push 0<br />	push 0<br />	push CW_USEDEFAULT<br />	push CW_USEDEFAULT<br />	push CW_USEDEFAULT<br />	push CW_USEDEFAULT<br />	push offset sectitle<br />	push offset secclass<br />	push 0<br />	call CreateWindowEx<br />	mov hSecWnd,eax<br />	<br />	push SW_SHOW<br />	push hWnd<br />	call ShowWindow<br />	<br />	push SW_SHOW<br />	push hSecWnd<br />	call ShowWindow<br />	<br />	push hWnd<br />	call UpdateWindow<br />	<br />	push hSecWnd<br />	call UpdateWindow<br />	<br />msg_loop&#58;<br />	push 0<br />	push 0<br />	push 0<br />	push offset msg<br />	call GetMessage<br />	cmp ax,0<br />	jz msg_end<br />	<br />	push offset msg<br />	call TranslateMessage<br />	<br />	push offset msg<br />	call DispatchMessage<br />	<br />	jmp msg_loop<br /><br />msg_end&#58;<br />	push msg.wParam<br />	call ExitProcess<br />	<br />WndProc Proc uses ebx edi esi,hwnd&#58;DWORD ,umsg&#58;DWORD,wparam&#58;DWORD,lparam&#58;DWORD<br />	mov eax,umsg<br />	cmp eax,WM_DESTROY<br />	jz  wm_destroy<br />	cmp eax,WM_COMMAND<br />	jz  wm_command<br />	cmp eax,WM_CREATE<br />	jz  wm_create<br />	<br />	push lparam<br />	push wparam<br />	push umsg<br />	push hwnd<br />	call DefWindowProc<br />	ret<br />	<br />wm_create&#58;<br />	push 0<br />	push hInstance<br />	push ButtonID<br />	push hwnd<br />	push 25<br />	push 80<br />	push 70<br />	push 100<br />	push WS_CHILD or WS_VISIBLE or BS_DEFPUSHBUTTON<br />	push offset ButtonText<br />	push offset ButtonClass<br />	push 0<br />	call CreateWindowEx<br />	mov hwndButton,eax<br />	xor eax,eax<br />	ret	<br />	<br />wm_command&#58;<br />	mov eax,wparam<br />	cmp ax,ButtonID<br />	jz buttonid	<br />	<br />wm_destroy&#58;<br />	push 0<br />	call PostQuitMessage<br />	xor eax,eax<br />	ret	<br /><br />buttonid&#58;<br />	mov eax,wparam<br />	shr eax,16<br />	cmp ax,BN_CLICKED<br />	jz  bn_clicked<br /><br />bn_clicked&#58;<br />	push SW_SHOW<br />	push hSecWnd<br />	call ShowWindow<br />	<br />	push hSecWnd<br />	call UpdateWindow<br />	ret<br /><br />WndProc endp<br /><br />SecWndProc Proc uses ebx edi esi,secwnd&#58;DWORD,secmsg&#58;DWORD,secwparam&#58;DWORD,seclparam&#58;DWORD<br />	mov eax,secmsg<br />	cmp eax,WM_CLOSE<br />	jz wm_close<br />	<br />	push seclparam<br />	push secwparam<br />	push secmsg<br />	push secwnd<br />	call DefWindowProc<br />	ret<br />	<br />wm_close&#58;<br />	push SW_HIDE<br />	push hSecWnd<br />	call ShowWindow<br />	ret	<br />SecWndProc endp<br />end start<br /><br /></code></pre></div>
    <div class="meta">Posted on 2003-03-09 10:46:36 by sysnet</div>
   </div>
   <div class="post" id="post-86069">
    <div class="subject"><a href="#post-86069">Re: second Window can't open</a></div>
    <div class="body"><div class="quote"><em>Originally posted by sysnet </em><br /><pre><code><br />push 0<br />push hInstance<br />push 0<br />push 0<br />push CW_USEDEFAULT<br />push CW_USEDEFAULT<br />push CW_USEDEFAULT<br />push CW_USEDEFAULT<br />&#91;b&#93;&#91;color=red&#93;push WS_OVERLAPPEDWINDOW&#91;/color&#93;&#91;/b&#93; ;you're missing this one<br />push offset sectitle<br />push offset secclass<br />push 0<br />call CreateWindowEx<br />mov hSecWnd,eax<br /></code></pre></div><br /><br />i hope it's your intention that both windows appear when you start the app...</div>
    <div class="meta">Posted on 2003-03-09 13:53:14 by hartyl</div>
   </div>
   <div class="post" id="post-86165">
    <div class="subject"><a href="#post-86165">Thanks</a></div>
    <div class="body">Oh,Thanks! <br />Your homepage is very  beautiful !</div>
    <div class="meta">Posted on 2003-03-09 23:46:39 by sysnet</div>
   </div>
   <div class="post" id="post-86291">
    <div class="subject"><a href="#post-86291">second Window can't open</a></div>
    <div class="body">thanks<br />btw, why don't you use the <strong>invoke-syntax</strong>? it will notice if you forget a parameter or have one in wrong type:<br /><br /><pre><code><br />push 0<br />push hInstance<br />push 0<br />push 0<br />push CW_USEDEFAULT<br />push CW_USEDEFAULT<br />push CW_USEDEFAULT<br />push CW_USEDEFAULT<br />push WS_OVERLAPPEDWINDOW<br />push offset sectitle<br />push offset secclass<br />push 0<br />call CreateWindowEx<br /><br />becomes<br /><br />invoke CreateWindowEx, 0, offset secclass, offset sectitle, WS_OVERLAPPEDWINDOW, CW_USEDEFAULT,<br />                       CW_USEDEFAULT,CW_USEDEFAULT,CW_USEDEFAULT, 0, 0, hInstance, 0<br /></code></pre></div>
    <div class="meta">Posted on 2003-03-10 13:17:21 by hartyl</div>
   </div>
  </div>
 </body>
</html>