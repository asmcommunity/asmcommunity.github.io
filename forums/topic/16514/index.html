<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Parsing strings in a buffer ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16514" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16514">Parsing strings in a buffer ?</a></p>
   <div class="post" id="post-128403">
    <div class="subject"><a href="#post-128403">Parsing strings in a buffer ?</a></div>
    <div class="body">Morning,<br /><br />Maybe you'll find i'm too lazy :o but I was wondering if there's a better way (i mean API solution) than &quot;Repne scasb&quot; to parse a string.<br /><br />Here's what is doing my program:<br /><br />I'm currently writing a program that keeps information about some files. Because i don't want to &quot;pollute&quot; my registry, i'm doing it with an INI file. Here's my INI file:<br /><br /><pre><code><br /><br />&#91;SECTION1&#93;<br />NumberOfKey=3<br />KEY1=D&#58;\Program Files\Programmation\RadASM\Masm\Projects\Item\TODO.txt<br />KEY2=D&#58;\Program Files\Programmation\RadASM\Masm\Projects\Item\createinifile.asm<br />KEY3=D&#58;\Program Files\Programmation\RadASM\Masm\Projects\Item\writeinifile.asm<br /><br /></code></pre><br /><br />After Calling &quot;GetPrivateProfileSection&quot; my buffer looks like this:<br /><br /><pre><code><br /><br />0040370C  NOK=3.KEY1=D&#58;\Program Files\Programmation\RadASM\Masm\Projects\I<br />0040374C  tem\TODO.txt.KEY2=D&#58;\Program Files\Programmation\RadASM\Masm\Pro<br />0040378C  jects\Item\createinifile.asm.KEY3=D&#58;\Program Files\Programmation<br />004037CC  \RadASM\Masm\Projects\Item\writeinifile.asm.<br /><br /></code></pre><br /><br />Here's the point: I want to be rid of &quot;KEY1=&quot; and so on (KEY2= ; KEY3= ...), and just retrieve the file path. I'm able to do it with &quot;pure asm&quot; with &quot;Repne scasb&quot; and some other instructions, but is there another way to do it with APIs ?<br /><br />Thank you very much.<br /><br />Regards, Neitsa.</div>
    <div class="meta">Posted on 2003-12-19 07:25:17 by Neitsa</div>
   </div>
   <div class="post" id="post-128410">
    <div class="subject"><a href="#post-128410">Parsing strings in a buffer ?</a></div>
    <div class="body">The UCR Standard Library for 80x86 Assembly Language Programmers and the HLA Standard Library (<a target="_blank" href="http://webster.cs.ucr.edu">http://webster.cs.ucr.edu</a>) have several routines you could use for this purpose.  The str.tokenize2 (HLA) routine, for example, can break up you strings by using &quot;=&quot; as a string delimiter. HLA's pattern matching library would also provide facilities for parsing your strings.<br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-12-19 10:53:57 by rhyde</div>
   </div>
   <div class="post" id="post-128413">
    <div class="subject"><a href="#post-128413">Parsing strings in a buffer ?</a></div>
    <div class="body">Thank you very much Randall,<br /><br />I'll study it !<br /><br />The question was just a matter of &quot;knowledge&quot; because I've implemented some Asm instructions that done the job well.<br /><br />P.S: Randall, you've certainly heard it many times, but AOA is a great book !</div>
    <div class="meta">Posted on 2003-12-19 11:22:09 by Neitsa</div>
   </div>
   <div class="post" id="post-128519">
    <div class="subject"><a href="#post-128519">Parsing strings in a buffer ?</a></div>
    <div class="body">Hi. :)<br />If the key names are known (or can be easily calculated, like &quot;KEY1&quot;, &quot;KEY2&quot;, etc...) you could get them using GetPrivateProfileString. It saves you the trouble of having to work out by yourself how to parse the INI section, and it won't cost you anything in terms of performance since the INI file is surely going to be cached.</div>
    <div class="meta">Posted on 2003-12-20 16:10:00 by QvasiModo</div>
   </div>
  </div>
 </body>
</html>