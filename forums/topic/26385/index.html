<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Font Dialog Box - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26385" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26385">Font Dialog Box</a></p>
   <div class="post" id="post-191352">
    <div class="subject"><a href="#post-191352">Font Dialog Box</a></div>
    <div class="body">I have put a font dialog box in my test app. When the user selects
"Set Font...", a font dialog box pops up and allows the user to pick his choice.
The problem arise when the user picks his choice and wants to repaint the
client area using current font selection.
Here is what it should do:
=> when the user selects "Set Font..." a font dialog box should pop up.
------> i used API "ChooseFont" to create a font dialog box.
------> and used "CreateFontIndirect" to use the selected font as current font
------> i saved the current selection in "hFont"  and then called "SendMessageA" with "WM_SETFONT" to repaint the client area. ----> DOESN"T WORK! I guess it is not as simple as I thought it is.
=> NOW, how do i apply the selected font in the edit control?

Thanks in Advance!
e-nigma</div>
    <div class="meta">Posted on 2001-01-14 08:11:00 by e-nigma</div>
   </div>
   <div class="post" id="post-191353">
    <div class="subject"><a href="#post-191353">Font Dialog Box</a></div>
    <div class="body">I'm not quite sure if I understood you right but:

invoke SendMessage,hWndEdit,WM_SETFONT,hFont,0

should work tho...</div>
    <div class="meta">Posted on 2001-01-14 10:28:00 by JimmyClif</div>
   </div>
   <div class="post" id="post-191354">
    <div class="subject"><a href="#post-191354">Font Dialog Box</a></div>
    <div class="body">Here are a couple of things to check:

<li>Is CreateFontIndirect successful?
<li>Is the handle to the edit window correct?
 

edit: replaced with MB tags
<pre><code>
,,<li>  and  are also available</code></pre>

Hiro

This message was edited by Hiroshimator, on 2/7/2001 7:03:42 AM</div>
    <div class="meta">Posted on 2001-01-14 11:11:00 by Iczelion </div>
   </div>
   <div class="post" id="post-191355">
    <div class="subject"><a href="#post-191355">Font Dialog Box</a></div>
    <div class="body">Pointer to the LOGFONT was not properly defined. Now,
it is WORKING!

=>But there is another problem. When the app is restarted
the default font is the one provided by the system. But
I want to use previously selected font as the default
font everytime the app is started. Is there any specific
API to do this?

=>I'd like to add one more question.
Whenever I save a file, the last alphabet in the file
gets deleted. Suppose a file named "asm.txt" contains
the data "WIN32ASM Is Great". When I save and reopen it,
the data will be "WIN32ASM Is Grea". The
alphabet "t" is not saved. Why is that?

I've use WM_GETTEXTLENGTH to determine the length before
before writing it to the disk.

Thanks in Advance!
e-nigma</div>
    <div class="meta">Posted on 2001-01-14 23:56:00 by e-nigma </div>
   </div>
   <div class="post" id="post-191356">
    <div class="subject"><a href="#post-191356">Font Dialog Box</a></div>
    <div class="body">=>But there is another problem. When the app is restarted
the default font is the one provided by the system. But
I want to use previously selected font as the default
font everytime the app is started. Is there any specific
API to do this?

If I understand the problem correctly, it's like this:
1. User runs your app.
2. User sets the font for your app.
3. Your app uses user-selected font.
4. User exits your app.
5. User re-starts your app, but app has reverted to default font.

No API call will save "user preferences" between program instances.  Your best bet is to use the registry.  Create a key something like:
HKEY_CURRENT_USER\Software\e-nigma\YourApp\
then create the value named DefaultFont and set it's value-data to the name of the font the user selected.
At run-time, have your app check this value, and set font accordingly...
I suppose you could use a settings file instead of the registry (i.e. YourApp.INI), but then again we could all go back to using adding-machines instead of computers, too.</div>
    <div class="meta">Posted on 2001-02-07 06:45:00 by Q</div>
   </div>
   <div class="post" id="post-191357">
    <div class="subject"><a href="#post-191357">Font Dialog Box</a></div>
    <div class="body">Actually, we could really all go back to using the abbacus if we wanted, too.... :D


_Shawn</div>
    <div class="meta">Posted on 2001-02-07 10:47:00 by _Shawn</div>
   </div>
   <div class="post" id="post-191358">
    <div class="subject"><a href="#post-191358">Font Dialog Box</a></div>
    <div class="body">Well if I'm not wearing shoes I can count to twenty!

Mirno</div>
    <div class="meta">Posted on 2001-02-07 11:12:00 by Mirno</div>
   </div>
  </div>
 </body>
</html>