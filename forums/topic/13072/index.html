<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>exe from exe?????? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13072" />
    <link rel="next" href="../?id=13072&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=13072">exe from exe??????</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=13072&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=13072&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="13072" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=13072&amp;page=2">&gt;</a><a href="../?id=13072&amp;page=2">&raquo;</a></form>   <div class="post" id="post-101525">
    <div class="subject"><a href="#post-101525">exe from exe??????</a></div>
    <div class="body">Can any one tell me how can i make a program which uses commandline parameters to create another .exe file showing<br /><br />a message box who's text and caption are set in the commandline ??<br /><br />Thakyou for reading this.</div>
    <div class="meta">Posted on 2003-05-06 09:09:53 by telophase</div>
   </div>
   <div class="post" id="post-101534">
    <div class="subject"><a href="#post-101534">exe from exe??????</a></div>
    <div class="body">If you say only had one message box and a max length for the string, You could have a dummy PE and overwrite the data section with whatever value you wanted. For example in your dummy PE you have something like this....<br /><br />stringdata db 256 DUP (&quot; &quot;)<br /><br />invoke messagebox,NULL,stringdata,NULL,NULL<br /><br />when you want to change the text you have only to find the offset of stringdata in your dummy PE and write in what you want. The offset wouldn't change so you can hard-code it in your program.<br /><br />Just an idea, I've never tried it so I can't say 100% it'll work but it should. You may even be able to store the dummy PE as data in you resource section (RCDATA)<br /><br />EDIT : Duh !</div>
    <div class="meta">Posted on 2003-05-06 09:27:40 by donkey</div>
   </div>
   <div class="post" id="post-101537">
    <div class="subject"><a href="#post-101537">exe from exe??????</a></div>
    <div class="body">How much do you pay for working example code?</div>
    <div class="meta">Posted on 2003-05-06 09:34:02 by bazik</div>
   </div>
   <div class="post" id="post-101541">
    <div class="subject"><a href="#post-101541">exe from exe??????</a></div>
    <div class="body"><div class="quote"><br />How much do you pay for working example code? </div><br />Hi Bazik,<br /><br />My idea won't work ? Like I said I've never tried it and it's not something that I can ever see doing so I'm not too concerned. I'd be interested to know why not though, seems pretty logical and I can  do it with a hex editor so doing it within an exe should be the same.</div>
    <div class="meta">Posted on 2003-05-06 09:46:39 by donkey</div>
   </div>
   <div class="post" id="post-101543">
    <div class="subject"><a href="#post-101543">exe from exe??????</a></div>
    <div class="body"><div class="quote"><br /><br />Hi Bazik,<br /><br />My idea won't work ? Like I said I've never tried it and it's not something that I can ever see doing so I'm not too concerned. I'd be interested to know why not though, seems pretty logical and I can  do it with a hex editor so doing it within an exe should be the same. </div><br /><br />I ment telophase not you ;)</div>
    <div class="meta">Posted on 2003-05-06 09:49:10 by bazik</div>
   </div>
   <div class="post" id="post-101609">
    <div class="subject"><a href="#post-101609">exe from exe??????</a></div>
    <div class="body">Awhile back I posted a gui version example of this exact type of program.   It's <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=6617&amp;perpage=15&amp;pagenumber=2">here</a> .<br /><br />I'll leave it up to you to add the command line handling.<br /><br /><br /><br />cheers,<br />will</div>
    <div class="meta">Posted on 2003-05-06 13:45:18 by Will</div>
   </div>
   <div class="post" id="post-101734">
    <div class="subject"><a href="#post-101734">thankx....</a></div>
    <div class="body">Thankyou will and donkey for your help...</div>
    <div class="meta">Posted on 2003-05-07 01:35:28 by telophase</div>
   </div>
   <div class="post" id="post-101738">
    <div class="subject"><a href="#post-101738">exe from exe??????</a></div>
    <div class="body">will,<br /><br />your gui program has helped me a lot but i didn't get the offset part:-<br /><br />-=-=-=-=-=-=-=-=-=-=-=-=-=-=-<br /><br />invoke SendMessage,hEdit1,WM_GETTEXT,63,addr ExeTemplate+0840h<br />invoke SendMessage,hEdit2,WM_GETTEXT,63,addr ExeTemplate+0800h<br /><br />-=-=-=-=-=-=-=-=-=-=-=-=-=-=-<br /><br />how did u actually get the offset's where you wanted to place the messagebox data??:confused:</div>
    <div class="meta">Posted on 2003-05-07 02:29:42 by telophase</div>
   </div>
   <div class="post" id="post-101799">
    <div class="subject"><a href="#post-101799">exe from exe??????</a></div>
    <div class="body">Iirc, I answered that question in that post.<br /><br />I'm pretty sure that what I did was make a couple of calls to SetWindowText that don't get executed with the offsets to those variables.  Then I got the offsets from a disassembler.<br /><br /><br />hope that answered the question,<br />will</div>
    <div class="meta">Posted on 2003-05-07 11:04:38 by Will</div>
   </div>
   <div class="post" id="post-101802">
    <div class="subject"><a href="#post-101802">exe from exe??????</a></div>
    <div class="body">+800 = offset to szcaption<br />+840 = offset to sztitle<br /><br />I think... And i suppose the buffer allocated for the szcaption and sztitle is only 64(40h).</div>
    <div class="meta">Posted on 2003-05-07 11:25:39 by roticv</div>
   </div>
   <div class="post" id="post-101906">
    <div class="subject"><a href="#post-101906">Still confused</a></div>
    <div class="body">i still cant get it why did u choose the 800h offset when i tried using the 700h offset the program didn't create<br /><br />exe with my caption??:(</div>
    <div class="meta">Posted on 2003-05-07 23:51:45 by telophase</div>
   </div>
   <div class="post" id="post-101919">
    <div class="subject"><a href="#post-101919">I never tried but.....</a></div>
    <div class="body">Can't you make a seperate message box with seperate buffer and unstead of Appname call it Appname2 ?</div>
    <div class="meta">Posted on 2003-05-08 00:28:45 by mrgone</div>
   </div>
   <div class="post" id="post-101921">
    <div class="subject"><a href="#post-101921">exe from exe??????</a></div>
    <div class="body">Hi telophase,<br /><br />You can get the offset by looking at the file with a hex editor. Put something in your buffer then find it in a hexeditor...<pre><code>.386<br />.model flat,stdcall<br />option casemap&#58;none<br /><br />;###################################<br />;		Include files<br /><br />	include \masm32\include\windows.inc<br />	include \masm32\include\user32.inc<br />	include \masm32\include\kernel32.inc<br /><br />;###################################<br />;		Libraries<br /><br />	includelib \masm32\lib\user32.lib<br />	includelib \masm32\lib\kernel32.lib<br /><br />.data<br />	buffer	BYTE		&quot;my Buffer starts here&quot;,0<br /><br /><br />.data?<br />	hInstance		DWORD		?<br /><br />.code<br /><br />start&#58;<br /><br />	invoke GetModuleHandle,NULL<br />	mov    hInstance,eax<br />	invoke MessageBox,NULL,ADDR buffer,NULL,NULL<br />	invoke ExitProcess,eax<br /><br />end start</code></pre>This is a screen shot of the hex editor (notice the offset is 800h)</div>
    <div class="meta">Posted on 2003-05-08 00:45:29 by donkey</div>
   </div>
   <div class="post" id="post-101922">
    <div class="subject"><a href="#post-101922">exe from exe??????</a></div>
    <div class="body">Thakx donkey ur idea has helped me but what if the buffer is empty somthing like<br /><br />buffer db 255 dup(?)<br /><br />then how do i find it??</div>
    <div class="meta">Posted on 2003-05-08 00:55:14 by telophase</div>
   </div>
   <div class="post" id="post-101925">
    <div class="subject"><a href="#post-101925">exe from exe??????</a></div>
    <div class="body">telophase,<br /><br />Well then you have a problem :) Why not just use this then you can find it !<br /><br />.data<br />buffer db 255 dup(&quot;Z&quot;)<br /><br />After all who cares what's in there, it's going to be overwritten anyway.</div>
    <div class="meta">Posted on 2003-05-08 01:01:31 by donkey</div>
   </div>
   <div class="post" id="post-101926">
    <div class="subject"><a href="#post-101926">exe from exe??????</a></div>
    <div class="body">gr8 idea....<br />Thankyou once again but isn't there any other easier way rather then to mess around with Hex-Strings?</div>
    <div class="meta">Posted on 2003-05-08 01:05:32 by telophase</div>
   </div>
   <div class="post" id="post-101928">
    <div class="subject"><a href="#post-101928">exe from exe??????</a></div>
    <div class="body">Ah, I find that way incredibly easy. I mean you can't really ask for much easier than that. create your file then look for 05A5A5A5Ah (BTW that's a DWORD pans out as &quot;ZZZZ&quot;)</div>
    <div class="meta">Posted on 2003-05-08 01:10:00 by donkey</div>
   </div>
   <div class="post" id="post-101929">
    <div class="subject"><a href="#post-101929">Thankyou All..</a></div>
    <div class="body">thnakyou very much for solving such a complicated problem;)</div>
    <div class="meta">Posted on 2003-05-08 01:14:11 by telophase</div>
   </div>
   <div class="post" id="post-101989">
    <div class="subject"><a href="#post-101989">exe from exe??????</a></div>
    <div class="body">That works fine too.  What I had done was put in a couple of calls referencing those 2 buffers that would never be executed:<br /><br />jmp around<br />invoke MessageBox,0,addr buffer1,addr buffer1,0<br />around:<br />.....<br />.....<br /><br /><br />Then you can disassemble it with w32dasm for example.  Find the string reference to those buffers, and you'll have the offsets.<br /><br /><br />hope that cleared it up,<br />will</div>
    <div class="meta">Posted on 2003-05-08 10:17:55 by Will</div>
   </div>
   <div class="post" id="post-101992">
    <div class="subject"><a href="#post-101992">exe from exe??????</a></div>
    <div class="body">I think the data section is always aligned at a 2k boundary above the code section, that would pretty much explain the 800h and the fact that 2K is the smallest Win32 executable size.</div>
    <div class="meta">Posted on 2003-05-08 10:29:53 by donkey</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=13072&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=13072&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="13072" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=13072&amp;page=2">&gt;</a><a href="../?id=13072&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>