<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>recieve version-information from an dll - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5642" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5642">recieve version-information from an dll</a></p>
   <div class="post" id="post-40228">
    <div class="subject"><a href="#post-40228">recieve version-information from an dll</a></div>
    <div class="body">I tried it the following way but well suppose i kinda suck ;)<br />Also i?m not sure if i must get the language Identifier before i can get<br />the info i would like to have.<br />Any Idea how to get the FileVersion, CompanyName and / or the other predefined version information <br />from an dll ?<br /><br /><pre><code><br />.data<br />szfilename db &quot;test.dll&quot;,0<br />szRoot	   db &quot;\&quot;,0	<br />.data?<br />lpdwHandle dd ?<br />Filesize   dd ?	<br />VersionBuffer db dup 30&#40;?&#41;<br />FileInfo   dd ?<br />outputBuffer db dup 20 &#40;?&#41;<br /><br /><br /><br />INVOKE GetFileVersionInfoSize,addr szfilename,addr lpdwHandle <br />mov Filesize,eax <br />INVOKE GetFileVersionInfo,addr szfilename,0,Filesize,addr VersionBuffer<br />INVOKE VerQueryValue,addr VersionBuffer,addr szRoot,addr FileInfo,addr outputBuffer<br /><br />;probably totally crap now &#58;/<br /><br />mov edi,FileInfo<br />assume edi&#58;ptr VS_FIXEDFILEINFO<br /><br /></code></pre></div>
    <div class="meta">Posted on 2002-05-27 13:25:23 by Allanon</div>
   </div>
   <div class="post" id="post-40261">
    <div class="subject"><a href="#post-40261">recieve version-information from an dll</a></div>
    <div class="body">To get this info, basically you have to wade thru the resource portion of the dll (or exe).<br /><br />Here's a particularly interesting version info section of something in my MSVC toybox. It's interesting cause it supports two languages (both english and japanese).<br /><br />Here's what it looked like coppied from qeditor:<br /><br /><pre><code><br />/////////////////////////////////////////////////////////////////////////////<br />//<br />// Version<br />//<br /><br />VS_VERSION_INFO VERSIONINFO<br /> FILEVERSION 4,0,0,0<br /> PRODUCTVERSION 4,0,0,0<br /> FILEFLAGSMASK 0x3fL<br />#ifdef _DEBUG<br /> FILEFLAGS 0xbL<br />#else<br /> FILEFLAGS 0xaL<br />#endif<br /> FILEOS 0x10001L<br /> FILETYPE 0x1L<br /> FILESUBTYPE 0x0L<br />BEGIN<br />    BLOCK &quot;StringFileInfo&quot;<br />    BEGIN<br />        BLOCK &quot;040904E4&quot;<br />        BEGIN<br />            VALUE &quot;CompanyName&quot;, &quot;Microsoft Corporation\0&quot;<br />            VALUE &quot;FileDescription&quot;, &quot;ClipText Example Application\0&quot;<br />            VALUE &quot;FileVersion&quot;, &quot;Version 4.0\0&quot;<br />            VALUE &quot;InternalName&quot;, &quot;ClipText\0&quot;<br />            VALUE &quot;LegalCopyright&quot;, &quot;Copyright &#40;C&#41; Microsoft Corp. 1990-1995\0&quot;<br />            VALUE &quot;LegalTrademarks&quot;, &quot;Microsoft&#40;R&#41; is a registered trademark of Microsoft Corporation. Windows&#40;TM&#41; is a trademark of Microsoft Corporation\0&quot;<br />            VALUE &quot;ProductName&quot;, &quot;ClipText\0&quot;<br />            VALUE &quot;ProductVersion&quot;, &quot;Version 4.0\0&quot;<br />        END<br />        BLOCK &quot;041104E4&quot;<br />        BEGIN<br />            VALUE &quot;CompanyName&quot;, &quot;Microsoft Corporation\0&quot;<br />            VALUE &quot;FileDescription&quot;, &quot;ClipText Example Application\0&quot;<br />            VALUE &quot;FileVersion&quot;, &quot;Version 4.0\0&quot;<br />            VALUE &quot;InternalName&quot;, &quot;ClipText\0&quot;<br />            VALUE &quot;LegalCopyright&quot;, &quot;Copyright &#40;C&#41; Microsoft Corp. 1990-1995\0&quot;<br />            VALUE &quot;LegalTrademarks&quot;, &quot;Microsoft&#40;R&#41; is a registered trademark of Microsoft Corporation. Windows&#40;TM&#41; is a trademark of Microsoft Corporation\0&quot;<br />            VALUE &quot;ProductName&quot;, &quot;ClipText\0&quot;<br />            VALUE &quot;ProductVersion&quot;, &quot;Version 4.0\0&quot;<br />        END<br />    END<br />    BLOCK &quot;VarFileInfo&quot;<br />    BEGIN<br />        VALUE &quot;Translation&quot;, 0x409, 1252, 0x411, 1252<br />    END<br />END<br /><br />#ifdef JAPAN<br />LANGUAGE LANG_JAPANESE, SUBLANG_NEUTRAL<br /><br />showdib MENU<br />     BEGIN<br />		POPUP &quot;?t?@?C??&#40;&amp;F&#41;&quot;<br />          BEGIN<br />		    MENUITEM &quot;?J??&#40;&amp;O&#41;...&quot;,	       IDM_OPEN<br />		    MENUITEM &quot;???&#40;&amp;S&#41;...&quot;,	       IDM_SAVE<br />		    MENUITEM &quot;????&#40;&amp;P&#41;&quot;,	       IDM_PRINT<br />		    MENUITEM SEPARATOR<br />		    MENUITEM &quot;?I??&#40;&amp;X&#41;&quot;,	       IDM_EXIT<br />		    MENUITEM SEPARATOR<br />		    MENUITEM &quot;?o?&#91;?W????????&#40;&amp;A&#41;...&quot;,  IDM_ABOUT<br />          END<br />        POPUP &quot;?I?v?V????&#40;&amp;O&#41;&quot;<br />          BEGIN<br />		    MENUITEM &quot;?F???X?V&#40;&amp;U&#41;&quot;,	      IDM_UPDATECOL<br />		    MENUITEM &quot;???X?_??\??&#40;&amp;H&#41;&quot;,      IDM_NOUGLY<br />		    MENUITEM &quot;DIB?\??&#40;&amp;D&#41;&quot;,	      IDM_DIBSCREEN<br />		    MENUITEM &quot;DIBs??????&#40;&amp;M&#41;&quot;,	      IDM_MEMORYDIB<br />		    MENUITEM &quot;????&#40;&amp;T&#41;&quot;,	      IDM_TRANSPARENT<br /><br />		    MENUITEM SEPARATOR<br />		    MENUITEM &quot;DIB??\???t??&#40;&amp;A&#41;&quot;,     IDM_PASTEDIB<br />		    MENUITEM &quot;DDB??\???t??&#40;&amp;S&#41;&quot;,     IDM_PASTEDDB<br />		    MENUITEM &quot;?p???b?g??\???t??&#40;&amp;E&#41;&quot;,IDM_PASTEPAL<br />		    MENUITEM &quot;?R?s?&#91;&#40;&amp;C&#41;&quot;,	      IDM_COPY<br />          END<br /><br />        POPUP &quot;?A?j???&#91;?V????&#40;&amp;A&#41;&quot;<br />          BEGIN<br />		    MENUITEM &quot;?X?`?&#91;?? ?J???&#91;&quot;,   	IDM_STEALCOL<br />		    MENUITEM &quot;?n?e?e&quot;,	IDM_ANIMATE0<br />		    MENUITEM &quot;5&quot;,		IDM_ANIMATE5<br />		    MENUITEM &quot;50&quot;,		IDM_ANIMATE50<br />		    MENUITEM &quot;100&quot;,		IDM_ANIMATE100<br />		    MENUITEM &quot;200&quot;,		IDM_ANIMATE200<br />		    MENUITEM &quot;??????&quot;,	IDM_ANIMATE201<br />          END<br />     END<br /><br />STRINGTABLE<br />	BEGIN<br />		IDS_MEMLOW          &quot;&lt;WM_CREATE&gt; ?p???b?g???????????????????????B&quot;<br />        IDS_NOMEM           &quot;??????????????????I&quot;<br />        IDS_OPENDIBPROMPT   &quot;?\?????? DIB ??I??&quot;<br />        IDS_SAVEDIBPROMPT   &quot;DIB ??????????t?@?C????I??&quot;<br />        IDS_CANTSAVEFILE    &quot;?w?????t?@?C?????????????????D&quot;<br />        IDS_CANTOPENFILE    &quot;?t?@?C?????I?|?v???????????D '%ls'&quot;<br />        IDS_BADDIBFILE      &quot;%s ?????????c?h?a?`????t?@?C??????????????I&quot;<br />        IDS_CREATEPALFAIL   &quot;CreatePalette&#40;&#41; ????s????????D&quot;<br />        IDS_CANTLOADRLE     &quot;?q?k?d?t?@?C?????????????????????????I&quot;<br />        IDS_CANTCREATEBMP   &quot;?r?b?g?&#125;?b?v??????????????????????I&quot;<br />        IDS_CANTDRAWSCANS   &quot;DIB ???f?o?C?X??`???????!&quot;<br />        IDS_CANTDRAWMAP     &quot;?r?b?g?&#125;?b?v???X?N???&#91;????R?s?&#91;????????!&quot;<br />        IDS_SAVESTR         &quot;???&#40;&amp;S&#41;&quot;<br />        IDS_OPENSTR         &quot;?J??&#40;&amp;O&#41;&quot;<br />	END<br />#endif<br /></code></pre><br /><br />Just have a go at the file with FindResource, LoadResource, LockResource, SizeofResource, and anything else you might want to use there.</div>
    <div class="meta">Posted on 2002-05-27 21:13:46 by Ernie</div>
   </div>
   <div class="post" id="post-40266">
    <div class="subject"><a href="#post-40266">recieve version-information from an dll</a></div>
    <div class="body">thanx Ernie, didn?t even thought about that</div>
    <div class="meta">Posted on 2002-05-27 23:55:53 by Allanon</div>
   </div>
  </div>
 </body>
</html>