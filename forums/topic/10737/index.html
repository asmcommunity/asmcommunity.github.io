<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>list of active processes - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10737" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10737">list of active processes</a></p>
   <div class="post" id="post-80731">
    <div class="subject"><a href="#post-80731">list of active processes</a></div>
    <div class="body">Hi all,<br />How i can receive list of active processes. When i want to receive list of all active <br />processes i use API CreateToolhelp32Snapshot but i want to receive the list of visible <br />processes only. (When i press CTRL+ALT+DEL, i see that list).<br /><br />Thanks in advance</div>
    <div class="meta">Posted on 2003-02-09 15:30:28 by martidim</div>
   </div>
   <div class="post" id="post-80799">
    <div class="subject"><a href="#post-80799">list of active processes</a></div>
    <div class="body">hi, look <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=7962&amp;highlight=EnumWindows">here</a> <br /><br />just convert this Little vb snipped in the middle of that thread to asm.<br />or just have a look at the &quot;EnumWindows&quot; API in your references.</div>
    <div class="meta">Posted on 2003-02-10 03:34:27 by mob</div>
   </div>
   <div class="post" id="post-80800">
    <div class="subject"><a href="#post-80800">...</a></div>
    <div class="body">or you could always do a loop with the getwindow api.</div>
    <div class="meta">Posted on 2003-02-10 03:51:21 by HeXeN</div>
   </div>
   <div class="post" id="post-80801">
    <div class="subject"><a href="#post-80801">list of active processes</a></div>
    <div class="body">have a look <a target="_blank" href="http://www.geocities.com/vpol_54296/index.html">here</a> <br />there?s an nice example for win9x and nt4</div>
    <div class="meta">Posted on 2003-02-10 04:05:05 by Allanon</div>
   </div>
   <div class="post" id="post-80802">
    <div class="subject"><a href="#post-80802">list of active processes</a></div>
    <div class="body">doesn't GetWindow need a source window?</div>
    <div class="meta">Posted on 2003-02-10 04:05:15 by mob</div>
   </div>
   <div class="post" id="post-80805">
    <div class="subject"><a href="#post-80805">...</a></div>
    <div class="body">here some of my vb code to look at:<br /><br />if u want i can also attach and app using this code everything looks ok to me so far.. the only problem would be with the process identifiers if u needed them.<br />--------------------------------------------------------------------------------------<br />Sub AllOpenWindows(lst As ListBox)<br />'-HeXeN<br /> Dim FirstWindow As Long<br /> Dim NextWindow As Long<br /> Dim LastWindow As Long<br /> Dim CN As String<br /> <br /> lst.Clear<br /> <br /> FirstWindow&amp; = GetActiveWindow<br /> NextWindow&amp; = FirstWindow&amp;<br /> <br /> Do: DoEvents<br /> <br />   If IsWindowVisible(NextWindow&amp;) &lt;&gt; 0 Then<br />    If GetParent(NextWindow&amp;) = 0 Then<br />     CN$ = String(255, vbNullChar)<br />     Call GetWindowText(NextWindow&amp;, CN$, 255)<br />     lst.AddItem CN$<br />    End If<br />   End If<br />  NextWindow&amp; = GetWindow(NextWindow&amp;, GW_HWNDNEXT)<br /><br /> Loop While NextWindow&amp; &lt;&gt; 0<br />End Sub<br />------------------------------<br />sorry to everyone who hates vb code :)<br />---------------------------------------------</div>
    <div class="meta">Posted on 2003-02-10 04:11:56 by HeXeN</div>
   </div>
   <div class="post" id="post-80808">
    <div class="subject"><a href="#post-80808">list of active processes</a></div>
    <div class="body">mh i don't know, looks like it could work, but i think it's a little kinky<br />to do it like this. EnumWindows is made for this purpose...</div>
    <div class="meta">Posted on 2003-02-10 04:35:43 by mob</div>
   </div>
   <div class="post" id="post-81143">
    <div class="subject"><a href="#post-81143">list of active processes</a></div>
    <div class="body">Thank you very much - EnumWindows is a good solution !</div>
    <div class="meta">Posted on 2003-02-11 17:53:35 by martidim</div>
   </div>
  </div>
 </body>
</html>