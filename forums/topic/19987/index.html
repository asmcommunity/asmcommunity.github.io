<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>how to use the dwFlagsAndAttributes FILE_FLAG_DELETE_ON_CLOS - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19987" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19987">how to use the dwFlagsAndAttributes FILE_FLAG_DELETE_ON_CLOS</a></p>
   <div class="post" id="post-153308">
    <div class="subject"><a href="#post-153308">how to use the dwFlagsAndAttributes FILE_FLAG_DELETE_ON_CLOS</a></div>
    <div class="body">hello, I writed a program, that when it is running, it will copy itself, and make the copied one to run. The copied one's dwFlagsAndAttributes is FILE_FLAG_DELETE_ON_CLOS, I mean to make the copied one disappeared when it no longer used.<br /><br />then the questions are : <br />1. bucause the copied one's dwFlagsAndAttributes is FILE_FLAG_DELETE_ON_CLOS, so when I create the file and colose it's handle, it will Disappear, so I cannot run it.<br />2. If I first give the dwFlagsAndAttributes FILE_ATTRIBUTE_ARCHIVE, then colose it's handle, but when the copied one no longer used, it will not Disappear.<br />how can I create that file and make it running?</div>
    <div class="meta">Posted on 2004-11-21 09:09:08 by miaomiao</div>
   </div>
   <div class="post" id="post-153346">
    <div class="subject"><a href="#post-153346">how to use the dwFlagsAndAttributes FILE_FLAG_DELETE_ON_CLOS</a></div>
    <div class="body">Try these steps:<br /><br />- Create file with FILE_FLAG_DELETE_ON_CLOSE <br />- Write file contents<br />- Run the file <br />- Close handle to file. CreateProcess (or ShellExecute, whatever you're using) will open a handle to the file and prevent the file from being deleted until the process exits.<br /><br />I'm not sure if CreateProcess will work on files that have handles with write-access open, so you may need to first write the file, close the file, and then re-open it readonly with FILE_FLAG_DELETE_ON_CLOSE.</div>
    <div class="meta">Posted on 2004-11-22 03:28:38 by Qweerdy</div>
   </div>
   <div class="post" id="post-153352">
    <div class="subject"><a href="#post-153352">how to use the dwFlagsAndAttributes FILE_FLAG_DELETE_ON_CLOS</a></div>
    <div class="body"><div class="quote">Try these steps:<br /><br />- Create file with FILE_FLAG_DELETE_ON_CLOSE <br />- Write file contents<br />- Run the file <br />- Close handle to file. CreateProcess (or ShellExecute, whatever you're using) will open a handle to the file and prevent the file from being deleted until the process exits.<br /><br />I'm not sure if CreateProcess will work on files that have handles with write-access open, so you may need to first write the file, close the file, and then re-open it readonly with FILE_FLAG_DELETE_ON_CLOSE.</div><br /><br />Thank for your reply, but when &quot;- Close handle to file.&quot;, the file will disappear, so &quot;CreateProcess&quot; will NOT work.</div>
    <div class="meta">Posted on 2004-11-22 07:01:47 by miaomiao</div>
   </div>
  </div>
 </body>
</html>