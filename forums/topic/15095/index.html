<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Simple ASCII TO BIN - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15095" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15095">Simple ASCII TO BIN</a></p>
   <div class="post" id="post-117291">
    <div class="subject"><a href="#post-117291">Simple ASCII TO BIN</a></div>
    <div class="body">This is a Simple program that is used to change ASCII HEX to BIN HEX.. Sometimes i find code snipets online that are in ASCII HEX and want them into something i can use..<br /><br />I added in support to check for Tabs,return valuse and spaces..<br /><br />its also based on a old template that should be revamped for multi file support..<br /><br /><br />.386<br />.model flat,stdcall<br />option casemap:none<br /><br />Main PROTO<br />INCLUDE \masm32\include\windows.inc<br />INCLUDE \masm32\include\user32.inc<br />INCLUDE \masm32\include\kernel32.inc<br />INCLUDE \masm32\include\comdlg32.inc<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\comdlg32.lib<br /><br />.const<br />MAXSIZE equ 00FFFFh<br />.data<br />fintext db &quot;Job Complete&quot;,0<br />fincap db &quot;Job Finished&quot;,0<br />AppName db &quot;Generic Decryptor&quot;,0<br />FilterString db &quot;All Files&quot;,0,&quot;*.*&quot;,0,0<br />buffer db MAXSIZE dup(0)<br />FILENAME db 250 dup(0)<br />Path db 250 dup(0)<br />Problem db &quot;Not Successfull&quot;,0<br /><br />.data?<br />hInstance HINSTANCE ?<br />hFileRead HANDLE ?<br />pMemory DWORD ?<br />hMemory DWORD ?<br />pMemory2 DWORD ?<br />hMemory2 DWORD ?<br />SizeWritten DWORD ?<br />ofn OPENFILENAME &lt;&gt;<br />FileSizeS LARGE_INTEGER &lt;&gt;<br />FileSizeU DWORD ?<br />PATHSIZE DWORD ?<br />NUMBEROFFILES DWORD ?<br />PASSES DWORD ?<br />FileNamePointer DWORD ?<br />PATHSIZEVAR DWORD ?<br />BLANK db 64 dup(?)<br />ENDOFFILENAME DWORD ?<br />FileSizeU2 dd ?<br />CorrectError dd ?<br /><br />.CODE<br />Program:<br />INVOKE GetModuleHandle,NULL<br /> mov hInstance,EAX<br />INVOKE Main<br />INVOKE ExitProcess,NULL<br />ret<br /><br />Main proc<br />mov ofn.lStructSize,SIZEOF ofn<br />push hInstance<br />pop ofn.hInstance<br />mov ofn.lpstrFilter,OFFSET FilterString<br />mov ofn.lpstrFile,OFFSET buffer<br />mov ofn.nMaxFile,MAXSIZE<br />mov ofn.Flags,OFN_FILEMUSTEXIST or OFN_PATHMUSTEXIST or OFN_LONGNAMES or \<br />              OFN_EXPLORER or OFN_HIDEREADONLY or OFN_ALLOWMULTISELECT<br />INVOKE GetOpenFileName,ADDR ofn<br />  .IF eax!=TRUE<br />    INVOKE MessageBox,NULL,ADDR Problem,ADDR AppName,MB_OK<br />    ret<br />  .ENDIF<br /><br />mov eax,OFFSET buffer<br />mov ebp,OFFSET Path<br />mov ebx,1<br /><br />move:<br />mov cl,BYTE PTR <br />mov BYTE PTR ,cl<br /> .IF cl!=00<br />    inc eax<br />    inc ebp<br />    inc ebx<br />    jmp move<br /> .ENDIF<br />mov PATHSIZE,EBX<br />mov PATHSIZEVAR,EBX<br />inc ebx<br />mov FileNamePointer,EBX<br />inc eax<br />xor ebx,EBX<br />xor ecx,ECX<br />COUNTFILES:<br />mov cl,BYTE PTR <br />  .IF cl==00<br />    inc ebx<br />    inc eax<br />    mov cl,BYTE PTR <br />      .IF cl==00<br />         mov NUMBEROFFILES,EBX<br />          .IF EBX==01<br />               xor EBP,EBP<br />               mov eax,OFFSET Path<br />               mov ebx,OFFSET FILENAME<br />            looop:<br />           .IF EBP&gt;=250 <br />           mov eax,OFFSET FILENAME<br />         EOFLOP:<br />             mov cl,BYTE PTR <br />             .IF cl==00<br />               mov ENDOFFILENAME,eax<br />               jmp SINGLE <br />             .ENDIF<br />             inc eax<br />             jmp EOFLOP<br />           .ENDIF<br />             mov CL,BYTE PTR           <br />             mov BYTE PTR ,CL<br />            INC EAX<br />            INC EBX<br />            INC EBP<br />            jmp looop<br />          .ENDIF<br />             mov PASSES,0<br />              jmp WORK<br />      .ENDIF<br />      .ENDIF<br />inc eax<br />jmp COUNTFILES<br />WORK:<br />   mov eax,NUMBEROFFILES<br />  .IF PASSES&gt;=EAX<br />    JMP DONE<br />  .ENDIF<br />   add PASSES,1<br />    mov eax,OFFSET Path<br />    mov ebx,OFFSET FILENAME<br />    xor EBP,EBP<br />looop2:<br />    .IF EBP&gt;=250 <br />      JMP loop2done<br />    .ENDIF<br />    mov CL,BYTE PTR           <br />    mov BYTE PTR ,CL<br />    INC EAX<br />    INC EBX<br />    INC EBP<br />jmp looop2<br />loop2done:<br />xor ebp,ebp<br />mov eax,OFFSET FILENAME<br />add eax,PATHSIZE<br />dec eax<br />mov BYTE PTR ,05ch<br />inc eax<br />mov ebx,OFFSET buffer<br />add ebx,PATHSIZEVAR<br />filenamesetup:<br />mov cl,BYTE PTR <br />mov BYTE PTR ,cl<br />  .IF cl==00<br />    inc ebp<br />    add PATHSIZEVAR,ebp<br />    mov ENDOFFILENAME,EAX<br />    jmp SINGLE<br />  .ENDIF<br />inc eax<br />inc ebx<br />inc ebp<br />jmp filenamesetup<br />SINGLE:<br />   ;INVOKE MessageBox,NULL,ADDR FILENAME,ADDR AppName,MB_OK<br />   INVOKE CreateFile,ADDR FILENAME,GENERIC_READ or GENERIC_WRITE,NULL,NULL,\<br />                     OPEN_EXISTING,NULL,NULL<br />   mov hFileRead,eax<br />   INVOKE GetFileSize,hFileRead,addr FileSizeS<br />   mov FileSizeU,eax<br />INVOKE GlobalAlloc,GMEM_MOVEABLE or GMEM_ZEROINIT,FileSizeU<br />mov hMemory,eax<br />INVOKE GlobalLock,hMemory<br />mov pMemory,eax<br /><br />xor eax,eax<br /><br />mov eax,FileSizeU<br />mov ecx,02h<br />div ecx<br />add eax,edx<br /><br />mov FileSizeU2,eax<br />INVOKE GlobalAlloc,GMEM_MOVEABLE or GMEM_ZEROINIT,FileSizeU2<br />mov hMemory2,eax<br />INVOKE GlobalLock,hMemory2<br />mov pMemory2,eax<br />INVOKE ReadFile,hFileRead,pMemory,FileSizeU,addr SizeWritten,NULL<br />INVOKE CloseHandle,hFileRead<br />      mov edi,pMemory<br />      mov esi,pMemory2<br />      mov ebx,00h<br />      mov ecx,00h<br /><br />       Loop_1:<br />       cmp byte ptr ,20h<br />       je Num_3_1<br />       cmp byte ptr ,09h<br />       je Num_3_1<br />       cmp word ptr ,0a0dh<br />       je Num_3<br />       mov al, byte ptr <br />       cmp al,41h  ;A<br />       je A_h<br />       cmp al,42h  ;B<br />       je B_h<br />       cmp al,43h  ;C<br />       je C_h<br />       cmp al,44h  ;D<br />       je D_h<br />       cmp al,45h  ;E<br />       je E_h<br />       cmp al,46h  ;F<br />       je F_h<br /><br />       sub al,30h<br />       jmp Num_1<br /><br />       A_h:<br />       mov al,0Ah<br />       jmp Num_1<br />       B_h:<br />       mov al,0Bh<br />       jmp Num_1<br />       C_h:<br />       mov al,0Ch<br />       jmp Num_1<br />       D_h:<br />       mov al,0Dh<br />       jmp Num_1<br />       E_h:<br />       mov al,0Eh<br />       jmp Num_1<br />       F_h:<br />       mov al,0Fh<br />       jmp Num_1<br /><br />       Num_1:<br />       shl al,04h<br />       mov cl,al<br />       inc edi<br />       inc ebx<br />       <br />       Loop_2:<br />       cmp byte ptr ,20h<br />       je Num_4_1<br />       cmp byte ptr ,09h<br />       je Num_4_1<br />       cmp word ptr ,0a0dh<br />       je Num_4<br />       mov al, byte ptr <br />       cmp al,41h  ;A<br />       je A2_h<br />       cmp al,42h  ;B<br />       je B2_h<br />       cmp al,43h  ;C<br />       je C2_h<br />       cmp al,44h  ;D<br />       je D2_h<br />       cmp al,45h  ;E<br />       je E2_h<br />       cmp al,46h  ;F<br />       je F2_h<br /><br />       sub al,30h<br />       jmp Num_2<br /><br />       A2_h:<br />       mov al,0Ah<br />       jmp Num_2<br />       B2_h:<br />       mov al,0Bh<br />       jmp Num_2<br />       C2_h:<br />       mov al,0Ch<br />       jmp Num_2<br />       D2_h:<br />       mov al,0Dh<br />       jmp Num_2<br />       E2_h:<br />       mov al,0Eh<br />       jmp Num_2<br />       F2_h:<br />       mov al,0Fh<br />       jmp Num_2<br /><br />       Num_2:<br />       add cl,al<br />       mov byte ptr ,cl<br />       inc edi<br />       inc esi<br />       inc ebx<br />       cmp ebx,FileSizeU<br />       jne Loop_1<br />       jmp nextfile<br />       <br />       Num_3:<br />       dec FileSizeU2<br />       add edi,02h<br />       add ebx,02h<br />       cmp ebx,FileSizeU<br />       jne Loop_1<br />       jmp nextfile<br />       <br />       Num_3_1:<br />       inc CorrectError<br />       inc edi<br />       inc ebx<br />       cmp ebx,FileSizeU<br />       jne Loop_1<br />       jmp nextfile<br /><br />       Num_4:<br />       dec FileSizeU2<br />       add edi,02h<br />       add ebx,02h<br />       cmp ebx,FileSizeU<br />       jne Loop_2<br />       jmp nextfile<br />       <br />       Num_4_1:<br />       inc CorrectError<br />       inc edi<br />       inc ebx<br />       cmp ebx,FileSizeU<br />       jne Loop_2<br />       jmp nextfile<br /><br /><br />nextfile:<br />xor eax,eax<br />xor edx,edx<br />xor ecx,ecx<br /><br />mov eax,CorrectError<br />mov ecx,02h<br />div ecx<br />add eax,edx<br />sub FileSizeU2,eax<br />INVOKE CreateFile,ADDR FILENAME,GENERIC_READ or GENERIC_WRITE,NULL,NULL,\<br />                  CREATE_ALWAYS,NULL,NULL<br />exit:<br />mov hFileRead,eax<br />INVOKE WriteFile,hFileRead,pMemory2,FileSizeU2,addr SizeWritten,NULL<br />INVOKE CloseHandle,hFileRead<br />INVOKE GlobalUnlock,pMemory<br />INVOKE GlobalFree,hMemory<br />INVOKE GlobalUnlock,pMemory2<br />INVOKE GlobalFree,hMemory2<br />.IF NUMBEROFFILES==01<br />  JMP DONE<br />.ENDIF<br />JMP WORK    <br />DONE:<br />invoke MessageBoxA,NULL,addr fintext,addr fincap,MB_OK<br />INVOKE PostQuitMessage,NULL<br />invoke ExitProcess,NULL<br />Main endp<br />END Program</div>
    <div class="meta">Posted on 2003-09-06 20:48:44 by devilsclaw</div>
   </div>
   <div class="post" id="post-117298">
    <div class="subject"><a href="#post-117298">Simple ASCII TO BIN</a></div>
    <div class="body">Have a look at the following:<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=4362&amp;highlight=Hex+string+mmx">http://www.asmcommunity.net/board/index.php?topic=4362&amp;highlight=Hex+string+mmx</a><br /><br />Oh yes a good snipplet to test for range is the following:<br /><pre><code><br />lea ecx, &#91;eax-LOWERLIMIT&#93;<br />cmp ecx, UPPERLIMIT-LOWERLIMIT<br />jna _in_range ; ja _notinrange<br /></code></pre></div>
    <div class="meta">Posted on 2003-09-06 22:21:42 by roticv</div>
   </div>
  </div>
 </body>
</html>