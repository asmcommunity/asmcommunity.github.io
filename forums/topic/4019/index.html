<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>newbie question:  how to translate Win32API to masm? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4019" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4019">newbie question:  how to translate Win32API to masm?</a></p>
   <div class="post" id="post-27435">
    <div class="subject"><a href="#post-27435">newbie question:  how to translate Win32API to masm?</a></div>
    <div class="body">Dear All,<br /><br />I'm yet another masm newbie.<br /><br />Please bear with me ...<br /><br />I've downloaded Win32 Programmer's Reference (win32.hlp dated 14-March-1997).<br /><br />(1)  Is this the latest version?  If not, where do I download the latest version?<br /><br />(2)  How do I translate it to masm?<br /><br />e.g.<br /><br />In the help file, it says<br /><br />The RegOpenKeyEx function opens the specified key. <br /><br />LONG RegOpenKeyEx(<br /><br />    HKEY hKey,	// handle of open key <br />    LPCTSTR lpSubKey,	// address of name of subkey to open <br />    DWORD ulOptions,	// reserved <br />    REGSAM samDesired,	// security access mask <br />    PHKEY phkResult 	// address of handle of open key <br />   );<br /><br />How is this translated to masm?<br /><br />What is the rule of thumb?  guideline?  Any documentation I can read on how to translate the API to masm (with many examples)?  Any real live examples of a program with masm source code I can refer to?<br /><br /><br />eager to learn,<br />newbie888</div>
    <div class="meta">Posted on 2002-03-05 23:26:00 by newbie888</div>
   </div>
   <div class="post" id="post-27441">
    <div class="subject"><a href="#post-27441">newbie question:  how to translate Win32API to masm?</a></div>
    <div class="body">newbie888,<br /><br />Its not as complicated as it looks, with only a few exceptions all of the parameters for windows API functions are 32 bit in size so its a matter of working out if they are values, addresses or a collection of data in a structure.<br /><br />I don't know the API as I rarely use registry stuff but some of them are simple.<br /><br />hKey is a 32 bit handle so you pass the value of the handle.<br /><br />lpSubKey uses &quot;lp&quot; so its an address, in this case probably a zero terminated string.<br /><br />ulOptions is reserved so its NULL<br /><br />samDesired appears to be a 32 bit constant<br /><br />phkResult is an address so it should be 32 bit like all addresses in 32 bit windows.<br /><br />The general rule of thumb is the SIZE of the parameter, what you ned to work out is if its a value or an address. Both are passed as DWORD size in assembler.<br /><br />Good Luck.<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-03-06 00:42:22 by hutch--</div>
   </div>
   <div class="post" id="post-27580">
    <div class="subject"><a href="#post-27580">newbie question:  how to translate Win32API to masm?</a></div>
    <div class="body">Hi hutch,<br /><br />tq for the reply.  I've found lots of examples from Betrayed website, which proves to be useful in understanding how to use the Win32 API in masm.<br /><br />regards.</div>
    <div class="meta">Posted on 2002-03-06 21:15:51 by newbie888</div>
   </div>
  </div>
 </body>
</html>