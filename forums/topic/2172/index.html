<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>_EPROCESS struct anyone ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2172" />
    <link rel="next" href="../?id=2172&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2172">_EPROCESS struct anyone ?</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=2172&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=2172&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="2172" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=2172&amp;page=2">&gt;</a><a href="../?id=2172&amp;page=2">&raquo;</a></form>   <div class="post" id="post-13711">
    <div class="subject"><a href="#post-13711">_EPROCESS struct anyone ?</a></div>
    <div class="body">Hello,<br /><br />I'm looking for an .inc file that contains a valid EPROCESS struct and perhaps KTHREAD etc.. I have a C header that describes this stuff but a full fledged .inc would be a thing nice-to-have.</div>
    <div class="meta">Posted on 2001-12-02 01:47:10 by jmp $FCE2</div>
   </div>
   <div class="post" id="post-13793">
    <div class="subject"><a href="#post-13793">_EPROCESS struct anyone ?</a></div>
    <div class="body">Post the C header.... ???  I have no clue what your getting at..<br /><br />NaN</div>
    <div class="meta">Posted on 2001-12-02 18:11:27 by NaN</div>
   </div>
   <div class="post" id="post-13801">
    <div class="subject"><a href="#post-13801">_EPROCESS struct anyone ?</a></div>
    <div class="body">This is EPROCESS structure, a NT / W2K / XP internal, undocumented process structure. Apparently it refers to tons of other definitions like KEVENT, PEB, KPROCESS and so on. It's taken from a C-Header file describing all this stuff and more, but I'm hesitating to convert it by hand and alas H2INC doesn't work of course.<br /><br />// =================================================================<br />// EXECUTIVE PROCESSES AND THREADS<br />// =================================================================<br /><br />typedef struct _EPROCESS<br />        {<br />/*000*/ KPROCESS               Pcb;<br />/*06C*/ NTSTATUS               ExitStatus;<br />/*070*/ KEVENT                 LockEvent;<br />/*080*/ DWORD                  LockCount;<br />/*084*/ DWORD                  d084;<br />/*088*/ LARGE_INTEGER          CreateTime;<br />/*090*/ LARGE_INTEGER          ExitTime;<br />/*098*/ PVOID                  LockOwner;<br />/*09C*/ DWORD                  UniqueProcessId;<br />/*0A0*/ LIST_ENTRY             ActiveProcessLinks;<br />/*0A8*/ DWORD                  QuotaPeakPoolUsage [2]; // NP, P<br />/*0B0*/ DWORD                  QuotaPoolUsage     [2]; // NP, P<br />/*0B8*/ DWORD                  PagefileUsage;<br />/*0BC*/ DWORD                  CommitCharge;<br />/*0C0*/ DWORD                  PeakPagefileUsage;<br />/*0C4*/ DWORD                  PeakVirtualSize;<br />/*0C8*/ LARGE_INTEGER          VirtualSize;<br />/*0D0*/ MMSUPPORT              Vm;<br />/*100*/ DWORD                  d100;<br />/*104*/ DWORD                  d104;<br />/*108*/ DWORD                  d108;<br />/*10C*/ DWORD                  d10C;<br />/*110*/ DWORD                  d110;<br />/*114*/ DWORD                  d114;<br />/*118*/ DWORD                  d118;<br />/*11C*/ DWORD                  d11C;<br />/*120*/ PVOID                  DebugPort;<br />/*124*/ PVOID                  ExceptionPort;<br />/*128*/ PHANDLE_TABLE          ObjectTable;<br />/*12C*/ PVOID                  Token;<br />/*130*/ FAST_MUTEX             WorkingSetLock;<br />/*150*/ DWORD                  WorkingSetPage;<br />/*154*/ BOOLEAN                ProcessOutswapEnabled;<br />/*155*/ BOOLEAN                ProcessOutswapped;<br />/*156*/ BOOLEAN                AddressSpaceInitialized;<br />/*157*/ BOOLEAN                AddressSpaceDeleted;<br />/*158*/ FAST_MUTEX             AddressCreationLock;<br />/*178*/ KSPIN_LOCK             HyperSpaceLock;<br />/*17C*/ DWORD                  ForkInProgress;<br />/*180*/ WORD                   VmOperation;<br />/*182*/ BOOLEAN                ForkWasSuccessful;<br />/*183*/ BYTE                   MmAgressiveWsTrimMask;<br />/*184*/ DWORD                  VmOperationEvent;<br />/*188*/ HARDWARE_PTE           PageDirectoryPte;<br />/*18C*/ DWORD                  LastFaultCount;<br />/*190*/ DWORD                  ModifiedPageCount;<br />/*194*/ PVOID                  VadRoot;<br />/*198*/ PVOID                  VadHint;<br />/*19C*/ PVOID                  CloneRoot;<br />/*1A0*/ DWORD                  NumberOfPrivatePages;<br />/*1A4*/ DWORD                  NumberOfLockedPages;<br />/*1A8*/ WORD                   NextPageColor;<br />/*1AA*/ BOOLEAN                ExitProcessCalled;<br />/*1AB*/ BOOLEAN                CreateProcessReported;<br />/*1AC*/ HANDLE                 SectionHandle;<br />/*1B0*/ struct _PEB           *Peb;<br />/*1B4*/ PVOID                  SectionBaseAddress;<br />/*1B8*/ PQUOTA_BLOCK           QuotaBlock;<br />/*1BC*/ NTSTATUS               LastThreadExitStatus;<br />/*1C0*/ DWORD                  WorkingSetWatch;<br />/*1C4*/ HANDLE                 Win32WindowStation;<br />/*1C8*/ DWORD                  InheritedFromUniqueProcessId;<br />/*1CC*/ ACCESS_MASK            GrantedAccess;<br />/*1D0*/ DWORD                  DefaultHardErrorProcessing; // HEM_*<br />/*1D4*/ DWORD                  LdtInformation;<br />/*1D8*/ PVOID                  VadFreeHint;<br />/*1DC*/ DWORD                  VdmObjects;<br />/*1E0*/ PVOID                  DeviceMap; // 0x24 bytes<br />/*1E4*/ DWORD                  SessionId;<br />/*1E8*/ DWORD                  d1E8;<br />/*1EC*/ DWORD                  d1EC;<br />/*1F0*/ DWORD                  d1F0;<br />/*1F4*/ DWORD                  d1F4;<br />/*1F8*/ DWORD                  d1F8;<br />/*1FC*/ BYTE                   ImageFileName [16];<br />/*20C*/ DWORD                  VmTrimFaultValue;<br />/*210*/ BYTE                   SetTimerResolution;<br />/*211*/ BYTE                   PriorityClass;<br />/*212*/ union<br />            {<br />            struct<br />                {<br />/*212*/         BYTE               SubSystemMinorVersion;<br />/*213*/         BYTE               SubSystemMajorVersion;<br />                };<br />            struct<br />                {<br />/*212*/         WORD               SubSystemVersion;<br />                };<br />            };<br />/*214*/ struct _WIN32_PROCESS *Win32Process;<br />/*218*/ DWORD                  d218;<br />/*21C*/ DWORD                  d21C;<br />/*220*/ DWORD                  d220;<br />/*224*/ DWORD                  d224;<br />/*228*/ DWORD                  d228;<br />/*22C*/ DWORD                  d22C;<br />/*230*/ PVOID                  Wow64;<br />/*234*/ DWORD                  d234;<br />/*238*/ IO_COUNTERS            IoCounters;<br />/*268*/ DWORD                  d268;<br />/*26C*/ DWORD                  d26C;<br />/*270*/ DWORD                  d270;<br />/*274*/ DWORD                  d274;<br />/*278*/ DWORD                  d278;<br />/*27C*/ DWORD                  d27C;<br />/*280*/ DWORD                  d280;<br />/*284*/ DWORD                  d284;<br />/*288*/ }<br />        EPROCESS,<br />     * PEPROCESS,<br />    **PPEPROCESS;<br /><br />#define EPROCESS_ \<br />        sizeof (EPROCESS)</div>
    <div class="meta">Posted on 2001-12-02 20:38:04 by jmp $FCE2</div>
   </div>
   <div class="post" id="post-13815">
    <div class="subject"><a href="#post-13815">_EPROCESS struct anyone ?</a></div>
    <div class="body">When you're done, are ya gonna donate it to MASM32 7.1 :grin: :grin: :grin:</div>
    <div class="meta">Posted on 2001-12-03 00:38:20 by S/390</div>
   </div>
   <div class="post" id="post-13819">
    <div class="subject"><a href="#post-13819">_EPROCESS struct anyone ?</a></div>
    <div class="body">Well its not finished, and i dont have NT, but took me bout 5 min to fix up with Ultra Edits' macro features...<br /><br /><pre><code>; ==================================================<br />; EXECUTIVE PROCESSES AND THREADS <br />; ==================================================<br /><br />EPROCESS struct <br /> KPROCESS Pcb; /*000*/                 MUST VERIFY<br /> NTSTATUS ExitStatus; /*06C*/           MUST VERIFY<br /> KEVENT LockEvent; /*070*/              MUST VERIFY<br /> DWORD LockCount; /*080*/<br /> DWORD d084; /*084*/<br /> LARGE_INTEGER CreateTime; /*088*/      MUST BE CREATED &#40;8 BYTES&#41;<br /> LARGE_INTEGER ExitTime; /*090*/        MUST BE CREATED &#40;8 BYTES&#41;<br /> DWORD LockOwner; /*098*/<br /> DWORD UniqueProcessId; /*09C*/<br /> LIST_ENTRY ActiveProcessLinks; /*0A0*/      MUST VERIFY<br /> DWORD QuotaPeakPoolUsage &#91;2&#93;; // NP, P /*0A8*/<br /> DWORD QuotaPoolUsage &#91;2&#93;; // NP, P /*0B0*/<br /> DWORD PagefileUsage; /*0B8*/<br /> DWORD CommitCharge; /*0BC*/<br /> DWORD PeakPagefileUsage; /*0C0*/<br /> DWORD PeakVirtualSize; /*0C4*/<br /> LARGE_INTEGER VirtualSize; /*0C8*/          MUST BE CREATED &#40;8 BYTES&#41;<br /> MMSUPPORT Vm; /*0D0*/                  MUST VERIFY<br /> DWORD d100; /*100*/<br /> DWORD d104; /*104*/<br /> DWORD d108; /*108*/<br /> DWORD d10C; /*10C*/<br /> DWORD d110; /*110*/<br /> DWORD d114; /*114*/<br /> DWORD d118; /*118*/<br /> DWORD d11C; /*11C*/<br /> DWORD DebugPort; /*120*/<br /> DWORD ExceptionPort; /*124*/<br /> DWORD lpObjectTable; /*128*/           HAND MODIFIED to lp<br /> DWORD Token; /*12C*/<br /> FAST_MUTEX WorkingSetLock; /*130*/     BIG STRUCT! MUST VERIFY<br /> DWORD WorkingSetPage; /*150*/<br /> BYTE ProcessOutswapEnabled; /*154*/<br /> BYTE ProcessOutswapped; /*155*/<br /> BYTE AddressSpaceInitialized; /*156*/<br /> BYTE AddressSpaceDeleted; /*157*/<br /> FAST_MUTEX AddressCreationLock; /*158*/     BIT STRUCT MUST VERIFY<br /> DWORD HyperSpaceLock; /*178*/               Hand modified &#40;should verify&#41;<br /> DWORD ForkInProgress; /*17C*/<br /> WORD VmOperation; /*180*/<br /> BYTE ForkWasSuccessful; /*182*/<br /> BYTE MmAgressiveWsTrimMask; /*183*/<br /> DWORD VmOperationEvent; /*184*/<br /> DWORD PageDirectoryPte; /*188*/             Hand modified &#40;should verify&#41;<br /> DWORD LastFaultCount; /*18C*/<br /> DWORD ModifiedPageCount; /*190*/<br /> DWORD VadRoot; /*194*/<br /> DWORD VadHint; /*198*/<br /> DWORD CloneRoot; /*19C*/<br /> DWORD NumberOfPrivatePages; /*1A0*/<br /> DWORD NumberOfLockedPages; /*1A4*/<br /> WORD NextPageColor; /*1A8*/<br /> BYTE ExitProcessCalled; /*1AA*/<br /> BYTE CreateProcessReported; /*1AB*/<br /> DWORD SectionHandle; /*1AC*/<br /> DWORD lpPeb; /*1B0*/          Hand modified to lpPeb...<br /> DWORD SectionBaseAddress; /*1B4*/<br /> DWORD QuotaBlock; /*1B8*/                   Hand modified &#40;should verify&#41;<br /> DWORD LastThreadExitStatus; /*1BC*/         Hand modified &#40;should verify&#41;<br /> DWORD WorkingSetWatch; /*1C0*/<br /> DWORD Win32WindowStation; /*1C4*/<br /> DWORD InheritedFromUniqueProcessId; /*1C8*/<br /> DWORD GrantedAccess; /*1CC*/                Hand modified &#40;should verify&#41;<br /> DWORD DefaultHardErrorProcessing; // HEM_* /*1D0*/<br /> DWORD LdtInformation; /*1D4*/<br /> DWORD VadFreeHint; /*1D8*/<br /> DWORD VdmObjects; /*1DC*/<br /> DWORD DeviceMap; // 0x24 bytes /*1E0*/<br /> DWORD SessionId; /*1E4*/<br /> DWORD d1E8; /*1E8*/<br /> DWORD d1EC; /*1EC*/<br /> DWORD d1F0; /*1F0*/<br /> DWORD d1F4; /*1F4*/<br /> DWORD d1F8; /*1F8*/<br /> BYTE ImageFileName &#91;16&#93;; /*1FC*/<br /> DWORD VmTrimFaultValue; /*20C*/<br /> BYTE SetTimerResolution; /*210*/<br /> BYTE PriorityClass; /*211*/<br /> <br /> union ;/*212*/<br />  struct <br />    BYTE SubSystemMinorVersion; /*212*/<br />    BYTE SubSystemMajorVersion; /*213*/<br />  ends<br />  struct <br />    WORD SubSystemVersion; /*212*/<br />  ends<br /> ends<br /><br /> DWORD lpWin32Process    ; /*214*/      HAND MODIFIED!!<br /> DWORD d218; /*218*/<br /> DWORD d21C; /*21C*/<br /> DWORD d220; /*220*/<br /> DWORD d224; /*224*/<br /> DWORD d228; /*228*/<br /> DWORD d22C; /*22C*/<br /> DWORD Wow64; /*230*/<br /> DWORD d234; /*234*/<br /> IO_COUNTERS IoCounters; /*238*/   BIT STRUCT!! VERIFY IT<br /> DWORD d268; /*268*/<br /> DWORD d26C; /*26C*/<br /> DWORD d270; /*270*/<br /> DWORD d274; /*274*/<br /> DWORD d278; /*278*/<br /> DWORD d27C; /*27C*/<br /> DWORD d280; /*280*/<br /> DWORD d284; /*284*/<br />ENDS ; /*288*/<br /><br />EPROCESS_ equ sizeof EPROCESS           ; pretty useless in my opinion... &#58;&#41;<br /></code></pre><br /><br />Things to look for:<ul><br />[*]KPROCESS<br />[*]NTSTATUS <br />[*]KEVENT <br />[*]LIST_ENTRY<br />[*]MMSUPPORT<br />[*]FAST_MUTEX<br />[*]IO_COUNTERS<br /><br />These NEED to be defined to get this struct to work.  I have no time to hunt them down for you, or if they are even in Windows.inc...  At any rate they are probably in your other headers somewhere (all convolutied with C++ crap :) ).<br /><br />The <strong>LARGE_INTEGER</strong> i didnt want to change right away.  You should verify its uses before making a struct for it, but i was about to define:<br /><pre><code>LARGE_INTEGER struct<br />   a DWORD<br />   b DWORD<br />LARGE_INTEGER ends</code></pre><br />I have a hunch its only needed for its size, and this struct would never actually be *used* in code.<br /><br />Things marked hand modified was my once over after done macro'n it to death :)  They are mostly fancy C++ lables that (i think) wont amount to nothing in MASM, so they were converted to DWORD's...  they shouldnt cause you grief, but if they do, i've marked them so you'll know it was me :)<br /><br />Aside from that... consider it a x-max gift :grin:<br />NaN</div>
    <div class="meta">Posted on 2001-12-03 01:52:36 by NaN</div>
   </div>
   <div class="post" id="post-13827">
    <div class="subject"><a href="#post-13827">_EPROCESS struct anyone ?</a></div>
    <div class="body">NaN, trust me, 64bit integers *are* used in the NT kernel. How do<br />you think they'd support the 64GB ram the x86 supports since the<br />ppro core? :).<br /><br />Good luck FCE2... I'd code NT kernel stuff in (pure) C with asm where<br />&quot;absolutely necessary&quot; (or where it makes my life *easier*). But<br />if you really want to go asm, I guess I can't stop you ;).</div>
    <div class="meta">Posted on 2001-12-03 03:11:22 by f0dder</div>
   </div>
   <div class="post" id="post-13859">
    <div class="subject"><a href="#post-13859">_EPROCESS struct anyone ?</a></div>
    <div class="body">f0dder,<br /><br /> Didnt know any of that ;) .  Thanx (Im really NT illiterate.)<br /><br />NaN</div>
    <div class="meta">Posted on 2001-12-03 10:24:05 by NaN</div>
   </div>
   <div class="post" id="post-13898">
    <div class="subject"><a href="#post-13898">_EPROCESS struct anyone ?</a></div>
    <div class="body">WOW ! Big Thanks NAN ! <br /><br />I feel embarassed now, I should have done this myself. I'll take a look at UltraEdits Macro feature and hopefully be able to convert the rest of those structs on my own. Once my KMD reaches 'production stability' I will contribute something to masm32, I think I should give something back for all the useful information I've picked up in these forums.<br /><br />Thanks again.</div>
    <div class="meta">Posted on 2001-12-03 19:15:28 by jmp $FCE2</div>
   </div>
   <div class="post" id="post-13940">
    <div class="subject"><a href="#post-13940">_EPROCESS struct anyone ?</a></div>
    <div class="body"><div class="quote">When you're done, are ya gonna donate it to MASM32 7.1 </div> <br /><br />All:<br /><br />Here is my controbution, which compiles under MASM32.  The attached file is an include file that I use for Windows 2000/XP system internal structures.<br /><br />Hope they are of use.<br /><br />BTW:<br /><br />If anyone improves upon the include file, please post a copy.  <br /><br />Thanks.</div>
    <div class="meta">Posted on 2001-12-04 13:14:58 by madprgmr</div>
   </div>
   <div class="post" id="post-13987">
    <div class="subject"><a href="#post-13987">_EPROCESS struct anyone ?</a></div>
    <div class="body">Awesome !!!! <br /><br />When / if I add enough useful stuff I will post it here. :alright:</div>
    <div class="meta">Posted on 2001-12-05 00:50:10 by jmp $FCE2</div>
   </div>
   <div class="post" id="post-14014">
    <div class="subject"><a href="#post-14014">_EPROCESS struct anyone ?</a></div>
    <div class="body">Here's a question to madprgmr :<br /><br />This struct is taken from your .inc file<br /><br />KAPC_STATE Struct<br />    ApcListHead             LIST__ENTRY 2 DUP (&lt;?&gt;)<br />    kapcProcess             pKPROCESS           ?;<br />    KernelApcInProgress     BYTE                ?;<br />    KernelApcPending        BYTE                ?;<br />    UserApcPending          BYTE                ?;<br />KAPC_STATE ENDS<br /><br />That would make KAPC_STATE 23 bytes. Are you sure that this is correct ? I suspect there's a 'padding' byte missing somewhere (after UserApcPending  ?)</div>
    <div class="meta">Posted on 2001-12-05 06:31:43 by jmp $FCE2</div>
   </div>
   <div class="post" id="post-14044">
    <div class="subject"><a href="#post-14044">_EPROCESS struct anyone ?</a></div>
    <div class="body"><div class="quote">That would make KAPC_STATE 23 bytes. Are you sure that this is correct ? I suspect there's a 'padding' byte missing somewhere </div> <br /><br />jmp $FCE2, thanks pointing this out as you are correct.  While going back to fix this little error I also noticed a type in my <br />KTHREAD Struct which I am in the process of fixing.  Once verified I will post the new include file.<br /><br />Sorry for any problems that the above mentioned errors may have caused anyone.</div>
    <div class="meta">Posted on 2001-12-05 12:01:20 by madprgmr</div>
   </div>
   <div class="post" id="post-14050">
    <div class="subject"><a href="#post-14050">_EPROCESS struct anyone ?</a></div>
    <div class="body">I just found out that M$ seems to have changed EPROCESS for XP. In my driver I rely on ActiveProcessLinks.Flink being at offset A0h.<br /><br />This is output from running my Driver on XP :<br /><br />PsInitialSystemProcess: 0xF8AD2BE4<br />EPROCESS Link: 0x80547C54 	<br />EPROCESS: 0x823CE838 	<br />ActiveProcessLinks.Flink: 0x00000000 	<br /><br />whereas the W2K output looks like :<br /><br />PsInitialSystemProcess: 0xEB922BE4 <br />EPROCESS Link: 0x8046CDA8 <br />EPROCESS: 0xF858C6E0 <br />ActiveProcessLinks.Flink: 0x8046DBE0 <br /><br />Apparently ActiveProcessLinks.Flink is not under XP where it is on W2K and unfortunately I do not have the XPDDK to check the 'new' layout of EPROCESS.<br /><br />Can anybody help ?</div>
    <div class="meta">Posted on 2001-12-05 13:46:26 by jmp $FCE2</div>
   </div>
   <div class="post" id="post-14063">
    <div class="subject"><a href="#post-14063">_EPROCESS struct anyone ?</a></div>
    <div class="body"><div class="quote">Can anybody help ?</div> <br /><br />I am currently working on a complete WinXP internals include file.  As to the Win2K one that I posted on Tue; here is the corrected version.<br /><br />As always, please let me know if you improve upon the file or find any other &quot;Stupid programmer&quot; bugs <br /><br />:grin:</div>
    <div class="meta">Posted on 2001-12-05 16:21:58 by madprgmr</div>
   </div>
   <div class="post" id="post-14111">
    <div class="subject"><a href="#post-14111">_EPROCESS struct anyone ?</a></div>
    <div class="body">Thanks alot. A friend of mine works for a software company and they've got an MSDN subscription. I asked him to look for the XP DKK and as soon as he gets back to me with the informarion, I'll post it here.</div>
    <div class="meta">Posted on 2001-12-06 01:47:35 by jmp $FCE2</div>
   </div>
   <div class="post" id="post-14139">
    <div class="subject"><a href="#post-14139">_EPROCESS struct anyone ?</a></div>
    <div class="body">No problem.  I am just about finished with a major update to the third installment of Win2KInternals.inc.  After I complete it, I am moving on to the XP version.<br /><br />BTW:<br /><br />Does anyone know what the procedure is for submitting include files for use in Masm32?</div>
    <div class="meta">Posted on 2001-12-06 09:11:40 by madprgmr</div>
   </div>
   <div class="post" id="post-14181">
    <div class="subject"><a href="#post-14181">_EPROCESS struct anyone ?</a></div>
    <div class="body">Ok....here is two days worth of work (I have tried my best to verify that all structs are of the proper size).<br /><br />For this version, here is what has been done:<br /><br /> Rev 1.02 - 12/06/01: Modified/Added<br />   - MODIFIED:<br />       WORKING_SET Struct<br />       FAST_MUTEX<br />       EPROCESS<br />       HARDWARE_PTE_X86<br />   - ADDED:<br />       WSLE_HASH,<br />       HANDLE_TABLE,<br />       ERESOURCE,<br />       HANDLE_TABLE_ENTRY,<br />       OWNER_ENTRY,<br />       PEB,<br />       PEB_LDR_DATA,<br />       UNICODE_STRING,<br />       EPROCESS_QUOTA_BLOCK,<br />       PROCESS_WS_WATCH_INFORMATION,<br />       PAGEFAULT_HISTORY,<br />       EJOB,<br />       IO_COUNTERS,<br />       WOW64_PROCESS,<br />       RTL_BITMAP,<br />       PS_JOB_TOKEN_FILTER,<br />       SID_AND_ATTRIBUTES,<br />       LUID,<br />       PS_IMPERSONATION_INFORMATION,<br />       DEVICE_OBJECT,<br />       WAIT_CONTEXT_BLOCK,<br />       DEVICE_OBJECT,<br />       KDPC,<br />       POWER_CHANNEL_SUMMARY,<br />       DEVICE_OBJECT_POWER_EXTENSION,<br />       DEVOBJ_EXTENSION,<br />       KDEVICE_QUEUE,<br />       IO_TIMER,<br />       VPB,<br />       IO_STATUS_BLOCK,<br />       _IRP,<br />       MDL,<br />       IO_STACK_LOCATION,<br />       UNICODE_STRING,<br />       CURDIR,<br />       RTL_DRIVE_LETTER_CURDIR,<br />       STRING,<br />       RTL_USER_PROCESS_PARAMETERS,<br />       PEB_FREE_BLOCK,<br />       PS_JOB_TOKEN_FILTER,<br />       EXCEPTION_REGISTRATION_RECORD,<br />       KTRAP_FRAME,<br />       DRIVER_OBJECT,<br />       DRIVER_EXTENSION,<br />       FAST_IO_DISPATCH,<br />       IO_CLIENT_EXTENSION,<br />       FILE_OBJECT,<br />       SECTION_OBJECT_POINTERS,<br />       NAMED_PIPE_CREATE_PARAMETERS,<br />       MAILSLOT_CREATE_PARAMETERS,<br />       SID_IDENTIFIER_AUTHORITY,<br />       FILE_GET_QUOTA_INFORMATION,<br />       KQUEUE,<br />       INTERFACE,<br />       DEVICE_CAPABILITIES,<br />       IO_RESOURCE_REQUIREMENTS_LIST,<br />       IO_RESOURCE_LIST,<br />       IO_RESOURCE_DESCRIPTOR,<br />       POWER_SEQUENCE,<br />       CM_FULL_RESOURCE_DESCRIPTOR,<br />       CM_RESOURCE_LIST,<br />       CM_PARTIAL_RESOURCE_LIST,<br />       CM_PARTIAL_RESOURCE_DESCRIPTOR<br /><br />--<br /><br />As always, please let me know if you have any comments or suggestions.</div>
    <div class="meta">Posted on 2001-12-06 16:53:22 by madprgmr</div>
   </div>
   <div class="post" id="post-14184">
    <div class="subject"><a href="#post-14184">_EPROCESS struct anyone ?</a></div>
    <div class="body">I really appreciate your work ! Great stuff.</div>
    <div class="meta">Posted on 2001-12-06 17:54:14 by jmp $FCE2</div>
   </div>
   <div class="post" id="post-14277">
    <div class="subject"><a href="#post-14277">_EPROCESS struct anyone ?</a></div>
    <div class="body">jmp $FCE2:<br /><br />I just noticed another stupid programmer bug, this one has to do with the RECORD field (sorry for all of the bugs - I should have taken more breaks while working on it).<br /><br />:stupid: <br /><br />The bug has to do with the fileds in the RECORD are in backwards order.  Here is the corrected version of those var's (just cut and paste):<br /><br />unnamed11_Bits RECORD uBaseHi:8, uGranularity:1, uDefault_Big:1, uReserved_0:1, uSys:1, uLimitHi:4, uPres:1, uDpl:2, uType:5, BaseMid:8<br /><br />MMSUPPORT_FLAGS RECORD Filler:25, WriteWatch:1,  WorkingSetHard:1,  TrimHard:1, SessionLeader:1,  ProcessInSession:1,  BeingTrimmed:1, SessionSpace:1<br /><br />_HARDWARE_PTE_X86  RECORD PageFrameNumber:20,  Reserved_1:1, Prototype:1, CopyOnWrite:1, Global:1, LargePage:1, Dirty:1, Accessed:1, CacheDisable:1, WriteThrough:1, Owner:1, Write:1, Valid:1<br /><br />DC_BITS Record dcReserved:15, WarmEjectSupported:1,  NonDynamic:1,  HardwareDisabled:1, WakeFromD3:1, WakeFromD2:1, WakeFromD1:1, WakeFromD0:1, SurpriseRemovalOK:1, RawDeviceOK:1, SilentInstall:1, UniqueID:1, DockDevice:1, Removable:1, EjectSupported:1, LockSupported:1, DeviceD2:1, DeviceD1:1,</div>
    <div class="meta">Posted on 2001-12-07 14:03:20 by madprgmr</div>
   </div>
   <div class="post" id="post-14317">
    <div class="subject"><a href="#post-14317">_EPROCESS struct anyone ?</a></div>
    <div class="body">I've gotten my hands on the DDK for XP finally. Yet I had no chance to install it because I'm not going to mess with XP on my development machine. In the meantime I've rewritten parts of my driver using only &quot;official&quot; ntoskrnl structs and calls. Eventually I will have to look at EPROCESS again. Hopefully I'm able to post XP structs next week.</div>
    <div class="meta">Posted on 2001-12-08 03:49:54 by jmp $FCE2</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=2172&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=2172&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="2172" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=2172&amp;page=2">&gt;</a><a href="../?id=2172&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>