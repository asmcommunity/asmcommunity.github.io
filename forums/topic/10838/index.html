<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How To Load And Display A Jpeg - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10838" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10838">How To Load And Display A Jpeg</a></p>
   <div class="post" id="post-81653">
    <div class="subject"><a href="#post-81653">How To Load And Display A Jpeg</a></div>
    <div class="body">Hi to Every body, I have a question about loading a JPEG image from a file and displaying it on a window; I being searching the web for accouple hours but have not found too much, all i know is the windows has a build-in librery called Ole32.dll and Ole32pro.dll that have a few functions for this, the must important functions are: CreateStreamOnHGlobal and OleLoadPicture with does two and some more you should be able to do it, but I don't know how to use them and I don't have the value for IID_IPicture variable, I found a sample in <a target="_blank" href="http://ourworld.compuserve.com/home...ies_world/a.htm">http://ourworld.compuserve.com/home...ies_world/a.htm</a> but is made for MASM not FASM and FASM doesn't have coinvoke macro and the .if macro doesn't work (but that's not a big problem).<br /><br />What I'm trying to do is include the JPEG file in the resource section and then use the LoadBitmap to get the image handle and then pass it to CreatePatternBrush to create a brush with the image to use it as a Window default background; here is the code for that (it works but only with BMP files).<br /><br /><br />invoke LoadBitmap,,IDB_ASSIGN<br />invoke CreatePatternBrush,eax<br />mov ,eax<br /><br /><br />COULD SOME BODY HELP ME PLEASE!!!</div>
    <div class="meta">Posted on 2003-02-13 18:37:10 by alonso</div>
   </div>
   <div class="post" id="post-81695">
    <div class="subject"><a href="#post-81695">How To Load And Display A Jpeg</a></div>
    <div class="body">I see your new and willing to search first ;)<br /><br />So i will point out this board also has a good search engine in it.  This link was found in a seach on this board:<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=4239&amp;highlight=OleLoadPicture">http://www.asmcommunity.net/board/index.php?topic=4239&amp;highlight=OleLoadPicture</a><br /><br />It has pretty well all your looking for... Ernie has alread been down this road a couple of times :alright:<br /><br />NaN</div>
    <div class="meta">Posted on 2003-02-13 22:44:48 by NaN</div>
   </div>
   <div class="post" id="post-81706">
    <div class="subject"><a href="#post-81706">How To Load And Display A Jpeg</a></div>
    <div class="body">NaN is right: Ernie wrote a library called ImageLib, IIRC that loads gif, jpeg, etc...<br />There is an example in the latest MASM32 package...</div>
    <div class="meta">Posted on 2003-02-14 00:54:00 by JCP</div>
   </div>
   <div class="post" id="post-81710">
    <div class="subject"><a href="#post-81710">How To Load And Display A Jpeg</a></div>
    <div class="body">Also my SOL Raytracer (find it with sourcecode in Games Programming forum section) has a routine that loads JPEG and temporary paints it over window (for testing) ... the routine is in \jpeg subfolder in TASM style but i am sure you can convert it easy to MASM or FASM . Based on Ernie's research :)</div>
    <div class="meta">Posted on 2003-02-14 01:39:24 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-81717">
    <div class="subject"><a href="#post-81717">How To Load And Display A Jpeg</a></div>
    <div class="body">look at the algorithms thread,  i posted a method to load a jpeg from a resource and return a bitmap handle to it.<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=10798">http://www.asmcommunity.net/board/index.php?topic=10798</a><br /><br /><br />hope this helps</div>
    <div class="meta">Posted on 2003-02-14 02:24:23 by Terab</div>
   </div>
   <div class="post" id="post-82154">
    <div class="subject"><a href="#post-82154">How To Load And Display A Jpeg</a></div>
    <div class="body">alonso: there is a &quot;comcall&quot; macro for FASM that does the same job as &quot;coinvoke&quot;, you can find it in the DDraw example in FASMW package.</div>
    <div class="meta">Posted on 2003-02-16 15:43:41 by Tomasz Grysztar</div>
   </div>
  </div>
 </body>
</html>