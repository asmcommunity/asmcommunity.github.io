<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>is uval bug? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20452" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20452">is uval bug?</a></p>
   <div class="post" id="post-156378">
    <div class="subject"><a href="#post-156378">is uval bug?</a></div>
    <div class="body"><pre><code><br />buffer db '1','7','8','k',0<br /><br />mov eax, uval&#40;addr buffer&#41;<br /></code></pre><br /><br />now eax is 1839<br /><br />but <br /><br /><pre><code><br />buffer db '1','7','8',0<br /><br />mov eax, uval&#40;addr buffer&#41;<br /></code></pre><br /><br />eax is 178<br /><br /></code></pre></div>
    <div class="meta">Posted on 2005-01-28 08:03:33 by jndk</div>
   </div>
   <div class="post" id="post-156379">
    <div class="subject"><a href="#post-156379">is uval bug?</a></div>
    <div class="body">but c fun atoi can work good, <br />why, the vual  fun cannot recognise 'k' ?<br />and is there anther method to solve this problem as you know MASM have not the fun of &quot;atoi&quot;</div>
    <div class="meta">Posted on 2005-01-28 08:07:16 by jndk</div>
   </div>
   <div class="post" id="post-156380">
    <div class="subject"><a href="#post-156380">is uval bug?</a></div>
    <div class="body">The underlying function with the macro is not designed to handle alphabetic characters. You can write them to do that but they are slower. It is designed for unsigned DWORD values.</div>
    <div class="meta">Posted on 2005-01-28 08:10:14 by hutch--</div>
   </div>
   <div class="post" id="post-156382">
    <div class="subject"><a href="#post-156382">is uval bug?</a></div>
    <div class="body">thanks a lot, I'm writing self atoi fun now :roll:</div>
    <div class="meta">Posted on 2005-01-28 08:14:25 by jndk</div>
   </div>
   <div class="post" id="post-156385">
    <div class="subject"><a href="#post-156385">is uval bug?</a></div>
    <div class="body">i write atoi <br /><br />Code: <br /><br />atoi proc uses ebx esi edi lpst:DWORD    <br />   xor ecx, ecx <br />   mov edi, lpst <br />   @@:   movzx esi, BYTE ptr  <br />   .if esi <br />      .if esi=='0' || esi=='1'|| esi=='2'|| esi=='3'|| esi=='4'|| esi=='5'\ <br />         || esi=='6'|| esi=='7'|| esi=='8'|| esi=='9'          <br />         mov eax, ecx <br />         mov ebx, 10 <br />         mul ebx          <br />         add eax, esi <br />         sub eax, '0' <br />         mov ecx, eax       <br />      .else <br />         mov eax, ecx <br />         ret <br />      .endif <br />      inc edi <br />      jmp @B <br />   .endif <br />   mov eax,ecx <br />   ret <br />atoi endp   :oops:</div>
    <div class="meta">Posted on 2005-01-28 08:33:11 by jndk</div>
   </div>
  </div>
 </body>
</html>