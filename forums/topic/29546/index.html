<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Interrupt hooking - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29546" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=113">Low Level Concepts</a> &raquo; <a href="../?id=29546">Interrupt hooking</a></p>
   <div class="post" id="post-208687">
    <div class="subject"><a href="#post-208687">Interrupt hooking</a></div>
    <div class="body">hello all<br /><br />please help me in starting a interrupt hooking program<br /><br />for checking if a file is opened in read/write mode<br />and do some thing<br /><br />thanx</div>
    <div class="meta">Posted on 2009-09-10 05:28:38 by aloksaini</div>
   </div>
   <div class="post" id="post-208688">
    <div class="subject"><a href="#post-208688">Re: Interrupt hooking</a></div>
    <div class="body">Look up SetWindowsHookEx at msdn and google for some code.<br />http://msdn.microsoft.com/en-us/library/ms644990(VS.85).aspx</div>
    <div class="meta">Posted on 2009-09-10 14:48:00 by GoldStar611</div>
   </div>
   <div class="post" id="post-208692">
    <div class="subject"><a href="#post-208692">Re: Interrupt hooking</a></div>
    <div class="body">Wrong answer - he wants to hook BIOS Interrupts - you can&#039;t use any Windows API to do that - in particular, he wants to know how to hook INT 13.<br /><br />Writing interrupt hooks is quite easy - installing interrupt hooks under NT systems is not so straightforward.<br />Care to elaborate apon what you are trying to achieve?<br /><br /></div>
    <div class="meta">Posted on 2009-09-11 00:03:36 by Homer</div>
   </div>
   <div class="post" id="post-208698">
    <div class="subject"><a href="#post-208698">Re: Interrupt hooking</a></div>
    <div class="body">ya homer is write<br /><br />i want to hook 13h function in bios mode<br /><br />please help me<br /><br />give some code<br />please</div>
    <div class="meta">Posted on 2009-09-11 10:35:38 by aloksaini</div>
   </div>
   <div class="post" id="post-208699">
    <div class="subject"><a href="#post-208699">Re: Interrupt hooking</a></div>
    <div class="body"><br />The interrupt table is stored in what they call &#039;zero page&#039; memory - that means it begins at address 0.<br />What you need to do is read the pointer that is currently stored in the table for interrupt 13.<br />This pointer is currently pointing to the &#039;OLD&#039; interrupt handler code.<br /><br />Now write your chunk of code (your &#039;NEW&#039; interrupt handler), at the end of your code you need to jump to the OLD handler, whose address you obtained earlier.<br /><br />Finally, overwrite the OLD pointer in the interrupt table with the address of your NEW handler.<br /><br /></div>
    <div class="meta">Posted on 2009-09-11 10:44:42 by Homer</div>
   </div>
   <div class="post" id="post-208738">
    <div class="subject"><a href="#post-208738">Re: Interrupt hooking</a></div>
    <div class="body">i have writed the code<br /><br />but i want to know<br /><br />what is the scope of this handler<br /><br />means it will active for till my application is running<br />or i have to make my program a tsr</div>
    <div class="meta">Posted on 2009-09-13 07:35:00 by aloksaini</div>
   </div>
   <div class="post" id="post-208744">
    <div class="subject"><a href="#post-208744">Re: Interrupt hooking</a></div>
    <div class="body"><div class="quote"><br />ya homer is write<br /><br />i want to hook 13h function in bios mode<br /><br />please help me<br /><br />give some code<br />please<br /></div><br /><br />Can you show us what you have written so far ?<br /><br />Could you try to put some punctuation in your sentences.<br /><br />Thanks.<br /><br /></div>
    <div class="meta">Posted on 2009-09-13 13:37:01 by skywalker</div>
   </div>
   <div class="post" id="post-208748">
    <div class="subject"><a href="#post-208748">Re: Interrupt hooking</a></div>
    <div class="body">I guess you&#039;re trying to do this under DOS? Makes no sense if under Windows, anyway.<br /><br />For DOS, yeah, you will have to make your program TSR, or write it as a device driver.</div>
    <div class="meta">Posted on 2009-09-13 16:04:48 by f0dder</div>
   </div>
   <div class="post" id="post-208766">
    <div class="subject"><a href="#post-208766">Re: Interrupt hooking</a></div>
    <div class="body"><pre><code><br />;here is the program for handling interrupt 21h<br />.model small&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;declare model small<br />.stack 100h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; declare 100h long stack<br />.data&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;data segment here<br />old_int_segment dw ?&nbsp; &nbsp; &nbsp; &nbsp; ;variable for storing int segment address <br />old_int_offset dw ?&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;variable for storing int offset address<br />.code&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; code segment start here<br />start:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; start label<br />mov ah,35h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;35h function in ah for <br />mov al,21h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; interrupt number for getting its address<br />int 21&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;go do it<br />mov old_int_segment,es&nbsp; &nbsp;  ; save the segment address<br />mov old_int_offset,bx&nbsp; &nbsp; &nbsp; &nbsp;  ; save the offset address<br />mov ah,25h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;function for setting handler<br />mov al,21h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; interrupt function to change handler<br />mov dx,offset int_21 handler&nbsp; ; address of the new handler<br />int 21&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;go do it<br />int_21_handler:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;hanler of int<br />.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; do any thing<br />.<br />.<br />db 0eah&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;for jmping in real int handler<br />.<br />.<br />.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;exit<br /></code></pre><br /><br />help me to make this making tsr<br /><br />thanxxxx</div>
    <div class="meta">Posted on 2009-09-14 07:59:34 by aloksaini</div>
   </div>
   <div class="post" id="post-208767">
    <div class="subject"><a href="#post-208767">Re: Interrupt hooking</a></div>
    <div class="body">http://www.ctyme.com/intr/rb-2723.htm use that when exiting your program..</div>
    <div class="meta">Posted on 2009-09-14 08:48:31 by lone_samurai5</div>
   </div>
   <div class="post" id="post-208768">
    <div class="subject"><a href="#post-208768">Re: Interrupt hooking</a></div>
    <div class="body">ok DUDE, thats crap.<br /><br />If you were to HOOK int 21, you cant CALL it !!!<br />Self Entrancy!<br /><br />If you HOOKED an interrupt, your hook code needs to call the OLD int handler, NOT generate an interrupt!</div>
    <div class="meta">Posted on 2009-09-14 08:58:04 by Homer</div>
   </div>
   <div class="post" id="post-208785">
    <div class="subject"><a href="#post-208785">Re: Interrupt hooking</a></div>
    <div class="body">then dude show mw how to do that</div>
    <div class="meta">Posted on 2009-09-15 00:44:27 by aloksaini</div>
   </div>
   <div class="post" id="post-208790">
    <div class="subject"><a href="#post-208790">Re: Interrupt hooking</a></div>
    <div class="body">Not going to happen.<br />I really want to teach, I will choose my students.<br />You want to learn machine layer?<br />Show me your work, prove it.<br /></div>
    <div class="meta">Posted on 2009-09-15 03:52:00 by Homer</div>
   </div>
   <div class="post" id="post-208791">
    <div class="subject"><a href="#post-208791">Re: Interrupt hooking</a></div>
    <div class="body"><pre><code><br />;here is the program for handling interrupt 21h<br />.model small&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;declare model small<br />.stack 100h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; declare 100h long stack<br />.data&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;data segment here<br />old_int_segment dw ?&nbsp; &nbsp; &nbsp; &nbsp; ;variable for storing int segment address <br />old_int_offset dw ?&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;variable for storing int offset address<br />.code&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; code segment start here<br />start:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; start label<br />mov ah,35h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;35h function in ah for <br />mov al,21h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; interrupt number for getting its address<br />db 0eah&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;go do it<br />mov old_int_segment,es&nbsp; &nbsp;  ; save the segment address<br />mov old_int_offset,bx&nbsp; &nbsp; &nbsp; &nbsp;  ; save the offset address<br />mov ah,25h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;function for setting handler<br />mov al,21h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; interrupt function to change handler<br />mov dx,offset int_21 handler&nbsp; ; address of the new handler<br />db 0eah&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;go do it<br />mov ah,35h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; make program tsr<br />mov dx,2h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;no of paragraphs<br />db 0eah&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;call old int handler<br />int_21_handler:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;hanler of int<br />.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; do any thing<br />.<br />.<br />db 0eah&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;for jmping in real int handler<br />end start<br /></code></pre><br />is this all right?<br /></div>
    <div class="meta">Posted on 2009-09-15 06:04:53 by aloksaini</div>
   </div>
   <div class="post" id="post-208793">
    <div class="subject"><a href="#post-208793">Re: Interrupt hooking</a></div>
    <div class="body">;&nbsp; div286.asm&nbsp; &nbsp;  Tasm code&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />;&nbsp; &nbsp;  Divide fault interrupt handler&nbsp; AK&nbsp; Jan 2003&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />;&nbsp; &nbsp;  Demonstrated using divfault.exe program<br />;&nbsp; &nbsp;  Removed code specific to Tasm Ideal Mode<br />;&nbsp; &nbsp;  Works thru Win 98 in a Dos box&nbsp; See divfault.asm for demo<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Uses only 848 bytes of memory&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br /><br />.model&nbsp; &nbsp; &nbsp; &nbsp; tiny<br /><br />.code<br /><br />org&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 100h<br /><br />start:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  jmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; begin<br /><br />welcome&nbsp; &nbsp; &nbsp; db&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  13,10, &#039;Divide-Fault Handler Installed&#039; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  13,10, &#039;Address = &#039;,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />string&nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  40 dup(?)<br /><br />divfault&nbsp; &nbsp; proc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  sti<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  bp<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bp,sp<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  si<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  ds<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  lds&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; si,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  lodsw<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  and&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ah,0c0h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ah,0c0h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  @@10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  add word ptr ,2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ,2&nbsp; ; Used in Tasm Ideal Mode<br />@@10:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  add word ptr ,2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ,2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ax,ax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ds<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; si<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bp<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  iret<br />endp&nbsp; &nbsp; &nbsp; &nbsp;  divfault<br /><br />begin:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ax,2500h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dx,offset divfault<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  int&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; di,offset welcome<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call&nbsp; &nbsp; &nbsp; &nbsp;  strwrite<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ax,cs<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call&nbsp; &nbsp; &nbsp; &nbsp;  showax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dl,&#039;:&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ah,2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  int&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ax,offset divfault<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call&nbsp; &nbsp; &nbsp; &nbsp;  showax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call&nbsp; &nbsp; &nbsp; &nbsp;  newline<br />exit:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dx,offset begin<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  int&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 27h<br /><br />showax&nbsp; &nbsp; &nbsp;  proc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cx,4<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; di,offset string<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call&nbsp; &nbsp; &nbsp; &nbsp;  bintoaschex<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call&nbsp; &nbsp; &nbsp; &nbsp;  strwrite<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ret<br />endp&nbsp; &nbsp; &nbsp; &nbsp;  showax<br /><br />bintoaschex&nbsp; proc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  bx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bx,16<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call&nbsp; &nbsp; &nbsp; &nbsp;  numtoascii<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ret<br />endp&nbsp; &nbsp; &nbsp; &nbsp;  bintoaschex<br /><br />numtoascii&nbsp;  proc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  dx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  di<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  si<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; si,si<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  jcxz&nbsp; &nbsp; &nbsp; &nbsp;  @@20<br />@@12:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dx,dx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  div&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call&nbsp; &nbsp; &nbsp; &nbsp;  hexdigit<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  dx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; si<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  loop&nbsp; &nbsp; &nbsp; &nbsp;  @@12<br />@@20:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  inc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  or&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ax,ax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  jnz&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @@12<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cx,si<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  jcxz&nbsp; &nbsp; &nbsp; &nbsp;  @@40<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  cld<br />@@30:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  stosb<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  loop&nbsp; &nbsp; &nbsp; &nbsp;  @@30<br />@@40:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp;  byte ptr ,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; si<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; di<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ret<br />endp&nbsp; &nbsp; &nbsp; &nbsp;  numtoascii<br /><br />hexdigit&nbsp; &nbsp; &nbsp; proc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  cmp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dl,10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  jb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  @@11<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  add&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dl,&#039;A&#039;-10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ret<br />@@11:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  or&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  dl,&#039;0&#039;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ret<br />endp&nbsp; &nbsp; &nbsp; &nbsp;  hexdigit<br /><br />newline&nbsp; &nbsp; &nbsp; proc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ah,2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dl,13<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  int&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dl,10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  int&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ret<br />endp&nbsp; &nbsp; &nbsp; &nbsp;  newline<br /><br />strwrite&nbsp; &nbsp;  proc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  call&nbsp; &nbsp; &nbsp; &nbsp;  strlength<br /><br />strwrite2&nbsp; &nbsp; proc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  ax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  bx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  dx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bx,1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dx,di<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ah,40h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  int&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 21h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; bx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ret<br />endp&nbsp; &nbsp; &nbsp; &nbsp;  strwrite2<br />endp&nbsp; &nbsp; &nbsp; &nbsp;  strwrite<br />strlength&nbsp; &nbsp; &nbsp; proc<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  ax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  push&nbsp; &nbsp; &nbsp; &nbsp;  di<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  xor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; al,al<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cx,0ffffh<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  cld<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  repnz&nbsp; &nbsp; &nbsp; &nbsp; scasb<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  not&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  dec&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; di<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  pop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ret<br />endp&nbsp; &nbsp; &nbsp; &nbsp;  strlength<br />end&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; start<br /><br /></div>
    <div class="meta">Posted on 2009-09-15 09:19:13 by skywalker</div>
   </div>
   <div class="post" id="post-208800">
    <div class="subject"><a href="#post-208800">Re: Interrupt hooking</a></div>
    <div class="body">thanx dude<br /><br />but can you comment it?<br /><br />im a beginner</div>
    <div class="meta">Posted on 2009-09-16 00:34:44 by aloksaini</div>
   </div>
  </div>
 </body>
</html>