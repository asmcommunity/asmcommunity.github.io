<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Problems with ITaskTrigger::SetTrigger - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20345" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=20345">Problems with ITaskTrigger::SetTrigger</a></p>
   <div class="post" id="post-155663">
    <div class="subject"><a href="#post-155663">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">Here's the situation:<br /><br />The C structs:<br /><br /><pre><code><br />typedef enum _TASK_TRIGGER_TYPE <br />&#123; <br />  TASK_TIME_TRIGGER_ONCE  = 0, <br />  TASK_TIME_TRIGGER_DAILY  = 1, <br />  TASK_TIME_TRIGGER_WEEKLY  = 2, <br />  TASK_TIME_TRIGGER_MONTHLYDATE  = 3, <br />  TASK_TIME_TRIGGER_MONTHLYDOW  = 4, <br />  TASK_EVENT_TRIGGER_ON_IDLE  = 5, <br />  TASK_EVENT_TRIGGER_AT_SYSTEMSTART  = 6, <br />  TASK_EVENT_TRIGGER_AT_LOGON  = 7 <br />&#125; TASK_TRIGGER_TYPE, *PTASK_TRIGGER_TYPE; <br /><br />typedef struct _DAILY &#123; <br />  WORD DaysInterval; <br />&#125; DAILY; <br /><br />typedef struct _WEEKLY &#123; <br />  WORD WeeksInterval; <br />  WORD rgfDaysOfTheWeek; <br />&#125; WEEKLY; <br /><br />typedef struct _MONTHLYDATE &#123; <br />  DWORD rgfDays; <br />  WORD rgfMonths; <br />&#125; MONTHLYDATE; <br /><br />typedef struct _MONTHLYDOW &#123; <br />  WORD wWhichWeek; <br />  WORD rgfDaysOfTheWeek; <br />  WORD rgfMonths; <br />&#125; MONTHLYDOW; <br /><br />typedef union _TRIGGER_TYPE_UNION &#123; <br />  DAILY Daily; <br />  WEEKLY Weekly; <br />  MONTHLYDATE MonthlyDate; <br />  MONTHLYDOW MonthlyDOW; <br />&#125; TRIGGER_TYPE_UNION; <br /><br />typedef struct _TASK_TRIGGER &#123; <br />  WORD cbTriggerSize; <br />  WORD Reserved1; <br />  WORD wBeginYear; <br />  WORD wBeginMonth; <br />  WORD wBeginDay; <br />  WORD wEndYear; <br />  WORD wEndMonth; <br />  WORD wEndDay; <br />  WORD wStartHour; <br />  WORD wStartMinute; <br />  DWORD MinutesDuration; <br />  DWORD MinutesInterval; <br />  DWORD rgFlags; <br />  TASK_TRIGGER_TYPE TriggerType; <br />  TRIGGER_TYPE_UNION Type; <br />  WORD Reserved2; <br />  WORD wRandomMinutesInterval; <br />&#125; TASK_TRIGGER, *PTASK_TRIGGER; <br /><br />The way I have them defined&#58;<br /><br />DAILY STRUCT <br />   DaysInterval   WORD ? <br />DAILY ENDS <br /><br />WEEKLY STRUCT <br />   WeeksInterval   WORD ? <br />   rgfDaysOfTheWeek   WORD ? <br />WEEKLY ENDS <br /><br />MONTHLYDATE STRUCT <br />   rgfDays      DWORD ? <br />   rgfMonths   WORD ? <br />MONTHLYDATE ENDS <br /><br />MONTHLYDOW STRUCT <br />   wWhichWeek   WORD ? <br />   rgfDaysOfTheWeek   WORD ? <br />   rgfMonths      WORD ? <br />MONTHLYDOW ENDS <br /><br />TRIGGER_TYPE_UNION UNION <br />   Daily      DAILY &lt;&gt; <br />   Weekly      WEEKLY &lt;&gt; <br />   MonthlyDate   MONTHLYDATE &lt;&gt; <br />   MonthlyDOW   MONTHLYDOW &lt;&gt; <br />TRIGGER_TYPE_UNION ENDS <br /><br />TASK_TRIGGER STRUCT <br />   cbTriggerSize   WORD ? <br />   Reserved1      WORD ? <br />   wBeginYear   WORD ? <br />   wBeginMonth   WORD ? <br />   wBeginDay   WORD ? <br />   wEndYear      WORD ? <br />   wEndMonth   WORD ? <br />   wEndDay      WORD ? <br />   wStartHour   WORD ? <br />   wStartMinute   WORD ? <br />   MinutesDuration   DWORD ? <br />   MinutesInterval   DWORD ? <br />   rgFlags      DWORD ? <br />   TriggerType   DWORD ? <br />   TypeT      TRIGGER_TYPE_UNION &lt;&gt; <br />   Reserved2      WORD ? <br />   wRandomMinutesInterval     WORD ? <br />TASK_TRIGGER ENDS <br />PTASK_TRIGGER TYPEDEF PTR TASK_TRIGGER<br /></code></pre><br /><br />I'm using TypeT instead of Type, since I get an error if I use Type.<br />I have TriggerType defined as a DWORD.<br /><br />Here is the C code I'm dealing with:<br /><br /><pre><code><br />HRESULT SetTrigger&#40;<br />  const PTASK_TRIGGER pTrigger<br />&#41;;<br /><br />Here is my Problem area&#58;<br /><br />	INVOKE	RtlZeroMemory,ADDR Trigger,SIZEOF TASK_TRIGGER<br /><br />	mov	Trigger.cbTriggerSize,SIZEOF TASK_TRIGGER<br />	mov	Trigger.wBeginYear,2005<br />	mov	Trigger.wBeginMonth,1<br />	mov	Trigger.wBeginDay,12<br />	mov	Trigger.MinutesInterval,5<br />	mov	Trigger.TriggerType,TASK_TRIGGER_TYPE_TASK_TIME_TRIGGER_DAILY<br />	mov	Trigger.TypeT.Daily.DaysInterval,1<br />	mov	Trigger.wStartHour,13<br />	mov	Trigger.wStartMinute,45<br /><br />	mov	edx,stTaskTrigger<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITaskTrigger PTR &#91;edx&#93;&#41;.SetTrigger,stTaskTrigger,ADDR Trigger<br /><br />	cmp	eax,S_OK<br />	jne	MT003<br /><br /></code></pre><br /><br />Everything works if I take out the SetTrigger function. It makes a task object with no trigger. Ain't that great. :-)<br />I did notice in the C code the pointer to the TASK_TRIGGER is a const!!!<br /><br />The error I get is E_INVALIDARG.<br /><br />Anyhow this is my situation. Any help would be greatly appreciated.<br /><br />Thanks for your time and consideration,<br /><br />Darrel</div>
    <div class="meta">Posted on 2005-01-12 17:14:43 by Darrel</div>
   </div>
   <div class="post" id="post-155670">
    <div class="subject"><a href="#post-155670">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">Greetings, <br />I suggest following the steps provided in the link <a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/taskschd/taskschd/creating_a_new_trigger.asp">Creating a New Trigger</a>, and then implement the code sample referenced at the end of the page.</div>
    <div class="meta">Posted on 2005-01-12 19:42:01 by Poimander</div>
   </div>
   <div class="post" id="post-155671">
    <div class="subject"><a href="#post-155671">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">Greetings,<br /><br />The link you gave me is where I have been reading. I'm not understanding the const pointer they're using in the <a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/taskschd/taskschd/itasktrigger_settrigger.asp">ITaskTrigger::SetTrigger</a> method.<br /><br />Thanks again,<br /><br />Darrel</div>
    <div class="meta">Posted on 2005-01-12 20:17:50 by Darrel</div>
   </div>
   <div class="post" id="post-155674">
    <div class="subject"><a href="#post-155674">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">(1) <div class="quote">The link you gave me is where I have been reading.</div><br />I thought that was the case. <br /><br />(2) <div class="quote">I'm not understanding the const pointer they're using in the ITaskTrigger::SetTrigger method. </div><br />Look at the prototype of ITaskTrigger::SetTrigger -- the argument is of type PTASK_TRIGGER, i.e. a pointer to a TASK_TRIGGER structure. Don't worry<br />about the 'const' keyword. <br /><br />This is your mistake --&gt;<br /> <div class="quote"><br /> mov   edx, stTaskTrigger<br /> mov   edx, <br /></div><br /><br />you're using the wrong pointer! The pointer you should be using here is the one obtained from a previous call to ITask::CreateTrigger as exhibited in C/C++ code example.</div>
    <div class="meta">Posted on 2005-01-12 20:41:37 by Poimander</div>
   </div>
   <div class="post" id="post-155676">
    <div class="subject"><a href="#post-155676">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">This is the pointer I'm using:<br /><br /><pre><code>	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.CreateTrigger,stTask,ADDR NewTrigger,ADDR stTaskTrigger<br /><br />	cmp	eax,S_OK<br />	jne	MT002<br /><br />	INVOKE	RtlZeroMemory,ADDR Trigger,SIZEOF TASK_TRIGGER<br /><br />	mov	Trigger.cbTriggerSize,SIZEOF TASK_TRIGGER<br />	mov	Trigger.wBeginYear,2005<br />	mov	Trigger.wBeginMonth,1<br />	mov	Trigger.wBeginDay,12<br />	mov	Trigger.MinutesInterval,5<br />	mov	Trigger.TriggerType,TASK_TRIGGER_TYPE_TASK_TIME_TRIGGER_DAILY<br />	mov	Trigger.TypeT.Daily.DaysInterval,1<br />	mov	Trigger.wStartHour,13<br />	mov	Trigger.wStartMinute,45<br /><br />	mov	edx,stTaskTrigger<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITaskTrigger PTR &#91;edx&#93;&#41;.SetTrigger,stTaskTrigger,ADDR Trigger<br /><br />	cmp	eax,S_OK<br />	jne	MT003<br /></code></pre><br />I'm not seeing the fault in my logic.<br /><br />Darrel</div>
    <div class="meta">Posted on 2005-01-12 20:56:04 by Darrel</div>
   </div>
   <div class="post" id="post-155679">
    <div class="subject"><a href="#post-155679">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">Actually I am in error here -- your code looks, on the face, it correct! However you may have a minor error elsewhere in your code -- or even in<br />of one your header files. If you could upload the code one of us should be able to find the error.</div>
    <div class="meta">Posted on 2005-01-12 21:18:47 by Poimander</div>
   </div>
   <div class="post" id="post-155680">
    <div class="subject"><a href="#post-155680">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">OK<br /><br /><pre><code><br />MakeTask PROC<br />	LOCAL	stTaskScheduler<br />	LOCAL	stTask<br />	LOCAL	stTaskTrigger<br />	LOCAL	stPersistFile<br />	LOCAL	Trigger&#58;TASK_TRIGGER<br /><br />	INVOKE	CoInitialize,NULL<br /><br />	INVOKE	CoCreateInstance,ADDR CLSID_CTaskScheduler,NULL,CLSCTX_INPROC_SERVER,ADDR IID_ITaskScheduler,ADDR stTaskScheduler<br /><br />	cmp	eax,S_OK<br />	jne	MT000<br /><br />	mov	edx,stTaskScheduler<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITaskScheduler PTR &#91;edx&#93;&#41;.NewWorkItem,stTaskScheduler,ADDR szTaskerW,ADDR CLSID_CTask,ADDR IID_ITask,ADDR stTask<br /><br />	cmp	eax,S_OK<br />	jne	MT001<br /><br />	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.SetCreator,stTask,ADDR szUserNameW<br /><br />	cmp	eax,S_OK<br />	jne	MT002<br /><br />	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.SetFlags,stTask,TASK_FLAG_RUN_ONLY_IF_LOGGED_ON<br /><br />	cmp	eax,S_OK<br />	jne	MT002<br /><br />	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.SetApplicationName,stTask,ADDR szProgramW<br /><br />	cmp	eax,S_OK<br />	jne	MT002<br /><br />	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.SetWorkingDirectory,stTask,ADDR szProgramDirW<br /><br />	cmp	eax,S_OK<br />	jne	MT002<br /><br />	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.SetPriority,stTask,REALTIME_PRIORITY_CLASS<br /><br />	cmp	eax,S_OK<br />	jne	MT002<br /><br />	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.SetMaxRunTime,stTask,INFINITE<br /><br />	cmp	eax,S_OK<br />	jne	MT002<br /><br />	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.SetAccountInformation,stTask,ADDR szComputerNameW,NULL<br /><br />	cmp	eax,S_OK<br />	jne	MT002<br /><br />	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.CreateTrigger,stTask,ADDR NewTrigger,ADDR stTaskTrigger<br /><br />	cmp	eax,S_OK<br />	jne	MT002<br /><br />	INVOKE	RtlZeroMemory,ADDR Trigger,SIZEOF TASK_TRIGGER<br /><br />	mov	Trigger.cbTriggerSize,SIZEOF TASK_TRIGGER<br />	mov	Trigger.wBeginYear,2005<br />	mov	Trigger.wBeginMonth,1<br />	mov	Trigger.wBeginDay,12<br />	mov	Trigger.MinutesInterval,5<br />	mov	Trigger.TriggerType,TASK_TRIGGER_TYPE_TASK_TIME_TRIGGER_DAILY<br />	mov	Trigger.TypeT.Daily.DaysInterval,1<br />	mov	Trigger.wStartHour,13<br />	mov	Trigger.wStartMinute,45<br /><br />	mov	edx,stTaskTrigger<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITaskTrigger PTR &#91;edx&#93;&#41;.SetTrigger,stTaskTrigger,ADDR Trigger<br /><br />	cmp	eax,S_OK<br />	jne	MT003<br /><br />	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.QueryInterface,stTask,ADDR IID_IPersistFile,ADDR stPersistFile<br /><br />	cmp	eax,S_OK<br />	jne	MT003<br /><br />	mov	edx,stPersistFile<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;IPersistFile PTR &#91;edx&#93;&#41;.Save,stPersistFile,NULL,TRUE<br /><br />	mov	edx,stPersistFile<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;IPersistFile PTR &#91;edx&#93;&#41;.Release,stPersistFile<br /><br />MT003&#58;<br />	mov	edx,stTaskTrigger<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITaskTrigger PTR &#91;edx&#93;&#41;.Release,stTaskTrigger<br /><br />MT002&#58;<br />	mov	edx,stTask<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITask PTR &#91;edx&#93;&#41;.Release,stTask<br /><br />MT001&#58;<br />	mov	edx,stTaskScheduler<br />	mov	edx,&#91;edx&#93;<br /><br />	INVOKE	&#40;ITaskScheduler PTR &#91;edx&#93;&#41;.Release,stTaskScheduler<br /><br />MT000&#58;<br />	INVOKE	CoUninitialize<br /><br />	ret<br /><br />MakeTask ENDP<br /></code></pre><br /><br />My concern is using TypeT instead of Type in TASK_TRIGGER STRUCT or my defining TriggerType as a DWORD instead of the ENUM STRUCT.<br /><br />If I omit the SetTrigger function everything is fine, except my task object has no trigger. :-)<br /><br />Here are my Interfaces:<br /><br /><pre><code><br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />externdef		IID_IUnknown&#58;IID<br />LPUNKNOWN		typedef DWORD<br />LPPUNKNOWN		typedef ptr LPUNKNOWN<br /><br />IUnknown_QueryInterfaceProto	typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IUnknown_AddRefProto		typedef proto &#58;DWORD<br />IUnknown_ReleaseProto		typedef proto &#58;DWORD<br /><br />IUnknown_QueryInterface		typedef ptr IUnknown_QueryInterfaceProto<br />IUnknown_AddRef			typedef ptr IUnknown_AddRefProto<br />IUnknown_Release		typedef ptr IUnknown_ReleaseProto<br /><br />IUnknown STRUCT DWORD<br />	QueryInterface	IUnknown_QueryInterface	?<br />	AddRef		IUnknown_AddRef		?<br />	Release		IUnknown_Release	?<br />IUnknown ENDS<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />sCLSID_CTaskScheduler	TEXTEQU		&lt;&#123;0148BD52Ah,0A2ABh,011CEh,&#123;0B1h,01Fh,000h,0AAh,000h,053h,005h,003h&#125;&#125;&gt;<br />sIID_ITaskScheduler	TEXTEQU		&lt;&#123;0148BD527h,0A2ABh,011CEh,&#123;0B1h,01Fh,000h,0AAh,000h,053h,005h,003h&#125;&#125;&gt;<br />sCLSID_CTask		TEXTEQU		&lt;&#123;0148BD520h,0A2ABh,011CEh,&#123;0B1h,01Fh,000h,0AAh,000h,053h,005h,003h&#125;&#125;&gt;<br /><br />LPTASKSCHEDULER		typedef DWORD<br />LPPTASKSCHEDULER	typedef ptr LPTASKSCHEDULER<br /><br />ITaskScheduler_SetTargetComputerProto	typedef proto &#58;DWORD, &#58;DWORD<br />ITaskScheduler_GetTargetComputerProto	typedef proto &#58;DWORD, &#58;DWORD<br />ITaskScheduler_EnumProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITaskScheduler_ActivateProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />ITaskScheduler_DeleteProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITaskScheduler_NewWorkItemProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />ITaskScheduler_AddWorkItemProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />ITaskScheduler_IsOfTypeProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br /><br />ITaskScheduler_SetTargetComputer	typedef ptr ITaskScheduler_SetTargetComputerProto<br />ITaskScheduler_GetTargetComputer	typedef ptr ITaskScheduler_GetTargetComputerProto<br />ITaskScheduler_Enum			typedef ptr ITaskScheduler_EnumProto<br />ITaskScheduler_Activate			typedef ptr ITaskScheduler_ActivateProto<br />ITaskScheduler_Delete			typedef ptr ITaskScheduler_DeleteProto<br />ITaskScheduler_NewWorkItem		typedef ptr ITaskScheduler_NewWorkItemProto<br />ITaskScheduler_AddWorkItem		typedef ptr ITaskScheduler_AddWorkItemProto<br />ITaskScheduler_IsOfType			typedef ptr ITaskScheduler_IsOfTypeProto<br /><br />ITaskScheduler STRUCT DWORD<br />	QueryInterface		IUnknown_QueryInterface			?<br />	AddRef			IUnknown_AddRef				?<br />	Release			IUnknown_Release			?<br />	SetTargetComputer	ITaskScheduler_SetTargetComputer	?<br />	GetTargetComputer	ITaskScheduler_GetTargetComputer	?<br />	Enum			ITaskScheduler_Enum			?<br />	Activate		ITaskScheduler_Activate			?<br />	Delete			ITaskScheduler_Delete			?<br />	NewWorkItem		ITaskScheduler_NewWorkItem		?<br />	AddWorkItem		ITaskScheduler_AddWorkItem		?<br />	IsOfType		ITaskScheduler_IsOfType			?<br />ITaskScheduler ENDS<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />sIID_IScheduledWorkItem		TEXTEQU		&lt;&#123;0a6b952f0h,0a4b1h,011d0h,&#123;099h,07dh,000h,0aah,000h,068h,087h,0ech&#125;&#125;&gt;<br /><br />LPSCHEDULEDWORKITEM		typedef DWORD<br />LPPSCHEDULEDWORKITEM		typedef ptr LPSCHEDULEDWORKITEM<br /><br />IScheduledWorkItem_CreateTriggerProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_DeleteTriggerProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetTriggerCountProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetTriggerProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetTriggerStringProto	typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetRunTimesProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetNextRunTimeProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_SetIdleWaitProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetIdleWaitProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_RunProto			typedef proto &#58;DWORD<br />IScheduledWorkItem_TerminateProto		typedef proto &#58;DWORD<br />IScheduledWorkItem_EditWorkItemProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetMostRecentRunTimeProto	typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetStatusProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetExitCodeProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_SetCommentProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetCommentProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_SetCreatorProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetCreatorProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_SetWorkItemDataProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetWorkItemDataProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_SetErrorRetryCountProto	typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetErrorRetryCountProto	typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_SetErrorRetryIntervalProto	typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetErrorRetryIntervalProto	typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_SetFlagsProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetFlagsProto		typedef proto &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_SetAccountInformationProto	typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IScheduledWorkItem_GetAccountInformationProto	typedef proto &#58;DWORD, &#58;DWORD<br /><br />IScheduledWorkItem_CreateTrigger		typedef ptr IScheduledWorkItem_CreateTriggerProto<br />IScheduledWorkItem_DeleteTrigger		typedef ptr IScheduledWorkItem_DeleteTriggerProto<br />IScheduledWorkItem_GetTriggerCount		typedef ptr IScheduledWorkItem_GetTriggerCountProto<br />IScheduledWorkItem_GetTrigger			typedef ptr IScheduledWorkItem_GetTriggerProto<br />IScheduledWorkItem_GetTriggerString		typedef ptr IScheduledWorkItem_GetTriggerStringProto<br />IScheduledWorkItem_GetRunTimes			typedef ptr IScheduledWorkItem_GetRunTimesProto<br />IScheduledWorkItem_GetNextRunTime		typedef ptr IScheduledWorkItem_GetNextRunTimeProto<br />IScheduledWorkItem_SetIdleWait			typedef ptr IScheduledWorkItem_SetIdleWaitProto<br />IScheduledWorkItem_GetIdleWait			typedef ptr IScheduledWorkItem_GetIdleWaitProto<br />IScheduledWorkItem_Run				typedef ptr IScheduledWorkItem_RunProto<br />IScheduledWorkItem_Terminate			typedef ptr IScheduledWorkItem_TerminateProto<br />IScheduledWorkItem_EditWorkItem			typedef ptr IScheduledWorkItem_EditWorkItemProto<br />IScheduledWorkItem_GetMostRecentRunTime		typedef ptr IScheduledWorkItem_GetMostRecentRunTimeProto<br />IScheduledWorkItem_GetStatus			typedef ptr IScheduledWorkItem_GetStatusProto<br />IScheduledWorkItem_GetExitCode			typedef ptr IScheduledWorkItem_GetExitCodeProto<br />IScheduledWorkItem_SetComment			typedef ptr IScheduledWorkItem_SetCommentProto<br />IScheduledWorkItem_GetComment			typedef ptr IScheduledWorkItem_GetCommentProto<br />IScheduledWorkItem_SetCreator			typedef ptr IScheduledWorkItem_SetCreatorProto<br />IScheduledWorkItem_GetCreator			typedef ptr IScheduledWorkItem_GetCreatorProto<br />IScheduledWorkItem_SetWorkItemData		typedef ptr IScheduledWorkItem_SetWorkItemDataProto<br />IScheduledWorkItem_GetWorkItemData		typedef ptr IScheduledWorkItem_GetWorkItemDataProto<br />IScheduledWorkItem_SetErrorRetryCount		typedef ptr IScheduledWorkItem_SetErrorRetryCountProto<br />IScheduledWorkItem_GetErrorRetryCount		typedef ptr IScheduledWorkItem_GetErrorRetryCountProto<br />IScheduledWorkItem_SetErrorRetryInterval	typedef ptr IScheduledWorkItem_SetErrorRetryIntervalProto<br />IScheduledWorkItem_GetErrorRetryInterval	typedef ptr IScheduledWorkItem_GetErrorRetryIntervalProto<br />IScheduledWorkItem_SetFlags			typedef ptr IScheduledWorkItem_SetFlagsProto<br />IScheduledWorkItem_GetFlags			typedef ptr IScheduledWorkItem_GetFlagsProto<br />IScheduledWorkItem_SetAccountInformation	typedef ptr IScheduledWorkItem_SetAccountInformationProto<br />IScheduledWorkItem_GetAccountInformation	typedef ptr IScheduledWorkItem_GetAccountInformationProto<br /><br />IScheduledWorkItem STRUCT DWORD<br />	QueryInterface		IUnknown_QueryInterface				?<br />	AddRef			IUnknown_AddRef					?<br />	Release			IUnknown_Release				?<br />	CreateTrigger		IScheduledWorkItem_CreateTrigger		?<br />	DeleteTrigger		IScheduledWorkItem_DeleteTrigger		?<br />	GetTriggerCount		IScheduledWorkItem_GetTriggerCount		?<br />	GetTrigger		IScheduledWorkItem_GetTrigger			?<br />	GetTriggerString	IScheduledWorkItem_GetTriggerString		?<br />	GetRunTimes		IScheduledWorkItem_GetRunTimes			?<br />	GetNextRunTime		IScheduledWorkItem_GetNextRunTime		?<br />	SetIdleWait		IScheduledWorkItem_SetIdleWait			?<br />	GetIdleWait		IScheduledWorkItem_GetIdleWait			?<br />	Run			IScheduledWorkItem_Run				?<br />	Terminate		IScheduledWorkItem_Terminate			?<br />	EditWorkItem		IScheduledWorkItem_EditWorkItem			?<br />	GetMostRecentRunTime	IScheduledWorkItem_GetMostRecentRunTime		?<br />	GetStatus		IScheduledWorkItem_GetStatus			?<br />	GetExitCode		IScheduledWorkItem_GetExitCode			?<br />	SetComment		IScheduledWorkItem_SetComment			?<br />	GetComment		IScheduledWorkItem_GetComment			?<br />	SetCreator		IScheduledWorkItem_SetCreator			?<br />	GetCreator		IScheduledWorkItem_GetCreator			?<br />	SetWorkItemData		IScheduledWorkItem_SetWorkItemData		?<br />	GetWorkItemData		IScheduledWorkItem_GetWorkItemData		?<br />	SetErrorRetryCount	IScheduledWorkItem_SetErrorRetryCount		?<br />	GetErrorRetryCount	IScheduledWorkItem_GetErrorRetryCount		?<br />	SetErrorRetryInterval	IScheduledWorkItem_SetErrorRetryInterval	?<br />	GetErrorRetryInterval	IScheduledWorkItem_GetErrorRetryInterval	?<br />	SetFlags		IScheduledWorkItem_SetFlags			?<br />	GetFlags		IScheduledWorkItem_GetFlags			?<br />	SetAccountInformation	IScheduledWorkItem_SetAccountInformation	?<br />	GetAccountInformation	IScheduledWorkItem_GetAccountInformation	?<br />IScheduledWorkItem ENDS<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />sIID_ITask		TEXTEQU		&lt;&#123;0148BD524h,0A2ABh,011CEh,&#123;0B1h,01Fh,000h,0AAh,000h,053h,005h,003h&#125;&#125;&gt;<br />;sIID_ITask		TEXTEQU		&lt;&#123;05A897574h,0B79Bh,011D2h,&#123;0B5h,023h,000h,0C0h,04Fh,0A3h,060h,00Ah&#125;&#125;&gt;<br /><br />LPTASK			typedef DWORD<br />LPPTASK			typedef ptr LPTASK<br /><br />ITask_SetApplicationNameProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITask_GetApplicationNameProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITask_SetParametersProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITask_GetParametersProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITask_SetWorkingDirectoryProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITask_GetWorkingDirectoryProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITask_SetPriorityProto			typedef proto &#58;DWORD, &#58;DWORD<br />ITask_GetPriorityProto			typedef proto &#58;DWORD, &#58;DWORD<br />ITask_SetTaskFlagsProto			typedef proto &#58;DWORD, &#58;DWORD<br />ITask_GetTaskFlagsProto			typedef proto &#58;DWORD, &#58;DWORD<br />ITask_SetMaxRunTimeProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITask_GetMaxRunTimeProto		typedef proto &#58;DWORD, &#58;DWORD<br /><br />ITask_SetApplicationName	typedef ptr ITask_SetApplicationNameProto<br />ITask_GetApplicationName	typedef ptr ITask_GetApplicationNameProto<br />ITask_SetParameters		typedef ptr ITask_SetParametersProto<br />ITask_GetParameters		typedef ptr ITask_GetParametersProto<br />ITask_SetWorkingDirectory	typedef ptr ITask_SetWorkingDirectoryProto<br />ITask_GetWorkingDirectory	typedef ptr ITask_GetWorkingDirectoryProto<br />ITask_SetPriority		typedef ptr ITask_SetPriorityProto<br />ITask_GetPriority		typedef ptr ITask_GetPriorityProto<br />ITask_SetTaskFlags		typedef ptr ITask_SetTaskFlagsProto<br />ITask_GetTaskFlags		typedef ptr ITask_GetTaskFlagsProto<br />ITask_SetMaxRunTime		typedef ptr ITask_SetMaxRunTimeProto<br />ITask_GetMaxRunTime		typedef ptr ITask_GetMaxRunTimeProto<br /><br />ITask STRUCT DWORD<br />	QueryInterface		IUnknown_QueryInterface				?<br />	AddRef			IUnknown_AddRef					?<br />	Release			IUnknown_Release				?<br />	CreateTrigger		IScheduledWorkItem_CreateTrigger		?<br />	DeleteTrigger		IScheduledWorkItem_DeleteTrigger		?<br />	GetTriggerCount		IScheduledWorkItem_GetTriggerCount		?<br />	GetTrigger		IScheduledWorkItem_GetTrigger			?<br />	GetTriggerString	IScheduledWorkItem_GetTriggerString		?<br />	GetRunTimes		IScheduledWorkItem_GetRunTimes			?<br />	GetNextRunTime		IScheduledWorkItem_GetNextRunTime		?<br />	SetIdleWait		IScheduledWorkItem_SetIdleWait			?<br />	GetIdleWait		IScheduledWorkItem_GetIdleWait			?<br />	Run			IScheduledWorkItem_Run				?<br />	Terminate		IScheduledWorkItem_Terminate			?<br />	EditWorkItem		IScheduledWorkItem_EditWorkItem			?<br />	GetMostRecentRunTime	IScheduledWorkItem_GetMostRecentRunTime		?<br />	GetStatus		IScheduledWorkItem_GetStatus			?<br />	GetExitCode		IScheduledWorkItem_GetExitCode			?<br />	SetComment		IScheduledWorkItem_SetComment			?<br />	GetComment		IScheduledWorkItem_GetComment			?<br />	SetCreator		IScheduledWorkItem_SetCreator			?<br />	GetCreator		IScheduledWorkItem_GetCreator			?<br />	SetWorkItemData		IScheduledWorkItem_SetWorkItemData		?<br />	GetWorkItemData		IScheduledWorkItem_GetWorkItemData		?<br />	SetErrorRetryCount	IScheduledWorkItem_SetErrorRetryCount		?<br />	GetErrorRetryCount	IScheduledWorkItem_GetErrorRetryCount		?<br />	SetErrorRetryInterval	IScheduledWorkItem_SetErrorRetryInterval	?<br />	GetErrorRetryInterval	IScheduledWorkItem_GetErrorRetryInterval	?<br />	SetFlags		IScheduledWorkItem_SetFlags			?<br />	GetFlags		IScheduledWorkItem_GetFlags			?<br />	SetAccountInformation	IScheduledWorkItem_SetAccountInformation	?<br />	GetAccountInformation	IScheduledWorkItem_GetAccountInformation	?<br />	SetApplicationName	ITask_SetApplicationName			?<br />	GetApplicationName	ITask_GetApplicationName			?<br />	SetParameters		ITask_SetParameters				?<br />	GetParameters		ITask_GetParameters				?<br />	SetWorkingDirectory	ITask_SetWorkingDirectory			?<br />	GetWorkingDirectory	ITask_GetWorkingDirectory			?<br />	SetPriority		ITask_SetPriority				?<br />	GetPriority		ITask_GetPriority				?<br />	SetTaskFlags		ITask_SetTaskFlags				?<br />	GetTaskFlags		ITask_GetTaskFlags				?<br />	SetMaxRunTime		ITask_SetMaxRunTime				?<br />	GetMaxRunTime		ITask_GetMaxRunTime				?<br />ITask ENDS<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />sIID_ITaskTrigger	TEXTEQU		&lt;&#123;0148BD52Bh,0A2ABh,011CEh,&#123;0B1h,01Fh,000h,0AAh,000h,053h,005h,003h&#125;&#125;&gt;<br /><br />LPTASKTRIGGER		typedef DWORD<br />LPPTASKTRIGGER		typedef ptr LPTASKTRIGGER<br /><br />ITaskTrigger_SetTriggerProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITaskTrigger_GetTriggerProto		typedef proto &#58;DWORD, &#58;DWORD<br />ITaskTrigger_GetTriggerStringProto	typedef proto &#58;DWORD, &#58;DWORD<br /><br />ITaskTrigger_SetTrigger		typedef ptr ITaskTrigger_SetTriggerProto<br />ITaskTrigger_GetTrigger		typedef ptr ITaskTrigger_GetTriggerProto<br />ITaskTrigger_GetTriggerString	typedef ptr ITaskTrigger_GetTriggerStringProto<br /><br />ITaskTrigger STRUCT DWORD<br />	QueryInterface		IUnknown_QueryInterface		?<br />	AddRef			IUnknown_AddRef			?<br />	Release			IUnknown_Release		?<br />	SetTrigger		ITaskTrigger_SetTrigger		?<br />	GetTrigger		ITaskTrigger_GetTrigger		?<br />	GetTriggerString	ITaskTrigger_GetTriggerString	?<br />ITaskTrigger ENDS<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />sIID_IPersistFile	TEXTEQU		&lt;&#123;00000010Bh,00000h,00000h,&#123;0C0h,000h,000h,000h,000h,000h,000h,046h&#125;&#125;&gt;<br /><br />LPPERSISTFILE		typedef DWORD<br />LPPPERSISTFILE		typedef ptr LPPERSISTFILE<br /><br />IPersistFile_GetClassIDProto	typedef proto &#58;DWORD, &#58;DWORD<br />IPersistFile_GetCurFileProto	typedef proto &#58;DWORD, &#58;DWORD<br />IPersistFile_IsDirtyProto	typedef proto &#58;DWORD<br />IPersistFile_LoadProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IPersistFile_SaveProto		typedef proto &#58;DWORD, &#58;DWORD, &#58;DWORD<br />IPersistFile_SaveCompletedProto	typedef proto &#58;DWORD, &#58;DWORD<br /><br />IPersistFile_GetClassID		typedef ptr IPersistFile_GetClassIDProto<br />IPersistFile_GetCurFile		typedef ptr IPersistFile_GetCurFileProto<br />IPersistFile_IsDirty		typedef ptr IPersistFile_IsDirtyProto<br />IPersistFile_Load		typedef ptr IPersistFile_LoadProto<br />IPersistFile_Save		typedef ptr IPersistFile_SaveProto<br />IPersistFile_SaveCompleted	typedef ptr IPersistFile_SaveCompletedProto<br /><br />IPersistFile STRUCT DWORD<br />	QueryInterface		IUnknown_QueryInterface		?<br />	AddRef			IUnknown_AddRef			?<br />	Release			IUnknown_Release		?<br />	GetClassID		IPersistFile_GetClassID		?<br />	IsDirty			IPersistFile_IsDirty		?<br />	Load			IPersistFile_Load		?<br />	Save			IPersistFile_Save		?<br />	SaveCompleted		IPersistFile_SaveCompleted	?<br />	GetCurFile		IPersistFile_GetCurFile		?<br />IPersistFile ENDS<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br /><br /></code></pre><br /><br />Thanks again for your time and consideration,<br /><br />Darrel</div>
    <div class="meta">Posted on 2005-01-12 21:26:16 by Darrel</div>
   </div>
   <div class="post" id="post-155684">
    <div class="subject"><a href="#post-155684">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">Your interfaces look ok. An error can result if the TASK_TRIGGER structure has been defined incorrectly. You may try using h2inc to generate an include<br />file, by creating a subsidiary '.h' from 'mstask.h' say -- including only the stuff you need to compile the TASK_TRIGGER structure --  that is if you have'nt done this already.</div>
    <div class="meta">Posted on 2005-01-12 21:58:07 by Poimander</div>
   </div>
   <div class="post" id="post-155687">
    <div class="subject"><a href="#post-155687">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">I don't have mstask.h, but I shall look for it.<br /><br />Darrel</div>
    <div class="meta">Posted on 2005-01-12 22:08:18 by Darrel</div>
   </div>
   <div class="post" id="post-155694">
    <div class="subject"><a href="#post-155694">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">I would suggest:<br /><br />- create an assembly listing of your C example and check if sizeof (TASK_TRIGGER) matches the one in the ASM source<br />- if there is a difference, define the union as follows:<br /><br /><pre><code><br />TRIGGER_TYPE_UNION UNION 4<br />   Daily      DAILY &lt;&gt;<br />   Weekly      WEEKLY &lt;&gt;<br />   MonthlyDate   MONTHLYDATE &lt;&gt;<br />   MonthlyDOW   MONTHLYDOW &lt;&gt;<br />TRIGGER_TYPE_UNION ENDS<br /></code></pre><br /><br />because AFAICS the union currently is 6 bytes in ASM, but may be 8 bytes in C</div>
    <div class="meta">Posted on 2005-01-12 23:04:55 by japheth</div>
   </div>
   <div class="post" id="post-155698">
    <div class="subject"><a href="#post-155698">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">Greetings <strong>japheth</strong>, <br /><br />Well, I managed to compile the mstask.idl file which contains all of the <br />required interfaces and structure definitions, and then converted the file <br />using tlb2inc. Here's the generated .inc file:<br /><br /><pre><code>;-===========================================================================-<br />;<br />; Generated .INC file &#40;by TlbToInc v1.2 - Copyright &#40;c&#41; 2001 Maurice MONTGENIE&#41;<br />;<br />; TypeLib filename&#58; MSTASK.tlb<br />;<br />;-===========================================================================-<br /><br />;Library &#58; mstask<br />;~~~~~~~~~~~~~~~~<br />;&#123;10646351-5E4B-4899-97BF-BD7F2E427732&#125;<br />sLIBID_mstask TEXTEQU &lt;&#123;010646351H, 05E4BH, 04899H, &#123;097H, 0BFH, 0BDH, 07FH, 02EH, 042H, 077H, 032H&#125;&#125;&gt;<br /><br />;Forward Declarations<br />  _vtITaskTrigger MACRO CastName&#58;REQ<br />ENDM<br />  _vtIScheduledWorkItem MACRO CastName&#58;REQ<br />ENDM<br />  _vtITask MACRO CastName&#58;REQ<br />ENDM<br />  _vtITaskScheduler MACRO CastName&#58;REQ<br />ENDM<br />  _vtIEnumWorkItems MACRO CastName&#58;REQ<br />ENDM<br />  _vtIProvideTaskPage MACRO CastName&#58;REQ<br />ENDM<br /><br />;EnumType &#58; _TASK_TRIGGER_TYPE<br />;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />_TASK_TRIGGER_TYPE TEXTEQU &lt;DWORD&gt;<br /><br />TASK_TIME_TRIGGER_ONCE EQU 0<br />TASK_TIME_TRIGGER_DAILY EQU 1<br />TASK_TIME_TRIGGER_WEEKLY EQU 2<br />TASK_TIME_TRIGGER_MONTHLYDATE EQU 3<br />TASK_TIME_TRIGGER_MONTHLYDOW EQU 4<br />TASK_EVENT_TRIGGER_ON_IDLE EQU 5<br />TASK_EVENT_TRIGGER_AT_SYSTEMSTART EQU 6<br />TASK_EVENT_TRIGGER_AT_LOGON EQU 7<br /><br />;EnumType &#58; _TASKPAGE<br />;~~~~~~~~~~~~~~~~~~~~<br />_TASKPAGE TEXTEQU &lt;DWORD&gt;<br /><br />TASKPAGE_TASK EQU 0<br />TASKPAGE_SCHEDULE EQU 1<br />TASKPAGE_SETTINGS EQU 2<br /><br />;Union &#58; _TRIGGER_TYPE_UNION<br />;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />_TRIGGER_TYPE_UNION UNION <br />  Daily _DAILY &lt;?&gt;<br />  Weekly _WEEKLY &lt;?&gt;<br />  MonthlyDate _MONTHLYDATE &lt;?&gt;<br />  MonthlyDOW _MONTHLYDOW &lt;?&gt;<br />_TRIGGER_TYPE_UNION ENDS<br /><br />;Union &#58; __MIDL_IWinTypes_0009<br />;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />__MIDL_IWinTypes_0009 UNION <br />  hInproc SDWORD ?<br />  hRemote SDWORD ?<br />__MIDL_IWinTypes_0009 ENDS<br /><br />;Struct &#58; _TASK_TRIGGER<br />;~~~~~~~~~~~~~~~~~~~~~~~<br />_TASK_TRIGGER STRUCT DWORD<br />  cbTriggerSize SWORD ?<br />  Reserved1 SWORD ?<br />  wBeginYear SWORD ?<br />  wBeginMonth SWORD ?<br />  wBeginDay SWORD ?<br />  wEndYear SWORD ?<br />  wEndMonth SWORD ?<br />  wEndDay SWORD ?<br />  wStartHour SWORD ?<br />  wStartMinute SWORD ?<br />  MinutesDuration DWORD ?<br />  MinutesInterval DWORD ?<br />  rgFlags DWORD ?<br />  TriggerType _TASK_TRIGGER_TYPE ?<br />  Type _TRIGGER_TYPE_UNION &lt;?&gt;<br />  Reserved2 SWORD ?<br />  wRandomMinutesInterval SWORD ?<br />_TASK_TRIGGER ENDS<br /><br />;Struct &#58; _DAILY<br />;~~~~~~~~~~~~~~~~<br />_DAILY STRUCT DWORD<br />  DaysInterval SWORD ?<br />_DAILY ENDS<br /><br />;Struct &#58; _WEEKLY<br />;~~~~~~~~~~~~~~~~~<br />_WEEKLY STRUCT DWORD<br />  WeeksInterval SWORD ?<br />  rgfDaysOfTheWeek SWORD ?<br />_WEEKLY ENDS<br /><br />;Struct &#58; _MONTHLYDATE<br />;~~~~~~~~~~~~~~~~~~~~~~<br />_MONTHLYDATE STRUCT DWORD<br />  rgfDays DWORD ?<br />  rgfMonths SWORD ?<br />_MONTHLYDATE ENDS<br /><br />;Struct &#58; _MONTHLYDOW<br />;~~~~~~~~~~~~~~~~~~~~~<br />_MONTHLYDOW STRUCT DWORD<br />  wWhichWeek SWORD ?<br />  rgfDaysOfTheWeek SWORD ?<br />  rgfMonths SWORD ?<br />_MONTHLYDOW ENDS<br /><br />;Struct &#58; _SYSTEMTIME<br />;~~~~~~~~~~~~~~~~~~~~~<br />_SYSTEMTIME STRUCT DWORD<br />  wYear SWORD ?<br />  wMonth SWORD ?<br />  wDayOfWeek SWORD ?<br />  wDay SWORD ?<br />  wHour SWORD ?<br />  wMinute SWORD ?<br />  wSecond SWORD ?<br />  wMilliseconds SWORD ?<br />_SYSTEMTIME ENDS<br /><br />;Struct &#58; _RemotableHandle<br />;~~~~~~~~~~~~~~~~~~~~~~~~~~<br />_RemotableHandle STRUCT DWORD<br />  fContext SDWORD ?<br />  u __MIDL_IWinTypes_0009 &lt;?&gt;<br />_RemotableHandle ENDS<br /><br />;Interface &#58; ITaskTrigger<br />;~~~~~~~~~~~~~~~~~~~~~~~~<br />;&#123;148BD52B-A2AB-11CE-B11F-00AA00530503&#125;<br />sIID_ITaskTrigger TEXTEQU &lt;&#123;0148BD52BH, 0A2ABH, 011CEH, &#123;0B1H, 01FH, 000H, 0AAH, 000H, 053H, 005H, 003H&#125;&#125;&gt;<br /><br />ITaskTrigger_SetTriggerProto typedef proto ITaskTrigger_SetTriggerProto &#58;DWORD,&#58;DWORD<br />ITaskTrigger_GetTriggerProto typedef proto ITaskTrigger_GetTriggerProto &#58;DWORD,&#58;DWORD<br />ITaskTrigger_GetTriggerStringProto typedef proto ITaskTrigger_GetTriggerStringProto &#58;DWORD,&#58;DWORD<br /><br />ITaskTrigger_SetTriggerVal typedef ptr ITaskTrigger_SetTriggerProto<br />ITaskTrigger_GetTriggerVal typedef ptr ITaskTrigger_GetTriggerProto<br />ITaskTrigger_GetTriggerStringVal typedef ptr ITaskTrigger_GetTriggerStringProto<br /><br />  _vtITaskTrigger MACRO CastName&#58;REQ<br />  ; IUnknown methods<br />  _vtIUnknown CastName<br />  ; ITaskTrigger methods<br />  &amp;CastName&amp;_SetTrigger ITaskTrigger_SetTriggerVal ?<br />  &amp;CastName&amp;_GetTrigger ITaskTrigger_GetTriggerVal ?<br />  &amp;CastName&amp;_GetTriggerString ITaskTrigger_GetTriggerStringVal ?<br /><br />ENDM<br /><br />ITaskTrigger STRUCT<br />  _vtITaskTrigger ITaskTrigger<br />ITaskTrigger ENDS<br /><br />;Interface &#58; IScheduledWorkItem<br />;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />;&#123;A6B952F0-A4B1-11D0-997D-00AA006887EC&#125;<br />sIID_IScheduledWorkItem TEXTEQU &lt;&#123;0A6B952F0H, 0A4B1H, 011D0H, &#123;099H, 07DH, 000H, 0AAH, 000H, 068H, 087H, 0ECH&#125;&#125;&gt;<br /><br />IScheduledWorkItem_CreateTriggerProto typedef proto IScheduledWorkItem_CreateTriggerProto &#58;DWORD,&#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_DeleteTriggerProto typedef proto IScheduledWorkItem_DeleteTriggerProto &#58;DWORD,&#58;SWORD<br />IScheduledWorkItem_GetTriggerCountProto typedef proto IScheduledWorkItem_GetTriggerCountProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_GetTriggerProto typedef proto IScheduledWorkItem_GetTriggerProto &#58;DWORD,&#58;SWORD,&#58;DWORD<br />IScheduledWorkItem_GetTriggerStringProto typedef proto IScheduledWorkItem_GetTriggerStringProto &#58;DWORD,&#58;SWORD,&#58;DWORD<br />IScheduledWorkItem_GetRunTimesProto typedef proto IScheduledWorkItem_GetRunTimesProto &#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_GetNextRunTimeProto typedef proto IScheduledWorkItem_GetNextRunTimeProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_SetIdleWaitProto typedef proto IScheduledWorkItem_SetIdleWaitProto &#58;DWORD,&#58;SWORD,&#58;SWORD<br />IScheduledWorkItem_GetIdleWaitProto typedef proto IScheduledWorkItem_GetIdleWaitProto &#58;DWORD,&#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_RunProto typedef proto IScheduledWorkItem_RunProto &#58;DWORD<br />IScheduledWorkItem_TerminateProto typedef proto IScheduledWorkItem_TerminateProto &#58;DWORD<br />IScheduledWorkItem_EditWorkItemProto typedef proto IScheduledWorkItem_EditWorkItemProto &#58;DWORD,&#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_GetMostRecentRunTimeProto typedef proto IScheduledWorkItem_GetMostRecentRunTimeProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_GetStatusProto typedef proto IScheduledWorkItem_GetStatusProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_GetExitCodeProto typedef proto IScheduledWorkItem_GetExitCodeProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_SetCommentProto typedef proto IScheduledWorkItem_SetCommentProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_GetCommentProto typedef proto IScheduledWorkItem_GetCommentProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_SetCreatorProto typedef proto IScheduledWorkItem_SetCreatorProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_GetCreatorProto typedef proto IScheduledWorkItem_GetCreatorProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_SetWorkItemDataProto typedef proto IScheduledWorkItem_SetWorkItemDataProto &#58;DWORD,&#58;SWORD,&#58;DWORD<br />IScheduledWorkItem_GetWorkItemDataProto typedef proto IScheduledWorkItem_GetWorkItemDataProto &#58;DWORD,&#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_SetErrorRetryCountProto typedef proto IScheduledWorkItem_SetErrorRetryCountProto &#58;DWORD,&#58;SWORD<br />IScheduledWorkItem_GetErrorRetryCountProto typedef proto IScheduledWorkItem_GetErrorRetryCountProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_SetErrorRetryIntervalProto typedef proto IScheduledWorkItem_SetErrorRetryIntervalProto &#58;DWORD,&#58;SWORD<br />IScheduledWorkItem_GetErrorRetryIntervalProto typedef proto IScheduledWorkItem_GetErrorRetryIntervalProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_SetFlagsProto typedef proto IScheduledWorkItem_SetFlagsProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_GetFlagsProto typedef proto IScheduledWorkItem_GetFlagsProto &#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_SetAccountInformationProto typedef proto IScheduledWorkItem_SetAccountInformationProto &#58;DWORD,&#58;DWORD,&#58;DWORD<br />IScheduledWorkItem_GetAccountInformationProto typedef proto IScheduledWorkItem_GetAccountInformationProto &#58;DWORD,&#58;DWORD<br /><br />IScheduledWorkItem_CreateTriggerVal typedef ptr IScheduledWorkItem_CreateTriggerProto<br />IScheduledWorkItem_DeleteTriggerVal typedef ptr IScheduledWorkItem_DeleteTriggerProto<br />IScheduledWorkItem_GetTriggerCountVal typedef ptr IScheduledWorkItem_GetTriggerCountProto<br />IScheduledWorkItem_GetTriggerVal typedef ptr IScheduledWorkItem_GetTriggerProto<br />IScheduledWorkItem_GetTriggerStringVal typedef ptr IScheduledWorkItem_GetTriggerStringProto<br />IScheduledWorkItem_GetRunTimesVal typedef ptr IScheduledWorkItem_GetRunTimesProto<br />IScheduledWorkItem_GetNextRunTimeVal typedef ptr IScheduledWorkItem_GetNextRunTimeProto<br />IScheduledWorkItem_SetIdleWaitVal typedef ptr IScheduledWorkItem_SetIdleWaitProto<br />IScheduledWorkItem_GetIdleWaitVal typedef ptr IScheduledWorkItem_GetIdleWaitProto<br />IScheduledWorkItem_RunVal typedef ptr IScheduledWorkItem_RunProto<br />IScheduledWorkItem_TerminateVal typedef ptr IScheduledWorkItem_TerminateProto<br />IScheduledWorkItem_EditWorkItemVal typedef ptr IScheduledWorkItem_EditWorkItemProto<br />IScheduledWorkItem_GetMostRecentRunTimeVal typedef ptr IScheduledWorkItem_GetMostRecentRunTimeProto<br />IScheduledWorkItem_GetStatusVal typedef ptr IScheduledWorkItem_GetStatusProto<br />IScheduledWorkItem_GetExitCodeVal typedef ptr IScheduledWorkItem_GetExitCodeProto<br />IScheduledWorkItem_SetCommentVal typedef ptr IScheduledWorkItem_SetCommentProto<br />IScheduledWorkItem_GetCommentVal typedef ptr IScheduledWorkItem_GetCommentProto<br />IScheduledWorkItem_SetCreatorVal typedef ptr IScheduledWorkItem_SetCreatorProto<br />IScheduledWorkItem_GetCreatorVal typedef ptr IScheduledWorkItem_GetCreatorProto<br />IScheduledWorkItem_SetWorkItemDataVal typedef ptr IScheduledWorkItem_SetWorkItemDataProto<br />IScheduledWorkItem_GetWorkItemDataVal typedef ptr IScheduledWorkItem_GetWorkItemDataProto<br />IScheduledWorkItem_SetErrorRetryCountVal typedef ptr IScheduledWorkItem_SetErrorRetryCountProto<br />IScheduledWorkItem_GetErrorRetryCountVal typedef ptr IScheduledWorkItem_GetErrorRetryCountProto<br />IScheduledWorkItem_SetErrorRetryIntervalVal typedef ptr IScheduledWorkItem_SetErrorRetryIntervalProto<br />IScheduledWorkItem_GetErrorRetryIntervalVal typedef ptr IScheduledWorkItem_GetErrorRetryIntervalProto<br />IScheduledWorkItem_SetFlagsVal typedef ptr IScheduledWorkItem_SetFlagsProto<br />IScheduledWorkItem_GetFlagsVal typedef ptr IScheduledWorkItem_GetFlagsProto<br />IScheduledWorkItem_SetAccountInformationVal typedef ptr IScheduledWorkItem_SetAccountInformationProto<br />IScheduledWorkItem_GetAccountInformationVal typedef ptr IScheduledWorkItem_GetAccountInformationProto<br /><br />  _vtIScheduledWorkItem MACRO CastName&#58;REQ<br />  ; IUnknown methods<br />  _vtIUnknown CastName<br />  ; IScheduledWorkItem methods<br />  &amp;CastName&amp;_CreateTrigger IScheduledWorkItem_CreateTriggerVal ?<br />  &amp;CastName&amp;_DeleteTrigger IScheduledWorkItem_DeleteTriggerVal ?<br />  &amp;CastName&amp;_GetTriggerCount IScheduledWorkItem_GetTriggerCountVal ?<br />  &amp;CastName&amp;_GetTrigger IScheduledWorkItem_GetTriggerVal ?<br />  &amp;CastName&amp;_GetTriggerString IScheduledWorkItem_GetTriggerStringVal ?<br />  &amp;CastName&amp;_GetRunTimes IScheduledWorkItem_GetRunTimesVal ?<br />  &amp;CastName&amp;_GetNextRunTime IScheduledWorkItem_GetNextRunTimeVal ?<br />  &amp;CastName&amp;_SetIdleWait IScheduledWorkItem_SetIdleWaitVal ?<br />  &amp;CastName&amp;_GetIdleWait IScheduledWorkItem_GetIdleWaitVal ?<br />  &amp;CastName&amp;_Run IScheduledWorkItem_RunVal ?<br />  &amp;CastName&amp;_Terminate IScheduledWorkItem_TerminateVal ?<br />  &amp;CastName&amp;_EditWorkItem IScheduledWorkItem_EditWorkItemVal ?<br />  &amp;CastName&amp;_GetMostRecentRunTime IScheduledWorkItem_GetMostRecentRunTimeVal ?<br />  &amp;CastName&amp;_GetStatus IScheduledWorkItem_GetStatusVal ?<br />  &amp;CastName&amp;_GetExitCode IScheduledWorkItem_GetExitCodeVal ?<br />  &amp;CastName&amp;_SetComment IScheduledWorkItem_SetCommentVal ?<br />  &amp;CastName&amp;_GetComment IScheduledWorkItem_GetCommentVal ?<br />  &amp;CastName&amp;_SetCreator IScheduledWorkItem_SetCreatorVal ?<br />  &amp;CastName&amp;_GetCreator IScheduledWorkItem_GetCreatorVal ?<br />  &amp;CastName&amp;_SetWorkItemData IScheduledWorkItem_SetWorkItemDataVal ?<br />  &amp;CastName&amp;_GetWorkItemData IScheduledWorkItem_GetWorkItemDataVal ?<br />  &amp;CastName&amp;_SetErrorRetryCount IScheduledWorkItem_SetErrorRetryCountVal ?<br />  &amp;CastName&amp;_GetErrorRetryCount IScheduledWorkItem_GetErrorRetryCountVal ?<br />  &amp;CastName&amp;_SetErrorRetryInterval IScheduledWorkItem_SetErrorRetryIntervalVal ?<br />  &amp;CastName&amp;_GetErrorRetryInterval IScheduledWorkItem_GetErrorRetryIntervalVal ?<br />  &amp;CastName&amp;_SetFlags IScheduledWorkItem_SetFlagsVal ?<br />  &amp;CastName&amp;_GetFlags IScheduledWorkItem_GetFlagsVal ?<br />  &amp;CastName&amp;_SetAccountInformation IScheduledWorkItem_SetAccountInformationVal ?<br />  &amp;CastName&amp;_GetAccountInformation IScheduledWorkItem_GetAccountInformationVal ?<br /><br />ENDM<br /><br />IScheduledWorkItem STRUCT<br />  _vtIScheduledWorkItem IScheduledWorkItem<br />IScheduledWorkItem ENDS<br /><br />;Interface &#58; ITask<br />;~~~~~~~~~~~~~~~~~<br />;&#123;148BD524-A2AB-11CE-B11F-00AA00530503&#125;<br />sIID_ITask TEXTEQU &lt;&#123;0148BD524H, 0A2ABH, 011CEH, &#123;0B1H, 01FH, 000H, 0AAH, 000H, 053H, 005H, 003H&#125;&#125;&gt;<br /><br />ITask_SetApplicationNameProto typedef proto ITask_SetApplicationNameProto &#58;DWORD,&#58;DWORD<br />ITask_GetApplicationNameProto typedef proto ITask_GetApplicationNameProto &#58;DWORD,&#58;DWORD<br />ITask_SetParametersProto typedef proto ITask_SetParametersProto &#58;DWORD,&#58;DWORD<br />ITask_GetParametersProto typedef proto ITask_GetParametersProto &#58;DWORD,&#58;DWORD<br />ITask_SetWorkingDirectoryProto typedef proto ITask_SetWorkingDirectoryProto &#58;DWORD,&#58;DWORD<br />ITask_GetWorkingDirectoryProto typedef proto ITask_GetWorkingDirectoryProto &#58;DWORD,&#58;DWORD<br />ITask_SetPriorityProto typedef proto ITask_SetPriorityProto &#58;DWORD,&#58;DWORD<br />ITask_GetPriorityProto typedef proto ITask_GetPriorityProto &#58;DWORD,&#58;DWORD<br />ITask_SetTaskFlagsProto typedef proto ITask_SetTaskFlagsProto &#58;DWORD,&#58;DWORD<br />ITask_GetTaskFlagsProto typedef proto ITask_GetTaskFlagsProto &#58;DWORD,&#58;DWORD<br />ITask_SetMaxRunTimeProto typedef proto ITask_SetMaxRunTimeProto &#58;DWORD,&#58;DWORD<br />ITask_GetMaxRunTimeProto typedef proto ITask_GetMaxRunTimeProto &#58;DWORD,&#58;DWORD<br /><br />ITask_SetApplicationNameVal typedef ptr ITask_SetApplicationNameProto<br />ITask_GetApplicationNameVal typedef ptr ITask_GetApplicationNameProto<br />ITask_SetParametersVal typedef ptr ITask_SetParametersProto<br />ITask_GetParametersVal typedef ptr ITask_GetParametersProto<br />ITask_SetWorkingDirectoryVal typedef ptr ITask_SetWorkingDirectoryProto<br />ITask_GetWorkingDirectoryVal typedef ptr ITask_GetWorkingDirectoryProto<br />ITask_SetPriorityVal typedef ptr ITask_SetPriorityProto<br />ITask_GetPriorityVal typedef ptr ITask_GetPriorityProto<br />ITask_SetTaskFlagsVal typedef ptr ITask_SetTaskFlagsProto<br />ITask_GetTaskFlagsVal typedef ptr ITask_GetTaskFlagsProto<br />ITask_SetMaxRunTimeVal typedef ptr ITask_SetMaxRunTimeProto<br />ITask_GetMaxRunTimeVal typedef ptr ITask_GetMaxRunTimeProto<br /><br />  _vtITask MACRO CastName&#58;REQ<br />  ; IScheduledWorkItem methods<br />  _vtIScheduledWorkItem CastName<br />  ; ITask methods<br />  &amp;CastName&amp;_SetApplicationName ITask_SetApplicationNameVal ?<br />  &amp;CastName&amp;_GetApplicationName ITask_GetApplicationNameVal ?<br />  &amp;CastName&amp;_SetParameters ITask_SetParametersVal ?<br />  &amp;CastName&amp;_GetParameters ITask_GetParametersVal ?<br />  &amp;CastName&amp;_SetWorkingDirectory ITask_SetWorkingDirectoryVal ?<br />  &amp;CastName&amp;_GetWorkingDirectory ITask_GetWorkingDirectoryVal ?<br />  &amp;CastName&amp;_SetPriority ITask_SetPriorityVal ?<br />  &amp;CastName&amp;_GetPriority ITask_GetPriorityVal ?<br />  &amp;CastName&amp;_SetTaskFlags ITask_SetTaskFlagsVal ?<br />  &amp;CastName&amp;_GetTaskFlags ITask_GetTaskFlagsVal ?<br />  &amp;CastName&amp;_SetMaxRunTime ITask_SetMaxRunTimeVal ?<br />  &amp;CastName&amp;_GetMaxRunTime ITask_GetMaxRunTimeVal ?<br /><br />ENDM<br /><br />ITask STRUCT<br />  _vtITask ITask<br />ITask ENDS<br /><br />;Interface &#58; ITaskScheduler<br />;~~~~~~~~~~~~~~~~~~~~~~~~~~<br />;&#123;148BD527-A2AB-11CE-B11F-00AA00530503&#125;<br />sIID_ITaskScheduler TEXTEQU &lt;&#123;0148BD527H, 0A2ABH, 011CEH, &#123;0B1H, 01FH, 000H, 0AAH, 000H, 053H, 005H, 003H&#125;&#125;&gt;<br /><br />ITaskScheduler_SetTargetComputerProto typedef proto ITaskScheduler_SetTargetComputerProto &#58;DWORD,&#58;DWORD<br />ITaskScheduler_GetTargetComputerProto typedef proto ITaskScheduler_GetTargetComputerProto &#58;DWORD,&#58;DWORD<br />ITaskScheduler_EnumProto typedef proto ITaskScheduler_EnumProto &#58;DWORD,&#58;DWORD<br />ITaskScheduler_ActivateProto typedef proto ITaskScheduler_ActivateProto &#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD<br />ITaskScheduler_DeleteProto typedef proto ITaskScheduler_DeleteProto &#58;DWORD,&#58;DWORD<br />ITaskScheduler_NewWorkItemProto typedef proto ITaskScheduler_NewWorkItemProto &#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD<br />ITaskScheduler_AddWorkItemProto typedef proto ITaskScheduler_AddWorkItemProto &#58;DWORD,&#58;DWORD,&#58;DWORD<br />ITaskScheduler_IsOfTypeProto typedef proto ITaskScheduler_IsOfTypeProto &#58;DWORD,&#58;DWORD,&#58;DWORD<br /><br />ITaskScheduler_SetTargetComputerVal typedef ptr ITaskScheduler_SetTargetComputerProto<br />ITaskScheduler_GetTargetComputerVal typedef ptr ITaskScheduler_GetTargetComputerProto<br />ITaskScheduler_EnumVal typedef ptr ITaskScheduler_EnumProto<br />ITaskScheduler_ActivateVal typedef ptr ITaskScheduler_ActivateProto<br />ITaskScheduler_DeleteVal typedef ptr ITaskScheduler_DeleteProto<br />ITaskScheduler_NewWorkItemVal typedef ptr ITaskScheduler_NewWorkItemProto<br />ITaskScheduler_AddWorkItemVal typedef ptr ITaskScheduler_AddWorkItemProto<br />ITaskScheduler_IsOfTypeVal typedef ptr ITaskScheduler_IsOfTypeProto<br /><br />  _vtITaskScheduler MACRO CastName&#58;REQ<br />  ; IUnknown methods<br />  _vtIUnknown CastName<br />  ; ITaskScheduler methods<br />  &amp;CastName&amp;_SetTargetComputer ITaskScheduler_SetTargetComputerVal ?<br />  &amp;CastName&amp;_GetTargetComputer ITaskScheduler_GetTargetComputerVal ?<br />  &amp;CastName&amp;_Enum ITaskScheduler_EnumVal ?<br />  &amp;CastName&amp;_Activate ITaskScheduler_ActivateVal ?<br />  &amp;CastName&amp;_Delete ITaskScheduler_DeleteVal ?<br />  &amp;CastName&amp;_NewWorkItem ITaskScheduler_NewWorkItemVal ?<br />  &amp;CastName&amp;_AddWorkItem ITaskScheduler_AddWorkItemVal ?<br />  &amp;CastName&amp;_IsOfType ITaskScheduler_IsOfTypeVal ?<br /><br />ENDM<br /><br />ITaskScheduler STRUCT<br />  _vtITaskScheduler ITaskScheduler<br />ITaskScheduler ENDS<br /><br />;Interface &#58; IEnumWorkItems<br />;~~~~~~~~~~~~~~~~~~~~~~~~~~<br />;&#123;148BD528-A2AB-11CE-B11F-00AA00530503&#125;<br />sIID_IEnumWorkItems TEXTEQU &lt;&#123;0148BD528H, 0A2ABH, 011CEH, &#123;0B1H, 01FH, 000H, 0AAH, 000H, 053H, 005H, 003H&#125;&#125;&gt;<br /><br />IEnumWorkItems_NextProto typedef proto IEnumWorkItems_NextProto &#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD<br />IEnumWorkItems_SkipProto typedef proto IEnumWorkItems_SkipProto &#58;DWORD,&#58;DWORD<br />IEnumWorkItems_ResetProto typedef proto IEnumWorkItems_ResetProto &#58;DWORD<br />IEnumWorkItems_CloneProto typedef proto IEnumWorkItems_CloneProto &#58;DWORD,&#58;DWORD<br /><br />IEnumWorkItems_NextVal typedef ptr IEnumWorkItems_NextProto<br />IEnumWorkItems_SkipVal typedef ptr IEnumWorkItems_SkipProto<br />IEnumWorkItems_ResetVal typedef ptr IEnumWorkItems_ResetProto<br />IEnumWorkItems_CloneVal typedef ptr IEnumWorkItems_CloneProto<br /><br />  _vtIEnumWorkItems MACRO CastName&#58;REQ<br />  ; IUnknown methods<br />  _vtIUnknown CastName<br />  ; IEnumWorkItems methods<br />  &amp;CastName&amp;_Next IEnumWorkItems_NextVal ?<br />  &amp;CastName&amp;_Skip IEnumWorkItems_SkipVal ?<br />  &amp;CastName&amp;_Reset IEnumWorkItems_ResetVal ?<br />  &amp;CastName&amp;_Clone IEnumWorkItems_CloneVal ?<br /><br />ENDM<br /><br />IEnumWorkItems STRUCT<br />  _vtIEnumWorkItems IEnumWorkItems<br />IEnumWorkItems ENDS<br /><br />;Interface &#58; IProvideTaskPage<br />;~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br />;&#123;4086658A-CBBB-11CF-B604-00C04FD8D565&#125;<br />sIID_IProvideTaskPage TEXTEQU &lt;&#123;04086658AH, 0CBBBH, 011CFH, &#123;0B6H, 004H, 000H, 0C0H, 04FH, 0D8H, 0D5H, 065H&#125;&#125;&gt;<br /><br />IProvideTaskPage_GetPageProto typedef proto IProvideTaskPage_GetPageProto &#58;DWORD,&#58;DWORD,&#58;SDWORD,&#58;DWORD<br /><br />IProvideTaskPage_GetPageVal typedef ptr IProvideTaskPage_GetPageProto<br /><br />  _vtIProvideTaskPage MACRO CastName&#58;REQ<br />  ; IUnknown methods<br />  _vtIUnknown CastName<br />  ; IProvideTaskPage methods<br />  &amp;CastName&amp;_GetPage IProvideTaskPage_GetPageVal ?<br /><br />ENDM<br /><br />IProvideTaskPage STRUCT<br />  _vtIProvideTaskPage IProvideTaskPage<br />IProvideTaskPage ENDS<br /><br /></code></pre></div>
    <div class="meta">Posted on 2005-01-13 00:07:22 by Poimander</div>
   </div>
   <div class="post" id="post-155737">
    <div class="subject"><a href="#post-155737">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">You are right japheth, the union is 8 Bytes.<br /><br />Now for the confession!!! :oops: <br /><br />Trigger.MinutesDuration has to be greater than or equal to Trigger.MinutesInterval, naturally I had left it out.<br /><br />Thank you both for your time and consideration, especially you <strong>Poimander</strong>.<br /><br />Thanks,<br /><br />Darrel</div>
    <div class="meta">Posted on 2005-01-13 13:53:54 by Darrel</div>
   </div>
   <div class="post" id="post-155739">
    <div class="subject"><a href="#post-155739">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">Hi Poimander, glad to hear you're still alive.  :)</div>
    <div class="meta">Posted on 2005-01-13 13:59:59 by japheth</div>
   </div>
   <div class="post" id="post-155760">
    <div class="subject"><a href="#post-155760">Problems with ITaskTrigger::SetTrigger</a></div>
    <div class="body">Hi <strong>japheph</strong>, <br />Thank you, I'm still alive! As far as I am aware.  <br />BTW, your site looks great!<br /><br /><strong>Darrel</strong>, you're welcome!</div>
    <div class="meta">Posted on 2005-01-13 18:40:51 by Poimander</div>
   </div>
  </div>
 </body>
</html>