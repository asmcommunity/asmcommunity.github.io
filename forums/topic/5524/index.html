<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>media player - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5524" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=5524">media player</a></p>
   <div class="post" id="post-39245">
    <div class="subject"><a href="#post-39245">media player</a></div>
    <div class="body">Wrote a simple media player using COM interfaces.  It's a lot simpler than I had thought after looking through the examples in the masm package.<br /><br />Credits go to bazik for his media player done in mci which got me started and to Adam Blaszczyk who I ripped the COM stuff from.  I didn't use the masm macros since I wanted to understand what I was doing :)<br /><br />There's still two bugs that I know of.  One, it pagefaults once in a while due to recursive calls (no I don't know how to fix it yet).  And two, it will play mp3 files on win2000, but just exits under win98.  If I debug it under win2000 w/ ollydbg it hangs the debugger on the call to RenderFile.<br /><br />Anyway, the code should be fairly straightforward.  Bugs, suggestions welcome.</div>
    <div class="meta">Posted on 2002-05-21 14:06:13 by grv575</div>
   </div>
   <div class="post" id="post-39263">
    <div class="subject"><a href="#post-39263">media player</a></div>
    <div class="body">Still can't figure out why mp3s crash in win98.<br /><br />Also, a lot of mp3s have tons of clicks &amp; pops when played with DirectShow.  Videos don't have buffering problems.  Neither does windows media player either and I would assume that microsoft uses the directx apis in it.<br /><br />From msdn<br /><div class="quote"><br />DirectShow is: <br /><br />Modular?filters are truly reusable. <br />Autonomous?filters have embedded threads that transfer and operate on data. Buffering is also automatic, requiring no application code. <br /></div><br /><br />So if buffering is automatic, is there a way to change how much audio is buffered in advance?</div>
    <div class="meta">Posted on 2002-05-21 15:09:58 by grv575</div>
   </div>
   <div class="post" id="post-39381">
    <div class="subject"><a href="#post-39381">media player</a></div>
    <div class="body">Here's a version with a poor man's playlist.</div>
    <div class="meta">Posted on 2002-05-22 12:53:47 by grv575</div>
   </div>
   <div class="post" id="post-161938">
    <div class="subject"><a href="#post-161938">Re: media player</a></div>
    <div class="body">I modified the directshow player to correctly handle wm_size and wm_move.&nbsp; Now it repaints properly when resizing or moving.&nbsp; Here&#39;s the updated source:<br /><br />http://www.geocities.com/grv575/dspl3.zip<br /><br />There&#39;s also an MCI version based on bazik&#39;s zplayer.&nbsp; I still can&#39;t figure out how to repaint properly on wm_move though when the player is paused.&nbsp; Don&#39;t like how windows handles this (only likes to update or receive notification when playing).<br /><br />It&#39;s also worth checking out the directx sdk playwnd sample for this type of stuff.<br /></div>
    <div class="meta">Posted on 2005-07-11 05:53:52 by grv575</div>
   </div>
  </div>
 </body>
</html>