<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>how to find "dns server" that was set on the running computer? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26222" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26222">how to find "dns server" that was set on the running computer?</a></p>
   <div class="post" id="post-190684">
    <div class="subject"><a href="#post-190684">how to find "dns server" that was set on the running computer?</a></div>
    <div class="body">how to find "dns server" that was set on the running computer?
it's is the same result as command "ipconfig /all" but i dont want to know all of the information just only dns server.
this dns may be change when the computer connected to the internet via modem with different isp.</div>
    <div class="meta">Posted on 2000-11-26 13:35:00 by doby</div>
   </div>
   <div class="post" id="post-190685">
    <div class="subject"><a href="#post-190685">how to find "dns server" that was set on the running computer?</a></div>
    <div class="body">after seeing the code of  "network monitor" (code found on this site by And-Or)
i found iphlpapi.dll has the funciton GetNetworkParams that can retrieve the CurrentDnsServer on the computer.
But I dont know anything about iphlpapi.dll. 
Is this funciton is the right way? Is iphlpapi.dll is the standard that already comes with window? Is it will work on NT?

Another way I found that dns server is stored in the registry.
but the same problem, i wonder that is it will work on all computer?

Anyone know about these please help me....</div>
    <div class="meta">Posted on 2000-11-27 18:03:00 by doby </div>
   </div>
   <div class="post" id="post-190686">
    <div class="subject"><a href="#post-190686">how to find "dns server" that was set on the running computer?</a></div>
    <div class="body">I have NT 4.0 with SP6 and there is iphlpapi.dll found.

I can check that reg key for you if you tell me where to look.</div>
    <div class="meta">Posted on 2000-11-28 15:36:00 by Sami </div>
   </div>
   <div class="post" id="post-190687">
    <div class="subject"><a href="#post-190687">how to find "dns server" that was set on the running computer?</a></div>
    <div class="body">don't bother dude. it's too hard. i've tried with everything from ida to softice and there is always something that fucks me up.  just use a fullblown resolver.  you don't actually need a 'dns' ever, it's just polite to use a local one where results might be cached.</div>
    <div class="meta">Posted on 2000-12-06 20:48:00 by dude who has tried </div>
   </div>
  </div>
 </body>
</html>