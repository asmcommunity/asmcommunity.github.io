<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Receiving events without using JournalRecord. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19821" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=19821">Receiving events without using JournalRecord.</a></p>
   <div class="post" id="post-152334">
    <div class="subject"><a href="#post-152334">Receiving events without using JournalRecord.</a></div>
    <div class="body">I need to be able to receive events without using JournalRecord, that works on Windows 98 and above.<br /><br />I have a WindowsHook that is requesting JournalRecord information.  This is done for a control I'm building, so it can:<br /><br />Obtain information on mouse buttons (system wide), be told when the mouse moves and retrieve keyboard information including extended keys (internet keyboard keys).<br /><br />The problem is:  Windows 98 and few others, only allow 1 instance of a JournalRecord and pressing CTRL + ALT + DELETE removes the recording (rendering the control instances dead).<br /><br />The Keyboard and Mouse hooks only work on a thread, not system wide.  There simply must be a better way to do this.<br /><br />The Internet keyboard extended keys are read like this:<br /><br />The message's lParamLow's lower byte will have 255 (denoting an invalid standard key), but the next byte upward (the highbyte of the low word) holds the extended key value.  The keyboard hook does not seem to provide this extra information, nor will it do so system wide.<br /><br />Anyone have any idea on how I can do this &quot;safely&quot;?  I have it working with Journal Record, but I see the control onscreen now, dead (pressed CTRL + ALT + DELETE), have to end the task to get rid of the program.  (But I put in a timer call to close it so I wouldn't have to.)<br /><br />Not sure how difficult this is, but if it is really difficult, I will raise the points.  I'd love to finish the control.<br /><br /><br />I'm also trying to find the fastest method to do a region build based on a transparent color of a picture so I can SetWindowRgn to set the region when it's finished.  (The scanning method with GetPixel, well, isn't fast.)<br /><br />Funky.</div>
    <div class="meta">Posted on 2004-11-04 08:24:59 by FunkyMeister</div>
   </div>
  </div>
 </body>
</html>