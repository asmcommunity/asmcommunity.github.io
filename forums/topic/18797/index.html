<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>For f0dder - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18797" />
    <link rel="next" href="../?id=18797&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=18797">For f0dder</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=18797&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=18797&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="18797" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=18797&amp;page=2">&gt;</a><a href="../?id=18797&amp;page=2">&raquo;</a></form>   <div class="post" id="post-145514">
    <div class="subject"><a href="#post-145514">For f0dder</a></div>
    <div class="body">Hi f0dder,<br /><br />Knowing how much you love undocumented stuff, I have been playing with the TIB and PDB for the last few days and have a few interesting tidbits, still no progress on GetPIDFromhProcess9x though...<br /><br />Replacement for GetProcessHeap (All Windows versions)<br /><pre><code>fs mov edi,&#91;30h&#93;<br />mov eax,&#91;edi+18h&#93;</code></pre><br /><br />Windows version information (NT systems only)<br /><pre><code>fs mov ecx,&#91;30h&#93;<br />mov eax,&#91;ecx+0A4h&#93; ;4=NT, 5= 2K/XP/2K3<br />mov edx,&#91;ecx+0A8h&#93; ;0=2K, 1=XP, 2=2K3</code></pre><br /><br />Determine 9x or NT (all Windows versions)<br /><pre><code>fs mov eax,&#91;18h&#93;<br />cmp eax,7FFDE000h<br />jne &gt;.OS_IS_9X </code></pre><br /><br />Replacement for GetModuleHandle,0 (NT only)<br /><pre><code>fs mov edi,&#91;30h&#93;<br />mov eax,&#91;edi+08h&#93;</code></pre><br /><br />Replacement for GetCurrentProcessId (NT systems only)<br /><pre><code>fs mov eax,&#91;20h&#93;</code></pre><br /><br />Get remote process ID (NT Systems only)<br /><pre><code>invoke ReadProcessMemory,&#91;hProcess&#93;,7FFDE020h,offset ProcessID,4,offset cbWritten</code></pre></div>
    <div class="meta">Posted on 2004-07-06 16:24:47 by donkey</div>
   </div>
   <div class="post" id="post-145519">
    <div class="subject"><a href="#post-145519">For f0dder</a></div>
    <div class="body">Thought I'd add this one.<br />Original Snippet by Ratter/29A, =BaseAddress of kernel32.dll<br />Seems to be universal.<br /><br />assume fs:nothing<br />mov     ebx, fs:[30h]   ; EAX=PEB base<br />mov     ebx,   ; EAX=PEB_LDR_DATA<br />mov     ebx,   ; InitOrderModuleList 1st entry<br />mov     ebx,       ; next entry<br />mov     ebx,     ; K32 imagebase<br /><br /><br />Anyone else got any of these?</div>
    <div class="meta">Posted on 2004-07-06 17:40:09 by Homer</div>
   </div>
   <div class="post" id="post-145520">
    <div class="subject"><a href="#post-145520">For f0dder</a></div>
    <div class="body">Hi EvilHomer2K<br /><br />I put these together from stuff I found and articles at MSJ, TIBxx is pointed to by fs:[18h] and PDB by fs:[30h]...<br /><br /><span style="font-size:9px><pre><code>TIB9X STRUCT<br />	; 9X &amp; NT<br />	pvExcept		DD	// 00h Head of exception record list<br />	pvStackUserTop		DD	// 04h Top of user stack<br />	pvStackUserBase		DD	// 08h Base of user stack<br /><br />	; 9X only<br /><br />	pvTDB			DW	// 0Ch TDB<br />	pvThunkSS		DW	// 0Eh SS selector used for thunking to 16 bits<br />	unknown1		DD	// 10h<br />	<br />	; 9X &amp; NT<br />	pvArbitrary		DD	// 14h Available for application use<br />	ptibSelf		DD	// 18h Points to the structure itself ???<br />	<br />	; 9X only<br />	TIBFlags		DW	// 1Ch<br />	Win16MutexCount		DW	// 1Eh<br />	DebugContext		DD	// 20h<br />	pCurrentPriority	DD	// 24h<br />	pvQueue			DD	// 28h Message Queue selector<br /><br />	; 9X &amp; NT<br />	pvTLSArray		DD	// 2Ch Thread Local Storage array<br />	; 9X only<br />	pProcess		DD	// 30h Pointer to owning process database &#40;PDB&#41;<br />ENDS<br /><br />TIBNT STRUCT<br />	pvExcept		DD	// 00h Head of exception record list<br />	pvStackUserTop		DD	// 04h Top of user stack<br />	pvStackUserBase		DD	// 08h Base of user stack<br /><br />	; NT only<br />	SubSystemTib		DD	// 0Ch<br />	FiberData		DD	// 10h<br /><br />	; 9X &amp; NT<br />	pvArbitrary		DD	// 14h Available for application use<br />	ptibSelf		DD	// 18h Points to the structure itself ???<br /><br />	; NT only<br />	unknown1		DD	// 1Ch<br />	processID		DD	// 20h<br />	threadID		DD	// 24h<br />	unknown2		DD	// 28h<br /><br />	pvTLSArray		DD	// 2Ch Thread Local Storage array<br /><br />	; NT only<br />	pPEB			DD	// 30h Pointer to Process Environment Block &#40;PDB&#41;<br />ENDS<br /><br />PDB STRUCT<br />	header 			DD	2 DUP &#40;?&#41;	// 00 Kernel object header<br />	module			DD			// 08 Main exe module &#40;NT&#41;<br />	LdrData			DD			// 0c Pointer to loader information <br />	ProcessParameters	DD			// 10 Process parameters <br />	unknown1		DD			// 14 Unknown<br />	heap			DD			// 18 Default process heap<br /><br />	mem_context		DD			// 1c Process memory context<br />	dwflags			DD			// 20 Flags<br />	pdb16			DD			// 24 DOS PSP &#40;pointer&#41;<br />	PSP_sel			DW			// 28 Selector to DOS PSP<br />	imte			DW			// 2a IMTE for the process module<br />	threads			DW			// 2c Number of threads<br />	running_threads		DW			// 2e Number of running threads<br />	free_lib_count		DW			// 30 Recursion depth of FreeLibrary calls<br />	ring0_threads		DW			// 32 Number of ring 0 threads<br />	system_heap		DD			// 34 System heap to allocate handles<br />	task			DD			// 38 Win16 task<br />	mem_map_files		DD			// 3c Pointer to mem-mapped files &#40;pointer&#41;<br />	env_db			DD			// 40 Environment database &#40;pointer&#41;<br />	handle_table		DD			// 44 Handle table &#40;pointer&#41;<br />	parent			DD			// 48 Parent process &#40;pointer&#41;<br />	modref_list		DD			// 4c MODREF list &#40;pointer&#41;<br />	thread_list		DD			// 50 List of threads &#40;pointer&#41;<br />	debuggee_CB		DD			// 54 Debuggee context block &#40;pointer&#41;<br />	local_heap_free		DD			// 58 Head of local heap free list &#40;pointer&#41;<br />	unknown2		DD			// 5c Unknown <br />	crit_section		DD			// 60 Critical section<br />	unknown3		DD	3 DUP &#40;?&#41;	// 78 Unknown<br />	console			DD			// 84 Console &#40;pointer&#41;<br />	tls_bits		DD	2 DUP &#40;?&#41;	// 88 TLS in-use bits<br />	process_dword		DD			// 90 process dword &#40;??&#41;<br />	group			DD			// 94 Process group &#40;pointer&#41;<br />	exe_modref		DD			// 98 MODREF for the process EXE &#40;pointer&#41;<br />	top_filter		DD			// 9c Top exception filter &#40;pointer&#41;<br />	priority		DD			// a0 Priority level<br />	heap_list		DD			// a4 Head of process heap list<br />	heap_handles		DD			// a8 Head of heap handles list &#40;pointer&#41;<br />	unknown4		DD			// ac Unknown<br />	console_provider	DD			// b0 Console provider &#40;??&#41;<br />	env_selector		DD			// b4 Selector to process environment<br />	error_mode		DD			// b6 Error mode<br />	load_done_evt		DD			// b8 Event for process loading done<br />	UTState			DD			// bc Head of Univeral Thunk list<br />	unknown5		DD			// c0 Unknown &#40;NT&#41;<br />	locale			DD			// c4 Locale to be queried by GetThreadLocale &#40;NT&#41;<br />ENDS</code></pre></span></div>
    <div class="meta">Posted on 2004-07-06 18:17:25 by donkey</div>
   </div>
   <div class="post" id="post-145521">
    <div class="subject"><a href="#post-145521">For f0dder</a></div>
    <div class="body">great stuff!</div>
    <div class="meta">Posted on 2004-07-06 19:04:32 by comrade</div>
   </div>
   <div class="post" id="post-145530">
    <div class="subject"><a href="#post-145530">For f0dder</a></div>
    <div class="body">Ok ok, you beat it out of me :grin:<br /><br />I have actually known about this for about five or so years now.<br />I was looking for undocumented window styles.  The odd thing about<br />it is that I actually found one...<br /><br />Not very useful in most cases I can think of.  Can be combined with<br />any other style.  It (in effect) reverses completely the x-axis so that<br />0,0 of the window is in the upper right corner and increasing X moves<br />farther left.  When used the buttons (of course) are in the left corner<br />and the title bar is aligned to the right with the system menu.<br /><br />I have tested it in most Windows versions with no issues<br />[98/NT/2k/XP].  The only thing I have yet been able to use it for<br />was to create a tool window on the left side so the close button was<br />also tward the right side...<br /><br />WS_EX_REVERSE = WS_DLGFRAME<br />And since Microsoft obviously cares not :) ? 2004 Graebel hehe<br /><br /><br />Enjoy the madness<br />Graebel</div>
    <div class="meta">Posted on 2004-07-06 22:01:06 by Graebel</div>
   </div>
   <div class="post" id="post-145531">
    <div class="subject"><a href="#post-145531">For f0dder</a></div>
    <div class="body">Hi donkey !<br />I found this GetLastError in WinNT/2000/XP:<br />GetLastError:<br />mov     eax, dword ptr fs:[18]<br />mov     eax, dword ptr ds:<br />ret<br />Thank for your informations.<br />TQN</div>
    <div class="meta">Posted on 2004-07-06 22:19:54 by TQN</div>
   </div>
   <div class="post" id="post-145536">
    <div class="subject"><a href="#post-145536">For f0dder</a></div>
    <div class="body">not much related to peb/tib, but this is a cheap trick to determine if the system is 9x/nt, optimized:<br /><pre><code><br />mov ecx,cs<br />xor cl,cl<br />jecxz win_nt<br /></code></pre></div>
    <div class="meta">Posted on 2004-07-07 00:42:43 by Drocon</div>
   </div>
   <div class="post" id="post-145540">
    <div class="subject"><a href="#post-145540">For f0dder</a></div>
    <div class="body">That's funny... yesterday evening I was wondering if GetCurrentThreadId is as fast as it should be. Today I decided to have a look in the debugger, and what I see is:<br /><br /><pre><code><br />77E7A7DF &gt; 64&#58;A1 18000000   MOV EAX,DWORD PTR FS&#58;&#91;18&#93;<br />77E7A7E5   8B40 24          MOV EAX,DWORD PTR DS&#58;&#91;EAX+24&#93;<br />77E7A7E8   C3               RETN<br /></code></pre><br /><br />Then I decide to read the messageboard and I find this thread :)</div>
    <div class="meta">Posted on 2004-07-07 03:10:48 by Qweerdy</div>
   </div>
   <div class="post" id="post-145554">
    <div class="subject"><a href="#post-145554">For f0dder</a></div>
    <div class="body">Very good stuff.<br /><br />Thanks for sharing :alright:</div>
    <div class="meta">Posted on 2004-07-07 07:53:45 by pelaillo</div>
   </div>
   <div class="post" id="post-145563">
    <div class="subject"><a href="#post-145563">For f0dder</a></div>
    <div class="body">Hi all,<br /><br />In keeping with the NT theme and semi-documentation. Have you ever looked at the MSDN entry for NtQueryInformationProcess ? It says :<br /><br /><div class="quote">ProcessInformationClass <br /> One of the values enumerated in PROCESSINFOCLASS, that specifies what kind of process information is to be returned. These include:</div><br /><br />Then it only gives 2 examples. Here are the rest...<br /><br /><pre><code>// ProcessInformationClasses for NtQueryInformationProcess<br />#Define ProcessBasicInformation 000000000h<br />#Define ProcessQuotaLimits 000000001h<br />#Define ProcessIoCounters 000000002h<br />#Define ProcessVmCounters 000000003h<br />#Define ProcessTimes 000000004h<br />#Define ProcessBasePriority 000000005h<br />#Define ProcessRaisePriority 000000006h<br />#Define ProcessDebugPort 000000007h<br />#Define ProcessExceptionPort 000000008h<br />#Define ProcessAccessToken 000000009h<br />#Define ProcessLdtInformation 00000000Ah<br />#Define ProcessLdtSize 00000000Bh<br />#Define ProcessDefaultHardErrorMode 00000000Ch<br />#Define ProcessIoPortHandlers 00000000Dh ; Kernel mode only<br />#Define ProcessPooledUsageAndLimits 00000000Eh<br />#Define ProcessWorkingSetWatch 00000000Fh<br />#Define ProcessUserModeIOPL 000000010h<br />#Define ProcessEnableAlignmentFaultFixup 000000011h<br />#Define ProcessPriorityClass 000000012h<br />#Define ProcessWx86Information 000000013h<br />#Define ProcessHandleCount 000000014h<br />#Define ProcessAffinityMask 000000015h<br />#Define ProcessPriorityBoost 000000016h<br />#Define ProcessDeviceMap 000000017h<br />#Define ProcessSessionInformation 000000018h<br />#Define ProcessForegroundInformation 000000019h<br />#Define ProcessWow64Information 00000001Ah<br />#Define MaxProcessInfoClass 00000001Bh<br /><br />/*<br />Structures for NtQueryInformationProcess<br />All structures must be aligned at 16 byte<br />boundaries or the call will fail<br />*/<br /><br />PROCESS_BASIC_INFORMATION STRUCT<br />	//  NtQueryInformationProcess using ProcessBasicInfo<br />	ExitStatus			DD<br />	PebBaseAddress			DD<br />	AffinityMask			DD<br />	BasePriority			DD<br />	UniqueProcessId			DD<br />	InheritedFromUniqueProcessId	DD<br />ENDS<br /><br />PROCESS_SESSION_INFORMATION STRUCT<br />	//  NtQueryInformationProcess using ProcessSessionInformation<br />	SessionId		DD<br />ENDS<br /><br />QUOTA_LIMITS STRUCT<br />	//  NtQueryInformationProcess using ProcessQuotaLimits<br />	//  NtQueryInformationProcess using ProcessPooledQuotaLimits<br />	//  NtSetInformationProcess using ProcessQuotaLimits<br />	PagedPoolLimit		DD ; SIZE_T ?<br />	NonPagedPoolLimit	DD ; SIZE_T ?<br />	MinimumWorkingSetSize	DD ; SIZE_T ?<br />	MaximumWorkingSetSize	DD ; SIZE_T ?<br />	PagefileLimit		DD ; SIZE_T ?<br />	TimeLimit		DQ ; SIZE_T ?<br />ENDS<br /><br />IO_COUNTERS STRUCT<br />	//  NtQueryInformationProcess using ProcessIoCounters<br />	ReadOperationCount	DD 2 DUP &#40;?&#41; ; ULONGLONG ?<br />	WriteOperationCount	DD 2 DUP &#40;?&#41; ; ULONGLONG ?<br />	OtherOperationCount	DD 2 DUP &#40;?&#41; ; ULONGLONG ?<br />	ReadTransferCount	DD 2 DUP &#40;?&#41; ; ULONGLONG ?<br />	WriteTransferCount	DD 2 DUP &#40;?&#41; ; ULONGLONG ?<br />	OtherTransferCount	DD 2 DUP &#40;?&#41; ; ULONGLONG ?<br />ENDS<br /><br />VM_COUNTERS STRUCT<br />	//  NtQueryInformationProcess using ProcessVmCounters<br />	PeakVirtualSize			DD ; SIZE_T ?<br />	VirtualSize			DD ; SIZE_T ?<br />	PageFaultCount			DD<br />	PeakWorkingSetSize		DD ; SIZE_T ?<br />	WorkingSetSize			DD ; SIZE_T ?<br />	QuotaPeakPagedPoolUsage		DD ; SIZE_T ?<br />	QuotaPagedPoolUsage		DD ; SIZE_T ?<br />	QuotaPeakNonPagedPoolUsage	DD ; SIZE_T ?<br />	QuotaNonPagedPoolUsage		DD ; SIZE_T ?<br />	PagefileUsage			DD ; SIZE_T ?<br />	PeakPagefileUsage		DD ; SIZE_T ?<br />ENDS<br /><br />POOLED_USAGE_AND_LIMITS STRUCT<br />	//  NtSetInformationProcess using ProcessAccessToken<br />	//  PROCESS_SET_ACCESS_TOKEN access to the process is needed<br />	PeakPagedPoolUsage		DD ; SIZE_T ?<br />	PagedPoolUsage			DD ; SIZE_T ?<br />	PagedPoolLimit			DD ; SIZE_T ?<br />	PeakNonPagedPoolUsage		DD ; SIZE_T ?<br />	NonPagedPoolUsage		DD ; SIZE_T ?<br />	NonPagedPoolLimit		DD ; SIZE_T ?<br />	PeakPagefileUsage		DD ; SIZE_T ?<br />	PagefileUsage			DD ; SIZE_T ?<br />	PagefileLimit			DD ; SIZE_T ?<br />ENDS<br /><br />PROCESS_ACCESS_TOKEN STRUCT<br />	//  NtSetInformationProcess using ProcessAccessToken<br />	//  PROCESS_SET_ACCESS_TOKEN access to the process is needed<br />	Token	DD<br />	Thread	DD<br />ENDS<br /><br />KERNEL_USER_TIMES STRUCT<br />	//  NtQueryInformationProcess using ProcessTimes<br />	//  NtQueryInformationThread using ThreadTimes<br />	//	Note all times are zulu<br />	CreateTime	DQ<br />	ExitTime	DQ<br />	KernelTime	DQ<br />	UserTime	DQ<br />ENDS<br /><br />TIME_FIELDS STRUCT<br />	// Use with RtlTimeToTimeFields<br />	// RtlTimeToTimeFields,offset DQTIME,offset TIME_FIELDS<br />	// Needed to convert KERNEL_USER_TIMES fields<br />	Year		DW ; range &#91;1601...&#93;<br />	Month		DW ; range &#91;1..12&#93;<br />	Day		DW ; range &#91;1..31&#93;<br />	Hour		DW ; range &#91;0..23&#93;<br />	Minute		DW ; range &#91;0..59&#93;<br />	Second		DW ; range &#91;0..59&#93;<br />	Milliseconds	DW ; range &#91;0..999&#93;<br />	Weekday		DW ; range &#91;0..6&#93; == &#91;Sunday..Saturday&#93;<br />ENDS</code></pre><br /><br />Example of how it works if you want to shave a few 100 clocks off of the GetProcessTimes API (GoAsm syntax)<br /><br /><pre><code>DATA SECTION<br />retlen DD ?<br /><br />ALIGN 16<br />kut KERNEL_USER_TIMES &lt;?&gt;<br />	<br />ALIGN 16<br />tflds TIME_FIELDS &lt;?&gt;<br /><br />CODE SECTION<br />invoke NTDLL&#58;NtQueryInformationProcess, &#91;hProcess&#93;, ProcessTimes, offset kut,<br />		sizeof KERNEL_USER_TIMES, offset retlen<br />invoke NTDLL&#58;RtlTimeToTimeFields, offset kut.CreateTime, offset tflds</code></pre></div>
    <div class="meta">Posted on 2004-07-07 09:56:18 by donkey</div>
   </div>
   <div class="post" id="post-145565">
    <div class="subject"><a href="#post-145565">For f0dder</a></div>
    <div class="body"><div class="quote"><br />Hi donkey !<br />I found this GetLastError in WinNT/2000/XP:<br />GetLastError:<br />mov     eax, dword ptr fs:[18]<br />mov     eax, dword ptr ds:<br />ret<br />Thank for your informations.<br />TQN </div><br /><br />Tested this on 95 and 98se :<br /><br /><pre><code>fs mov eax, &#91;18h&#93;<br />mov eax, &#91;eax+60h&#93;</code></pre></div>
    <div class="meta">Posted on 2004-07-07 10:34:08 by donkey</div>
   </div>
   <div class="post" id="post-145693">
    <div class="subject"><a href="#post-145693">For f0dder</a></div>
    <div class="body">Well as long as the topic is undocumented stuff...<br /><br />Anyone have a clue as to the nature / purpose of of the Windows Message<br />with the value of 0118h ?  I have seen this message several times, but so<br />far I am clueless on what it actually is or does...<br /><br />:rolleyes:</div>
    <div class="meta">Posted on 2004-07-08 21:01:25 by Graebel</div>
   </div>
   <div class="post" id="post-145717">
    <div class="subject"><a href="#post-145717">For f0dder</a></div>
    <div class="body">I was going through my list of offline books in search of an OpenGL book (if anyone has a PDF on learning OpenGL, I'm keen! I'm busy with the NeHe tutorials!) and stumbled upon a list of &quot;undocumented OpCodes I must have downloaded a LONG time ago! If f0dder loves this sort of thing, he probably has the list, but here it is for those that don't! It lists a few opcodes from the &quot;unofficial&quot; site. I can't seem to find the site again though (listed in the files) ... Not exactly sure if they (the opcodes) are documented or not now, the list is old (last updated in '95?)<br /><br />AAM<br />AAD<br />CMOV<br />FCMOV<br />FCOMI<br />ICEBP<br />INT01<br />LOADALL<br />RDPMC<br />SALC<br />UMOV<br /><br />Regards</div>
    <div class="meta">Posted on 2004-07-09 05:00:11 by SubEvil</div>
   </div>
   <div class="post" id="post-145725">
    <div class="subject"><a href="#post-145725">For f0dder</a></div>
    <div class="body">In XP and 2000,<br />GetCurrentProcess returns -1, and in 98 it returns 7FFFFFFFh. If it's true in other windowses, then these calls could be replaced by simple constants: :grin:<br /><pre><code><br />	CURRENT_PROCESS_9X EQU &lt;7FFFFFFFh&gt;<br />	CURRENT_PROCESS_NT EQU &lt;-1&gt;<br /></code></pre></div>
    <div class="meta">Posted on 2004-07-09 09:07:36 by Petroizki</div>
   </div>
   <div class="post" id="post-145730">
    <div class="subject"><a href="#post-145730">For f0dder</a></div>
    <div class="body">Hi  Petroizki,<br /><br />Good one, but very well documented at MSDN ...<br /><br /><div class="quote"><em>GetCurrentProcess</em><br />A pseudo handle is a special constant, currently (HANDLE)-1, that is interpreted as the current process handle. For compatibility with future operating systems, it is best to call GetCurrentProcess instead of hard-coding this constant value.</div></div>
    <div class="meta">Posted on 2004-07-09 10:28:36 by donkey</div>
   </div>
   <div class="post" id="post-145731">
    <div class="subject"><a href="#post-145731">WM_SYSTIMER</a></div>
    <div class="body"><div class="quote"><br />Anyone have a clue as to the nature / purpose of of the Windows Message<br />with the value of 0118h ?  I have seen this message several times, but so<br />far I am clueless on what it actually is or does...<br /><br />:rolleyes: </div><br /><br />That's WM_SYSTIMER.<br />All that M$ tells about it is at<br />h..p://support.microsoft.com/default.aspx?scid=kb;EN-US;108938<br /><br />You can find a little more with some googling.<br />Regards, bilbo</div>
    <div class="meta">Posted on 2004-07-09 10:33:32 by prom</div>
   </div>
   <div class="post" id="post-145738">
    <div class="subject"><a href="#post-145738">For f0dder</a></div>
    <div class="body">donkey,<br />Sorry my MSDN is a rather old, so all i can do is to give bad advices.. :tongue:<br />anyway, here's another one:<br /><br />a way to get current directory in NT (UNICODE format):<br /><pre><code><br />	mov eax, dword ptr fs&#58;&#91;30h&#93;<br />	mov eax, dword ptr &#91;eax + 10h&#93;<br />	mov eax, dword ptr &#91;eax + 28h&#93;<br /></code></pre></div>
    <div class="meta">Posted on 2004-07-09 12:30:11 by Petroizki</div>
   </div>
   <div class="post" id="post-145739">
    <div class="subject"><a href="#post-145739">For f0dder</a></div>
    <div class="body">That is a very useful one and I will add it to my little repetoire :alright:<br /><br />I think it is the application path however, I tried SetCurrentDirectory and it did not change.</div>
    <div class="meta">Posted on 2004-07-09 12:31:21 by donkey</div>
   </div>
   <div class="post" id="post-145781">
    <div class="subject"><a href="#post-145781">For f0dder</a></div>
    <div class="body">Sweet !<br />Keep them coming :)</div>
    <div class="meta">Posted on 2004-07-09 23:45:05 by Homer</div>
   </div>
   <div class="post" id="post-145784">
    <div class="subject"><a href="#post-145784">For f0dder</a></div>
    <div class="body">Name of the current module in NT (UNICODE):<br /><pre><code><br />	mov eax, dword ptr fs&#58;&#91;30h&#93;<br />	mov eax, dword ptr &#91;eax + 10h&#93;<br />	mov eax, dword ptr &#91;eax + 74h&#93;<br /></code></pre><br /><br />Command line in NT (UNICODE):<br /><pre><code><br />	mov eax, dword ptr fs&#58;&#91;30h&#93;<br />	mov eax, dword ptr &#91;eax + 10h&#93;<br />	mov eax, dword ptr &#91;eax + 44h&#93;<br /></code></pre></div>
    <div class="meta">Posted on 2004-07-10 00:05:25 by Petroizki</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=18797&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=18797&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="18797" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=18797&amp;page=2">&gt;</a><a href="../?id=18797&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>