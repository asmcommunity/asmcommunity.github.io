<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Program Files folder - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18507" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18507">Program Files folder</a></p>
   <div class="post" id="post-143245">
    <div class="subject"><a href="#post-143245">Program Files folder</a></div>
    <div class="body">Hi,<br />I am looking for a way to find out the path to a users Program Files folder. I know the SHGetSpecialFolderPath API (or SHGetFolderPath for Win 2000 or later) using the CSIDL 'CSIDL_PROGRAM_FILES' will get this but the problem is I can't guarantee users will have shell32.dll version 5.0 or later installed. I know if they have Internet Explorer 5.0 or later running they will have the requisite version of this dll but if they don't....<br /><br />I am thinking about simply checking a registry key (which is no doubt what the shell programs do anyway). On Win 2000 the key is:<br />HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\ProgramFilesDir<br /><br />However I don't whether this is consistent across various Windows versions.<br />Any ideas much appreciated.<br />Cheers,<br />Andrew</div>
    <div class="meta">Posted on 2004-06-08 17:15:21 by andrew_k</div>
   </div>
   <div class="post" id="post-143262">
    <div class="subject"><a href="#post-143262">Program Files folder</a></div>
    <div class="body">ProgramFilesDir key supported in win9x,nt,2000,xp</div>
    <div class="meta">Posted on 2004-06-08 22:44:07 by Funbit</div>
   </div>
   <div class="post" id="post-143269">
    <div class="subject"><a href="#post-143269">Program Files folder</a></div>
    <div class="body">Thanks Funbit, this is all I needed to know.</div>
    <div class="meta">Posted on 2004-06-09 01:30:05 by andrew_k</div>
   </div>
  </div>
 </body>
</html>