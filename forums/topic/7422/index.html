<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Any function available to save/restore the undo buffer of a - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7422" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7422">Any function available to save/restore the undo buffer of a</a></p>
   <div class="post" id="post-53955">
    <div class="subject"><a href="#post-53955">Any function available to save/restore the undo buffer of a</a></div>
    <div class="body">The problem is following: I want to offer the user the possebility to switch the wordwrap-mode. But to avoid graphic problems I copy the content of the richedit control into an allocated buffer, then I destroy the control, after this I create a new one, switch the wordwrap-mode and copy the saved content to the new control. But doing it this way means to destroy the undo buffer. Is there a message existing with which you could save the undo/redo informations so that you could set them afterwards? Or could I receive anyhow a pointer to the buffer and its length?<br />Although Iczelion's Tutorial Series said nothing about such a function I hope there is one.<br /><br />  Thank you for your effort to help my finding a way out of this situation, Marwin</div>
    <div class="meta">Posted on 2002-08-18 12:10:50 by Marwin</div>
   </div>
   <div class="post" id="post-53963">
    <div class="subject"><a href="#post-53963">Any function available to save/restore the undo buffer of a</a></div>
    <div class="body">Marwin,<br /><br />  to be honest, I don't have an answer for you, i haven't ever used rich edit controls. However, it seems to me a bit roundabout to destroy/recreate the edit control to avoid &quot;graphical problems&quot;. I would assume that any graphical problems could be avoided by calling InvalidateRect,hWnd,NULL,TRUE to force a redraw of the window after you switch to/from word wrapping.<br /><br />--Chorus</div>
    <div class="meta">Posted on 2002-08-18 12:39:28 by chorus</div>
   </div>
   <div class="post" id="post-54228">
    <div class="subject"><a href="#post-54228">Any function available to save/restore the undo buffer of a</a></div>
    <div class="body">Well, chorus I use the wrong words. What I mean by graphic problems is following:<br />When I toggle the wordwrap mode sometimes a vertical scrollbar appears at the right of the control. Even if there's not enough text in the control, so that in reality no scrollbar is needed.<br /><br />        Marwin</div>
    <div class="meta">Posted on 2002-08-20 04:43:22 by Marwin</div>
   </div>
   <div class="post" id="post-54265">
    <div class="subject"><a href="#post-54265">Any function available to save/restore the undo buffer of a</a></div>
    <div class="body">what about calling MoveWindow on your edit control without changing any of the dimensions? I would hope that this would send a WM_MOVE and WM_SIZE message to the window and the scroll bar would be recalculated.<br /><br />Sorry, still don't have an answer for your original question :(<br /><br />--Chorus</div>
    <div class="meta">Posted on 2002-08-20 11:56:31 by chorus</div>
   </div>
  </div>
 </body>
</html>