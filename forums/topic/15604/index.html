<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>simple colib - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15604" />
    <link rel="next" href="../?id=15604&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=15604">simple colib</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=15604&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=15604&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="15604" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=15604&amp;page=2">&gt;</a><a href="../?id=15604&amp;page=2">&raquo;</a></form>   <div class="post" id="post-121143">
    <div class="subject"><a href="#post-121143">simple colib</a></div>
    <div class="body">Hi!<br /><br />It is very simple variant colib for masm32.<br /><a target="_blank" href="http://203.115.31.10/colib.exe">http://203.115.31.10/colib.exe</a></div>
    <div class="meta">Posted on 2003-10-12 14:16:30 by robin11</div>
   </div>
   <div class="post" id="post-121175">
    <div class="subject"><a href="#post-121175">simple colib</a></div>
    <div class="body">Hi robin11,<br /><br />why not posting your files in ZIP format. I surely dont download executables of a so far unknown member.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-10-13 01:03:36 by japheth</div>
   </div>
   <div class="post" id="post-121184">
    <div class="subject"><a href="#post-121184">simple colib</a></div>
    <div class="body"><a target="_blank" href="http://203.115.31.10/allfiles.rar">http://203.115.31.10/allfiles.rar</a></div>
    <div class="meta">Posted on 2003-10-13 02:36:59 by robin11</div>
   </div>
   <div class="post" id="post-121185">
    <div class="subject"><a href="#post-121185">simple colib</a></div>
    <div class="body">hi Robin, not to be annoying but have you looked up wether you could distribute these files? MS licenses tend to change and it would be good for us as well as yourself if you include the license governing these files that said that they may be distributed :)<br /><br />Welcome to the board :alright:</div>
    <div class="meta">Posted on 2003-10-13 02:59:39 by Hiroshimator</div>
   </div>
   <div class="post" id="post-122777">
    <div class="subject"><a href="#post-122777">simple colib</a></div>
    <div class="body">Damned if you do, Damned if you don't :tongue:</div>
    <div class="meta">Posted on 2003-10-29 03:24:28 by Homer</div>
   </div>
   <div class="post" id="post-123309">
    <div class="subject"><a href="#post-123309">simple colib</a></div>
    <div class="body">OCX   on absolutely pure ASM  without  UI.<br /><br />Something it is similar on WinSock :)</div>
    <div class="meta">Posted on 2003-11-03 05:22:14 by robin11</div>
   </div>
   <div class="post" id="post-123327">
    <div class="subject"><a href="#post-123327">simple colib</a></div>
    <div class="body">Hi robin11,<br /><br />just tried your ocx control with comview. Im able to view properties and show about box, but cannot view this control in the container (it crashes because method IPersistStorage::GetClassID is implemented wrong).<br /><br />I would have some questions/suggestions:<br /><br />1. template.lib is not available in source code. why?<br />2. some comments in the source would be helpful.<br />3. please tell us the benefits of your library compared to other approaches<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-11-03 10:51:22 by japheth</div>
   </div>
   <div class="post" id="post-123338">
    <div class="subject"><a href="#post-123338">simple colib</a></div>
    <div class="body">In template.lib still it is a lot of bugs. <br />Sometime it will come nearer to the end. <br />Then I shall make comments and a source.<br />It nothing is better  than others,  is simply other animal :)</div>
    <div class="meta">Posted on 2003-11-03 11:45:34 by robin11</div>
   </div>
   <div class="post" id="post-123353">
    <div class="subject"><a href="#post-123353">simple colib</a></div>
    <div class="body">Outside of commercial reasons, I'm curious why you'd spend time writing stuff to help VB coders :)</div>
    <div class="meta">Posted on 2003-11-03 13:17:19 by Homer</div>
   </div>
   <div class="post" id="post-123382">
    <div class="subject"><a href="#post-123382">simple colib</a></div>
    <div class="body">It works in Delphi too.<br />VB - makes  programs quickly.<br />At  ASM - programs the fastest.<br />Then VB  +  ASM  - the combination is ideal :grin:</div>
    <div class="meta">Posted on 2003-11-04 02:08:08 by robin11</div>
   </div>
   <div class="post" id="post-123978">
    <div class="subject"><a href="#post-123978">simple colib</a></div>
    <div class="body">Hi!<br /><br />Has corrected some bugs.<br />Now works in the container.<br />Does not fall in VB  and  Delphi.<br />But there is one question :<br />At work with &quot; ActiveX Control Pad &quot; I do not see Object  properties,  why?<br />More precisely - I can not insert them into the .htm document.<br />Somebody knows this problem?</div>
    <div class="meta">Posted on 2003-11-10 17:03:12 by robin11</div>
   </div>
   <div class="post" id="post-124447">
    <div class="subject"><a href="#post-124447">simple colib</a></div>
    <div class="body">Hi robin11,<br /><br />thanks for posting this stuff. Because it has so many bugs I was able to make the container inside comview much more stable by testing it with your control :grin: . As you already mentioned there remains some work to do.<br /><br />A strange issue I want to mention: your object exposes IClassFactory interface. This most likely doesnt hurt, but &quot;normally&quot; the classfactory has to be a (very simple) object of its own.<br /><br />Besides that you have left some debug breaks in your template lib, which is annoying in some cases.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-11-15 11:57:03 by japheth</div>
   </div>
   <div class="post" id="post-124455">
    <div class="subject"><a href="#post-124455">simple colib</a></div>
    <div class="body">Hi!<br /><br />Very well that there is any benefit of it :)<br />About IClassfactory, is an experimental variant.<br />I already have corrected many bugs and IPersistStorage too.<br />I want to make universal library for COM_OCX, COM_EXE, COM_DLL, Shellext, COM Add-Ins.<br />There are some problems for association of all it.</div>
    <div class="meta">Posted on 2003-11-15 14:19:50 by robin11</div>
   </div>
   <div class="post" id="post-124606">
    <div class="subject"><a href="#post-124606">simple colib</a></div>
    <div class="body">Hi !<br /><br /><br /><br />Next step...</div>
    <div class="meta">Posted on 2003-11-17 11:53:50 by robin11</div>
   </div>
   <div class="post" id="post-124659">
    <div class="subject"><a href="#post-124659">simple colib</a></div>
    <div class="body">Hi robin,<br /><br />very good work. OCX control works much better now.<br /><br />Some problems I found:<br /><br />1. your objects dont unregister properly. the ProgID entries and the CLSID entry itself is not removed from registry.<br />2. Disconnecting from your OCX (Unadvise) causes a GPF<br />3. you should expose IPersist interface as well (minor issue)<br />4. IPersistPropertyBag::Save causes GPF<br />5. value &quot;ThreadingModel&quot; for entry LocalServer32 is useless  (minor issue)<br />6. your IUnknown::Release function should return reference count<br />7. method IPersistStreamInit::GetSizeMax returns size &gt; 1000000  (minor issue)<br /><br />As already mentioned you should post the source of your template lib. Many members avoid executing code for which there is no source available.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-11-18 04:40:14 by japheth</div>
   </div>
   <div class="post" id="post-124809">
    <div class="subject"><a href="#post-124809">simple colib</a></div>
    <div class="body">Hi!<br /><br />I have completed Shellext - now work correctly. <br />And searched for bugs slightly. <br /><br />&gt; 1. your objects dont unregister properly. the ProgID entries and the CLSID entry itself is not removed from registry.<br />I shall correct (I search for a universal way of registration)<br />&gt;2. Disconnecting from your OCX (Unadvise) causes a GPF<br />It was necessary to destroy a window.<br />&gt;3. you should expose IPersist interface as well (minor issue)<br />What for - unless it is used?<br />&gt;4. IPersistPropertyBag::Save causes GPF<br />I have not seen it.<br />&gt;5. value &quot;ThreadingModel&quot; for entry LocalServer32 is useless (minor issue)<br />--------<br />&gt;6. your IUnknown::Release function should return reference count<br />There there is no bugs.<br />&gt;7. method IPersistStreamInit::GetSizeMax returns size &gt; 1000000 (minor issue)<br />--------<br /><br />Thank for the help.</div>
    <div class="meta">Posted on 2003-11-19 11:09:07 by robin11</div>
   </div>
   <div class="post" id="post-124827">
    <div class="subject"><a href="#post-124827">simple colib</a></div>
    <div class="body">Hi robin,<br /><br />the only method of IPersist is GetClassID. This method is important (and thats why you should expose IPersist, which should be trivial). A container calles it just before calling WriteClassStg/WriteClassStm (or it is called by OLE itself in functions OleLoad/OleSave). It has to return the CLSID of your object (not a pointer, you will have to copy all 16 bytes). Because GetClassID is implemented wrong, I can save your object with IPersistStorage::Save, but the control cannot be reloaded later.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-11-19 14:35:45 by japheth</div>
   </div>
   <div class="post" id="post-125197">
    <div class="subject"><a href="#post-125197">simple colib</a></div>
    <div class="body">Hi!<br /><br />Next step ...</div>
    <div class="meta">Posted on 2003-11-23 10:49:04 by robin11</div>
   </div>
   <div class="post" id="post-125280">
    <div class="subject"><a href="#post-125280">simple colib</a></div>
    <div class="body">works a bit better now.<br /><br />Have you tested your OCX with win9x? On my win98se system it causes a crash, forcing me to reboot.<br />And I couldnt find sort of a &quot;OnPaint&quot; routine. So I am wondering how one may adjust the drawing code,<br />which is somewhat &quot;vital&quot; for a control with a user interface. Possibly I have missed something?<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-11-24 05:20:27 by japheth</div>
   </div>
   <div class="post" id="post-125410">
    <div class="subject"><a href="#post-125410">simple colib</a></div>
    <div class="body">Hi!<br /><br />Has checked up on WinMe, there is a bug  (.... in &quot;User&quot; module)<br />On my computer is not present Win9x, but I soon shall install and then I shall correct the bug.  <br />This OCX not for UI usages.<br />But I have ideas to make full UI OCX.</div>
    <div class="meta">Posted on 2003-11-25 04:06:00 by robin11</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=15604&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=15604&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="15604" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=15604&amp;page=2">&gt;</a><a href="../?id=15604&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>