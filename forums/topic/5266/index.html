<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>WM_CHAR question - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5266" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5266">WM_CHAR question</a></p>
   <div class="post" id="post-37246">
    <div class="subject"><a href="#post-37246">WM_CHAR question</a></div>
    <div class="body">Hello<br />I've setup WH_GETMESSAGE hook to monitor WM_CHAR message, but some applications like Word 97, Visual C++ editor etc.. generates 2 or even 3 WM_CHAR messages on single key press<br />so my hook procedure is called 2 or 3 times instead one<br />how can i fix this up, so on one key press to get only one WM_CHAR??<br />I tryed checking if bit 30 (counting from zero) is check in lParam of WM_CHAR but this just gives what previous state of key was so has nothing to do with multiply WM_CHARs generated by some apps.. or I am wrong somewhere here?<br />Also spy++ shows that only one WM_CHAR message was generated which makes me more confused....<br /><br />Disclaimer: all this is <strong>not</strong> intendent for malicius usage as someone may think<br /><br />thanks</div>
    <div class="meta">Posted on 2002-05-08 16:22:45 by Mikky</div>
   </div>
   <div class="post" id="post-37514">
    <div class="subject"><a href="#post-37514">WM_CHAR question</a></div>
    <div class="body"><div class="quote">or I am wrong somewhere here?</div> I afraid you are. Its unlikely that you get more than one message for a key. Do you hand the message correctly further to the next process? Maybe you can post a code snip with the hook handler.</div>
    <div class="meta">Posted on 2002-05-10 03:38:52 by beaster</div>
   </div>
   <div class="post" id="post-37622">
    <div class="subject"><a href="#post-37622">WM_CHAR question</a></div>
    <div class="body">ok here is my hook callback procedure<br />its writen in c (hope u can read it) but i am planing to convert it to asm later<br /><br /><pre><code><br />LRESULT CALLBACK MsgProc&#40;int code,WPARAM wParam,WPARAM lParam&#41;<br />&#123;<br /> if &#40;code&lt;0&#41; <br />  &#123;<br />    return CallNextHookEx&#40;hHook, code,wParam,lParam&#41;;<br />  &#125;<br />if &#40;code == HC_ACTION&#41;<br />  &#123;<br />    if &#40;&#40;&#40;MSG*&#41;lParam&#41;-&gt;message == WM_CHAR&#41;<br />    &#123;<br />      MsgBox&#40;&quot;WM_CHAR generated&quot;&#41;;<br />    &#125;<br />  &#125;<br /><br />return CallNextHookEx&#40;hHook, code, wParam, lParam&#41;;<br />&#125;<br /></code></pre><br /><br />anyway the problem is that just *some* (usaly MS, like vc++ or word) apps generate multiply messages, not *all* and that confuses me</div>
    <div class="meta">Posted on 2002-05-10 16:00:51 by Mikky</div>
   </div>
  </div>
 </body>
</html>