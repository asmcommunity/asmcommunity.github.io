<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>help against homepage hijacker... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16805" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16805">help against homepage hijacker...</a></p>
   <div class="post" id="post-130435">
    <div class="subject"><a href="#post-130435">help against homepage hijacker...</a></div>
    <div class="body">last week a friend of me was infected by spooner.trojan<br />the trojan redirects to ntsearch.com<br /><br />with help from google i found some tips to remove this malware and start coding a small tool to remove the malware...<br /><br />since i never infected myself with such a hijacker im now thinking about a way to stop this shit.<br /><br />as you know from my older posts, im only a beginner without much time.<br />but many fun using asm and not delphi or vb.<br /><br />so i want to ask all you proffessional coder if it is possible within windows to know what programm use the registry.<br />like regmon from sysinternals.com<br /><br />do they make a file/open hook on user.dat ?<br /><br />or is there some other way to know  that ?<br />like in firewalls, what filename try to open ports...<br /><br />so one or me can programm a small tool, block all request from filenames not equal to regedit.exe.<br />better a pop up if user wish to take the new settings to the registry.<br /><br />what do you think ?<br />any idea what i must learn to programm this ?<br /><br />thanks !</div>
    <div class="meta">Posted on 2004-01-12 08:19:30 by xanthos</div>
   </div>
   <div class="post" id="post-130436">
    <div class="subject"><a href="#post-130436">help against homepage hijacker...</a></div>
    <div class="body">Afaik the source to regmon used to be available... effectively blocking access to  the registry will required coding a KMD. Filemon.sys is 40k in the version of filemon I have, so in case the license and/or your country doesn't forbid it, it should be a managable Reverse Engineering project.<br /><br />Other than that, NTDDK and various articles at and linked to from sysinternals.com should be your friends, I guess :)</div>
    <div class="meta">Posted on 2004-01-12 08:27:54 by f0dder</div>
   </div>
   <div class="post" id="post-130437">
    <div class="subject"><a href="#post-130437">help against homepage hijacker...</a></div>
    <div class="body">Reverse engineering of Regmon .sys file and understand the source is not easy.<br />Like f0dder said, you will need to write a KMD for NT, 2k or XP.<br /><br />Some very useful links:<br /><br /><a target="_blank" href="http://www.windowsitlibrary.com/Content/356/06/2.html">Hooking Windows NT System Services </a> <br /><a target="_blank" href="http://www.wiretapped.net/~fyre/sst.html">Windows NT System Service Table Hooking</a> <br /><br />IMHO, you need reverse engineering an application only if you can?t do the same by yourself.<br />There is no substitute for experience.<br /><br /><br /><br />:alright: Good luck !</div>
    <div class="meta">Posted on 2004-01-12 09:10:43 by Opcode</div>
   </div>
   <div class="post" id="post-130438">
    <div class="subject"><a href="#post-130438">help against homepage hijacker...</a></div>
    <div class="body">thank you for your answers.<br />sounds heavy to me, but not undoable :)<br /><br />many windows versions later and microsoft never build a function that ask the user for permission, like when you open a 'xyz.reg* file.<br /><br />in this case it sound much easy for a beginner like me, to watch first some registry keys for changes.<br />like the autostart page.<br /><br />then i think hooking is something i learn not in a week, so better code firszt something easy and then i have enough time to make my tool better and better.<br /><br />ha thats the cool thing behind this board !<br />some little question and possible i dont need hours of searching.<br /><br />btw. if you are infected by spooner, look for a handle 'sp' and remove it.<br />next remove sp.exe from windows folder and the key from autostart.<br /><br />cheers</div>
    <div class="meta">Posted on 2004-01-12 10:19:06 by xanthos</div>
   </div>
   <div class="post" id="post-130439">
    <div class="subject"><a href="#post-130439">help against homepage hijacker...</a></div>
    <div class="body"><div class="quote"><br />many windows versions later and microsoft never build a function that ask the user for permission, like when you open a 'xyz.reg* file.<br /></div><br />This can actually be done via user policies on NT. I dunno how it affects the registry API, but you can lock down regedit.exe and thus importing of .reg files. Also, home users really ought to be running a less-privileged account than adminstrator, and by doing so apps cannot write to HKLM.</div>
    <div class="meta">Posted on 2004-01-12 10:28:06 by f0dder</div>
   </div>
  </div>
 </body>
</html>