<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Copy files to another location on Win shutdown - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22464" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=22464">Copy files to another location on Win shutdown</a></p>
   <div class="post" id="post-168606">
    <div class="subject"><a href="#post-168606">Copy files to another location on Win shutdown</a></div>
    <div class="body">I am looking for a program that will copy files to another location on shutdown or one that&#39;ll let you just click and copy them in one step. Different files would be added on occasion. Hope that made sense. :-)<br /><br />Thanks.<br /><br />Oh yeah, gotta be freeware too.</div>
    <div class="meta">Posted on 2005-12-06 17:58:19 by skywalker</div>
   </div>
   <div class="post" id="post-168642">
    <div class="subject"><a href="#post-168642">Re: Copy files to another location on Win shutdown</a></div>
    <div class="body">There is a M$ startup one.&nbsp; So what is the difference between Shutdown and Startup for you?<br /><br />Regards,&nbsp; P1 8)</div>
    <div class="meta">Posted on 2005-12-07 12:56:03 by P1</div>
   </div>
   <div class="post" id="post-168649">
    <div class="subject"><a href="#post-168649">Re: Copy files to another location on Win shutdown</a></div>
    <div class="body"><div class="quote"><br />There is a M$ startup one.&nbsp; So what is the difference between Shutdown and Startup for you?<br /><br />Regards,&nbsp; P1 8)<br /></div><br /><br />Start may happen more often :P</div>
    <div class="meta">Posted on 2005-12-07 16:07:58 by SpooK</div>
   </div>
   <div class="post" id="post-168655">
    <div class="subject"><a href="#post-168655">Re: Copy files to another location on Win shutdown</a></div>
    <div class="body"><div class="quote"><br /><div class="quote"><br />There is a M$ startup one.&nbsp; So what is the difference between Shutdown and Startup for you?<br /><br />Regards,&nbsp; P1 8)<br /></div><br /><br />Start may happen more often :P<br /></div><br />Hehe, certainly if you run win9x :)<br /><br />Just had to fix the in-laws&#39; old box... yet another confirmation that WinMe is the worst windows version to date. Starts more often than shutdowns for sure.<br /><br />Anyway SkyWalker, as P1 said there&#39;s a startup method of doing it, that will even let you overwrite system files etc. If you just need to move some regular files on shutdown, that should be a pretty trivial problem... at least as long as the move operation only takes a few seconds.<br /></div>
    <div class="meta">Posted on 2005-12-07 19:04:19 by f0dder</div>
   </div>
   <div class="post" id="post-168657">
    <div class="subject"><a href="#post-168657">Re: Copy files to another location on Win shutdown</a></div>
    <div class="body"><div class="quote"><br /><div class="quote"><br /><div class="quote"><br />There is a M$ startup one.&nbsp; So what is the difference between Shutdown and Startup for you?<br /><br />Regards,&nbsp; P1 8)<br /></div><br /><br />Start may happen more often :P<br /></div><br />Hehe, certainly if you run win9x :)<br /><br />Just had to fix the in-laws&#39; old box... yet another confirmation that WinMe is the worst windows version to date. Starts more often than shutdowns for sure.<br /><br />Anyway SkyWalker, as P1 said there&#39;s a startup method of doing it, that will even let you overwrite system files etc. If you just need to move some regular files on shutdown, that should be a pretty trivial problem... at least as long as the move operation only takes a few seconds.<br /><br /></div><br /><br />Everyone seems to missing the key word in my post. COPY<br /><br />I want to be able to copy some files from one location to another. I would like it automated to occur during shutdown. Ideally it would also have the option of manually doing by it a mouseclick. The files wouldn&#39;t be any system files. <br /><br /><br /><br /></div>
    <div class="meta">Posted on 2005-12-07 19:35:26 by skywalker</div>
   </div>
   <div class="post" id="post-168659">
    <div class="subject"><a href="#post-168659">Re: Copy files to another location on Win shutdown</a></div>
    <div class="body">What&#39;s the problem with copying a file? CopyFile/CopyFileEx. If you want to display something, you need a window/dialog. Additionally you have to postpone the shutdown process (probably requires some administrator rights) and resume it when you&#39;re done. Otherwise WinXP and alike will close you app after few seconds.</div>
    <div class="meta">Posted on 2005-12-07 19:39:32 by ti_mo_n</div>
   </div>
   <div class="post" id="post-168677">
    <div class="subject"><a href="#post-168677">Re: Copy files to another location on Win shutdown</a></div>
    <div class="body"><div class="quote"><br />What&#39;s the problem with copying a file? CopyFile/CopyFileEx. If you want to display something, you need a window/dialog. Additionally you have to postpone the shutdown process (probably requires some administrator rights) and resume it when you&#39;re done. Otherwise WinXP and alike will close you app after few seconds.<br /></div><br /><br />I copied this from a recent post.<br /><br />Have it respond to the WM_ENDSESSION message:<br /> - read in the file containing the list of files to copy (and a destination?) - one per line<br /> - extract each line (from start to newline)<br /> - copy the file<br /> - repeat for each line<br /> - close the list file<br /> - return TRUE<br /><br />BigGrin<br /><br />Thanks.<br /><br />Unfortunately I don&#39;t have the time to devote to programming anymore because of my job.<br />It looks like your method would work and I could manually change the list.</div>
    <div class="meta">Posted on 2005-12-08 16:44:45 by skywalker</div>
   </div>
   <div class="post" id="post-168871">
    <div class="subject"><a href="#post-168871">Re: Copy files to another location on Win shutdown</a></div>
    <div class="body">From a reliability point of view, with jesting aside.&nbsp; Startups are more reliable and more often.&nbsp; Hint:&nbsp; A Blue Screen is not a Shutdown.&nbsp; Niether is a power outage.<br /><br />Copying that does not get done is no Copying at all.&nbsp; That was my point.<br /><br />Regards,&nbsp; P1&nbsp; 8)</div>
    <div class="meta">Posted on 2005-12-13 10:45:10 by P1</div>
   </div>
   <div class="post" id="post-168874">
    <div class="subject"><a href="#post-168874">Re: Copy files to another location on Win shutdown</a></div>
    <div class="body"><div class="quote"><br />From a reliability point of view, with jesting aside.&nbsp; Startups are more reliable and more often.&nbsp; Hint:&nbsp; A Blue Screen is not a Shutdown.&nbsp; Niether is a power outage.<br /><br />Copying that does not get done is no Copying at all.&nbsp; That was my point.<br /><br />Regards,&nbsp; P1&nbsp; 8)<br /></div><br /><br />I&#39;ll dig out my code and see what I can find. I remember some that executed dos functions, so I&#39;ll just code for each file as new ones are added. I&#39;ll just run it each day. </div>
    <div class="meta">Posted on 2005-12-13 17:25:12 by skywalker</div>
   </div>
  </div>
 </body>
</html>