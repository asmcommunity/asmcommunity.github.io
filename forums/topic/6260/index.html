<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>I am stumped......... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6260" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6260">I am stumped.........</a></p>
   <div class="post" id="post-45028">
    <div class="subject"><a href="#post-45028">I am stumped.........</a></div>
    <div class="body">Ok, I started by creating a main window, then upon menu click, create a new window, but when I close that window with DestroyWindow then shut the main program down, the process still runs, couldn't figure it out so I stopped that project for the time being.  Now here is my question, I want to create 5 text boxes and 5 buttons....  Started by doing:<br /><br /><pre><code><br />   invoke 	CreateWindowEx,\<br />                WS_EX_CLIENTEDGE,\<br />                ADDR WndClsText,\<br />                NULL,\<br />                WS_VISIBLE + WS_CHILDWINDOW + ES_AUTOHSCROLL + ES_NOHIDESEL,\<br />                1,\ ; Left<br />                1,\ ; Top<br />                302,\ ; Width<br />                20,\ ; Height<br />                hwnd,\<br />                NULL,\<br />                hInstance,\<br />                NULL<br />    invoke 	SendMessage, eax, WM_SETFONT, hFont, NULL<br /></code></pre> <br />and I would do this 5 times to create 5 different text boxes(Yes, I would increase the top value) which worked, but then I said there has to be an easier way... then I looked into loops...  Well I tried:<br /><pre><code><br />   push ecx<br />    xor ecx, ecx<br />    mov ecx, 5<br />    .WHILE ecx != 0<br />        invoke 	CreateWindowEx,\<br />                WS_EX_CLIENTEDGE,\<br />                ADDR WndClsText,\<br />                NULL,\<br />                WS_VISIBLE + WS_CHILDWINDOW + ES_AUTOHSCROLL + ES_NOHIDESEL,\<br />                1,\ ; Left<br />                Some value here!,\ ; Top<br />                302,\ ; Width<br />                20,\ ; Height<br />                hwnd,\<br />                NULL,\<br />                hInstance,\<br />                NULL<br />    invoke 	SendMessage, eax, WM_SETFONT, hFont, NULL<br /><br />        sub ecx, 1<br />    .ENDW<br />    pop ecx<br />               </code></pre> <br /><br />and that put my progam into some kind of loop.. and either the program would not start (stays in some kind of loop) or the main window would show but no text boxes! ( I don't remember, playing around with too much code) :( <br />Then I found the debug libs and I tried:<br /><br /><pre><code><br />push ecx<br />    xor ecx, ecx<br />    mov		ecx, 5<br />    .WHILE ecx != 0<br />        PrintDec ecx<br />        sub ecx, 1<br />    .ENDW<br />    pop ecx<br /></code></pre> <br /><br />Which prints correctly!  Why is my CreateWindow loop not working?  Is there an easier (better) way of creating more then one textbox (besides Dialogs)?</div>
    <div class="meta">Posted on 2002-06-24 23:20:55 by Gunner</div>
   </div>
   <div class="post" id="post-45030">
    <div class="subject"><a href="#post-45030">I am stumped.........</a></div>
    <div class="body">Try this:<pre><code>xor ecx, ecx<br />    mov ecx, 5<br />    .WHILE ecx != 0<br />        push ecx<br />        invoke 	CreateWindowEx,\<br />                WS_EX_CLIENTEDGE,\<br />                ADDR WndClsText,\<br />                NULL,\<br />                WS_VISIBLE + WS_CHILDWINDOW + ES_AUTOHSCROLL + ES_NOHIDESEL,\<br />                1,\ ; Left<br />                Some value here!,\ ; Top<br />                302,\ ; Width<br />                20,\ ; Height<br />                hwnd,\<br />                NULL,\<br />                hInstance,\<br />                NULL<br />    invoke 	SendMessage, eax, WM_SETFONT, hFont, NULL<br />        pop ecx<br />        dec ecx<br />    .ENDW<br /></code></pre>Your ecx was destroyed by the CreateWindowEx And SendMessage, try pushing ecx before the API call and pop it afterwards. :) remember to push any registers except ebx esi and edi if you plan to use them after an API call.</div>
    <div class="meta">Posted on 2002-06-24 23:37:43 by stryker</div>
   </div>
   <div class="post" id="post-45134">
    <div class="subject"><a href="#post-45134">I am stumped.........</a></div>
    <div class="body">Outstanding!!!  Thanks Stryker!  Have to keep this in mind.</div>
    <div class="meta">Posted on 2002-06-25 09:35:52 by Gunner</div>
   </div>
   <div class="post" id="post-45135">
    <div class="subject"><a href="#post-45135">I am stumped.........</a></div>
    <div class="body">personally i make a different procedure for each controls i make that way i dont have to pass the class, and styles to my procedure only a unique ID. The top code example is a single procedure you can use but i prefer the second example. use procedures makes your code much more readable i think.<br /><pre><code>   ID_BTN1    equ 2000<br />   ID_BTN2    equ 2001<br /><br />.data<br />   WndEditCls db &quot;edit&quot;,0<br />   WndBtnCls  db &quot;button&quot;,0<br /><br />.data?<br />   hEdit1     HANDLE ?<br />   hEdit2     HANDLE ?<br />   hButton1   HANDLE ?<br />   hButton2   HANDLE ?<br /><br />.code<br />.IF uMsg == WM_CREATE<br />   ;// Create EditBox's<br />   invoke CreateControls,WndEditCls,WS_VISIBLE + WS_CHILDWINDOW + ES_AUTOHSCROLL + ES_NOHIDESEL,0<br />   mov hEdit1,eax<br />   invoke CreateControls,WndEditCls,WS_VISIBLE + WS_CHILDWINDOW + ES_AUTOHSCROLL + ES_NOHIDESEL,0<br />   mov hEdit2,eax<br />   ;// Create Buttons<br />   invoke CreateControls,WndBtnCls, WS_VISIBLE + WS_CHILDWINDOW,ID_BTN1<br />   mov hButton1,eax<br />   invoke CreateControls,WndBtnCls, WS_VISIBLE + WS_CHILDWINDOW,ID_BTN2<br />   mov hButton2,eax<br />   <br /><br />;=========================================================<br />CreateControls  proc CLASS&#58;DWORD,STYLES&#58;DWORD,ID&#58;DWORD<br />    invoke      CreateWindowEx,\<br />                WS_EX_CLIENTEDGE,\<br />                CLASS,\<br />                NULL,\<br />                STYLES,\<br />                1,\ ; Left<br />                1,\ ; Top<br />                302,\ ; Width<br />                20,\ ; Height<br />                hwnd,\<br />                ID,\<br />                hInstance,\<br />                NULL<br />    push eax<br />    invoke      SendMessage, eax, WM_SETFONT, hFont, NULL<br />    pop eax<br />ret<br />CreateControls endp</code></pre><br />example 2:<br /><pre><code>   ID_BTN1    equ 2000<br />   ID_BTN2    equ 2001<br /><br />.data<br />   WndEditCls db &quot;edit&quot;,0<br />   WndBtnCls  db &quot;button&quot;,0<br /><br />.data?<br />   hEdit1     HANDLE ?<br />   hEdit2     HANDLE ?<br />   hButton1   HANDLE ?<br />   hButton2   HANDLE ?<br /><br />.code<br />.IF uMsg == WM_CREATE<br />   ;// Create EditBox's<br />   invoke CreateEdit<br />   mov hEdit1,eax<br />   invoke CreateEdit<br />   mov hEdit2,eax<br />   ;// Create Buttons<br />   invoke CreateControls,ID_BTN1<br />   mov hButton1,eax<br />   invoke CreateControls,ID_BTN2<br />   mov hButton2,eax<br />   <br /><br />;=================================================<br />CreateEdit  proc<br />    invoke      CreateWindowEx,\<br />                WS_EX_CLIENTEDGE,\<br />                WndEditCls,\<br />                NULL,\<br />                WS_VISIBLE + WS_CHILDWINDOW + ES_AUTOHSCROLL + ES_NOHIDESEL,\<br />                1,\ ; Left<br />                1,\ ; Top<br />                302,\ ; Width<br />                20,\ ; Height<br />                hwnd,\<br />                ID,\<br />                hInstance,\<br />                NULL<br />    push eax<br />    invoke      SendMessage, eax, WM_SETFONT, hFont, NULL<br />    pop eax<br />ret<br />CreateEdit endp<br />;=================================================<br />CreateButton  proc ID&#58;DWORD<br />    invoke      CreateWindowEx,\<br />                WS_EX_CLIENTEDGE,\<br />                WndBtnCls,\<br />                NULL,\<br />                WS_VISIBLE + WS_CHILDWINDOW,\<br />                1,\ ; Left<br />                1,\ ; Top<br />                302,\ ; Width<br />                20,\ ; Height<br />                hwnd,\<br />                ID,\<br />                hInstance,\<br />                NULL<br />    push eax<br />    invoke      SendMessage, eax, WM_SETFONT, hFont, NULL<br />    pop eax<br />ret<br />CreateButton endp</code></pre></div>
    <div class="meta">Posted on 2002-06-25 09:44:20 by smurf</div>
   </div>
   <div class="post" id="post-45140">
    <div class="subject"><a href="#post-45140">I am stumped.........</a></div>
    <div class="body">gunner,<br /><br />A couple of things, when you make a function call like CreateWindowEx where you split it across different lines, you only need to leave a trailing comma (,) to continue the line, saves you the extra typing.<br /><br />My approach for multiple windows is to put the CreateWindowEx call in its own proc then call it the number of times you need. I do this with all of the normal controls as the code is fully reusable if you write it properly, you just pass stuff to the procedure like different strings and styles etc ...<br /><br />This way you get the handle of each window as the return value and you have a tidy style of code.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-06-25 10:46:23 by hutch--</div>
   </div>
  </div>
 </body>
</html>