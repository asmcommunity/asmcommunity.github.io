<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Can I get some help here? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=354" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=113">Low Level Concepts</a> &raquo; <a href="../?id=354">Can I get some help here?</a></p>
   <div class="post" id="post-1915">
    <div class="subject"><a href="#post-1915">Can I get some help here?</a></div>
    <div class="body">I'm taking embedded controller programming at a local college this summer, and the book and the instructor both are awful...  I posted this on anohter forum for help and got referred to here (I got no help there, so I figured I'd try the experts!)  The controller is a an 8051 derivitive, and one of its oddities is that commands like MOV, ADD, etc... are followed by: destination, source, instead of source, destination... Anyways, My homework is 2 parts... There's some questions in both, and some coding in the end of the second part... If you could look it over for me, it'd be great!  If not, thanks for your time anyhow!<br /><br />(I'm only going to include the code/question part of the first one, it should have everything needed)<br /><br />; 0) Do the addition below assuming that we are working with<br />; UNSIGNED numbers. What are the two numbers we are adding (decimal) ?<br />; 101 and 43<br />; What is the result ?<br />; 144<br />; Is the result valid or not ?<br />; Yes<br />; Why or Why not ?<br />; Both numbers and the correct result are all within the limits of an UNSIGNED 2 digit hex number (0-255)<br /><br />  MOV   A, #65h<br />  ADD   A, #2Bh<br /><br />; 1) Do the addition below assuming that we are working with<br />; UNSIGNED numbers. What are the two numbers we are adding (decimal) ?<br />; 197 and 75<br />; What is the result ?<br />; 16<br />; Is the result valid or not ?<br />; No<br />; Why or Why not ?<br />; The answer it should be (272) is outside the range of UNSIGNED 2 digit hex numbers (0-255)<br /><br />  MOV   A, #0C5h<br />  ADD   A, #4Bh<br /><br />; 2)  Now do the addition below assuming that we are working with<br />; SIGNED numbers. What are the two numbers we are adding (decimal) ?<br />; -59 and 75<br />; What is the result ?<br />; 16<br />; Is the result valid or not ?<br />; Yes<br />; Why or Why not ?<br />; Both -59 and 75 and the correct result are in the range of a 2 digit SIGNED hex number (-128 to 127)<br /><br />  MOV   A, #0C5h<br />  ADD   A, #4Bh<br /><br />; 3)  Do the addition below assuming that we are working with<br />; SIGNED numbers. What are the two numbers we are adding (decimal) ?<br />; -128 and 127<br />; What is the result ?<br />; -1<br />; Is the result valid or not ?<br />; Yes<br />; Why or Why not ?<br />; Both -128 and 127 and the correct result are in the range of a 2 digit SIGNED hex number (-128 to 127)<br /><br />  MOV   A, #80h<br />  ADDC  A, #7Fh<br /><br />; 4) Do the subtraction below assuming that we are working with<br />; UNSIGNED numbers. What are the two numbers we are adding (decimal) ?<br />; 147 and 161<br />; What is the result ?<br />; 242<br />; Is the result valid or not ?  <br />; No<br />; Why or Why not ?<br />; The answer should be -14, which cannot be represented in an UNSIGNED number<br /><br />  MOV   A, #93h<br />  CLR   C<br />  SUBB  A, #0A1h<br /><br />; 5) Now do the subtraction below assuming that we are working with<br />; SIGNED numbers. What are the two numbers we are adding (decimal) ?<br />; -128 and 1<br />; What is the result ?<br />; 127<br />; Is the result valid or not ? <br />; No<br />; Why or Why not ?<br />; The answer should be -129, which is outside the range of a 2 digit SIGNED hex number (-128 to 127)<br /><br />  MOV   A, #80h<br />  CLR   C<br />  SUBB  A, #01h<br /><br />; 6) Do the subtraction below assuming that we are working with<br />; SIGNED numbers. What are the two numbers we are adding (decimal) ?<br />; -109 and -95<br />; What is the result ? <br />; -14<br />; Is the result valid or not ?<br />; Yes<br />; Why or Why not ?<br />; Because both numbers and the correct result are within the range of a 2 digit SIGNED hex number (-128 to 127)<br /><br />  MOV   A, #93h<br />  CLR   C<br />  SUBB  A, #0A1h<br /><br /><br /><br /><br /><br />;  --------------------------------------------------------------<br />;                EMBEDDED MICROCONTROLLER PROGRAMMING<br />;                       HOMEWORK #2 - PROBLEM 2<br />;<br />;                      Written by S.C.T.  1-10-99<br />;		    Modified by ALM: April 2, 2001<br />;  --------------------------------------------------------------<br /><br />; This program demonstrates the use of 16 bit arithmetic and<br />; subroutine calls on the 8051.<br /><br />; This is a shell program to demonstrate arithmetic for performing<br />; 16 bit addition and subtraction on the 8051.  The homework assignment<br />; is to fill in the missing subroutines which perform 16 bit adds on<br />; the values assigned to the respective program registers.<br /><br />  $MOD52<br /><br />  XH    EQU     R0              ; Define X High and Low Bytes<br />  XL    EQU     R1<br />  YH    EQU     R2              ; Define Y High and Low Bytes<br />  YL    EQU     R3<br />  ZH    EQU     R4              ; Define Z High and Low Bytes<br />  ZL    EQU     R5<br /><br />  ORG   4000h                   ; Start Program execution at<br />                                ; Address 4000 hex<br /><br />  MOV   XH, #0F0h               ; Load X High Byte with F0h<br />  MOV   XL, #73h                ; Load X Low Byte with 73h<br /><br />  MOV   YH, #74h                ; Load Y High Byte with 74h<br />  MOV   YL, #65h                ; Load Y Low Byte with 65h<br /><br />  ACALL ADD16                   ; Call ADD16 subroutine<br /><br />; ---------------- ANSWER QUESTIONS HERE ----------------------<br />; 1) Assuming the 16 bit values in X and Y are UNSIGNED, what<br />; are the values in X and Y that we are adding (in decimal)?<br />; X = 61555 and Y = 29797<br />; What will the value of Z be on return from the the<br />; subroutine (in decimal)?<br />; 25817<br />; Is this answer valid ? Why ?<br />; No, because the real answer exceeds the limits of a 16-bit UNSIGNED number (0-65535)<br />; 2) Repeat 1 assuming X and Y are SIGNED values. <br />; x = -3981 and Y = 29797<br />; 25816<br />; Yes, because both values and the true result are within the boundaries of a 16-bit SIGNED number (-32768 to 32767)<br />; --------------------------------------------------------------<br /><br /><br />  ACALL SUB16  <br /><br />; ---------------- ANSWER QUESTIONS HERE ----------------------<br />; 1) Assuming the 16 bit values in X and Y are UNSIGNED, what<br />; are the values in X and Y that we are subtracting (in decimal)?<br />; What will the value of Z be on return from the the<br />; subroutine (in decimal)?<br />; 31758<br />; Is this answer valid ?<br />; Yes<br />; Why ?<br />; Because both values and the result are in the boundaries of a 16-bit SIGNED number (0-65535)<br />;<br />; 2) Repeat 1 assuming X and Y are SIGNED values. <br />; 31758<br />; No<br />; Because the answer it should be (-33778) is not within the boundaries of a 16-bit SIGNED number (-32768 to 32767)<br />; --------------------------------------------------------------<br /><br /><br />; ------------ FILL IN SUBROUTINES ADD16 and SUB16 Below -------<br />; 3) These two subroutines should perform 16 bit additions and<br />; subtractions (respectively) on the 16 bit values stored in<br />; X and Y and store the results in Z.  The high and low bytes<br />; in X,Y, and Z are denoted as XH,XL, YH,YL, and ZH,ZL.<br /><br />  ADD16:<br /><br />  MOV A, XL<br />  ADD A, YL<br />  MOV ZL, A<br />  MOV A, XH<br />  ADDC A, YH<br />  MOV ZH, A<br /><br />  RET<br /><br /><br /><br />  SUB16:<br /><br />  MOV 0D0h, #00h<br />  MOV A, XL<br />  SUBB A, YL<br />  MOV ZL, A<br />  MOV A, XH<br />  SUBB A, YH<br />  MOV A, ZH<br /><br />  RET<br /><br /><br />  END</div>
    <div class="meta">Posted on 2001-07-24 16:45:02 by The Lost</div>
   </div>
   <div class="post" id="post-1923">
    <div class="subject"><a href="#post-1923">hmmm</a></div>
    <div class="body">So you want us to make your homework? looks somehow allready done...then what?<br /><br />MOV destination,source ....<br /><br />Is the standard notation for Intel(c) so i see no odd here ;)</div>
    <div class="meta">Posted on 2001-07-24 17:59:51 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-1924">
    <div class="subject"><a href="#post-1924">Can I get some help here?</a></div>
    <div class="body">Nonononono, I don't want you to do it, its ALREADY DONE... I wanted you guys to CHECK it... Really only the last part:<br /><br />ADD16: <br /><br />MOV A, XL <br />ADD A, YL <br />MOV ZL, A <br />MOV A, XH <br />ADDC A, YH <br />MOV ZH, A <br /><br />RET <br /><br /><br /><br />SUB16: <br /><br />MOV 0D0h, #00h <br />MOV A, XL <br />SUBB A, YL <br />MOV ZL, A <br />MOV A, XH <br />SUBB A, YH <br />MOV A, ZH <br /><br />RET</div>
    <div class="meta">Posted on 2001-07-24 18:14:15 by The Lost</div>
   </div>
   <div class="post" id="post-1981">
    <div class="subject"><a href="#post-1981">Can I get some help here?</a></div>
    <div class="body">I think you forgot something, what if XL+YL don't fit in A (if I understood A is 8 bits) ?<br /><br />(s)</div>
    <div class="meta">Posted on 2001-07-25 10:33:45 by (scalp)</div>
   </div>
   <div class="post" id="post-1982">
    <div class="subject"><a href="#post-1982">Can I get some help here?</a></div>
    <div class="body">There's a tutorial <a target="_blank" href="http://www.8052.com">here</a>.</div>
    <div class="meta">Posted on 2001-07-25 10:42:30 by Dr. Manhattan</div>
   </div>
   <div class="post" id="post-1983">
    <div class="subject"><a href="#post-1983">Can I get some help here?</a></div>
    <div class="body">this reminds me on old z80 days. And which statement does clear carry flag in SUB16?<br /><br />SUB16: <br /><br />MOV 0D0h, #00h    ;dont know<br />CLR C                     ; isnt this statement missing?<br />MOV A, XL <br />SUBB A, YL                  <br />MOV ZL, A <br />MOV A, XH <br />SUBB A, YH<br />MOV A, ZH             ;i think this should be MOV ZH,A instead<br /><br />RET</div>
    <div class="meta">Posted on 2001-07-25 11:16:05 by Unregistered</div>
   </div>
   <div class="post" id="post-1986">
    <div class="subject"><a href="#post-1986">Can I get some help here?</a></div>
    <div class="body">This thread really belongs in The Heap.<br /><br />To (scalp):  The carry is handled by ADDC.<br /><br />To The Lost:<br /><br />Well, I thought you forgot to initialize the carry for the subtract, but then I had to go check the '51 manual to verify the SFR you are using is correct.<br /><br />Although MOV 0D0h,#00h clears the C flag, it is bad practice for several reasons.<br /><br />1) Obscurity.  '51 assemblers will either predefine or allow the definition of the name &quot;PSW&quot; for this register.<br /><br />2) Correctness. It affects more than just the C flag. There are three bits you don't want to change unless the change is really needed.<br /><br />3) Size. The more obvious CLR C instruction is one byte long, as opposed to three bytes for MOV 0D0h,#00h.<br /><br />4) Speed. CLR C takes one machine cycle, MOV 0D0h,#00h takes two or three cycles (depending on '51 variant).</div>
    <div class="meta">Posted on 2001-07-25 12:04:59 by tank</div>
   </div>
   <div class="post" id="post-2080">
    <div class="subject"><a href="#post-2080">Can I get some help here?</a></div>
    <div class="body">thanx Tank but I knew that but I didn't want to resolve it<br /><br />(s)</div>
    <div class="meta">Posted on 2001-07-26 13:51:40 by (scalp)</div>
   </div>
  </div>
 </body>
</html>