<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Uhm.. help. Strangest bug ever. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9827" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9827">Uhm.. help. Strangest bug ever.</a></p>
   <div class="post" id="post-73173">
    <div class="subject"><a href="#post-73173">Uhm.. help. Strangest bug ever.</a></div>
    <div class="body">The problem seems to be with these two lines:<br /><br /><pre><code><br />invoke GetProcessHeap<br />invoke HeapAlloc,eax,HEAP_ZERO_MEMORY,sizeof LayeredListboxInfo<br /></code></pre><br /><br />If I leave them uncommented, I get the following error message when starting my program:<br /><br />---------------------------<br />Main Window: pngskin.exe - Unable To Locate Component<br />---------------------------<br />This application has failed to start because WINSTA.dll was not found. Re-installing the application may fix this problem. <br />---------------------------<br />OK   <br />---------------------------<br /><br />I have no clue what WINSTA.DLL is, and I certainly don't use it. All is well when I remove those two lines. Anybody have a clue as to what is going on?</div>
    <div class="meta">Posted on 2002-12-29 07:04:48 by Qweerdy</div>
   </div>
   <div class="post" id="post-73186">
    <div class="subject"><a href="#post-73186">Uhm.. help. Strangest bug ever.</a></div>
    <div class="body">:) Hello,<br /><br />I don't know about your problem, but I did a lil research and found that DLL is part of WinXP service pack 1. I looked on MSDN to find that. Not sure it helps... :( ... but maybe a start for you.<br /><br />If you want to check there to, you can search better, since you will know what better and whats useless. ;) In canse you wanna a lil push, check my latest threads on win's dll... some usefull links there too.<br /><br />Regards,<br /><br /><strong>Wicr0s0ft</strong><br /><br />Other thing I just bumped on: the dll is associated with &quot;win station&quot;... maybe thats his name! :eek: ... anyway, good luck. </div>
    <div class="meta">Posted on 2002-12-29 07:57:46 by wicr0s0ft</div>
   </div>
   <div class="post" id="post-73301">
    <div class="subject"><a href="#post-73301">Uhm.. help. Strangest bug ever.</a></div>
    <div class="body">Qweerdy,<br />where is LayeredListboxInfo declared? And why do you not check for a NULL pointer in eax before calling HeapAlloc? (calling GetProcessHeap should never fail, but what if it *is*?). Do you still get the error if you only comment out the HeapAlloc line?</div>
    <div class="meta">Posted on 2002-12-29 20:13:02 by sluggy</div>
   </div>
   <div class="post" id="post-73315">
    <div class="subject"><a href="#post-73315">Uhm.. help. Strangest bug ever.</a></div>
    <div class="body">How are you storing data into the allocated structure?<br />If you're properly preserving registers, then I'm guessing you're not properly using the pointer from HeapAlloc.</div>
    <div class="meta">Posted on 2002-12-29 22:39:47 by tenkey</div>
   </div>
  </div>
 </body>
</html>