<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>The dreaded ClassMap Build problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=954" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=954">The dreaded ClassMap Build problem</a></p>
   <div class="post" id="post-6178">
    <div class="subject"><a href="#post-6178">The dreaded ClassMap Build problem</a></div>
    <div class="body">Ah yes, ClassMap will haunt me for the rest of my days.<br /><br />  A ClassMap is a pointer to a list of classes contained inside a dll. CoLib was orgionally written to enable making such, but I soon found other uses for it.<br /><br />  However, CoLib 1.0 DEMANDS a ClassMap. Version 1.1 (in Sp2) fixes this problem. I just downloaded a fresh copy to check this, and my LoadPic.asm compiled fine with it.<br /><br />  If you keep having trouble, just define:<br /><br />ClassMap   DWORD    0   ; dummy value<br /><br />  This will make the linker happy. You'll have a small bit of never executed code in your .exe, but it will work.<br /><br />(Seems this is a heavy week for people emailing having build problems with this, so I hope I spare people some debug time. GET THE NEWEST VERION, willyas? Thank you.)</div>
    <div class="meta">Posted on 2001-09-04 18:02:28 by Ernie</div>
   </div>
   <div class="post" id="post-6315">
    <div class="subject"><a href="#post-6315">The dreaded ClassMap Build problem</a></div>
    <div class="body">I realize I've talked about this in another Thread.. but for those who might pull this Thread up in a search under &quot;ClassMap&quot; etc.<br /><br />I discovered a major key to the error is compiling with Windows.inc 1.25, regardless if you gotten the most recient package!.  <br /><br />Solution: Compile on an earlier version of windows, or do what Ernie sugested.<br /><br />NaN</div>
    <div class="meta">Posted on 2001-09-05 22:58:23 by NaN</div>
   </div>
   <div class="post" id="post-6331">
    <div class="subject"><a href="#post-6331">The dreaded ClassMap Build problem</a></div>
    <div class="body">Dang it, I forgot all about windows.inc. Yeah, it can cause some serious problems. <br /><br />Personally, I still use version 1.19. That's why I don't have these problems.<br /><br />Icz and I tried to eliminate this stuff for 1.25, I had a perliminary copy and I cut tons of stuff out. But from what Nan describes, I didn't cut far enough.<br /><br />Nan, see if windows.inc is declaring the protos for the 5 basic COM dll exports My guess is he's defined DllGetClassObject's proto, so the linker adds that out of CoLib, and that proc needs the (defined elsewhere) ClassMap. Bingo, build fails.<br /><br />My best advice is we handle this as a bug report for Icz (he's very accomodating with these things) and comment out of the current windows.inc. Hopefully,m the next revision of that inc file will be nicer to us.<br /><br />The other thing to try is use windows.inc version 1.19, it's available on my site (link above on button).</div>
    <div class="meta">Posted on 2001-09-06 06:41:18 by Ernie</div>
   </div>
   <div class="post" id="post-6357">
    <div class="subject"><a href="#post-6357">The dreaded ClassMap Build problem</a></div>
    <div class="body">Im not sure what you want me to coment out here.. or all of it...? but this is the com stuff at the end of windows 1.25:<pre><code><br />; Object API Prototypes<br />;----------------------------------------------------------------------------<br /><br />CoBuildVersion PROTO<br /><br />CoInitialize PROTO &#58;DWORD<br />CoUninitialize PROTO<br />CoGetMalloc PROTO &#58;DWORD, &#58;DWORD<br />CoGetCurrentProcess PROTO<br />CoRegisterMallocSpy PROTO &#58;DWORD<br />CoRevokeMallocSpy PROTO<br />CoCreateStandardMalloc PROTO &#58;DWORD, &#58;DWORD<br /><br />DebugCoGetRpcFault PROTO<br />DebugCoSetRpcFault PROTO &#58;DWORD<br /><br />CoGetClassObject PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CoRegisterClassObject PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CoRevokeClassObject PROTO &#58;DWORD<br /><br />CoGetMarshalSizeMax PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CoMarshalInterface PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CoUnmarshalInterface PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CoMarshalHresult PROTO &#58;DWORD, &#58;DWORD<br />CoUnmarshalHresult PROTO &#58;DWORD, &#58;DWORD<br />CoReleaseMarshalData PROTO &#58;DWORD<br />CoDisconnectObject PROTO &#58;DWORD, &#58;DWORD<br />CoLockObjectExternal PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CoGetStandardMarshal PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br /><br />CoIsHandlerConnected PROTO &#58;DWORD<br />CoHasStrongExternalConnections PROTO &#58;DWORD<br />CoMarshalInterThreadInterfaceInStream PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CoGetInterfaceAndReleaseStream PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CoCreateFreeThreadedMarshaler PROTO &#58;DWORD, &#58;DWORD<br /><br />CoLoadLibrary PROTO &#58;DWORD, &#58;DWORD<br />CoFreeLibrary PROTO &#58;DWORD<br />CoFreeAllLibraries PROTO<br />CoFreeUnusedLibraries PROTO<br /><br />CoCreateInstance PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br /><br />StringFromCLSID PROTO &#58;DWORD, &#58;DWORD<br />CLSIDFromString PROTO &#58;DWORD, &#58;DWORD<br />StringFromIID PROTO &#58;DWORD, &#58;DWORD<br />IIDFromString PROTO &#58;DWORD, &#58;DWORD<br />CoIsOle1Class PROTO &#58;DWORD<br />ProgIDFromCLSID PROTO &#58;DWORD, &#58;DWORD<br />CLSIDFromProgID PROTO &#58;DWORD, &#58;DWORD<br />StringFromGUID2 PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br /><br />CoCreateGuid PROTO &#58;DWORD<br />CoFileTimeToDosDateTime PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CoDosDateTimeToFileTime PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CoFileTimeNow PROTO &#58;DWORD<br /><br />CoRegisterMessageFilter PROTO &#58;DWORD, &#58;DWORD<br />CoGetTreatAsClass PROTO &#58;DWORD, &#58;DWORD<br />CoTreatAsClass PROTO &#58;DWORD, &#58;DWORD<br /><br />DllGetClassObject PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br />DllCanUnloadNow PROTO<br /><br />CoTaskMemAlloc PROTO &#58;DWORD<br />CoTaskMemRealloc PROTO &#58;DWORD, &#58;DWORD<br />CoTaskMemFree PROTO &#58;DWORD<br /><br />;CreateDataAdviseHolder PROTO &#58;DWORD, &#58;DWORD<br />CreateDataCache        PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br /><br /><br />StgCreateDocfile PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />StgCreateDocfileOnILockBytes PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br /><br />StgOpenStorage PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />StgOpenStorageOnILockBytes PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />StgIsStorageFile PROTO &#58;DWORD<br />StgIsStorageILockBytes PROTO &#58;DWORD<br /><br />StgSetTimes PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br /><br />BindMoniker PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />MkParseDisplayName PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />MonikerRelativePathTo PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD, &#58;DWORD<br />MonikerCommonPrefixWith PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CreateBindCtx PROTO &#58;DWORD, &#58;DWORD<br />CreateGenericComposite PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br />GetClassFile PROTO &#58;DWORD, &#58;DWORD<br /><br />CreateFileMoniker PROTO &#58;DWORD, &#58;DWORD<br />CreateItemMoniker PROTO &#58;DWORD, &#58;DWORD, &#58;DWORD<br />CreateAntiMoniker PROTO &#58;DWORD<br />CreatePointerMoniker PROTO &#58;DWORD, &#58;DWORD<br />GetRunningObjectTable PROTO &#58;DWORD, &#58;DWORD<br /><br />IID   STRUCT DWORD<br />    Data1        dd ?<br />    Data2        dw ?<br />    Data3        dw ?<br />    Data4        db 8 dup&#40;?&#41;<br />IID ENDS</code></pre><br /><br />but &quot;DllGetClassObject PROTO :DWORD, :DWORD, :DWORD&quot; is in here... and when this alown is commented out it compiles fine...  thanx Ernie... I was still stumped on the reasons until you posted your reply.. I peviously searched both for a &quot;ClassMap&quot; but was dissapointed to learn neither version had one...<br /><br />NaN</div>
    <div class="meta">Posted on 2001-09-06 12:45:09 by NaN</div>
   </div>
  </div>
 </body>
</html>