<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Can i check if someone is behind router (MASQUARADE) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22145" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=22145">Can i check if someone is behind router (MASQUARADE)</a></p>
   <div class="post" id="post-166674">
    <div class="subject"><a href="#post-166674">Can i check if someone is behind router (MASQUARADE)</a></div>
    <div class="body">OK i have go 2 computers behind the router I&#39;m using MASQUARADE my inner computers have got address like 192.168........ Since I&#39;m using NAT is there a possibility for someone from outer network to find out that I&#39;m using more than one computer. ??</div>
    <div class="meta">Posted on 2005-10-04 13:34:42 by AceEmbler</div>
   </div>
   <div class="post" id="post-166678">
    <div class="subject"><a href="#post-166678">Re: Can i check if someone is behind router (MASQUARADE)</a></div>
    <div class="body">Hm, theoretically yes. I can&#39;t remember the details and it was pretty technical, but there was some way where you could at least make good guesstimates. It&#39;s not something I would worry about, unless you&#39;re doing something you shouldn&#39;t :)<br /><br />It would be nice to find the article again, though, it was an interesting read.<br /></div>
    <div class="meta">Posted on 2005-10-04 15:52:32 by f0dder</div>
   </div>
   <div class="post" id="post-166680">
    <div class="subject"><a href="#post-166680">Re: Can i check if someone is behind router (MASQUARADE)</a></div>
    <div class="body">f0dder is right, it&#39;s possible. <br /><br /><br />Some fields in IP packets could be used to determine if you are using a single machine or a whole network of IP masqueraded machines. <br />When IP packet is created TTL (time to live) field set to 128 (or 255) and ID field set to some sequential number. <br />Now two different things happen when using single machine vs number of machines behind nat/masquerading. If it&#39;s a single computer then packets arrive at destination with unchanged TTL 128 (or 255) and ID of some single sequence (1st packet - 30000, 2nd packet -30001, etc.) <br /><br />For machines behind NAT or IP masquerading the story is a bit different. TTL field gets decremented once it passes a forwarding device and each machine sets it&#39;s own sequence for ID field. So at destination packets arrive with TTL less then 128 (or 255) and IDs with different sequences (1st packet - 30000, 2nd packet -30001, 3rd - 10010, 4th - 10011, etc). The ID fields then could be used to determine number of machines on the network. <br /><br />Btw, this is how ISPs determine if you are connecting a single pc or a number of pcs to their server. My ISP for example, till recently used to have different billing prices depending on the amount of pcs you&#39;ll be connecting.&nbsp;  :mad:</div>
    <div class="meta">Posted on 2005-10-04 17:17:21 by arafel</div>
   </div>
   <div class="post" id="post-166681">
    <div class="subject"><a href="#post-166681">Re: Can i check if someone is behind router (MASQUARADE)</a></div>
    <div class="body">This could be handled, though, if your NAT software does some a bit-more-than-trivial packet rewriting, I guess?<br /></div>
    <div class="meta">Posted on 2005-10-04 17:24:09 by f0dder</div>
   </div>
   <div class="post" id="post-166683">
    <div class="subject"><a href="#post-166683">Re: Can i check if someone is behind router (MASQUARADE)</a></div>
    <div class="body">Yeah, I guess it could be fooled by restoring the TTL and synchronizing IDa sequences among the machines. </div>
    <div class="meta">Posted on 2005-10-04 17:37:08 by arafel</div>
   </div>
   <div class="post" id="post-166686">
    <div class="subject"><a href="#post-166686">Re: Can i check if someone is behind router (MASQUARADE)</a></div>
    <div class="body"><div class="quote"><br />Hm, theoretically yes. I can&#39;t remember the details and it was pretty technical, but there was some way where you could at least make good guesstimates. It&#39;s not something I would worry about, unless you&#39;re doing something you shouldn&#39;t :)<br /><br />It would be nice to find the article again, though, it was an interesting read.<br /><br /></div><br /><br />Yep I&#39;m doing something i shouldn&#39;t but this guy who is giving me access to internet does not pay taxes for it, so I&#39;m feeling justified&nbsp; :P<br /><br />Thx guys for the answears, it looks like i will have to dust some old machine for a Linux router.</div>
    <div class="meta">Posted on 2005-10-04 18:15:02 by AceEmbler</div>
   </div>
   <div class="post" id="post-166849">
    <div class="subject"><a href="#post-166849">Re: Can i check if someone is behind router (MASQUARADE)</a></div>
    <div class="body">Unless it is simple HTTP it is nOT going to work... the router that is masquerading (be it Linux or whatever) will need to know the destination of incoming UDP and ICMP and other low level packets... it can only be done by packet tagging and this will be noticed by the ISP ...<br /><br />Basically ISP will always know ;)&nbsp;  if it wants to...<br /></div>
    <div class="meta">Posted on 2005-10-12 01:46:54 by BogdanOntanu</div>
   </div>
  </div>
 </body>
</html>