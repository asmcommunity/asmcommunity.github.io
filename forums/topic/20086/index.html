<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>My 1ST OBJECT! - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20086" />
    <link rel="next" href="../?id=20086&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=38">Object Oriented Programming</a> &raquo; <a href="../?id=20086">My 1ST OBJECT!</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=20086&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=20086&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="20086" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=20086&amp;page=2">&gt;</a><a href="../?id=20086&amp;page=2">&raquo;</a></form>   <div class="post" id="post-153913">
    <div class="subject"><a href="#post-153913">My 1ST OBJECT!</a></div>
    <div class="body">Hi.<br /><br />At last, I tryed to do something on OOP, it was quite easy, and using the Object in programm is soo cool and easy (:<br /><br />I made CData, the idea is to have a big buffer, and keep some multiple &quot;Named&quot; information in it. Like variables in mIRC:<br /><pre><code>%var1 = ABCDEF<br />%var2 = GGG<br />%var3 = 9090<br />Then they are stored in variables.ini, but that requires<br />smart string operations.<br /></code></pre><br />This simple Object can ADD, REMOVE, and RENEW(remove then add) data.<br /><br />http://www.hot.ee/valk777/data.rar<br /><br />Special thanks to: NaN, Thomas for creating Object Creator and object.inc</div>
    <div class="meta">Posted on 2004-12-08 16:01:31 by zabnik</div>
   </div>
   <div class="post" id="post-153939">
    <div class="subject"><a href="#post-153939">My 1ST OBJECT!</a></div>
    <div class="body">Hi zabnik!<br />It's fine to see a new OOPer here!<br />My suggestion here is to switch to ObjAsm32 as soon as possible. The model you are using has been discontinued and ObjAsm32 contains all the features of NaN's old model. Check this post <a target="_blank" href="http://www.asmcommunity.net/board/viewtopic.php?t=17620">http://www.asmcommunity.net/board/viewtopic.php?t=17620</a><br /><br />Regards and good luck  8) <br /><br />Biterider</div>
    <div class="meta">Posted on 2004-12-09 01:10:12 by Biterider</div>
   </div>
   <div class="post" id="post-153953">
    <div class="subject"><a href="#post-153953">My 1ST OBJECT!</a></div>
    <div class="body">it is very different</div>
    <div class="meta">Posted on 2004-12-09 10:20:58 by zabnik</div>
   </div>
   <div class="post" id="post-153955">
    <div class="subject"><a href="#post-153955">My 1ST OBJECT!</a></div>
    <div class="body">Hi zabnik<br />If you look under the surface, you will see a lot of equivalences. OA32 has a more elaborated syntax to make things easier and extensions that allow the use of COM interfaces and events.<br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-12-09 10:35:31 by Biterider</div>
   </div>
   <div class="post" id="post-153956">
    <div class="subject"><a href="#post-153956">My 1ST OBJECT!</a></div>
    <div class="body">Wow! New objects.inc is very scary inside, I think I need few week's to understand how to make object.</div>
    <div class="meta">Posted on 2004-12-09 11:21:31 by zabnik</div>
   </div>
   <div class="post" id="post-153964">
    <div class="subject"><a href="#post-153964">My 1ST OBJECT!</a></div>
    <div class="body">To start up using the model, I recommend the use of the documentation or directly one of the first demos. Much of the code is commented and the macros are self explanatory.<br /> <br />Your are right, the Objects.inc file looks pretty complex due the fact that there are a lot of checks and error reporting macros build in. These aside, the core of this model and all other OOP models is the construction of structures and templates and the corresponding procs to handle them.<br />You will see that there are macro and code libraries for all common tasks for your asm coding daily business.<br /><br />If you have problems to start up, I will be glad to help you.<br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-12-09 14:01:54 by Biterider</div>
   </div>
   <div class="post" id="post-153998">
    <div class="subject"><a href="#post-153998">My 1ST OBJECT!</a></div>
    <div class="body">Whats the diference between this:<br /><br />RedefineMethod<br />StaticMethod<br />PrivateMethod<br />DynamicMethod<br /><br />and <br /><br />DefineVariable<br />RedefineVariable<br /><br />?</div>
    <div class="meta">Posted on 2004-12-10 15:41:25 by zabnik</div>
   </div>
   <div class="post" id="post-154000">
    <div class="subject"><a href="#post-154000">My 1ST OBJECT!</a></div>
    <div class="body">!!!<br />http://www.hot.ee/valk777/data2.rar<br /><br />Done, now CData with new OOP Base. But im still don't know why<br />Static,dynamic,redefine -method. And I know nothing about Inhertance.</div>
    <div class="meta">Posted on 2004-12-10 17:02:18 by zabnik</div>
   </div>
   <div class="post" id="post-154010">
    <div class="subject"><a href="#post-154010">My 1ST OBJECT!</a></div>
    <div class="body">Hi zabnik<br />Really good work! I have seen from your code that you are doing the learning curve pretty fast?<br /><br />Here my thoughts about the work:<br />1.	The EndMethod macro has some build in features: one of them is the ReleaseObject/ret instruction set. By this way it is not necessary to write them at the end of the method  8) .<br />2.	EndMethod also includes a label called @@EOM (End Of Method) to directly jump out of the method.<br />3.	You have a handy macro to create dynamic memory blocks called MemAlloc. Check your Memory.inc file.<br />4.	Use Demo12 to check the correct preservation of the registers (Checks menu option). BTW, you don?t need to preserve ecx.<br /><br />To your questions<br />You have seen that we have 3 types of methods: StaticMethod, DynamicMethod, and InterfaceMethod. The last one is supposed for the use with COM.<br />The first 2 are the most important. A static method is a procedure that is linked to the object through its internal method table (in the model called SMT = Static method table). Since the SMT is common to all object instances, if you make a change there, it will be reflected on all instances (superclassing). But what about if you only want to change the behavior of a single instance? Now comes DynamicMethod into the game. Dynamicmethod links your procedure to the object instance through a hidden object variable. This way, each object can manage a different procedure with the same name! This is a sort of subclassing.<br />Most of the times you have to deal with static methods.<br />All inheritance rules apply to these 3 method types.<br />Finally, PrivateMethod is a variation of a StaticMethod. It is used when you want to protect some methods to be used from outside the scope of its object. (This is a more advanced topic)<br /><br />The RedefineMethod macro is intended to replace an inherited method that is defined somewhere in one of the parents. You can replace the method completely. Usually this is not the case, since you want to reuse the code of your parent. This is achieved using the ACall (Ancestor call), usually at the beginning of a constructor method and at the end of a destructor method.<br /><br />Note that the universal destructor ?Done? is called automatically when you call the Destroy macro.<br /><br />DefineVariable is used to define the type and initial value of an object variable. You can redefine the initial value in a descendant using the RedefineVariable macro.<br /><br />I hope this helps a little bit?<br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-12-11 03:58:23 by Biterider</div>
   </div>
   <div class="post" id="post-154194">
    <div class="subject"><a href="#post-154194">My 1ST OBJECT!</a></div>
    <div class="body">PROBLEM IN NEW OOP MODEL:<br /><br />I was doing some simple stuff... learning OOP (:<br />But this one won't compile<br /><br /><pre><code>Method _lstr.replace,uses edi,buffa&#58;DWORD,replacewhat&#58;BYTE,replaceto&#58;BYTE<br />   ; cuted...<br />MethodEnd<br />...<br />OCall hlstr&#58;&#58;_lstr.replace,addr buffer,&quot;\&quot;,02Fh<br />...<br />ProbnikGL.asm&#40;166&#41; &#58; error A2008&#58; syntax error &#58; in directive<br /> MacroLoop&#40;1&#41;&#58; iteration 1&#58; Macro Called From <br />  String&#40;7&#41;&#58; Macro Called From<br />   $OfsCStrX&#40;5&#41;&#58; Macro Called From<br />    MacroLoop&#40;2&#41;&#58; iteration 3&#58; Macro Called From <br />     @invoke&#40;11&#41;&#58; Macro Called From<br />      ObjectCall&#40;46&#41;&#58; Macro Called From<br />       OCall&#40;63&#41;&#58; Macro Called From<br />        ProbnikGL.asm&#40;166&#41;&#58; Main Line Code<br />ProbnikGL.asm&#40;166&#41; &#58; error A2006&#58; undefined symbol &#58; ??0694<br /> @invoke&#40;12&#41;&#58; Macro Called From<br />  ObjectCall&#40;46&#41;&#58; Macro Called From<br />   OCall&#40;63&#41;&#58; Macro Called From<br />    ProbnikGL.asm&#40;166&#41;&#58; Main Line Code<br />ProbnikGL.asm&#40;166&#41; &#58; error A2114&#58; INVOKE argument type mismatch &#58; argument &#58; 3<br /> @invoke&#40;12&#41;&#58; Macro Called From<br />  ObjectCall&#40;46&#41;&#58; Macro Called From<br />   OCall&#40;63&#41;&#58; Macro Called From<br />    ProbnikGL.asm&#40;166&#41;&#58; Main Line Code</code></pre><br /><br />So I have to use 05Ch istead of &quot;\&quot;.</div>
    <div class="meta">Posted on 2004-12-15 08:31:17 by zabnik</div>
   </div>
   <div class="post" id="post-154199">
    <div class="subject"><a href="#post-154199">Current solution</a></div>
    <div class="body">Hi zabnik<br />Thanks for the warning. I have detected the problem since a few days. It is a bug introduced with the last revision, concerning the handling of string shortcuts (i.e. ?\n?) in the $ConvEscSeqs macro located in the system.inc file.<br />You will see that the registrations of the COM servers are also affected.<br /><br />To solve this problem use $OfsCStr(?\?) in place of  ?\? in the problematic code line.  :) <br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-12-15 09:15:28 by Biterider</div>
   </div>
   <div class="post" id="post-154207">
    <div class="subject"><a href="#post-154207">My 1ST OBJECT!</a></div>
    <div class="body">Nothing problematic, just converting ASCII to HEX takes time (:<br />And... $OfsCStr(&quot;\&quot;)<br /><br /><pre><code>OCall hlstr&#58;&#58;_lstr.replace,addr buffer,$OfsCStr&#40;&quot;\&quot;&#41;,02Fh<br />...<br />ProbnikGL.asm&#40;542&#41; &#58; error A2114&#58; INVOKE argument type mismatch &#58; argument &#58; 3<br /> @invoke&#40;12&#41;&#58; Macro Called From<br />  ObjectCall&#40;46&#41;&#58; Macro Called From<br />   OCall&#40;63&#41;&#58; Macro Called From<br />    ProbnikGL.asm&#40;542&#41;&#58; Main Line Code<br /><br />...<br /><br />; and I had tryed this one&#58;<br />OCall hlstr&#58;&#58;_lstr.replace,addr buffer,$OfsCStr&#40;?\?&#41;,02Fh<br />...<br />ProbnikGL.asm&#40;542&#41; &#58; error A2044&#58; invalid character in file<br /> MacroLoop&#40;1&#41;&#58; iteration 1&#58; Macro Called From <br />  String&#40;7&#41;&#58; Macro Called From<br />   $OfsCStr&#40;4&#41;&#58; Macro Called From<br />    OCall&#40;1&#41;&#58; Macro Called From<br />     ProbnikGL.asm&#40;542&#41;&#58; Main Line Code<br />ProbnikGL.asm&#40;542&#41; &#58; error A2006&#58; undefined symbol &#58; ??0B6D<br /> @invoke&#40;12&#41;&#58; Macro Called From<br />  ObjectCall&#40;46&#41;&#58; Macro Called From<br />   OCall&#40;63&#41;&#58; Macro Called From<br />    ProbnikGL.asm&#40;542&#41;&#58; Main Line Code<br />ProbnikGL.asm&#40;542&#41; &#58; error A2114&#58; INVOKE argument type mismatch &#58; argument &#58; 3<br /> @invoke&#40;12&#41;&#58; Macro Called From<br />  ObjectCall&#40;46&#41;&#58; Macro Called From<br />   OCall&#40;63&#41;&#58; Macro Called From<br />    ProbnikGL.asm&#40;542&#41;&#58; Main Line Code</code></pre>nasty...</div>
    <div class="meta">Posted on 2004-12-15 14:58:04 by zabnik</div>
   </div>
   <div class="post" id="post-154208">
    <div class="subject"><a href="#post-154208">My 1ST OBJECT!</a></div>
    <div class="body">Hi zabnik<br />In your case, you are trying to pass a byte value to your method. If you use double quotes, you are signalizing that you will pass an offset to a string allocated in the .const segment. The right syntax in this case to pass a byte value is using single quotes, like ?\?. <br /><br /><pre><code>OCall hlstr&#58;&#58;_lstr.replace,addr buffer,?\?, ?/?</code></pre><br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-12-15 15:54:17 by Biterider</div>
   </div>
   <div class="post" id="post-154217">
    <div class="subject"><a href="#post-154217">My 1ST OBJECT!</a></div>
    <div class="body">zabnik,<br /><br />First off, im glad to see your inspired to learn our newest OOP model.  Biterider has far exceeded our origional model (NaN &amp; Thomas) and it is worth learning the newest versions. <br /><br />That said, i understand your confusions as the newest model had far more in the capabilities as well as places to go wrong (the unfortunate paradox that haunts all projects).<br /><br />All this aside, your probably doing quite well with your own R&amp;D into the architecture.  So if you dont mind, post your source and we can help you learn giving you corrections and/or suggestions to achieve your ideas.  (It also helps us by getting a better idea of where the stumbling blocks are for beginners (another paradox for those who develope such things ;) )<br /><br />Best of luck!<br />Regards,<br />:NaN:</div>
    <div class="meta">Posted on 2004-12-15 21:37:55 by NaN</div>
   </div>
   <div class="post" id="post-154244">
    <div class="subject"><a href="#post-154244">My 1ST OBJECT!</a></div>
    <div class="body"><pre><code>OCall hlstr&#58;&#58;_lstr.replace,addr buffer,?\?, ?/?</code></pre><br />Is working! Thank's. I post the full source a bit later, because Im OOP'ing my ProbnikGL (which load bsp maps), and not everything is done.</div>
    <div class="meta">Posted on 2004-12-16 08:25:07 by zabnik</div>
   </div>
   <div class="post" id="post-154262">
    <div class="subject"><a href="#post-154262">My 1ST OBJECT!</a></div>
    <div class="body">I updated, and uploaded: http://www.hot.ee/valk777/ProbnikGL_0_06.rar<br />What may I change to make it betted?</div>
    <div class="meta">Posted on 2004-12-16 14:13:41 by zabnik</div>
   </div>
   <div class="post" id="post-154279">
    <div class="subject"><a href="#post-154279">My 1ST OBJECT!</a></div>
    <div class="body">Hi zabnik<br />Thanks for posting your code! I took a look into it to check things concerning OOP and haven?t seen anything wrong.<br />Nevertheless some points need an explanation:<br />1. The MethodEnd macro includes the ret instruction, so you don?t need to type it at the end of your methods.<br />2. The register preservation rule indicates to preserve ebx, edi and esi. All other registers can be changed freely. The ?uses? statement can be restricted to these 3 registers (if used) to save unnecessary push and pops. Demo12 checking tools give me 4 files where the register preservation failed: Camera.inc, Frustum.inc, lstr.inc, Quake3Bsp.inc. Little changes here will guarantee a better stability of your app!<br />3. To improve your typing work, some macro parameters are taken by defaults. I.e., the SetObject macro takes it second parameter from the current method scope. The line 455 in the Quake3Bsp.inc file can be simply written as SetObject edi. The same rule applies to the XCalls. Line 514 can be written as OCall edi.RenderFace, ?<br /><br />Unfortunately, I can?t compile your work, since I miss some files. The exe file works pretty well on my box! Congrats!  :alright: <br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-12-17 02:08:35 by Biterider</div>
   </div>
   <div class="post" id="post-154282">
    <div class="subject"><a href="#post-154282">My 1ST OBJECT!</a></div>
    <div class="body">Yeah, I see, forgot to check for missing files, but I uploaded, so you can compile it:<br />http://www.hot.ee/valk777/ProbnikGL_libs.rar<br /><br />Btw, Do I use these ID's correctly:<br /><pre><code>; #########################################################################<br />Quake3BspID		equ 0001<br />lstrID			equ 0002<br />FrustumID		equ 0003<br />CameraID			equ 0004<br />ImageID			equ 0005<br />FontID			equ 0006<br />QuaternionID	equ 0007<br />; #########################################################################<br />.data? ; OOP<br />	hBsp				dd ?<br />	hlstr				dd ?<br />	hFrustum			dd ?<br />	hCamera			dd ?<br />	hImage			dd ?<br />	hFont				dd ?<br />; #########################################################################<br />include lstr.inc<br />include Image.inc<br />include Quake3Bsp.inc<br />include Frustum.inc<br />include Camera.inc<br />include Font.inc<br />; #########################################################################</code></pre><br />And can I do something with inheritance stuff? Because all Object inheritance path is Primer, I want do something <u>ExTReMe</u>:<br /><pre><code>Inheritance path&#58; Primer<br />Inheritance path&#58; Primer - Streamable<br />Inheritance path&#58; Primer - _lstr<br />Inheritance path&#58; Primer - Image<br />Inheritance path&#58; Primer - Quake3Bsp<br />Inheritance path&#58; Primer - Frustum<br />Inheritance path&#58; Primer - Camera</code></pre><br />I just don't understand it, but I want to. (:</div>
    <div class="meta">Posted on 2004-12-17 07:09:29 by zabnik</div>
   </div>
   <div class="post" id="post-154358">
    <div class="subject"><a href="#post-154358">My 1ST OBJECT!</a></div>
    <div class="body">Hi zabnik<br />I recommend to check your own object IDs with the model IDs located in ObjAsm32\Objects\ObjIDs.inc file. It?s not a good idea to put your IDs in this file, since new model revisions will override it. Create your own MyObjIDs.inc file. The IDs are used to identify the objects, especially for error reporting and streaming (See Stream object).<br /><br />It?s a good idea to take a look into the ?collection? object. It?s a flexible and fast iterator. I used it also for the API -3D engine (Demo14) and I think it may be useful for you, too.  8) <br /><br />The inheritance path witch is shown when you compile your app, lets you know how the compilation of the object is done. In your case, all objects derive from Primer, since they have nothing in common. The clue with the OOP inheritance is to group properties and methods that are common to different objects and put them in a common ancestor. Check Demo1 to see this point.<br /><br />Regards, :alright: <br /><br />Biterider</div>
    <div class="meta">Posted on 2004-12-18 12:24:46 by Biterider</div>
   </div>
   <div class="post" id="post-154363">
    <div class="subject"><a href="#post-154363">My 1ST OBJECT!</a></div>
    <div class="body"><div class="quote">Create your own MyObjIDs.inc file.</div><br />Like this?:<br /><pre><code>; MyObjectID.inc<br />Quake3BspID		equ 0001<br />lstrID			equ 0002<br />FrustumID		equ 0003<br />CameraID			equ 0004<br />ImageID			equ 0005<br />FontID			equ 0006<br />QuaternionID	equ 0007<br /></code></pre><br /><br />...<br /><br />Look what I have done with inheritance:<br /><pre><code>Inheritance path&#58; Primer<br />Inheritance path&#58; Primer - Streamable<br />Inheritance path&#58; Primer - _lstr<br />Inheritance path&#58; Primer - Quake3Bsp<br />Inheritance path&#58; Primer - Quake3Bsp - Image<br />Inheritance path&#58; Primer - Camera<br />Inheritance path&#58; Primer - Camera - Frustum<br />Inheritance path&#58; Primer - Camera - Quaternions<br />Inheritance path&#58; Primer - Font</code></pre><br /><br />I found cool macro is System.inc<br /><pre><code>; So I convert this&#58;<br />	;mov eax,&#91;esi&#93;.BSP_HEADER.Faces._offset<br />	;add eax,&#91;edi&#93;.pMemBSP<br />	;mov &#91;edi&#93;.m_pFace,eax<br /><br />	;mov eax,&#91;esi&#93;.BSP_HEADER.Leafs._offset<br />	;add eax,&#91;edi&#93;.pMemBSP<br />	;mov &#91;edi&#93;.m_pLeaf,eax<br /><br />	;mov eax,&#91;esi&#93;.BSP_HEADER.Leaffaces._offset<br />	;add eax,&#91;edi&#93;.pMemBSP<br />	;mov &#91;edi&#93;.m_pLeafface,eax<br /><br />	;mov eax,&#91;esi&#93;.BSP_HEADER.Vertexes._offset<br />	;add eax,&#91;edi&#93;.pMemBSP<br />	;mov &#91;edi&#93;.m_pVertex,eax<br />; To this&#58;<br />	mov &#91;edi&#93;.m_pFace,$eax&#40;add $eax&#40;mov eax,&#91;esi&#93;.BSP_HEADER.Faces._offset&#41;,&#91;edi&#93;.pMemBSP&#41;<br />	mov &#91;edi&#93;.m_pLeaf,$eax&#40;add $eax&#40;mov eax,&#91;esi&#93;.BSP_HEADER.Leafs._offset&#41;,&#91;edi&#93;.pMemBSP&#41;<br />	mov &#91;edi&#93;.m_pLeafface,$eax&#40;add $eax&#40;mov eax,&#91;esi&#93;.BSP_HEADER.Leaffaces._offset&#41;,&#91;edi&#93;.pMemBSP&#41;<br />	mov &#91;edi&#93;.m_pVertex,$eax&#40;add $eax&#40;mov eax,&#91;esi&#93;.BSP_HEADER.Vertexes._offset&#41;,&#91;edi&#93;.pMemBSP&#41;</code></pre><br /><br />Also a mini problem: How to retrieve a variable contents from object?<br />I do this:<br /><pre><code>		.if &#91;$eax&#40;mov eax,hQuake3Bsp&#41;&#93;.Quake3Bsp.g_bTextures ; Turn texture mapping on/off<br />			mov &#91;eax&#93;.Quake3Bsp.g_bTextures,0<br />			push GL_TEXTURE1_ARB<br />			call glActiveTextureARB ; <br />			invoke glEnable,GL_TEXTURE_2D<br />		.else ; If we don't want texture mapping<br />			mov &#91;eax&#93;.Quake3Bsp.g_bTextures,1<br />			push GL_TEXTURE1_ARB<br />			call glActiveTextureARB<br />			invoke glDisable,GL_TEXTURE_2D ; Disable texture mapping<br />		.endif</code></pre><br />Maybe there is somewhere a cool macro, another solution, or Im doing that right? (:<br /><br />And have you tried compiling ProbnikGL?</div>
    <div class="meta">Posted on 2004-12-18 15:11:27 by zabnik</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=20086&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=20086&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="20086" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=20086&amp;page=2">&gt;</a><a href="../?id=20086&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>