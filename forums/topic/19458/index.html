<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Suggestion for dictionary program - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19458" />
    <link rel="next" href="../?id=19458&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19458">Suggestion for dictionary program</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=19458&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=19458&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="19458" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=19458&amp;page=2">&gt;</a><a href="../?id=19458&amp;page=2">&raquo;</a></form>   <div class="post" id="post-150009">
    <div class="subject"><a href="#post-150009">Suggestion for dictionary program</a></div>
    <div class="body">I'm creating a simple dictionary program and made most of it. I'm fetching the words and their meanings from a access database and I wonder if it would be faster if I use a simple structured file, from which I will fetch the data. Or even better - use Tsunami Record Manager? Which of these ways is best according the speed? Or is there another better?<br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-09-19 15:42:12 by siddhartha</div>
   </div>
   <div class="post" id="post-150334">
    <div class="subject"><a href="#post-150334">Suggestion for dictionary program</a></div>
    <div class="body">So, anybody with opinion on the topic? I don't think that no one of you has ever played with databases?!<br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-09-24 09:12:25 by siddhartha</div>
   </div>
   <div class="post" id="post-150335">
    <div class="subject"><a href="#post-150335">Suggestion for dictionary program</a></div>
    <div class="body">I love database programming. I always use access. I think the best way is to use ADO, but if you can't/don't want you can use ODBC. SQL is very simple. Creating a structured file would be difficoult and useless.<br /><br />You don't see speed differences between differen solutions, because your program doesn't stress the database</div>
    <div class="meta">Posted on 2004-09-24 09:18:55 by greenant</div>
   </div>
   <div class="post" id="post-150336">
    <div class="subject"><a href="#post-150336">Suggestion for dictionary program</a></div>
    <div class="body">So, I even don't know what ADO is. I use ODBC with Access and it works pretty well, but when testing it on some slower machines it turned out that it takes some time until all the words are populated into the listbox. I saw many dictionaries using a structured file and they don't have problems on slower computers. So my conclusion is that database is not the best choice for this kind of projects. I may be wrong and most probable is that I don't implement some parts of my program in the best way... So, some explanation about ADO and the other stuff is welcome! Thanks for the reply, <strong>greenant</strong>!<br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-09-24 09:31:57 by siddhartha</div>
   </div>
   <div class="post" id="post-150337">
    <div class="subject"><a href="#post-150337">Suggestion for dictionary program</a></div>
    <div class="body">the bottleneck is the listbox and not the database.<br />I'm programming a software, Gremaf, that has a listview. It reads from an access database and fill the listview. It has 16 columns and about 5500 rows. The first version used a normal listview, but now I use a VirtualListview and now the startup of the program is faster and column sorting is immediate (on my Duron 800).</div>
    <div class="meta">Posted on 2004-09-24 09:39:04 by greenant</div>
   </div>
   <div class="post" id="post-150339">
    <div class="subject"><a href="#post-150339">Suggestion for dictionary program</a></div>
    <div class="body">OK. So, you use a listview? Tell me if I'm getting you wrong, but you advise me to use listview instead of listbox? And another thing - initially I tried with listview, but I didn't manage to get it work like a listbox - I mean when you select an item in the listbox it selects not only the text but all the visible area of the row. Got it? So this is the reason why I use listbox. If there's a way to set listview's behaviour in to a similar way, then it's OK for me to use listview. Any link to get started with ADO? Thanks again!<br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-09-24 09:59:20 by siddhartha</div>
   </div>
   <div class="post" id="post-150340">
    <div class="subject"><a href="#post-150340">Suggestion for dictionary program</a></div>
    <div class="body">I'm not advising you to use a listview, because I don't know exactly what you are doing.<br /><br />ADO is a COM object and it is not so simple as other COM objects, like MsAgent. I use ADO only with C++ and not asm. The best ADO refercence is the MSDN.<br /><br />Can you send me your exe file, so I can understand exacly what you are doing?</div>
    <div class="meta">Posted on 2004-09-24 10:05:15 by greenant</div>
   </div>
   <div class="post" id="post-150341">
    <div class="subject"><a href="#post-150341">Suggestion for dictionary program</a></div>
    <div class="body">I case you want to use listviews... use the LVS_EX_FULLROWSELECT extended listview style. And if you want fast speed, use virtual listviews - it's pretty easy.</div>
    <div class="meta">Posted on 2004-09-24 10:06:16 by f0dder</div>
   </div>
   <div class="post" id="post-150345">
    <div class="subject"><a href="#post-150345">Suggestion for dictionary program</a></div>
    <div class="body">Thanks, <strong>f0dder</strong>! That was the thing I was looking for! Some explanations for the 'virtual listview'? What does it mean and how do I use it? Thanks for the patience!<br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-09-24 10:45:39 by siddhartha</div>
   </div>
   <div class="post" id="post-150346">
    <div class="subject"><a href="#post-150346">Suggestion for dictionary program</a></div>
    <div class="body">Virtual Listview means that, rather than you filling the listview with items, windows will send a notification message when it needs an item... it also sends some &quot;cache hints&quot; that you could use if it's slow to fetch an item from your database. Look it up in PlatformSDK - it's easy to use.</div>
    <div class="meta">Posted on 2004-09-24 10:48:40 by f0dder</div>
   </div>
   <div class="post" id="post-150350">
    <div class="subject"><a href="#post-150350">Suggestion for dictionary program</a></div>
    <div class="body">I have a Virtual ListView with a stable sort algo (merge sort), and a linked list to retrieve data from the database and store it in an array.<br />If you want you can look at the code<br />http://greenant.altervista.org -&gt; Gremaf</div>
    <div class="meta">Posted on 2004-09-24 10:52:19 by greenant</div>
   </div>
   <div class="post" id="post-150352">
    <div class="subject"><a href="#post-150352">Suggestion for dictionary program</a></div>
    <div class="body">OK. I don't have the PSDK on this computer, but when I get home after a while I'll take a look at it. Only one more question - does virtual listview mean that I won't be able to just drop the listview control on a dialog inside RadASM and I must create it with CreateWindow(Ex)? Thanks for the fast replies, <strong>f0dder</strong>!<br /><br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-09-24 10:53:21 by siddhartha</div>
   </div>
   <div class="post" id="post-150353">
    <div class="subject"><a href="#post-150353">Suggestion for dictionary program</a></div>
    <div class="body">The only difference is the LVS_OWNERDATA style.</div>
    <div class="meta">Posted on 2004-09-24 10:55:23 by greenant</div>
   </div>
   <div class="post" id="post-150354">
    <div class="subject"><a href="#post-150354">Suggestion for dictionary program</a></div>
    <div class="body">Humm, I think you can set the type at runtime? If not, it should be possible to change the flags somewhere in RadASM - or bug ketilo until he adds that feature ;). If you don't have PlatformSDK where you are, use http://msdn.microsoft.com ...</div>
    <div class="meta">Posted on 2004-09-24 10:55:27 by f0dder</div>
   </div>
   <div class="post" id="post-150355">
    <div class="subject"><a href="#post-150355">Suggestion for dictionary program</a></div>
    <div class="body">Thanks, <strong>greenant</strong>, I'll take a look! I've once downloaded Gremaf, but I wasn't interested in DB stuff so I deleted it. I think it should be very helpful for me in this very moment! Thanks again!<br /><br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-09-24 10:56:27 by siddhartha</div>
   </div>
   <div class="post" id="post-150357">
    <div class="subject"><a href="#post-150357">Suggestion for dictionary program</a></div>
    <div class="body"><div class="quote">The only difference is the LVS_OWNERDATA style.</div><br /><br /><br />You mean that if I directly set this style in RadASM I get a virtual listview? Or what?<br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-09-24 10:58:48 by siddhartha</div>
   </div>
   <div class="post" id="post-150358">
    <div class="subject"><a href="#post-150358">Suggestion for dictionary program</a></div>
    <div class="body">You get a virtuallistview but you should handle LNV_GETDISPINFO to show text.<br /><br />This is a sample code in C++ of a WM_NOTIFY handler for a VirtualListview<br /><br /><pre><code>long listview&#58;&#58;Notify&#40;LPNMHDR pHdr&#41;<br />&#123;<br />	switch&#40;pHdr-&gt;code&#41;<br />	&#123;<br />	case LVN_GETDISPINFO&#58;<br />		&#123;<br />			NMLVDISPINFO* pnmv = &#40;NMLVDISPINFO*&#41; pHdr;<br />			if &#40;pnmv-&gt;item.mask &amp; LVIF_TEXT&#41;<br />			&#123;<br />				long si = pnmv-&gt;item.iSubItem; <br />				long i = pnmv-&gt;item.iItem;<br />				switch&#40;si&#41;<br />				&#123;<br />				case LVC_DATA&#58;<br />					lstrcpy&#40;pnmv-&gt;item.pszText, pAnalisiStr&#91;i&#93;-&gt;data&#41;;<br />					break;<br />					<br />				case LVC_IMBALLO&#58;<br />					lstrcpy&#40;pnmv-&gt;item.pszText, pAnalisiStr&#91;i&#93;-&gt;imballo&#41;;<br />					break;<br />						<br />				case LVC_LOTTO&#58;<br />					lstrcpy&#40;pnmv-&gt;item.pszText, pAnalisiStr&#91;i&#93;-&gt;lotto&#41;;<br />					break;<br />						<br />......						<br />				case LVC_CLIENTE&#58;<br />					if&#40;pAnalisiVal&#91;i&#93;-&gt;cliente&#41;<br />						lstrcpy&#40;pnmv-&gt;item.pszText, pAnalisiStr&#91;i&#93;-&gt;cliente&#41;;<br />					else<br />						pnmv-&gt;item.pszText&#91;0&#93; = 0;<br />					break;<br />						<br />				case LVC_CONF&#58;<br />					lstrcpy&#40;pnmv-&gt;item.pszText, pAnalisiStr&#91;i&#93;-&gt;conforme&#41;;<br />					break;<br />						<br />				case LVC_NOTE&#58;<br />					lstrcpy&#40;pnmv-&gt;item.pszText, pAnalisiStr&#91;i&#93;-&gt;note&#41;;<br />					break;<br />				&#125;<br />			&#125;<br />		&#125;<br />		break;<br /><br />	case LVN_COLUMNCLICK&#58;<br />		SortOrder *= -1;<br />		Sort&#40;&#40;&#40;NMLISTVIEW*&#41; pHdr&#41;-&gt;iSubItem&#41;;<br />		break;<br /><br />	case NM_CUSTOMDRAW&#58;<br />		&#123;<br />			NMLVCUSTOMDRAW* nmcd = &#40;NMLVCUSTOMDRAW*&#41; pHdr;<br /><br />			switch&#40;nmcd-&gt;nmcd.dwDrawStage&#41;<br />			&#123;<br />		    case CDDS_PREPAINT &#58;<br />				return CDRF_NOTIFYITEMDRAW;<br /><br />			case CDDS_ITEMPREPAINT&#58;<br />				if&#40;pAnalisiVal&#91;nmcd-&gt;nmcd.dwItemSpec&#93;-&gt;conforme == CONF_VALUE&#41;<br />					return 0;<br />				else<br />					return CDRF_NOTIFYSUBITEMDRAW;<br /><br />			case &#40;CDDS_ITEMPREPAINT | CDDS_SUBITEM&#41;&#58;<br />				&#123;<br />				long conforme = pAnalisiVal&#91;nmcd-&gt;nmcd.dwItemSpec&#93;-&gt;conforme;<br />				switch&#40;nmcd-&gt;iSubItem&#41;<br />				&#123;<br />				case LVC_PH&#58;								//pH<br />					if&#40;conforme &amp; &#40;1&lt;&lt;4&#41;&#41;<br />						nmcd-&gt;clrText = CONF;<br />					else<br />						nmcd-&gt;clrText = NON_CONF;<br />					break;<br /><br />				case LVC_VISCO1&#58;							//Viscost?<br />					if&#40;conforme &amp; &#40;1&lt;&lt;3&#41;&#41;<br />						nmcd-&gt;clrText = CONF;<br />					else<br />						nmcd-&gt;clrText = NON_CONF;<br />					break;<br /><br />				case LVC_R30&#58;								//R30<br />					if&#40;conforme &amp; &#40;1&lt;&lt;2&#41;&#41;<br />						nmcd-&gt;clrText = CONF;<br />					else<br />						nmcd-&gt;clrText = NON_CONF;<br />					break;<br /><br />				case LVC_UMIDITA&#58;							//Umidit?<br />					if&#40;conforme &amp; &#40;1&lt;&lt;1&#41;&#41;<br />						nmcd-&gt;clrText = CONF;<br />					else<br />						nmcd-&gt;clrText = NON_CONF;<br />					break;<br /><br />				case LVC_IMPACCA&#58;							//Impaccamento<br />					if&#40;conforme &amp; &#40;1&#41;&#41;<br />						nmcd-&gt;clrText = CONF;<br />					else<br />						nmcd-&gt;clrText = NON_CONF;<br />					break;<br /><br />				case LVC_CONF&#58;								//Conforme<br />					if&#40;conforme == CONF_VALUE&#41;<br />						nmcd-&gt;clrText = CONF;<br />					else<br />						nmcd-&gt;clrText = NON_CONF;<br />					break;<br /><br />				default&#58;<br />					nmcd-&gt;clrText = CONF;<br />					break;<br /><br />				&#125;<br /><br />				return CDRF_NEWFONT;<br />				&#125;<br />			&#125;<br />		&#125;<br />	&#125;<br />	return 0;<br />&#125;<br /></code></pre></div>
    <div class="meta">Posted on 2004-09-24 11:02:28 by greenant</div>
   </div>
   <div class="post" id="post-150360">
    <div class="subject"><a href="#post-150360">Suggestion for dictionary program</a></div>
    <div class="body">Thanks for the fast and exact reply! I really appreciate it! I'll take a closer look later at home... I have a lot of homework for tonight :)<br /><br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-09-24 11:04:35 by siddhartha</div>
   </div>
   <div class="post" id="post-150404">
    <div class="subject"><a href="#post-150404">Suggestion for dictionary program</a></div>
    <div class="body">When doing this:<br /><br />invoke SendMessage,hList,LVM_SETEXTENDEDLISTVIEWSTYLE,LVS_EX_FULLROWSELECT,1<br /><br /><br />nothing happens. What am I doing wrong? Thanks in advance!<br /><br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-09-25 07:19:15 by siddhartha</div>
   </div>
   <div class="post" id="post-150407">
    <div class="subject"><a href="#post-150407">Suggestion for dictionary program</a></div>
    <div class="body"><div class="quote">Parameters<br /><br />dwExMask<br />DWORD value that specifies which styles in dwExStyle are to be affected. This parameter can be a combination of Extended List-View Styles. Only the extended styles in dwExMask will be changed. All other styles will be maintained as they are. If this parameter is zero, all of the styles in dwExStyle will be affected. <br />dwExStyle<br />DWORD value that specifies the extended list-view control style. This parameter can be a combination of Extended List-View Styles. </div><br /><br />You shoud do this<br /><pre><code><br />invoke SendMessage,hList,LVM_SETEXTENDEDLISTVIEWSTYLE,LVS _EX_FULLROWSELECT,LVS _EX_FULLROWSELECT<br /></code></pre><br />but I prefer this<br /><pre><code><br />invoke SendMessage,hList,LVM_SETEXTENDEDLISTVIEWSTYLE,0,LVS _EX_FULLROWSELECT<br /></code></pre></div>
    <div class="meta">Posted on 2004-09-25 07:26:02 by greenant</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=19458&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=19458&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="19458" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=19458&amp;page=2">&gt;</a><a href="../?id=19458&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>