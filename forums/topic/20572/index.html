<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>caution with this API - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20572" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20572">caution with this API</a></p>
   <div class="post" id="post-157109">
    <div class="subject"><a href="#post-157109">caution with this API</a></div>
    <div class="body">Hello everybody, <br />My program requires that all users are able to read/write to the registry in windows xp/2000 regardless of whether they are administrators, restricted or limited users.<br /><br />I decided to use <strong>SetNamedSecurityInfo</strong> as follows:<br /><pre><code><br />		 invoke SetNamedSecurityInfo,ADDR DiscretionaryACL,\<br />						   SE_REGISTRY_KEY,DACL_SECURITY_INFORMATION or\<br />						   PROTECTED_DACL_SECURITY_INFORMATION,\<br />						   NULL,NULL,NULL,NULL</code></pre><br />declared in .data:<br />DiscretionaryACL_Machine db &quot;MACHINE\Software&quot;,0<br /><br />This call returned error success.  Next time I tried to logon to windows xp a <em>Windows Product Activation Error code: 07008005 </em>was generated along with numerous other errors.  This could only be fixed by manually editing the registry from another partition cuz Restore and many other functions would no longer work.<br /><br />Nothing in the documentation suggests the possibility of registry corruption so I don't know where to go from here:)  If anybody has any insight, suggestions or samples on how to give all users read/write privileges it would be much appreciated.<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2005-02-17 08:50:52 by czDrillard</div>
   </div>
  </div>
 </body>
</html>