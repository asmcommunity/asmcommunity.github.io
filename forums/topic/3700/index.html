<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Text based game... Going old school - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3700" />
    <link rel="next" href="../?id=3700&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=3700">Text based game... Going old school</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=3700&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=3700&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="3700" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=3700&amp;page=2">&gt;</a><a href="../?id=3700&amp;page=2">&raquo;</a></form>   <div class="post" id="post-24772">
    <div class="subject"><a href="#post-24772">Text based game... Going old school</a></div>
    <div class="body">Hola,<br /><br />Ok, i've decided to try my hands at improving my knowledge of assembly by creating a version of &quot;MUD&quot; (aka Multi user dungeon/domain/d... whatever).  More specifically I'm trying to improve my knowledge of working with *structures* and *pointers* in assembly.<br /><br /><u>Basic Set-Up</u> <br />I want to create the environment so that the user would see on the screen:<br /><br />---- hypothetical output ----<br /><br />You're in the Temple.<br />There is no one here with you.<br />There is nothing on the floor.<br /><br />move east<br /><br />You're in the North Square<br />There is no one here with you.<br />There is nothing on the floor.<br /><br />move south<br /><br />You're in the South Square<br />There is no one here with you.<br />There is nothing on the floor.<br /><br />move west<br /><br />You can't go in that direction.<br /><br />---- end ----<br /><br />Now the problem is I'm looking for a robust way to create the room locations in such a way so that it can be easily expanded and have many properties (hence a struct)... but I don't really want to use a multi dimension array to represent it...<br /><br />More like:<br /><br />struct Location<br />{<br />  string name;<br />  string description;<br /><br />  // what room lies in each direction<br />  //if the location is NULL then there is not room in<br />  // that direction<br />  Location * north;<br />  Location * south;<br />  Location * east;<br />  Location * west;<br />  Location * northeast;<br />  Location * southeast;<br />  Location * northwest;<br />  Location * southwest;<br />  Location * up;<br />  Location * down;<br />}<br /><br />Basically the way I figured it would be that the player struct would have a pointer the location struct and by checking that structure above find out where other room were...<br /><br />structure Being<br />{<br />  string name;         // name of this being<br />  string article;      // article for being e.g. &quot;a&quot; &quot;an&quot;<br />  string pronoun;      // pronoun for being, e.g. &quot;he&quot; &quot;she&quot; &quot;it&quot;<br />  string possessive;   // possesive pronoun, e.g. &quot;his&quot;, &quot;her&quot;, &quot;its&quot;<br />  string sex;          // sex of this being<br /><br />  int gold;            // how much gold this being has<br />  <br />  Location * location; // where this being is<br />}<br /><br />The problem is I don't know how to port my code in c++ to assembly... and I was hoping that someone would understand what I was trying for a maybe help me write a &quot;small example&quot; so I could get a grasp of this concept better... Inotherwords, how can I do this more robustly?<br /><br />Again if someone has/had and example of a small text based world example I'd appreciate a look<br /><br />Sliver</div>
    <div class="meta">Posted on 2002-02-17 23:47:08 by Sliver</div>
   </div>
   <div class="post" id="post-24774">
    <div class="subject"><a href="#post-24774">Text based game... Going old school</a></div>
    <div class="body">Since, I'm still new to Direct3d or OpenGl, I may not be of help but since you mentioned that it's text based I suggest you do a  linked list or an array of structures, you can modify a doubly linked list to make it octuple linked list(8 Directions - N, E, W, S, NE, NW, SE, SW). But It would be better if you do a quadruple linked list/Array of structures (4 Directions - N, E, W, S) -  less complicated.<br /><br /><pre><code><br />player STRUCT<br />  Name      DB 20 DUP&#40;?&#41;<br />  Desc      DB 20 DUP&#40;?&#41;<br />  Location  DD ?<br />player ENDS<br /></code></pre><br /><br />Location must be an address in memory. This is usually the address or pointer in memory that was allocated by HeapAlloc or GlobalAlloc or VirtualAlloc. You have make the player start at the root node or the first allocated memory.<br /><br /><pre><code><br /><br />items STRUCT<br />  name      DB 20 DUP&#40;0&#41;<br />  desc      DB 20 DUP&#40;0&#41;<br />  Effect    DD ?<br />items ENDS<br /><br />rooms STRUCT<br />  N         DD ?<br />  E         DD ?<br />  W         DD ?<br />  S         DD ?<br />  Desc      DB 50 DUP&#40;?&#41;<br />  RmItem    items&lt;&gt;<br />  <br />  ;You could create an array of items.<br />  <br />player ENDS<br /></code></pre><br /><br />If I have the time, I could code one, if you want. I know I didn't explain much up here, since there are a lot of things to consider and If I do It'll be a long one. I'll make a follow up with the code it will be just four rooms and only four directions just to give you an example.<br /><br />Hmm!!! looks like Ultima to me but text based.<br /><br />Happy Coding!!!</div>
    <div class="meta">Posted on 2002-02-18 00:25:40 by stryker</div>
   </div>
   <div class="post" id="post-24776">
    <div class="subject"><a href="#post-24776">Text based game... Going old school</a></div>
    <div class="body">Thanks for the help so far...<br /><br />What I'm looking for doesn't have to be dynamic... I'm going to assume that I hav only 9 rooms...<br /><pre><code><br />&#91;NULL&#93;  &#91;NULL&#93;    &#91;NULL&#93;    &#91;NULL&#93;  &#91;NULL&#93;<br />&#91;NULL&#93; &#91;Room1&#93; &#91;Room2&#93; &#91;Room3&#93; &#91;NULL&#93;<br />&#91;NULL&#93; &#91;Room4&#93; &#91;Room5&#93; &#91;Room6&#93; &#91;NULL&#93;<br />&#91;NULL&#93; &#91;Room7&#93; &#91;Room8&#93; &#91;Room9&#93; &#91;NULL&#93;<br />&#91;NULL&#93;  &#91;NULL&#93;    &#91;NULL&#93;    &#91;NULL&#93;  &#91;NULL&#93;<br /></code></pre><br /><br />Given this type of setup...<br /><br />I want within the player structure to have a pointer to the &quot;players location&quot; in the world... <br /><br />The location structure would contain pointers for all 8 possible directions and if the value is not NULL then it would contain the address of the adjecent  room...<br /><br />I know how to do this in C++, but I'm absolutely confused doing to in assembly<br /><br /><br />Sliver</div>
    <div class="meta">Posted on 2002-02-18 00:55:55 by Sliver</div>
   </div>
   <div class="post" id="post-24777">
    <div class="subject"><a href="#post-24777">Text based game... Going old school</a></div>
    <div class="body">Yes, it would be very easy, It's so hard to explain right now, but I'll try to code up one using an array of structures to give you an example. I'll be back with the code. Oh!!! no classes tomorrow. Nice!!!</div>
    <div class="meta">Posted on 2002-02-18 01:00:15 by stryker</div>
   </div>
   <div class="post" id="post-24778">
    <div class="subject"><a href="#post-24778">Text based game... Going old school</a></div>
    <div class="body">umberg6007... Your help is very much appreciated... <br />I don't think I can sleep until I solve this problem :(<br /><br />I editted my last comments to reflect more clearly what I'm trying to do...<br /><br />Sliver<br /><br />ps. 2am here in New York and I should be getting up for 9 am classes too...</div>
    <div class="meta">Posted on 2002-02-18 01:04:22 by Sliver</div>
   </div>
   <div class="post" id="post-24791">
    <div class="subject"><a href="#post-24791">Text based game... Going old school</a></div>
    <div class="body">The included zip file should do the trick. The asm file is not optimized and still lacks most aspects of the game but it should help you solve the <strong>movements</strong> of your game. I suggest you make the included .gif file as your guide. You can exploit it if you want. There's no sophisticated algorithm, everything's hard coded to make it easier for you to understand.<br /><br />Happy Coding!!!<br /><br />P.S. Oops I forgot, tomorrows president's day, so no classes :)</div>
    <div class="meta">Posted on 2002-02-18 03:01:59 by stryker</div>
   </div>
   <div class="post" id="post-24799">
    <div class="subject"><a href="#post-24799">Text based game... Going old school</a></div>
    <div class="body">first off... <br /><br />Thank you very much for your great application...<br />:):):)<br />I need all the help I can get, so I appreciate it<br /><br />Second... <br /><br />I figured that both your method and mine aren't that condusive to making very large applications... So do you think that this might not be done a more productive way?<br /><br />I'm including my source and app (the app -- mainly because I hardcoded the values to demonstrate that I was passing the pointer to the location structure)<br /><br />Well anyway here it is... I explained a bit more of what I'm doing in the source...<br /><br />Sliver<br /><br />ps. run it first to get a feel for what it is doing (because of the hardcoded values)</div>
    <div class="meta">Posted on 2002-02-18 03:27:32 by Sliver</div>
   </div>
   <div class="post" id="post-24802">
    <div class="subject"><a href="#post-24802">Text based game... Going old school</a></div>
    <div class="body">OMG, you hard coded the memory locations? Uurp sorry, It's late it's 1:30 a.m here, I'll check it out tomorrow. But anyway, I'll see what I can do to improve it. I need sleep!!!<br /><br />P.S. I never coded that way before, I always have my own GUI with me. Never tried using debug.</div>
    <div class="meta">Posted on 2002-02-18 03:36:19 by stryker</div>
   </div>
   <div class="post" id="post-24863">
    <div class="subject"><a href="#post-24863">Text based game... Going old school</a></div>
    <div class="body">I have an Idea, this is from my chess program in java. The concept is to think there are 2 points on one square namely the x and the y axis.<br /><br />So we have to create structure like this:<br /><br /><pre><code><br />player struct<br />  xAxis DD ?<br />  yAxis DD ?<br />player ends<br /></code></pre><br /><br />so each square also has an axis point<br /><br /><pre><code><br />&#91;NULL&#93; &#91;NULL&#93; &#91;NULL&#93; &#91;NULL&#93; &#91;NULL&#93;<br />&#91;NULL&#93; &#91;0, 0&#93; &#91;0, 1&#93; &#91;0, 2&#93; &#91;NULL&#93;<br />&#91;NULL&#93; &#91;1, 0&#93; &#91;1, 1&#93; &#91;1, 2&#93; &#91;NULL&#93;<br />&#91;NULL&#93; &#91;2, 0&#93; &#91;2, 1&#93; &#91;2, 2&#93; &#91;NULL&#93;<br />&#91;NULL&#93; &#91;NULL&#93; &#91;NULL&#93; &#91;NULL&#93; &#91;NULL&#93;<br /></code></pre><br /><br />I'm sure this can be done in a very productive way. Making the user enter how many x and y grids he/she wants, will help us determine our borders. Assuming he/she choses a 2 x 3 grid:<br /><br /><pre><code><br />&#91;NULL&#93; &#91;NULL&#93; &#91;NULL&#93; &#91;NULL&#93;<br />&#91;NULL&#93; &#91;0, 0&#93; &#91;0, 1&#93; &#91;NULL&#93;<br />&#91;NULL&#93; &#91;1, 0&#93; &#91;1, 1&#93; &#91;NULL&#93;<br />&#91;NULL&#93; &#91;2, 0&#93; &#91;2, 1&#93; &#91;NULL&#93;<br />&#91;NULL&#93; &#91;NULL&#93; &#91;NULL&#93; &#91;NULL&#93;<br /></code></pre><br /><br />Starting at room 0 (0, 0) the player chose the following movements:<br /><br />left: (0, 0) subtract 1 from y = -1, check if this value is &lt; 0 or =2 if it is, this is an invalid move.<br />right: (0, 0) add 1 to y = 1, check if this value is &lt; 0 or = 2, no it's not, so change the player's current x and y locations to (0, 1)<br />right: (0, 1) add 1 to y = 2, check if this value is &lt; 0 or = 2, if it is, this is an invalid move.<br /><br />If the player choses to move down or up, you have to add/subtract 1 from the user's current location.<br /><br />So here's a rundown:<br /><br />Moving from left to right and vice versa: check the y axis value if it's &lt; 0 or = 2<br />Moving from up  to right and vice versa: check the x axis value if it's &lt; 0 or = 3<br /><br />I'm sure you get my point and I know there's a little twist on the concept but it's the best solution I can think of. Tell me if you have questions.<br /><br />Happy Coding!!!<br /><br /><br />I'll leave this up to you. I'm sure you can code this way.<br /><br /><br />And finally, I forgot to add this, create a table look up, when<br />the user lands on a room E.G. a room with axis point<br />(0, 0) this will resolve to 0 and then you can go and calculate the<br />equivalent structure and print the data of the structure.<br /><br /><pre><code><br />location struct<br />    description DB 50 DUP&#40;0&#41;<br />location ends<br /></code></pre></div>
    <div class="meta">Posted on 2002-02-18 11:18:55 by stryker</div>
   </div>
   <div class="post" id="post-24885">
    <div class="subject"><a href="#post-24885">Text based game... Going old school</a></div>
    <div class="body">Ok this is the code to move around the map that I've created for now...<br /><br />valid keys are:<br />e, w, n, s<br /><br />any other key will exit<br /><br />Sliver<br /><br /><pre><code><br />;-------------------------------------------------------------------------------<br />; loc.asm<br />;-------------------------------------------------------------------------------<br />; &#91;email&#93;sliver55@ix.netcom.com&#91;/email&#93; &#40;Sliver&#41;<br />;-------------------------------------------------------------------------------<br />; Assemble  &#58; ml /c /coff loc.asm<br />; Link      &#58; link /SUBSYSTEM&#58;WINDOWS loc.obj<br />;-------------------------------------------------------------------------------<br /><br /><br />.386<br />.model flat, stdcall<br />option casemap&#58; none<br /><br />include \masm32\include\windows.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\masm32.inc<br />include \masm32\include\debug.inc<br /><br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\masm32.lib<br />includelib \masm32\lib\debug.lib<br /><br />    ; ------------<br />    ; Local macros<br />    ; ------------<br />      print MACRO Quoted_Text&#58;VARARG<br />        LOCAL Txt<br />          .data<br />            Txt db Quoted_Text,0<br />          .code<br />        invoke StdOut,ADDR Txt<br />      ENDM<br /><br />      input MACRO Quoted_Prompt_Text&#58;VARARG<br />        LOCAL Txt<br />        LOCAL Buffer<br />          .data<br />            Txt db Quoted_Prompt_Text,0<br />            Buffer db 128 dup&#40;?&#41;<br />          .code<br />        invoke StdOut,ADDR Txt<br />        invoke StdIn,ADDR Buffer,LENGTHOF Buffer<br />        mov eax, offset Buffer<br />      ENDM<br /><br />      cls MACRO<br />        invoke ClearScreen<br />      ENDM<br /><br />      InitMap PROTO<br />      Main   PROTO<br /><br />    .data<br />        <br />    LOCATIONS struct<br />        n dd 0<br />        s dd 0<br />        e dd 0<br />        w dd 0<br />        rname db 16 DUP &#40;0&#41;<br />        <br />    LOCATIONS ends<br /><br />     <br />    ;g_Location is initialized with a 'room number', but will later contain the<br />    ;pointer to the actual structure location<br />    g_Locations  LOCATIONS  &#123;0,3,1,0, &quot;Room 0&quot;&#125;, &#123;1,1,2,0,&quot;Room 1&quot;&#125;, &#123;2,5,2,1,&quot;Room 2&quot;&#125;,\<br />                            &#123;0,6,3,3, &quot;Room 3&quot;&#125;, &#123;4,7,5,4,&quot;Room 4&quot;&#125;, &#123;2,5,5,4,&quot;Room 5&quot;&#125;,\<br />                            &#123;3,6,7,6, &quot;Room 6&quot;&#125;, &#123;4,7,8,6,&quot;Room 7&quot;&#125;, &#123;8,8,8,7,&quot;Room 8&quot;&#125;<br /><br />    .code<br /><br />start&#58;<br /><br />      invoke Main<br />      invoke ExitProcess,0<br /><br />; #########################################################################<br />; Example&#58; Room 1 contains a number corresponding to a 'room location'<br />; After InitMap runs the Location structure for room 1 will contain pointers<br />; to all the adjecent location structure.  IF THERE IS NO ROOM IN A CERTAIN DIRECTION<br />; then the location structure will point to itself... So when you see<br />; for room 0 &#123; 0, 3, 1, 0&#125; it means that for&#58;<br />; North &#40; room 0 points to &#41; itself,<br />; South &#40; room 0 points to &#41; room 3,<br />; East  &#40; room 0 points to &#41; room 1,<br />; West  &#40; room 0 points to &#41; itself<br />;<br />;   Room set-up<br />;    0  1  2<br />;    3  4  5<br />;    6  7  8<br />; #########################################################################<br />InitMap proc<br /><br />    push esi<br />    ASSUME esi&#58;PTR LOCATIONS<br />    lea esi, g_Locations<br />    <br />    push edi<br />    ASSUME edi&#58;PTR LOCATIONS<br />    lea edi, g_Locations<br /><br />    mov ecx, 1<br />    <br />    @@&#58;<br />        push ecx<br />    <br />        mov eax, &#91;esi&#93;.n<br />        mov ecx, SIZEOF LOCATIONS<br />        mul ecx<br /><br />        lea edx, &#91;edi+eax&#93;<br />        mov &#91;esi&#93;.n, edx<br /><br />        mov eax, &#91;esi&#93;.s<br />        mov ecx, SIZEOF LOCATIONS<br />        mul ecx<br />        <br />        lea edx, &#91;edi+eax&#93;<br />        mov &#91;esi&#93;.s, edx<br /><br />        mov eax, &#91;esi&#93;.e<br />        mov ecx, SIZEOF LOCATIONS<br />        mul ecx<br />        <br />        lea edx, &#91;edi+eax&#93;<br />        mov &#91;esi&#93;.e, edx<br /><br />        mov eax, &#91;esi&#93;.w<br />        mov ecx, SIZEOF LOCATIONS<br />        mul ecx<br />        <br />        lea edx, &#91;edi+eax&#93;<br />        mov &#91;esi&#93;.w, edx<br /><br />        add esi, SIZEOF LOCATIONS<br /><br />        pop ecx<br />        inc ecx<br />        cmp ecx, 10<br />        jne @B<br />    @@&#58;<br />    ASSUME edi&#58;nothing<br />    pop edi<br />    ASSUME esi&#58;nothing<br />    pop esi<br />       <br />    ret<br /><br />InitMap endp<br /><br />Move proc<br /><br />Move endp<br /><br />Main proc<br /><br />    invoke InitMap <br />        <br />    .data<br />        inbuffer      db  32 DUP&#40;0&#41;<br />        location      dd  0<br />    .code<br /><br />        print &quot; &quot;,13,10<br />        print &quot;&#91;Room0&#93; &lt;-&gt; &#91;Room1&#93; &lt;-&gt; &#91;Room2&#93;&quot;,13,10<br />        print &quot;   |                       |   &quot;,13,10<br />        print &quot;&#91;Room3&#93;     &#91;Room4&#93; &lt;-&gt; &#91;Room5&#93;&quot;,13,10<br />        print &quot;   |           |               &quot;,13,10<br />        print &quot;&#91;Room6&#93; &lt;-&gt; &#91;Room7&#93; &lt;-&gt; &#91;Room8&#93;&quot;,13,10<br />        print &quot; &quot;,13,10<br />    <br />        push esi<br />        ASSUME esi&#58;PTR LOCATIONS<br />        lea esi, g_Locations<br /><br />        mov location, esi<br />            <br />        lea edx, &#91;esi&#93;.rname<br />        invoke StdOut, edx<br />        <br />        ASSUME esi&#58;nothing<br />        pop esi    <br />        <br />    nextone&#58;<br />    invoke StdIn,ADDR inbuffer,LENGTHOF inbuffer    ;get input<br /><br />    mov esi,offset inbuffer<br /><br />    ;check input for cr or lf<br /><br />    @@&#58;<br />    lodsb<br />    .if &#40;al == 'n'&#41;<br />        push esi<br />        ASSUME esi&#58;PTR LOCATIONS<br />        mov esi, location<br />        <br />            <br />        print &quot;Moving North...&quot;,13,10<br />        mov esi, &#91;esi&#93;.n<br />        lea edx, &#91;esi&#93;.rname<br />        invoke StdOut, edx<br /><br />        mov location, esi<br />        ASSUME esi&#58;nothing<br />        pop esi<br />    .elseif &#40;al == 's'&#41;<br />        push esi<br />        ASSUME esi&#58;PTR LOCATIONS<br />        mov esi, location<br />            <br />        print &quot;Moving South...&quot;,13,10<br />        mov esi, &#91;esi&#93;.s<br />        lea edx, &#91;esi&#93;.rname<br />        invoke StdOut, edx<br /><br />        mov location, esi<br />        ASSUME esi&#58;nothing<br />        pop esi    <br />    .elseif &#40;al == 'e'&#41;<br />        push esi<br />        ASSUME esi&#58;PTR LOCATIONS<br />        mov esi, location<br />            <br />        print &quot;Moving East...&quot;,13,10<br />        mov esi, &#91;esi&#93;.e<br />        lea edx, &#91;esi&#93;.rname<br />        invoke StdOut, edx<br />        <br />        mov location, esi    <br />        ASSUME esi&#58;nothing<br />        pop esi    <br />    .elseif &#40;al == 'w'&#41;<br />        push esi<br />        ASSUME esi&#58;PTR LOCATIONS<br />        mov esi, location<br />            <br />        print &quot;Moving West...&quot;,13,10<br />        mov esi, &#91;esi&#93;.w<br />        lea edx, &#91;esi&#93;.rname<br />        invoke StdOut, edx<br />        <br />        mov location, esi        <br />        ASSUME esi&#58;nothing<br />        pop esi    <br />    .else<br />        ret<br />    .endif<br />    jmp nextone<br /><br />    ret<br /><br />Main endp<br /><br />end start<br /><br /><br /></code></pre></div>
    <div class="meta">Posted on 2002-02-18 14:08:55 by Sliver</div>
   </div>
   <div class="post" id="post-24888">
    <div class="subject"><a href="#post-24888">Text based game... Going old school</a></div>
    <div class="body">I tried it and it works great! Cool :alright:</div>
    <div class="meta">Posted on 2002-02-18 14:18:36 by stryker</div>
   </div>
   <div class="post" id="post-25102">
    <div class="subject"><a href="#post-25102">Re: Text based game... Going old school</a></div>
    <div class="body"><div class="quote"><br />Hola,<br /><br />struct Location<br />{<br />  string name;<br />  string description;<br /><br />  // what room lies in each direction<br />  //if the location is NULL then there is not room in<br />  // that direction<br />  Location * north;<br />  Location * south;<br />  Location * east;<br />  Location * west;<br />  Location * northeast;<br />  Location * southeast;<br />  Location * northwest;<br />  Location * southwest;<br />  Location * up;<br />  Location * down;<br />}<br /><br />Basically the way I figured it would be that the player struct would have a pointer the location struct and by checking that structure above find out where other room were...<br /><br />structure Being<br />{<br />  string name;         // name of this being<br />  string article;      // article for being e.g. &quot;a&quot; &quot;an&quot;<br />  string pronoun;      // pronoun for being, e.g. &quot;he&quot; &quot;she&quot; &quot;it&quot;<br />  string possessive;   // possesive pronoun, e.g. &quot;his&quot;, &quot;her&quot;, &quot;its&quot;<br />  string sex;          // sex of this being<br /><br />  int gold;            // how much gold this being has<br />  <br />  Location * location; // where this being is<br />}<br /><br /></div><br /><br />Hi sliver, <br />well i'd like to propose an idea about the structure design <br /><br />U wanna create the location and the beings as objects and so on should address the location they stay in <br />But this way to list all the beings, objects and other things that stay in a room u've to check all the beings, objects,... u've created to discover which r the ones present in ur room and u've to do this every time u change room and if u've a quite big number of beings, obejcts and so on its quite hard work 4 ur machine <br />What about putting inside the location a pointer to a list of entities created this way: <br /><br />struct entity <br />{<br />    entity* next_entity;<br />    void* entity_object;<br />    int entity_type;<br />}<br /><br />Every location has to be its entity list which lists all the entities <br />inside the room <br />Entities r beings, objects,... and so on <br />U put the pointer to ur being, object structure in the entity_object field and u put a ID for the entity type in the entity_type field <br />so u r able to deal with the structure pointed by the entity_object <br /><br />See ya <br />NikDH</div>
    <div class="meta">Posted on 2002-02-19 18:29:13 by NikDH</div>
   </div>
   <div class="post" id="post-25121">
    <div class="subject"><a href="#post-25121">Re: Re: Text based game... Going old school</a></div>
    <div class="body"><div class="quote"><em>Originally posted by NikDH </em><br /><br />struct entity <br />{<br />    entity* next_entity;<br />    void* entity_object;<br />    int entity_type;<br />}<br /><br />Every location has to be its entity list which lists all the entities <br />inside the room <br />Entities r beings, objects,... and so on <br />U put the pointer to ur being, object structure in the entity_object field and u put a ID for the entity type in the entity_type field <br />so u r able to deal with the structure pointed by the entity_object <br /></div><br /><br />I can't say I follow you're idea completely, but I'll explain what I was thinking...<br /><br />First this is how I moved around rooms (I think I'm going to use a variation of this to create weapons and armor -- however items seem to be a bit different)...<br /><br />I created an array of structures (each of which is a room location)...<br /><br />Within the structure is a list of directions (North, South, East, ect..) which are changed to pointers to the rooms that are connected to when the program is run. <br /><br />A pointer to the location that the player is in can be found within the &quot;player&quot; structure.  So here is what else is contained in the location structure...<br /><br />The location struture also contains a list of pointers for the items present in the room... Much like the way I reference the connecting rooms...<br /><br />Therefore if a battleaxe is in the room with the player the computer only checks what room the player is in and goes to that location structure... the location structure contains a pointer to the weapon or armor type that is in that location too...<br /><br /><pre><code><br />location struct<br />        room_items dd &#123;6&#125;,&#123;2&#125;,&#123;4&#125;,&#123;1&#125;<br />location ends<br /></code></pre><br /><br />Where:<br />1 = club<br />2 = short sword<br />etc.<br /><br />These will be pointers to the weapons only (I use numbers for clarity sake).<br /><br />Therefore, (and this is the key part) I don't need to make multiple instances of the same weapon for someone to use... All players and creatures will reference the same weapon structure.  So 100 people or creatures can be using a battle axe, but I only need to reference that one structure (mainly because weapons tend to not change in their specifications).<br /><br />The problem:<br /><br />I don't know what to do about certain types of &quot;items&quot;... Mainly because some items &quot;run out&quot;... Like a &quot;torch&quot; for example...<br /><br />A torch should run for about 5 minutes and then burn out... but using the same structure as a reference would mean that I can't change the structure... I don't want to have to allocate space for 300 torch structure needlessly...<br /><br />Maybe I'll put some form of timer in the player structure to keep track of these types of &quot;timing&quot; prblems...<br /><br />Anyway, I always appreciate the help (and since I always post all my source it would be beneficial to the rest of the community if we could all put something together... great learning exercise :)<br /><br />Sliver<br /><br />ps. I'm intrested to know exactly what you mean... if you want to modify my source and repost it... I'd love to see where you are going with it...<br /><br />pps.  I just thought... creatures will be annoying...<br />I may have to allocate &quot;Actual&quot; space from the heap for them... seeing they can't use the same structure... i'dunno</div>
    <div class="meta">Posted on 2002-02-19 22:22:36 by Sliver</div>
   </div>
   <div class="post" id="post-25122">
    <div class="subject"><a href="#post-25122">Text based game... Going old school</a></div>
    <div class="body">If I have the time, I'll code up one, since I'm always interested in an RPG like game, even though it's text based, the idea still rocks ;) <br /><br />Who says dungeon and dragons(papers and pencils) is boring? :grin:</div>
    <div class="meta">Posted on 2002-02-19 22:25:48 by stryker</div>
   </div>
   <div class="post" id="post-25127">
    <div class="subject"><a href="#post-25127">Text based game... Going old school</a></div>
    <div class="body">If you want to create the data statically, then macros would make it very readable and automate most the the pointer offset stuff.  Let me give a small example of ideal syntax (assuming readablity is a plus):<pre><code>Room 5, &lt;This is a cool place to be!&gt;<br />; note compass directions below&#58;<br />Room_Links 5, \<br /> 1, 2, 3, \<br /> 4,    6, \<br /> 7, 8, 9<br />Room_Items 5, &lt;Book, Lamp, Pen&gt;<br /><br />...this would create a data structure like...<br /><br />Room_5&#58;<br />  dd offset RoomDesc_5<br />  dd offset Room_1,offset Room_2,offset Room_3<br />  dd offset Room_4,offset Room_6,offset Room_7<br />  dd offset Room_8,offset Room_9<br />  dd offset RoomItemsList_5<br /><br />RoomDesc_5 db &quot;This is a cool place to be!&quot;<br /><br />RoomItemsList dd offset items_5_0,offset items_5_1,offset items_5_2<br /><br />items_5_0 db &quot;Book&quot;,0<br />items_5_1 db &quot;Lamp&quot;,0<br />items_5_2 db &quot;Pen&quot;,0</code></pre>You can see how a little macro coding has a big pay off, and will maybe help organize the data a little better?  Also, you could keep the same map layout and change the macros to match your code as it develops. ;)</div>
    <div class="meta">Posted on 2002-02-19 23:00:36 by bitRAKE</div>
   </div>
   <div class="post" id="post-25128">
    <div class="subject"><a href="#post-25128">Text based game... Going old school</a></div>
    <div class="body">Hey, Our MACRO king :grin: I'll code up using my x and y idea and I will try to attempt to do an octuple/quadruple linked list, ha ha never heard of it before. :grin:</div>
    <div class="meta">Posted on 2002-02-19 23:04:27 by stryker</div>
   </div>
   <div class="post" id="post-25137">
    <div class="subject"><a href="#post-25137">Text based game... Going old school</a></div>
    <div class="body">Ok here is an updated version... :-)<br /><br />What it includes:<br />-Better optimized<br />-Now you can move in all 8 possible directions<br />N,S,E,W,NW,NE,SW,SE<br />-gave rooms the ability to have weapons (only 1.. but more shouldn't be too difficult)<br />-new look as well<br /><br />I'm sure that isn't all -- just gonna have to download it to see it..<br /><br />Can't post the source on this page anymore... it's 200 more lines than it was the last time I posted it...<br />:):):)<br /><br />Sliver<br /><br />ps. umberg6007 I can't wait to see it (I think I may need to implement some form of what your doing so I could use all the help...)<br /><br />pps. BitRAKE I think you're right about the macro thing... IF you download the code maybe you could tell me where it might come in the most useful...<br /><br />-----EDIT----<br />deleted the last download because it had the debug window in it<br /><br />so here is a new one</div>
    <div class="meta">Posted on 2002-02-20 01:36:14 by Sliver</div>
   </div>
   <div class="post" id="post-25182">
    <div class="subject"><a href="#post-25182">Re: Re: Re: Text based game... Going old school</a></div>
    <div class="body"><div class="quote"><br /><br /><pre><code><br />location struct<br />        room_items dd &#123;6&#125;,&#123;2&#125;,&#123;4&#125;,&#123;1&#125;<br />location ends<br /></code></pre><br /><br />Where:<br />1 = club<br />2 = short sword<br />etc.<br /><br />The problem:<br /><br />I don't know what to do about certain types of &quot;items&quot;... Mainly because some items &quot;run out&quot;... Like a &quot;torch&quot; for example...<br /><br />A torch should run for about 5 minutes and then burn out... but using the same structure as a reference would mean that I can't change the structure... I don't want to have to allocate space for 300 torch structure needlessly...<br /><br />Maybe I'll put some form of timer in the player structure to keep track of these types of &quot;timing&quot; prblems...<br /><br />Anyway, I always appreciate the help (and since I always post all my source it would be beneficial to the rest of the community if we could all put something together... great learning exercise :)<br /></div><br /><br />Hi sliver, <br />ur idea about careful use of resources is good :) <br />The solution at ur prob should be this one: <br />u can create objects with a common section and a private section <br />such as dll that have a common code section and as many data sections as many process have loaded the dll <br />The torch object is a structure with a method inside: <br /><br />strcut torch_personal_data<br />{<br />int fuel; /* remaining fuel of the torch */ <br />time_t time_start; /* time u've lit the torch */ <br />int some_other_info; <br />}<br /><br />strcut torch<br />{<br />/* All the common data of every torch */ <br />int light_power; <br />...<br /><br />/* This function is returning a handle u can use to access the info <br />about ur personal torch */ <br />void* turnOn();<br />int get_remaining_light_time(void* htorch);<br />}<br /><br />void* turnOn()<br />{<br />void* temp;<br />temp = malloc(sizeof(torch_personal_data));<br />torch_personal_data-&gt;fuel = init_value;<br />/* some other init stuff of the torch */ <br />/* create a timer object that will signal when the torch has run out of fuel */ <br />}<br /><br />int get_remaining_light_time(void* htorch)<br />{<br />int temp;<br />long deltat; <br />deltat = gettime() - time_start;<br />/* u can calc easily the remenaing fuel with this data */ <br />}<br /><br />Well the code should has some errs coz i'm in a little hurry now <br />but the idea should be quite clear <br /><br />See ya<br />NikDH</div>
    <div class="meta">Posted on 2002-02-20 13:04:31 by NikDH</div>
   </div>
   <div class="post" id="post-25248">
    <div class="subject"><a href="#post-25248">Text based game... Going old school</a></div>
    <div class="body">Real quick... Someone explain to me why this won't work...<br /><br />What I'm doing:<br />My location structure contains a pointer to items in the rooms...<br />I wrote a proc to take that item on the floor and put it into the players structure, but it doesn't work...<br /><br /><pre><code><br />GetItemFromRoom proc<br /><br />    LOCAL temp&#58;DWORD<br />    xor edx, edx<br /><br />    ;Check for weapons lying on the floor<br />    push edi<br />    ASSUME edi&#58;PTR WEAPONS<br />    lea edi, g_Weapons<br />    <br />    push esi<br />    ASSUME esi&#58;PTR LOCATIONS<br />    mov esi, loc<br /><br />    .if &#40;edi == &#91;esi&#93;.ritem&#41;<br />        print &quot;There is nothing lying on the floor.&quot;,10,13<br />    .else<br />        ;moving the pointer of the item on the floor to edi<br />        mov edi, &#91;esi&#93;.ritem<br />         <br />    .endif<br />    <br />    ASSUME esi&#58;nothing<br />    pop esi<br /><br />    push esi<br />    ASSUME esi&#58;PTR PLAYER<br />    mov esi, g_Player<br /><br />  ;I get the error here saying instruction <br />   ;operands must be the same size<br />    mov &#91;esi&#93;.weapon, edi  ; &lt;---Error here<br /><br />    ASSUME esi&#58;nothing<br />    pop esi<br /><br />    ASSUME edi&#58;nothing<br />    pop edi<br /><br />    ret<br />GetItemFromRoom endp<br /><br />;Structures&#58;<br />    LOCATIONS struct<br />        north dd 0<br />        south dd 0<br />        east dd 0<br />        west dd 0<br />        neast dd 0<br />        nwest dd 0<br />        seast dd 0<br />        swest dd 0<br />        rname db 24 DUP &#40;0&#41;<br />        numberofritem dd 0<br />        ritem  dd 2 DUP &#40;0&#41;<br />    LOCATIONS ends<br /><br />    PLAYER struct<br />        pname db 24 DUP &#40;0&#41;<br />        weapon dd 0<br />        pid dd 0<br />    PLAYER ends<br />    <br />    WEAPONS struct<br />        wname db 24 DUP &#40;0&#41;<br />        wid dd 0<br />    WEAPONS ends<br /></code></pre></div>
    <div class="meta">Posted on 2002-02-20 23:28:15 by Sliver</div>
   </div>
   <div class="post" id="post-25249">
    <div class="subject"><a href="#post-25249">Text based game... Going old school</a></div>
    <div class="body">This is the problem with assembly :)<br /><br /><pre><code><br />    push esi<br />    ASSUME esi&#58;PTR PLAYER<br />    mov esi, g_Player<br /></code></pre><br /><br />it should have been<br /><br /><pre><code><br />    push esi<br />    ASSUME esi&#58;PTR PLAYER<br />   &#91;B&#93;LEA&#91;/B&#93;  esi, g_Player<br /></code></pre><br /><br />Spent like 30 minutes tracking this down</div>
    <div class="meta">Posted on 2002-02-20 23:37:00 by Sliver</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=3700&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=3700&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="3700" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=3700&amp;page=2">&gt;</a><a href="../?id=3700&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>