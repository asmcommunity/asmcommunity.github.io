<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Text based game... Going old school - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3700" />
  <link rel="prev" href="../?id=3700&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=3700">Text based game... Going old school</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=3700&amp;page=1" style="">&laquo;</a><a href="../?id=3700&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="3700" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-25257">
    <div class="subject"><a href="#post-25257">Text based game... Going old school</a></div>
    <div class="body"><strong>Sliver</strong>, feel for ya man - been there dozens of times. It just<br />needs to become heavy scar tissue, then your good for life!<br />:) :) :)</div>
    <div class="meta">Posted on 2002-02-21 00:53:24 by bitRAKE</div>
   </div>
   <div class="post" id="post-25258">
    <div class="subject"><a href="#post-25258">Text based game... Going old school</a></div>
    <div class="body">:)<br /><br />The problem the error was on the next command after the &quot;lea&quot; statement...<br /><br />So I spent those 30 minutes changing things around like<br /><br />mov .weapon, edi<br /><br />mov .weapon, <br /><br />lea .weapon, edi<br /><br />lea .weapon, <br /><br />lea edx, edi<br />mov .weapon, edx<br /><br />then I went to using the local stack... Anyway, I think you get the picture...<br /><br />I'm gonna upload my new thing *hopefully* in about an hour *hopefully*...<br /><br />some cool new additions :)<br /><br />This has been seriously a great learning expereince...<br /><br />Sliver</div>
    <div class="meta">Posted on 2002-02-21 01:01:44 by Sliver</div>
   </div>
   <div class="post" id="post-25269">
    <div class="subject"><a href="#post-25269">Text based game... Going old school</a></div>
    <div class="body">Ok given an input of <br /><br /> 3  5  0  0  1<br /> 3  5  3  5  0<br /> 3  5  5  3  5<br /><br />This code is supposed to break up and handle each line individually.  Now the readline proc works... however when the file is being converted using atodw I get some strange outcomes...<br /><br />here is what it print using debug.inc<br /><br />eax = -1984453087<br />eax = 136165533/<br />eax = 26426401<br />eax = 26401<br />eax = 1<br />eax = -1981448088<br />eax = 1364660328<br />eax = 29431400<br />eax = 31400<br />eax = 0<br />eax = -1979450083<br />eax = 1366658333<br />eax = 31429405<br />eax = 29405<br />eax = 5<br /><br />I noticed that only the last digit seems to be recognized and I tested this fact by only having one digit on the line and it worked... however, I'm not content with this outcome and still want to have the whole line parsed.... Any ideas?<br /><br />Code listed below:<br /><br /><pre><code><br />mov ecx,0<br /><br />    @OuterOuterloop&#58;<br />    push ecx<br /><br />        mov ecx, 0<br />        @Outerloop&#58;<br />        push ecx<br /><br />            xor eax, eax<br />            .while eax == 0<br />                invoke ReadALine, pointer, ADDR buffer<br />                add pointer, ecx<br />            .endw<br />            mov esi, offset buffer<br />            <br />            mov ecx, 0<br />            @Innerloop&#58;<br />                push ecx<br />    <br />                .while &#40;BYTE PTR &#91;esi&#93; == ' '&#41;<br />                    inc esi<br />                .endw<br />                invoke atodw, esi<br />                PrintDec eax             <br />                inc esi<br />       <br />            pop ecx<br />            inc ecx<br />            cmp ecx, 5<br />           jnz @Innerloop<br />    <br />        <br />        pop ecx<br />        inc ecx<br />        cmp ecx, 3<br />        jnz @Outerloop   <br /><br />    pop ecx<br />    inc ecx<br />    cmp ecx, 1<br />    jnz @OuterOuterloop<br /><br /><br /></code></pre></div>
    <div class="meta">Posted on 2002-02-21 02:46:48 by Sliver</div>
   </div>
   <div class="post" id="post-25515">
    <div class="subject"><a href="#post-25515">Text based game... Going old school</a></div>
    <div class="body">Quick question:<br /><br />Why doesn't this work...<br /><br /><pre><code><br />                invoke szMid, edi, ADDR Buf, edx, eax<br />                lea edx, Buf<br />                mov &#91;esi&#93;.rname, edx  ;&lt;---error here<br /></code></pre><br /><br />Given a structure described like:<br /><br /><pre><code><br />    LOCATIONS struct<br />        north dd 0<br />        south dd 0<br />        east dd 0<br />        west dd 0<br />        neast dd 0<br />        nwest dd 0<br />        seast dd 0<br />        swest dd 0<br />        rname db 24 DUP &#40;0&#41; &lt;--- this is the string I want to change<br />        numberofritem dd 0<br />        ritem  dd 2 DUP &#40;0&#41;<br />    LOCATIONS ends<br /></code></pre><br /><br />Basically the rname is defined already and I want to change the value at runtime to another string, but when I try to do that it says &quot;invalid instructions operand&quot;<br /><br />I can change all the other code at run time, just not the string...<br /><br />Also, the StdOut works perfectly and displays the word... so why can't I change over the locations<br /><br />PLEASE HELP ME!!!!<br /><br />Sliver</div>
    <div class="meta">Posted on 2002-02-22 19:09:29 by Sliver</div>
   </div>
   <div class="post" id="post-25523">
    <div class="subject"><a href="#post-25523">Text based game... Going old school</a></div>
    <div class="body">Sliver, the problem is that in your struct you have allocated 24 bytes to actually contain a string. However in the code you post you try to put a pointer to a string in the struct rather than the string itself.<br /><br />Perhaps a simple solution would be to have szMid to put the substring directly into the struct for you.<br /><br />invoke szMid, edi, ADDR .rname, edx, eax<br /><br />That should hopefully work.</div>
    <div class="meta">Posted on 2002-02-22 19:35:29 by EÃ³in</div>
   </div>
   <div class="post" id="post-25524">
    <div class="subject"><a href="#post-25524">Text based game... Going old school</a></div>
    <div class="body"><div class="quote"><br />Quick question:<br /><br />Why doesn't this work...<br /><br /><pre><code><br />                invoke szMid, edi, ADDR Buf, edx, eax<br />                lea edx, Buf<br />                mov &#91;esi&#93;.rname, edx  ;&lt;---error here<br /></code></pre><br /><br />Given a structure described like:<br /><br /><pre><code><br />    LOCATIONS struct<br />        north dd 0<br />        south dd 0<br />        east dd 0<br />        west dd 0<br />        neast dd 0<br />        nwest dd 0<br />        seast dd 0<br />        swest dd 0<br />        rname db 24 DUP &#40;0&#41; &lt;--- this is the string I want to change<br />        numberofritem dd 0<br />        ritem  dd 2 DUP &#40;0&#41;<br />    LOCATIONS ends<br /></code></pre><br /><br />Basically the rname is defined already and I want to change the value at runtime to another string, but when I try to do that it says &quot;invalid instructions operand&quot;<br /><br />I can change all the other code at run time, just not the string...<br /></div><br /><br />Hi sliver, <br />it seems the rname field in ur structure is the 1st of ur string <br />and not a pointer to a string <br />So u cant copy edx thats a dword into a byte thats the reason of ur error and anyway if u wanna substitute the rname string with the one pointed by edx u've to copy the edx pointed string <br />into the rname field byte a byte this way: <br /><br />mov esi,buffer<br />mov edi,offset_of_the_rname_field_in_the_structure<br />copia: <br />mov al, <br />mov ,al <br />test al,al <br />jnz copia <br /><br />Altrimenti se sai quanti byte devi copiare di preciso puoi fare: <br />mov ecx,len_str <br />mov esi,buffer <br />mov edi,offset_of_the_rname_field_in_the_structure<br />repz movsb <br /><br />See ya <br />NikDH</div>
    <div class="meta">Posted on 2002-02-22 19:42:49 by NikDH</div>
   </div>
   <div class="post" id="post-25701">
    <div class="subject"><a href="#post-25701">Text based game... Going old school</a></div>
    <div class="body">Well, time for another update....<br /><br />What this comes with:<br />-Text parsing / Map support :)<br />(now it builds the world based on the &quot;World.txt&quot; supplied)<br /><br />//999 = not an exit, all other number will become the pointer<br />//to the other rooms<br />//ROOM 0 &lt;aka temple&gt;<br />// Room:N S	E W NE NW SE SW #ofroomitems   (1st ritem, 2s ritem)  'name'<br />999 3 1 999 999 999  4  999 1 1 0 'The Temple'<br /><br />-You can now have weapons in the inventory and weapons disappear after they've been &quot;picked up&quot;<br /><br />Movement : n,s,e,w,nw,ne,sw,se<br />Map      : m <br />Help     : h <br />Exit     : x <br />Get item : g<br />list items: l<br /><br /><br />Sliver<br /><br />ps. Still can't fight and no monsters yet.... still tryint o figure all that stuff out...<br /><br />pps. all suggestions welcome</div>
    <div class="meta">Posted on 2002-02-24 10:57:07 by Sliver</div>
   </div>
   <div class="post" id="post-25763">
    <div class="subject"><a href="#post-25763">Text based game... Going old school</a></div>
    <div class="body">Here it is, the long awaited XY proggy. As I stated on the accompanying readme file, this is just to give you an example of the XY concept I was talking about. Though this one is already D3D ready, I disabled the D3D routines. Once I get the map editor, map loading into full working condition, I'll add directx functionality and probably add dll's for weapons, armors, enemies, items...<br /><br />The only thing that always stumped me is the map stuff. I'll do a little research on other games, on how they do those custom maps. Though, I have an idea for it, It would be much better if I research more on this. If I can produce this, it'll no longer be a static 3x3 map but a custom map based on the map editor. It could be 16x16 or 9x9, anything the user desires.<br /><br />Controls:<br /><br />Right Mouse Button: Main Menu<br />Up Key: Move Up<br />Down Key: Move Down<br />Right Key: Move Right<br />Left Key: Move Left<br /><br />This proggy is still based on the 3x3 map:<br /><pre><code><br />&#91;  0 &#93; &#91;  1 &#93; &#91;  2 &#93;<br />&#91;  3 &#93; &#91;  4 &#93; &#91;  5 &#93;<br />&#91;  6 &#93; &#91;  7 &#93; &#91;  8 &#93;<br /></code></pre><br /><br />I suggest when you run the program, you should open up also the gif file I created on the first version of the game. Or you can refer to the crude map above. Why? the constant popup of a messagebox might annoy you in the long run :)<br /><br /><br />Happy ASMing!!!<br /><br /><br />And before I forgot, you can then use the calculated room location to the appropriate, parallel room structure, where in this structures contains the data for your weapons, enemies...That way, you don't need to fiddle with N, S, NE, SW location structure members, thus reducing instruction, less memory...</div>
    <div class="meta">Posted on 2002-02-24 22:54:53 by stryker</div>
   </div>
   <div class="post" id="post-25815">
    <div class="subject"><a href="#post-25815">Text based game... Going old school</a></div>
    <div class="body">If you see this line of code sub eax, 1 -&gt; chage this to dec eax. I'm so ashamed I forgot the dec instruction :)</div>
    <div class="meta">Posted on 2002-02-25 13:19:19 by stryker</div>
   </div>
   <div class="post" id="post-25847">
    <div class="subject"><a href="#post-25847">Text based game... Going old school</a></div>
    <div class="body">I like the way you're going with your application -- maybe a cooperative is in order?<br /><br />:) :) :)<br /><br />I'm having fun writing this program (and seeing how your approach the same topic with different ideas)... Keep up the good work<br /><br />Sliver</div>
    <div class="meta">Posted on 2002-02-25 16:57:54 by Sliver</div>
   </div>
   <div class="post" id="post-26087">
    <div class="subject"><a href="#post-26087">Text based game... Going old school</a></div>
    <div class="body">I'll start coding for the game this summer, since I'm a little bit busy nowadays. So you might not hear from me soon on updating this project. But if you have questions or need some ideas just ask, I'll response but I won't update the recent version of the game until summer vacation. :) Ooops, you'll be finished by that time :)</div>
    <div class="meta">Posted on 2002-02-26 20:18:07 by stryker</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=3700&amp;page=1" style="">&laquo;</a><a href="../?id=3700&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="3700" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>