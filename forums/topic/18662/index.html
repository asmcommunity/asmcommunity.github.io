<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Protection with hardware breakpoint ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18662" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=18662">Protection with hardware breakpoint ?</a></p>
   <div class="post" id="post-144581">
    <div class="subject"><a href="#post-144581">Protection with hardware breakpoint ?</a></div>
    <div class="body">hello how it's possible to code one protection for anti BPM (breakpoint hardware) ? :confused: <br />how erase the value of registry debug without passing by Ring 0 ? :confused: <br />Please give me one exemple with code source.<br />Thks for u help :)<br /><br />@+++:alright:</div>
    <div class="meta">Posted on 2004-06-23 00:37:09 by dicky96</div>
   </div>
   <div class="post" id="post-144586">
    <div class="subject"><a href="#post-144586">Protection with hardware breakpoint ?</a></div>
    <div class="body">You can desactivate those BP using API SetThreadContext (a way to reach <br />Ring0), that will clean the DRx registers, rendering inefective any hardware<br />BP set by the debugger. I don't know if this could be achevied without<br />using Ring0....<br /><br />Sorry, no source under hand, you should go and have a look either at Daemon's <br />cave or <a target="_blank" href="http://www.yates2k.net/sysinfo.html">http://www.yates2k.net/sysinfo.html</a><br /><br />Regards<br />etherlord</div>
    <div class="meta">Posted on 2004-06-23 01:18:10 by etherlord</div>
   </div>
   <div class="post" id="post-144603">
    <div class="subject"><a href="#post-144603">Protection with hardware breakpoint ?</a></div>
    <div class="body">You really shouldn't be messing with hardware breakpoints...</div>
    <div class="meta">Posted on 2004-06-23 06:34:06 by f0dder</div>
   </div>
   <div class="post" id="post-144665">
    <div class="subject"><a href="#post-144665">Protection with hardware breakpoint ?</a></div>
    <div class="body">Hello,<br /><br />Here's way, one may say that's ugly...<br /><br />-Implement a SEH<br />-Try to do a gpf:<br /> <br />xor eax,eax<br />mov eax, ;cause a gpf<br /><br />-then it will call your SEH<br />-In your SEH, access the CONTEXT structure<br />-In the CONTEXT struct you'll find all debug registers (aka DRx)<br />-Erase DR7<br /><br /><br />This is one way to access Debug registers without CPL0.<br /><br /><br /><br />Neitsa</div>
    <div class="meta">Posted on 2004-06-23 18:20:37 by Neitsa</div>
   </div>
   <div class="post" id="post-144669">
    <div class="subject"><a href="#post-144669">Protection with hardware breakpoint ?</a></div>
    <div class="body">ths u verry mutch +Neitsa ;):alright: :alright: :alright:</div>
    <div class="meta">Posted on 2004-06-23 18:38:16 by dicky96</div>
   </div>
  </div>
 </body>
</html>