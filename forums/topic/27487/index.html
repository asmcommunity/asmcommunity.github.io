<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Menu in modal Dialog - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27487" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27487">Menu in modal Dialog</a></p>
   <div class="post" id="post-196540">
    <div class="subject"><a href="#post-196540">Menu in modal Dialog</a></div>
    <div class="body">I was just looking through my win32 api reference and
i found the LoadMenu and SetMenu functions, now i wanned 
to show a menu - i specified it in my resource - in my modal dialog
so i put the functions under
WM_INITDIALOG
like this:
 invoke LoadMenu,hDlg,CalcMenu
 invoke SetMenu,hDlg,eax 
LoadMenu gives the returnvalue (the Menu Handle) in eax
i also tried this:
.data
MenuName db "CalcMenu",0
.
.
.code
invoke LoadMenu,hDlg,addr MenuName
invoke SetMenu,hDlg,eax 

both doesn't work

Regards Typhoon</div>
    <div class="meta">Posted on 2001-04-01 00:32:00 by Typhoon</div>
   </div>
   <div class="post" id="post-196541">
    <div class="subject"><a href="#post-196541">Menu in modal Dialog</a></div>
    <div class="body">Your error is classic: it happens to all beginners to the art of Windows programming. You confuse between dialog/window handle and instance handle. They are not the same thing. A dialog handle represents a dialog box while an instance handle represents the whole process. In your LoadMenu line, you use hDlg instead of hInstance.</div>
    <div class="meta">Posted on 2001-04-01 05:31:00 by Iczelion</div>
   </div>
   <div class="post" id="post-196542">
    <div class="subject"><a href="#post-196542">Menu in modal Dialog</a></div>
    <div class="body">Thanks Iczelion,

i just learned a little more, :)

regards</div>
    <div class="meta">Posted on 2001-04-01 13:34:00 by Typhoon</div>
   </div>
  </div>
 </body>
</html>