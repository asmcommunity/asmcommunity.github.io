<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>hotkeys - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4753" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4753">hotkeys</a></p>
   <div class="post" id="post-33327">
    <div class="subject"><a href="#post-33327">hotkeys</a></div>
    <div class="body">How do I write a proggie that waits for some particular keystrokes and then does something? Do I have to use windows hooks? Is there any other way?</div>
    <div class="meta">Posted on 2002-04-13 12:14:49 by marcinbu</div>
   </div>
   <div class="post" id="post-33336">
    <div class="subject"><a href="#post-33336">hotkeys</a></div>
    <div class="body">Use &quot;RegisterHotKey&quot; API to register hotkeys and respond to WM_HOTKEY message.</div>
    <div class="meta">Posted on 2002-04-13 13:47:16 by ante</div>
   </div>
   <div class="post" id="post-33338">
    <div class="subject"><a href="#post-33338">hotkeys</a></div>
    <div class="body">I' m not sure if it will work 'cause I'm trying to write a proggie which will work with one of those multimedia keyboards, so I want to react for keys like &quot;Volume Up&quot; or something...</div>
    <div class="meta">Posted on 2002-04-13 13:59:24 by marcinbu</div>
   </div>
   <div class="post" id="post-33339">
    <div class="subject"><a href="#post-33339">hotkeys</a></div>
    <div class="body">&quot;RegisterHotKey&quot; works fine with those special keys.<br /><br />Checkout the source I have attached. It uses some special keys on my Microsoft natural keyboard pro to change track in Winamp.</div>
    <div class="meta">Posted on 2002-04-13 14:08:58 by ante</div>
   </div>
   <div class="post" id="post-33340">
    <div class="subject"><a href="#post-33340">hotkeys</a></div>
    <div class="body">Uploaded the wrong source:)</div>
    <div class="meta">Posted on 2002-04-13 14:19:04 by ante</div>
   </div>
   <div class="post" id="post-33341">
    <div class="subject"><a href="#post-33341">hotkeys</a></div>
    <div class="body">Thanx! This is exactly what I was trying to do :)</div>
    <div class="meta">Posted on 2002-04-13 14:25:44 by marcinbu</div>
   </div>
   <div class="post" id="post-33342">
    <div class="subject"><a href="#post-33342">hotkeys</a></div>
    <div class="body">Uh... but there's another problem. How do I get virtual-key codes to use with my keyboard? I don't know them and guessing doesn't seem as a good idea... :confused:</div>
    <div class="meta">Posted on 2002-04-13 14:27:59 by marcinbu</div>
   </div>
   <div class="post" id="post-33347">
    <div class="subject"><a href="#post-33347">hotkeys</a></div>
    <div class="body">Check this page:<br /><br /><a target="_blank" href="http://msdn.microsoft.com/library/en-us/winui/vkeys_529f.asp">http://msdn.microsoft.com/library/en-us/winui/vkeys_529f.asp</a></div>
    <div class="meta">Posted on 2002-04-13 14:59:24 by ante</div>
   </div>
   <div class="post" id="post-33352">
    <div class="subject"><a href="#post-33352">hotkeys</a></div>
    <div class="body">It ain't that easy :( I managed to write a simple proggie which reads virtual-key codes (using windows hooks) and there's another problem: for some keys (there are 6 of them) I get a VK=FF. I can distinguish them by their scan codes only and RegisterHotKey can't work with scan codes, can it?</div>
    <div class="meta">Posted on 2002-04-13 15:25:56 by marcinbu</div>
   </div>
   <div class="post" id="post-33354">
    <div class="subject"><a href="#post-33354">hotkeys</a></div>
    <div class="body">One more thing: when I catch some key, can I modify the VK code and pass it back to Windows to make it do its job as if the user pressed some other key? I mean: I install a hotkey on Esc and when sb pushes Esc I change it to Enter and pass it back to Windows?</div>
    <div class="meta">Posted on 2002-04-13 15:29:39 by marcinbu</div>
   </div>
   <div class="post" id="post-33371">
    <div class="subject"><a href="#post-33371">hotkeys</a></div>
    <div class="body"><div class="quote"><br />One more thing: when I catch some key, can I modify the VK code and pass it back to Windows to make it do its job as if the user pressed some other key? I mean: I install a hotkey on Esc and when sb pushes Esc I change it to Enter and pass it back to Windows? </div><br /><br />No, even with hooks you can't modify the key code. You can prevent it from being processed though, with hooks. But then you will need to find a way to send the character yourself.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-04-13 16:55:23 by Thomas</div>
   </div>
   <div class="post" id="post-33406">
    <div class="subject"><a href="#post-33406">hotkeys</a></div>
    <div class="body">When the original software for my keyboard is running, it filters keystrokes before my proggie! How is this possible if it's not a driver and I'm using hooks?</div>
    <div class="meta">Posted on 2002-04-14 01:42:53 by marcinbu</div>
   </div>
   <div class="post" id="post-33409">
    <div class="subject"><a href="#post-33409">hotkeys</a></div>
    <div class="body">About hooks: my keyboard hook must reside in a dll, therefore I need to have two files - dll and exe, and the latter does nothing more than loading the first... Is there any way to put all this into one executable?</div>
    <div class="meta">Posted on 2002-04-14 03:14:37 by marcinbu</div>
   </div>
   <div class="post" id="post-33423">
    <div class="subject"><a href="#post-33423">hotkeys</a></div>
    <div class="body">@ante: how did you get all those control IDs you send to Winamp? I ripped all Winamp resources with Restorator and found some accelareator IDs which also work but how did you get yours?</div>
    <div class="meta">Posted on 2002-04-14 05:35:34 by marcinbu</div>
   </div>
   <div class="post" id="post-33424">
    <div class="subject"><a href="#post-33424">hotkeys</a></div>
    <div class="body">I found them on Winamp?s site: <a target="_blank" href="http://www.winamp.com/nsdn/winamp2x/dev/sdk/api.jhtml;">http://www.winamp.com/nsdn/winamp2x/dev/sdk/api.jhtml;</a>$sessionid$J1WJJOZ31MKCJTN245JBC0A</div>
    <div class="meta">Posted on 2002-04-14 05:47:12 by ante</div>
   </div>
   <div class="post" id="post-33436">
    <div class="subject"><a href="#post-33436">hotkeys</a></div>
    <div class="body">My keyboard is a b#%ch to me! There are some keys that can only be distinguished by scan codes (VK=255), so I tried to make all keys working (those with VKs, too) using windows hooks. But, e.g. my &quot;Eject&quot; key has a VK=VK_LAUNCH_APP2 and everytime I press it, Windows launches Calculator as well. I don't know how to stop Windows from doing it. The only solution I can think of, is to use hooks for keys with VK=255 and RegisterHotKey API for other keys...<br />Is there a way for a keyboard proc to remove WM_KEYDOWN message from message que? Perhaps with GetMessage but what window handle should I use?</div>
    <div class="meta">Posted on 2002-04-14 07:03:57 by marcinbu</div>
   </div>
  </div>
 </body>
</html>