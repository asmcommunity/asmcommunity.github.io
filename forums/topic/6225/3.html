<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Why use 400000h instead of hInstance? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6225" />
  <link rel="prev" href="../?id=6225&amp;page=2" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6225">Why use 400000h instead of hInstance?</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=6225&amp;page=1" style="">&laquo;</a><a href="../?id=6225&amp;page=2" style="">&lt;</a><input type="hidden" name="id" value="6225" /><input type="number" name="page" min="1" max="3" step="1" value="3" onchange="this.form.submit();" /></form>   <div class="post" id="post-45655">
    <div class="subject"><a href="#post-45655">Why use 400000h instead of hInstance?</a></div>
    <div class="body">1) you cannot depend on ANY register state on program entry. The win32<br />   standard doesn't specify any, and even though some registers have had<br />   interesting values on some windows versions, this has changed a lot.<br /><br />2) if you have an image without relocs that can't be loaded at its preferred<br />   image base, the win32 loader will give an error and wont load the executable.<br />   Not a crash, a loader error.<br /><br />What can you learn from these two examples? Play clean.<br />Theoretically I couldn't give a **** about this, but some programmers might<br />thing that stupid tricks are honky-dory and end up implemeting crap in<br />commercial programs. And I'm tired of fixing other peoples bugs when I do<br />not have source code.</div>
    <div class="meta">Posted on 2002-06-28 21:28:35 by f0dder</div>
   </div>
   <div class="post" id="post-45657">
    <div class="subject"><a href="#post-45657">Why use 400000h instead of hInstance?</a></div>
    <div class="body">/me sends f0dder some valium<br />Easy there, big fella!</div>
    <div class="meta">Posted on 2002-06-28 21:56:34 by comrade</div>
   </div>
   <div class="post" id="post-45659">
    <div class="subject"><a href="#post-45659">Why use 400000h instead of hInstance?</a></div>
    <div class="body">f0dder,<br />  Thanks for clearing that up. I wasn't sure if there was a documented entry to win32 programs or not. Finding information on stuff like this is like pulling teeth. For example, what Maverick has said about hInstance not being less than 400000h. I'm not sure where he found this, I tried to find it myself, but you can imagine searching MSDN for hInstance :) However, I figure Maverick knows what he's talking about, ditto for you. So I trust what you guys say, even if it's second hand information.<br /><br />As for cheap tricks in programming, I think there's a place for them, but not always. As you've pointed out before, GetModuleHandle is reliable whereas other methods are speculation. Furthermore, there isn't any &quot;performance&quot; gain.<br /><br />However, I think any good windows programmer should recognize that some APIs can be replaced by better programming habits. One example I can think of is GetClientRect. I used to use this function in WM_PAINT processing a lot until I realised I could just save the value from WM_SIZE, and bingo, there's one less API I can use.<br /><br />But GetModuleHandle isn't really one of those APIs :)<br /><br />--Chorus</div>
    <div class="meta">Posted on 2002-06-28 22:11:08 by chorus</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=6225&amp;page=1" style="">&laquo;</a><a href="../?id=6225&amp;page=2" style="">&lt;</a><input type="hidden" name="id" value="6225" /><input type="number" name="page" min="1" max="3" step="1" value="3" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>