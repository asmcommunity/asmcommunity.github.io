<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Cheap Try-Catch Macros - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5844" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=5844">Cheap Try-Catch Macros</a></p>
   <div class="post" id="post-41842">
    <div class="subject"><a href="#post-41842">Cheap Try-Catch Macros</a></div>
    <div class="body">This is a <strong>cheap</strong> Try-Catch macros(d/l .inc file below).<br /><br />Sample Code:<pre><code>&#91;size=9&#93;<br />Euclid PROC STDCALL m&#58;DWORD, n&#58;DWORD<br /><br />    @@STEP1&#58;<br /><br />    TRY&lt;EXCEPTION&gt;<br />    <br />        mov     ecx, n<br />        mov     eax, m<br />        &#91;color=#3366FF&#93;;or      ecx, ecx<br />        ;jz      @@PREMATURESTEP4&#91;/color&#93;<br />        xor     edx, edx<br />        div     ecx<br /><br />    CATCH&lt;EXCEPTION&gt;<br /><br />        xor     eax, eax<br />        or      edx, edx<br />        jz      @@STEP4<br />        mov     m, ecx<br />        mov     n, edx<br />        jmp     @@STEP1<br /><br />    @@STEP4&#58;<br /><br />        mov     eax, ecx<br />        ret<br />        <br />    @@PREMATURESTEP4&#58;<br />    <br />        CLEANUP<br />        <br />        ret<br />        <br />Euclid ENDP&#91;/size&#93;</code></pre>Note: Uncomment the comments above to get the correct answer. The comment was just there to force a probability of division by zero exception. I know, I know, that there are better SEH includes out there but if anyone who just wants a simple Try-Catch exception handling, go for it. :)<br /><br /><br />I forgot: remove <strong>align 32</strong> if an error occurs during the assembling stage.</div>
    <div class="meta">Posted on 2002-06-07 02:27:43 by stryker</div>
   </div>
  </div>
 </body>
</html>