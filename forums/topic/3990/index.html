<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Error #998 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3990" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=3990">Error #998</a></p>
   <div class="post" id="post-27248">
    <div class="subject"><a href="#post-27248">Error #998</a></div>
    <div class="body">Ok I have been coding a bot, and I recently made some changes to the source, and I screwed it royally.<br />It was working fine !! <br /><br />The code is thread-based, using WSAWaitForMultipleObjects on a single eventobject comprised of FD_CONNECT,FD_READ and FD_CLOSE.<br /><br />I wait for a socket event, then call WSAEnumSocketEvents to determine which event(s) have fired.<br /><br />Then I simply handle the events using an if else endif loop.<br /><br />All straightforward, just one socket, nice and easy.<br />Until I added some code to the FD_READ handler, and now this is what is happening:<br />I connect , and from inside the connect handler I send the first data, a login. I then jump back, waiting on the next event.<br />Next I get some data from the server, which I RECV and parse, and I find my login is fine, so I go to send my second datapacket.<br />This packet never gets sent, but no WSA error is generated by the SEND.. since I saw no error I jump back to the Wait function again, to await the reply....<br />here the event wait fails immediately with the error# 998<br />which I found out is ERROR_NOACCESS, 998 Invalid access to memory location.  <br />Ok the problem I have with that is that the data I am trying to send is in both cases located in the global data segment owned by the Parent of the thread, the main application window !!<br />(ie under .DATA)<br />Why does it work the first time and not the second time?<br />I have not changed the permissions I create the thread with , which is NULL (Inherit from Parent), and same for the thread stack size again NULL (Inherit from Parent).<br />Yipe!</div>
    <div class="meta">Posted on 2002-03-04 23:34:41 by Homer</div>
   </div>
   <div class="post" id="post-27280">
    <div class="subject"><a href="#post-27280">Error #998</a></div>
    <div class="body">FOOTNOTE:<br /><br />I am on an XP box, using the old ML.EXE (Masm7)<br /><br />I fixed the problem by changing the instructionset from .386 to .486 in the thread's parent (thread is an INCLUDE)<br />I am left to conclude that the problem was created by a compiler bug, as the permissions should be ok.<br />The problem occured when I accessed a dword variable located in the .DATA segment of the Parent from the Child Thread's FD_READ handler.<br />I look forward to getting my grubby paws on the updated ML.EXE which apparently exists in the new XP DDK.</div>
    <div class="meta">Posted on 2002-03-05 08:49:48 by Homer</div>
   </div>
   <div class="post" id="post-27307">
    <div class="subject"><a href="#post-27307">Error #998</a></div>
    <div class="body">The last version of ml.exe is in MS VisualEntArch.NET -&gt; 7.00.9466</div>
    <div class="meta">Posted on 2002-03-05 11:08:30 by buliaNaza</div>
   </div>
   <div class="post" id="post-27477">
    <div class="subject"><a href="#post-27477">Error #998</a></div>
    <div class="body">Would / Could someone post an URL to the updated ML.exe?<br /><br />Thanks,  P1</div>
    <div class="meta">Posted on 2002-03-06 08:35:56 by Pone</div>
   </div>
  </div>
 </body>
</html>