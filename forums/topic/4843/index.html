<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Looking for a &quot;ShowMessage&quot; macro - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4843" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4843">Looking for a &quot;ShowMessage&quot; macro</a></p>
   <div class="post" id="post-33969">
    <div class="subject"><a href="#post-33969">Looking for a &quot;ShowMessage&quot; macro</a></div>
    <div class="body">Hi everyone!<br /><br />In Delphi you can do a ShowMessage(&quot;Hello World!&quot;) to display a simple Messagebox with the specified text. I tried to do something like it in assembly with a macro but my macro skills aren't the best. The macro output should be something like this:<br /><br />invoke MessageBox,hWin,CTEXT(passed text),CTEXT(&quot;Info&quot;),MB_OK<br /><br />Can someone help me with this one? :confused: <br /><br /><br />/Delight</div>
    <div class="meta">Posted on 2002-04-18 15:10:10 by Delight</div>
   </div>
   <div class="post" id="post-33973">
    <div class="subject"><a href="#post-33973">Looking for a &quot;ShowMessage&quot; macro</a></div>
    <div class="body">This exists in form of the CTXT Macro and the SADD Macro... Here they are:<br /><br /><pre><code>&#91;size=12&#93;<br />; Hutch's SADD Macro<br />; Use&#58; invoke MessageBox,hwnd,SADD&#40;&quot;The Message&quot;&#41;,SADD&#40;&quot;The Title&quot;&#41;,MB_OK<br />; ---------------------<br />; literal string MACRO<br />; ---------------------<br />literal MACRO quoted_text<br />LOCAL local_text<br />    .data<br />    	local_text db quoted_text,0<br />    .code<br />	    EXITM &lt;local_text&gt;<br />ENDM<br />; --------------------------------<br />; string address in INVOKE format<br />; --------------------------------<br />SADD MACRO quoted_text<br />	EXITM &lt;ADDR literal&#40;quoted_text&#41;&gt;<br />ENDM<br />; --------------------------------<br />; string OFFSET for manual coding<br />; USE&#58; <br />; mov eax, CTXT&#40;&quot;Hello&quot;&#41;<br />; push 0<br />; push eax<br />; push eax<br />; push 0<br />; call MessageBox<br />; --------------------------------<br />CTXT MACRO quoted_text<br />	EXITM &lt;offset literal&#40;quoted_text&#41;&gt;<br />ENDM<br /></code></pre></span></div>
    <div class="meta">Posted on 2002-04-18 15:56:59 by JimmyClif</div>
   </div>
   <div class="post" id="post-33979">
    <div class="subject"><a href="#post-33979">Looking for a &quot;ShowMessage&quot; macro</a></div>
    <div class="body">instead of using .data/.code in the SADD macro, wouldn't it be better<br />to do something like (untested)...<br /><pre><code><br />literal MACRO quoted_text<br />LOCAL local_text<br />_data segment<br />    	local_text db quoted_text,0<br />_data ends<br />	    EXITM &lt;local_text&gt;<br />ENDM<br /></code></pre><br />?<br /><br />If this works :), it should be usable from any section, where the<br />original SADD only works within .code. SADD could be useful in .data<br />for, say, a string pointer table.<br /><br />Just wondering.</div>
    <div class="meta">Posted on 2002-04-18 17:10:38 by f0dder</div>
   </div>
   <div class="post" id="post-33986">
    <div class="subject"><a href="#post-33986">Looking for a &quot;ShowMessage&quot; macro</a></div>
    <div class="body">You can use this macro (found in Masm32/Macros/Macros.asm -- in Masm32 v7)<br /><br /><pre><code><br />   ; --------------------------------------------------------<br />    ; MsgBox macro takes 2 parameters, both can be either<br />    ; literal text in quotes or addresses of zero terminated<br />    ; strings passed with &quot;ADDR szString&quot; where szString is<br />    ; a zero terminated string. Note that ADDR is uppercase.<br />    ;<br />    ; example &#58; MsgBox &quot;Greetings all&quot;,ADDR szTitle<br />    ;           MsgBox ADDR szMessage,&quot;Result&quot;<br />    ;<br />    ; --------------------------------------------------------<br /><br />      MsgBox MACRO handl, TxtMsg, TxtTitle, styl<br /><br />        LOCAL Msg1<br />        LOCAL Titl<br /><br />        If @InStr&#40;1,&lt;TxtMsg&gt;,&lt;ADDR&gt;&#41; eq 0<br />          If @InStr&#40;1,&lt;TxtTitle&gt;,&lt;ADDR&gt;&#41; eq 0<br />          .data<br />            Msg1 db TxtMsg,0<br />            Titl db TxtTitle,0<br />          .code<br />            invoke MessageBox,handl,ADDR Msg1,ADDR Titl,styl<br />            EXITM<br />          EndIf<br />        EndIf<br /><br />        If @InStr&#40;1,&lt;TxtMsg&gt;,&lt;ADDR&gt;&#41; gt 0<br />          If @InStr&#40;1,&lt;TxtTitle&gt;,&lt;ADDR&gt;&#41; eq 0<br />          .data<br />            Titl db TxtTitle,0<br />          .code<br />            invoke MessageBox,handl,TxtMsg,ADDR Titl,styl<br />            EXITM<br />          EndIf<br />        EndIf<br /><br />        If @InStr&#40;1,&lt;TxtMsg&gt;,&lt;ADDR&gt;&#41; eq 0<br />          If @InStr&#40;1,&lt;TxtTitle&gt;,&lt;ADDR&gt;&#41; gt 0<br />          .data<br />            Msg1 db TxtMsg,0<br />          .code<br />            invoke MessageBox,handl,ADDR Msg1,TxtTitle,styl<br />            EXITM<br />          EndIf<br />        EndIf<br /><br />        If @InStr&#40;1,&lt;TxtMsg&gt;,&lt;ADDR&gt;&#41; gt 0<br />          If @InStr&#40;1,&lt;TxtTitle&gt;,&lt;ADDR&gt;&#41; gt 0<br />            invoke MessageBox,handl,TxtMsg,TxtTitle,styl<br />            EXITM<br />          EndIf<br />        EndIf<br /><br />      ENDM<br /><br /><br /></code></pre><br /><br />Sliver</div>
    <div class="meta">Posted on 2002-04-18 17:36:07 by Sliver</div>
   </div>
   <div class="post" id="post-33989">
    <div class="subject"><a href="#post-33989">Looking for a &quot;ShowMessage&quot; macro</a></div>
    <div class="body"><div class="quote">instead of using .data/.code in the SADD macro, wouldn't it be better <br />to do something like (untested)... </div><br /><br />or this (tested)...<br /><br /><pre><code><br />literal MACRO quoted_text<br />LOCAL local_text, SegName<br /><br />  SegName TEXTEQU @CurSeg<br /><br />  .data<br />  local_text db quoted_text,0<br /><br />  @CurSeg ENDS<br />  SegName SEGMENT<br /><br />EXITM &lt;local_text&gt;<br />ENDM<br /></code></pre><br /><br /><br /><strong>*****************************************</strong><br /><br /><br /><pre><code><br />.386<br />.model flat, stdcall<br />option casemap&#58;none<br /><br />include \masm32\include\windows.inc<br />include \masm32\include\user32.inc<br /><br />includelib \masm32\lib\user32.lib<br /><br />;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;<br /><br />MsgBox MACRO hWnd, sMessage, sCaption, uType <br /><br />; &#40;c&#41; Four-F<br /><br />local szMessage, Mes, szCaption, Cap<br /><br />    IF @InStr&#40;1, &lt;sMessage&gt;, &lt;!&quot;&gt;&#41; EQ 1  ;		; is it a string<br />    	.data<br />	    IF @InStr&#40;1, &lt;sMessage&gt;, &lt;!&quot;!&quot;&gt;&#41; EQ 1	; for null-string<br />			szMessage db 0<br />		ELSE<br />			szMessage db sMessage, 0<br />		ENDIF<br />		.code<br />		Mes TEXTEQU &lt;addr szMessage&gt;<br />	ELSE										; not a string<br />		.ERR &lt;MsgBox macro ERROR!!! Message must be a string.&gt;<br />		EXITM<br />    ENDIF<br />  <br />    IF @InStr&#40;1, &lt;sCaption&gt;, &lt;!&quot;&gt;&#41; EQ 1  ;		; is it a string<br />    	.data<br />	    IF @InStr&#40;1, &lt;sCaption&gt;, &lt;!&quot;!&quot;&gt;&#41; EQ 1	; for null-string<br />			szCaption db 0<br />		ELSE<br />			szCaption db sCaption, 0<br />		ENDIF<br />		.code<br />		Cap TEXTEQU &lt;addr szCaption&gt;<br />	ELSE										; not a string<br />		Cap TEXTEQU &lt;sCaption&gt;<br />    ENDIF<br /><br />    invoke MessageBox, hWnd, Mes, Cap, uType<br />    <br />ENDM<br /><br />;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;<br /><br />.code<br />start&#58;<br />	MsgBox NULL, &quot;Message with caption.&quot;, &quot;Caption&quot;, MB_ICONINFORMATION<br />	MsgBox NULL, &quot;Message without caption.&quot;, &quot;&quot;, MB_OK<br />	MsgBox NULL, &quot;Error Message.&quot;, NULL, MB_ICONERROR<br />	MsgBox NULL, &quot;&quot;, &quot;Empty message.&quot;, MB_ICONEXCLAMATION<br />	ret<br /><br />;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;&#58;<br /><br />end start<br /></code></pre><br /><br />But this form not supported yet:<br />MsgBox NULL, &quot;Message with caption.&quot;, addr szCaption, MB_OK<br /><br />It's very convenient sometimes.<br />If you want to use previously defined caption or message, for ex.<br />If you need it you can fix my macro.</div>
    <div class="meta">Posted on 2002-04-18 18:17:02 by Four-F</div>
   </div>
   <div class="post" id="post-33993">
    <div class="subject"><a href="#post-33993">Looking for a &quot;ShowMessage&quot; macro</a></div>
    <div class="body"><div class="quote"><br />Just wondering.</div>That is what I use. :)</div>
    <div class="meta">Posted on 2002-04-18 19:32:47 by bitRAKE</div>
   </div>
  </div>
 </body>
</html>