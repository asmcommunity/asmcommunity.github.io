<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>InternetGetConnectedState - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19007" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19007">InternetGetConnectedState</a></p>
   <div class="post" id="post-147058">
    <div class="subject"><a href="#post-147058">InternetGetConnectedState</a></div>
    <div class="body">Hi everyone<br /><br />Does <strong>InternetGetConnectedState</strong>  work in win98?<br />My win98 PC returns a &quot;connected&quot; value when it is not connected to the Internet or network.<br /><br />Thanks.</div>
    <div class="meta">Posted on 2004-07-29 01:38:02 by trexxz</div>
   </div>
   <div class="post" id="post-147062">
    <div class="subject"><a href="#post-147062">InternetGetConnectedState</a></div>
    <div class="body">It works correctly with my programs. Better try using InternetGetConnectedStateEx. And tell us what lpdwFlags are you setting - you may have set them wrong, who knows...<br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-07-29 03:55:48 by siddhartha</div>
   </div>
   <div class="post" id="post-147099">
    <div class="subject"><a href="#post-147099">InternetGetConnectedState</a></div>
    <div class="body">I have to declare INTERNET_CONNECTION_OFFLINE as it is not in windows.inc<br /><br /><br />My code goes like this.<br /><br />...<br /><br />.const<br />INTERNET_CONNECTION_OFFLINE	equ 20h<br /><br />...<br /><br />local  status  :DWORD<br /><br />invoke InternetGetConnectedState,addr status,NULL<br />.if eax<br />    mov eax,status<br />    and eax,INTERNET_CONNECTION_MODEM<br />    .if eax==INTERNET_CONNECTION_MODEM<br />        &quot;Display Connection by Modem Message&quot;<br />        jmp CONNECT_END<br />    .endif<br /><br />    mov eax,status<br />    and eax,INTERNET_CONNECTION_LAN<br />    .if eax==INTERNET_CONNECTION_LAN<br />        &quot;Display Connection by LAN Message&quot;<br />        jmp CONNECT_END<br />    .endif<br /><br />    CONNECT_END:<br /><br />.else<br />    mov eax,status<br />    and eax,INTERNET_CONNECTION_OFFLINE<br />    &quot;Display Offline Message&quot;<br />.endif<br /><br />...</div>
    <div class="meta">Posted on 2004-07-29 21:48:33 by trexxz</div>
   </div>
   <div class="post" id="post-147104">
    <div class="subject"><a href="#post-147104">InternetGetConnectedState</a></div>
    <div class="body">Perhaps its related to this (found in a search on the web):<br /><br /><div class="quote"><br />Win95 and IE4+?<br /><br />We can use WinInet and InternetGetConnectedState but if the user runs another browser (like Netscape)<br />and doesn't have IE configured then InternetGetConnectedState may give us false information.<br /><br />For example, I used to have IE installed on both WinNT4 and Win98 systems (with a LAN between them)<br />but I used NetScape with a modem on each machine to connect to the Internet (I now use Mozilla and DSL).<br />With Internet Explorer configured to use a LAN connection, InternetGetConnectedState always returns TRUE.<br />When I checked both of my systems they were both configured by default to &quot;use a LAN connection&quot; since I<br />never configured IE. On both systems I got TRUE from InternetGetConnectedState when I was not online.<br /><br />Microsoft <a target="_blank" href="http://support.microsoft.com/default.aspx?scid=kb;en-us;242558">http://support.microsoft.com/default.aspx?scid=kb;en-us;242558</a> says: &quot;You can be assured<br />however that if InternetGetConnectedState returns TRUE, that attempting your connection will NOT cause<br />you to be prompted to connect to the default Internet Service Provider.&quot; That statement was false on my<br />systems where I used NetScape. On my systems InternetGetConnectedState always returned TRUE, and<br />if I trusted that information and attempted a connection to some place on the Internet I got the default<br />dialup networking prompt.<br /></div></div>
    <div class="meta">Posted on 2004-07-29 23:27:28 by Graebel</div>
   </div>
   <div class="post" id="post-147165">
    <div class="subject"><a href="#post-147165">InternetGetConnectedState</a></div>
    <div class="body">That means using InternetGetConnectedState is not a good way to check for internet connection? What about InternetGetConnectedStateEx? Are there any other better ways?</div>
    <div class="meta">Posted on 2004-07-30 23:32:16 by trexxz</div>
   </div>
   <div class="post" id="post-147189">
    <div class="subject"><a href="#post-147189">here</a></div>
    <div class="body">Take a look at this prog from Iczy's site<br /><br /><a target="_blank" href="http://spiff.tripnet.se/~iczelion/files/Welcome2Net.zip">http://spiff.tripnet.se/~iczelion/files/Welcome2Net.zip</a><br /><br />You could put the loop in another thread in your prog, or you can do it in the message lop of your prog<br /><br />Hope its useful!:alright: <br /><br />Thomas Antony:alright:</div>
    <div class="meta">Posted on 2004-07-31 09:31:00 by thomasantony</div>
   </div>
   <div class="post" id="post-147252">
    <div class="subject"><a href="#post-147252">InternetGetConnectedState</a></div>
    <div class="body">Thanks thomasantony.<br /><br /><br />I'm looking for a way which does not trigger off firewall alerts. E.G. zonealarm. Therefore, i do not want to try to connect to a host or url. <br /><br />So far, i only know about InternetGetConnectedState. <br /><br />:)</div>
    <div class="meta">Posted on 2004-08-01 21:46:14 by trexxz</div>
   </div>
   <div class="post" id="post-147259">
    <div class="subject"><a href="#post-147259">InternetGetConnectedState</a></div>
    <div class="body">InternetGetConnectedState will completely fail you if someone is using NAT.</div>
    <div class="meta">Posted on 2004-08-02 07:19:13 by The Beginner</div>
   </div>
   <div class="post" id="post-147281">
    <div class="subject"><a href="#post-147281">InternetGetConnectedState</a></div>
    <div class="body">The Beginner<br /><br />Do you mean Network Address Translation?</div>
    <div class="meta">Posted on 2004-08-02 21:39:59 by trexxz</div>
   </div>
   <div class="post" id="post-147402">
    <div class="subject"><a href="#post-147402">InternetGetConnectedState</a></div>
    <div class="body">Yes.<br /><br />For instance...<br /><br />Someone is hooked up to the internet via a router on their LAN. InternetGetConnectedState() will ALWAYS see the internet as &quot;active&quot; because the router is usually active handling the LAN as well as the internet connection.<br /><br />That is why pinging is the better option. If you want to skirt around a firewall (for whatever your reasons may be), you can hook into an application that can access the 'net and check the connection through that.</div>
    <div class="meta">Posted on 2004-08-04 18:58:18 by The Beginner</div>
   </div>
  </div>
 </body>
</html>