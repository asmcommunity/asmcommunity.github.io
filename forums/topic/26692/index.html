<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Retrieving Desktop path. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26692" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26692">Retrieving Desktop path.</a></p>
   <div class="post" id="post-192628">
    <div class="subject"><a href="#post-192628">Retrieving Desktop path.</a></div>
    <div class="body">Hi there, I used to know where in the registry you could find the path to the desktop and program folder and such. And I know you are not supposed to assume C:\WINDOWS\DESKTOP\ because people might change it, or might be on a network setup, etc...

Does anyone know where in the registry the path to the desktop is stored and to the programs folder?
Thanks
Ben</div>
    <div class="meta">Posted on 2001-01-27 22:10:00 by cyberben</div>
   </div>
   <div class="post" id="post-192629">
    <div class="subject"><a href="#post-192629">Retrieving Desktop path.</a></div>
    <div class="body">Never mind, a little registry surfing found the answer. For all others who want this information all shell folder paths are stored in this key:

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders

See ya,
Ben</div>
    <div class="meta">Posted on 2001-01-27 22:30:00 by cyberben</div>
   </div>
   <div class="post" id="post-192630">
    <div class="subject"><a href="#post-192630">Retrieving Desktop path.</a></div>
    <div class="body">Ummmmm, im not so sure if that is correct, because on my machine, there are different profiles for different users, so each user has there own desktop. So i checked it out in the registry, and that key doesn't exist. There definatly is a way, to retirve the path, but i think you will have to delve deeper into the windows shell interface.</div>
    <div class="meta">Posted on 2001-01-29 19:19:00 by X</div>
   </div>
   <div class="post" id="post-192631">
    <div class="subject"><a href="#post-192631">Retrieving Desktop path.</a></div>
    <div class="body">Nope. I Checked it out that is correct. The registry is actually stored in two seperate files on your machine in all case. One which is common to all users and one which is special for each user. Notice the HKEY_CURRENT_USER, that root will be changed depending on which user is logged in. I've already incorporated that into the setup program I've been writing and it worked on Win95, Win98, Win98SE, WinNT4Sp6 (I'm assuming that must have had network stuff on it) and Win2KSp1 (Also might have had network stuff on it or multi users). The only version of windows it didn't work on was ME and that was an API Error, which should soon be fixed!

I'll test this out at work to confirm this in a network (multiuser) environment later just in case though.
See ya,
Ben</div>
    <div class="meta">Posted on 2001-01-29 23:36:00 by cyberben</div>
   </div>
  </div>
 </body>
</html>