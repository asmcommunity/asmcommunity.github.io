<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Save a var after exit - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19160" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19160">Save a var after exit</a></p>
   <div class="post" id="post-148134">
    <div class="subject"><a href="#post-148134">Save a var after exit</a></div>
    <div class="body">I bulit a program with vars and I want to open the program and to find the vars exucly the same before I close the program <br /><br />example: <br /><br />var1 = 1 <br />close program <br />open program<br />var1 = 1</div>
    <div class="meta">Posted on 2004-08-15 11:32:08 by </div>
   </div>
   <div class="post" id="post-148135">
    <div class="subject"><a href="#post-148135">Save a var after exit</a></div>
    <div class="body">Use the registry or some external file to store the contents of the variable, and read it back when the program starts.<br /><br />It sounds like you want to change the contents of the variable in the EXE file - this isn't really possible from a windows program.</div>
    <div class="meta">Posted on 2004-08-15 11:39:51 by f0dder</div>
   </div>
   <div class="post" id="post-148136">
    <div class="subject"><a href="#post-148136">Save a var after exit</a></div>
    <div class="body">You would have to save the variable in a file (for example .ini files) or store it in registry.</div>
    <div class="meta">Posted on 2004-08-15 11:39:59 by roticv</div>
   </div>
   <div class="post" id="post-148137">
    <div class="subject"><a href="#post-148137">Save a var after exit</a></div>
    <div class="body">Write your data to file on exit, and read it back on startup.<br /><br />Edit: Heh, all replied at the same time.</div>
    <div class="meta">Posted on 2004-08-15 11:40:35 by iblis</div>
   </div>
   <div class="post" id="post-148138">
    <div class="subject"><a href="#post-148138">Save a var after exit</a></div>
    <div class="body">how can I write to .ini , .dat files?</div>
    <div class="meta">Posted on 2004-08-15 11:42:43 by </div>
   </div>
   <div class="post" id="post-148139">
    <div class="subject"><a href="#post-148139">Save a var after exit</a></div>
    <div class="body">Some basics on file I/O:<br /><a target="_blank" href="http://spiff.tripnet.se/~iczelion/tut12.html">http://spiff.tripnet.se/~iczelion/tut12.html</a></div>
    <div class="meta">Posted on 2004-08-15 11:45:39 by iblis</div>
   </div>
   <div class="post" id="post-148140">
    <div class="subject"><a href="#post-148140">Save a var after exit</a></div>
    <div class="body">You can make use of the api WriteProfileString and GetProfileString for .ini files.</div>
    <div class="meta">Posted on 2004-08-15 11:48:29 by roticv</div>
   </div>
   <div class="post" id="post-148142">
    <div class="subject"><a href="#post-148142">Save a var after exit</a></div>
    <div class="body">indeed, file I/O is a not-done for .ini files. anyway are .ini files not very appreciated, better use the registry. it is very easy, you'll need the Reg* api from advapi.dll/lib.</div>
    <div class="meta">Posted on 2004-08-15 12:42:11 by Mbee</div>
   </div>
   <div class="post" id="post-148148">
    <div class="subject"><a href="#post-148148">Save a var after exit</a></div>
    <div class="body">.dat, .ini, whatever.  It depends on how easily you want to give users access to initialization data.<br />I would encourage learning basic file I/O, as it is one of the fundamental concepts with which new programmers should familiarize themselves.<br /><br />The .ini parsing APIs are dinosaurs from the Win 3.x days, and adhere to a strict format which one may or may not find to their liking or needs.  I personally don't like it, but for very simple purposes it works well.<br /><br />The windows registry is handy, but can quickly become a disaster zone if you don't know what you're doing, and should be used sparingly.<br />Here are some articles from MS about the registry:<br /><a target="_blank" href="http://msdn.microsoft.com/msdnmag/issues/1100/Registry/default.aspx">http://msdn.microsoft.com/msdnmag/issues/1100/Registry/default.aspx</a><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/registry_storage_space.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/registry_storage_space.asp</a><br /><br />There's also an article which I couldn't immediately find which details the correct steps an application should take when making use of the registry.  Try to find it and read it if you can.  For the multiuser environments like Windows NT/2k/XP/2k3, there's also the matter of security  and permissions, as things might not always behave as expected if you are not running under administrator credentials.  This applies to file I/O as well.</div>
    <div class="meta">Posted on 2004-08-15 14:34:30 by iblis</div>
   </div>
  </div>
 </body>
</html>