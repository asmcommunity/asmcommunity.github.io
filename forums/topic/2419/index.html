<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How to : Simple+Easy IDE Bar - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2419" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=2419">How to : Simple+Easy IDE Bar</a></p>
   <div class="post" id="post-15285">
    <div class="subject"><a href="#post-15285">How to : Simple+Easy IDE Bar</a></div>
    <div class="body">data <br /><br />;--location in registry for actual screensize <br />SCREENSIZE_KEY db 'Config\0001\Display\Settings\',0 <br />SCREENSIZE_VALUE db 'Resolution',0 <br /><br /><br />;-- strings for check if regvalue = <br />REG_VALUE_1 db '1024,768',0 <br />REG_VALUE_2 db '800,600',0 <br /><br /><br />; --flags so whe dont need to check all twice <br />SIZESCREEN_FLAG_1024 dd 0 <br />SIZESCREEN_FLAG_800   dd 0 <br /><br /><br /><br />;--buffer for screensize <br />SCREENSIZE_ACTUAL DB 40 dup (0) <br /><br />;--the rest  <br />Vdatsize06 dd 40 <br />handle dd 0 <br /><br /><br />.code <br />..... <br />..... <br />;--- if WM_INITDIALOG = jmp dlginit <br />..... <br />..... <br />..... <br />..... <br />dlginit: <br />..... <br />call GET_SET_SIZE <br />..... <br />..... <br />..... <br />..... <br />ret <br /><br /><br />;********************************** G E T S I Z E F R O M R E G I S T R Y ***************************** <br />GET_SET_SIZE PROC <br />mov SIZESCREEN_FLAG_1024,0 ;-- set flags to 0 to have allways fresh settings <br />mov SIZESCREEN_FLAG_800,0 ;-- set flags to 0..... <br /><br />call RegOpenKeyEx,80000002h,offset SCREENSIZE_KEY,1, 1, offset handle ;--open regkey <br />call RegQueryValueExA, handle, offset sinfo, 0, 0, offset SCREENSIZE_ACTUAL, offset Vdatsize06 ;-- read value as string <br />call RegCloseKey,handle ;-- close the regkey <br /><br />mov edi, offset SCREENSIZE_ACTUAL ;--- mov actual size from registry <br />mov esi, offset REG_VALUE_1 ;-- mov 1 string to check for <br />mov ecx, 5 <br />repz cmpsb <br />jnz NOTOK_NEXT_2 ;-- not equal then jump to check next <br />mov SIZESCREEN_FLAG_1024,1 ;--- set flag from 0 to 1so whe dont need to check twice the reg later <br />call NEWSIZE_1024 ;-- is equal then call the function <br />ret <br />;-------- <br />NOTOK_NEXT_2: <br />mov edi, offset SCREENSIZE_ACTUAL <br />mov esi, offset REG_VALUE_2 <br />mov ecx, 5 <br />repz cmpsb <br />jnz NOTOK_NEXT_3 <br />mov SIZESCREEN_FLAG_800,1 <br />call NEWSIZE_800 <br />ret <br />;-------- <br />NOTOK_NEXT_3: <br />;-- and again and again = next screensize...... <br />;-- or make a error message shown up = error ,need bigger/smaller resolution to run. <br />ret <br />GET_SET_SIZE ENDP <br />;********************************** S E T N E W S I Z E ***************************** <br />NEWSIZE_1024 PROC <br />call MoveWindow ,hwnd_,0,0,1024,40, TRUE ;-----set dialog window to new size &amp; position 0,0,1024,40= left/right,top/down,widht,hight <br /><br />call GetDlgItem, hwnd_, IDB_EXIT ;----- get the exit button <br />call MoveWindow,eax,990,9,20,20, TRUE ;----- move exit button to new postion <br />..... <br />..... <br />..... <br />ret <br />NEWSIZE_1024 ENDP <br />;*************************** <br />NEWSIZE_800 PROC <br />call MoveWindow ,hwnd_,0,0,800,40, TRUE ;-----set dialog window to new size &amp; position <br /><br /><br />call GetDlgItem, hwnd_, IDB_EXIT ;----- get the exit button <br />call MoveWindow,eax,773,9,20,20, TRUE ;----- move exit button to new postion <br />..... <br />..... <br />..... <br />ret <br />NEWSIZE_800 ENDP <br />;*************************** <br /><br /><br /><br />;-- other program code <br /><br /><br /><br />;*************************************************<br />********* <br />;this function is if you have buttons on the dialog and when you press one the <br />;dialogbutton the function should set the dialog to your worksize and center on the screen <br />;use in wm_somebuttonpressed = call BIGWINDOW ;-) <br />;if you allways use the same size for your idebar or what ever ,forget this code. <br />;*************************************************<br />********* <br />BIGWINDOW PROC <br />cmp SIZESCREEN_FLAG_1024,1 ;---- check the flag so whe dont need to check the registry again <br />je CENTER_1024 ;---- if yes jump to function <br />cmp SIZESCREEN_FLAG_800,1 <br />je CENTER_800 <br />ret <br /><br />CENTER_1024: <br />call MoveWindow ,hwnd_,200,260,662,257, TRUE ;-----set dialog window to new size &amp; position <br /><br />call GetDlgItem, hwnd_, IDB_EXIT ;----- get the exit button <br />call MoveWindow,eax,635,9,20,20, TRUE ;----- move exit button to new postion <br />...... <br />...... <br />...... <br />...... <br />ret <br /><br /><br />CENTER_800: <br />call MoveWindow ,hwnd_,80,160,662,257, TRUE ;-----set dialog window to new size &amp; position <br /><br />call GetDlgItem, hwnd_, IDB_EXIT ;----- get the exit button <br />call MoveWindow,eax,635,9,20,20, TRUE ;----- move exit button to new postion <br />...... <br />...... <br />...... <br />...... <br />ret <br />BIGWINDOW ENDP</div>
    <div class="meta">Posted on 2001-12-18 07:41:27 by Max</div>
   </div>
  </div>
 </body>
</html>