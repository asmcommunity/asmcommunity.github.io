<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Callback procedure - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9801" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9801">Callback procedure</a></p>
   <div class="post" id="post-72857">
    <div class="subject"><a href="#post-72857">Callback procedure</a></div>
    <div class="body">Hello.<br />How can I create a dll in which a procedure gives me a value back?<br />Could you post me an exampel procedure?<br /><br />Thanks</div>
    <div class="meta">Posted on 2002-12-27 04:59:42 by Alunitro3078</div>
   </div>
   <div class="post" id="post-72866">
    <div class="subject"><a href="#post-72866">Callback procedure</a></div>
    <div class="body">Okie dokie.  I'm sure there's many ways to do it, but you could for example have in your <em>program</em> source:<br /><br /><pre><code>SomeFunction proto &#58;DWORD<br />....<br />includelib myDll.lib</code></pre><br /><br />And of course, in your <em>dll</em> you declare the function proto and the write the proc as per normal:<br /><br /><pre><code><br />SomeFunction proto &#58;DWORD<br />....<br />SomeFunction proc asdf&#58;DWORD<br />    ; Insert goodies here &#58;&#41;<br />    mov eax, theReturnValue<br />    ret<br />SomeFunction endp<br /></code></pre><br /><br />Export the function as per Iczelion's DLL tutorial, and you're free to call SomeFunction from your program.  Once again, refer to Iczelion's tut on how to do this using LoadLibrary if you so desire.<br /><br />Hope this helps (it'd be nice if I could contribute even a little to this great board)</div>
    <div class="meta">Posted on 2002-12-27 06:06:29 by Miko</div>
   </div>
   <div class="post" id="post-72871">
    <div class="subject"><a href="#post-72871">Callback procedure</a></div>
    <div class="body">thanks!<br />thats what I wanted :)</div>
    <div class="meta">Posted on 2002-12-27 06:30:57 by Alunitro3078</div>
   </div>
  </div>
 </body>
</html>