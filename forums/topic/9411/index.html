<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Monitoring CPU Load - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9411" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9411">Monitoring CPU Load</a></p>
   <div class="post" id="post-69665">
    <div class="subject"><a href="#post-69665">Monitoring CPU Load</a></div>
    <div class="body">I want to create a program that monitors the CPU load (like the task manager of Windows NT).<br /><br />I have no idea where to begin so any help will be appriciated.<br /><br />Thanks</div>
    <div class="meta">Posted on 2002-12-07 05:12:03 by titanium</div>
   </div>
   <div class="post" id="post-69670">
    <div class="subject"><a href="#post-69670">Monitoring CPU Load</a></div>
    <div class="body">I *think* you can get that info from the registry. Not sure where....</div>
    <div class="meta">Posted on 2002-12-07 05:50:52 by Xtreme</div>
   </div>
   <div class="post" id="post-69685">
    <div class="subject"><a href="#post-69685">Monitoring CPU Load</a></div>
    <div class="body">Hi titanium,<br /><br />On WinME I invoke GlobalMemoryStatus into a MEMORYSTATUS structure and read the 'load' from the MemStat.dwMemoryLoad structure element.<br /><br />I use MyGetFreeSystemResources32@4 from the rsrc32.dll to get the System, User, and GDI amounts.<br /><br />I gave up on trying to display the CPUusage percent, since M$ documentation stated it could be read from the registry...then later retracted that saying it wasn't accurate..HAHaha..read: way off. I see that several prgs deal with it in some way to get a stable accurate reading, but I put it aside on the backburner and haven't messed with it since. <br /><br />I don't know if any of this has anything at all to do with NT or not though.</div>
    <div class="meta">Posted on 2002-12-07 07:09:06 by gscundiff</div>
   </div>
   <div class="post" id="post-69767">
    <div class="subject"><a href="#post-69767">Monitoring CPU Load</a></div>
    <div class="body">gscundiff,<br /><br />I've had the same experience with GlobalMemoryStatus. Not a reliable API.</div>
    <div class="meta">Posted on 2002-12-07 16:31:40 by Xtreme</div>
   </div>
   <div class="post" id="post-69774">
    <div class="subject"><a href="#post-69774">Monitoring CPU Load</a></div>
    <div class="body">Indeed there is very simple/bad support for such a function in WIndows OS. <br /><br />It wrongly assumes that IF you are not waisteing time in a GetMessage Loop  (even if you are corectly using PeekMessage to deal with system requests) you are using 100% of CPU time.<br /><br />This is obviouse wrong because if my application uses 100% of CPU time then how am i able to play MP3 music, read email, and act as a file server and router in the same time? eh?<br /><br />You can try and use RDTSC instruction inside a driver (better) or even inside a ring3 WINAPI application to detect how much time all OTHER tasks took from you... but that will not be very accurate as there is no way of knowing where the time was waisted (ie inside OS or other applications).<br /><br />You should inject your little RDTSC code int each and all applications and sum up the time they use, the rest has to be used up by the system OS... i guess ...<br /><br />From here on you are on your own ;)</div>
    <div class="meta">Posted on 2002-12-07 17:27:29 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-69968">
    <div class="subject"><a href="#post-69968">PDH stuff...</a></div>
    <div class="body">I've ported it FROM vb... ;) it use the Pdh* func.<br />Actually you'll have to change the line<br /><pre><code><br />pdhStrCounter	db &quot;\Processeur&#40;0&#41;\% Temps Processeur&quot;,0<br /></code></pre><br />to it's english equivalent.. (got a french windows version...)<br />it must be something like &quot;Processor(0)\% Processor time&quot; or SLT<br /><br />Hope it helps...</div>
    <div class="meta">Posted on 2002-12-09 01:31:21 by PhoBos</div>
   </div>
   <div class="post" id="post-69970">
    <div class="subject"><a href="#post-69970">:-)</a></div>
    <div class="body">Just see the name of the zip file :))<br />ThX  goes to Iczelion's tuts...  :grin:</div>
    <div class="meta">Posted on 2002-12-09 01:32:52 by PhoBos</div>
   </div>
   <div class="post" id="post-70009">
    <div class="subject"><a href="#post-70009">Monitoring CPU Load</a></div>
    <div class="body">just an information<br /><strong>PdhTool requires pdh.dll. The library is not supported by, and consequently PdhTool will not work on, systems running Windows 95, 98, or ME. </strong><br /><br />dont have pdh.dll, get it from <a target="_blank" href="http://www.microsoft.com/Downloads/release.asp?releaseid=30336">here</a> <br /><br />another program that uses pdh with source <a target="_blank" href="http://www.cheztabor.com/PdhTool/">PdhTool</a> <br /><br />both dont work on my NT4SP6. donno why.<br /><br />one program that works, but no source <a target="_blank" href="http://pesoft.fr.st">TinyResMeter</a> </div>
    <div class="meta">Posted on 2002-12-09 05:32:31 by TBD</div>
   </div>
  </div>
 </body>
</html>