<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>howto use C++ classes in MASM? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9816" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9816">howto use C++ classes in MASM?</a></p>
   <div class="post" id="post-73025">
    <div class="subject"><a href="#post-73025">howto use C++ classes in MASM?</a></div>
    <div class="body">hello,<br /><br />i have trubl using static lib originally written for VC++ it uses VC classes and<br />decoreted exports... ?Play@CWsp@@QAEXPAXH@Z...<br /><br />to access the class from finctions i wrote just an intermediate lib in C with<br />stdcall demangled exports... <br /><br />extern &quot;C&quot; __declspec(dllexport) void wsp_play(HINSTANCE hInst, WORD ResID, const char *ResDir, CWsp::EModType eType)<br /><br />this is compiled in OK format: _wsp_play in the lib<br /><br />however on final link of my asm project there's many library conflicts:<br />double defs in libc.lib and libcmt.lib. I knew how resolve this disabling one of these libs.<br />(my asm project uses c++ library by default (libc.lib), changing this to libcmt doesn't help)<br /><br />beside this libc can't find main() func in my code (however this is handled previously by assembler, and i'm using WinMain)<br /><br />i need get it running (can provide the libraries if necessary)</div>
    <div class="meta">Posted on 2002-12-28 11:41:35 by _Servil_</div>
   </div>
  </div>
 </body>
</html>