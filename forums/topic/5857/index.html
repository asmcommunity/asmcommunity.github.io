<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Help With TAPI - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5857" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5857">Help With TAPI</a></p>
   <div class="post" id="post-41987">
    <div class="subject"><a href="#post-41987">Help With TAPI</a></div>
    <div class="body">I have a problem with TAPI. I'm creating an application that waits for incoming calls while I'm online on my dial-up connection and notifies me of the incoming call. I have initialized and opened all lines and my program is able to detect outbound calls made on my modem, but it cannot detect inbound calls when I plug in my telephone wire. In fact the line callback function is not even called once even though a call is coming in.<br /><br />Thnx in advance.</div>
    <div class="meta">Posted on 2002-06-08 04:37:55 by SubzeroHeat</div>
   </div>
   <div class="post" id="post-42012">
    <div class="subject"><a href="#post-42012">Help With TAPI</a></div>
    <div class="body">A while back i was interested in TAPI and there has never been much said about it but a few short posts .... <br /><br />Search the word TAPI here....<br /><br />than go for gooies or what ever their name is.  It's good too but a lot to search..</div>
    <div class="meta">Posted on 2002-06-08 12:20:59 by cmax</div>
   </div>
   <div class="post" id="post-42016">
    <div class="subject"><a href="#post-42016">Help With TAPI</a></div>
    <div class="body">If you are online using a dial-up then your line will be engadged so won't ring. If you have some kind of call waiting on your line that that might interupt the internet connection and let u take the call but I'm not sure.</div>
    <div class="meta">Posted on 2002-06-08 12:47:35 by Kudos</div>
   </div>
   <div class="post" id="post-43398">
    <div class="subject"><a href="#post-43398">Help With TAPI</a></div>
    <div class="body">I finally found the solution. I tried getting help but I can't believe how little other developers know about TAPI. So little that even after weeks of searching, I couldn't find the answer, so I decided to dig deeper into my help file and found that you have to call a function, lineSetStatusMessages, to receive inbound calls as notification of incoming calls are disabled by default. After opening the line, write this line of code for every telephony line opened:<br /><br /><br />lineSetStatusMessages(oLines, LINEDEVSTATE_RINGING | LINEDEVSTATE_NUMCALLS | LINEDEVSTATE_OTHER,        					      LINEADDRESSSTATE_NUMCALLS | LINEADDRESSSTATE_OTHER<br />		     );<br /><br /><br /><br /><br />olines is the line. I've tried it and I will receive LINECALLSTATE offering messages when a call comes in. I will also receive LINDEVSTATE_RINGING messages. My application will also be notified once the caller hangs up before you get to answer the call. Note that, for me, this technique does not work for calls that come in through call waiting. I hope this is a good help for other developers who face similar problems.</div>
    <div class="meta">Posted on 2002-06-15 03:15:04 by SubzeroHeat</div>
   </div>
  </div>
 </body>
</html>