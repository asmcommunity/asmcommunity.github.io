<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Need this to copy only if destination file is older - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22619" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22619">Need this to copy only if destination file is older</a></p>
   <div class="post" id="post-169668">
    <div class="subject"><a href="#post-169668">Need this to copy only if destination file is older</a></div>
    <div class="body">I&#39;d like to modify this so it only copies if the destination file is older than the source.<br />Not sure where to start at.<br /><br />&nbsp; &nbsp; LOCAL buffer[260]:BYTE<br />&nbsp; &nbsp; invoke GetCL,1,ADDR buffer<br /><br />&nbsp; &nbsp; ; Specifies how this operation is to proceed if a file of the same <br />&nbsp; &nbsp; ; name as that specified by lpNewFileName already exists. <br />&nbsp; &nbsp; ; If this parameter is TRUE and the new file already exists,<br />&nbsp; &nbsp; ; the function fails. If this parameter is FALSE and the new file<br />&nbsp; &nbsp; ; already exists, the function overwrites the existing file and succeeds.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br /><br />&nbsp; &nbsp; ; remove file attributes from destination file in case it&#39;s READ-ONLY<br />&nbsp; &nbsp; invoke SetFileAttributes, offset File2,FILE_ATTRIBUTE_NORMAL<br /><br />&nbsp; &nbsp; ; If file isn&#39;t already there, this copies it there<br />&nbsp; &nbsp; invoke CopyFile, offset File1, offset File2, TRUE<br /><br />&nbsp; &nbsp; ; Otherwise, make it so.<br />&nbsp; &nbsp; invoke CopyFile, offset File1, offset File2, FALSE<br /></div>
    <div class="meta">Posted on 2006-01-18 15:15:13 by skywalker</div>
   </div>
  </div>
 </body>
</html>