<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>how to get current line of text in multiline editbox? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16487" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16487">how to get current line of text in multiline editbox?</a></p>
   <div class="post" id="post-128173">
    <div class="subject"><a href="#post-128173">how to get current line of text in multiline editbox?</a></div>
    <div class="body">I have a subclassed editbox which is all well and good..  I would like to be able to get the current line of wherever my cursor is.. other examples get the line index number from your selected text which is no good.<br />other examples expect you to know the line index number to do an EM_GETLINE.  It works great with EM_GETLINE but how do I get the current line#  (NDY)?   via<br /><br />invoke SendMessage, hwndEdit, EM_GETLINE, NDY, addr SingleLine<br /><br /><br />If I have to keep track of it myself, I would rather build my own control dernit..<br /><br /><br />thanks</div>
    <div class="meta">Posted on 2003-12-17 13:44:48 by drarem</div>
   </div>
   <div class="post" id="post-128185">
    <div class="subject"><a href="#post-128185">how to get current line of text in multiline editbox?</a></div>
    <div class="body">i didn't try it, but could work <br /><br />call  SendMessage, hEditBox,  EM_LINEFROMCHAR, -1,  0<br />add eax, 1<br /><br />in eax should be the current line.<br />    <br />Bit7</div>
    <div class="meta">Posted on 2003-12-17 14:41:20 by Bit7</div>
   </div>
   <div class="post" id="post-128264">
    <div class="subject"><a href="#post-128264">how to get current line of text in multiline editbox?</a></div>
    <div class="body">Thanks, it works perfectly when subtracting 1 from eax instead of adding..<br /><br />sub eax, 1..<br /><br />and not adding or subtracting to/from eax when not throwing up a messagebox, I guess it depends on how you use it, but thanks again :)</div>
    <div class="meta">Posted on 2003-12-18 07:09:19 by drarem</div>
   </div>
   <div class="post" id="post-128313">
    <div class="subject"><a href="#post-128313">how to get current line of text in multiline editbox?</a></div>
    <div class="body">oops, just a transcription error :)<br /><br />B7</div>
    <div class="meta">Posted on 2003-12-18 14:01:34 by Bit7</div>
   </div>
  </div>
 </body>
</html>