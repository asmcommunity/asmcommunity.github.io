<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Modified version of nasm ;) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14082" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=35">Toolchain Development</a> &raquo; <a href="../?id=14082">Modified version of nasm ;)</a></p>
   <div class="post" id="post-108806">
    <div class="subject"><a href="#post-108806">Modified version of nasm ;)</a></div>
    <div class="body">Hey is valid a modification to nasm??<br /><br /><br /><br />In the last days i was modificating nasm.. and i do ;), now can suport in a more direct way struct and unions, also nested or for exaple if you define some like:<br /><br />aMember aDataType<br /><br /><br />you have a valid name, etc. i try add all the functionality that have or i see in C struct/unions, also suport the block of selections inside the sutrct/unions...<br /><br />I am happy that i can modificate, at less works ok.. and as I spected.<br /><br />I will not attach here, i send the code to frank.<br /><br />I don know if is a good implementation.. i dont know much of compilers and such tings.. near to nothing.. i dont understand BNF.. but i see that i can implement this and i do.<br /><br />If this modification is not used in the normal package of nasm, i will use on my own. ;).<br /><br /><br />Also i need that i learn some things reading the code.. and modificating sure, and understand ther things. and learn about how to program.<br /><br />In fact i learn some about the diferent ways.. for example.. i start in a way of two fases.. or steps.. the first, was the definition of the data type, and the second was the insertion for later use.  I know that i can skeep this step, and only do one step. But i was in front of a really heavy structure.. in the manipulation.. lol, and the later implementations let me see that really i can skeep this step without problems..<br /><br /><br />The whole time take me do this modifications was like 20 days:<br />The days of work that i take was distributed in:<br /><br />4 days of quake<br />6 days of do nithing... or think and pass the time<br /><br />10 days of work:<br />divided in:<br /><br />like 6+/- days of work in the point of view one (with two steps)<br />like 2 +/- days of implementation in the second point of view (skeeping the first step)<br /><br />uuhh??.. the sume(addition) are not 10... lol the other 2 days.. the ufo capture me.. i think.. dont remember.<br /><br /><br />Ok, the point here is that i want your feedback about the modification that I do, ok, that is all.. i think.<br /><br />If the code is not put in the CVS of nasm,  then i post here for your feedback.<br /><br />Also and only this addition is only not to write some like:<br /><br />wnd+WNDCLASSEX.cbSize<br /><br />now you can do some like:<br />wnd.cbSize<br /><br />NOTE: i see that skeep and skeeping is not in your idiom.. the correct word is skip and skiping.. the pronunciation  play with me in this word.  Thing diferent, almost I done!!!.. :S:confused: <br /><br /><br />Nice day.:alright:</div>
    <div class="meta">Posted on 2003-06-30 11:58:56 by rea</div>
   </div>
   <div class="post" id="post-112737">
    <div class="subject"><a href="#post-112737">hi!!!</a></div>
    <div class="body">Ok, i terminate this but only cover my necessities... i not cover initialized structs/unions but this is a strong part  like initialize tables of structs and such things in the code and not in the run time this is the major left thing, but have cualified names for registers.. ok an example of how look like (with a macro for funct and in front of the locals a '.' ;) ).<br /><br /><pre><code><br />%include &quot;\lab\vasm\inc\win32n_.inc&quot;<br />%include &quot;\lab\vasm\inc\F_4_n.inc&quot;<br /><br /><br />def WinMain, 4<br />def WndProc, 4<br />section data class = data use32 align=16<br />section code class=code use32 aling=16<br /><br />..start&#58;<br />	var hInstance, HINSTANCE<br />	call GetModuleHandle, NULL<br />	mov dword&#91;hInstance&#93;, eax<br />	var cmdLine, LPSTR<br />	call GetCommandLine, NULL<br />	mov dword&#91;cmdLine&#93;, eax<br />	call WinMain, &#91;hInstance&#93;, NULL, &#91;cmdLine&#93;, SW_SHOWDEFAULT<br />	call ExitProcess, eax<br /><br />funct WinMain, hInstance, hPInst, lpCmdL, nCmdShow<br />	sizef 80<br />	local wc, WNDCLASSEX, msg, MSG, hwnd, HWND<br />	%makedata WNDCLASSEX .wc<br />	%makedata MSG .msg<br /><br />	mov dword&#91;.wc.cbSize&#93;, WNDCLASSEX_size<br />	mov dword&#91;.wc.style&#93;, CS_VREDRAW | CS_HREDRAW<br />	mov dword&#91;.wc.lpfnWndProc&#93;, WinProc<br />	mov dword&#91;.wc.cbClsExtra&#93;, NULL<br />	mov dword&#91;.wc.cbWndExtra&#93;, NULL<br />	mov eax, dword&#91;.hInstance&#93;<br />	mov dword&#91;.wc.hInstance&#93;, eax<br />	mov dword&#91;.wc.hbrBackground&#93;,COLOR_WINDOW+1<br />	mov dword&#91;.wc.lpszMenuName&#93;, NULL<br />	var ClassName, &quot;CLASSNAME&quot;<br />	mov dword&#91;.wc.lpszClassName&#93;, ClassName<br />	call LoadIconA, NULL, IDI_APPLICATION<br />	mov dword&#91;.wc.hIcon&#93;, eax<br />	mov dword&#91;.wc.hIconSm&#93;, eax<br />	call LoadCursor, NULL, IDC_ARROW<br />	mov dword&#91;.wc.hCursor&#93;, eax<br />	lea eax, &#91;.wc&#93;<br />	call RegisterClassEx, eax<br />	var AppName, &quot;AppName&#58;&quot;<br />	call CreateWindowEx, NULL,\<br />				ClassName,\<br />				AppName,\<br />				WS_OVERLAPPEDWINDOW,\<br />				CW_USEDEFAULT,\<br />				CW_USEDEFAULT,\<br />				CW_USEDEFAULT,\<br />				CW_USEDEFAULT,\<br />				NULL,\<br />				NULL,\<br />				hInstance,\<br />				NULL<br />	mov dword&#91;.hwnd&#93;, eax<br />	call ShowWindow, &#91;.hwnd&#93;, &#91;.nCmdShow&#93;<br />	call UpdateWindow, &#91;.hwnd&#93;<br />.loop&#58;<br />	lea eax, &#91;.msg&#93;<br />	call GetMessage, eax, NULL, 0, 0<br />	cmp eax, 0<br />	jb .erro<br />	je .fin<br />	lea eax, &#91;.msg&#93;<br />	call TranslateMessage, eax<br />	lea eax, &#91;.msg&#93;<br />	call DispatchMessage, eax<br />	jmp .loop<br />	.erro&#58;<br />		call MessageBoxA, 0, &quot;ERROR&quot;, &quot;Saliendo&quot;, MB_OK<br />	.fin&#58;<br />		mov eax, dword&#91;.msg.wParam&#93;<br />endfunct<br /><br />funct WinProc, hWnd, uMsg, wParam, lParam<br />	mov eax, dword&#91;.uMsg&#93;<br />	cmp eax, WM_DESTROY<br />	je .WM_DESTROY<br />	;-----DEFAULT<br />		call DefWindowProc, &#91;.hWnd&#93;, &#91;.uMsg&#93;, &#91;.wParam&#93;,&#91;.lParam&#93;<br />		return<br />	.WM_DESTROY&#58;<br />		var hola, &quot;hola mundo&quot;<br />		mov eax, &#91;.wParam&#93;<br />		call PostQuitMessage, 0<br />endfunct<br /></code></pre><br /><br />and the structs look like:<br /><br />struct WNDCLASSEX<br />	cbSize resd 1<br />...<br />	cbClsExtra resd 1<br />	cbWndExtra resd 1<br />...<br />	hIconSm resd 1<br />endstruct<br /><br />or:<br /><br />struct EMRCREATEMONOBRUSH<br />	emr EMR<br />	ihBrush resd 1<br />...<br />endstruct<br /><br />NOTE: things like <br />struct WINDOWPOS<br />	hwnd resd 1<br />	hWndInsertAfter resd 1<br />	x resd 1<br />	y resd 1<br />	lx resd 1<br />	ly resd 1<br />	flags resd 1<br />endstruct<br /><br />the member lx is cx and this name can be corrected and used in the normal way of the win 32 api....<br /><br />OTher note: apparently the time of compile is decreased a little.. i think like a half with a large file like the modified win32n_.inc for compatibility with this &quot;sintaxis&quot;.<br /><br />We need wait more for see this in a Good version of nasm, i have this like a approach objetive ;) i will try for second time.. I for now... i can say only... in the flavour of movies of vogue ....<br /><br />I'll be back !!!!!<br /><br />Remember that i start this from scratch in the way that i know only what was a compiler.. in this case a assembler, now i see other posibilible ways.. and sure more rude ;).. that will require more and strong knowledge by my part.<br /><br />I think maybe in the future we can have a version of nasm that can do this in the correct way, but for now I think that i will keep this version for my.. maybe not...????, but this is for have only one version of nasm... maybe i try to belike a patch.. (diff) for the source code... and only in that way i think will be the correct form...<br /><br /><br /><br /><br /><br /><br />A sorry for the anterior post.. but i was very happy or some that was my first aproach of do this ;)<br /><br />Nice day.:alright:</div>
    <div class="meta">Posted on 2003-08-01 23:14:28 by rea</div>
   </div>
   <div class="post" id="post-150785">
    <div class="subject"><a href="#post-150785">Modified version of nasm ;)</a></div>
    <div class="body">Nifty :-)  I wonder if frank's actually included this yet</div>
    <div class="meta">Posted on 2004-10-01 20:58:51 by Al_Leitch</div>
   </div>
   <div class="post" id="post-150788">
    <div class="subject"><a href="#post-150788">Modified version of nasm ;)</a></div>
    <div class="body">No, actually that is not implemented, and should not be implemented (at less in that way), altought like I say without a real mesuring tool can be feeled naturally that the speed is at more the half of assembly time with that modification.<br /><br />The modification was &quot;reflected&quot;(rechazada) dont know how to say it, because it cant initialize correctly data, it has no suport for initialization of structures in x source code. Also it uses extensively the hash of the macros, also I have the problem that I allocate memory but never free it (bad habit). There where other things, and also I acept that in some way is more &quot;easy&quot; understand the mean of<br /><br />wnd+WNDCLASSEX.cbSize<br />it show a little more than wnd.cbSize but is normally prefered the second for the ones that come from C/++<br /><br /><br /><br />I guess will be nice try implement it, or rewrite it ;) is some that I have in mind from time a go... but you see, there are a ton of projects that I whant, let organize me more ;).<br /><br /><br /><br /><br />Have a nice day or night.</div>
    <div class="meta">Posted on 2004-10-01 22:40:47 by rea</div>
   </div>
   <div class="post" id="post-151962">
    <div class="subject"><a href="#post-151962">Modified version of nasm ;)</a></div>
    <div class="body">hi hgb,<br /><br />I agree with you. Nasm must provide some HLL structs for its users. I don't like primitive assemblers. Todays assembler must include at least the followings. <br /><br />1) As you said before, there must be a easy way to access structure members. Especially when we encounture  nested structres, syntax look horrible.<br />con+CONTEXT.xxx+SOMETING.yyy+etc<br />I prefer this<br />con.xxx.yyy<br /><br />2) There must be HLL macros inside assembler itself. If users prefer HLL macros (like .if, .elseif, .else, .endif ), assembler must give this opportinity to its users. In this way no one have to invent their own HLL macros again and again. <br /><br />3) I'm sure I'm not the only one who says such things. Developer says nasm provide very advanced macro capability. Yes they are right. Macro capability must be developed much more. But it is not the same thing: assembler has macro capability doesn't means assembler has standart HLL capability inside it. I also want to code something like below without any include file.<br /><br />?f eax=5<br />....<br />elseif eax=4||3||1<br />.....<br />else<br />...<br />endif<br /><br /><br />or<br /><br />if eax=xxx&amp;&amp;zzz<br />...<br />endif<br /><br /><br />best regards</div>
    <div class="meta">Posted on 2004-10-28 11:02:32 by highenergy</div>
   </div>
  </div>
 </body>
</html>