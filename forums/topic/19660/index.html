<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Like Raw Sockets: receive all incoming packets - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19660" />
    <link rel="next" href="../?id=19660&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=19660">Like Raw Sockets: receive all incoming packets</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=19660&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=19660&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="19660" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=19660&amp;page=2">&gt;</a><a href="../?id=19660&amp;page=2">&raquo;</a></form>   <div class="post" id="post-151258">
    <div class="subject"><a href="#post-151258">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">This little tool opens a raw socket and receives all incoming network packets.<br />Have fun with it..... and report bugs, please..   8) <br />Dominik</div>
    <div class="meta">Posted on 2004-10-13 19:21:19 by Dom</div>
   </div>
   <div class="post" id="post-151275">
    <div class="subject"><a href="#post-151275">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">nice. a reizeable window would be great. and a sniffer for outgoing data. and a port filter. thats all ;)</div>
    <div class="meta">Posted on 2004-10-14 10:06:00 by diablo2oo2</div>
   </div>
   <div class="post" id="post-151277">
    <div class="subject"><a href="#post-151277">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">tought about that resizing....but was too lazy :).<br />Port Filter is no problem, but as I know there is no way to read outgoing packets using the raw-socket-implementation.<br /><br />Dominik</div>
    <div class="meta">Posted on 2004-10-14 10:35:23 by Dom</div>
   </div>
   <div class="post" id="post-152237">
    <div class="subject"><a href="#post-152237">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">The tool goes into promiscuous mode using WSAIoctl...<br />under Win2k it works, it even captures the outgoing packets...<br />under XP pro there is no chance. Can anyone help?</div>
    <div class="meta">Posted on 2004-11-03 02:35:47 by Dom</div>
   </div>
   <div class="post" id="post-152729">
    <div class="subject"><a href="#post-152729">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">winsock 2 (ws2_32) supports true rawsockets on xp.</div>
    <div class="meta">Posted on 2004-11-11 07:30:30 by Homer</div>
   </div>
   <div class="post" id="post-152970">
    <div class="subject"><a href="#post-152970">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">so how to make promicous mode there, homer? any idea?</div>
    <div class="meta">Posted on 2004-11-15 06:47:33 by Dom</div>
   </div>
   <div class="post" id="post-153106">
    <div class="subject"><a href="#post-153106">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">WSAIoctl with SIO_RECVALL</div>
    <div class="meta">Posted on 2004-11-16 20:09:49 by Homer</div>
   </div>
   <div class="post" id="post-153173">
    <div class="subject"><a href="#post-153173">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">I assume what you call SIO_RECVALL is already implemented, called SIO_RCVALL. But on xp promiscous mode won't work. Would you take a look at my code, Homer!? What is it that makes p.-mode running on 2k but not on xp!?<br />Dominik</div>
    <div class="meta">Posted on 2004-11-18 04:29:57 by Dom</div>
   </div>
   <div class="post" id="post-153179">
    <div class="subject"><a href="#post-153179">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">As I mentioned yesterday in another thread here, rawsock on XP works fine for SP1, and for SP2 RC1 (release candidate 1)<br />But m$ deliberately broke the outgoing side of rawsock under SP2 RC2 and higher, because according to them the ONLY use for forging packet headers is making attack tools.. go figure.<br />I am happy to report that the incoming side of rawsock works fine under RC2 and higher, it seems it's not evil to listen... <br /><br />Dom, your application has a major problem that I noticed..<br />it's to do with the way you fetch the interface ip address.<br />What if theres more than one ip, and the first ip isnt the internet one?<br />My machine has two network cards - the first ip reported is my LAN.<br />I can sniff LAN packets promiscuously on XP SP2 RC2  using your tool all day and night.<br />Please add a listbox and enumerate the ip addresses PROPERLY so I can CHOOSE which interface to bind to :)</div>
    <div class="meta">Posted on 2004-11-18 06:43:58 by Homer</div>
   </div>
   <div class="post" id="post-153234">
    <div class="subject"><a href="#post-153234">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">Hey EvilHomer, thanks for your help and xp-sp report...so as there are several things I wanted to fix you just made me working on a new version...nothing special, but some useful features (including selection of ip interface). So that's what I call pushing someone to coding :) .....thx<br />Dominik</div>
    <div class="meta">Posted on 2004-11-19 13:31:05 by Dom</div>
   </div>
   <div class="post" id="post-153282">
    <div class="subject"><a href="#post-153282">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">I don't know about you, but I get a hell of a kick out of creating something out of nothing.. for me, coding is a lot like oilpainting - you start with an idea and a fresh canvas, you start adding a dob here and a blob there and then something magical happens - things start to reveal themselves out of the chaos, then you add some more and before you know it those elements are working together to create something which is much greater than its parts... and it all starts with an idea :)</div>
    <div class="meta">Posted on 2004-11-20 22:20:46 by Homer</div>
   </div>
   <div class="post" id="post-153297">
    <div class="subject"><a href="#post-153297">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">Unfortunately this application is NOT receiving raw incoming packets from SolOS :D<br /><br />But windows connection properties is showing that the packets have been indeed received aka 100.000 of them :P<br />and still no item appears in your list ;)<br /><br />Is there anything that i am doing wrongly ?<br /><br />SolOS is receiving the packets ok. <br />Aparently Windows also.<br /><br />Are you receiving only TCp/IP like packets?</div>
    <div class="meta">Posted on 2004-11-21 05:54:23 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-153333">
    <div class="subject"><a href="#post-153333">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">You are requesting winsock v1.01:<br /><br />invoke WSAStartup, 101h, addr WinsockData   ;INIT NETWORK<br /><br />Under XP on  my machine WSADATA returns v 1.01, but still supports raw sockets and SIO_RCVALL. Perhaps this could be a problem on other Versions of Windows. Arent these only supported under Winsock 2.0? <br /><br />Winsock 2.0 would be:<br /><br />invoke WSAStartup, 2h, addr WinsockData   ;INIT NETWORK</div>
    <div class="meta">Posted on 2004-11-21 21:46:10 by The Dude of Dudes</div>
   </div>
   <div class="post" id="post-153338">
    <div class="subject"><a href="#post-153338">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">Yes , absolutely correct, and why not use 0202h as the version major, minor while we are at it? :)</div>
    <div class="meta">Posted on 2004-11-21 23:09:02 by Homer</div>
   </div>
   <div class="post" id="post-153344">
    <div class="subject"><a href="#post-153344">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">So a little off-topic:<br /><br />Using this application or another win32 application is there a way to capture <strong>all</strong> incoming raw packets? And i really mean ALL.<br /><br />I could use such an application to test my OS intercomunication with Windows...</div>
    <div class="meta">Posted on 2004-11-22 03:24:00 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-153347">
    <div class="subject"><a href="#post-153347">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">My personal experience with full rawsocket support is that it drops incoming packets at the best of times.<br />It's simply not up to the task of a full session analysing packet logger.<br />My recommendation is to go with a VxD / SYS style of capture library.<br />There's several to choose from, and you have the added advantage that your code will execute as expected on ALL Win platforms.</div>
    <div class="meta">Posted on 2004-11-22 03:56:38 by Homer</div>
   </div>
   <div class="post" id="post-153502">
    <div class="subject"><a href="#post-153502">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">So after I had no time and the forum was hacked, here is finally the new version. it is now able to sniff both incoming and outgoing packets...<br /><br />p.s. thx to evilhome for his inspirating words...<br /><br />as the forum now does not seem to handle attached files i just uploaded it on some sh*tty old tripod host: <a target="_blank" href="http://mitglied.lycos.de/darkripper/snf2.zip">http://mitglied.lycos.de/darkripper/snf2.zip</a><br /><br />Dominik</div>
    <div class="meta">Posted on 2004-11-30 12:22:06 by Dom</div>
   </div>
   <div class="post" id="post-153598">
    <div class="subject"><a href="#post-153598">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">Mr. Dom:<br />snf1.zip is a great source code , we can't access the http://mitglied.lycos.de/ ,Could you move the snf2.zip to another address that we can ?</div>
    <div class="meta">Posted on 2004-12-02 06:12:19 by dcskm4200</div>
   </div>
   <div class="post" id="post-153612">
    <div class="subject"><a href="#post-153612">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">thx for the info...i just posted it on masmforum now...and here is the link:<br />http://masmforum.com/viewtopic.php?p=31559#31559<br /><br />Dominik</div>
    <div class="meta">Posted on 2004-12-02 08:20:07 by Dom</div>
   </div>
   <div class="post" id="post-153619">
    <div class="subject"><a href="#post-153619">Like Raw Sockets: receive all incoming packets</a></div>
    <div class="body">Mr. Dom:<br />Thanks you did.<br />but we still can't access. take a consultation with Mr. Hutch--. Put snf2.zip on somewhere in http://www.movsd.com/ .</div>
    <div class="meta">Posted on 2004-12-02 09:33:11 by dcskm4200</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=19660&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=19660&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="19660" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=19660&amp;page=2">&gt;</a><a href="../?id=19660&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>