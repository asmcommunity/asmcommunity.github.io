<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Plugin for Excel - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15066" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15066">Plugin for Excel</a></p>
   <div class="post" id="post-117005">
    <div class="subject"><a href="#post-117005">Plugin for Excel</a></div>
    <div class="body">Hi Gurus,<br />I have an asm program that retrieve data from other system and it 's working fine. <br />Now I want to make it as an &quot;plug in for Excel&quot; or &quot;an Library&quot; in order VBA code can reuse it ?<br />Any advise are welcome<br />m</div>
    <div class="meta">Posted on 2003-09-04 21:20:32 by nvm</div>
   </div>
   <div class="post" id="post-117011">
    <div class="subject"><a href="#post-117011">Plugin for Excel</a></div>
    <div class="body">If you're into COM, you can make a COM Object for the asm program.  <br /><br />If you don't want that level of complexity you can make a DLL and make function calls from VBA.  I don't have an example here at home, I'll look for one and post it later.  Several things to watch out for when doing this:  You must use stdcall calling convention, understand the way VBA passes parameters, and the DLL will have to reside either in the same directory as the Excel file or somewhere on the standard LoadLibrary search paths.</div>
    <div class="meta">Posted on 2003-09-04 22:10:00 by Mecurius</div>
   </div>
   <div class="post" id="post-117034">
    <div class="subject"><a href="#post-117034">Plugin for Excel</a></div>
    <div class="body">VBA does not support asm code.(am I wrong?)</div>
    <div class="meta">Posted on 2003-09-05 02:37:09 by etn</div>
   </div>
   <div class="post" id="post-117072">
    <div class="subject"><a href="#post-117072">Plugin for Excel</a></div>
    <div class="body"><div class="quote"><br />VBA does not support asm code.(am I wrong?) </div><br /><br />Neither VB nor VBA support asm code :)<br />Anyway, both VB and VBA can link to functions exported by DLLs.<br /><br />Just as Mercurius wrote:<br /><div class="quote">You must use stdcall calling convention, understand the way VBA passes parameters,<br />and the DLL will have to reside either in the same directory as the Excel file or somewhere on<br />the standard LoadLibrary search paths.</div><br /><br />To declare a function in VB(A):<br /><br /><pre><code><br />Declare Function MessageBox Lib &quot;user32.dll&quot; Alias &quot;MessageBoxA&quot; <br />            &#40;&#91;b&#93;ByVal&#91;/b&#93; HWND As Long, ByVal Message As String, ByVal Title As String, ByVal Flags As Long&#41; As Long<br /></code></pre><br /><br /><strong>ByVal</strong> is very important, as by default VB(A) pass parameters by reference (so you would get a pointer to a value instead of the value itself). Strings are double-referenced in VB(A), so &quot;ByVal X As String&quot; will pass a pointer to null terminated string, whilst &quot;X As String&quot; would pass a pointer to a pointer to a string.</div>
    <div class="meta">Posted on 2003-09-05 07:37:24 by Morris</div>
   </div>
   <div class="post" id="post-117104">
    <div class="subject"><a href="#post-117104">Plugin for Excel</a></div>
    <div class="body">I have several examples if you'ld like (mostly passing numeric data &amp; arrays) - let us know a little more specifics of your task and I'll see if I can help.</div>
    <div class="meta">Posted on 2003-09-05 12:07:50 by TheoMcCloskey</div>
   </div>
   <div class="post" id="post-117723">
    <div class="subject"><a href="#post-117723">Plugin for Excel</a></div>
    <div class="body">Thank TheoMcCloskey I decided to make the dll file and let VBA call its export functions</div>
    <div class="meta">Posted on 2003-09-10 23:34:14 by nvm</div>
   </div>
  </div>
 </body>
</html>