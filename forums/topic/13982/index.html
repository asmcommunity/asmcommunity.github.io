<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Using DirectShow for image capture - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13982" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=13982">Using DirectShow for image capture</a></p>
   <div class="post" id="post-108073">
    <div class="subject"><a href="#post-108073">Using DirectShow for image capture</a></div>
    <div class="body">Hi,<br />since about one week I am active working on a project where I have to capture images from USB Webcams. I got 3x &quot;Logitech Quickcam Pro 4000&quot; and they are working ok with <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=11496&amp;highlight=webcams">Scronty's test programm</a>.<br /><br /><br />I say &quot;ok&quot; because VFW doesnt provide a way to manual select the video source. Sure, you can select the driver (which in this case is &quot;Microsoft WDM Image Capture (WDM)&quot;) but you get a ugly &quot;Video Source&quot; selection dialog with a combobox top select the source camera. Read what <a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dndevice/html/vfwmap.asp">Microsoft says</a> about that selection box:<br /><br /><pre><code><br />&#91;b&#93;- Programmatically open a specific WDM capture device.&#91;/b&#93;<br />There is a compatibility issue in allowing a VfW application to programmatically<br />open a specific capture device without using the video source dialog box. <br />However, because most VfW client applications allow a user to bring up the <br />video source dialog, this issue has a workaround. <br /></code></pre><br /><br />Thanks Microsoft, thats <strong>-1000</strong> points for programm automation!<br /><br />--<br /><br />Another way of to capture images is using DirectShow (formerly &quot;ActiveMovie&quot;) instead of the (old) VFW interface. I googled the last 2 days for documentation/examples covering video/image capturing using DirectShow and beside from two applications and a free OCX (which doesnt work as I would like it to do) I found nothing usefull.<br /><br />A good start would be the ability to select the cameras as capture devices. But when I look at the <a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/directx9_c/directx/htm/selectingacapturedevice.asp">example code</a> Microsoft provides about that topic, I get sick :(<br /><br />To sum it up:<br /><ul><br />[*]does anyone have information about video/image capture of webcams with DirectShow (I need video preview and capturing of a single frame)?<br />[*]Can anyone provide <strong>understandable</strong> example code?<br /><br /><br />Thanks in advance,<br />bazik</div>
    <div class="meta">Posted on 2003-06-24 02:59:40 by bazik</div>
   </div>
   <div class="post" id="post-108189">
    <div class="subject"><a href="#post-108189">Using DirectShow for image capture</a></div>
    <div class="body">Anyone got a idea? :/</div>
    <div class="meta">Posted on 2003-06-25 00:34:15 by bazik</div>
   </div>
   <div class="post" id="post-108331">
    <div class="subject"><a href="#post-108331">Using DirectShow for image capture</a></div>
    <div class="body">Video Capture with directshow is very well documented inside dxsdk.<br /><br />hint# : try first with graphedit to build your capture graph and later you can load it from your code (look for : Loading a Graphedit File programatically ).<br /><br />if you like to process captured images with your prg, insert samplegrabber filter to the graph (between capture device and rendering filter (if you dont like realtime preview, you can use null renderer as video rendering filter).<br /><br />note : i never used dshow for video capture, i dont have any example code..</div>
    <div class="meta">Posted on 2003-06-26 12:52:57 by kamilh</div>
   </div>
  </div>
 </body>
</html>