<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Need a Code Snippet for SHGetDesktopFolder - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8638" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=8638">Need a Code Snippet for SHGetDesktopFolder</a></p>
   <div class="post" id="post-63434">
    <div class="subject"><a href="#post-63434">Need a Code Snippet for SHGetDesktopFolder</a></div>
    <div class="body">I prefer not to re-invent the &quot;code&quot; wheel.  And save some time.<br /><br />I have a network environment with user profiles.  Needed the code for a loader/updating program to drop shortcuts onto a desktop.<br /><br />If not, I will grind one out and post it here.<br /><br />Enjoy your work,  P1</div>
    <div class="meta">Posted on 2002-10-25 13:11:48 by Pone</div>
   </div>
   <div class="post" id="post-65078">
    <div class="subject"><a href="#post-65078">My Solution</a></div>
    <div class="body">After experimenting with different API's settled on this one.<br /><br />Invoke SHGetSpecialFolderPath,0,ADDR szDPFname,CSIDL_DESKTOPDIRECTORY,0<br /><br />But it does not work with older W95's.  I'm working out a kludge for this.<br /><br />Even M$ is recommending a different API again.<br /><br />I would recommend to anyone posting, that even if they don't a answer from here, post the answer here.  It helps to grow the knowledge base on this board.<br /><br />Regards,  P1</div>
    <div class="meta">Posted on 2002-11-08 12:24:25 by Pone</div>
   </div>
   <div class="post" id="post-65687">
    <div class="subject"><a href="#post-65687">Final working version</a></div>
    <div class="body">Note: Will not work on W95 without IE5 or better installed.<br /><br />Thanks to natas &amp; Eviloid for their help.<br /><br />Regards, P1</div>
    <div class="meta">Posted on 2002-11-13 12:44:05 by Pone</div>
   </div>
  </div>
 </body>
</html>