<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>InternetGetConnectedState Function - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2805" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2805">InternetGetConnectedState Function</a></p>
   <div class="post" id="post-18019">
    <div class="subject"><a href="#post-18019">InternetGetConnectedState Function</a></div>
    <div class="body">I have a problem. My application wants to check wether there is an internet connection and if the system is online at the moment. The function above returns every time 1 in eax. In the buffer (one parameter has to be zero, another is a pointer to an interger buffer) i get 12h as long as im not connected. There are these possible values:<br /><br />INTERNET_CONNECTION_CONFIGURED<br />Local system has a valid connection to the Internet, but it might or might not be currently connected.<br />INTERNET_CONNECTION_LAN<br />Local system uses a local area network to connect to the Internet.<br />INTERNET_CONNECTION_MODEM<br />Local system uses a modem to connect to the Internet.<br />INTERNET_CONNECTION_MODEM_BUSY<br />No longer used.<br />INTERNET_CONNECTION_OFFLINE<br />Local system is in offline mode.<br />INTERNET_CONNECTION_PROXY<br />Local system uses a proxy server to connect to the Internet.<br />INTERNET_RAS_INSTALLED<br />Local system has RAS installed.<br /><br />My problem is, i dont find these eqates in the wininet.h (the function is exported by wininet.dll) . Can anybody give me those equates?<br /><br />Thanx</div>
    <div class="meta">Posted on 2002-01-07 10:30:39 by belial</div>
   </div>
   <div class="post" id="post-18022">
    <div class="subject"><a href="#post-18022">InternetGetConnectedState Function</a></div>
    <div class="body">INTERNET_CONNECTION_MODEM      equ 1<br />INTERNET_CONNECTION_LAN        equ 2<br />INTERNET_CONNECTION_PROXY      equ 4<br />INTERNET_RAS_INSTALLED         equ 10h<br />INTERNET_CONNECTION_OFFLINE    equ 20h<br />INTERNET_CONNECTION_CONFIGURED equ 40h</div>
    <div class="meta">Posted on 2002-01-07 10:37:35 by japheth</div>
   </div>
   <div class="post" id="post-18062">
    <div class="subject"><a href="#post-18062">Re: InternetGetConnectedState Function</a></div>
    <div class="body"><div class="quote"><em>My application wants to check wether there is an internet connection and if the system is online at the moment.</em></div><br />Just be aware that this function will not show if you are actually currently connected to the internet. To check that, you will have to ping or try to GET an index page from one or two major sites. When you do so, make sure in your headers that you specify to get the page from the website, so that you don't get the copy that is possibly stored in the cache. Also, when you try to test the connection, be aware of possible firewall and proxy problems.</div>
    <div class="meta">Posted on 2002-01-07 15:28:23 by sluggy</div>
   </div>
   <div class="post" id="post-18063">
    <div class="subject"><a href="#post-18063">InternetGetConnectedState Function</a></div>
    <div class="body">Well it does show if you are actually currently connected to the internet if you are using a dial-up. Otherwise you will most probably have to go Sluggy's route. A good resource for APIs, equates, etc, its made for VB but easily translatable, is <a target="_blank" href="www.allapi.net.">www.allapi.net.</a></div>
    <div class="meta">Posted on 2002-01-07 15:36:24 by peterverstappen</div>
   </div>
   <div class="post" id="post-18066">
    <div class="subject"><a href="#post-18066">InternetGetConnectedState Function</a></div>
    <div class="body"><div class="quote"><em>its made for VB but easily translatable, is <a target="_blank" href="www.allapi.net.">www.allapi.net.</a> </em></div><br />Also, that site and some of the ones it links to also have excellent code covering this exact problem, like peter. said it is easily translated.</div>
    <div class="meta">Posted on 2002-01-07 15:56:39 by sluggy</div>
   </div>
   <div class="post" id="post-18153">
    <div class="subject"><a href="#post-18153">InternetGetConnectedState Function</a></div>
    <div class="body">Maybe you sould use RasEnumConnections and RasGetConnectStatus. If u want that your program receives control when a connection is created or closed (when u start dialoging) u should use an event object that is used with RasConnectionNotification.<br /><br />bye<br /><br />Coder7345/Jean</div>
    <div class="meta">Posted on 2002-01-08 10:17:15 by coder</div>
   </div>
  </div>
 </body>
</html>