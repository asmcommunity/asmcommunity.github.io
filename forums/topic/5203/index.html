<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>combobox in toolbar sizing question - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5203" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5203">combobox in toolbar sizing question</a></p>
   <div class="post" id="post-36734">
    <div class="subject"><a href="#post-36734">combobox in toolbar sizing question</a></div>
    <div class="body">im able to put a combobox on a toolbar. the problem is my toolbar wont always have the same amount of buttons on it. so i need to get the total amount of buttons on the toolbar, multiply that amount by 16 (because thats the width of each of my buttons) and add 5 (just to make a little space between my comboxbox and the buttons) to that amount. this total will give me the location of where i need my combobox to start at on the toolbar. here is the code i was working with but it isnt working.<br /><pre><code>invoke SendMessage,hToolBar,TB_BUTTONCOUNT,0,0  ;get button count<br />shl eax, 8                                      ;multiply count by 16 to get length of buttons<br />add eax, 5                                      ;add 5 to the length to make a little space<br />mov len, eax                                    ;mov the total into a variable to preserve<br /><br /><br />      invoke CreateWindowEx, 0,<br />                             ADDR ComboBoxClass,<br />                             0,<br />                             WS_CHILD + WS_VISIBLE,<br />                             addr len,0,200,1,<br />                             hToolBar,<br />                             0,<br />                             hInstance,<br />                             0<br />      mov hComboBox,eax</code></pre></div>
    <div class="meta">Posted on 2002-05-05 20:42:29 by smurf</div>
   </div>
   <div class="post" id="post-36737">
    <div class="subject"><a href="#post-36737">combobox in toolbar sizing question</a></div>
    <div class="body">To multiply by 16 use shl eax, 4</div>
    <div class="meta">Posted on 2002-05-05 21:21:45 by Kudos</div>
   </div>
   <div class="post" id="post-36738">
    <div class="subject"><a href="#post-36738">combobox in toolbar sizing question</a></div>
    <div class="body">Also, you should not need the <strong>addr</strong> len. Just use len.</div>
    <div class="meta">Posted on 2002-05-05 21:32:01 by anon</div>
   </div>
  </div>
 </body>
</html>