<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>&quot;Enhanced&quot; menus (menu bitmaps and stuff) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2539" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2539">&quot;Enhanced&quot; menus (menu bitmaps and stuff)</a></p>
   <div class="post" id="post-16031">
    <div class="subject"><a href="#post-16031">&quot;Enhanced&quot; menus (menu bitmaps and stuff)</a></div>
    <div class="body">Hello everyone,<br />First of all, I want to wish you all a merry christmas and a happy new year.<br />I am trying to make a menu like ICQ's (I attached an image).<br />I wanna create a &quot;left-side-bar&quot; like the one in ICQ's menu in the image and I wanna add bitmaps to the menu.<br />I tryed to use the function SeMenuItemBitmaps but I read that this function is used for the check marks and indeed the bitmaps looked ungly, I noticed that the limit was a 12x12 bitmap and I wanna use 16x16 bitmaps.<br />How do I do this?<br />I think I have to use owner-draw menus, right?<br />Can anyone help me?<br />Is there any example that uses this?<br /><br />Thanks in advance.<br />Happy holidays.</div>
    <div class="meta">Posted on 2001-12-24 22:33:05 by dilau</div>
   </div>
   <div class="post" id="post-16033">
    <div class="subject"><a href="#post-16033">&quot;Enhanced&quot; menus (menu bitmaps and stuff)</a></div>
    <div class="body">Sorry guys, I forgot the image.<br />I also forgot to say that I wanna do this lines that seen like groupboxes.</div>
    <div class="meta">Posted on 2001-12-24 22:44:51 by dilau</div>
   </div>
   <div class="post" id="post-16068">
    <div class="subject"><a href="#post-16068">&quot;Enhanced&quot; menus (menu bitmaps and stuff)</a></div>
    <div class="body"><div class="quote"><br />I wanna create a &quot;left-side-bar&quot; like the one in ICQ's menu in the image and I wanna add bitmaps to the menu. <br />I tryed to use the function SeMenuItemBitmaps but I read that this function is used for the check marks and indeed the bitmaps looked ungly, I noticed that the limit was a 12x12 bitmap and I wanna use 16x16 bitmaps. <br /></div><br /><br />I don't know for sure but I believe you can also use 16x16 bitmaps. However, when you move over them, they are inverted (like checkboxes, they turn white when you select them). There's an example of this in the masm32 v7 package (rclkmenu, ex8).<br /><br /><div class="quote"><br />How do I do this? <br />I think I have to use owner-draw menus, right? <br /></div><br /><br />Yes, I'm using it in a trayicon menu, I got some source code from vom-bonjour which I used. <br />However remember that you also have to draw the text on it and that can be very hard because you need to draw the text differently for grayed items, disabled items, enabled items, selected items, and so on..<br />Luckily I didn't need this.. <br /><br />For the bar on the left, it's actually a seperate menu page. The first item is a normal menu item (which is the bar), the next item has the MFT_MENUBARBREAK style. This will cause that menu to start on a new menu page (on the right).<br /><br />There's a very detailed document &amp; example on the subject at msdn (<a target="_blank" href="http://www.microsoft.com/msj/defaultframe.asp?page=/msj/0198/coolmenu.htm&amp;nav=/msj/0198/newnav.htm">http://www.microsoft.com/msj/defaultframe.asp?page=/msj/0198/coolmenu.htm&amp;nav=/msj/0198/newnav.htm</a>). It's all c++ though.<br /><br />I'll post some source code of my own project here today, but I can't give you a full example because I have to rip it out of the project. <br /><br />Thomas</div>
    <div class="meta">Posted on 2001-12-25 05:07:50 by Thomas</div>
   </div>
   <div class="post" id="post-16113">
    <div class="subject"><a href="#post-16113">&quot;Enhanced&quot; menus (menu bitmaps and stuff)</a></div>
    <div class="body">The attachment is one file of my HTTP file transfer project, I can't give you a fully working example, but it may be useful to you.<br />The file contains several functions to create a system tray icon and a menu that pops up when you right-click it.<br /><br />In addition to the source, two messages in the window procedures are handled like this:<br /><pre><code><br />.ELSEIF eax==WM_MEASUREITEM<br />    mov     eax, wParam<br />    .IF     eax==0<br />        invoke  TrayProcessMeasureItem, hWnd, lParam<br />        xor     eax, eax<br />        inc     eax<br />    .ELSE<br />        xor     eax, eax<br />    .ENDIF<br />.ELSEIF eax==WM_DRAWITEM<br />    mov     eax, wParam<br />    .IF     eax==0<br />        invoke  TrayProcessDrawItem, lParam<br />        xor     eax, eax<br />        inc     eax<br />    .ELSE<br />        xor     eax, eax<br />    .ENDIF<br /></code></pre><br /><br />Thomas</div>
    <div class="meta">Posted on 2001-12-25 14:04:38 by Thomas</div>
   </div>
   <div class="post" id="post-16114">
    <div class="subject"><a href="#post-16114">&quot;Enhanced&quot; menus (menu bitmaps and stuff)</a></div>
    <div class="body">This is how it looks:</div>
    <div class="meta">Posted on 2001-12-25 14:05:24 by Thomas</div>
   </div>
   <div class="post" id="post-16143">
    <div class="subject"><a href="#post-16143">Thanks!! :)</a></div>
    <div class="body">Thank you very much, Thomas! :)<br />That will be very helpful to me!<br />Merry christmas!</div>
    <div class="meta">Posted on 2001-12-25 19:18:35 by dilau</div>
   </div>
  </div>
 </body>
</html>