<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>sendmessage EM_SETCHARFORMAT never work - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27096" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27096">sendmessage EM_SETCHARFORMAT never work</a></p>
   <div class="post" id="post-194577">
    <div class="subject"><a href="#post-194577">sendmessage EM_SETCHARFORMAT never work</a></div>
    <div class="body">hi,
this never work :

LOCAL cfm : CHARFORMAT
mov     cfm.cbSize, sizeof cfm
invoke  SendMessageA, hRichEdit, EM_SETCHARFORMAT, 4, addr cfm ; SCF_ALL equ 4h 

i've recompiled iczelion tut 33 in order to see if it was my code or my system that wrong : and it's my system because changing text color is impossible!

i've tested riched20.dll version 2 and 3 (5.0.140.1 and more recent), i've tested riched32.dll...
but always return FALSE after SendMessage.
i've win2k ... latest windows.inc...

any idea? please could you say me what version of riched20.dll you use.

another question : the original exe of tut33 work fine but if i recompile it, it don't work anymore... sniff :'(

-- apology for my bad english :) --</div>
    <div class="meta">Posted on 2001-03-04 06:34:00 by gael</div>
   </div>
  </div>
 </body>
</html>