<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>TSR? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27553" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27553">TSR?</a></p>
   <div class="post" id="post-196889">
    <div class="subject"><a href="#post-196889">TSR?</a></div>
    <div class="body">I have made an .exe that estabilishes a IPC connection with a game (Microsoft CFS2), and reads some variables and writes some others. The problem is that I want my prog to stay resident, and do its routine every x seconds, instead of terminationg after it completes the routine. It should also leave control to the game in the meantime (when it's not performing its routine). How can I achieve this? 

Thanks all, Kefren</div>
    <div class="meta">Posted on 2001-04-06 05:10:00 by kefren</div>
   </div>
   <div class="post" id="post-196890">
    <div class="subject"><a href="#post-196890">TSR?</a></div>
    <div class="body">You don't want your program to exit? Don't invoke ExitProcess :P
Not so much a TSR, more an SR!

If you want it to do some thing every X seconds, a Timer is what you will be after.

Mirno</div>
    <div class="meta">Posted on 2001-04-06 06:17:00 by Mirno</div>
   </div>
   <div class="post" id="post-196891">
    <div class="subject"><a href="#post-196891">TSR?</a></div>
    <div class="body">Wow! Said this way it seems to be easy! But...how do I make a timer?

Thanks, Andrea</div>
    <div class="meta">Posted on 2001-04-06 06:39:00 by kefren</div>
   </div>
   <div class="post" id="post-196892">
    <div class="subject"><a href="#post-196892">TSR?</a></div>
    <div class="body">Look in your API reference at SetTimer
From the API:
<div class="quote">The SetTimer function creates a timer with the specified time-out value. </div>

When your done, remember to KillTimer!

Mirno</div>
    <div class="meta">Posted on 2001-04-06 07:09:00 by Mirno</div>
   </div>
   <div class="post" id="post-196893">
    <div class="subject"><a href="#post-196893">TSR?</a></div>
    <div class="body">Hi

you can also use a modifyed message loop using PeekMessage instead of GetMessage and if there is no message from windows to process....do your thing :) this is the way games loop work usualy...much faster then a timer also :)

to get even more complicated you can use a separated thread and adjust its speed with a Sleep() API call at the end of the loop</div>
    <div class="meta">Posted on 2001-04-06 07:38:00 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-196894">
    <div class="subject"><a href="#post-196894">TSR?</a></div>
    <div class="body">Hi,

for a simple program with a timer and no window you can take a look at SaFc0n's Start-button-animator. You can find it on his site:
Click me :)

Maybe this helps.

Stefan

P.S. Make sure to comment out\remove the line 

<pre><code>
invoke DeleteObject,oldbmp          ;|> and delete that bitmap
</code></pre>

because otherwise you will loose your original bitmap of your start-button until rebooting.</div>
    <div class="meta">Posted on 2001-04-09 18:38:00 by Stefan Krause</div>
   </div>
   <div class="post" id="post-196895">
    <div class="subject"><a href="#post-196895">TSR?</a></div>
    <div class="body">This al is great! I will dig into all these suggestions! Thanx all!

Now another bit of a problem: If I make a program with no window, can I put an icon on the system tray, near the clock?

'Bye, Kefren</div>
    <div class="meta">Posted on 2001-04-11 11:39:00 by kefren</div>
   </div>
   <div class="post" id="post-196896">
    <div class="subject"><a href="#post-196896">TSR?</a></div>
    <div class="body">Look at Icz's tut 23 - "TrayIcon"...
It was rather lucky Icz named it that, as it puts an item in the system tray! :P

Mirno</div>
    <div class="meta">Posted on 2001-04-11 13:25:00 by Mirno</div>
   </div>
   <div class="post" id="post-196897">
    <div class="subject"><a href="#post-196897">TSR?</a></div>
    <div class="body">Oh My! How could I be so silly not to see it?!?!?

Thanx, and I'm sorry for bothering!!!</div>
    <div class="meta">Posted on 2001-04-12 05:55:00 by kefren</div>
   </div>
  </div>
 </body>
</html>