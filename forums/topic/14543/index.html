<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How do trust your firewall ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14543" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=14543">How do trust your firewall ?</a></p>
   <div class="post" id="post-112442">
    <div class="subject"><a href="#post-112442">How do trust your firewall ?</a></div>
    <div class="body">Firewall tester,<br />Ought to be win32 compatible.<br /><br />Regards</div>
    <div class="meta">Posted on 2003-07-30 12:26:28 by Axial</div>
   </div>
   <div class="post" id="post-112451">
    <div class="subject"><a href="#post-112451">How do trust your firewall ?</a></div>
    <div class="body">Me: <br />App: Check your MailBox!<br /> (You may have mail)<br /><br />Me: <br />Me: Mail, where?<br />Me: <br /><br />Me: <br />Me: Mail, where?<br />Me: <br /><br /><br />Me: <br />Me: Mail, where?<br />Me: <br /><br />Me: Wonders, how does this app work? (It's not working for me, how does the mail I missed look like?)<br /><br />Seriously, nothing happens, no mail, no firewall even... :(</div>
    <div class="meta">Posted on 2003-07-30 13:52:15 by scientica</div>
   </div>
   <div class="post" id="post-112453">
    <div class="subject"><a href="#post-112453">How do trust your firewall ?</a></div>
    <div class="body">Well, it is possible it does not work with your system. Rare enough though. It requires you to have an already existing email client installed (outlook, the batch whatever...).<br />The mail is a small test mail, nothing else... Ideally you shouldn't see it as you have good firewall (thats the purpose of the app;) )</div>
    <div class="meta">Posted on 2003-07-30 14:04:24 by Axial</div>
   </div>
   <div class="post" id="post-112461">
    <div class="subject"><a href="#post-112461">How do trust your firewall ?</a></div>
    <div class="body"><div class="quote"><br />Well, it is possible it does not work with your system. Rare enough though. It requires you to have an already existing email client installed (outlook, the batch whatever...).<br />The mail is a small test mail, nothing else... Ideally you shouldn't see it as you have good firewall (thats the purpose of the app;) ) </div><br />Then your app must be incompatible with my system (and the way I deal with mails, don't use M$ Outlook/Inlook/opendoor/whatever-they-call-it (I wonder if there's anything left of it, most of it &quot;disapeared&quot; after I played hide-and-seek (serarch-and-destroy really :)) with it))<br /><br />I use Pegasus Mail. Do you utilize the email client to actually send the email, so that it's the email client that sends the apps email. (thus the app wouldn't be using anything the firewall triggers on)</div>
    <div class="meta">Posted on 2003-07-30 16:20:15 by scientica</div>
   </div>
   <div class="post" id="post-112465">
    <div class="subject"><a href="#post-112465">How do trust your firewall ?</a></div>
    <div class="body">Exactly how does this test work? Is it just about sending mails through Outlook? If that's so, it's only natural if firewalls don't complain... unless they are still configured in &quot;learning mode&quot;. BTW, what do the &quot;stealth&quot; modes represent?</div>
    <div class="meta">Posted on 2003-07-30 17:24:56 by QvasiModo</div>
   </div>
   <div class="post" id="post-112511">
    <div class="subject"><a href="#post-112511">How do trust your firewall ?</a></div>
    <div class="body">I've just corrected a bug but still, for a reason I don't know, the app refuses to connect when it's placed into &quot;some&quot; directories :confused: (it may be a buffer overflow somewhere, i'll check it later)<br /><br />Well simply put it into c:\ it would work.<br /><br />QvasiModo: I'm not using MAPI but winsock, and YES the trick is based on the assumption the default mail client has the right to send mail !<br />I use code injection, sorta hijacking ...<br /><br />None : no stealth. Trying to directly send the mail.<br />Advanced : Hijacking of default mail client (DMC (in order to gain the rights )<br />Elite : Multiple Hijacking, inject code into explorer.exe which, in turn,  inject's code into DMC . (This makes the firewall think an user clicked on the DMC because explorer.exe launched it)</div>
    <div class="meta">Posted on 2003-07-31 04:03:20 by Axial</div>
   </div>
   <div class="post" id="post-112513">
    <div class="subject"><a href="#post-112513">How do trust your firewall ?</a></div>
    <div class="body">Scientica: I run my own code in the context of the default mail client. It should work with ALL client, including pegasus. Hopefully i'll get that bug :(</div>
    <div class="meta">Posted on 2003-07-31 04:06:58 by Axial</div>
   </div>
   <div class="post" id="post-112516">
    <div class="subject"><a href="#post-112516">How do trust your firewall ?</a></div>
    <div class="body">This has been addressed in the past with the FW vendors, but there's really absolutley nothing you can do to prevent it.. Desing flaw of win32...</div>
    <div class="meta">Posted on 2003-07-31 04:33:18 by FearHQ</div>
   </div>
   <div class="post" id="post-112520">
    <div class="subject"><a href="#post-112520">How do trust your firewall ?</a></div>
    <div class="body">This is not exaclty true. There are several way in win32 to obtain the parent process ID, even without writing a driver. ZoneAlarm Pro does it (and then it caches the &quot;advanced stealth&quot; (simple hijacking method) but NOT the elite one.</div>
    <div class="meta">Posted on 2003-07-31 04:48:55 by Axial</div>
   </div>
   <div class="post" id="post-112522">
    <div class="subject"><a href="#post-112522">How do trust your firewall ?</a></div>
    <div class="body">Donkey : what do you mean by default block ? Did your firewall send you a warning ? if so, it is straightforward you didn't get any mail. Have you tried the other modes ?</div>
    <div class="meta">Posted on 2003-07-31 04:55:38 by Axial</div>
   </div>
   <div class="post" id="post-112523">
    <div class="subject"><a href="#post-112523">How do trust your firewall ?</a></div>
    <div class="body">BTW if you just downloaded a firewall and didn't configure the rights of your mail client then all 3 modes will be blocked (as they need the rights of the MC...)</div>
    <div class="meta">Posted on 2003-07-31 05:04:25 by Axial</div>
   </div>
   <div class="post" id="post-112526">
    <div class="subject"><a href="#post-112526">How do trust your firewall ?</a></div>
    <div class="body">I think it failed to get the DMC in HKEY_CLASSES_ROOT\mailto\shell\open\command.<br />The parser I wrote is pretty chaotic:rolleyes:</div>
    <div class="meta">Posted on 2003-07-31 05:22:03 by Axial</div>
   </div>
   <div class="post" id="post-112527">
    <div class="subject"><a href="#post-112527">How do trust your firewall ?</a></div>
    <div class="body">Will the app work behind a proxy server or some &quot;port (re)mapping service&quot;? (thus the mail ports are non-standard)<br />When you use the DMC, do you use it's port settings too or do you assume port 110 (for POP3) and 25 (SMTP)?</div>
    <div class="meta">Posted on 2003-07-31 05:27:16 by scientica</div>
   </div>
   <div class="post" id="post-112529">
    <div class="subject"><a href="#post-112529">How do trust your firewall ?</a></div>
    <div class="body">No proxy and no pop3, I just use smtp.<br />I found out that the programm wont work when the path is, for instance,<br />&quot;C:\\INTERNET\\PMAIL\\WINPM-32.EXE -A -T %1&quot;<br />instead of<br />&quot;C:\INTERNET\PMAIL\WINPM-32.EXE -A -T %1&quot;</div>
    <div class="meta">Posted on 2003-07-31 05:33:58 by Axial</div>
   </div>
   <div class="post" id="post-112532">
    <div class="subject"><a href="#post-112532">How do trust your firewall ?</a></div>
    <div class="body">Why did you compress the executable with Petite? Anything to hide? :rolleyes: <br /><br />Unpackable with &quot;r!sc's petite enlarger v1.3&quot; btw :)</div>
    <div class="meta">Posted on 2003-07-31 06:05:42 by bazik</div>
   </div>
   <div class="post" id="post-112550">
    <div class="subject"><a href="#post-112550">How do trust your firewall ?</a></div>
    <div class="body"><div class="quote"><br />QvasiModo: I'm not using MAPI but winsock, and YES the trick is based on the assumption the default mail client has the right to send mail !<br />I use code injection, sorta hijacking ...<br /><br />None : no stealth. Trying to directly send the mail.<br />Advanced : Hijacking of default mail client (DMC (in order to gain the rights )<br />Elite : Multiple Hijacking, inject code into explorer.exe which, in turn,  inject's code into DMC . (This makes the firewall think an user clicked on the DMC because explorer.exe launched it) </div><br />Gotcha. So the firewall tester tries to fool the firewall, by masquerading as an application with permission to send mails.<br />I have a couple of suggestions:<br />1) How about reading the config of the most popular firewall apps? They usually store everything in the registry, and don't worry too much to hide the app names (usually they encrypt the permissions data, and sometimes not even that, they just put some hash to verify that the data was not tampered). That way you can know what applications are allowed to get past the firewall.<br />2) How about encrypting it with Yoda's crypter (or a similar, less known utility)?<br />3) How about posting the source code? :grin:</div>
    <div class="meta">Posted on 2003-07-31 09:55:31 by QvasiModo</div>
   </div>
   <div class="post" id="post-112551">
    <div class="subject"><a href="#post-112551">How do trust your firewall ?</a></div>
    <div class="body"><div class="quote"><br />Why did you compress the executable with Petite? Anything to hide? :rolleyes: </div><br />Yes, it's compressed with PEtite 2.1. Or at least that's what PEId reports.</div>
    <div class="meta">Posted on 2003-07-31 09:58:22 by QvasiModo</div>
   </div>
   <div class="post" id="post-112568">
    <div class="subject"><a href="#post-112568">How do trust your firewall ?</a></div>
    <div class="body">Nothing to hide, but I wrote a couple of procs that could easily be re-used in virii or trojans. (and these are not buggy :grin: ) Anyway you're right ! Im not responsible for what &quot;lamer&quot; may or may not do with this code.<br />So here is the source :<br /><br />(now the funniest part goes on : you guys can help me on debuggin  :grin: )</div>
    <div class="meta">Posted on 2003-07-31 12:15:15 by Axial</div>
   </div>
   <div class="post" id="post-112572">
    <div class="subject"><a href="#post-112572">How do trust your firewall ?</a></div>
    <div class="body"><div class="quote"><br /><br />Gotcha. So the firewall tester tries to fool the firewall, by masquerading as an application with permission to send mails.<br />I have a couple of suggestions:<br /><br />1) How about reading the config of the most popular firewall apps? They usually store everything in the registry, and don't worry too much to hide the app names (usually they encrypt the permissions data, and sometimes not even that, they just put some hash to verify that the data was not tampered). That way you can know what applications are allowed to get past the firewall.<br /></div><br /><br />It would be a fastidious task and finally useless because of the numerous firewalls of the market. I wanted something that works everywhere.</div>
    <div class="meta">Posted on 2003-07-31 12:44:21 by Axial</div>
   </div>
   <div class="post" id="post-112686">
    <div class="subject"><a href="#post-112686">How do trust your firewall ?</a></div>
    <div class="body"><div class="quote"><br />It would be a fastidious task...</div><br />Agreed. :)<br /><div class="quote"><strong>...and finally useless because of the numerous firewalls of the market. I wanted something that works everywhere. </div><br />Not quite... if your program doesn't find any known firewall installed, it should behave as it does right now. And if you do find one, you can exploit any vulnerabilities particular to that software. It would be an extra feature.</div>
    <div class="meta">Posted on 2003-08-01 12:40:29 by QvasiModo</div>
   </div>
  </div>
 </body>
</html>