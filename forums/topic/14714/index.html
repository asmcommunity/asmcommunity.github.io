<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>For Newbies: Text.asm Iczelion's example FASMW version - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14714" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=14714">For Newbies: Text.asm Iczelion's example FASMW version</a></p>
   <div class="post" id="post-114018">
    <div class="subject"><a href="#post-114018">For Newbies: Text.asm Iczelion's example FASMW version</a></div>
    <div class="body"><pre><code><br /><br />; Text.asm Iczelion's example FASMW version<br /><br />format PE GUI 4.0<br />entry start<br /><br /><br />include '%include%\win32a.inc'<br /><br />;--------------------------------------------<br />macro RGB red, green, blue<br />&#123;<br />        xor eax, eax<br />        mov ah, blue<br />        shl eax, 8<br />        mov ah, green<br />        mov al, red<br />&#125;<br /><br />;---------------------------------------------<br />section '.data' data readable writeable<br /><br />  _title db 'Our First Window',0<br />  _class db 'SimpleWinClass',0<br />  _OurText  db 'Win32 assembly is great and easy!',0<br />  mainhwnd dd ?<br />  hinstance dd ?<br />  msg MSG<br />  wc WNDCLASS<br />  _hdc dd 0<br />  _ps PAINTSTRUCT<br />  _FontName db 'script',0<br />  _hfont dd 0<br />;---------------------------------------------<br />section '.code' code readable executable<br /><br />  start&#58;<br /><br />        invoke  GetModuleHandle,0<br />        mov     &#91;hinstance&#93;,eax<br />        invoke  LoadIcon,0,IDI_APPLICATION<br />        mov     &#91;wc.hIcon&#93;,eax<br />        invoke  LoadCursor,0,IDC_ARROW<br />        mov     &#91;wc.hCursor&#93;,eax<br />        mov     &#91;wc.style&#93;,0<br />        mov     &#91;wc.lpfnWndProc&#93;,WindowProc<br />        mov     &#91;wc.cbClsExtra&#93;,0<br />        mov     &#91;wc.cbWndExtra&#93;,0<br />        mov     eax,&#91;hinstance&#93;<br />        mov     &#91;wc.hInstance&#93;,eax<br />        mov     &#91;wc.hbrBackground&#93;,COLOR_WINDOW+1<br />        mov     &#91;wc.lpszMenuName&#93;,0<br />        mov     &#91;wc.lpszClassName&#93;,_class<br />        invoke  RegisterClass,wc<br /><br />        invoke  CreateWindowEx,0,_class,_title, WS_OVERLAPPEDWINDOW,\<br />                               CW_USEDEFAULT, CW_USEDEFAULT , CW_USEDEFAULT, CW_USEDEFAULT,\<br />                               NULL, NULL, &#91;hinstance&#93;, NULL<br />        mov     &#91;mainhwnd&#93;,eax<br />        invoke  ShowWindow, &#91;mainhwnd&#93;, SW_SHOWNORMAL<br />        invoke  UpdateWindow, &#91;mainhwnd&#93;<br /><br />  msg_loop&#58;<br />        invoke  GetMessage,msg,NULL,0,0<br />        or      eax,eax<br />        jz      end_loop<br />        invoke  TranslateMessage,msg<br />        invoke  DispatchMessage,msg<br />        jmp     msg_loop<br /><br />  end_loop&#58;<br />        invoke  ExitProcess,&#91;msg.wParam&#93;<br />;---------------------------------------------<br />proc WindowProc, hwnd,wmsg,wparam,lparam<br />        enter<br />        push    ebx esi edi<br />        cmp     &#91;wmsg&#93;,WM_DESTROY<br />        je      wmdestroy<br />        cmp     &#91;wmsg&#93;,WM_PAINT<br />        je      wmpaint<br />  defwndproc&#58;<br />        invoke  DefWindowProc,&#91;hwnd&#93;,&#91;wmsg&#93;,&#91;wparam&#93;,&#91;lparam&#93;<br />        jmp     finish<br />  wmpaint&#58;<br />        invoke  BeginPaint, &#91;hwnd&#93;, _ps<br />        mov     &#91;_hdc&#93;, eax<br />        invoke  CreateFont, 24, 16, 0, 0, 400, 0, 0, 0,\<br />                           OEM_CHARSET, OUT_DEFAULT_PRECIS, CLIP_DEFAULT_PRECIS,\<br />                           DEFAULT_QUALITY, DEFAULT_PITCH+FF_SCRIPT, _FontName<br />        invoke  SelectObject, &#91;_hdc&#93;, eax<br />        mov     &#91;_hfont&#93;, eax<br />        RGB 200,200,50<br />        invoke  SetTextColor, &#91;_hdc&#93;, eax<br />        RGB 0,0,255<br />        invoke  SetBkColor, &#91;_hdc&#93;, eax<br />        invoke  TextOut, &#91;_hdc&#93;, 0 ,0, _OurText, 33<br />        invoke  SelectObject, _hdc, _hfont<br />        invoke  EndPaint, &#91;hwnd&#93;, _ps<br />        jmp     finish<br />  wmdestroy&#58;<br />        invoke  PostQuitMessage,0<br />        xor     eax,eax<br />  finish&#58;<br />        pop     edi esi ebx<br />        return<br />;-----------------------------------------------<br />section '.idata' import data readable writeable<br /><br />  library kernel,'KERNEL32.DLL',\<br />          gdi, 'GDI32.DLL',\<br />          user,'USER32.DLL'<br /><br />  import kernel,\<br />         GetModuleHandle,'GetModuleHandleA',\<br />         ExitProcess,'ExitProcess'<br /><br />  import user,\<br />         RegisterClass,'RegisterClassA',\<br />         CreateWindowEx,'CreateWindowExA',\<br />         DefWindowProc,'DefWindowProcA',\<br />         GetMessage,'GetMessageA',\<br />         TranslateMessage,'TranslateMessage',\<br />         DispatchMessage,'DispatchMessageA',\<br />         LoadCursor,'LoadCursorA',\<br />         LoadIcon,'LoadIconA',\<br />         PostQuitMessage,'PostQuitMessage',\<br />         ShowWindow,'ShowWindow',\<br />         UpdateWindow, 'UpdateWindow',\<br />         BeginPaint, 'BeginPaint',\<br />         EndPaint, 'EndPaint'<br /><br />   import gdi,\<br />         CreateFont, 'CreateFontA',\<br />         SelectObject, 'SelectObject',\<br />         SetTextColor, 'SetTextColor',\<br />         SetBkColor, 'SetBkColor',\<br />         TextOut, 'TextOutA'<br />;=============================================<br /></code></pre><br /><br />Cheers,<br /><br />The I</div>
    <div class="meta">Posted on 2003-08-15 22:01:43 by imagineer</div>
   </div>
  </div>
 </body>
</html>