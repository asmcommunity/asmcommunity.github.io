<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Does somebody has some experience with BIFF ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=11894" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=11894">Does somebody has some experience with BIFF ?</a></p>
   <div class="post" id="post-91089">
    <div class="subject"><a href="#post-91089">Does somebody has some experience with BIFF ?</a></div>
    <div class="body">Hi !<br /><br />Does somebody has experiences with the BIFF format ?<br />It is in fact the Excel file format and it was partly documented by Microsoft some time ago...<br /><br />I would like to use an Excel spreadsheet to output some reports from my software.<br />I first thought of using macros to connect the spreadsheet to my database, but it seems to not be very secure : crashes randomly with absolutely no reason though my queries and my code are OK and all Office updates are installed. And this solution will force the software to have an official version of Excel.<br /><br />The solution I thought about would be to output an Excel file directly, in raw binary, from my program. The spreadsheet could be then read with the free Excel viewer...<br /><br />I have looked at the file format : it is a bit complex but with some time it should be OK.<br />Do somebody has ever done this work and if yes, what were the difficulties encoutered ?<br /><br />Any advices or other solutions are welcome.<br /><br />Thanks.</div>
    <div class="meta">Posted on 2003-03-28 01:46:05 by JCP</div>
   </div>
   <div class="post" id="post-91101">
    <div class="subject"><a href="#post-91101">Does somebody has some experience with BIFF ?</a></div>
    <div class="body">Why do you want to reinvent the wheel?<br /><br /><div class="quote"><br />ExcelAPI Source Code (freeware)<br />Create BIFF 2.1 compatible Excel files directly without using any DLL's (no need for JET, ADO/DAO). Handles writing text, numbers and dates, headers, footers, fonts, cell formatting, column and row heights, hidden cells, locked cells and protected spreadsheets. <br /></div><br /><br /><a target="_blank" href="http://planetsquires.com/files/excelapi_vb.zip">http://planetsquires.com/files/excelapi_vb.zip</a> (Visual Basic Demo)<br /><a target="_blank" href="http://planetsquires.com/files/excelapi_pb.zip">http://planetsquires.com/files/excelapi_pb.zip</a> (Power Basic Demo)<br /><br />Or use HTML:<br /><br /><pre><code><br />&lt;table border=&quot;1&quot;&gt;<br />&lt;tr&gt;<br />  &lt;td&gt;100&lt;/td&gt;<br />  &lt;td&gt;200&lt;/td&gt;<br />  &lt;td&gt;300&lt;/td&gt;<br />&lt;/tr&gt;<br />&lt;tr&gt;<br />  &lt;td&gt;400&lt;/td&gt;<br />  &lt;td&gt;500&lt;/td&gt;<br />  &lt;td&gt;600&lt;/td&gt;<br />&lt;/tr&gt;<br />&lt;tr&gt;<br />  &lt;td&gt;=SUM&#40;A1&#58;A2&#41;&lt;/td&gt;<br />  &lt;td&gt;=SUM&#40;B1&#58;B2&#41;&lt;/td&gt;<br />  &lt;td&gt;=SUM&#40;C1&#58;C2&#41;&lt;/td&gt;<br />&lt;/tr&gt;<br />&lt;/table&gt;<br /></code></pre><br /><br />(save as .xls and open with Excel)</div>
    <div class="meta">Posted on 2003-03-28 02:46:01 by bazik</div>
   </div>
   <div class="post" id="post-91115">
    <div class="subject"><a href="#post-91115">Does somebody has some experience with BIFF ?</a></div>
    <div class="body">use csv<br /><br />Very easy to use and excel can read the file format.<br /><br />the commas means another column and CRLF means another row.</div>
    <div class="meta">Posted on 2003-03-28 03:30:50 by roticv</div>
   </div>
   <div class="post" id="post-91118">
    <div class="subject"><a href="#post-91118">Does somebody has some experience with BIFF ?</a></div>
    <div class="body"><div class="quote"><br />use csv<br /><br />Very easy to use and excel can read the file format.<br /><br />the commas means another column and CRLF means another row. </div><br /><br />Thanks, but I can not use this : it would not be very user friendly to have a raw format... I also must write the formatting in the file and I don't think CSV is able to do that.<br /><br />Bazik : Thanks a lot for these source codes : very useful and exactly what I am looking for.<br />As my program is in C do you think the PowerBasic version could be compiled as a DLL (or even better a static library) and use it from my C program ?<br /><br />Thanks.<br /><br />PS : The html trick is also nice, but I also need to set header for printing and adjusts pages sizes, etc... but still it is very nice to be able to do that.</div>
    <div class="meta">Posted on 2003-03-28 04:00:54 by JCP</div>
   </div>
   <div class="post" id="post-91119">
    <div class="subject"><a href="#post-91119">Does somebody has some experience with BIFF ?</a></div>
    <div class="body"><div class="quote"><br />As my program is in C do you think the PowerBasic version could be compiled as a DLL (or even better a static library) and use it from my C program ?<br /> </div><br /><br />Yes, you could create a DLL. <br /><br />&lt;advertise&gt;BTW, PowerBasic is worth the money ;) &lt;/advertise&gt;</div>
    <div class="meta">Posted on 2003-03-28 04:03:59 by bazik</div>
   </div>
   <div class="post" id="post-91187">
    <div class="subject"><a href="#post-91187">Does somebody has some experience with BIFF ?</a></div>
    <div class="body">I worked on just this for a month or so.   Then i discovered that using COM automation is much better and cleaner.  I would recomend doing this.  I would be glad to help you where i can.<br /><br />However if your still bent on writing your own BIFF files, i was focused on BIFF 8.  The early versions are a joke, but to handle that latter is far more complicated.  And you still need to use COM (IStream intefaces). <br /><br />The doc i have are to big to post at once... here they are. (just Biff stuff).</div>
    <div class="meta">Posted on 2003-03-28 09:15:56 by NaN</div>
   </div>
   <div class="post" id="post-91189">
    <div class="subject"><a href="#post-91189">Does somebody has some experience with BIFF ?</a></div>
    <div class="body">And part 2</div>
    <div class="meta">Posted on 2003-03-28 09:17:04 by NaN</div>
   </div>
   <div class="post" id="post-91191">
    <div class="subject"><a href="#post-91191">Does somebody has some experience with BIFF ?</a></div>
    <div class="body">And here is one of my test programs of using excel through COM automation.<br /><br />I dont have a &quot;SaveAs&quot; routine in this, but its very easy to implement.<br /><br />I suggest you seriously look down this road.  Japheth had done alot of work revising his ComView tool such that workng on projects like this is drasticly simplified.<br /><br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2003-03-28 09:20:23 by NaN</div>
   </div>
   <div class="post" id="post-91225">
    <div class="subject"><a href="#post-91225">Does somebody has some experience with BIFF ?</a></div>
    <div class="body">Very interesting stuff !<br /><br />Thanks a lot, NaN ! :alright:<br />I never used COM but your examples are clean and well written : I think I will understand what is going on relatively easily.<br /><br />Does it works on older Excel versions (ie 5 ?)<br /><br />bazik : if it is not much work at all, please would you mind to compile this DLL for me ? ;)<br />I have heard good things about Power Basic, maybe I will buy it one day but C allows me to do nearly everything I want...<br />If it is longer than simply run a command-line, do not mind about it, I will port the code by myself.<br /><br />All solutions seems interesting and I don't know which one I will use yet, so I would like to try them all...<br /><br />By the way, your html tip gave me an idea : Excel saves also to html format but with their own tags that allows to do many more things, to control nearly everything : ie. set the header section, the print scale etc...he bad side is that html is not appropriated to write complex spreadsheets and that creating multi-tabbed spreadsheets requires to write one file for each tab...</div>
    <div class="meta">Posted on 2003-03-28 10:57:40 by JCP</div>
   </div>
   <div class="post" id="post-91231">
    <div class="subject"><a href="#post-91231">Does somebody has some experience with BIFF ?</a></div>
    <div class="body"><div class="quote"><br />bazik : if it is not much work at all, please would you mind to compile this DLL for me ? ;) </div><br /><br />I'll post it here later today.</div>
    <div class="meta">Posted on 2003-03-28 11:39:40 by bazik</div>
   </div>
   <div class="post" id="post-91375">
    <div class="subject"><a href="#post-91375">Does somebody has some experience with BIFF ?</a></div>
    <div class="body">Excel 5 must be pretty old.. i cant say.<br /><br />I have Excel 97, which itself supports BIFF8.   If your only interseted in these early versions (assuming its cause this is the software you have) you may want to write your own output directly as you first queried on.  Its very simple, and i gave you infor on how to do this in one of the above files..<br /><br />To my knowledge, Excel introduced automation at Excel 97...<br /><br />Hope it helps..<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2003-03-29 02:00:34 by NaN</div>
   </div>
  </div>
 </body>
</html>