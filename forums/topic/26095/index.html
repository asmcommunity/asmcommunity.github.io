<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>XML Writer-Parser Source Code - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26095" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26095">XML Writer-Parser Source Code</a></p>
   <div class="post" id="post-190104">
    <div class="subject"><a href="#post-190104">XML Writer-Parser Source Code</a></div>
    <div class="body">Hi,<br />This is my wraper code over the DOM API component of Windows, in asm32 language. include sample code and necessary inc file. because XML inc/lib or code is not available in masm32 compiler&#39;s librarys or in this forum, so this post may be usefull to anyone.<br />enjoy it.<br />veri@&nbsp; &nbsp;</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=2400" target="_blank">IoEXML.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2007-08-09 09:17:27 by veri@</div>
   </div>
   <div class="post" id="post-190111">
    <div class="subject"><a href="#post-190111">Re: XML Writer-Parser Source Code</a></div>
    <div class="body">Wow. Thank you for sharing.<br />BTW you should preserve ebx in ParseXML ;).<br /><br />greetings<br />GM</div>
    <div class="meta">Posted on 2007-08-10 03:55:06 by Gismo</div>
   </div>
   <div class="post" id="post-202616">
    <div class="subject"><a href="#post-202616">Re: XML Writer-Parser Source Code</a></div>
    <div class="body">Gismo, <br />thanks, you are right. I forget it.<br />Any suggestion to optimize this code, for example in memory management or speed optimization, can be usefull. <br />regards<br />Veri@</div>
    <div class="meta">Posted on 2007-08-12 14:16:57 by veri@</div>
   </div>
   <div class="post" id="post-203106">
    <div class="subject"><a href="#post-203106">Re: XML Writer-Parser Source Code</a></div>
    <div class="body">Hi, veri@<br /><br />I found a memory leak in your code.<br />When your app closes, it tries to free memory:<br /><pre><code>invoke	GlobalFree,lpwXMLBuff</code></pre><br />but in your case, lpwXMLBuff is <strong>Local</strong> variable!<br />so, declare it as global variable.<br /><br />does <strong>lpXMLBuff</strong> is freed anywhere in your code?<br /><br />when you call LoadXMLFile, you do not free lpXMLBuff buffer in case if all was OK.<br />and in case of fail of LoadXMLFile, <strong>bstr</strong> is not freed too.<br /><br />Attached updated source code.<br /><br /><pre><code><br />--------------------------------------<br />v1.1	Oct	1, 2007<br />--------------------------------------<br />	[-] Memory leak fixed<br />	[+] VersionInfo resource added<br />	[+] Manifest<br />	[+] Icon<br />	[*] Little code redesign<br />	[+] WinAsm Studio Project<br />	[!] by Jupiter<br /></code></pre></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=2426" target="_blank">LoadXML.v1.1.rar</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2007-09-30 14:03:48 by Jupiter</div>
   </div>
   <div class="post" id="post-203121">
    <div class="subject"><a href="#post-203121">Re: XML Writer-Parser Source Code</a></div>
    <div class="body">Hi<br />Thank you Jupiter.<br />I am so happy for your post and your attached update. I hope this code can be extend in the future more and more. I will review your code later.<br />Thanks again.</div>
    <div class="meta">Posted on 2007-10-02 04:43:18 by veri@</div>
   </div>
  </div>
 </body>
</html>