<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Help on writting a console app for serial coms - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24688" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24688">Help on writting a console app for serial coms</a></p>
   <div class="post" id="post-180380">
    <div class="subject"><a href="#post-180380">Help on writting a console app for serial coms</a></div>
    <div class="body">Hi all,<br /><br />I am new to this forum, so please excuse me if my question is off topic or has been discussed previously.<br /><br />I have developed many applications for windows using Visual studio.&nbsp; Now I need to develop a console (no Windows) application for communicating two pcs via serial port usign pure assembler.&nbsp; The application must have some graphical interface for showing serial data in a tabular form.<br /><br />Can some one point me in the right direction.&nbsp; Where can I find asm code examples for serial communications and display handling. Can I develop this application using MASM? Or what is the recomended compiler for this?<br /><br />Tanks a lot for your kinldy help!<br /><br />John</div>
    <div class="meta">Posted on 2006-05-04 14:33:33 by John Vargas</div>
   </div>
   <div class="post" id="post-180621">
    <div class="subject"><a href="#post-180621">Re: Help on writting a console app for serial coms</a></div>
    <div class="body">Lo,<br /><br />i am currently still working on some other project. but eventualy i also want to do something whit my serial ports, i am thinking about building something outside the PC, which is controlled through my serial port.<br /><br />i would look for the following: The Art of Assembly (PDF-book)<br />Chapter 22, it covers the Serial port <br /><br />you should also get Ralf Brown&#39;s interupt and port lists. it covers a lot of stuf.<br /><br /><br />but you got 1 problem, since i dont know if windows will allow you to write directly to the Serial ports, so you will probely need to boot whit some old Dos diskette, then u can also use simple Dos int&#39;s (functions) to display stuff on the screen.<br /><br />it can be written in any asm, so also masm (i am coding an OS in masm, so u should be able to program the serial port whit it :P ). but u will need to be able to write some Dos-Exe file, if u are booting whit Dos.<br /><br /><br />If u got anything which works, please post it here, cause i also need to use the serial port in the future, as explained above<br /><br /><br />Regards.<br />PyroMathic</div>
    <div class="meta">Posted on 2006-05-12 04:13:48 by pyr0_mathic</div>
   </div>
   <div class="post" id="post-180622">
    <div class="subject"><a href="#post-180622">Re: Help on writting a console app for serial coms</a></div>
    <div class="body">Use CreateFile to open access to the serial port (set the file name to the port name, e.g. &quot;COM1&quot;).<br />Next, setup the internal buffer sizes, using SetupComm.<br />Now you might want to set some options (like baud rate), so use GetCommState/SetCommState.<br />The last setup thing to do is to set the timeouts, use GetCommTimeouts/SetCommTimeouts for that.<br /><br />After this, you can use ReadFile and WriteFile for communications (using blocking or non-blocking calls, whatever you like - just like using a file... I would use overlapped IO, even though it is more complex... it means the thread can be doing somethign else at the same time... tho maybe for a console app, this wont be needed)<br /><br />Finally, just use CloseHandle to close the connection<br /><br />Ossa<br /><br /> PyroMathic - you&#39;re right, you can&#39;t use interrupts under windows... you MUST use the API </div>
    <div class="meta">Posted on 2006-05-12 04:34:21 by Ossa</div>
   </div>
   <div class="post" id="post-180632">
    <div class="subject"><a href="#post-180632">Re: Help on writting a console app for serial coms</a></div>
    <div class="body">Ossa&#39;s way is probably the best way to do it for windows programming - clean and portable, and can be done the same way whether you implement it in assembly or a HLL.<br /><br />By the way, is this some school project? If so, your teacher might have some special requirements.</div>
    <div class="meta">Posted on 2006-05-12 09:44:01 by f0dder</div>
   </div>
  </div>
 </body>
</html>