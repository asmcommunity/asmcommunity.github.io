<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Windows XP, after write boot sector of Drive C, my computer hang up - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20858" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20858">Windows XP, after write boot sector of Drive C, my computer hang up</a></p>
   <div class="post" id="post-158537">
    <div class="subject"><a href="#post-158537">Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">Windows XP, after write boot sector of Drive C, my computer hang up<br />Power off, and restart, system crash<br /><br />(I tried write bootsector of Win98 in bootsector of Drive C of WinXP)<br /><br />Help me<br />Thanks</div>
    <div class="meta">Posted on 2005-03-29 19:28:28 by Ctrl+Break</div>
   </div>
   <div class="post" id="post-158538">
    <div class="subject"><a href="#post-158538">Re: Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">http://kos.enix.org/pub/bootwrit.html<br /><br />Maybe there&#39;s some help here.<br /><br />Kydwyn</div>
    <div class="meta">Posted on 2005-03-29 20:05:03 by Kydwyn</div>
   </div>
   <div class="post" id="post-158540">
    <div class="subject"><a href="#post-158540">Re: Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">No, I wrote win98 boot sector to Boot sector of Driver C, and system crash<br />My compuer installed Windows XP<br /><br />Tell me solution to system not crash before restart.<br /><br />I don&#39;t write a bootsector, this is very simply</div>
    <div class="meta">Posted on 2005-03-29 20:56:09 by Ctrl+Break</div>
   </div>
   <div class="post" id="post-158541">
    <div class="subject"><a href="#post-158541">Re: Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">Ctrl+Break,<br /><br />Boot from your Windows XP CD, select &#39;To repair a Windows XP installation using the recovery console, press R&#39;, then run FIXMBR in the recovery console. Worth a try.<br /><br />Here is a good link about using the Recovery Console:<br /><br /><a target="_blank" href="http://www.wown.com/j_helmig/wxprcons.htm">http://www.wown.com/j_helmig/wxprcons.htm</a><br /> <br /></div>
    <div class="meta">Posted on 2005-03-29 21:27:27 by Greg</div>
   </div>
   <div class="post" id="post-158546">
    <div class="subject"><a href="#post-158546">Re: Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">Boot sector is ok if you can boot up the OS. It has no connection with system shutdown.<br />Perhaps you had a dual-boot ? So after writing Win98 bootsector with fdisk /mbr you cant boot winXP?<br />Or while trying to install winXp you get a crash?</div>
    <div class="meta">Posted on 2005-03-30 02:09:01 by Azrim</div>
   </div>
   <div class="post" id="post-158547">
    <div class="subject"><a href="#post-158547">Re: Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">In any case you can upgrade WinXp to WinXp with no problems if you think that something is corrupted.<br />Before that you could try START&gt;Run sfc /scannow (you will need winXp CD)<br /><br />best regards</div>
    <div class="meta">Posted on 2005-03-30 02:12:27 by Azrim</div>
   </div>
   <div class="post" id="post-158550">
    <div class="subject"><a href="#post-158550">Re: Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">Nonono, My Question: <br />after write boot sector of Windows 98 into bootsector of Drive C, system no crash before reboot, <br />how to do ?<br /></div>
    <div class="meta">Posted on 2005-03-30 02:48:48 by Ctrl+Break</div>
   </div>
   <div class="post" id="post-158554">
    <div class="subject"><a href="#post-158554">Re: Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">Afternoon, Ctrl+Break.<br /><br /><div class="quote"><br />Nonono, My Question: <br />after write boot sector of Windows 98 into bootsector of Drive C, system no crash before reboot, <br />how to do ?</div><br /><br />Why are you wishing to do this?<br />Are you attempting to avoid security (password) protection on a computer?<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2005-03-30 05:01:32 by Scronty</div>
   </div>
   <div class="post" id="post-158555">
    <div class="subject"><a href="#post-158555">Re: Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">I writing an IO program. but i couldn&#39;t wrote a kmd.<br />My Solution: When run: my program will write boot sector of drive c by boot sector of win98 and restart&nbsp; <br />After finish, program restore boot sector of drive C and restart<br />I have administrator privilege. However, i couldn&#39;t do it<br /><br />code:<pre><code>.386<br />.model flat, stdcall<br />option casemap:none<br /><br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; I N C L U D E&nbsp;  F I L E S&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />include C:\masm32\include\windows.inc<br /><br />include c:\masm32\include\kernel32.inc<br />include c:\masm32\include\user32.inc<br />include c:\masm32\include\gdi32.inc<br /><br />includelib c:\masm32\lib\kernel32.lib<br />includelib c:\masm32\lib\user32.lib<br />includelib c:\masm32\lib\gdi32.lib<br /><br />include c:\masm32\Macros\Strings.mac<br /><br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; E Q U A T E S&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br /><br />MBR_SIZE			equ 512<br /><br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; U N I N I T I A L I Z E D&nbsp; D A T A&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />.data?<br /><br />MBR					BYTE MBR_SIZE dup(?)<br /><br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  C O D E&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />.code<br /><br /><br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  start&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />start proc uses esi ebx<br /><br />local hDevice:HANDLE<br />local dwNumberOfBytesRead:DWORD<br />local hFile: HANDLE<br />	invoke CreateFile, $CTA0(&quot;\\\\.\\C:&quot;), GENERIC_WRITE+GENERIC_READ, \<br />						FILE_SHARE_READ + FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, NULL<br />	.if eax != INVALID_HANDLE_VALUE<br /><br />		mov hDevice, eax<br /><br />		invoke 	CreateFile, $CTA0(&quot;boot.bin&quot;), GENERIC_READ, FILE_SHARE_READ, NULL, OPEN_EXISTING, NULL,NULL<br />		mov	hFile, eax<br />		<br />		invoke ReadFile, hFile, addr MBR, MBR_SIZE, addr dwNumberOfBytesRead, NULL<br />		invoke WriteFile, hDevice, addr MBR, MBR_SIZE, addr dwNumberOfBytesRead, NULL<br /><br />		invoke&nbsp;  CloseHandle, hFile<br />		invoke CloseHandle, hDevice&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />	.else<br />		invoke MessageBox, NULL, $CTA0(&quot;Couldn&#39;t open PhysicalDrive0 device&quot;), NULL, MB_ICONEXCLAMATION<br />	.endif<br /><br />	invoke ExitProcess, 0<br /><br />start endp<br /><br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />end start<br /></code></pre></div>
    <div class="meta">Posted on 2005-03-30 06:26:28 by Ctrl+Break</div>
   </div>
   <div class="post" id="post-158566">
    <div class="subject"><a href="#post-158566">Re: Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">When using using Read/WriteFile on disk or partitions, your buffers (and reads) must be 512-byte aligned. Allocate the &quot;MBR&quot; buffer with VirtualAlloc. Also, where does the error happen? You don&#39;t have nearly enough error checks.<br /><br />And then of course there&#39;s the obvious thing - wtf are you doing this? Overwriting the MBR is a dangerous thing to do. Especially if you don&#39;t want your partition table smashed.<br /></div>
    <div class="meta">Posted on 2005-03-30 08:46:02 by f0dder</div>
   </div>
   <div class="post" id="post-158593">
    <div class="subject"><a href="#post-158593">Re: Windows XP, after write boot sector of Drive C, my computer hang up</a></div>
    <div class="body">I don&#39;t overwrite MBR, i overwrite Boot Sector.</div>
    <div class="meta">Posted on 2005-03-30 19:12:27 by Ctrl+Break</div>
   </div>
  </div>
 </body>
</html>