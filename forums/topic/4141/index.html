<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>RE-NAMING A File - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4141" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4141">RE-NAMING A File</a></p>
   <div class="post" id="post-28290">
    <div class="subject"><a href="#post-28290">RE-NAMING A File</a></div>
    <div class="body">Do anyone know how to RENAME a file with SHFILEOPSTRUCT.  I can copy and delete with it but can't figure out how to RENAME a file with it.<br /><br />Also is the a way to COPY, DELETE OR RENAME a file at an lower level in ASM without the help of SHFILEOPSTRUCT.<br /><br />I already searched previous Posts and did not find anything about it at all. I looked under SHELL and RENAME.<br /><br />Thanks in advance....</div>
    <div class="meta">Posted on 2002-03-11 06:16:06 by cmax</div>
   </div>
   <div class="post" id="post-28293">
    <div class="subject"><a href="#post-28293">RE-NAMING A File</a></div>
    <div class="body">These APIs will help you :<br /><br />CopyFile<br />DeleteFile<br />MoveFile (use it for renaming too).</div>
    <div class="meta">Posted on 2002-03-11 06:24:28 by JCP</div>
   </div>
   <div class="post" id="post-28294">
    <div class="subject"><a href="#post-28294">Re: RE-NAMING A File</a></div>
    <div class="body">&gt;Also is the a way to COPY, DELETE OR RENAME a file at an lower <br />&gt;level in ASM without the help of SHFILEOPSTRUCT.<br /><br />Yes, with the use of CopyFile, DeleteFile or MoveFile (move it to rename it :) ). I'm sure, there's no way, to use SHFILE* to rename a file, because there's no special Windows dialog for that. So using MoveFile would be the best way.<br /><br />&gt;I already searched previous Posts and did not find anything <br />&gt;about it at all. I looked under SHELL and RENAME.<br /><br />Search for &quot;MoveFile&quot; and my name. It should bring up one or two Sources where I use this API for renaming a file.<br /><br />regards,<br />bAZiK<br /><br /><br />P.S.: Was this fast? :rolleyes:<br /><br /><br /><em><strong>Edit:</strong><br />Arrrghh... Readiosys was faster... :o </em></div>
    <div class="meta">Posted on 2002-03-11 06:25:47 by bazik</div>
   </div>
   <div class="post" id="post-28296">
    <div class="subject"><a href="#post-28296">RE-NAMING A File</a></div>
    <div class="body">Thanks Guys<br /><br />That was very fast and i really needed to know so i can get back to work on it.<br /><br />bAZiK i been using your codes for strings and it took me very far to understanding ASM a heck of a lot better.  It was from the Posts last 1 or 2 months ago back when Strings was the hottest topic.  I read everything Readiosys say.<br /><br />Thanks again</div>
    <div class="meta">Posted on 2002-03-11 06:55:22 by cmax</div>
   </div>
   <div class="post" id="post-28297">
    <div class="subject"><a href="#post-28297">RE-NAMING A File</a></div>
    <div class="body">Renaming a file is just an encapsulation for moving the file to the same directory under the new name... and moving is an encapsulation for copying and deleting. You probably will not find a rename function in Linux unless you have a special shell for it... all you really have to do is move the file to the same directory with an additional parameter for the new name as Bazik mentioned.</div>
    <div class="meta">Posted on 2002-03-11 06:55:26 by SpooK</div>
   </div>
   <div class="post" id="post-28302">
    <div class="subject"><a href="#post-28302">RE-NAMING A File</a></div>
    <div class="body">bAZiK, i looked under &quot;MoveFile&quot; and only found three post then i looked under move but there is 100's of posts.<br /><br />I just go and read the api and come back and search latter if needed.<br /><br />The best thing about this board is that someone always seem to throw in extra information to keep you from getting tripped up down the line.  <br /><br />Thanks spook, i do want to have everything close as possible for Linux also and your operating system too when ready.</div>
    <div class="meta">Posted on 2002-03-11 07:16:55 by cmax</div>
   </div>
   <div class="post" id="post-28304">
    <div class="subject"><a href="#post-28304">RE-NAMING A File</a></div>
    <div class="body">Hmm...ok... I had in mind, that I posted some source, wich uses MoveFile to rename a file... <br />But I'm sure, you won't have any problems to do it yourself, because the API's are very simple to use! Good luck! :alright:</div>
    <div class="meta">Posted on 2002-03-11 07:27:41 by bazik</div>
   </div>
   <div class="post" id="post-28306">
    <div class="subject"><a href="#post-28306">RE-NAMING A File</a></div>
    <div class="body">while downloading some mp3`s with different extensions i code a small file renamer !<br />enjoy my bad coding :)<br /><br />ps:   call   MoveFileA,offset OLD,offset NEW</div>
    <div class="meta">Posted on 2002-03-11 07:28:54 by syntax_error</div>
   </div>
   <div class="post" id="post-28308">
    <div class="subject"><a href="#post-28308">RE-NAMING A File</a></div>
    <div class="body">syntax_error, you use Win9x? <br />I use 2K here at work and look what I got (needs some fixing :grin: ):</div>
    <div class="meta">Posted on 2002-03-11 07:34:09 by bazik</div>
   </div>
   <div class="post" id="post-28311">
    <div class="subject"><a href="#post-28311">RE-NAMING A File</a></div>
    <div class="body"><div class="quote"><br />and moving is an encapsulation for copying and deleting<br /></div><br />Not 100% correct :). If you move/rename a file within the same<br />partition, any (sane) OS/FS combo will just update the directory<br />entries.</div>
    <div class="meta">Posted on 2002-03-11 07:42:16 by f0dder</div>
   </div>
   <div class="post" id="post-28314">
    <div class="subject"><a href="#post-28314">RE-NAMING A File</a></div>
    <div class="body">That's why the call him syntax_error <br /><br />Just kidding ;)<br /><br />Thats a super super kool program.  I wish i had 2K to work on that.</div>
    <div class="meta">Posted on 2002-03-11 07:49:29 by cmax</div>
   </div>
   <div class="post" id="post-28342">
    <div class="subject"><a href="#post-28342">RE-NAMING A File</a></div>
    <div class="body">&lt;That's why the call him syntax_error <br /><br />EXACT thats why i take this name :)<br />its like : yesterday it works today not !<br /><br />cmax i like you :)<br />while typing this i must alltime laugh :)<br />i remeber syntax error from my old c64 days and when i read your answer i see how good this nick is for me *lol*<br /><br />thanks for the tip bAZiK !<br />what a luck that i dont mail this tool to the page where i found the mp3`s :)<br />better fix it first !<br /><br />ah the sun is shining and id like to jump arround ,coding maybe later in the night :)</div>
    <div class="meta">Posted on 2002-03-11 09:21:55 by syntax_error</div>
   </div>
   <div class="post" id="post-28362">
    <div class="subject"><a href="#post-28362">RE-NAMING A File</a></div>
    <div class="body">Well I don't have tasm, but I have the same problem with masm under win2k when I don't use the &quot;uses edi edx ecx&quot; (or whatever registers you're using) statement in the starting proc line.  Man I'm not so good at the technical wording, but I hope you know what I mean.  :) <br /><br />i.e.<br />stuff PROC uses ebx ecx blah:dword, blahblah:dword<br /><br />Like I said I can't re-assemble/link your source to see if that's the problem without tasm, but it's worth a try.</div>
    <div class="meta">Posted on 2002-03-11 12:55:07 by Will</div>
   </div>
   <div class="post" id="post-28485">
    <div class="subject"><a href="#post-28485">RE-NAMING A File</a></div>
    <div class="body">I took me forever to figure out how to use SHFILEOPSTRUCT and now find out it only take two lines of code to do it ALL, any way you chosse...<br /><br />Well that's what i get for talking about Bill all the time when i get mad.<br /><br />Kool syntax_error<br />It's to much for mp3`s</div>
    <div class="meta">Posted on 2002-03-11 21:40:23 by cmax</div>
   </div>
  </div>
 </body>
</html>