<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Just curious... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2216" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2216">Just curious...</a></p>
   <div class="post" id="post-13983">
    <div class="subject"><a href="#post-13983">Just curious...</a></div>
    <div class="body">Heres an off the cuff type question... (been day-dreaming today between studying)...<br /><br />Does anyone think it *could* be possible to build a single win32 EXE program, while at the same time able to be loaded as a DLL from another program?<br /><br />IE)  I want to run fancy_calc, i double click on it and run it..<br />and some other program or IDE can load it (the exe) as a suporting tool and call upon certain exported fuctions thru a DLL type interface to get the same behavior done.. ???<br /><br />Or am i just mixing apples and oranges here?<br /><br />NaN</div>
    <div class="meta">Posted on 2001-12-04 22:58:23 by NaN</div>
   </div>
   <div class="post" id="post-13986">
    <div class="subject"><a href="#post-13986">Just curious...</a></div>
    <div class="body">Yep --- FAsm 1.14:</div>
    <div class="meta">Posted on 2001-12-05 00:40:08 by eet_1024</div>
   </div>
   <div class="post" id="post-13989">
    <div class="subject"><a href="#post-13989">Just curious...</a></div>
    <div class="body">After some testing, it appears the the dummy function is executed on load AND close (when the user app exits)</div>
    <div class="meta">Posted on 2001-12-05 00:57:32 by eet_1024</div>
   </div>
   <div class="post" id="post-14031">
    <div class="subject"><a href="#post-14031">Just curious...</a></div>
    <div class="body">I've had major trouble with something similar, NaN. On some versions<br />of windows (9x, I think), it seems like .EXE files do not get relocated<br />even if they possess relocation information, and LoadLibrary on a<br />.exe file is limited to fiddling with resources. On win2k my test worked,<br />but you shouldn't be doing this. Look what PSDK has to say:<br /><br /><div class="quote"><br />LoadLibrary can also be used to map other executable modules. For example, the function can specify an .exe file to get a handle that can be used in FindResource or LoadResource. However, do not use LoadLibrary to run an .exe file, use the CreateProcess function.<br /></div><br /><br />*** edit ***<br />You can of course think of *other* ways to get the second executable<br />doing it's work. You can set up a named pipe to communicate, for<br />instance.</div>
    <div class="meta">Posted on 2001-12-05 09:21:42 by f0dder</div>
   </div>
   <div class="post" id="post-14152">
    <div class="subject"><a href="#post-14152">Just curious...</a></div>
    <div class="body">Thanx all for your thoughts (and code snippets :)  )..<br /><br />I will play with them and see what conclusions i can come up with....<br /><br />NaN</div>
    <div class="meta">Posted on 2001-12-06 10:48:17 by NaN</div>
   </div>
  </div>
 </body>
</html>