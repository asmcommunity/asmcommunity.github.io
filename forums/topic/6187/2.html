<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>replacing invoke :: faster xcall macro - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6187" />
  <link rel="prev" href="../?id=6187&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=6187">replacing invoke :: faster xcall macro</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=6187&amp;page=1" style="">&laquo;</a><a href="../?id=6187&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="6187" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-44594">
    <div class="subject"><a href="#post-44594">replacing invoke :: faster xcall macro</a></div>
    <div class="body">The align value of 4 isn't so good. :)  It's already aligned by four.  Also, there was an error in the align macro above - I hope you got the fix. :tongue:  I'll play with it when I get home - I already have a working set-up for my code, but there is too much stuff mixed in to post.</div>
    <div class="meta">Posted on 2002-06-21 14:18:22 by bitRAKE</div>
   </div>
   <div class="post" id="post-44595">
    <div class="subject"><a href="#post-44595">replacing invoke :: faster xcall macro</a></div>
    <div class="body"><pre><code>@align MACRO val&#58;REQ, sz&#58;REQ<br />    EXITM %&#40;&#40;val*&#40;sz&#41;&#41;/sz&#41;<br />ENDM<br /></code></pre>I removed the -1 because it's causing some graphical problems(see image below). Now fixed :) Thanks for the alignment macro!!! <img src="http://www.plauder-smilies.de/biggrinflip.gif" /></div>
    <div class="meta">Posted on 2002-06-21 14:19:59 by stryker</div>
   </div>
   <div class="post" id="post-44596">
    <div class="subject"><a href="#post-44596">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Really should be:<pre><code>@align MACRO val&#58;REQ, sz&#58;REQ<br />    EXITM %&#40;&#40;val+sz-1&#41;/sz&#41;*sz&#41;<br />ENDM</code></pre>Sorry, I'm a little busy ATM - going in a million directions and all... :)</div>
    <div class="meta">Posted on 2002-06-21 14:43:50 by bitRAKE</div>
   </div>
   <div class="post" id="post-44597">
    <div class="subject"><a href="#post-44597">Final Version???</a></div>
    <div class="body">I'll post the final version to avoid confusion. :grin:<br /><br /><pre><code>&#91;size=9&#93;;by bitRAKE<br /><br />@align MACRO val&#58;REQ, sz&#58;REQ<br />    EXITM %&#40;&#40;&#40;val+sz-1&#41;/sz&#41;*sz&#41;<br />ENDM<br /><br />;by gfalen<br /><br />@str MACRO _str&#58;VARARG<br />    LOCAL @@1<br />    IF @InStr&#40;1, &lt;_str&gt;, &lt;!&quot;&gt; &#41;<br />        .DATA<br />            @@1 DB _str, 0<br />        .CODE<br />        EXITM &lt;OFFSET @@1&gt;<br />    ELSE<br />        EXITM &lt;_str&gt;<br />    ENDIF<br />ENDM<br /><br />;by stryker<br /><br />xcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    LOCAL psize, paddr, plen<br />    IFNB &lt;parameters&gt;<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            psize = psize + 4<br />        ENDM<br />        psize = @align&#40;&#40;psize+4&#41;, &#91;color=#3366FF&#93;&#91;b&#93;4&#91;/b&#93;&#91;/color&#93;&#41;  &#91;color=#3366FF&#93;&#91;b&#93;;change alignment&#91;/b&#93;&#91;/color&#93;<br />        psize = psize - 4<br />        sub esp, psize<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            IF @SizeStr&#40;&lt;param&gt; &#41; GT 4<br />                paddr SUBSTR &lt;param&gt;, 1, 5<br />                IFIDNI paddr, &lt;ADDR &gt;<br />                    paddr SUBSTR &lt;param&gt;, 6, @SizeStr&#40;&lt;param&gt;&#41; - 5<br />                    lea eax, paddr<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, eax<br />                ELSE<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt;&#41;<br />                ENDIF<br />            ELSE<br />                mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt; &#41;<br />            ENDIF<br />            psize = psize + 1<br />        ENDM<br />    ENDIF<br />    call function<br />ENDM&#91;/size&#93;</code></pre>Thanks to all those who've contributed!!! :alright:</div>
    <div class="meta">Posted on 2002-06-21 14:49:26 by stryker</div>
   </div>
   <div class="post" id="post-44599">
    <div class="subject"><a href="#post-44599">replacing invoke :: faster xcall macro</a></div>
    <div class="body"><strong>stryker</strong>, there is no such thing as a final version. ;)</div>
    <div class="meta">Posted on 2002-06-21 14:56:21 by bitRAKE</div>
   </div>
   <div class="post" id="post-44602">
    <div class="subject"><a href="#post-44602">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Yep, if I can just access the variable declarations on the data and data? sections plus the local variables, the macro could be tweaked more, plus determining the size of the variables(byte, word, qword, tbyte) would add functionality and flexibility to the macro. :)</div>
    <div class="meta">Posted on 2002-06-21 14:59:57 by stryker</div>
   </div>
   <div class="post" id="post-44700">
    <div class="subject"><a href="#post-44700">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Ok, now I've listened to the conversations (unfortunately I've been lacking any really (advanced) macro training) and I've come to one conclusion:  That I need to reread this whole thread one more time.<br /><br />What benefits does this (xcall) have over (invoke)?<br />What does &quot;@align&quot; and &quot;@str&quot; do?<br />If a tree falls in a forest does anyone really care if it makes a sound?<br /><br />I need instant gratification :)  So a line by line commenting of the whole procedure is what you have to give me :alright: <br /><br />Well, maybe you can just start with the first 2 questions and work on the rest later :)<br /><br />Sliver</div>
    <div class="meta">Posted on 2002-06-22 11:18:14 by Sliver</div>
   </div>
   <div class="post" id="post-44702">
    <div class="subject"><a href="#post-44702">replacing invoke :: faster xcall macro</a></div>
    <div class="body"><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=5991&amp;highlight=optimization">this thread</a> might help you more!!! :) I designed it to accomplished this for example:<pre><code><br />sub esp, 16<br />mov DWORD PTR &#91;esp&#93;, NULL<br />mov DWORD PTR &#91;esp+4&#93;, OFFSET MsgCaption<br />mov DWORD PTR &#91;esp+8&#93;, OFFSET MsgTitle<br />mov DWORD PTR &#91;esp+12&#93;, MB_OK<br />call MessageBox</code></pre>which is <em>&quot;faster&quot;</em> than:<pre><code><br />push MB_OK<br />push OFFSET MsgTitle<br />push OFFSET MsgTitle<br />push NULL<br />call MessageBox</code></pre> these pushes are create by invoke.<br /><br />As for @align bitRAKE might explain this much better.<br /><br />As for @str this is a macro created by gfalen so it'll be easy to create text data for example:<pre><code>xcall MessageBox, 0, &quot;MsgCaption&quot;, &quot;MsgTitle&quot;, MB_YESNO</code></pre>You don't need to go to the data section and create or edit the contents of a text data. Nice Isn't it!! :)<br /><br /><br />Just remember when you use the xcall macro it only supports DWORD sizes(Most API calls are DWORD in size)...I'll see what I can do to improve it, so it can support any size.</div>
    <div class="meta">Posted on 2002-06-22 11:30:46 by stryker</div>
   </div>
   <div class="post" id="post-44703">
    <div class="subject"><a href="#post-44703">replacing invoke :: faster xcall macro</a></div>
    <div class="body">For some processors:<pre><code>sub esp,X<br />mov &#91;esp+4*i&#93;, Ni<br />mov &#91;esp+4*&#40;i-1&#41;&#93;, N&#40;i-1&#41;<br />mov &#91;esp+4*&#40;i-2&#41;&#93;, N&#40;i-2&#41;<br />...<br />mov &#91;esp+4*0&#93;, N0</code></pre>Is faster than:<pre><code>push Ni<br />push N&#40;i-1&#41;<br />push N&#40;i-2&#41;<br />...<br />push N0</code></pre>Also, if you were to hand code it, you could do the moves in any order that fit with the calculations you were doing, helping to eliminate dependancies and making maximum use of the registers.<br /><br />@str - checks if a parameter is a constant string and creates the string if it is - returning the offset.  Otherwise it just returns the parameter.<br /><br />@align - returns the smallest interger multiple of the alignment size, that is equal or greaterthan the value passed.  @align(24,16) would return 32.  @align(8,4) would return 8 - it is already aligned.<br /><br />I like to test macros using the ECHO keyword.  Macros that return values always return text.<pre><code>% ECHO @align&#40;24,16&#41;</code></pre>Note the <strong>%</strong> forces MASM to evaluate the line, rather then just echoing it.  Cool, huh!</div>
    <div class="meta">Posted on 2002-06-22 11:35:07 by bitRAKE</div>
   </div>
   <div class="post" id="post-44804">
    <div class="subject"><a href="#post-44804">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Hi!<br />Compliments for clever macro, but i should say, that using it is not so good as it seems at first glance.<br /><br />Let's compile this code-snippet:<br />(_call is macro i use instead of invoke. It puts params on stack in a general way)<br /><br /><pre><code><br />xcall MessageBox, 0, &quot;MsgCaption&quot;, &quot;MsgTitle&quot;, MB_YESNO<br />_call MessageBox, 0, &quot;MsgCaption&quot;, &quot;MsgTitle&quot;, MB_YESNO<br /></code></pre><br /><br />and take a look at disassembly from IDA:<br /><br /><pre><code><br />&#58;00401000  ; xcall MessageBox, 0, &quot;MsgCaption&quot;, &quot;MsgTitle&quot;, MB_YESNO<br />&#58;00401000<br />&#58;00401000                                sub esp, 1Ch                                 ; hWnd<br />&#58;00401003  &#91;COLOR=red&#93;C7 04 24 00 00 00 00&#91;/COLOR&#93;          mov &#91;esp+1Ch+var_1C&#93;, 0<br />&#58;0040100A  &#91;COLOR=red&#93;C7 44 24 04 00 30 40 00&#91;/COLOR&#93;       mov &#91;esp+1Ch+var_18&#93;, offset szMsgcaption    ; &quot;MsgCaption&quot;<br />&#58;00401012  &#91;COLOR=red&#93;C7 44 24 08 0B 30 40 00&#91;/COLOR&#93;       mov &#91;esp+1Ch+var_14&#93;, offset szMsgtitle      ; &quot;MsgTitle&quot;<br />&#58;0040101A  &#91;COLOR=red&#93;C7 44 24 0C 04 00 00 00&#91;/COLOR&#93;       mov &#91;esp+1Ch+var_10&#93;, 4<br />&#58;00401022  E8 43 00 00 00                call MessageBoxA<br />&#58;00401027<br />&#58;00401027  ; _call MessageBox, 0, &quot;MsgCaption&quot;, &quot;MsgTitle&quot;, MB_YESNO<br />&#58;00401027<br />&#58;00401027  &#91;COLOR=red&#93;6A 04&#91;/COLOR&#93;                         push 4                                       ; uType<br />&#58;00401029  &#91;COLOR=red&#93;68 14 30 40 00&#91;/COLOR&#93;                push offset szMsgtitle_0                     ; lpCaption<br />&#58;0040102E  &#91;COLOR=red&#93;68 1D 30 40 00&#91;/COLOR&#93;                push offset szMsgcaption_0                   ; lpText<br />&#58;00401033  &#91;COLOR=red&#93;6A 00&#91;/COLOR&#93;                         push 0                                       ; hWnd<br />&#58;00401035  E8 30 00 00 00                call MessageBoxA<br /></code></pre><br /><br />You can see that xcall needs <strong>31</strong> bytes to pass 4 params to MessageBox.<br />But _call only <strong>14</strong> bytes.<br /><strong>31 - 14 = 17.</strong><br />17 extra bytes for calling simple MessageBox!<br />If params are in registers the difference is yet more:<br /><strong>push reg            - 1 byte<br />mov    - 8 bytes</strong><br />7 extra bytes for every reg-param.<br /><br />Is it faster or slower does not matter at all if you call system function,<br />because system function basically are bad optimized.<br />Is it important for you, how many cpu circles does it take to call some func from kernel or user - 5000 or 5005?<br />It makes sense to use xcall only if you call your own func many times.<br />But in this instance it will be better, IMHO, to pass params through registers.<br /><br /><strong>BUT BE CAREFULL!</strong> Things will get much worse if you use aligment option.<br />You get Stack Overflow or GPF error in very short order.<br /><br />Suppose 32-byte alignment and let see what will happen in this code:<br /><pre><code><br />xcall GetModuleHandle, &quot;Kernel32.dll&quot;         ; hInstance of Kernel32.dll<br />push eax                                      ; save it for future use<br />xcall GetProcAddress, eax, &quot;LoadLibraryA&quot;     ; addr of LoadLibraryA<br />pop eax                                       ; restore hInstance of Kernel32.dll<br /></code></pre><br /><br /><pre><code><br />&#58;00401004      sub     esp, 1Ch                               ; say esp = 0063FE3C<br />&#58;00401007      mov     &#91;esp+1Ch+var_1C&#93;, offset aKernel32_dll ; esp = 0063FE20<br />&#58;0040100E      call    GetModuleHandleA                       ; esp = 0063FE20<br />&#58;00401013      push    eax                                    ; esp = 0063FE24<br />&#58;00401014      sub     esp, 1Ch                               ; esp = 0063FE20<br />&#58;00401017      mov     &#91;esp+38h+var_38&#93;, eax                  ; esp = 0063FE04<br />&#58;0040101A      mov     &#91;esp+38h+var_34&#93;, offset aLoadlibrarya ; esp = 0063FE04<br />&#58;00401022      call    GetProcAddress                         ; esp = 0063FE04<br />&#58;00401027      pop     eax                                    ; esp = 0063FE0C &#91;COLOR=red&#93;&lt;-!!! it's not hInstance&#91;/COLOR&#93;<br />&#58;00401028                                                     ; esp = 0063FE10 &#91;COLOR=red&#93;&lt;-!!! should be 0063FE3C&#91;/COLOR&#93;<br /></code></pre><br /><br />GetModuleHandleA and GetProcAddress and all other know nothing about your aligment,<br />and according to stdcall conversion remove from stack 4 and 8 bytes accordingly.<br />And at address 00401027 you have garbage in eax instead of hInstance of Kernel32.dll!!!<br />In order to use xcall properly <strong>you should balance stack manually</strong> - nightmare, i think.<br /><br />The macro i use:<br /><pre><code><br />_call MACRO arglist&#58;VARARG<br /><br />local n, a, sz, q, arg<br /><br />    n TEXTEQU @ArgCount&#40; &lt;arglist&gt; &#41;<br />    % FOR arg, @ArgRev&#40; &lt;arglist&gt; &#41;<br />        n TEXTEQU %&#40;n - 1&#41;<br />        IF n EQ 0<br />            call arg<br />            IF &#40;OPATTR &#40; arg &#41;&#41; AND 10000000y<br />                ;; References an external label<br />                IF &#40;&#40;OPATTR &#40; arg &#41;&#41; AND 11100000000y&#41; EQ 00100000000y<br />                    ;; Uses C calling convention &#40;_cdecl&#41;<br />                    n TEXTEQU @ArgCount&#40; &lt;arglist&gt; &#41;<br />                    add esp, &#40;n - 1&#41; * sizeof DWORD<br />                ENDIF<br />            ENDIF<br />        ELSE<br />            IF @InStr&#40;1, &lt;arg&gt;, &lt;addr &gt;&#41; OR @InStr&#40;1, &lt;arg&gt;, &lt;ADDR &gt;&#41;<br />                a SUBSTR &lt;arg&gt;, 6<br />                IF $IsStack&#40;a&#41;        ;; Is relative to SS<br />                    lea eax, a<br />                    push eax<br />                ELSE<br />                    push offset a<br />                ENDIF<br />            ELSEIF @InStr&#40;1, @SubStr&#40;&lt;arg&gt;, 1 , 1&#41;, &lt;!&quot;&gt;&#41;<br />                push $TO&#40;,&lt;arg&gt;,&#41;<br />            ELSEIF @InStr&#40;1, @SubStr&#40;&lt;arg&gt;, 1 , 1&#41;, &lt;&amp;&gt;&#41;<br />                a SUBSTR &lt;arg&gt;, 2<br />                IF $IsStack&#40;a&#41;        ;; Is relative to SS<br />                    lea eax, a<br />                    push eax<br />                ELSE<br />                    push offset a<br />                ENDIF<br />            ELSE<br />                IF $IsImm&#40;arg&#41;<br />                    push arg<br />                ENDIF<br />            ENDIF<br />        ENDIF<br />    ENDM<br />ENDM<br /><br />$call MACRO arglist&#58;VARARG<br />    _call arglist<br />    EXITM &lt;eax&gt;<br />ENDM<br /></code></pre><br />If possible _call tries to use push offset, if not - lea eax, param/push eax.<br />To pass addresses you can use addr or ADDR but not aDDr, Addr etc... or you can use c-like &amp;.<br />What @ArgCount, $IsStack and other macros do see in attachment.<br />Hope this will be interesting for all of you.</div>
    <div class="meta">Posted on 2002-06-23 05:50:22 by Four-F</div>
   </div>
   <div class="post" id="post-44825">
    <div class="subject"><a href="#post-44825">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Great work, guys. Our apps will at least run 0,1 micro seconds faster (but possibly load 0,2 microseconds slower because of larger file size :) ).<br /><br />what Four-F said about alignment seems to be a severe bug. I think in Win32 esp should be always dword-aligned. So instead of adjusting esp it may be better to display a warning if esp is &quot;wrong&quot; (if anything at all).<br /><br />About speed: I doubt that manuelly &quot;pushing&quot; parms is faster than push if it is a call with just one parameter. So the macro should be adjusted to handle this special case.<br /><br />To Four-F: could you please explain me what is the advantage of your macro compared with the standard &quot;invoke&quot;?<br /><br />japheth</div>
    <div class="meta">Posted on 2002-06-23 11:18:58 by japheth</div>
   </div>
   <div class="post" id="post-44826">
    <div class="subject"><a href="#post-44826">replacing invoke :: faster xcall macro</a></div>
    <div class="body"><strong>Four-F</strong>, you have stated some very good points.  I think the alignment should be left out - it really requires the stack to be aligned all the time.<br /><br /><strong>japheth</strong>, there are many features that can be added to the macros to automate providing better performance, but the best optimizer is always going to be manually coding the instructions.<br /><br />Here is the fix for the stack alignment:<pre><code>__STACK_ALIGNMENT__ EQU 16<br /><br />@align MACRO val&#58;REQ, sz&#58;REQ<br />    EXITM %&#40;&#40;&#40;val+sz-1&#41;/sz&#41;*sz&#41;<br />ENDM<br /><br />;by gfalen<br /><br />@str MACRO _str&#58;VARARG<br />    LOCAL @@1<br />    IF @InStr&#40;1, &lt;_str&gt;, &lt;!&quot;&gt; &#41;<br />        .DATA<br />            @@1 DB _str, 0<br />        .CODE<br />        EXITM &lt;OFFSET @@1&gt;<br />    ELSE<br />        EXITM &lt;_str&gt;<br />    ENDIF<br />ENDM<br /><br />;by stryker<br /><br />xcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    LOCAL psize, paddr, plen, palign<br /><br />    IFNB &lt;parameters&gt;<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            psize = psize + 4<br />        ENDM<br />        palign = @align&#40;&#40;psize+4&#41;, __STACK_ALIGNMENT__&#41; - 4 - psize<br />        sub esp, psize + palign<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            IF @SizeStr&#40;&lt;param&gt; &#41; GT 4<br />                paddr SUBSTR &lt;param&gt;, 1, 5<br />                IFIDNI paddr, &lt;ADDR &gt;<br />                    paddr SUBSTR &lt;param&gt;, 6, @SizeStr&#40;&lt;param&gt; &#41; - 5<br />                    lea eax, paddr<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, eax<br />                ELSE<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt; &#41;<br />                ENDIF<br />            ELSE<br />                mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt; &#41;<br />            ENDIF<br />            psize = psize + 1<br />        ENDM<br />    ENDIF<br />    call function<br />    IF palign NE 0<br />        add esp,palign<br />    ENDIF<br />ENDM</code></pre></div>
    <div class="meta">Posted on 2002-06-23 11:50:03 by bitRAKE</div>
   </div>
   <div class="post" id="post-44864">
    <div class="subject"><a href="#post-44864">replacing invoke :: faster xcall macro</a></div>
    <div class="body">If you don't want to use alignment at all(Which was the original version), use this macro added with what japheth said about only 1 parameter. By the way, the ADDR is not limited to ADDR or addr but to any uppercase-lowercase combo .eg. aDdR ...<pre><code>;by gfalen<br /><br />@str MACRO _str&#58;VARARG<br />    LOCAL @@1<br />    IF @InStr&#40;1, &lt;_str&gt;, &lt;!&quot;&gt; &#41;<br />        .DATA<br />            @@1 DB _str, 0<br />        .CODE<br />        EXITM &lt;OFFSET @@1&gt;<br />    ELSE<br />        EXITM &lt;_str&gt;<br />    ENDIF<br />ENDM<br /><br />;by stryker<br /><br />xcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    LOCAL psize, paddr, plen<br />    IFNB &lt;parameters&gt;<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            psize = psize + 4<br />        ENDM<br />        IF psize EQ 4<br />            push parameters<br />        ELSE<br />            sub esp, psize<br />            psize = 0<br />            FOR param, &lt;parameters&gt;<br />                IF @SizeStr&#40;&lt;param&gt; &#41; GT 4<br />                    paddr SUBSTR &lt;param&gt;, 1, 5<br />                    IFIDNI paddr, &lt;ADDR &gt;<br />                        paddr SUBSTR &lt;param&gt;, 6, @SizeStr&#40;&lt;param&gt; &#41; - 5<br />                        lea eax, paddr<br />                        mov DWORD PTR &#91;esp+psize*4&#93;, eax<br />                    ELSE<br />                        mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt; &#41;<br />                    ENDIF<br />                ELSE<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt; &#41;<br />                ENDIF<br />                psize = psize + 1<br />            ENDM<br />        ENDIF<br />    ENDIF<br />    call function<br />ENDM</code></pre>Haven't tested bitRAKE's modified version yet. And remember folks, this only supports DWORD parameters. I'll test with QWORD(2 pushes) later.</div>
    <div class="meta">Posted on 2002-06-23 22:48:23 by stryker</div>
   </div>
   <div class="post" id="post-44872">
    <div class="subject"><a href="#post-44872">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Stryker,<br />What program is that a screen shot from?<br /><br />Sliver</div>
    <div class="meta">Posted on 2002-06-24 00:26:06 by Sliver</div>
   </div>
   <div class="post" id="post-44873">
    <div class="subject"><a href="#post-44873">replacing invoke :: faster xcall macro</a></div>
    <div class="body">IDA Pro :)</div>
    <div class="meta">Posted on 2002-06-24 00:50:55 by stryker</div>
   </div>
   <div class="post" id="post-44878">
    <div class="subject"><a href="#post-44878">replacing invoke :: faster xcall macro</a></div>
    <div class="body"><div class="quote"><br />what Four-F said about alignment seems to be a severe bug. I think in Win32 esp should be always dword-aligned. So instead of adjusting esp it may be better to display a warning if esp is &quot;wrong&quot; (if anything at all). <br /></div><br /><br />Right. I meant alignment other then DWORD.<br /><br /><div class="quote"><br />To Four-F: could you please explain me what is the advantage of your macro compared with the standard &quot;invoke&quot;? <br /></div><br /><br />None ;-) Except for:<br /><pre><code><br />mov var, $call&#40;SomeFunc1,,,,,$call&#40;SomeFunc2,,,&#41;&#41;<br /></code></pre><br />and<br /><pre><code><br />_call SomeFuncWithTextParam,,,,&quot;SomeText&quot;,,<br /></code></pre><br /><br />But main disadvantage is no param type/number checking.<br /><br /><div class="quote"><br />If you don't want to use alignment at all(Which was the original version), use this macro added with what japheth said about only 1 parameter. By the way, the ADDR is not limited to ADDR or addr but to any uppercase-lowercase combo .eg. aDdR ...<br /></div><br /><br />If 0,0001% of speed increasing is more important than 1% larger size use it.<br />Sorry, but personally i can't see any advantage of using it.</div>
    <div class="meta">Posted on 2002-06-24 02:26:24 by Four-F</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=6187&amp;page=1" style="">&laquo;</a><a href="../?id=6187&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="6187" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>