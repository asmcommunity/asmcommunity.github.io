<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>replacing invoke :: faster xcall macro - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6187" />
    <link rel="next" href="../?id=6187&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=6187">replacing invoke :: faster xcall macro</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=6187&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=6187&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="6187" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=6187&amp;page=2">&gt;</a><a href="../?id=6187&amp;page=2">&raquo;</a></form>   <div class="post" id="post-44432">
    <div class="subject"><a href="#post-44432">replacing invoke :: faster xcall macro</a></div>
    <div class="body">I was reading an <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=5991&amp;highlight=optimization">old post</a>. So I created a macro to <em>&quot;partially replace&quot;</em> invoke.<pre><code>xcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    LOCAL psize, paddr, plen<br />    IFNB &lt;parameters&gt;<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            psize = psize + 4<br />        ENDM<br />        sub esp, psize<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            IF @SizeStr&#40;&lt;param&gt;&#41; GT 4<br />                paddr SUBSTR &lt;param&gt;, 1, 5<br />                IFIDNI paddr, &lt;ADDR &gt;<br />                    paddr SUBSTR &lt;param&gt;, 6, @SizeStr&#40;&lt;param&gt;&#41; - 5<br />                    lea eax, paddr<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, eax<br />                ELSE<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, param<br />                ENDIF<br />            ELSE<br />                mov DWORD PTR &#91;esp+psize*4&#93;, param<br />            ENDIF<br />            psize = psize + 1<br />        ENDM<br />    ENDIF<br />    call function<br />ENDM</code></pre><strong>How To Use It:</strong> xcall functionName, parameter1, parameter2, ...<br /><br /><strong>Cons:</strong><ul>[*]Limitation #1 : Cannot Handle Direct Memory<br />Solution #1 : Place the value from memory into a register<br />[*]Limitation #2 : Cannot handle BYTE, WORD, QWORD, TBYTE size parameters.<br />Solution #2 : None. If I know how to access the protoype of a function or the procedure structure, then this problem will be solved.<strong>Pros:</strong><ul>[*]Supports use of the ADDR macro<br />[*]<em>&quot;Faster&quot;</em> compared to the normal <strong>push</strong>ing of parameters used by invoke<br /><strong>Sidenote : </strong><ul>[*]Please limit the use of the ADDR to <strong>local</strong> variables, <strong>use OFFSET if you can</strong>. Why? It will execute the lea instruction, which is used to get the address of a variable, so if you use ADDR even if the variable is declared in the data section, you'll be adding 1 instruction more to your program. If I can access the variable declarations on the data, code section plus the locals, this issue will be solved.<br />[*]When using ADDR be sure to use another register instead of EAX because ADDR macro uses EAX as a placeholder of the memory address. So if you have a function call like this:<pre><code>mov eax, hWnd<br />xcall myfunction, ADDR mystring, eax</code></pre>This will break your app. Though this only happens when using ADDR then the post-parameter/s uses the EAX register, aside from this, there should be no problem/s(except the ones mentioned above on the cons list).<br /><br />Have Fun!!! :grin:</div>
    <div class="meta">Posted on 2002-06-21 00:12:08 by stryker</div>
   </div>
   <div class="post" id="post-44441">
    <div class="subject"><a href="#post-44441">replacing invoke :: faster xcall macro</a></div>
    <div class="body">/me is waiting until bitRAKE sees this thread and comes with a 5 lines shorter and 10 times faster version...<br /><br /><br /><br /><br /><br />:grin:</div>
    <div class="meta">Posted on 2002-06-21 01:10:27 by bazik</div>
   </div>
   <div class="post" id="post-44442">
    <div class="subject"><a href="#post-44442">replacing invoke :: faster xcall macro</a></div>
    <div class="body">I can remove some error checkings if you want to and no ADDR support...I maximized the features to my extent. :grin: stripped-down version(no ADDR support)<pre><code>xcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    LOCAL psize<br />    IFNB &lt;parameters&gt;<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            psize = psize + 4<br />        ENDM<br />        sub esp, psize<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            mov DWORD PTR &#91;esp+psize*4&#93;, param<br />            psize = psize + 1<br />        ENDM<br />    ENDIF<br />    call function<br />ENDM</code></pre>Is this what your looking for? :grin:</div>
    <div class="meta">Posted on 2002-06-21 01:16:39 by stryker</div>
   </div>
   <div class="post" id="post-44446">
    <div class="subject"><a href="#post-44446">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Nice!<br /><br />What about that:<br /><br /><pre><code><br />xcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    LOCAL psize<br />    IFNB &lt;parameters&gt;<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            sub esp, 4<br />            mov DWORD PTR &#91;esp+psize*4&#93;, param<br />            psize = psize + 1<br />        ENDM<br />    ENDIF<br />    call function<br />ENDM<br /></code></pre><br /><br /><br />Would this work? :)</div>
    <div class="meta">Posted on 2002-06-21 01:40:47 by bazik</div>
   </div>
   <div class="post" id="post-44447">
    <div class="subject"><a href="#post-44447">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Just tested it... nice, it works :) Damn, I am good! :stupid:</div>
    <div class="meta">Posted on 2002-06-21 01:42:47 by bazik</div>
   </div>
   <div class="post" id="post-44449">
    <div class="subject"><a href="#post-44449">replacing invoke :: faster xcall macro</a></div>
    <div class="body">really, hmm why did my app crashed? :confused: If it did worked, I believe there would be a lot of sub esp, 4 for each parameter -&gt; bloat.<pre><code>&#91;size=9&#93;.386<br />.model flat, stdcall<br />option casemap&#58;none<br />include \masm32\include\windows.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\user32.inc<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br /><br />xcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    LOCAL psize<br />    IFNB &lt;parameters&gt;<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            sub esp, 4<br />            mov DWORD PTR &#91;esp+psize*4&#93;, param<br />            psize = psize + 1<br />        ENDM<br />    ENDIF<br />    call function<br />ENDM<br /><br /><br />.code<br />start&#58;<br />	xcall MessageBox, 0, 0, 0, 0<br />	invoke ExitProcess,NULL<br />end start&#91;/size&#93;</code></pre>Dunno why mine crashed??? and yours not???<br /><br /><br />I know, you probably used only 1 parameter. :)<pre><code><br />push 0<br />push 0<br />push 0<br />xcall MessageBox, 0</code></pre></div>
    <div class="meta">Posted on 2002-06-21 01:45:41 by stryker</div>
   </div>
   <div class="post" id="post-44450">
    <div class="subject"><a href="#post-44450">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Maybe because I didn't save the source before clicking &quot;compile&quot; :)<br /><br />Ok, it crashes too. Can you explain why? In fact it does the same as your app, with the difference that it subtracts for each param and not all at ones?!</div>
    <div class="meta">Posted on 2002-06-21 02:00:13 by bazik</div>
   </div>
   <div class="post" id="post-44451">
    <div class="subject"><a href="#post-44451">replacing invoke :: faster xcall macro</a></div>
    <div class="body">I just modified your macro to make it work<pre><code>xcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    IFNB &lt;parameters&gt;<br />        FOR param, &lt;parameters&gt;<br />            sub esp, 4<br />            mov DWORD PTR &#91;esp&#93;, param<br />        ENDM<br />    ENDIF<br />    call function<br />ENDM</code></pre>but the problem is the redundant sub esp, 4 which will add bloat to your app.<br /><br />As for why the above macro didn't work is because of garbage<pre><code>Param 4 - garbage, current esp, TOS<br />Param 3 - garbage<br />Param 2 - garbage<br />Param 1 - only the lower part was constantly changed<br />          during the execution of the MOV instruction</code></pre>Also if we are going to use the macro I just modified we need to reverse the parameters, Param1 should be on the TOS. I'll search for ParReverse macro tomorrow, it seems to me I've lost it in my MACRO collections. Anyway, as far as I can remember ParReverse will be slower because it has to parse the parameters in reverse order.<br /><br />BTW, this one really has a lot of weird outputs(Param 2 &amp; 3 are interchanged - I've seen a pattern), I'll study it tomorrow. Don't use these macros folks except for the original one on the first thread. These are still on the testing phase.<br /><br />I'm sleepy!!! :o I think I need some shut eye :alright:</div>
    <div class="meta">Posted on 2002-06-21 02:16:57 by stryker</div>
   </div>
   <div class="post" id="post-44494">
    <div class="subject"><a href="#post-44494">replacing invoke :: faster xcall macro</a></div>
    <div class="body">The following from my Masm.inc file allows immediate strings in the call ie:<br /><br />invok MessageBox, &quot;My Caption&quot;, &quot;Mytext&quot;, 0, 0, 0<br /><br /><pre><code>@str macro _str&#58;vararg<br />local @@1<br />    if @InStr&#40;1, &lt;_str&gt;, &lt;!&quot;&gt;&#41;<br />        .data<br />            @@1 db _str<br />        .code<br />        exitm &lt;offset @@1&gt;<br />    else<br />        exitm &lt;_str&gt;<br />    endif<br />endm<br /><br />invok macro _func&#58;req, _args&#58;vararg<br />    ifb &lt;_args&gt;<br />        invoke _func<br />    else<br />        $invok equ &lt;&gt;<br />        irp $v, &lt;_args&gt;<br />            $invok catstr $invok, &lt;,&gt;, @str&#40;&lt;$v&gt;&#41;<br />        endm<br />        invoke _func $invok<br />    endif<br />endm<br /><br /></code></pre></div>
    <div class="meta">Posted on 2002-06-21 05:27:45 by gfalen</div>
   </div>
   <div class="post" id="post-44496">
    <div class="subject"><a href="#post-44496">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Wow! I'm really impressed with your macro skills! Good job gfalen :alright: <br /><br /><strong>edit:</strong> Oops..it looks like the strings aren't zero terminated. Solved it by changing &quot;@@1 db _str&quot; to &quot;@@1 db _str<strong>,0h</strong>&quot;<br /><br />/Delight</div>
    <div class="meta">Posted on 2002-06-21 05:33:30 by Delight</div>
   </div>
   <div class="post" id="post-44499">
    <div class="subject"><a href="#post-44499">replacing invoke :: faster xcall macro</a></div>
    <div class="body">Right you are!   I copied and pasted from my file.  In it @str() calls yet another function to declare the string.  In trying to move this functionality to the @str() macro i forgot the trailing  &quot;, 0&quot;.<br /><br />Here's the updated version:<br /><br /><pre><code>@str macro _str&#58;vararg<br />local @@1<br />    if @InStr&#40;1, &lt;_str&gt;, &lt;!&quot;&gt;&#41;<br />        .data<br />            @@1 db _str, 0<br />        .code<br />        exitm &lt;o @@1&gt;<br />    else<br />        exitm &lt;_str&gt;<br />    endif<br />endm<br /><br /></code></pre><br /><br /><br />P.S. Here's the link to the thread with my file(s)<br /><br /><a target="_blank" href="">http://www.asmcommunity.net/board/index.php?topic=6073&amp;highlight=static</a></div>
    <div class="meta">Posted on 2002-06-21 06:02:18 by gfalen</div>
   </div>
   <div class="post" id="post-44506">
    <div class="subject"><a href="#post-44506">replacing invoke :: faster xcall macro</a></div>
    <div class="body"><strong>stryker</strong>, very nice work.  Might want to take a look at <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=2153&amp;highlight=PROLOGUE">this</a> thread to get more advanced stuff happening between caller and callee.  You could easily add stack alignment, too.</div>
    <div class="meta">Posted on 2002-06-21 07:09:33 by bitRAKE</div>
   </div>
   <div class="post" id="post-44510">
    <div class="subject"><a href="#post-44510">replacing invoke :: faster xcall macro</a></div>
    <div class="body">This is the version from the macros in MASM32.<br /><pre><code><br />; --------------------------------------------------<br />; macro for making STDCALL procedure and API calls.<br />; --------------------------------------------------<br /><br />Scall MACRO name&#58;REQ,p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12, \<br />                     p13,p14,p15,p16,p17,p18,p19,p20,p21,p22<br /><br />    ;; ---------------------------------------<br />    ;; loop through arguments backwards, push<br />    ;; NON blank ones and call the function.<br />    ;; ---------------------------------------<br /><br />    FOR arg,&lt;p22,p21,p20,p19,p18,p17,p16,p15,p14,p13,\<br />             p12,p11,p10,p9,p8,p7,p6,p5,p4,p3,p2,p1&gt;<br />      IFNB &lt;arg&gt;    ;; If not blank<br />        push arg    ;; push parameter<br />      ENDIF<br />    ENDM<br /><br />    call name       ;; call the procedure<br /><br />ENDM<br /></code></pre><br />It works much like the old TASM CALL syntax.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-06-21 07:16:57 by hutch--</div>
   </div>
   <div class="post" id="post-44512">
    <div class="subject"><a href="#post-44512">replacing invoke :: faster xcall macro</a></div>
    <div class="body">What about using VARARG there, hutch? :)</div>
    <div class="meta">Posted on 2002-06-21 07:19:38 by bazik</div>
   </div>
   <div class="post" id="post-44532">
    <div class="subject"><a href="#post-44532">replacing invoke :: faster xcall macro</a></div>
    <div class="body"><strong>gfalen</strong>,<br /><br />I just infused my macro and your @str and it works perfectly<pre><code><br />@str macro _str&#58;vararg<br />local @@1<br />    if @InStr&#40;1, &lt;_str&gt;, &lt;!&quot;&gt; &#41;<br />        .data<br />            @@1 db _str, 0<br />        .code<br />        exitm &lt;offset @@1&gt;<br />    else<br />        exitm &lt;_str&gt;<br />    endif<br />endm<br /><br />xcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    LOCAL psize, paddr, plen<br />    IFNB &lt;parameters&gt;<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            psize = psize + 4<br />        ENDM<br />        sub esp, psize<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            IF @SizeStr&#40;&lt;param&gt;&#41; GT 4<br />                paddr SUBSTR &lt;param&gt;, 1, 5<br />                IFIDNI paddr, &lt;ADDR &gt;<br />                    paddr SUBSTR &lt;param&gt;, 6, @SizeStr&#40;&lt;param&gt;&#41; - 5<br />                    lea eax, paddr<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, eax<br />                ELSE<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt;&#41;<br />                ENDIF<br />            ELSE<br />                mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt;&#41;<br />            ENDIF<br />            psize = psize + 1<br />        ENDM<br />    ENDIF<br />    call function<br />ENDM<br /><br />xcall MessageBox, NULL, &quot;Hello Cruel World&quot;, &quot;Testing xcall macro&quot;, MB_YESNO<br /></code></pre>Nice work, thanks for sharing.<br /><br /><strong>bitRAKE</strong>,<br /><br />I'll check out that profiling macro. Thanks!!!<br /><br /><strong>bAZiK</strong> &amp;&amp; <strong>hutch--</strong>,<br /><br />If I'll find ParReverse I'll post a modified version of your macros.</div>
    <div class="meta">Posted on 2002-06-21 09:54:44 by stryker</div>
   </div>
   <div class="post" id="post-44566">
    <div class="subject"><a href="#post-44566">replacing invoke :: faster xcall macro</a></div>
    <div class="body">For <strong>bitRAKE</strong>: :(<br /><br />I'm not sure if I did it correctly.<pre><code>&#91;size=9&#93;@str macro _str&#58;vararg<br />local @@1<br />    if @InStr&#40;1, &lt;_str&gt;, &lt;!&quot;&gt; &#41;<br />        .data<br />            @@1 db _str, 0<br />        .code<br />        exitm &lt;offset @@1&gt;<br />    else<br />        exitm &lt;_str&gt;<br />    endif<br />endm<br /><br />xcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    LOCAL psize, paddr, plen<br />    IFNB &lt;parameters&gt;<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            psize = psize + 4<br />        ENDM<br /><br />        &#91;color=#3366FF&#93;;Is this right? or should this be 16/32? or did I get the<br />        ;whole thing wrong. I'm such a newb &#58;&#41;<br /><br />        align 4&#91;/color&#93;<br /><br />        sub esp, psize<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            IF @SizeStr&#40;&lt;param&gt;&#41; GT 4<br />                paddr SUBSTR &lt;param&gt;, 1, 5<br />                IFIDNI paddr, &lt;ADDR &gt;<br />                    paddr SUBSTR &lt;param&gt;, 6, @SizeStr&#40;&lt;param&gt;&#41; - 5<br />                    lea eax, paddr<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, eax<br />                ELSE<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt;&#41;<br />                ENDIF<br />            ELSE<br />                mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt;&#41;<br />            ENDIF<br />            psize = psize + 1<br />        ENDM<br />    ENDIF<br />    call function<br />ENDM&#91;/size&#93;</code></pre>For <strong>bAZiK</strong>:<pre><code>&#91;size=9&#93;preverse MACRO ParList&#58;REQ<br />    LOCAL Value, arg<br />    Value TEXTEQU &lt;&gt;<br />    % FOR arg, &lt;ParList&gt;<br />        Value CATSTR &lt;arg&gt;, &lt;,&gt;, Value<br />    ENDM<br />    Value SUBSTR Value, 1, @SizeStr&#40; %Value &#41; - 1<br />    Value CATSTR &lt;!&lt;&gt;, Value, &lt;!&gt;&gt;<br />    EXITM Value<br />ENDM<br /><br />bcall MACRO function&#58;REQ, parameters&#58;VARARG<br />    IFNB &lt;parameters&gt;<br />        % FOR param, preverse&#40;&lt;parameters&gt;&#41;<br />            sub esp, 4<br />            mov DWORD PTR &#91;esp&#93;, param<br />        ENDM<br />    ENDIF<br />    call function<br />ENDM&#91;/size&#93;</code></pre>for <strong>Hutch--</strong>:<br /><br />Use this together with the preverse macro.<pre><code>&#91;size=9&#93;scall MACRO function&#58;REQ, parameters&#58;VARARG<br />    IFNB &lt;parameters&gt;<br />        % FOR param, preverse&#40;&lt;parameters&gt;&#41;<br />            push param<br />        ENDM<br />    ENDIF<br />    call function<br />ENDM&#91;/size&#93;</code></pre> :)</div>
    <div class="meta">Posted on 2002-06-21 11:46:55 by stryker</div>
   </div>
   <div class="post" id="post-44585">
    <div class="subject"><a href="#post-44585">replacing invoke :: faster xcall macro</a></div>
    <div class="body"><strong>stryker</strong>, I meant to align the address of stack for the proceedure being called:<pre><code>; Assuming stack is aligned at time of macro execution and<br />; add 4 bytes for the return address pushed onto the stack&#58;<br />psize = MyALIGN&#40;&#40;psize+4&#41;, __STACK_ALIGN__&#41;<br />psize = psize - 4 ; return address adjustment</code></pre><pre><code>MyALIGN macro val&#58;REQ, sz&#58;REQ<br />    EXITM %&#40;&#40;&#40;val+sz-1&#41;/sz&#41;*sz&#41;<br />ENDM</code></pre> sorry, I'm at work and fixed a little bug - most likely are others... :grin:<br />hopefully, you can understand what I mean.  When the called PROC is reached the stack is aligned, and then the called PROC grabs chunks of the stack that are also aligned - therefor, the stack is always aligned! :)</div>
    <div class="meta">Posted on 2002-06-21 13:05:34 by bitRAKE</div>
   </div>
   <div class="post" id="post-44591">
    <div class="subject"><a href="#post-44591">replacing invoke :: faster xcall macro</a></div>
    <div class="body">To tell you the truth I really have no idea what you're talking about! <img src="http://www.dennistang.com/bus/others/guestbook/images/smilies/eek.gif" /> I apologize, I'm still reading some intel docs.<pre><code>&#91;size=9&#93;<br />        FOR param, &lt;parameters&gt;<br />            IF @SizeStr&#40;&lt;param&gt;&#41; GT 4<br />                paddr SUBSTR &lt;param&gt;, 1, 5<br />                IFIDNI paddr, &lt;ADDR &gt;<br />                    paddr SUBSTR &lt;param&gt;, 6, @SizeStr&#40;&lt;param&gt;&#41; - 5<br />                    lea eax, paddr<br />                    mov DWORD PTR &#91;esp-psize*4&#93;, eax<br />                ELSE<br />                    mov DWORD PTR &#91;esp-psize*4&#93;, @str&#40;&lt;param&gt;&#41;<br />                ENDIF<br />            ELSE<br />                mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt;&#41;<br />            ENDIF<br />            psize = @align&#40;&#40;psize+4&#41;, 4&#41;<br />            psize = psize - 4<br />        ENDM&#91;/size&#93;</code></pre>I have a feeling this isn't right. This is the best I could come up. I think I need to read some more docs about stack alignment :)<br /><br />@align is the same macro you just posted. I'll be back  and try some more. :grin:</div>
    <div class="meta">Posted on 2002-06-21 13:50:35 by stryker</div>
   </div>
   <div class="post" id="post-44592">
    <div class="subject"><a href="#post-44592">replacing invoke :: faster xcall macro</a></div>
    <div class="body"><pre><code>&#91;b&#93;        psize = @align&#40;&#40;psize+4&#41;, 32&#41;<br />        psize = psize - 4&#91;/b&#93;<br /><br />        sub esp, psize<br />        psize = 0<br />        FOR param, &lt;parameters&gt;<br />            IF @SizeStr&#40;&lt;param&gt; &#41; GT 4<br />                paddr SUBSTR &lt;param&gt;, 1, 5<br />                IFIDNI paddr, &lt;ADDR &gt;<br />                    paddr SUBSTR &lt;param&gt;, 6, @SizeStr&#40;&lt;param&gt; &#41; - 5<br />                    lea eax, paddr<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, eax<br />                ELSE<br />                    mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt; &#41;<br />                ENDIF<br />            ELSE<br />                mov DWORD PTR &#91;esp+psize*4&#93;, @str&#40;&lt;param&gt; &#41;<br />            ENDIF<br />            psize = psize + 1<br />        ENDM</code></pre>:eek: :grin:</div>
    <div class="meta">Posted on 2002-06-21 14:09:12 by bitRAKE</div>
   </div>
   <div class="post" id="post-44593">
    <div class="subject"><a href="#post-44593">replacing invoke :: faster xcall macro</a></div>
    <div class="body">I did that before but I don't know what happened because it crashed??? :) I'll check it back again</div>
    <div class="meta">Posted on 2002-06-21 14:11:44 by stryker</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=6187&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=6187&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="6187" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=6187&amp;page=2">&gt;</a><a href="../?id=6187&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>