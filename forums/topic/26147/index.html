<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Appendmenua help please - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26147" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26147">Appendmenua help please</a></p>
   <div class="post" id="post-190335">
    <div class="subject"><a href="#post-190335">Appendmenua help please</a></div>
    <div class="body">I am trying to add about menu to my dialog but it doesnt work.I can see the about menu but it doesn't show messagebox
caption		db "About",0
defname		db "About" ,0
info		db "Test",0
IDC_Sit		         =     1009

_wmcommand:
	mov	eax, _wParam
	cmp	ax, IDC_Sit
	jz   sit


sit:
    push 0
    push offset caption
    push offset info
    push __hWnd
    call MessageBoxA
    mov eax,-1
    ret

-------<<<<......>>>>
        call	GetSystemMenu, __hwnd, FALSE
	mov	esi, eax
	mov	edi, offset DeleteMenu
	call	edi, esi, SC_RESTORE, MF_BYCOMMAND
	call	edi, esi, SC_MAXIMIZE, MF_BYCOMMAND
	call	edi, esi, SC_SIZE, MF_BYCOMMAND
	call    AppendMenuA,esi,MF_STRING,IDC_Sit,offset defname
	call	DrawMenuBar, __hwnd

Thanks for any reply</div>
    <div class="meta">Posted on 2000-11-10 19:36:00 by LaptoniC</div>
   </div>
   <div class="post" id="post-190336">
    <div class="subject"><a href="#post-190336">Appendmenua help please</a></div>
    <div class="body">I'm guessing that a system menu generates a WM_SYSCOMMAND instead of a WM_COMMAND.

I know that's the case for the minimize, maximize, and close menu items.</div>
    <div class="meta">Posted on 2000-11-10 20:42:00 by ub1 </div>
   </div>
   <div class="post" id="post-190337">
    <div class="subject"><a href="#post-190337">Appendmenua help please</a></div>
    <div class="body">Thanks it works</div>
    <div class="meta">Posted on 2000-11-11 18:58:00 by LaptoniC</div>
   </div>
  </div>
 </body>
</html>