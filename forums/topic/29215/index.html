<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Controlling Registry Virtualization in Vista - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29215" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=29215">Controlling Registry Virtualization in Vista</a></p>
   <div class="post" id="post-206330">
    <div class="subject"><a href="#post-206330">Controlling Registry Virtualization in Vista</a></div>
    <div class="body">I need to change keys in Windows Vista registry in HKEY_LOCAL_MACHINE\Software... For this purpose it is necessary to use requestedExecutionLevel in the manifest. But for me it turns out nothing.<br />Earlier I had such manifest for XP-interface support.<br /><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;<br />&lt;assembly xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot; manifestVersion=&quot;1.0&quot;&gt;<br />&nbsp; &nbsp; &lt;dependency&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;dependentAssembly&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;assemblyIdentity<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type=&quot;win32&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; name=&quot;Microsoft.Windows.Common-Controls&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; version=&quot;6.0.0.0&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processorArchitecture=&quot;*&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; publicKeyToken=&quot;6595b64144ccf1df&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; language=&quot;*&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;/dependentAssembly&gt;<br />&nbsp; &nbsp; &lt;/dependency&gt;<br />&lt;/assembly&gt;</code></pre><br />Now I try so<br /><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;<br />&lt;assembly xmlns=&quot;urn:schemas-microsoft-com:asm.v1&quot; manifestVersion=&quot;1.0&quot;&gt;<br />&nbsp; &nbsp; &lt;dependency&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;dependentAssembly&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;assemblyIdentity<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; type=&quot;win32&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; name=&quot;Microsoft.Windows.Common-Controls&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; version=&quot;6.0.0.0&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; processorArchitecture=&quot;*&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; publicKeyToken=&quot;6595b64144ccf1df&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; language=&quot;*&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;/dependentAssembly&gt;<br />&nbsp; &nbsp; &lt;/dependency&gt;<br />&lt;trustInfo xmlns=&quot;urn:schemas-microsoft-com:asm.v3&quot;&gt;<br />&nbsp; &nbsp; &lt;security&gt;<br />&nbsp; &nbsp; &nbsp; &lt;requestedPrivileges&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;requestedExecutionLevel<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; level=&quot;requireAdministrator&quot;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uiAccess=&quot;false&quot;/&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;/requestedPrivileges&gt;<br />&nbsp; &nbsp; &nbsp;  &lt;/security&gt;<br />&nbsp; &lt;/trustInfo&gt;<br />&lt;/assembly&gt;</code></pre><br />Somebody already used in the programs written on masm32 the manifest with a requested execution level?</div>
    <div class="meta">Posted on 2008-11-17 03:55:13 by vitaliythegreat</div>
   </div>
  </div>
 </body>
</html>