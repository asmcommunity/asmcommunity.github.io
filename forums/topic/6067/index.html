<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Small Anti-SoftIce Code - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6067" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6067">Small Anti-SoftIce Code</a></p>
   <div class="post" id="post-43447">
    <div class="subject"><a href="#post-43447">Small Anti-SoftIce Code</a></div>
    <div class="body">Hello,<br /><br />I want do protect my programm and want a small<br />code it check softice and close my own if found.</div>
    <div class="meta">Posted on 2002-06-15 12:59:13 by Fred556</div>
   </div>
   <div class="post" id="post-43448">
    <div class="subject"><a href="#post-43448">Small Anti-SoftIce Code</a></div>
    <div class="body">Last I heard, softice relied exclusively on INT3.<br />In case you don't know, Interrupt 3 is used to set the cpu into single-stepping mode, as used by many debuggers and tracers.<br />The anti-softice stuff I've seen worked by checking the value at the INT3 vector to determine if SI (or some other debugger) was loaded up.</div>
    <div class="meta">Posted on 2002-06-15 13:11:32 by Homer</div>
   </div>
   <div class="post" id="post-43460">
    <div class="subject"><a href="#post-43460">Small Anti-SoftIce Code</a></div>
    <div class="body">As usual: <br /><br />Chances are that if an someone uses SoftIce for malicious purposes, any trick you can code it will be useless. :( As there are countless addons for SoftIce which all they do is keep their eyes open for a possible detection.<br /><br />and <br /><br />Chances are that you might piss off good Users (probably) developpers which won't even take your program into consideration when it closes itself upon SoftIce detection.<br /><br />Anyway,<br /><br />MeltIce is the most common trick to detect SI:<br /><br />CreateFile with &quot;\\\\.\\SICE&quot; as Name - if it returns an existing Handle, you can assume that it is loaded.<br /><br />There are many more : <br /><a target="_blank" href="http://linux20368.dn.net/crackz/Tutorials/Protect.htm">See here for a start</a> and <a target="_blank" href="http://www.google.com">Search the Net</a></div>
    <div class="meta">Posted on 2002-06-15 19:46:42 by JimmyClif</div>
   </div>
   <div class="post" id="post-43461">
    <div class="subject"><a href="#post-43461">Small Anti-SoftIce Code</a></div>
    <div class="body">Softice detection is silly. There is <strong>NO</strong> way you'll stop anybody<br />with just a little skill (people who are able to more than just install<br />softice). There's a few generic ways to do it (like the createfile method)<br />that will not harm your program, but most other methods involve<br />dirty tricks that'll make your program incompatible with a bunch of<br />windows versions. Really, softice detection is not worth the effort.</div>
    <div class="meta">Posted on 2002-06-15 20:05:35 by f0dder</div>
   </div>
   <div class="post" id="post-43463">
    <div class="subject"><a href="#post-43463">si stop</a></div>
    <div class="body">Hi,<br /><br /> I attached  example code about &quot;how to detect SI and icedump&quot;. But not detected other debuggers. As Fodder said,  this method not %100 safe... <br /><br /> have nice days</div>
    <div class="meta">Posted on 2002-06-15 20:27:40 by CYDONIA</div>
   </div>
   <div class="post" id="post-43513">
    <div class="subject"><a href="#post-43513">Re: si stop</a></div>
    <div class="body"><div class="quote"><br />Hi,<br /><br /> I attached  example code about &quot;how to detect SI and icedump&quot;. But not detected other debuggers. As Fodder said,  this method not %100 safe... <br /><br /> have nice days </div><br /><br />Thanks. Is this a Win32ASM or TASM?</div>
    <div class="meta">Posted on 2002-06-16 03:02:57 by Fred556</div>
   </div>
   <div class="post" id="post-43524">
    <div class="subject"><a href="#post-43524">two ways more...</a></div>
    <div class="body">search for more on the net...</div>
    <div class="meta">Posted on 2002-06-16 04:17:29 by hunter</div>
   </div>
   <div class="post" id="post-43638">
    <div class="subject"><a href="#post-43638">Small Anti-SoftIce Code</a></div>
    <div class="body">Hi,<br /><br /> <div class="quote"><br />Thanks. Is this a Win32ASM or TASM?<br /> </div><br /><br /> Yes, TASM. MASM example below,<br /><br /> have nice days.</div>
    <div class="meta">Posted on 2002-06-16 18:26:03 by CYDONIA</div>
   </div>
   <div class="post" id="post-43664">
    <div class="subject"><a href="#post-43664">Small Anti-SoftIce Code</a></div>
    <div class="body">I dont have much knowledge about subject but here is translation of what i found on one of the russian web site about new protection program:<br /><br />use INT0, INT1, INT3 also use DRx registers not just check or clear them use it.</div>
    <div class="meta">Posted on 2002-06-16 23:22:18 by pahan</div>
   </div>
   <div class="post" id="post-43733">
    <div class="subject"><a href="#post-43733">Re: two ways more...</a></div>
    <div class="body"><div class="quote"><br />search for more on the net... </div><br /><br />How Can I compile it?<br />incluse Win32.inc?? Cannot found it in MASM7.</div>
    <div class="meta">Posted on 2002-06-17 06:17:41 by Fred556</div>
   </div>
   <div class="post" id="post-43747">
    <div class="subject"><a href="#post-43747">Small Anti-SoftIce Code</a></div>
    <div class="body">If you don't know how to use it, and don't know how and WHY it<br />works, then by all means dont use it. You'll be back to point 0 without<br />any protection at all, and might end up annoying legitimate users.<br />Ie, I have softice running a lot of time on my system, for the purpose<br />of debugging *MY OWN* apps... sorta sucks that I have to reboot<br />to run a few apps (well, anti-si code can obviously be removed,<br />and often rather easily, but it's still annoying having to do it).</div>
    <div class="meta">Posted on 2002-06-17 07:51:15 by f0dder</div>
   </div>
  </div>
 </body>
</html>