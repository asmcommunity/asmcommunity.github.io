<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Try-list.... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12814" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12814">Try-list....</a></p>
   <div class="post" id="post-99302">
    <div class="subject"><a href="#post-99302">Try-list....</a></div>
    <div class="body">Hi, I wonder how to programm a try-icon-list.<br />Perhaps someone of you has experience.<br /><br />Bye !</div>
    <div class="meta">Posted on 2003-04-25 05:47:04 by Forginforcer</div>
   </div>
   <div class="post" id="post-99311">
    <div class="subject"><a href="#post-99311">Re: Try-list....</a></div>
    <div class="body"><div class="quote"><em>Hi, I wonder how to programm a try-icon-list.</em></div>Huh???? What is a &quot;try-icon-list&quot;?  :confused:</div>
    <div class="meta">Posted on 2003-04-25 06:11:57 by sluggy</div>
   </div>
   <div class="post" id="post-99316">
    <div class="subject"><a href="#post-99316">Try-list....</a></div>
    <div class="body">you know, the little batten where all trayed programms are. :alright:<br /><br />P.S. Perhaps I made a little typo</div>
    <div class="meta">Posted on 2003-04-25 06:27:43 by Forginforcer</div>
   </div>
   <div class="post" id="post-99326">
    <div class="subject"><a href="#post-99326">Try-list....</a></div>
    <div class="body">Hi Red,<br />Somrthing like this. Just look for the WM_USER+27 message in your message loop.<br /><br />Insert the Icon<pre><code>invoke LoadIcon,hInst,ICO_TRAY<br /><br />mov NID.hIcon,eax<br />mov NID.cbSize,SIZEOF NOTIFYICONDATA<br />mov eax,hDlg<br />mov NID.hwnd,eax<br />mov NID.uID,1<br />mov NID.uFlags,NIF_ICON	or NIF_MESSAGE or NIF_TIP<br />mov NID.uCallbackMessage,WM_USER + 27<br />invoke LoadString,hInst,IDC_TRAYTIP,ADDR NID.szTip,SIZEOF NID.szTip<br />invoke Shell_NotifyIcon,NIM_ADD,ADDR NID</code></pre>Remove the Icon<pre><code>mov NID.cbSize,SIZEOF NOTIFYICONDATA<br />mov eax,hDlg<br />mov NID.hwnd,eax<br />mov NID.uID,1<br />invoke Shell_NotifyIcon,NIM_DELETE,ADDR NID</code></pre></div>
    <div class="meta">Posted on 2003-04-25 07:07:30 by donkey</div>
   </div>
   <div class="post" id="post-99329">
    <div class="subject"><a href="#post-99329">Try-list....</a></div>
    <div class="body">As I see well, its a sample to make a try-icon, isn't ?<br />I would like to get all trys...</div>
    <div class="meta">Posted on 2003-04-25 07:28:04 by Forginforcer</div>
   </div>
   <div class="post" id="post-99331">
    <div class="subject"><a href="#post-99331">Try-list....</a></div>
    <div class="body">I assume you mean a Tray Icon. This will add one and delete it. To get a list of current tray Icons you have to use something else. I don't know how to do that, never needed it and can't see a use so I was never interested to find out how.</div>
    <div class="meta">Posted on 2003-04-25 07:38:45 by donkey</div>
   </div>
   <div class="post" id="post-99395">
    <div class="subject"><a href="#post-99395">Try-list....</a></div>
    <div class="body">Ahh, a tray icon list. There is no way of enumerating the icons already in the tray (at least there is no way that i have ever seen, although you may discover some hack to do it).</div>
    <div class="meta">Posted on 2003-04-25 14:19:03 by sluggy</div>
   </div>
   <div class="post" id="post-99400">
    <div class="subject"><a href="#post-99400">Try-list....</a></div>
    <div class="body">I saw something about this on the ExpertsExchange once, you'll have to pay to search the database though, they don't give advice away for free. It was a long and involved process that was written in C++, something about hooking to the WindowProc of the SysTray, but I can't remember exactly what it was.<br /><br /><a target="_blank" href="http://www.geocities.com/nickrepin/winprog/shellico.txt">This might help but it's not in ASM</a> so I can't comment on it working or not or even if it's good code.</div>
    <div class="meta">Posted on 2003-04-25 14:37:37 by donkey</div>
   </div>
  </div>
 </body>
</html>