<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>WinAsm V1.0.1.5 (Add-Ins) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14611" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=41">WinAsm Studio</a> &raquo; <a href="../?id=14611">WinAsm V1.0.1.5 (Add-Ins)</a></p>
   <div class="post" id="post-113077">
    <div class="subject"><a href="#post-113077">WinAsm V1.0.1.5 (Add-Ins)</a></div>
    <div class="body">Hi All,<br /><br />This is WinAsm V1.0.1.5 <strong>(Now available at WinAsm site)</strong><br /><br /><strong>Add-Ins</strong>   (Thanks eko, TBD and many others)<br />	<br />A)The best way to start building Add-Ins for WinAsm is by choosing File-<br />New Project-Bare Bone-AddIn. A new project containing the following procedures<br />will be created:<br /><br />a)DllEntry<br />----------<br />Leave this as it is (a WinAsm Add-In is a Dll after all)<br />THIS FUNCTION IS REQUIRED BY ALL VALID WinAsm ADDINS.<br />	<br />b)GetWAAddInData<br />----------------<br />This procedure must fill in Add-In friendly name and description of what<br />this Add-In does.<br />THIS FUNCTION IS REQUIRED BY ALL VALID WinAsm ADDINS.<br />	<br />c)WAAddInLoad<br />-------------<br />Place all one-time initializations here. If all resources are<br />successfully allocated, function must return 0. On error, it must free<br />partially allocated resources and return -1, in this case Add-In will not be loaded.<br />pWinAsmHandles is a pointer to the HANDLES structure (see WAAddIn.inc),<br />you will most probably need to keep it. Parameter 'features' is reserved<br />for future extentions, do not use it.<br />THIS FUNCTION IS REQUIRED BY ALL VALID WinAsm ADDINS.<br />	<br />d)WAAddInUnload<br />---------------<br />It is called when WinAsm closes and when user selectes to unload the<br />Add-In from the WinAsm Add-In Manager. Free all internally allocated<br />resources, like window classes, files, memory and so on here.<br />THIS FUNCTION IS REQUIRED BY ALL VALID WinAsm ADDINS.<br />	<br />e)FrameWindowProc<br />-----------------<br />This Procedure receives ALL messages of the Main window. You should<br />return 0 if you want WinAsm AND ALL OTHER POSSIBLY LOADED ADDINS to<br />process the message otherwise WinAsm AND OTHER POSSIBLY LOADED ADDINS<br />will NOT process it.<br />If you want to use this procedure you must uncomment it from the WAAddIn.inc<br />	<br />f)ChildWindowProc<br />-----------------<br />This Procedure receives ALL messages of ALL MDI child windows.<br />You should return 0 if you want WinAsm AND ALL OTHER POSSIBLY LOADED<br />ADDINS to process the message otherwise WinAsm AND OTHER POSSIBLY LOADED<br />ADDINS will NOT process it.<br />If you want to use this procedure you must uncomment it from the WAAddIn.inc<br /><br />g)ProjectExplorerProc<br />---------------------<br />This Procedure receives ALL messages of the Project Explorer window.<br />You should return 0 if you want WinAsm AND ALL OTHER POSSIBLY LOADED ADDINS<br />to process the message otherwise WinAsm AND OTHER POSSIBLY LOADED ADDINS<br />will NOT process it.<br />If you want to use this procedure you must uncomment it from the WAAddIn.inc<br />	<br />h)OutWindowProc<br />---------------<br />This Procedure receives ALL messages of the Out window. You should return 0<br />if you want WinAsm AND ALL OTHER POSSIBLY LOADED ADDINS to process the<br />message otherwise WinAsm AND OTHER POSSIBLY LOADED ADDINS will NOT process it.<br />If you want to use this procedure you must uncomment it from the WAAddIn.inc<br /><br />B)Note the new &quot;Inc&quot; folder in the WinAsm Directory. It includes WAAddIn.inc<br />(in which you will find all constants, structures etc ). I already know that<br />more information can be added in this file so I expect suggestions here.<br /><br />C)AFTER creating a new Add-In I suggest you go Project-Properties-/OUT and<br />set the name of your Dll and where it should be created.e.g If your WinAsm<br />directory is C:\WinAsm you set C:\WinAsm\AddIns\nameofaddin.dll<br /><br />D)In AddIn.def you change<br />LIBRARY AddIn -----to--------&gt;LIBRARY nameofaddin.dll<br /><br />AND uncomment procedure names you will use in your addin:<br /><br />EXPORTS	GetWAAddInData	&lt;------Do not comment this<br />	WAAddInLoad	&lt;------Do not comment this<br />	WAAddInUnload	&lt;------Do not comment this<br />	;FrameWindowProc	&lt;------Uncomment this if you are going to use it in your Add-In<br />	;ChildWindowProc	&lt;------Uncomment this if you are going to use it in your Add-In<br />	;ProjectExplorerProc&lt;-------Uncomment this if you are going to use it in your Add-In<br />	;OutWindowProc	&lt;-------Uncomment this if you are going to use it in your Add-In<br /><br /><br /><strong>Other</strong><br />2.Small behaviour change: WinAsm help file was application topmost(Thanks Masmer).<br /><br />3.A MesageBox popping up asking if the user really wants to remove a<br />  file (Yes\No)(Thanks Masmer).<br /><br />4.Splash takes a little longer (Thanks FunkyMeister)<br /><br />5.Some optimizations for Intellisense.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-05 08:14:55 by akyprian</div>
   </div>
   <div class="post" id="post-113091">
    <div class="subject"><a href="#post-113091">WinAsm V1.0.1.5 (Add-Ins)</a></div>
    <div class="body">Thank you for implementing my suggestions. Looks like my work is cut out for me with this release. ;) <br /><br />BTW: You have &quot;Open Last Project&quot; enabled which opens the Addin project (in case you didn't know).<br /><br />Note to all: That AddInOne addin can be disabled from Add-ins menu =&gt; Add-in Manager. :grin: <br /><br />Found this amusing ...</div>
    <div class="meta">Posted on 2003-08-05 09:51:34 by Masmer</div>
   </div>
   <div class="post" id="post-113097">
    <div class="subject"><a href="#post-113097">WinAsm V1.0.1.5 (Add-Ins)</a></div>
    <div class="body">Hi Masmer,<br /><br /><strong>You have &quot;Open Last Project&quot; enabled which opens the Addin project (in case you didn't know).</strong><br /><br />Yes I DID know. I did it on purpose :tongue: <br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-05 11:41:39 by akyprian</div>
   </div>
   <div class="post" id="post-113147">
    <div class="subject"><a href="#post-113147">Inserting text</a></div>
    <div class="body">Hi Akyprian,<br />         I was wondering how we go about inserting a text string into an open document (.asm file). I am assuming we send some sort of message to the open child window. ie.<br /><br />Invoke SendMessage, hClient, WM_MDIGETACTIVE, 0, 0<br />; Test to see if valid value returned...<br />...<br />mov      hChild, eax<br />Invoke SendMessage, hChild, ????message????, offset stringToInsert, 0<br /><br />I had a good look through the addin files but couldn't find what I was looking for message-wise. Any ideas?<br /><br />Thanks</div>
    <div class="meta">Posted on 2003-08-05 21:25:11 by andrew_k</div>
   </div>
   <div class="post" id="post-113149">
    <div class="subject"><a href="#post-113149">Tray icon and colours</a></div>
    <div class="body">Hi Akyprian,<br />Winasm just keeps getting cooler! I noticed it re-opens the most recently used project on startup a lot quicker now. Excellent! However I noticed the background in the new version of Winasm changed to green when I opened one of your addin projects and stayed that colour afterwards when I opened one of my own (located in a different directory). Is this intentional? I don't know if I really liked the green....<br /><br />Also (while I'm complaining about something you've slaved over and give away for free...!), Winasm 1.0.1.5 minimises to a tray icon. In my opinion (and this is just my opinion, I'm not saying I'm correct) this can be a little frustrating. I always expect to be able to restore a minimised window from the task bar and the new Winasm of course simply doesn't minimise there. Unless you have a particularly good reason for doing this I feel that by stepping out of established convention you are violating usability principles: the application simply doesn't behave as the user expects. Sure I could get used to it maybe, but why? Please note that this is not meant as a criticism. As you know I appreciate your work immensely, I was just curious as to why you have done this. Maybe other users could offer some comments here?<br /><br />Thanks hugely once again, the addin feature rocks!!!</div>
    <div class="meta">Posted on 2003-08-05 21:50:05 by andrew_k</div>
   </div>
   <div class="post" id="post-113154">
    <div class="subject"><a href="#post-113154">Re: Inserting text</a></div>
    <div class="body"><div class="quote"><br />Hi Akyprian,<br />         I was wondering how we go about inserting a text string into an open document (.asm file). I am assuming we send some sort of message to the open child window. ie.<br /><br />Invoke SendMessage, hClient, WM_MDIGETACTIVE, 0, 0<br />; Test to see if valid value returned...<br />...<br />mov      hChild, eax<br />Invoke SendMessage, hChild, ????message????, offset stringToInsert, 0<br /><br />I had a good look through the addin files but couldn't find what I was looking for message-wise. Any ideas?<br /><br />Thanks </div><br /><br />andrew_k,<br /><br />The messages you can send to the editor are in the WAAddin.inc plus these:<br /><br />EM_EXLINEFROMCHAR<br />wParam=0<br />lParam=cp<br /><br />EM_EXSETSEL<br />wParam=0<br />lParam=lpCHARRANGE<br /><br />EM_EXGETSEL<br />wParam=0<br />lParam=lpCHARRANGE<br /><br />EM_FINDTEXTEX<br />wParam=Flags<br />lParam=lpFINDTEXTEX<br /><br />EM_GETTEXTRANGE<br />wParam=0<br />lParam=lpTEXTRANGE<br /><br />EM_FINDWORDBREAK<br />wParam=uFlags<br />lParam=cp<br /><br />EM_CANREDO<br />wParam=0<br />lParam=0<br /><br />EM_REDO<br />wParam=0<br />lParam=0<br /><br />EM_HIDESELECTION<br />wParam=TRUE/FALSE<br />lParam=0<br /><br />EM_GETSELTEXT<br />wParam=0<br />lParam=lpBuff<br /><br />EM_CANPASTE<br />wParam=CF_TEXT<br />lParam=0<br /><br />EM_STREAMIN<br />wParam=SF_TEXT<br />lParam=lpStream<br /><br />EM_STREAMOUT<br />wParam=SF_TEXT<br />lParam=lpStream<br /><br />EM_CHARFROMPOS<br />wParam=0<br />lParam=lpPoint<br /><br />EM_POSFROMCHAR<br />wParam=lpPoint<br />lParam=cp<br /><br />EM_LINEFROMCHAR<br />wParam=cp<br />lParam=0<br /><br />EM_LINEINDEX<br />wParam=line<br />lParam=0<br /><br />EM_LINELENGTH<br />wParam=cp<br />lParam=0<br /><br />EM_GETLINE<br />wParam=Line<br />lParam=lpBuff<br /><br />EM_GETFIRSTVISIBLELINE<br />wParam=0<br />lParam=0<br /><br />EM_LINESCROLL<br />wParam=cxScroll<br />lParam=cyScroll<br /><br />EM_SCROLLCARET<br />wParam=0<br />lParam=0<br /><br />EM_SETSEL<br />wParam=cpMin<br />lParam=cpMax<br /><br />EM_GETSEL<br />wParam=lpcpMin<br />lParam=lpcpMax<br /><br />EM_GETMODIFY<br />wParam=0<br />lParam=0<br /><br />EM_SETMODIFY<br />wParam=TRUE/FALSE<br />lParam=0<br /><br />EM_REPLACESEL<br />wParam=TRUE/FALSE<br />lParam=lpText<br /><br />EM_GETLINECOUNT<br />wParam=0<br />lParam=0<br /><br />EM_GETRECT<br />wParam=0<br />lParam=lpRECT<br /><br />EM_CANUNDO<br />wParam=0<br />lParam=0<br /><br />EM_UNDO<br />wParam=0<br />lParam=0<br /><br />EM_EMPTYUNDOBUFFER<br />wParam=0<br />lParam=0<br /><br />WM_COPY<br />wParam=0<br />lParam=0<br /><br />WM_CUT<br />wParam=0<br />lParam=0<br /><br />WM_PASTE<br />wParam=0<br />lParam=0<br /><br />WM_CLEAR<br />wParam=0<br />lParam=0<br /><br />WM_SETTEXT<br />wParam=0<br />lParam=lpszText<br /><br />WM_GETTEXT<br />wParam=cbBuff<br />lParam=lpBuff<br /><br />WM_GETTEXTLENGTH<br />wParam=0<br />lParam=0<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-05 23:50:14 by akyprian</div>
   </div>
   <div class="post" id="post-113157">
    <div class="subject"><a href="#post-113157">Re: Tray icon and colours</a></div>
    <div class="body"><div class="quote"><br />Hi Akyprian,<br />Winasm just keeps getting cooler! I noticed it re-opens the most recently used project on startup a lot quicker now. Excellent! However I noticed the background in the new version of Winasm changed to green when I opened one of your addin projects and stayed that colour afterwards when I opened one of my own (located in a different directory). Is this intentional? I don't know if I really liked the green....<br /><br />Also (while I'm complaining about something you've slaved over and give away for free...!), Winasm 1.0.1.5 minimises to a tray icon. In my opinion (and this is just my opinion, I'm not saying I'm correct) this can be a little frustrating. I always expect to be able to restore a minimised window from the task bar and the new Winasm of course simply doesn't minimise there. Unless you have a particularly good reason for doing this I feel that by stepping out of established convention you are violating usability principles: the application simply doesn't behave as the user expects. Sure I could get used to it maybe, but why? Please note that this is not meant as a criticism. As you know I appreciate your work immensely, I was just curious as to why you have done this. Maybe other users could offer some comments here?<br /><br />Thanks hugely once again, the addin feature rocks!!! </div><br /><br />Hi again,<br /><br />Most probably you loaded Client Color Add-In ? Go to Add-Ins --&gt; Add-Ins Manager and unload it or from the new menu item &quot;Client Color Add-In&quot; you can choose a different color.<br /><br />Tray Icon is optional. Go to Tools-Options-General and disable it. Satisfied ?<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-05 23:59:50 by akyprian</div>
   </div>
   <div class="post" id="post-113166">
    <div class="subject"><a href="#post-113166">WinAsm V1.0.1.5 (Add-Ins)</a></div>
    <div class="body"><strong>akyprian:</strong> just wow :tongue: <br />i didnt expect that you will implement the add-ins so quick and so well.<br />excelent work. I like that you can load/unload on demand.<br /><br />suggestion: create on the homepage a section for add-ins. i think<br />some nice addins will appear and a home for them would be nice :)</div>
    <div class="meta">Posted on 2003-08-06 00:43:23 by TBD</div>
   </div>
   <div class="post" id="post-113169">
    <div class="subject"><a href="#post-113169">WinAsm V1.0.1.5 (Add-Ins)</a></div>
    <div class="body"><div class="quote"><br /><strong>akyprian:</strong> just wow :tongue: <br />i didnt expect that you will implement the add-ins so quick and so well.<br />excelent work. I like that you can load/unload on demand.<br /><br />suggestion: create on the homepage a section for add-ins. i think<br />some nice addins will appear and a home for them would be nice :) </div><br /><br />Hi TBD,<br /><br />First of all, thanks for your kindness to provide those OllyDbg Plugin samples. As you can see I got some ideas from those although I 've chosen a rather different approach.<br /><br />As far as the Add-Ins section in the WinAsm site is concerned, YES, I have already thought of it. Thanks. Masmer, are you reading ?<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-06 00:51:57 by akyprian</div>
   </div>
   <div class="post" id="post-113170">
    <div class="subject"><a href="#post-113170">WinAsm V1.0.1.5 (Add-Ins)</a></div>
    <div class="body">I was just about to update the website when TBD posted. Check out the downloads page and see if that is good enough. (Do people want a new page for add-ins?)</div>
    <div class="meta">Posted on 2003-08-06 01:07:26 by Masmer</div>
   </div>
   <div class="post" id="post-113176">
    <div class="subject"><a href="#post-113176">WinAsm V1.0.1.5 (Add-Ins)</a></div>
    <div class="body"><strong>Masmer:</strong> i think it is ok on the download page.<br />... when a lot of add-ins exists maybe than a new page would be nice ;) <br /><br />now the ball is in our playground ... to enhance WinASM using AddIns :grin:</div>
    <div class="meta">Posted on 2003-08-06 02:50:41 by TBD</div>
   </div>
   <div class="post" id="post-113181">
    <div class="subject"><a href="#post-113181">WinAsm V1.0.1.5 (Add-Ins)</a></div>
    <div class="body"><div class="quote"><br />now the ball is in our playground ... to enhance WinASM using AddIns :grin: </div><br /><br />TBD,<br /><br />100% correct ;) <br /><br /><br />Masmer,<br /><br /><strong>Check out the downloads page and see if that is good enough.</strong><br />Very nice, please leave it as it is for now :alright: <br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-06 03:18:40 by akyprian</div>
   </div>
  </div>
 </body>
</html>