<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How to handle a program create by ShellExecute - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2058" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2058">How to handle a program create by ShellExecute</a></p>
   <div class="post" id="post-13082">
    <div class="subject"><a href="#post-13082">How to handle a program create by ShellExecute</a></div>
    <div class="body">I use ShellExecute to execute IE opens some CGI script like:<br /><br />HINSTANCE result = ShellExecute(NULL, _T(&quot;open&quot;), mUrl, NULL,NULL, cmdshow );<br /><br />Is it true?<br />And when I created, the handle is result?<br />And how to close this dialog by coding in my program?<br />Another way to run CGI script?<br /><br /><br />Please help me! thank you very much!</div>
    <div class="meta">Posted on 2001-11-26 08:43:13 by bung</div>
   </div>
   <div class="post" id="post-13148">
    <div class="subject"><a href="#post-13148">How to handle a program create by ShellExecute</a></div>
    <div class="body">Use ShellExecuteEx instead, this function returns a handle to the newly created process, you can then use this handle to help you terminate the process, and do various other things with it.<br /><br />Check out <a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wc">this</a> for info on this function.</div>
    <div class="meta">Posted on 2001-11-26 21:48:31 by sluggy</div>
   </div>
   <div class="post" id="post-13282">
    <div class="subject"><a href="#post-13282">How to handle a program create by ShellExecute</a></div>
    <div class="body">Here is an example in VB...<br /><pre><code>Public Type SHELLEXECUTEINFO<br />        cbSize As Long<br />        fMask As Long<br />        hwnd As Long<br />        lpVerb As String<br />        lpFile As String<br />        lpParameters As String<br />        lpDirectory As String<br />        nShow As Long<br />        hInstApp As Long<br />        '  Optional fields<br />        lpIDList As Long<br />        lpClass As String<br />        hkeyClass As Long<br />        dwHotKey As Long<br />        hIcon As Long<br />        hProcess As Long<br />End Type<br />Public Declare Function GetExitCodeProcess Lib &quot;kernel32&quot; &#40;ByVal hProcess As Long, lpExitCode As Long&#41; As Long<br />Public Declare Function Sleep Lib &quot;kernel32&quot; &#40;ByVal dwMicroSecs As Long&#41; As Long<br />Public Declare Function ShellExecuteEx Lib &quot;shell32.dll&quot; Alias &quot;ShellExecuteExA&quot; &#40;lpExecInfo As SHELLEXECUTEINFO&#41; As Long<br /><br />Sub odbc&#40;&#41;<br />'<br />' odbc Macro<br />' Macro created 11/23/2000 by bNaza<br /><br /> docum = &quot;odbc&quot;<br /><br />If ActiveDocument = &#40;docum + &quot;.doc&quot;&#41; Then<br /><br />direct = &quot;c&#58;\My Documents\asm\db\&quot;<br />rcprog = &quot;Rc.exe&quot;<br />rcpara = &quot; /v &quot; + &quot;rsrc.rc&quot;<br />cvprog = &quot;Cvtres.exe&quot;<br />cvpara = &quot; /machine&#58;ix86 &quot; + &quot;rsrc.res&quot;<br />mlprog = &quot;ml.exe&quot;<br />mlpara = &quot; /c /coff &quot; + docum + &quot;.asm&quot;<br />linkprog = &quot;link.exe&quot;<br />linkpara = &quot; /SUBSYSTEM&#58;WINDOWS /RELEASE /MERGE&#58;.rdata=.text /SECTION&#58;.text&quot; + &quot;,&quot; + &quot;CEWR &quot; + docum + &quot;.obj&quot;<br />linkparaRes = &quot; /SUBSYSTEM&#58;WINDOWS /RELEASE /MERGE&#58;.rdata=.text /SECTION&#58;.text&quot; + &quot;,&quot; + &quot;CEWR &quot; + docum + &quot;.obj &quot; + &quot;rsrc.obj&quot;<br /><br /><br />'Save Document as asm&#40;txt&#41; and as doc files<br />    ChangeFileOpenDirectory &#40;direct&#41;<br />    ActiveDocument.SaveAs filename&#58;=&#40;docum + &quot;.asm&quot;&#41;, FileFormat&#58;=wdFormatDOSText _<br />        , LockComments&#58;=False, Password&#58;=&quot;&quot;, AddToRecentFiles&#58;=False, _<br />        WritePassword&#58;=&quot;&quot;, ReadOnlyRecommended&#58;=False, EmbedTrueTypeFonts&#58;=False, _<br />         SaveNativePictureFormat&#58;=False, SaveFormsData&#58;=False, SaveAsAOCELetter&#58;=False<br />    ActiveDocument.SaveAs filename&#58;=&#40;docum + &quot;.doc&quot;&#41;, FileFormat&#58;= _<br />        wdFormatDocument, LockComments&#58;=False, Password&#58;=&quot;&quot;, AddToRecentFiles&#58;= _<br />        True, WritePassword&#58;=&quot;&quot;, ReadOnlyRecommended&#58;=False, EmbedTrueTypeFonts&#58;= _<br />        False, SaveNativePictureFormat&#58;=False, SaveFormsData&#58;=False, _<br />        SaveAsAOCELetter&#58;=False<br />        <br />'Searching recource file<br />         Set fs = Application.FileSearch<br />    With fs<br />           .LookIn = direct<br />           .filename = &quot;rsrc.obj&quot;<br />        If .Execute &gt; 0 Then GoTo LResource<br />           .filename = &quot;rsrc.rc&quot;<br />           If .Execute &gt; 0 Then<br />'Compiling the recource file<br />              If &#40;CheckProcStatus&#40;rcprog, direct, rcpara, &quot;rsrc.res&quot;, &quot;Recource Compiling Error&quot;&#41;&#41; = False Then End<br />'Starting Resource to Object Convertor<br />              If &#40;CheckProcStatus&#40;cvprog, direct, cvpara, &quot;rsrc.obj&quot;, &quot;Recource To Object Converting Error&quot;&#41;&#41; = False Then End<br />LResource&#58;<br />           linkpara = linkparaRes<br />           End If<br />    End With<br /><br />'Compiling the asm file<br />       If &#40;CheckProcStatus&#40;mlprog, direct, mlpara, &#40;docum + &quot;.obj&quot;&#41;, &quot;Compiling Error&quot;&#41;&#41; = False Then End<br />'Linking the obj and res file<br />       If &#40;CheckProcStatus&#40;linkprog, direct, linkpara, &#40;docum + &quot;.exe&quot;&#41;, &quot;Link Error&quot;&#41;&#41; = False Then End<br />'Runing the exe file<br />       Call Shell&#40;&#40;docum + &quot;.exe&quot;&#41;, 1&#41;<br />End If<br />End Sub<br /><br />Public Function CheckProcStatus&#40;ByVal prog As String, ByVal directory As String, ByVal param As String, ByVal filename As String, ByVal mess As String&#41; As Boolean<br />Dim shellex As SHELLEXECUTEINFO<br /><br />CheckProcStatus = False     'by default-&gt;Return error<br />shellex.cbSize = 60<br />shellex.fMask = &amp;H40        'Public Const SEE_MASK_NOCLOSEPROCESS = &amp;H40<br />shellex.lpVerb = &quot;open&quot;<br />shellex.nShow = 1<br />shellex.lpFile = prog<br />shellex.lpParameters = param<br />        On Error GoTo Error<br />        Set fs = Application.FileSearch<br />    With fs<br />       .LookIn = directory<br />       .filename = filename<br />       If .Execute &gt; 0 Then Kill .filename              'Delete file if exist<br />       <br />    If ShellExecuteEx&#40;shellex&#41; = 0 Or shellex.hInstApp &lt; 33 Then GoTo Error<br /><br />Loop1&#58;                                                  'Loop<br />        Sleep &#40;500&#41;                                     'Wait 0.5 second<br />        M = GetExitCodeProcess&#40;shellex.hProcess, N1&#41;    'N1-&gt;status flag<br />    If N1 = &amp;H103 Then GoTo Loop1                       '&amp;H103=Still_Active &#40;process is&#41;<br /><br />    If .Execute &gt; 0 Then                                'Search new created file name<br />       CheckProcStatus = True                           'Return success<br />    Else<br />Error&#58;<br />       L = MsgBox&#40;&#40;mess + &quot;!&quot;&#41;, 0, &quot;Fatal error!&quot;&#41;      'Return error<br />   End If<br />End With<br />End Function</code></pre></div>
    <div class="meta">Posted on 2001-11-27 18:23:57 by buliaNaza</div>
   </div>
   <div class="post" id="post-13312">
    <div class="subject"><a href="#post-13312">ShellExecuteEx ask?</a></div>
    <div class="body">I use ShellExecuteEx, but my handle always = 0x00000000.<br /><br />and this function always return TRUE!<br /><br />:stupid:</div>
    <div class="meta">Posted on 2001-11-28 00:43:42 by bung</div>
   </div>
   <div class="post" id="post-13329">
    <div class="subject"><a href="#post-13329">Re: ShellExecuteEx ask?</a></div>
    <div class="body"><div class="quote"><em>Originally posted by bung </em><br />and this function always return TRUE!</div><br /><br />Hang on one moment.... you are complaining that it is failing, but not posting any details?<br /><br />When it returns TRUE, what is the value in the hInstApp member of the SHELLEXECUTEINFO struct? Is it 32 or below? And what do you have contained in the hProcess member of the same struct? And when you complain that your handle is NULL, what handle are you talking about?</div>
    <div class="meta">Posted on 2001-11-28 03:19:02 by sluggy</div>
   </div>
  </div>
 </body>
</html>