<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Proposed content of Ray Filiatrault's FP library - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9297" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=9297">Proposed content of Ray Filiatrault's FP library</a></p>
   <div class="post" id="post-68584">
    <div class="subject"><a href="#post-68584">Proposed content of Ray Filiatrault's FP library</a></div>
    <div class="body">This is the latest info that Ray has sent to me on the library that he is writing.<br /><br />Proposed list of functions for Fpu.lib:<br /><pre><code><br />Conversion functions&#58;<br />FpuAtoFL        Convert Alphanumeric to REAL10<br />FpuFLtoA        Convert REAL10 to Alphanumeric<br /><br />Arithmetic functions&#58;<br />FpuAdd          Add 2 numbers<br />FpuSub          Subtract 2 numbers<br />FpuMul          Multiply 2 numbers<br />FpuDiv          Divide 2 numbers<br />FpuSqrt         Extract square root of a number<br />FpuXexpY        Raise a number to an exponent<br />FpuAbs          Returns the absolute value of a number<br />FpuTrunc        Discards the decimal portion of a number<br />FpuRound        Rounds a number to the nearest integer<br /><br />Trigonometric functions&#58;<br />FpuSin          Sine of an angle<br />FpuCos          Cosine of an angle<br />FpuTan          Tangent of an angle<br />FpuArcsin       Angle corresponding to a sine<br />FpuArccos       Angle corresponding to a cosine<br />FpuArctan       Angle corresponding to a tangent<br /><br />Hyperbolic functions&#58;<br />FpuSinh         Hyperbolic sine of a number<br />FpuCosh         Hyperbolic cosine of a number<br />FpuTanh         Hyperbolic tangent of a number<br />FpuArcsinh      Number corresponding to a hyperbolic sine<br />FpuArccosh      Number corresponding to a hyperbolic cosine<br />FpuArctanh      Number corresponding to a hyperbolic tangent<br /><br />Logarithmic functions&#58;<br />FpuLnx          Napierian logarithm of a number<br />FpuLogx         Base 10 logarithm of a number<br /><br />Miscellaneous functions&#58;<br />FpuExam         Checks REAL10 for zero, sign, and absolute value less than 1<br />FpuSize         Returns the exponent as would appear in scientific notation<br /><br /><br />Proposed flexibility&#58;<br />-       Decimal strings in regular format or scientific notation will be allowed <br />for conversion to REAL10.<br />-       Regular format or scientific notation, and the number of decimal digits <br />will be allowed to be specified when converting from REAL10.<br />-       REAL10, LONG integers, and the FPU constants will be allowed as input <br />wherever appropriate.<br />-       Angle in degrees or radians will be allowed as input &#40;or output&#41; for the <br />trigonometric functions.<br />-       Results will be allowed to remain on the FPU or stored in memory wherever <br />appropriate.<br /><br /><br />Necessary restriction&#58;<br />-       Only one result will be allowed to remain on the FPU to be used <br />immediately with the following function.<br /><br /><br />Other restrictions&#58;<br />-       The total number of digits &#40;including leading 0's&#41; is limited to 18 in a <br />string to be converted to a REAL10.<br />-       The total number of digits returned when converting from a REAL10 to a <br />string is limited to 16.<br /></code></pre><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-12-02 06:02:42 by hutch--</div>
   </div>
   <div class="post" id="post-69188">
    <div class="subject"><a href="#post-69188">Proposed content of Ray Filiatrault's FP library</a></div>
    <div class="body">Just my first impression, but is it really worth implementing functions such as Add and Subtract for the obvious reason that you are wrapping an entire procedure round a single instruction.<br /><br />I realise that you can reply with, &quot;just cause its there, its doesn't have to be used&quot; and if someone is willing to stick the effot in to do it, I have no problem with that.<br /><br />But maybe a sensible compromise would be to use macros to implent the librarys functions (if it is nesscery for a function to be used such with as the FpuExam function (Use macros all round to maintain some sort of calling consistantcy)) , otherwise the macro could directly handle the task, such as adding two numbers.<br /><br />Just my quick first up thoughts<br />-huh</div>
    <div class="meta">Posted on 2002-12-05 03:37:32 by huh</div>
   </div>
   <div class="post" id="post-69885">
    <div class="subject"><a href="#post-69885">Proposed content of Ray Filiatrault's FP library</a></div>
    <div class="body">I think that it's time for me to get involved directly in this forum.<br /><br />First, the MAIN intent of the Fpulib is to provide a series of functions which will allow beginners in assembly programming to perform high precision maths before learning any of the intricacies and syntax of the FPU. <br /><br />When they become more familiar with assembly, they could then expand their knowledge to the FPU instructions. The commented source code for the Fpulib functions can then be used for learning and later streamlining their code.<br /><br />I do agree that a function like FpuAdd for adding two numbers may seem trivial to persons familiar with programming the FPU. However, to the uninitiated, there is a lot more to it than the simple &quot;fadd&quot; instruction.<br /><br />One has first to learn how to load the FPU registers with the two numbers, instructions being different for REAL and integer numbers, AND an indirect method must be used to load immediate numbers or the content of the CPU registers.<br /><br />One must also learn how to detect invalid operations such as could result even with the &quot;fadd&quot; instruction if one of the numbers is an undetected NAN carried over from a previous operation. Then, one has to learn how to transfer the result to memory, instructions being different for REAL and integer variable types. It may also be preferable to leave the result on the FPU.<br /><br />The Fpulib would make all these details transparent to the beginner (as with most high level languages). The only requirement would be to check the return value in EAX for the error code indicating an invalid operation.<br /><br />Overall, I would have a lot of difficulty incorporating all of the potential variables into a single properly working macro which would cover all situations!!! Furthermore, if such a complex macro is feasible, the entire macro code gets repeated in the assembled program every time the addition of two numbers (or other operation) is required, instead of only once when written as a procedure. <br /><br />A few more functions have been added to the list since the first posting. One is the FpuComp for comparing 2 numbers, another is the FpuChs to change the sign of a number. Also, the antilog functions FpuEexpX (e^x) and FpuTexpX (10^x) have been added; although the FpuXexpY (x^y) function could have been used, the new ones require one less parameter to be passed and are more efficient.<br /><br />FYI the library is effectively completed and the related Help file is almost completed. Remains the tedious task of testing each function thoroughly to insure proper performance under all the conditions enumerated in the Help file. Any volunteers for beta testing????<br /><br />Raymond</div>
    <div class="meta">Posted on 2002-12-08 16:20:15 by Raymond</div>
   </div>
   <div class="post" id="post-69984">
    <div class="subject"><a href="#post-69984">Proposed content of Ray Filiatrault's FP library</a></div>
    <div class="body">Hi <strong>Raymond</strong>,<br /><br />I agree with you on the &quot;teaching&quot; usefullness of the library, before<br />anything else. Coders can customize their code if needed, anyway.. and<br />beginners may benefit from the huge number of functions and the clear<br />way they're written.<br /><br />Just a thought.. you felt limited by the MACROs, which in the hands of<br />geniuses like <strong>bitRAKE</strong> can be very powerful tools, but can't do all the<br />miracles one needs anyway.<br /><br />So I'd like to propose a simple, common for us all, preprocessor. If we<br />all agree, it could be nice, and could be easily added to our assemblers<br />via batch files.<br /><br />Basically it would get in input asm sources, identify some key words,<br />pass as-is every text non identified, and instead expand the key words.<br />How would it expand the key words?<br /><br />Well, I thought about this: let our preprocessor program's name be<br />PPAsm (PreProcessAsm, or any other name we wish of course), it will<br />have a plug-ins directory. Each plug-in will identify one (or more)<br />keywords, and will contain a little program to expand them.<br /><br />Not as powerful as a compiler (which would be able to track the nearby<br />instructions to produce better code), but quite powerful. Imagine<br />something like this:<br /><pre><code><br />        MOV             ...<br />        &#91;..&#93;<br />        $MEMCPY.MM      EDI,ESI,ECX<br />        &#91;..&#93;<br />        ADD             ...<br /></code></pre><br />Where MEMCPY.MM gets expanded by some plug-in into code to perform a<br />memory copy between misaligned regions of memory.<br /><br />Or:<br /><pre><code><br />        $INVOKE         ...<br /></code></pre><br />Which generates optimized code (not the usual unoptimized list of<br />PUSHes as the INVOKE macro does).<br /><br />Or:<br /><pre><code><br />        $DIV            EAX,142,EBX<br /></code></pre><br />To perform &quot;magic division&quot; (as the tool <strong>The Svin</strong> created), generating<br />quick code to divide EAX by the constant 142, using EBX as temp register,<br />and will expand the line above to:<br /><pre><code><br />        MOV             EBX,3871519816<br />        INC             EAX<br />        MUL             EBX<br />        SHR             EBX,7<br />        MOV            EAX,EBX<br /></code></pre><br /><br />I'm sure that all the geniuses we have here would produce tons of useful<br />plugins that will expand this system in very useful ways; you could, for example,<br />produce some good FPU support.<br /><br />We could then specify the target assembler (MASM/TASM/FASM,etc..) for a<br />common code formatter (also to work in memory not with text, but with data<br />easier to manipulate), and other info, if necessary, inside the batch file, e.g.:<br /><br />PPAsm.EXE %1 MyASM<br />MyASM.EXE %1<br /><br />It would use the code formatter MyASM found in its directory Formatters.<br />The plug-ins may be either 32 bit binary files made with a small header<br />to import/use some functions from the main program, or whole EXE's.</div>
    <div class="meta">Posted on 2002-12-09 02:54:12 by Maverick</div>
   </div>
  </div>
 </body>
</html>