<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>GetPrivateProfileString problems; getting spaces at the end - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14247" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14247">GetPrivateProfileString problems; getting spaces at the end</a></p>
   <div class="post" id="post-110227">
    <div class="subject"><a href="#post-110227">GetPrivateProfileString problems; getting spaces at the end</a></div>
    <div class="body">I'm having problems getting the spaces at the end of a string value from an ini file.<br /><br />For example:<br /><br /><br />String1=This is string one with 5 spaces after it.     <br /><br />It stops at the period, anyone know why or how to solve the problem? :X<br /><br />Heres a simple test I threw.<br /><br />&gt;&gt; test.asm<br /><br />.486<br />.model flat,stdcall<br />option casemap:none<br /><br />include \masm32\include\windows.inc<br />include \masm32\macros\macros.asm<br />include \masm32\include\user32.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\masm32.inc<br /><br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\masm32.lib<br /><br />.data<br /><br />.data?<br />hInstance HINSTANCE ?<br />buffer db 2000 dup(?)<br /><br />.code<br />start:<br />	invoke GetModuleHandle,NULL<br />	mov    hInstance,eax<br />	<br />	invoke GetPrivateProfileString,SADD(&quot;Test&quot;),SADD(&quot;test&quot;),NULL,addr buffer,1024,SADD(&quot;D:\test.ini&quot;)<br />	invoke MessageBox,NULL,addr buffer,addr buffer,MB_OK<br /><br />	invoke ExitProcess,eax<br />end start<br /><br />&gt;&gt; D:\test.ini<br /><br />testbegin=xxx<br />test=testing...                                                                                     <br />testend=xxx</div>
    <div class="meta">Posted on 2003-07-12 16:40:36 by xkardisx</div>
   </div>
   <div class="post" id="post-110228">
    <div class="subject"><a href="#post-110228">GetPrivateProfileString problems; getting spaces at the end</a></div>
    <div class="body">MSDN:<br /><br />GetPrivateProfileString copies the default string to the lpReturnedString buffer. This parameter cannot be NULL. <br /><br />Avoid specifying a default string with trailing blank characters. The function inserts a null character in the lpReturnedString buffer to strip any trailing blanks.<br /><br />:(<br /><br />What's a way to work around this, or do I have to create my own INI parser?</div>
    <div class="meta">Posted on 2003-07-12 16:42:26 by xkardisx</div>
   </div>
   <div class="post" id="post-110250">
    <div class="subject"><a href="#post-110250">GetPrivateProfileString problems; getting spaces at the end</a></div>
    <div class="body">Here is an idea for a work-around.<br /><br />Say you have a key like this:<br /><br /><br />String1=This is string one with 5 spaces after it. <br /><br />Instead of the expecting spaces use _ Underscores.<br />Somthing that wont normally occur in the string.<br /><br />Like:<br /><br />String1=This is string one with 5 spaces after it. _____<br /><br />When you retrieve the string convert the underscores (or whatever)<br />to spaces.<br /><br />I did something like this is a keyword file that made the user specify the actual <br />number of spaces in a more descriptive way. like....<br /><br />_This_is_line__._<br /><br />So they were always aware the actual space count.<br /><br />This method has a bit of a hack feel.<br /><br />btw, writing your own ini parser isn't that difficult.<br /><br />RobotBob</div>
    <div class="meta">Posted on 2003-07-12 22:03:46 by RobotBob</div>
   </div>
   <div class="post" id="post-110258">
    <div class="subject"><a href="#post-110258">GetPrivateProfileString problems; getting spaces at the end</a></div>
    <div class="body">Oh I know its not hard. I just didn't want to, as I have other important thing to work out in the meantime. The reason I don't want to use _ or a temporary *, because basically my program uses an existing INI file that was generated by another program. That program (not made by me), probably uses its own INI routine because it reads the space. I want the INI to be able to work properly in both programs. :)</div>
    <div class="meta">Posted on 2003-07-13 00:07:49 by xkardisx</div>
   </div>
   <div class="post" id="post-110259">
    <div class="subject"><a href="#post-110259">GetPrivateProfileString problems; getting spaces at the end</a></div>
    <div class="body">Oh, If someone else doesn't think of another work-around and<br />you are forced to write your own ini parser...<br />Since you are crunched for time maybe some else here has a ready to go<br />ini parser you can use. <br /><br />Good luck<br /><br />RobotBob</div>
    <div class="meta">Posted on 2003-07-13 00:15:32 by RobotBob</div>
   </div>
   <div class="post" id="post-110261">
    <div class="subject"><a href="#post-110261">GetPrivateProfileString problems; getting spaces at the end</a></div>
    <div class="body">There is no workaround, using another character in place of the space can cause problems if you don't directly control the entries. Write a section parser using GetPrivateProfileSection to load the strings into a NULL terminated array. It is simply a matter of scanning forward for a '=' token and comparing values. Note that you are limited to 32767 characters in the buffer to load the section, that must be the maximum value you pass to the function as a buffer size as well.</div>
    <div class="meta">Posted on 2003-07-13 00:35:09 by donkey</div>
   </div>
  </div>
 </body>
</html>