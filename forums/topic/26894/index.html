<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Problem with GetOpenFileName - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26894" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26894">Problem with GetOpenFileName</a></p>
   <div class="post" id="post-193495">
    <div class="subject"><a href="#post-193495">Problem with GetOpenFileName</a></div>
    <div class="body">Hi
I wanted to use the CommonDialog for opening a File.
So I created an OPENFILENAME Struct to fill it with the stuff I need for the Dialog.
I declared it as follows:
ofn OPENFILENAME <>

Then I tried to fill in the needed information:
mov ofn.lStructSize, SIZEOF ofn
push hWin 
pop  ofn.hwndOwner
push HMODULE 
pop  ofn.hInstance 
mov ofn.lpstrFilter,OFFSET ofn_filter
mov ofn.nFilterIndex,1
mov ofn.lpstrFile,OFFSET ofn_buffer
mov ofn.nMaxFile,2048
mov ofn.lpstrTitle,OFFSET ofn_title
mov  ofn.Flags, OFN_FILEMUSTEXIST or \ 
                OFN_PATHMUSTEXIST or OFN_LONGNAMES or\ 
		OFN_EXPLORER or OFN_HIDEREADONLY 

I could fill in every part of it with exception of the hwndOwner and the hInstance I always got the following error:

gpx.asm(126) : error A2006: undefined symbol : hwndOwner
gpx.asm(128) : error A2006: undefined symbol : hInstance

Does anyone have an idea why this happens?
I just tried to solve the problem over 1 and a half hours. I don't know what to do anymore.

I hope one of you guys can help me

sign CyBerian</div>
    <div class="meta">Posted on 2001-02-14 13:28:00 by CyBerian</div>
   </div>
   <div class="post" id="post-193496">
    <div class="subject"><a href="#post-193496">Problem with GetOpenFileName</a></div>
    <div class="body">hmmm
I got the error already :)

sign CyBerian</div>
    <div class="meta">Posted on 2001-02-14 14:07:00 by CyBerian</div>
   </div>
  </div>
 </body>
</html>