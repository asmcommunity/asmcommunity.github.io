<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Probs with MUL - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=11842" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=11842">Probs with MUL</a></p>
   <div class="post" id="post-90574">
    <div class="subject"><a href="#post-90574">Probs with MUL</a></div>
    <div class="body">Hello, why the SetTimer dosn't accept the EAX/EDX value after multiply ?<br /><br />                          INVOKE atodw,ADDR EQU_Time<br />                          mov edx,60000<br />                          mul edx<br />                          INVOKE SetTimer, hDlg, 1, edx, NULL<br /><br />:confused: :confused: :confused: :confused: :confused: <br /><br />Greets Forginforcer</div>
    <div class="meta">Posted on 2003-03-26 11:56:52 by Forginforcer</div>
   </div>
   <div class="post" id="post-90583">
    <div class="subject"><a href="#post-90583">Probs with MUL</a></div>
    <div class="body">mul returns a 64 bit result in eax:edx. So edx is overwritten (probably with 0, if the resulting number isn't larger than 32 bits).</div>
    <div class="meta">Posted on 2003-03-26 12:10:06 by Qweerdy</div>
   </div>
   <div class="post" id="post-90585">
    <div class="subject"><a href="#post-90585">Huhu !</a></div>
    <div class="body">I know, but EAX isnt useable too.<br /><br />:confused: :confused: :confused:</div>
    <div class="meta">Posted on 2003-03-26 12:16:10 by Forginforcer</div>
   </div>
   <div class="post" id="post-90601">
    <div class="subject"><a href="#post-90601">Probs with MUL</a></div>
    <div class="body">What do you mean by EAX is not useable?</div>
    <div class="meta">Posted on 2003-03-26 12:57:05 by Odyssey</div>
   </div>
   <div class="post" id="post-90604">
    <div class="subject"><a href="#post-90604">Probs with MUL</a></div>
    <div class="body">INVOKE SetTimer, hDlg, 1, eax, NULL<br /><br />INVOKE atodw,ADDR EQU_Time<br />mov edx,60000<br />mul edx<br />INVOKE SetTimer, hDlg, 1, eax, NULL</div>
    <div class="meta">Posted on 2003-03-26 13:03:43 by Forginforcer</div>
   </div>
   <div class="post" id="post-90611">
    <div class="subject"><a href="#post-90611">Probs with MUL</a></div>
    <div class="body">I still don't understand what you mean. Is the settimer function returning 0?</div>
    <div class="meta">Posted on 2003-03-26 13:24:14 by Odyssey</div>
   </div>
   <div class="post" id="post-90614">
    <div class="subject"><a href="#post-90614">Probs with MUL</a></div>
    <div class="body">hmmm, how to get the right value ?</div>
    <div class="meta">Posted on 2003-03-26 13:33:27 by Forginforcer</div>
   </div>
   <div class="post" id="post-90616">
    <div class="subject"><a href="#post-90616">Probs with MUL</a></div>
    <div class="body">quote from api reference on SetTimer function <br /><br />Return Values<br /><br />If the function succeeds, the return value is an integer identifying the new timer. An application can pass this value, or the string identifier, if it exists, to the KillTimer function to destroy the timer. If the function fails to create a timer, the return value is zero.</div>
    <div class="meta">Posted on 2003-03-26 13:35:01 by Odyssey</div>
   </div>
   <div class="post" id="post-90617">
    <div class="subject"><a href="#post-90617">Probs with MUL</a></div>
    <div class="body">The compile dont accept this:<br />INVOKE SetTimer, hDlg, 1, eax, NULL</div>
    <div class="meta">Posted on 2003-03-26 13:38:23 by Forginforcer</div>
   </div>
   <div class="post" id="post-90622">
    <div class="subject"><a href="#post-90622">Probs with MUL</a></div>
    <div class="body">What assembler are you using? What is the error message you get?</div>
    <div class="meta">Posted on 2003-03-26 13:49:06 by Odyssey</div>
   </div>
   <div class="post" id="post-90644">
    <div class="subject"><a href="#post-90644">Probs with MUL</a></div>
    <div class="body">And which &quot;atodw&quot; function are you using? The one from the MASM32 library?<br /><br />Hutch:<br />The &quot;atodw&quot; function in the MASM32 library has the following code for loading ESI with the address of the string:<br /><strong>mov esi, </strong><br />Does that assemble properly with MASM?<br /><br />Raymond</div>
    <div class="meta">Posted on 2003-03-26 14:56:06 by Raymond</div>
   </div>
   <div class="post" id="post-90646">
    <div class="subject"><a href="#post-90646">Probs with MUL</a></div>
    <div class="body">Hi Red,<br /><br />We went over this already, you asked the same thing in <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=11716&amp;highlight=EQUTime">this thread</a>  and I explained the problems with your original proc. The one I supplied you works, are you passing a string to the atodw proc ? Did you find a book or text on the difference between numbers and strings ? <br /><br />What is the problem you are having with the proc, post all the relavant data - where you are getting the data for the EQU_Time variable, what the compiler error is that you get and what results you get if you are able to compile.<br /><br />Donkey</div>
    <div class="meta">Posted on 2003-03-26 15:05:40 by donkey</div>
   </div>
   <div class="post" id="post-90794">
    <div class="subject"><a href="#post-90794">Probs with MUL</a></div>
    <div class="body">That should be my code, but it doesnt work:<br /><br />I dont know, wich variable type I have to choose with EQU_Time.<br /><br />				INVOKE GetDlgItemText, hDlg, IDC_EDIT1, EQU_Time, 2<br />                        invoke atodw,ADDR EQU_Time<br />                        mov edx,60000<br />                        mul edx<br />                        INVOKE SetTimer, hDlg, 1, eax, NULL<br /><br /><br />Bye...</div>
    <div class="meta">Posted on 2003-03-27 00:25:06 by Forginforcer</div>
   </div>
   <div class="post" id="post-90920">
    <div class="subject"><a href="#post-90920">Probs with MUL</a></div>
    <div class="body"><div class="quote">INVOKE GetDlgItemText, hDlg, IDC_EDIT1, EQU_Time, 2<br />invoke atodw,ADDR EQU_Time</div>For the first function call you use the content of the variable <strong>EQU_Time</strong> as a parameter. In the very next function call you use its address as the parameter.<br /><br />I would strongly recommend that you download the Win32 Programmers' Reference and study <strong><u>IN DETAIL</strong></u> the requirements of each function you intend to call and understand which parameters are required.<br /><br />You should then have much less problems with your code.<br /><br />Raymond</div>
    <div class="meta">Posted on 2003-03-27 11:10:16 by Raymond</div>
   </div>
   <div class="post" id="post-90923">
    <div class="subject"><a href="#post-90923">Probs with MUL</a></div>
    <div class="body">Red,<br /><br />You consistently ignore everything that I have shown you. If I have put ADDR in front of a parameter it is because that is required in the context you are using. In my original example I demonstrated it this way :<div class="quote"><strong><pre><code>.data<br />; Create a string buffer to hold the text from the edit control<br />EQU_Time BYTE 4 DUP &#40;0&#41; ; you only read 2 bytes so make it 4 long for the null terminator + alignment<br /><br />.Code<br />&#91;i&#93;; copy the text from the edit control into your string buffer&#91;/i&#93;<br />INVOKE GetDlgItemText, hDlg, IDC_EDIT1, &#91;COLOR=red&#93;ADDR EQU_time&#91;/COLOR&#93;, 2<br />&#91;i&#93;; convert the string in the buffer to a numeric DWORD value&#91;/i&#93;<br />invoke atodw,ADDR EQU_Time<br />&#91;i&#93;; perform the math in one operation instead of splitting it in two&#91;/i&#93;<br />mov edx,60000<br />mul edx<br />&#91;i&#93;; The result is in EAX you cannot use it in EQU_Time as that is a &#91;COLOR=red&#93;String&#91;/COLOR&#93; buffer&#91;/i&#93;</code></pre></div>Why did you remove the ADDR from the example ? Was there a specific reason for this ?<br /><br />EDIT : Added the rest of the example and code tags</div>
    <div class="meta">Posted on 2003-03-27 11:37:48 by donkey</div>
   </div>
  </div>
 </body>
</html>