<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Dll userspace??? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18324" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18324">Dll userspace???</a></p>
   <div class="post" id="post-141971">
    <div class="subject"><a href="#post-141971">Dll userspace???</a></div>
    <div class="body">I just wanted to ask a simple question here:<br /><br />when we load the dll in our program using LoadLibrary is it shared system wide i.e can another application<br /><br />get my function in the dll using GetProcAddress ??<br /><br />If not then how do i share my dll system wide such that when my dll is loaded by my application all the<br /><br />process currenly running can directly access and they dont need to load it first to access it :confused: <br /><br />Also how can i get the process-id of a currently running process other than mine??<br /><br />Thankx for reading :grin:</div>
    <div class="meta">Posted on 2004-05-24 07:52:48 by telophase</div>
   </div>
   <div class="post" id="post-141972">
    <div class="subject"><a href="#post-141972">Dll userspace???</a></div>
    <div class="body">Use the following registry key:<br /><br /><pre><code>HKEY_LOCAL_MACHINE\Software\Microsoft\<br />Windows NT\CurrentVersion\Windows\AppInit_DLLs<br /></code></pre>The value for this key might contain a single DLL filename or a set of DLL filenames (separated by spaces or commas)<br /><br />Regards,<br />Opcode</div>
    <div class="meta">Posted on 2004-05-24 08:10:34 by Opcode</div>
   </div>
   <div class="post" id="post-141973">
    <div class="subject"><a href="#post-141973">Re: Dll userspace???</a></div>
    <div class="body"><div class="quote"><em>Originally posted by telophase </em><br />Also how can i get the process-id of a currently running process other than mine??<br /></div>Use the <strong>Search</strong> button of this forum :grin:<br /><br />Opcode</div>
    <div class="meta">Posted on 2004-05-24 08:12:48 by Opcode</div>
   </div>
   <div class="post" id="post-141976">
    <div class="subject"><a href="#post-141976">Interesting....</a></div>
    <div class="body">But that means that i will have to do it via the registry :( <br /><br />No other alternative that you can think of??<br /><br />And i can get address using getmodulehandle right??<br /><br />But will the system have to restart to do this or can i do it without ending the current session?</div>
    <div class="meta">Posted on 2004-05-24 08:23:28 by telophase</div>
   </div>
   <div class="post" id="post-141978">
    <div class="subject"><a href="#post-141978">Dll userspace???</a></div>
    <div class="body">Yes, there are other methods.<br /><br />They are listed in the book <br /><strong>Programming applications for Microsoft Windows</strong> from Jeffrey Richter.<br />and are more methods that you can find using Google.<br /><br />And unfortunately you will need to reboot to use this registry trick.<br /><br />Regards,<br />Opcode</div>
    <div class="meta">Posted on 2004-05-24 09:02:30 by Opcode</div>
   </div>
   <div class="post" id="post-141979">
    <div class="subject"><a href="#post-141979">had a problem compiling the dll</a></div>
    <div class="body">I added a shortcut to the Masm GUI menu to point to my batch file so that i can get the dll directly from<br /><br />the menu itself but when i compile it that way i get only the .obj file and i cant seem to get the .lib and .dll<br /><br />files. Please take a look:<br />;compile_dll.bat<br /><br />\masm32\bin\ml /c /coff /Cp %1.asm<br /><br />Link /DLL /DEF:%1.def /SUBSYSTEM:WINDOWS /LIBPATH:f:\masm32\lib %1.obj<br /><br />del %1.exp<br /><br />exit</div>
    <div class="meta">Posted on 2004-05-24 09:10:40 by telophase</div>
   </div>
   <div class="post" id="post-141980">
    <div class="subject"><a href="#post-141980">One more thing</a></div>
    <div class="body">If i am using LoadLibraryA to load a DLL and if i dont unload it using UnloadLibrary then will that<br /><br />library be resident in the memory till the machine shut's down or restarts??</div>
    <div class="meta">Posted on 2004-05-24 09:31:19 by telophase</div>
   </div>
  </div>
 </body>
</html>