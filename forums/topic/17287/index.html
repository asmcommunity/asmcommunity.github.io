<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>I think it's wrong .... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17287" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=17">Iczelion's Tutorials</a> &raquo; <a href="../?id=17287">I think it's wrong ....</a></p>
   <div class="post" id="post-133972">
    <div class="subject"><a href="#post-133972">I think it's wrong ....</a></div>
    <div class="body">Hello this is from tutorial 5 of iczelion's:<br /><br />.<br />..<br />...<br />invoke CreateFont,24,16,0,0,400,0,0,0,OEM_CHARSET,\ <br />                                       OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,\ <br />                                       DEFAULT_QUALITY,DEFAULT_PITCH or FF_SCRIPT,\ <br />                                       ADDR FontName <br />        invoke SelectObject, hdc, eax <br />        mov    hfont,eax <br />        RGB    200,200,50 <br />        invoke SetTextColor,hdc,eax <br />        RGB    0,0,255 <br />        invoke SetBkColor,hdc,eax <br />        invoke TextOut,hdc,0,0,ADDR TestString,SIZEOF TestString <br />        invoke SelectObject,hdc, hfont <br />...<br />..<br />.<br /><br />I think that in there are 1 or 2  things wrong. <br />1st)Never 'unselect' the handle of the font from the DC<br />2nd)Never delete the dc<br /><br />Should'nt be like this?:<br />invoke CreateFont,24,16,0,0,400,0,0,0,OEM_CHARSET,\ <br />                                       OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,\ <br />                                       DEFAULT_QUALITY,DEFAULT_PITCH or FF_SCRIPT,\ <br />                                       ADDR FontName <br />        invoke SelectObject, hdc, eax <br />        push eax;save previous font handle<br />        mov    hfont,eax <br />        RGB    200,200,50 <br />        invoke SetTextColor,hdc,eax <br />        RGB    0,0,255 <br />        invoke SetBkColor,hdc,eax <br />        invoke TextOut,hdc,0,0,ADDR TestString,SIZEOF TestString <br />        pop eax<br />        invoke SelectObject,hdc, eax;restore previous font<br />        invoke DeleteObject,hfont<br /><br />and from the tutorial 26:<br /><br />..<br />.elseif uMsg==WM_PAINT <br />                invoke BeginPaint,hWnd,addr ps <br />                mov hdc,eax <br />                invoke CreateCompatibleDC,hdc <br />                mov hMemoryDC,eax <br />                invoke SelectObject,eax,hBitMap <br />                mov hOldBmp,eax <br />                invoke GetObject,hBitMap,sizeof BITMAP,addr bitmap <br />                invoke StretchBlt,hdc,0,0,250,250,\ <br />                       hMemoryDC,0,0,bitmap.bmWidth,bitmap.bmHeight,SRCCOPY <br />                invoke SelectObject,hMemoryDC,hOldBmp <br />                invoke DeleteDC,hMemoryDC <br />                invoke EndPaint,hWnd,addr ps <br />..<br />its not wrong, but cant i do this?:<br />.elseif uMsg==WM_PAINT <br />                invoke BeginPaint,hWnd,addr ps <br />                mov hdc,eax <br />                invoke CreateCompatibleDC,hdc <br />                mov hMemoryDC,eax <br />                invoke SelectObject,eax,hBitMap <br />;                mov hOldBmp,eax <br />                invoke GetObject,hBitMap,sizeof BITMAP,addr bitmap <br />                invoke StretchBlt,hdc,0,0,250,250,\ <br />                       hMemoryDC,0,0,bitmap.bmWidth,bitmap.bmHeight,SRCCOPY <br />;                invoke SelectObject,hMemoryDC,hOldBmp <br />                invoke DeleteDC,hMemoryDC <br />                invoke EndPaint,hWnd,addr ps<br /><br />anyway the memory dc will be deleted and the hBitMap will be automatically 'Unselected', i think.<br />is this ok?<br /><br />(sorry my english)<br />____________________Hugo Mauricio Prado Macat</div>
    <div class="meta">Posted on 2004-02-17 23:26:25 by mauricioprado</div>
   </div>
   <div class="post" id="post-133979">
    <div class="subject"><a href="#post-133979">I think it's wrong ....</a></div>
    <div class="body">The PlatformSDK clearly states:<br /><div class="quote"><br />An application should always replace a new object with the original, default object after it has finished drawing with the new object. <br /></div><br />And yes, you <strong>will</strong> get leaks if you don't follow this, and GDI leaks is a thing you do *NOT* want, especially if you expect your application to run on crappy old Win9x.</div>
    <div class="meta">Posted on 2004-02-18 01:03:35 by f0dder</div>
   </div>
   <div class="post" id="post-136584">
    <div class="subject"><a href="#post-136584">I think it's wrong ....</a></div>
    <div class="body"><div class="quote"><br />Hello this is from tutorial 5 of iczelion's:<br /><br />.<br />..<br />...<br />invoke CreateFont,24,16,0,0,400,0,0,0,OEM_CHARSET,\ <br />OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,\ <br />DEFAULT_QUALITY,DEFAULT_PITCH or FF_SCRIPT,\ <br />ADDR FontName <br />invoke SelectObject, hdc, eax <br />mov hfont,eax <br />RGB 200,200,50 <br />invoke SetTextColor,hdc,eax <br />RGB 0,0,255 <br />invoke SetBkColor,hdc,eax <br />invoke TextOut,hdc,0,0,ADDR TestString,SIZEOF TestString <br />invoke SelectObject,hdc, hfont <br />...<br />..<br />.<br /><br />I think that in there are 1 or 2 things wrong. <br />1st)Never 'unselect' the handle of the font from the DC<br />2nd)Never delete the dc<br /><br />Should'nt be like this?:<br />invoke CreateFont,24,16,0,0,400,0,0,0,OEM_CHARSET,\ <br />OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,\ <br />DEFAULT_QUALITY,DEFAULT_PITCH or FF_SCRIPT,\ <br />ADDR FontName <br />invoke SelectObject, hdc, eax <br />push eax;save previous font handle<br />mov hfont,eax <br />RGB 200,200,50 <br />invoke SetTextColor,hdc,eax <br />RGB 0,0,255 <br />invoke SetBkColor,hdc,eax <br />invoke TextOut,hdc,0,0,ADDR TestString,SIZEOF TestString <br />pop eax<br />invoke SelectObject,hdc, eax;restore previous font<br />invoke DeleteObject,hfont<br /></div><br /><br />i know what he think!<br /><br />it should be this<br /><br />invoke CreateFont,24,16,0,0,400,0,0,0,OEM_CHARSET,\ <br />OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,\ <br />DEFAULT_QUALITY,DEFAULT_PITCH or FF_SCRIPT,\ <br />ADDR FontName <br />invoke SelectObject, hdc, eax <br />push eax;save previous font handle<br />RGB 200,200,50 <br />invoke SetTextColor,hdc,eax <br />RGB 0,0,255 <br />invoke SetBkColor,hdc,eax <br />invoke TextOut,hdc,0,0,ADDR TestString,SIZEOF TestString <br />pop eax<br />invoke SelectObject,hdc, eax;restore previous font<br />invoke DeleteObject,eax</div>
    <div class="meta">Posted on 2004-03-21 07:08:55 by tomorrow</div>
   </div>
  </div>
 </body>
</html>