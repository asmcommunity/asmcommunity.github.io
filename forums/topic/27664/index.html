<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>SAFEARRAY - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27664" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27664">SAFEARRAY</a></p>
   <div class="post" id="post-197406">
    <div class="subject"><a href="#post-197406">SAFEARRAY</a></div>
    <div class="body">Has anybody samples of using SAFEARRAY in assembly programs?</div>
    <div class="meta">Posted on 2001-04-16 01:24:00 by vkim</div>
   </div>
   <div class="post" id="post-197407">
    <div class="subject"><a href="#post-197407">SAFEARRAY</a></div>
    <div class="body">A SAFEARRAY is an automation (or COM or ActiveX) data type. SAFEARRAY is a structure for storing arrays of arbitrary complexity.  Not only does it allow multidimensional arrays, but it provides a SAFEARRAYBOUND instance for each dimension to describe the starting index (unlike C++ arrays, SAFEARRAYs don't have to be zero-based) and number of elements.  The SAFEARRAY and SafeArrayXXXX COM runtime methods are documented in the Automation Programmer's Guide.  

I've not seen any asm code on it, but MSDN has lots of C code defining how to declare and manipulate one.

Basically, stick to the provided API's to work with these beasts, don't try to manipulate them directly or one day your code might break.</div>
    <div class="meta">Posted on 2001-04-16 07:23:00 by Ernie</div>
   </div>
   <div class="post" id="post-197408">
    <div class="subject"><a href="#post-197408">SAFEARRAY</a></div>
    <div class="body">Ernie, thank you very much!
Visual Basic allows to use dinamic arrays. For example:
<pre><code>
Dim intValue() As Integer
Dim i as Integer
i = 10
Redim Preserve intValue(i)
</code></pre>
How can I do the same in my assembly program? I think VB uses SafeArray... functions.</div>
    <div class="meta">Posted on 2001-04-16 07:59:00 by vkim</div>
   </div>
   <div class="post" id="post-197409">
    <div class="subject"><a href="#post-197409">SAFEARRAY</a></div>
    <div class="body">I don't know anything about SAFEARRAYs, but if you just want to use dynamic arrays, allocate the memory needed for the array with GlobalAlloc, then when you want to redefine the array, use GlobalReAlloc to change the size of the allocated memory block. 

Thomas</div>
    <div class="meta">Posted on 2001-04-16 13:12:00 by Thomas</div>
   </div>
   <div class="post" id="post-197410">
    <div class="subject"><a href="#post-197410">SAFEARRAY</a></div>
    <div class="body">vkim,

  I took the liberty of emailing you some Safearray info. I found an article in this area of MSDN most helpful with dealing with BSTR's.

  Anyone else interested, either post your email here or email me direct.


-----------------------------
"The only danger in space is if we land on the terrible Planet of the Apes...wait a minute...Statue of Liberty ... that was our planet! You maniacs! You blew it up! Damn you! Damn you all to hell!"</div>
    <div class="meta">Posted on 2001-04-16 23:12:00 by Ernie</div>
   </div>
   <div class="post" id="post-197411">
    <div class="subject"><a href="#post-197411">SAFEARRAY</a></div>
    <div class="body">Thanks again!
It's a very useful article. And I very love Bruce McKinney's writings, especially his book "Hardcore Visual Basic". Thanks a lot!</div>
    <div class="meta">Posted on 2001-04-16 23:45:00 by vkim</div>
   </div>
  </div>
 </body>
</html>