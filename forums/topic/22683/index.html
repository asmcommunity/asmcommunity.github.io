<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Problem:using masm32 to develop xll  - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22683" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22683">Problem:using masm32 to develop xll </a></p>
   <div class="post" id="post-170020">
    <div class="subject"><a href="#post-170020">Problem:using masm32 to develop xll </a></div>
    <div class="body">Hi,everybody!<br />i am trying to develop an Excel add-in using masm32<br />now,my xll could be loaded by Excel and perform some simple task like:<br />invoke XLCallVer <br />invoke Excel4,xlcAlert,0,1,addr xl_str&nbsp; ;xl_str is an address of a xltypeStr XLOPER<br /><br />Here is the XLOPER structure i made according to frmwrk32(the excel sdk):<br />;/*<br />;** XLREF structure <br />;**<br />;** Describes a single rectangular reference<br />;*/<br />xlref	struct<br />		rwFirst			word		?<br />		rwLast		&nbsp; &nbsp; &nbsp;  word		?<br />		colFirst		 byte		?<br />		colLast		&nbsp; &nbsp; &nbsp; &nbsp; byte		?<br />xlref ends<br /><br />;/*<br />;** XLMREF structure<br />;**<br />;** Describes multiple rectangular references.<br />;** This is a variable size structure, default <br />;** size is 1 reference.<br />;*/<br />xlmref	struct<br />		count			word		?			<br />		reftbl		&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xlref		&nbsp; &lt;&gt;<br />xlmref	ends <br /><br />;/*<br />;** XLOPER structure <br />;**<br />;** Excel&#39;s fundamental data type: can hold data<br />;** of any type. Use &quot;R&quot; as the argument type in the <br />;** REGISTER function.<br />;**/<br />&nbsp; &nbsp; &nbsp; &nbsp; sref_	struct&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; count		word		?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* always = 1 */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ref			&nbsp; xlref		&nbsp; &lt;&gt;;<br />&nbsp; &nbsp; &nbsp; &nbsp; sref_	ends;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* xltypeSRef */&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; mref_	struct <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpmref		 dword		?;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; idSheet		dword		?;<br />&nbsp; &nbsp; &nbsp; &nbsp; mref_	ends												;/* xltypeSRef */<br />&nbsp; &nbsp; &nbsp; &nbsp; array_	struct <br />	&nbsp; &nbsp; lparray		dword		 ?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rows		word		 ?;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; columns	&nbsp; &nbsp; &nbsp;  word	&nbsp; &nbsp; &nbsp;  ?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; array_	ends;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeMulti */ <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; valflow_	union <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; level		word		?;&nbsp; &nbsp; &nbsp; &nbsp; /* xlflowRestart */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; tbctrl	&nbsp; &nbsp; &nbsp; &nbsp; word		?;&nbsp; &nbsp; &nbsp;  /* xlflowPause */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; idSheet	&nbsp; &nbsp; &nbsp;  dword		?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xlflowGoto */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; valflow_	ends&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; flow_	struct <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; valflow valflow_	&lt;&gt;&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; rw			word			?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xlflowGoto */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; col			 byte			?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* xlflowGoto */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xlflow	&nbsp; &nbsp; &nbsp; &nbsp; byte			?;<br />&nbsp; &nbsp; &nbsp; &nbsp; flow_	ends;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* xltypeFlow */&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h_	union&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lpbData		dword		?;&nbsp; &nbsp; &nbsp; /* data passed to XL */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hdata			dword		?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* data returned from XL */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h_ 	ends&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; bigdata_	struct <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; h					h_			&lt;&gt;&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cbData		dword		?;&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; bigdata_	ends;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeBigData */ <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; val_	union <br />&nbsp; &nbsp; &nbsp; &nbsp; num				DOUBLE		?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeNum */<br />&nbsp; &nbsp; &nbsp; &nbsp; str_			dword			?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeStr */<br />&nbsp; &nbsp; &nbsp; &nbsp; bool			word			?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeBool */<br />&nbsp; &nbsp; &nbsp; &nbsp; err			word			?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeErr */<br />&nbsp; &nbsp; &nbsp; &nbsp; w			word			?;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeInt */<br />	sref			sref_			&lt;&gt;<br />	mref			mref_			&lt;&gt;<br />	array			array_		&lt;&gt;<br />	flow			flow_			&lt;&gt;<br />	bigdata		&nbsp; &nbsp; &nbsp; bigdata_ 	&nbsp; &nbsp; &nbsp; &nbsp;  &lt;&gt;<br />&nbsp; &nbsp; val_ 	ends&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />xloper struct<br />		val&nbsp; 		val_		&lt;&gt;<br />		xltype	&nbsp; &nbsp; &nbsp;  word		?<br />xloper	ends<br /><br />and the sdk xloper structure(C++ version):<br /><br />/*<br />** XLREF structure <br />**<br />** Describes a single rectangular reference<br />*/<br /><br />typedef struct xlref <br />{<br />&nbsp; &nbsp; WORD rwFirst;<br />&nbsp; &nbsp; WORD rwLast;<br />&nbsp; &nbsp; BYTE colFirst;<br />&nbsp; &nbsp; BYTE colLast;<br />} XLREF, FAR *LPXLREF;<br /><br /><br />/*<br />** XLMREF structure<br />**<br />** Describes multiple rectangular references.<br />** This is a variable size structure, default <br />** size is 1 reference.<br />*/<br /><br />typedef struct xlmref <br />{<br />&nbsp; &nbsp; WORD count;<br />&nbsp; &nbsp; XLREF reftbl[1];&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* actually reftbl */<br />} XLMREF, FAR *LPXLMREF;<br /><br /><br />/*<br />** XLOPER structure <br />**<br />** Excel&#39;s fundamental data type: can hold data<br />** of any type. Use &quot;R&quot; as the argument type in the <br />** REGISTER function.<br />**/<br /><br />typedef struct xloper <br />{<br />&nbsp; &nbsp; union <br />&nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; double num;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* xltypeNum */<br />&nbsp; &nbsp; &nbsp; &nbsp; LPSTR str;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeStr */<br />&nbsp; &nbsp; &nbsp; &nbsp; WORD bool;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeBool */<br />&nbsp; &nbsp; &nbsp; &nbsp; WORD err;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* xltypeErr */<br />&nbsp; &nbsp; &nbsp; &nbsp; short int w;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeInt */<br />&nbsp; &nbsp; &nbsp; &nbsp; struct <br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WORD count;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* always = 1 */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; XLREF ref;<br />&nbsp; &nbsp; &nbsp; &nbsp; } sref;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* xltypeSRef */<br />&nbsp; &nbsp; &nbsp; &nbsp; struct <br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; XLMREF far *lpmref;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DWORD idSheet;<br />&nbsp; &nbsp; &nbsp; &nbsp; } mref;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* xltypeRef */<br />&nbsp; &nbsp; &nbsp; &nbsp; struct <br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; struct xloper far *lparray;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WORD rows;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WORD columns;<br />&nbsp; &nbsp; &nbsp; &nbsp; } array;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeMulti */<br />&nbsp; &nbsp; &nbsp; &nbsp; struct <br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; union<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; short int level;&nbsp; &nbsp; &nbsp; &nbsp; /* xlflowRestart */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; short int tbctrl;&nbsp; &nbsp; &nbsp;  /* xlflowPause */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DWORD idSheet;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xlflowGoto */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } valflow;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WORD rw;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xlflowGoto */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BYTE col;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* xlflowGoto */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BYTE xlflow;<br />&nbsp; &nbsp; &nbsp; &nbsp; } flow;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* xltypeFlow */<br />&nbsp; &nbsp; &nbsp; &nbsp; struct<br />&nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; union<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BYTE far *lpbData;&nbsp; &nbsp; &nbsp; /* data passed to XL */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; HANDLE hdata;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  /* data returned from XL */<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } h;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; long cbData;<br />&nbsp; &nbsp; &nbsp; &nbsp; } bigdata;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* xltypeBigData */<br />&nbsp; &nbsp; } val;<br />&nbsp; &nbsp; WORD xltype;<br />} XLOPER, FAR *LPXLOPER;<br /><br />when i was trying to use xltypeMulti XLOPER to create dialog by calling xlfDialogBox Excel function,it returned xlretInvXloper(the xloper i provided is invalid),i don&#39;t know why!<br />here is the code:<br /><br />.data<br />		;the null string<br />									align 4<br />		str_null			db		&#39; &#39;,0<br />		<br />		;number string <br />									align 4									<br />		str_1				db		&#39; 1&#39;,0<br />									align 4									<br />		str_2				db		&#39; 2&#39;,0	<br />									align 4									<br />		str_5				db		&#39; 5&#39;,0<br />									align 4									<br />		str_11				db		&#39; 11&#39;,0	<br />									align 4									<br />		str_19				db		&#39; 19&#39;,0					<br />									align 4									<br />		str_88				db		&#39; 88&#39;,0				<br />									align 4									<br />		str_174				db		&#39; 174&#39;,0		<br />									align 4									<br />		str_210				db		&#39; 210&#39;,0<br />									align 4									<br />		str_225				db		&#39; 225&#39;,0		<br />									align 4									<br />		str_330				db		&#39; 330&#39;,0					<br />									align 4									<br />		str_494			&nbsp; &nbsp; &nbsp; db		&#39; 494&#39;,0<br />		<br />									align 4									<br />		str_Name		&nbsp; &nbsp;  db		&#39; Name&#39;,0<br />		<br />									align 4									<br />		str_dl				db		&#39; Login&#39;,0		<br />									align 4									<br />		str_dlsjk			db		&#39; Database Login&#39;,0					<br />									align 4									<br />		str_qx				db		&#39; Cancel&#39;,0<br /><br />		;the array 7*3 rows<br />									align 4	<br />		xa_login	&nbsp; &nbsp;  dword		&nbsp; &nbsp;  offset	&nbsp; &nbsp;  str_null<br />					dword			offset		str_null<br />					dword			offset		str_null<br />					dword			offset		str_494<br />					dword			offset		str_210<br />					dword			offset		str_dlsjk<br />					dword			offset		str_null<br />					dword			offset		str_1<br />					dword			offset		str_330<br />					dword			offset		str_174<br />					dword			offset		str_88<br />					dword			offset		str_null<br />					dword			offset		str_dl<br />					dword			offset		str_null<br />					dword			offset		str_2<br />					dword			offset		str_225<br />					dword			offset		str_174<br />					dword			offset		str_88<br />					dword			offset		str_null<br />					dword			offset		str_qx<br />					dword			offset		str_null<br />.code<br /><br />;the function Fillxloper put the string array into xloper array<br />;px is the address of xloper array,pa is the string array<br />FillXloper		proc	 uses ebx esi edi px,pa,rows<br />		mov esi,pa<br />		mov edi,px<br />		assume edi:ptr xloper<br />		.while rows&gt;0																												<br />				.if dword ptr ==offset str_null&nbsp; ;empty string<br />						mov .xltype,xltypeNil<br />				.else<br />						mov .xltype,xltypeStr<br />						mov eax,dword ptr <br />						mov .val.str_,eax		<br />				.endif<br />				add esi,4<br />				add edi,sizeof xloper<br />				dec rows				<br />		.endw<br />		assume edi:nothing<br />		ret <br />FillXloper		endp<br /><br />;here is the code to create a dialog<br />Login		proc<br />		local	pxLoginArray:ptr,hxLoginArray:ptr<br />		local	pxLogin:ptr,hxLogin:ptr<br />		local	pxLoginRet:ptr,hxLoginRet:ptr<br />		<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;allocate memory for the xloper array		<br />		invoke GlobalAlloc,GMEM_MOVEABLE,(sizeof xloper)*7*3<br />		mov hxLoginArray,eax<br />		invoke GlobalLock,eax<br />		mov pxLoginArray,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;the xltypeMulti xloper to be passed to Excel4 function<br />		invoke GlobalAlloc,GMEM_MOVEABLE,sizeof xloper<br />		mov hxLogin,eax<br />		invoke GlobalLock,eax<br />		mov pxLogin,eax		<br />		<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;the return xloper to be passed to Excel4 function<br />		invoke GlobalAlloc,GMEM_MOVEABLE,sizeof xloper<br />		mov hxLoginRet,eax<br />		invoke GlobalLock,eax<br />		mov pxLoginRet,eax<br />		<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;make the xloper array<br />		invoke FillXloper,pxLoginArray,addr xa_login,7*3<br />		<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;set the xltypeMulti xloper<br />		mov eax,pxLogin<br />		assume eax:ptr xloper <br />		mov .xltype,xltypeMulti<br />		push pxLoginArray<br />		pop .val.array.lparray<br />		mov .val.array.rows,3<br />		mov .val.array.columns,7<br />		assume eax:nothing<br />						<br />		invoke Excel4,xlfDialogBox,pxLoginRet,1,pxLogin<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!this function returns xlretInvXloper!!!!!!!!!!!!!!!!!!!!!!!!!!!!!<br />			<br />		invoke GlobalUnlock,hxLogin<br />		invoke GlobalFree,hxLogin<br />		<br />		invoke GlobalUnlock,hxLoginRet<br />		invoke GlobalFree,hxLoginRet<br />				<br />		invoke GlobalUnlock,hxLogin<br />		invoke GlobalFree,hxLogin<br />	<br />		ret<br />Login		endp<br /><br />could anyone tell me where the problem is?<br />thanks!</div>
    <div class="meta">Posted on 2006-02-17 19:59:22 by JinYang</div>
   </div>
  </div>
 </body>
</html>