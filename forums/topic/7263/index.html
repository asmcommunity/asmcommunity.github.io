<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Static and dynamic VxD - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7263" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7263">Static and dynamic VxD</a></p>
   <div class="post" id="post-52541">
    <div class="subject"><a href="#post-52541">Static and dynamic VxD</a></div>
    <div class="body">Can a static VxD process the w32_deviceIoControl message?<br />If yes, do I have to call CreateFile function in my application to use Win32 DeviceIoControl Interface in a static VxD then?<br />Or is the only way for an application to call functions inside a VxD to make that VxD dynamic?<br />Thanx.</div>
    <div class="meta">Posted on 2002-08-10 16:31:40 by Vaxon</div>
   </div>
   <div class="post" id="post-53171">
    <div class="subject"><a href="#post-53171">Static and dynamic VxD</a></div>
    <div class="body">yes a static VxD can process DeviceIO. <br /><br />No you do not have to load it dynamically (createfile).<br /><br />You can make a Vxd both static and dynamic by making the ON_SystemDynamic_Init routing jump to the ON_System_Init routine.<br /><br />That way you can load it dynamically until you work the kinks out.</div>
    <div class="meta">Posted on 2002-08-13 12:43:53 by sceptor</div>
   </div>
   <div class="post" id="post-53417">
    <div class="subject"><a href="#post-53417">Static and dynamic VxD</a></div>
    <div class="body">Thank you, but I still can't figure out how a static VxD does process win32_DeviceIoControl message.<br />To call the DeviceIoControl procedure from a win32 application I must get a vxd handle, which I do get when loading it dynamically using CreateFile. If the VxD is static and loaded by the system my application doesn't get any VxD hadle. How should I get it if the VxD is static?:confused:</div>
    <div class="meta">Posted on 2002-08-15 02:56:33 by Vaxon</div>
   </div>
   <div class="post" id="post-53426">
    <div class="subject"><a href="#post-53426">Static and dynamic VxD</a></div>
    <div class="body">Far as I remember, the same way that you would load your vxd: with a call to Createfile. Name being \\.\vxdnamehere. This should get you a valid handle to it, for use with DeviceIOControl.<br /><br />Fake</div>
    <div class="meta">Posted on 2002-08-15 04:39:11 by Fake51</div>
   </div>
  </div>
 </body>
</html>