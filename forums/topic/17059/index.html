<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>weird menu-problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17059" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=17059">weird menu-problem</a></p>
   <div class="post" id="post-132341">
    <div class="subject"><a href="#post-132341">weird menu-problem</a></div>
    <div class="body">Can anybody help me with the following problem:<br /><br />In my latest project I added some colors to my menu using SetSysColors function. The menu's background is black with white and gray text on it so it blends nicely with the graphix in the window. In Win2000 this works fine as I get the wanted result -&gt; a fully black menu-bar and black pop-up's. But in Win-XP however the result is different although it is the complete same program running -&gt; in XP the menu-bar stays gray! And only the pop-up's are colored black !! To me this is weird. Anyone who knows how this happens and/or can give me a solution to paint my XP menu-bar black as well ?<br /><br />Thanx in advance<br /><br />Greetings everybody!<br /><br />Lovesong.:confused:</div>
    <div class="meta">Posted on 2004-02-02 16:12:48 by lovesong</div>
   </div>
   <div class="post" id="post-132363">
    <div class="subject"><a href="#post-132363">weird menu-problem</a></div>
    <div class="body">I'm using GetSysColorBrush+FillRect to paint menu in XP, no problem so far :)</div>
    <div class="meta">Posted on 2004-02-03 04:06:58 by masquer</div>
   </div>
   <div class="post" id="post-132498">
    <div class="subject"><a href="#post-132498">problem still present...</a></div>
    <div class="body">Thanx for your reply masquer!<br /><br /> but could you be more specific in what you mean with using Fillrect. Do you mean you paint in non-client-area during ncpaint-message ?<br /> to illustrate my problem I send this picture of the problem at hand. On the left the result of my code in Win2000 with the desired effect. On the right the problem I have in XP. The menu-bar doesn't turn black and makes the menu-commands as good as unreadable....<br /><br />How can I solve this ??<br /><br />Thanx in advance,<br /><br />Lovesong.<br /><br />:sweat:</div>
    <div class="meta">Posted on 2004-02-04 09:24:18 by lovesong</div>
   </div>
   <div class="post" id="post-132676">
    <div class="subject"><a href="#post-132676">weird menu-problem</a></div>
    <div class="body">I'm mislead myself and mislead you. I was thinking we are talking about menu windows and not about menu bar. I'm using rebars for that and for your case I can't suggest you off-hand. Try to remove your manifest and see if it help.</div>
    <div class="meta">Posted on 2004-02-05 09:08:13 by masquer</div>
   </div>
   <div class="post" id="post-132754">
    <div class="subject"><a href="#post-132754">weird menu-problem</a></div>
    <div class="body">Hi Masquer,<br /><br />What do you mean with 'manifest'? could you give me some info about that.<br /><br />Thanx &amp; greetings,<br /><br /><br />Lovesong. ;)</div>
    <div class="meta">Posted on 2004-02-06 05:30:12 by lovesong</div>
   </div>
   <div class="post" id="post-132768">
    <div class="subject"><a href="#post-132768">weird menu-problem</a></div>
    <div class="body">Hm, better use search for manifest. This is new resource type introduced in WinXP, in short.</div>
    <div class="meta">Posted on 2004-02-06 09:23:14 by masquer</div>
   </div>
   <div class="post" id="post-132808">
    <div class="subject"><a href="#post-132808">weird menu-problem</a></div>
    <div class="body">Thank you for your advice masquer!<br /><br /> I allready gathered some info about  XP-manifest and will test around with that first. Guess it might fix the problem...<br /><br />Friendly greetings,<br /><br />Lovesong ;)</div>
    <div class="meta">Posted on 2004-02-07 02:31:44 by lovesong</div>
   </div>
  </div>
 </body>
</html>