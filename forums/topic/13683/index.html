<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Searching for Directories - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13683" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=13683">Searching for Directories</a></p>
   <div class="post" id="post-106010">
    <div class="subject"><a href="#post-106010">Searching for Directories</a></div>
    <div class="body">I can't find a decent way to find out if a file path points is a directory. I am thinking of a waythat would tell if a string, like &quot;C:\Windows\System32&quot; or &quot;C:\SomeFolder&quot; is a path to a folder or not. <br /><br />The only other way I know is calling CreateDirectory(), and then calling RemoveDirectory() if the first function returns 0 (meaning the folder exists).<br /><br />Please help</div>
    <div class="meta">Posted on 2003-06-04 18:53:51 by Paulicles the Philosopher</div>
   </div>
   <div class="post" id="post-106011">
    <div class="subject"><a href="#post-106011">Searching for Directories</a></div>
    <div class="body">BOOL PathIsDirectory( LPCTSTR pszPath);<br /><br />pszPath<br /> Pointer to a null-terminated string of maximum length MAX_PATH that contains the path to verify.<br /><br />Returns TRUE if the path is a valid directory, or FALSE otherwise. <br /><br />Minimum DLL Version shlwapi.dll version 4.71 or later</div>
    <div class="meta">Posted on 2003-06-04 18:59:53 by gfalen</div>
   </div>
   <div class="post" id="post-106013">
    <div class="subject"><a href="#post-106013">Searching for Directories</a></div>
    <div class="body">You must also try to SetCurrentDirectory, which would fail if path is file.</div>
    <div class="meta">Posted on 2003-06-04 19:07:01 by comrade</div>
   </div>
   <div class="post" id="post-106019">
    <div class="subject"><a href="#post-106019">Searching for Directories</a></div>
    <div class="body"><pre><code>&#91;size=12&#93;    invoke GetFileAttributes, pszPath<br />    cmp eax, INVALID_FILE_ATTRIBUTES<br />    je @isNotDir<br />    test eax, FILE_ATTRIBUTE_DIRECTORY<br />    jz @isNotDir<br />    jmp @isDir&#91;/size&#93;</code></pre></div>
    <div class="meta">Posted on 2003-06-04 21:02:21 by iblis</div>
   </div>
   <div class="post" id="post-106022">
    <div class="subject"><a href="#post-106022">Searching for Directories</a></div>
    <div class="body">Nice :alright:</div>
    <div class="meta">Posted on 2003-06-04 21:22:52 by comrade</div>
   </div>
   <div class="post" id="post-106472">
    <div class="subject"><a href="#post-106472">Searching for Directories</a></div>
    <div class="body">Possible use: FindFirstFile(pszPath + '\', ...) != INVALID_HANDLE_VALUE</div>
    <div class="meta">Posted on 2003-06-09 03:55:18 by P2M</div>
   </div>
  </div>
 </body>
</html>