<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>RegQueryValueEx ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26330" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26330">RegQueryValueEx ?</a></p>
   <div class="post" id="post-191143">
    <div class="subject"><a href="#post-191143">RegQueryValueEx ?</a></div>
    <div class="body">I would like to know how works RegQueryValueEx.
I know how works RegOpen and RegSet but I don't succeed with this one. 

A simple example with:
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Version --> 
How I must do please ?</div>
    <div class="meta">Posted on 2000-12-15 17:30:00 by Divon</div>
   </div>
   <div class="post" id="post-191144">
    <div class="subject"><a href="#post-191144">RegQueryValueEx ?</a></div>
    <div class="body">Here is the code...
;RegQueryValueEx (LONG)
;-
;HKEY    hKey,           //handle of key to query 
;LPTSTR  lpszValueName,	// address of name of value to query 
;LPDWORD lpdwReserved,	// reserved 
;LPDWORD lpdwType,	// address of buffer for value type 
;LPBYTE  lpbData,	// address of data buffer 
;LPDWORD lpcbData 	// address of data buffer size
;-
.DATA
rpath db "\SOFTWARE\Microsoft\Windows\CurrentVersion\Version",0
buff  dd 0
.CODE
invoke GlobalAlloc,GMEM_FIXED,50000
mov buff,eax
invoke RegQueryValueEx,HKEY_LOCAL_MACHINE,rpath,NULL,REG_DWORD,addr buff,50000
invoke GlobalFree,buff</div>
    <div class="meta">Posted on 2000-12-15 20:54:00 by dork </div>
   </div>
  </div>
 </body>
</html>