<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Help with CAB-Archives - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15578" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15578">Help with CAB-Archives</a></p>
   <div class="post" id="post-120986">
    <div class="subject"><a href="#post-120986">Help with CAB-Archives</a></div>
    <div class="body">Hi!<br /><br />Can anybody help me with the CAB-DLL. I've heard that one can create and extract CAB-Archives with it and I found something on that. This is the download-link:  <a target="_blank" href="http://download.microsoft.com/download/platformsdk/cab/2.0/w98nt42kmexp/en-us/Cabsdk.exe">http://download.microsoft.com/download/platformsdk/cab/2.0/w98nt42kmexp/en-us/Cabsdk.exe</a><br /><br />In the examples anything is written in C I think and it would be great if somebody can help me with translating it and/or give any other information about the CAB-DLL.<br /><br />thx in advance</div>
    <div class="meta">Posted on 2003-10-10 06:30:25 by ChigpA</div>
   </div>
   <div class="post" id="post-121054">
    <div class="subject"><a href="#post-121054">Help with CAB-Archives</a></div>
    <div class="body">Well i once got it working on vb, but i guess the c source will be easier to translate.<br />What i can tell you to save some time (took me a while to figure out, and then ages trying to fix it from within vb) is that the functions use C calling method (ie you need to clean up the stack yourself).<br /><br />These are the vb structures and api calls:<br /><pre><code><br />Private Type FdiCabinetInfo<br />    CabinetSize As Long<br />    NrFolders As Integer<br />    NrFiles As Integer<br />    SetID As Integer<br />    CabinetNumber As Integer<br />    Reserved As Long<br />    HasPrev As Long<br />    HasNext As Long<br />End Type<br />Private Type FdiErrorStruct<br />    Code As Long<br />    Type As Long<br />    IsError As Long<br />End Type<br />Private Type FdiNotifyStruct<br />    FileSize As Long<br />    String1 As Long<br />    String2 As Long<br />    String3 As Long<br />    UserData As Long<br />    hFile As Long<br />    Date As Integer<br />    Time As Integer<br />    Attribs As Integer<br />    CabID As Integer<br />    CabNumber As Integer<br />    FolderNumber As Integer<br />    FdiError As Long<br />End Type<br /><br />' _cdecl api's, call indirectly<br />'Private Declare Function FDICreate Lib &quot;cabinet&quot; &#40;ByVal MemAllocFunc As Long, ByVal MemFreeFunc As Long, ByVal FileOpenFunc As Long, ByVal FileReadFunc As Long, ByVal FileWriteFunc As Long, ByVal FileCloseFunc As Long, ByVal FileSeekFunc As Long, ByVal CPUType As Long, FdiError As FdiErrorStruct&#41; As Long<br />'Private Declare Function FDIIsCabinet Lib &quot;cabinet&quot; &#40;ByVal hFdi As Long, ByVal hFile As Long, CabinetInfo As FdiCabinetInfo&#41; As Long<br />'Private Declare Function FDICopy Lib &quot;cabinet&quot; &#40;ByVal hFdi As Long, ByVal CabinetName As String, ByVal CabinetPath As String, ByVal Flags As Long, ByVal MsgHandler As Long, ByVal DecryptHandler As Long, UserData As Any&#41; As Long<br />'Private Declare Function FDIDestroy Lib &quot;cabinet&quot; &#40;ByVal hFdi As Long&#41; As Long<br /></code></pre></div>
    <div class="meta">Posted on 2003-10-11 02:04:19 by Joshua</div>
   </div>
  </div>
 </body>
</html>