<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Cache Performance Counters - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20584" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20584">Cache Performance Counters</a></p>
   <div class="post" id="post-157181">
    <div class="subject"><a href="#post-157181">Cache Performance Counters</a></div>
    <div class="body">I need measure L1 and L2 cache misses for my procedures.<br />I know how to do (Performance Counters) but I have troubles with this because on WinXP as normal user I can't set PCE flag <br />of the control register CR4. PCE flag allows use perfomance counters in the user mode but unfortunatelly it is cleared in WinXP. So I have to use<br />MOV command with CR4 as argument but it is forbidden for normal user<br />(its priviledged instruction only for OS)<br />Have anyone any idea how to do it<br /><br />Thx</div>
    <div class="meta">Posted on 2005-02-19 08:54:02 by tutek</div>
   </div>
   <div class="post" id="post-157191">
    <div class="subject"><a href="#post-157191">Cache Performance Counters</a></div>
    <div class="body">I've tried using a driver to set the PCE flag in CR4 but Windows always seems to clear it again once back in user mode. Looks to me like you'll have to do it all in a driver. :wink:</div>
    <div class="meta">Posted on 2005-02-19 14:45:24 by The Dude of Dudes</div>
   </div>
  </div>
 </body>
</html>