<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>listview question - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=28045" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=28045">listview question</a></p>
   <div class="post" id="post-199180">
    <div class="subject"><a href="#post-199180">listview question</a></div>
    <div class="body">i want to be able to delete a row that i have clicked on in my listview. how do i determine which row is selected?

smurf</div>
    <div class="meta">Posted on 2001-05-13 15:33:00 by smurf</div>
   </div>
   <div class="post" id="post-199181">
    <div class="subject"><a href="#post-199181">listview question</a></div>
    <div class="body">If you want to delete the row by clicking it:
      .elseif uMsg==WM_NOTIFY
		push edi
		mov edi,lParam
		assume edi:ptr NMHDR
		mov eax,.hwndFrom
		.if eax==hListView
                  mov eax, .code
			.if eax==NM_CLICK
                      assume edi:ptr NMLISTVIEW
                      mov eax,.iItem ;here eax equals item index to be removed
                      invoke   SendMessage,hListView,LVM_DELETEITEM,eax,0
          		.endif
            .endif
		pop edi

;if you want to delete the row later :
mov eax,.iItem ;here eax equals item index to be removed
mov MyItem,eax ;MyItem is a dd variable that will carry the index
               ;of the item, then later on 
invoke   SendMessage,hListView,LVM_DELETEITEM,MyItem,0</div>
    <div class="meta">Posted on 2001-05-13 17:24:00 by a nada</div>
   </div>
   <div class="post" id="post-199182">
    <div class="subject"><a href="#post-199182">listview question</a></div>
    <div class="body">thanks a nada! if you figure out anything else of interest with listviews let me know.

smurf</div>
    <div class="meta">Posted on 2001-05-13 20:57:00 by smurf</div>
   </div>
  </div>
 </body>
</html>