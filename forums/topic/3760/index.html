<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>wm_paste message in richedit control - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3760" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3760">wm_paste message in richedit control</a></p>
   <div class="post" id="post-25284">
    <div class="subject"><a href="#post-25284">wm_paste message in richedit control</a></div>
    <div class="body">now I have a question about richedit, I am writing my own richeditor, as u konw, richedit can paste rtf format text, but I just wanna extract the pure text from the clipboard that maybe include rtf format text, then paste it into my richedit control, in this way, I must set the pasted text into the same font style as the other text in the richedit , how do it?</div>
    <div class="meta">Posted on 2002-02-21 05:45:47 by dREAMtHEATER</div>
   </div>
   <div class="post" id="post-25321">
    <div class="subject"><a href="#post-25321">wm_paste message in richedit control</a></div>
    <div class="body">dREAMtHEATER,<br /><br />From memory, if you use the EM_PASTESPECIAL message and set the format to CF_TEXT, it should do what you are after.<br /><br />You shold also trap the keyboard clipboard keys as well so that the user cannot paste in the wrong stuff.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-02-21 10:20:05 by hutch--</div>
   </div>
   <div class="post" id="post-25479">
    <div class="subject"><a href="#post-25479">wm_paste message in richedit control</a></div>
    <div class="body">hi!<br /><br />Had the same problem...I just set EM_SETTEXTMODE with TM_PLAINTEXT to the richedit..but then you can't do syntax-highlight with em_setcharformat</div>
    <div class="meta">Posted on 2002-02-22 13:26:39 by Rennsemmel</div>
   </div>
  </div>
 </body>
</html>