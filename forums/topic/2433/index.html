<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Findfirst...Findnext...shame on me - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2433" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2433">Findfirst...Findnext...shame on me</a></p>
   <div class="post" id="post-15376">
    <div class="subject"><a href="#post-15376">Findfirst...Findnext...shame on me</a></div>
    <div class="body">hossa<br /><br />i try to use the findfirst findnext function and aehm im unable to get it working :(<br />i try to convert a masm sample to tasm.<br /><br />hm normal i mean it must be very easy....call findfirst..offset wheretofind (c:\test\*.*)<br />the result should be the first file<br />but my result is allways empty ?!?<br /><br />then ,for the loop do i have to count the files first in the directory or is there a error or something i can look for when there is no more files to search for ?<br /><br />i only need to look in 1 directory ,lets say Autostart folder.<br /><br />thanks</div>
    <div class="meta">Posted on 2001-12-19 05:01:13 by Max</div>
   </div>
   <div class="post" id="post-15382">
    <div class="subject"><a href="#post-15382">Findfirst...Findnext...shame on me</a></div>
    <div class="body">check Iczelions tut 31 this deals with FindFirstFile, FindNextFile</div>
    <div class="meta">Posted on 2001-12-19 06:11:02 by Allanon</div>
   </div>
   <div class="post" id="post-15383">
    <div class="subject"><a href="#post-15383">Re: Findfirst...Findnext...shame on me</a></div>
    <div class="body"><div class="quote">call findfirst..offset wheretofind (c:\test\*.*)<br />the result should be the first file</div><br />The result comes in two parts for this call: the handle to the first file, and the data contained in your WIN32_FIND_DATA struct. The handle is used in your call to FindNextFile, the API uses that handle to keep track of where it is up to in the directory. Which file you get back first will depend on the OS and filesystem: if you are on NTFS, the &quot;.&quot; and &quot;..&quot; directories are returned first, followed by the rest of the files/folders in alphabetic order. If you are on FAT32/FAT16, the files/folders are returned in random order, unless you are running Win2K which follows the rule for NTFS even when you are running FAT32.<br /><br /><div class="quote">but my result is allways empty ?!?</div><br />What is always empty? Do you mean your handle is NULL, or your struct is not being filled?<br /><br /><div class="quote">then ,for the loop do i have to count the files first in the directory or is there a error or something i can look for when there is no more files to search for ?</div><br />When the handle comes back NULL from a call to FindNextFile, that means there is no more files to enumerate in that folder.</div>
    <div class="meta">Posted on 2001-12-19 06:18:08 by sluggy</div>
   </div>
   <div class="post" id="post-15388">
    <div class="subject"><a href="#post-15388">Findfirst...Findnext...shame on me</a></div>
    <div class="body">Yeah cool !<br /><br />Now i understand !!!<br />ha i try to show the first result i get back as filename *bg*<br />thats my misstake aaaaaaah light goes on :)<br /><br />thanks !</div>
    <div class="meta">Posted on 2001-12-19 06:27:12 by Max</div>
   </div>
  </div>
 </body>
</html>