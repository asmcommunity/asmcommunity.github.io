<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Translate this to Masm - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29606" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=115">DOS &amp; BIOS</a> &raquo; <a href="../?id=29606">Translate this to Masm</a></p>
   <div class="post" id="post-209058">
    <div class="subject"><a href="#post-209058">Translate this to Masm</a></div>
    <div class="body">guys i need to translate it in masm assembler because i&#039;ve made this code in emu8086 and unfortunately there are many errors...plsss help me...i&#039;ve made my job...but the problem is my instructor tell me suddenly that masm should be the assembler....<br /><br />.model small<br />.stack 100h<br />.data<br />&nbsp; &nbsp; msg db &#039;Enter hex: $&#039;<br />&nbsp; &nbsp; msg2 db 0ah,0dh,&#039;Enter hex: $&#039;<br />&nbsp; &nbsp; buf db 5,6 dup(&#039;$&#039;)<br />&nbsp; &nbsp; buf2 db 3,4 dup(&#039;$&#039;)<br />&nbsp; &nbsp; msg3 db 0ah,0dh,&#039;The quotient is: &#039;,0ah,0dh,&#039;$&#039;<br /><br />.code&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; mov ax,@data<br />&nbsp; &nbsp; mov ds,ax<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah,09h<br />&nbsp; &nbsp; lea dx,msg<br />&nbsp; &nbsp; int 21h&nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah,0ah<br />&nbsp; &nbsp; lea dx,buf<br />&nbsp; &nbsp; int 21h&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; mov cx,0h<br />&nbsp; &nbsp; mov cl,buf[1]<br />&nbsp; &nbsp; mov bx,2h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; again:<br />&nbsp; &nbsp; &nbsp; &nbsp; sub buf,30h<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp buf,10h<br />&nbsp; &nbsp; &nbsp; &nbsp; jg alpha <br />&nbsp; &nbsp; &nbsp; &nbsp; here:&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; inc bx<br />&nbsp; &nbsp; loop again:&nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah,09h<br />&nbsp; &nbsp; lea dx,msg2<br />&nbsp; &nbsp; int 21h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah,0ah<br />&nbsp; &nbsp; lea dx,buf2<br />&nbsp; &nbsp; int 21h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov cx,0h<br />&nbsp; &nbsp; mov cl,buf2[1]<br />&nbsp; &nbsp; mov bx,2h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; again2:<br />&nbsp; &nbsp; &nbsp; &nbsp; sub buf2,30h<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp buf2,10h<br />&nbsp; &nbsp; &nbsp; &nbsp; jg alpha2 <br />&nbsp; &nbsp; &nbsp; &nbsp; here2:&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; inc bx<br />&nbsp; &nbsp; loop again2:<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ax,0h<br />&nbsp; &nbsp; mov ax,buf[2]<br />&nbsp; &nbsp; shl al,04h<br />&nbsp; &nbsp; add ah,al<br />&nbsp; &nbsp; mov dh,ah<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ax,0h<br />&nbsp; &nbsp; mov ax,buf[4]<br />&nbsp; &nbsp; shl al,04h<br />&nbsp; &nbsp; add ah,al<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov cx,0h<br />&nbsp; &nbsp; mov cx,buf2[2]<br />&nbsp; &nbsp; shl cx,01h<br />&nbsp; &nbsp; mov cx,buf[3]<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov al,dh<br />&nbsp; &nbsp; xchg al,ah<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov bx,0h&nbsp;  <br />&nbsp; &nbsp; mov bx,buf2[2]<br />&nbsp; &nbsp; mov dl,buf2[1]<br />&nbsp; &nbsp; cmp dl,01h<br />&nbsp; &nbsp; je dex<br />&nbsp; &nbsp; shl bl,04h <br />&nbsp; &nbsp; ambs:<br />&nbsp; &nbsp; add bh,bl<br />&nbsp; &nbsp; mov bl,bh<br />&nbsp; &nbsp; mov bh,00h<br />&nbsp; &nbsp; mov dx,0h <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; div bx <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov dl,ah<br />&nbsp; &nbsp; and dl,0F0h<br />&nbsp; &nbsp; shr dl,04h&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; mov buf[2],dl<br />&nbsp; &nbsp; mov dl,ah<br />&nbsp; &nbsp; and dl,0Fh<br />&nbsp; &nbsp; mov buf[3],dl<br />&nbsp; &nbsp; mov dl,al<br />&nbsp; &nbsp; and dl,0F0h<br />&nbsp; &nbsp; shr dl,04h <br />&nbsp; &nbsp; mov buf[4],dl<br />&nbsp; &nbsp; mov dl,al<br />&nbsp; &nbsp; and dl,0Fh <br />&nbsp; &nbsp; mov buf[5],dl <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov bx,2h <br />&nbsp; &nbsp; mov cx,0h<br />&nbsp; &nbsp; mov cl,buf[1]<br />&nbsp; &nbsp; res:<br />&nbsp; &nbsp; &nbsp; cmp buf,0Ah<br />&nbsp; &nbsp; &nbsp; jg alp<br />&nbsp; &nbsp; &nbsp; add buf,30h&nbsp; <br />&nbsp; &nbsp; &nbsp; this:<br />&nbsp; &nbsp; &nbsp; inc bx&nbsp; &nbsp;  <br />&nbsp; &nbsp; loop res<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah,09h<br />&nbsp; &nbsp; lea dx,msg3<br />&nbsp; &nbsp; int 21h&nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov cx,0h<br />&nbsp; &nbsp; mov bx,002h<br />&nbsp; &nbsp; mov cl,buf[1] <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ans:<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov dl,0h<br />&nbsp; &nbsp; mov dl,buf<br />&nbsp; &nbsp; mov ah,02h<br />&nbsp; &nbsp; int 21h <br />&nbsp; &nbsp; inc bx<br />&nbsp; &nbsp; loop ans<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ax,4c00h<br />&nbsp; &nbsp; int 21h <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; dex proc<br />&nbsp; &nbsp; &nbsp; &nbsp; mov bh,0h<br />&nbsp; &nbsp; &nbsp; &nbsp; jmp ambs<br />&nbsp; &nbsp; dex endp<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alp proc<br />&nbsp; &nbsp; &nbsp;  cmp buf,0Ah<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alpA<br />&nbsp; &nbsp; &nbsp;  cmp buf,0Bh<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alpB<br />&nbsp; &nbsp; &nbsp;  cmp buf,0Ch<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alpC<br />&nbsp; &nbsp; &nbsp;  cmp buf,0Dh<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alpD<br />&nbsp; &nbsp; &nbsp;  cmp buf,0Eh<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alpE<br />&nbsp; &nbsp; &nbsp;  cmp buf,0Fh<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alpF<br />&nbsp; &nbsp; alp endp&nbsp;  <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alpha proc<br />&nbsp; &nbsp; &nbsp;  sub buf,10h<br />&nbsp; &nbsp; &nbsp;  cmp buf,1h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alA<br />&nbsp; &nbsp; &nbsp;  cmp buf,2h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alB<br />&nbsp; &nbsp; &nbsp;  cmp buf,3h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alC<br />&nbsp; &nbsp; &nbsp;  cmp buf,4h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alD<br />&nbsp; &nbsp; &nbsp;  cmp buf,5h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alE<br />&nbsp; &nbsp; &nbsp;  cmp buf,6h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alF<br />&nbsp; &nbsp; alpha endp&nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alpha2 proc<br />&nbsp; &nbsp; &nbsp;  sub buf2,10h<br />&nbsp; &nbsp; &nbsp;  cmp buf2,1h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alA2<br />&nbsp; &nbsp; &nbsp;  cmp buf2,2h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alB2<br />&nbsp; &nbsp; &nbsp;  cmp buf2,3h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alC2<br />&nbsp; &nbsp; &nbsp;  cmp buf2,4h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alD2<br />&nbsp; &nbsp; &nbsp;  cmp buf2,5h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alE2<br />&nbsp; &nbsp; &nbsp;  cmp buf2,6h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alF2<br />&nbsp; &nbsp; alpha2 endp<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alA proc<br />&nbsp; &nbsp; &nbsp;  mov buf,0Ah<br />&nbsp; &nbsp; &nbsp;  jmp here<br />&nbsp; &nbsp; alA endp <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alB proc<br />&nbsp; &nbsp; &nbsp;  mov buf,0Bh<br />&nbsp; &nbsp; &nbsp;  jmp here<br />&nbsp; &nbsp; alB endp<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; alC proc<br />&nbsp; &nbsp; &nbsp;  mov buf,0Ch <br />&nbsp; &nbsp; &nbsp;  jmp here<br />&nbsp; &nbsp; alC endp<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; alD proc<br />&nbsp; &nbsp; &nbsp;  mov buf,0Dh<br />&nbsp; &nbsp; &nbsp;  jmp here<br />&nbsp; &nbsp; alD endp<br />&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; alE proc<br />&nbsp; &nbsp; &nbsp;  mov buf,0Eh<br />&nbsp; &nbsp; &nbsp;  jmp here<br />&nbsp; &nbsp; alE endp&nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alF proc<br />&nbsp; &nbsp; &nbsp;  mov buf,0Fh<br />&nbsp; &nbsp; &nbsp;  jmp here<br />&nbsp; &nbsp; alF endp&nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alA2 proc<br />&nbsp; &nbsp; &nbsp;  mov buf2,0Ah<br />&nbsp; &nbsp; &nbsp;  jmp here2<br />&nbsp; &nbsp; alA2 endp <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alB2 proc<br />&nbsp; &nbsp; &nbsp;  mov buf2,0Bh<br />&nbsp; &nbsp; &nbsp;  jmp here2<br />&nbsp; &nbsp; alB2 endp<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; alC2 proc<br />&nbsp; &nbsp; &nbsp;  mov buf2,0Ch <br />&nbsp; &nbsp; &nbsp;  jmp here2<br />&nbsp; &nbsp; alC2 endp<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; alD2 proc<br />&nbsp; &nbsp; &nbsp;  mov buf2,0Dh<br />&nbsp; &nbsp; &nbsp;  jmp here2<br />&nbsp; &nbsp; alD2 endp<br />&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; alE2 proc<br />&nbsp; &nbsp; &nbsp;  mov buf2,0Eh<br />&nbsp; &nbsp; &nbsp;  jmp here2<br />&nbsp; &nbsp; alE2 endp&nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alF2 proc<br />&nbsp; &nbsp; &nbsp;  mov buf2,0Fh<br />&nbsp; &nbsp; &nbsp;  jmp here2<br />&nbsp; &nbsp; alF2 endp<br /><br />&nbsp; &nbsp; alpA proc<br />&nbsp; &nbsp; &nbsp;  mov buf,41h<br />&nbsp; &nbsp; &nbsp;  jmp this<br />&nbsp; &nbsp; alpA endp&nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alpB proc<br />&nbsp; &nbsp; &nbsp;  mov buf,42h<br />&nbsp; &nbsp; &nbsp;  jmp this<br />&nbsp; &nbsp; alpB endp <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alpC proc<br />&nbsp; &nbsp; &nbsp;  mov buf,43h<br />&nbsp; &nbsp; &nbsp;  jmp this<br />&nbsp; &nbsp; alpC endp<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alpD proc<br />&nbsp; &nbsp; &nbsp;  mov buf,44h<br />&nbsp; &nbsp; &nbsp;  jmp this<br />&nbsp; &nbsp; alpD endp<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; alpE proc<br />&nbsp; &nbsp; &nbsp;  mov buf,45h<br />&nbsp; &nbsp; &nbsp;  jmp this<br />&nbsp; &nbsp; alpE endp<br /><br />&nbsp; &nbsp; alpF proc<br />&nbsp; &nbsp; &nbsp;  mov buf,46h<br />&nbsp; &nbsp; &nbsp;  jmp this<br />&nbsp; &nbsp; alpF endp<br /><br /><br /><br />and i&#039;ve tried to compile it on tasm because they are much related but i also have an error like this<br /><br />Assembling file:&nbsp;  draft.asm<br />**Error** draft.asm(33) Need expression<br />**Error** draft.asm(54) Need expression<br />**Error** draft.asm(57) Operand types do not match<br />**Error** draft.asm(63) Operand types do not match<br />**Error** draft.asm(68) Operand types do not match<br />**Error** draft.asm(70) Operand types do not match<br />**Error** draft.asm(77) Operand types do not match<br />*Warning* draft.asm(112) Reserved word used as symbol: THIS<br />**Fatal** draft.asm(278) Unexpected end of file encountered<br />Error messages:&nbsp; &nbsp; 8<br />Warning messages:&nbsp; 1<br />Passes:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 1<br />Remaining memory:&nbsp; 446k<br /><br />plss help me..i&#039;m in a nick of time to pass this subject...btw that is 8086 version of asm</div>
    <div class="meta">Posted on 2009-10-08 16:05:58 by web4</div>
   </div>
   <div class="post" id="post-209074">
    <div class="subject"><a href="#post-209074">Re: Translate this to Masm</a></div>
    <div class="body">The problems are due to your choice of memory model.<br />Your relative jumps are too far apart.<br /></div>
    <div class="meta">Posted on 2009-10-10 01:19:05 by Homer</div>
   </div>
   <div class="post" id="post-209077">
    <div class="subject"><a href="#post-209077">Re: Translate this to Masm</a></div>
    <div class="body">umm what would i do to fix that?? could you give me example homer?? please</div>
    <div class="meta">Posted on 2009-10-10 03:16:58 by web4</div>
   </div>
   <div class="post" id="post-209082">
    <div class="subject"><a href="#post-209082">Re: Translate this to Masm</a></div>
    <div class="body">Hi web4,<br /><br />I&#039;m Nasmist, and can&#039;t help you with Masm syntax (if you&#039;re supposed to use Masm, use Masm - Tasm is not quite the same...). Perhaps I can make some suggestions that will help...<br /><br />I don&#039;t understand what Homer says about the &quot;memory model&quot; being wrong. The problem, I think, is that your &quot;conditional jumps&quot; (je, etc.) are out of range - they&#039;ll only go forward or backward 127 bytes in your code. You&#039;ve apparently tried &quot;far&quot;, which is not what you want. What you might want is &quot;near&quot; jumps. However, those instructions weren&#039;t available on the 8086. To enable them, I think Masm wants &quot;.286&quot; (or better), but if you&#039;re supposed to be using 8086 code, there&#039;s a workaround:<br /><br />cmp ax, bx<br />je someplace<br />...<br /><br />If &quot;someplace&quot; is too far away, you can do:<br /><br />cmp ax, bx<br />jne notsomeplace<br />jmp someplace<br />notsomeplace:<br />...<br /><br />Better, if you can do it, is to rearrange your code so the so your jumps are in range. Look at some of the &quot;nearly repetitive&quot; parts of your code. Can you see any &quot;patterns&quot; that you could take advantage of? For example...<br /><br />sub buf, 10h<br />cmp buf, 1<br />je alA<br />cmp buf, 2<br />je alB<br />...<br /><br />Then at &quot;alA&quot;...<br /><br />&nbsp; &nbsp; alA proc<br />&nbsp; &nbsp; &nbsp;  mov buf,0Ah<br />&nbsp; &nbsp; &nbsp;  jmp here<br />&nbsp; &nbsp; alA endp<br />&nbsp;  <br />&nbsp; &nbsp; alB proc<br />&nbsp; &nbsp; &nbsp;  mov buf,0Bh<br />&nbsp; &nbsp; &nbsp;  jmp here<br />&nbsp; &nbsp; alB endp<br />...<br /><br />Could you....<br /><br />mov al, buf<br />sub al, 10h<br />cmp al, 1<br />jb not_this_routine<br />cmp al, 6<br />ja not_this_routine<br />add al, 9<br />mov buf, al<br />not this routine:<br />cmp al, ???<br />...<br /><br />You use &quot;proc&quot; and &quot;endp&quot; a lot. Do you know what they do? Usually, they&#039;d be used in a PROCedure that&#039;s &quot;call&quot;ed and &quot;ret&quot;urned from. Do you know how to use &quot;call&quot; and &quot;ret&quot;? Learning them might simplify your code a lot.<br /><br />To be honest, I think you should start over - don&#039;t worry, you can use most of the same code. First, just write comments to indicate what you need to do:<br /><br />; display first prompt<br />; get first number from user<br />; (what do you do if the idiot enters something wrong?)<br />; convert text to number<br />; store first number<br />; display second prompt<br />; get second number from user<br />; convert text to number<br />; store second number<br />; divide first number by second number<br />; convert number to text<br />; display the quotient<br />...<br /><br />I think it will help you organize your code so that the conditional jumps are in range, and will make it easier to follow your code. I can&#039;t really tell if your code would work as intended - looks like it might be good with tomato sauce and basil. :)<br /><br />Don&#039;t worry, it gets easier as you go along...<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="meta">Posted on 2009-10-10 06:13:10 by fbkotler</div>
   </div>
   <div class="post" id="post-209083">
    <div class="subject"><a href="#post-209083">Re: Translate this to Masm</a></div>
    <div class="body">thanks fbkotler i really appreciate your time reading my source code that is too long....and i&#039;ve minize it because you point out my mistake...but the one you discuss about the &quot;conditional jumps&quot; part i don&#039;t get it...i&#039;m sorry you can really see from my code that i am really a noob..</div>
    <div class="meta">Posted on 2009-10-10 06:38:04 by web4</div>
   </div>
   <div class="post" id="post-209088">
    <div class="subject"><a href="#post-209088">Re: Translate this to Masm</a></div>
    <div class="body">Ahhh... conditional jumps... ja, jae, jb, jbe, jc, jg, jl,... jz. There are quite a few of them! On the 8086, these were available only in &quot;short&quot; form. On the 80186 (maybe not until 80286), a &quot;near&quot; form was introduced which will jump a longer distance. As an experiment, try adding &quot;.286&quot; to the top of your code (not sure whether it goes before or after &quot;.model small&quot; - RTFM). This will enable Masm/Tasm to use those instructions. If that helps any, check with your instructor whether you&#039;re allowed to use it.<br /><br />You seem to understand the dos interrupts you need to use, so you&#039;re off to a good start there. You might benefit from studying the routine you found by searching &quot;hex string&quot; in the other thread. It&#039;s 32-bit, so you won&#039;t be able to use it directly, but figure out what it does, and you can do it in 16-bit code. The first version given should be fast enough for your purposes. :)<br /><br />If you&#039;ve got time, look into the &quot;call&quot; and &quot;ret&quot; instructions. A subroutine will allow you to convert both text inputs into numbers with one routine, but you can do it &quot;inline&quot; twice (or jumping from place to place) as you&#039;re doing, if you don&#039;t have time to learn that...<br /><br />Again, comment your code. It will not only help us folks reading it (and get you a better grade!), but it&#039;ll help you keep track of what you&#039;re doing, and what you need to do next.<br /><br />Don&#039;t worry about being a &quot;noob&quot;. Nobody was born knowing this stuff. It takes a while to &quot;get&quot; it.<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="meta">Posted on 2009-10-10 08:46:33 by fbkotler</div>
   </div>
   <div class="post" id="post-209149">
    <div class="subject"><a href="#post-209149">Re: Translate this to Masm</a></div>
    <div class="body">.model small<br />.stack 100h<br />.data<br />&nbsp; &nbsp; msg db &#039;Enter hex: $&#039;<br />&nbsp; &nbsp; msg2 db 0ah,0dh,&#039;Enter hex: $&#039;<br />&nbsp; &nbsp; buf db 5,6 dup(&#039;$&#039;)<br />&nbsp; &nbsp; buf2 db 3,4 dup(&#039;$&#039;)<br />&nbsp; &nbsp; msg3 db 0AH,0DH,&#039;The quotient is: $&#039;<br /><br />.code&nbsp; <br />&nbsp; &nbsp; start:<br />&nbsp;  main proc&nbsp;  <br />&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; mov ax,@data<br />&nbsp; &nbsp; mov ds,ax<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah,09h<br />&nbsp; &nbsp; lea dx,msg<br />&nbsp; &nbsp; int 21h&nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah,0ah<br />&nbsp; &nbsp; lea dx,buf<br />&nbsp; &nbsp; int 21h&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; mov cx,0h<br />&nbsp; &nbsp; mov cl,buf[1]<br />&nbsp; &nbsp; mov bx,2h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; again:&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; mov al,buf<br />&nbsp; &nbsp; &nbsp; &nbsp; sub al,30h <br />&nbsp; &nbsp; &nbsp; &nbsp; call well<br />&nbsp; &nbsp; &nbsp; &nbsp; mov buf,al<br />&nbsp; &nbsp; &nbsp; &nbsp; inc bx<br />&nbsp; &nbsp; loop again&nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah,09h<br />&nbsp; &nbsp; lea dx,msg2<br />&nbsp; &nbsp; int 21h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah,0ah<br />&nbsp; &nbsp; lea dx,buf2<br />&nbsp; &nbsp; int 21h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov cx,0h<br />&nbsp; &nbsp; mov cl,buf2[1]<br />&nbsp; &nbsp; mov bx,2h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; again2:<br />&nbsp; &nbsp; &nbsp; &nbsp; mov al,buf2<br />&nbsp; &nbsp; &nbsp; &nbsp; sub al,30h<br />&nbsp; &nbsp; &nbsp; &nbsp; mov buf2,al <br />&nbsp; &nbsp; &nbsp; &nbsp; call well<br />&nbsp; &nbsp; &nbsp; &nbsp; mov buf2,al&nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; inc bx<br />&nbsp; &nbsp; loop again2<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ax,0h<br />&nbsp; &nbsp; mov al,buf[2] <br />&nbsp; &nbsp; shl al,01h<br />&nbsp; &nbsp; shl al,01h<br />&nbsp; &nbsp; shl al,01h<br />&nbsp; &nbsp; shl al,01h<br />&nbsp; &nbsp; mov ah,buf[3]<br />&nbsp; &nbsp; add ah,al<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov dh,ah<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ax,0h<br />&nbsp; &nbsp; mov al,buf[4]<br />&nbsp; &nbsp; shl al,01h<br />&nbsp; &nbsp; shl al,01h<br />&nbsp; &nbsp; shl al,01h<br />&nbsp; &nbsp; shl al,01h<br />&nbsp; &nbsp; mov ah,buf[5]<br />&nbsp; &nbsp; add ah,al<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov cx,0h<br />&nbsp; &nbsp; mov cl,buf2[2]<br />&nbsp; &nbsp; shl cx,01h<br />&nbsp; &nbsp; mov cl,buf[3]<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov al,dh<br />&nbsp; &nbsp; xchg al,ah<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov bx,0h&nbsp;  <br />&nbsp; &nbsp; mov bl,buf2[2]<br />&nbsp; &nbsp; mov dl,buf2[1]<br />&nbsp; &nbsp; cmp dl,01h<br />&nbsp; &nbsp; je dex<br />&nbsp; &nbsp; ambs:<br />&nbsp; &nbsp; shl bl,01h<br />&nbsp; &nbsp; shl bl,01h<br />&nbsp; &nbsp; shl bl,01h<br />&nbsp; &nbsp; shl bl,01h <br />&nbsp; &nbsp; mov bh,buf2[3]<br />&nbsp; &nbsp; add bh,bl<br />&nbsp; &nbsp; mov bl,bh<br />&nbsp; &nbsp; mov bh,00h<br />&nbsp; &nbsp; mov dx,0h <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; div bx <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov dl,ah<br />&nbsp; &nbsp; and dl,0F0h<br />&nbsp; &nbsp; shr dl,01h<br />&nbsp; &nbsp; shr dl,01h<br />&nbsp; &nbsp; shr dl,01h<br />&nbsp; &nbsp; shr dl,01h&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; mov buf[2],dl<br />&nbsp; &nbsp; mov dl,ah<br />&nbsp; &nbsp; and dl,0Fh<br />&nbsp; &nbsp; mov buf[3],dl<br />&nbsp; &nbsp; mov dl,al<br />&nbsp; &nbsp; and dl,0F0h<br />&nbsp; &nbsp; shr dl,01h<br />&nbsp; &nbsp; shr dl,01h<br />&nbsp; &nbsp; shr dl,01h<br />&nbsp; &nbsp; shr dl,01h&nbsp; <br />&nbsp; &nbsp; mov buf[4],dl<br />&nbsp; &nbsp; mov dl,al<br />&nbsp; &nbsp; and dl,0Fh <br />&nbsp; &nbsp; mov buf[5],dl <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov bx,2h <br />&nbsp; &nbsp; mov cx,0h<br />&nbsp; &nbsp; mov cl,buf[1]&nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; res:<br />&nbsp; &nbsp; &nbsp; mov al,buf<br />&nbsp; &nbsp; &nbsp; add al,7h<br />&nbsp; &nbsp; &nbsp; cmp al,10h<br />&nbsp; &nbsp; &nbsp; jl&nbsp; let&nbsp; <br />&nbsp; &nbsp; &nbsp; add al,30h<br />&nbsp; &nbsp; &nbsp; lab:<br />&nbsp; &nbsp; &nbsp; mov buf,al <br />&nbsp; &nbsp; &nbsp; inc bx&nbsp; &nbsp;  <br />&nbsp; &nbsp; loop res <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; MOV BUF,&#039;$&#039;<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah,09h<br />&nbsp; &nbsp; lea dx,msg3<br />&nbsp; &nbsp; int 21h&nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; MOV AH,09H<br />&nbsp; &nbsp; LEA DX,BUF<br />&nbsp; &nbsp; ADD DX,2<br />&nbsp; &nbsp; INT 21H<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; mov ah, 01h<br />&nbsp; &nbsp; int 21h<br />&nbsp; &nbsp; mov ax,4c00h<br />&nbsp; &nbsp; int 21h <br /><br />&nbsp;  dex:<br />&nbsp; &nbsp; &nbsp; &nbsp; mov bh,0h<br />&nbsp; &nbsp; &nbsp; &nbsp; jmp ambs<br /><br />&nbsp;  well proc&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; cmp al,10h<br />&nbsp; &nbsp; &nbsp; &nbsp; jg alpha<br />&nbsp; &nbsp; &nbsp; &nbsp; here: <br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; well endp <br /><br />&nbsp;  alpha:<br />&nbsp; &nbsp; &nbsp;  sub al,10h<br />&nbsp; &nbsp; &nbsp;  cmp al,1h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alA<br />&nbsp; &nbsp; &nbsp;  cmp al,2h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alB<br />&nbsp; &nbsp; &nbsp;  cmp al,3h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alC<br />&nbsp; &nbsp; &nbsp;  cmp al,4h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alD<br />&nbsp; &nbsp; &nbsp;  cmp al,5h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alE<br />&nbsp; &nbsp; &nbsp;  cmp al,6h<br />&nbsp; &nbsp; &nbsp;  je&nbsp; alF&nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; alA:<br />&nbsp; &nbsp; &nbsp;  mov al,0Ah<br />&nbsp; &nbsp; &nbsp;  jmp here<br /><br />&nbsp; &nbsp; alB:<br />&nbsp; &nbsp; &nbsp;  mov al,0Bh<br />&nbsp; &nbsp; &nbsp;  jmp here<br /><br />&nbsp; &nbsp; alC:<br />&nbsp; &nbsp; &nbsp;  mov al,0Ch <br />&nbsp; &nbsp; &nbsp;  jmp here<br /><br />&nbsp; &nbsp; alD:<br />&nbsp; &nbsp; &nbsp;  mov al,0Dh<br />&nbsp; &nbsp; &nbsp;  jmp here<br /><br />&nbsp; &nbsp; alE:<br />&nbsp; &nbsp; &nbsp;  mov al,0Eh<br />&nbsp; &nbsp; &nbsp;  jmp here<br /><br />&nbsp; &nbsp; alF:<br />&nbsp; &nbsp; &nbsp;  mov al,0Fh<br />&nbsp; &nbsp; &nbsp;  jmp here<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; let:<br />&nbsp; &nbsp; &nbsp; &nbsp; sub al,7h<br />&nbsp; &nbsp; &nbsp; &nbsp; add al,30h<br />&nbsp; &nbsp; &nbsp; &nbsp; jmp lab<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; main endp<br />&nbsp; &nbsp; end start<br /><br /><br />I have given up....don&#039;t know what the errors means....<br /><br />draft2.asm(164): error a2006 :alpha<br />draft2.asm(186): error a2006 :here<br />draft2.asm(190): error a2006 :here<br />draft2.asm(194): error a2006 :here<br />draft2.asm(198): error a2006 :here<br />draft2.asm(202): error a2006 :here<br />draft2.asm(206): error a2006 :here<br /><br />please help me...don&#039;t know what are the meaning of the error a2006 because it seems my code works well in other compiler but my instructor tells us to do in masm611<br /><br />you could download my assembler here:<br /> http://downloadzone.ucoz.com/publ/14-1-0-24</div>
    <div class="meta">Posted on 2009-10-13 15:28:22 by web4</div>
   </div>
   <div class="post" id="post-209152">
    <div class="subject"><a href="#post-209152">Re: Translate this to Masm</a></div>
    <div class="body">Hi web4,<br /><br />&quot;I have given up...&quot;<br /><br />No, no, no, no no! There are three important rules for learning asm.<br /><br />1) never give up<br />2) never give up<br />3) never give up<br /><br />Besides, you&#039;re really close! You&#039;ve really only got one error - &quot; a2006&quot; - and on two labels. That&#039;s a lot better than when you started off!<br /><br />Being Nasmist (I thought Nasm&#039;s error messages were unhelpful!), I have no idea what &quot;a2006&quot; means. I could download Masm - I ASSume there are docs? - and look it up, but you might as well learn to do it. Probably not the last error message you&#039;ll see! :)<br /><br />I&#039;ll take a wild guess, though. I notice that both of the labels barfing up errors are between &quot;proc&quot; and &quot;endp&quot;. I&#039;m going to guess that these are &quot;local&quot; labels, &quot;visible&quot; only within the procedure. A simple way to test this theory would be to comment out &quot;well proc&quot; and &quot;well endp&quot;. Just put &quot;well:&quot; before your procedure... and of course it ends with &quot;ret&quot; (congratulations!). &quot;proc&quot; and &quot;endp&quot; are fine macros, and in some cases they generate useful code. In this case, I&#039;m pretty sure they aren&#039;t generating anything you need, and they may be screwing you up. I hope this theory is correct - it might solve all your problems. Well... might get it to assemble - there &quot;could&quot; still be bugs. :)<br /><br />You might also be able to improve this code further...<br />&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; alA:<br />&nbsp; &nbsp; &nbsp;  mov al,0Ah<br />&nbsp; &nbsp; &nbsp;  jmp here<br /><br />&nbsp; &nbsp; alB:<br />&nbsp; &nbsp; &nbsp;  mov al,0Bh<br />&nbsp; &nbsp; &nbsp;  jmp here<br /><br />&nbsp; &nbsp; alC:<br />&nbsp; &nbsp; &nbsp;  mov al,0Ch<br />&nbsp; &nbsp; &nbsp;  jmp here<br /><br />&nbsp; &nbsp; alD:<br />&nbsp; &nbsp; &nbsp;  mov al,0Dh<br />&nbsp; &nbsp; &nbsp;  jmp here<br />...<br /><br />Can you see a &quot;pattern&quot; developing here? If al is greater than 10, we jump off to &quot;alpha&quot;, where we subtract 10 from al, and then if al = 1, jump off to put 0Ah in al, if al =2, put 0Bh in al... and then, in each case, jump back to &quot;here:&quot;. Would an &quot;add&quot; instruction help here? If you could squeeze all that cruft inside your &quot;well&quot; &quot;proc&quot;, it might work even with the &quot;proc&quot; and &quot;endp&quot; (but I still don&#039;t think they do anything for ya).<br /><br />To make this work, you might need to reverse the sense of the &quot;conditional jumps&quot; we were discussing. They all (almost all?) have &quot;n&quot; forms - &quot;jg alpha&quot;, &quot;jng not_alpha&quot;...<br /><br />As I was reading through your code, I thought &quot;this is looking good!&quot;, so I was disappointed to see the errors at the end, but I don&#039;t think it&#039;s too &quot;serious&quot;. You still need to think about what you&#039;re going to do with invalid input (check ASAP, is my advice). And note that the &quot;div&quot; instruction gives you both quotient and remainder. For &quot;extra credit&quot;, you might want to show the remainder, too. Depends on how much time you&#039;ve got...<br /><br />Best,<br />Frank<br /><br /><br /><br /></div>
    <div class="meta">Posted on 2009-10-13 18:03:42 by fbkotler</div>
   </div>
   <div class="post" id="post-209154">
    <div class="subject"><a href="#post-209154">Re: Translate this to Masm</a></div>
    <div class="body">Ah, it&#039;s my favorite: MASM versions. MASM 5.1 (without defined language type) treats labels inside <strong>PROC</strong> â€¦ <strong>ENDP</strong> as global, MASM 6.11 assumes they&#039;re local to enclosing <strong>PROC</strong> (thus reference can&#039;t cross <strong>PROC</strong> boundary). Add <strong>OPTION NOSCOPED</strong> directive somewhere at the beginning, it will fix this issue.<br /><br />How do you expect to learn MASM (or whatever) without manuals?</div>
    <div class="meta">Posted on 2009-10-13 18:47:03 by baldr</div>
   </div>
   <div class="post" id="post-209157">
    <div class="subject"><a href="#post-209157">Re: Translate this to Masm</a></div>
    <div class="body">Thank you so much baldr...you are truly a masm expert....thank very much also fbkotler for keeping me realizing on where to improve my poor codings....thank you so much!!!! God bless you</div>
    <div class="meta">Posted on 2009-10-13 20:38:50 by web4</div>
   </div>
  </div>
 </body>
</html>