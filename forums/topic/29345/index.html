<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Question about GetCommandLine  - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29345" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=113">Low Level Concepts</a> &raquo; <a href="../?id=29345">Question about GetCommandLine </a></p>
   <div class="post" id="post-207228">
    <div class="subject"><a href="#post-207228">Question about GetCommandLine </a></div>
    <div class="body">Is there any possible way to make the GetCommandLine Returns 2 paths of 2 files.<br />Ex:- when i use GetCommandLine it returns to me the path of the Exe(Running File) only,i want it to return two paths the Exe and another files in the same Destination is it possible?! </div>
    <div class="meta">Posted on 2009-04-05 21:53:51 by BlackGear</div>
   </div>
   <div class="post" id="post-207234">
    <div class="subject"><a href="#post-207234">Re: Question about GetCommandLine </a></div>
    <div class="body"><em><a target="_blank" href="http://google.com/search?q=GetCommandLine+site:msdn.microsoft.com">GetCommandLine()</a></em> returns, funnily enough, the program command line. On win32, the command line consists of the executable and the arguments given to CreateProcess, if any.<br /><br />If you want to get a list of the files in the folder your executable is in, you&#039;ll have to parse out the module path (though I suggest getting it from <em><a target="_blank" href="http://google.com/search?q=GetModuleFileName+site:msdn.microsoft.com">GetModuleFileName()</a></em>, specifying <em><a target="_blank" href="http://google.com/search?q=GetModuleHandle+site:msdn.microsoft.com">GetModuleHandle(0)</a></em> as module handle, to be certain you&#039;re getting the right path), and then iterate the files with <em><a target="_blank" href="http://google.com/search?q=FindFirstFile+site:msdn.microsoft.com">FindFirstFile()</a></em> and <em><a target="_blank" href="http://google.com/search?q=FindNextFile+site:msdn.microsoft.com">FindNextFile()</a></em>.<br /><br />Or is it something else you want?</div>
    <div class="meta">Posted on 2009-04-06 04:05:43 by f0dder</div>
   </div>
   <div class="post" id="post-207237">
    <div class="subject"><a href="#post-207237">Re: Question about GetCommandLine </a></div>
    <div class="body">thanx for your help,i had asked my question because i had found a app check for a file existence by GetCommandLine so i want to ask is there any way to add this file to the arguments.</div>
    <div class="meta">Posted on 2009-04-06 05:27:47 by BlackGear</div>
   </div>
   <div class="post" id="post-207239">
    <div class="subject"><a href="#post-207239">Re: Question about GetCommandLine </a></div>
    <div class="body">the executable filename is usually the first argument...<br />make a silly program which calls GetCommandLine, load up olly and look at the buffer...</div>
    <div class="meta">Posted on 2009-04-06 10:37:09 by evlncrn8</div>
   </div>
  </div>
 </body>
</html>