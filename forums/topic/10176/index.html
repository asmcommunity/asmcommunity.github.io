<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Multi Threading? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10176" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=10176">Multi Threading?</a></p>
   <div class="post" id="post-76288">
    <div class="subject"><a href="#post-76288">Multi Threading?</a></div>
    <div class="body">Hi could someone give me some help concerning CreateThread,this is my code im trying to create a thread which just popups a messagebox, the function call returns successful with a handle to a new thread but no messagebox appears. This is mysterious obviusly my code is wrong or something.<br />here is the offending code<br /><br />section '.code' code readable writeable executable<br />start:<br />        invoke CreateThread,NULL,NULL,ThreadProc,NULL,0,ThreadID<br />        invoke CloseHandle,eax<br />Exit:<br />        invoke ExitProcess,0<br /><br /><br />proc ThreadProc,Param:DWORD<br />     enter<br />     invoke MessageBox,NULL,Caption,AppName,MB_OK<br />     return           <br /><br />any help would be appreciated.<br />thnx</div>
    <div class="meta">Posted on 2003-01-14 11:20:24 by keyoke</div>
   </div>
   <div class="post" id="post-76294">
    <div class="subject"><a href="#post-76294">Multi Threading?</a></div>
    <div class="body">You are just closing the thread too fast. Try putting &quot;invoke Sleep,1000&quot; after the CreateThread and you'll see what I mean.</div>
    <div class="meta">Posted on 2003-01-14 11:59:45 by Tomasz Grysztar</div>
   </div>
   <div class="post" id="post-76295">
    <div class="subject"><a href="#post-76295">Multi Threading?</a></div>
    <div class="body">Ha ha it works.....but it doesnt wait for user to click ok on msgbox :( how can i make it wait? if it had other code not msgbox in, would that code run to completion before the thread terminates?</div>
    <div class="meta">Posted on 2003-01-14 12:06:16 by keyoke</div>
   </div>
   <div class="post" id="post-76298">
    <div class="subject"><a href="#post-76298">Multi Threading?</a></div>
    <div class="body"><pre><code><br />        invoke  CreateThread,NULL,NULL,ThreadProc,NULL,0,ThreadID<br />        invoke  WaitForSingleObject,eax,-1<br />        invoke  ExitProcess,0<br /></code></pre></div>
    <div class="meta">Posted on 2003-01-14 12:13:39 by Tomasz Grysztar</div>
   </div>
   <div class="post" id="post-76299">
    <div class="subject"><a href="#post-76299">Multi Threading?</a></div>
    <div class="body">Aahh<br />thanks for the help :)</div>
    <div class="meta">Posted on 2003-01-14 12:23:15 by keyoke</div>
   </div>
   <div class="post" id="post-76391">
    <div class="subject"><a href="#post-76391">Multi Threading?</a></div>
    <div class="body">Shouldn't it be :<br /><br /><pre><code><br />invoke MessageBox,NULL, addr Caption, addr AppName,MB_OK<br />[\CODE]<br /><br />?</div>
    <div class="meta">Posted on 2003-01-15 01:34:58 by Axial</div>
   </div>
   <div class="post" id="post-76620">
    <div class="subject"><a href="#post-76620">Multi Threading?</a></div>
    <div class="body">What makes you say that?</div>
    <div class="meta">Posted on 2003-01-16 06:46:37 by keyoke</div>
   </div>
  </div>
 </body>
</html>