<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How to build a combo box with scrollbar ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15359" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15359">How to build a combo box with scrollbar ?</a></p>
   <div class="post" id="post-119350">
    <div class="subject"><a href="#post-119350">How to build a combo box with scrollbar ?</a></div>
    <div class="body">Do you get any idea ?<br />My combo box has about 26 items so I have to declare its height with a quite big value. When it shows its content, the whole list of items appears. It is too long ! I'd like to know whether or not I can limit the number of visible items at a time by using a scrollbar. Thanks !</div>
    <div class="meta">Posted on 2003-09-25 02:46:36 by hcm2k3</div>
   </div>
   <div class="post" id="post-119352">
    <div class="subject"><a href="#post-119352">How to build a combo box with scrollbar ?</a></div>
    <div class="body">1. Create a combobox with WS_VSCROLL Style<br />2. Set font to it<br />3. Get item height - SendMessage(...,CB_GETITEMHEIGHT,..)<br />4. GetWindowRect(yourcombohandle,RECT)<br />5. Calculate target combobox height: RECT.bottom - RECT.top + 2 + limit_display_to * item_height<br />6. SetWindowPos<br /><br />This &quot;+2&quot; in the size is for the dropdownlist border size (1 at the top + 1 at the bottom)<br /><br />limit_display_to is, for example, 8. If you put more items to your combobox, the scrollbar will appear<br /><br />HTH</div>
    <div class="meta">Posted on 2003-09-25 03:11:57 by Morris</div>
   </div>
   <div class="post" id="post-119541">
    <div class="subject"><a href="#post-119541">How to build a combo box with scrollbar ?</a></div>
    <div class="body"><div class="quote"><br />5. Calculate target combobox height: RECT.bottom - RECT.top + 2 + limit_display_to * item_height<br /></div><br />Thanks ! BTW, how can I compute item_height ? It is the height of the font used in the combo box, the height of the combo box when closed or anything else ?</div>
    <div class="meta">Posted on 2003-09-25 23:25:43 by hcm2k3</div>
   </div>
   <div class="post" id="post-119555">
    <div class="subject"><a href="#post-119555">How to build a combo box with scrollbar ?</a></div>
    <div class="body"><div class="quote">BTW, how can I compute item_height ? It is the height of the font used in the combo box</div><br /><br />After you set the font to the combobox, do:<br />SendMessage(hCombo,CB_GETITEMHEIGHT,0,0)<br /><br />And yes, the item height is the height of the combobox font.</div>
    <div class="meta">Posted on 2003-09-26 01:52:47 by Morris</div>
   </div>
  </div>
 </body>
</html>