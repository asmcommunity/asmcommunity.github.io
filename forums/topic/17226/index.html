<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>DllRegisterServer entry point - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17226" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=17226">DllRegisterServer entry point</a></p>
   <div class="post" id="post-133514">
    <div class="subject"><a href="#post-133514">DllRegisterServer entry point</a></div>
    <div class="body">How do I provide my dll with a DllRegisterServer entry point. When installing the dll with a bat file like<pre><code>@echo off<br />copy NMEA.dll %SystemRoot%\system32<br />regsvr32 %SystemRoot%\system32\NMEA.dll</code></pre><br />I get the following messagebox<pre><code>RegSvr32<br /><br />C&#58;\WINNT\System32\NMEA.dll was loaded, but the DllRegisterServer entry point was not found.<br /><br />DllRegisterServer may not be exported, or a corrupt version of C&#58;\WINNT\system32\NMEA.dll <br />may be in memory. Consider using PView to detect and remove it.</code></pre></div>
    <div class="meta">Posted on 2004-02-14 11:50:49 by minor28</div>
   </div>
   <div class="post" id="post-133531">
    <div class="subject"><a href="#post-133531">DllRegisterServer entry point</a></div>
    <div class="body">Are you writing a COM or ActiveX dll? If you are not, then you do not need to register your dll. DllRegisterServer is exported with no parameters. Here is an excerpt of documentation from MSDN:<br /><br /><div class="quote"><br />DllRegisterServer<br />Instructs an in-process server to create its registry entries for all classes supported in this server module. If this function fails, the state of the registry for all its classes is indeterminate.<br /><br />STDAPI DllRegisterServer(void);<br /><br />Return Values<br />This function supports the standard return values E_OUTOFMEMORY and E_UNEXPECTED, as well as the following: <br /><br />S_OK <br />The registry entries were created successfully. <br /><br />SELFREG_E_TYPELIB <br />The server was unable to complete the registration of all the type libraries used by its classes. <br /><br />SELFREG_E_CLASS <br />The server was unable to complete the registration of all the object classes. <br /><br /><br />Remarks<br />E_NOTIMPL is not a valid return code.<br /></div></div>
    <div class="meta">Posted on 2004-02-14 17:17:10 by sluggy</div>
   </div>
   <div class="post" id="post-133562">
    <div class="subject"><a href="#post-133562">DllRegisterServer entry point</a></div>
    <div class="body">I am improving my Visual Basic knowledge and I have written a masm dll with a string parsing function. I works well. Now I have found some annoying things with the VB IDE. For example you can't set any options to open code window maximized or set you own project path. That's what I am working with now.<br /><br />I have succeded to create an addin to VB to open the code window maximized at start up, but nothing more. There are no standard events that suits my purpose. Now I am trying to hook and realize the need of masm.<br /><br />Therefore I will try to write an addin in masm. Perhaps it is a COM dll. I have read the threads at COM board. I seems to be very difficult to understand. Any hints are wellcome.<br /><br />Best Regards.</div>
    <div class="meta">Posted on 2004-02-15 04:05:11 by minor28</div>
   </div>
  </div>
 </body>
</html>