<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>OK now - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19125" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19125">OK now</a></p>
   <div class="post" id="post-147874">
    <div class="subject"><a href="#post-147874">OK now</a></div>
    <div class="body">I figured out last problem. I have two machines. A desktop with 512 Meg and a laptop with supposedly 256Meg. I beleive it is actually shy of 256Meg but larger than 128Meg. What happened is the program would determine that it was 128Meg and therefore would limit the seach to that amout when the 4K pages the program was looking for was outside 128Meg so it limited the search and the 4K pages were never found.<br /><br />FindMemSize:<br />       <br />        push eax<br />        push edi<br />        push esi<br />        mov esi,08BC00000h<br />        invlpg dword ptr <br />        shr esi,14h<br />        or esi,0C0300000h<br />        mov eax,0F9C001E3h          ; Test if 4Gig Physical Mem*<br />        mov dword ptr ,eax<br />        mov esi,08bd001e0h          ; Up 1Meg from base<br />        mov eax,055AA55AAh<br />        mov dword ptr ,eax<br />        nop<br />        nop<br />        mov eax,dword ptr <br />        cmp eax,055AA55AAh<br />        jnz try2Gig<br />        mov eax,03E7h               ; Set up number of 4Meg pages*<br />        mov FoundMemSize,eax<br />        pop esi<br />        pop edi<br />        pop eax<br />        retn<br />try2Gig:<br />        mov esi,08BC00000h<br />        invlpg dword ptr <br />        shr esi,14h<br />        or esi,0C0300000h<br />        mov eax,07CC001E3h          ; Test if 2Gig Physical Mem*<br />        mov dword ptr ,eax<br />        mov esi,08bd001e0h          ; Up 1Meg from base<br />        mov eax,055AA55AAh<br />        mov dword ptr ,eax<br />        nop<br />        nop<br />        mov eax,dword ptr <br />        cmp eax,055AA55AAh<br />        jnz try1Gig<br />        mov eax,01F3h               ; Set up number of 4Meg pages*<br />        mov FoundMemSize,eax<br />        pop esi<br />        pop edi<br />        pop eax<br />        retn<br />try1Gig:<br />        mov esi,08BC00000h<br />        invlpg dword ptr <br />        shr esi,14h<br />        or esi,0C0300000h<br />        mov eax,03E4001E3h          ; Test if 1Gig Physical Mem*<br />        mov dword ptr ,eax<br />        mov esi,08bd001e0h          ; Up 1Meg from base<br />        mov eax,055AA55AAh<br />        mov dword ptr ,eax<br />        nop<br />        nop<br />        mov eax,dword ptr <br />        cmp eax,055AA55AAh<br />        jnz try512Meg<br />        mov eax,0F9h               ; Set up number of 4Meg pages*<br />        mov FoundMemSize,eax<br />        pop esi<br />        pop edi<br />        pop eax<br />        retn<br />try512Meg:<br />        mov esi,08BC00000h<br />        invlpg dword ptr <br />        shr esi,14h<br />        or esi,0C0300000h<br />        mov eax,01F0001E3h          ; Test if 512Meg Physical Mem*<br />        mov dword ptr ,eax<br />        mov esi,08bd001e0h          ; Up 1Meg from base<br />        mov eax,055AA55AAh<br />        mov dword ptr ,eax<br />        nop<br />        nop<br />        mov eax,dword ptr <br />        cmp eax,055AA55AAh<br />        jnz try256Meg<br />        mov eax,07Ch               ; Set up number of 4Meg pages*<br />        mov FoundMemSize,eax<br />        pop esi<br />        pop edi<br />        pop eax<br />        retn<br />try256Meg:<br />        mov esi,08BC00000h<br />        invlpg dword ptr <br />        shr esi,14h<br />        or esi,0C0300000h<br />        mov eax,0F4001E3h           ; Test if 256Meg Physical Mem*<br />        mov dword ptr ,eax<br />        mov esi,08bd001e0h          ; Up 1Meg from base<br />        mov eax,055AA55AAh<br />        mov dword ptr ,eax<br />        nop<br />        nop<br />        mov eax,dword ptr <br />        cmp eax,055AA55AAh<br />        jnz try128Meg<br />        mov eax,03Dh               ; Set up number of 4Meg pages*<br />        mov FoundMemSize,eax<br />        pop esi<br />        pop edi<br />        pop eax<br />        retn<br />try128Meg:<br />        mov esi,08BC00000h<br />        invlpg dword ptr <br />        shr esi,14h<br />        or esi,0C0300000h<br />        mov eax,078001E3h           ; Test if 128Meg Physical Mem*<br />        mov dword ptr ,eax<br />        mov esi,08bd001e0h          ; Up 1Meg from base<br />        mov eax,055AA55AAh<br />        mov dword ptr ,eax<br />        nop<br />        nop<br />        mov eax,dword ptr <br />        cmp eax,055AA55AAh<br />        jnz nothingMem<br />        mov eax,<strong>03Dh</strong>               ; Set up number of 4Meg pages*<br />        mov FoundMemSize,eax<br />nothingMem:<br />        pop esi<br />        pop edi<br />        pop eax<br />        retn<br /><br />  If you look right above you will see I changed from a 1E to 3D for 128 Meg determination (these are number of 4Meg pages). Now the program will page fault for nonexisting memory but it is handled.<br />  This was the final problem and you may run into this yourself if you have a non standard amount of memory like unstead of 512Meg you have 400Meg. Than you will need to edit this code yourself in the driver BAT file (code above). You may ask why didn't I just call all computers 4Gig memory? The reason is running through that many page faults takes some time.<br />   At any rate the program once again will edit any physical memory and find search strings of other programs that you may edit. It has some I/O control. It reads and edits 4K at a time. It is not user freindly but if you read the instructions carefully and operate it a few times it will become second nature in operation and is an extremely useful tool for learning and debugging. The program would not be possible without the awesome work of our freind Four-F.</div>
    <div class="meta">Posted on 2004-08-10 23:37:04 by mrgone</div>
   </div>
   <div class="post" id="post-147930">
    <div class="subject"><a href="#post-147930">Didn't let me attach on edit</a></div>
    <div class="body">So here it is:<br /><br /><br />It's just been noted that when using search string command to search specific data out of memory I did not give it an out if the memory doesn't exist. Have to fix later. No time now. Better get back to regular job...lol</div>
    <div class="meta">Posted on 2004-08-11 20:09:45 by mrgone</div>
   </div>
  </div>
 </body>
</html>