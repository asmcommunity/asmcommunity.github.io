<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Scripting for RadASM 3 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30549" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=42">RadASM</a> &raquo; <a href="../?id=30549">Scripting for RadASM 3</a></p>
   <div class="post" id="post-214340">
    <div class="subject"><a href="#post-214340">Scripting for RadASM 3</a></div>
    <div class="body">Hi KetilO<br />As I mentioned sometime ago, I started working on a ScriptHost for RadASM3. So far I got the first shot and I implemented 3 objects with the following methods<br /><br /><pre><code><br />RadASM.GetEditor &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;returns an editor object of an open MDI child<br />RadASM.SaveAll &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;saves all open files<br />RadASM.CloseAll &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; closes all open files<br />RadASM.Sleep &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;sleeps n milisecs<br />RadASM.SendMessage &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SendMessage API for test purposes only<br /><br />Output.hWnd &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Output window handle<br />Output.Clear &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Clears the window<br />Output.Write &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Writes to the window<br />Output.Font &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Sets the output font, doesn&#039;t work yet<br />Output.Foreground &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Sets the forground color, doesn&#039;t work<br />Output.Background &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Sets the background color, doesn&#039;t work<br />Output.SendMessage &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SendMessage API for test purposes only<br /><br />Editor.hWnd &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Editor window handle<br />Editor.Clear &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Clears the editor window<br />Editor.LineCount &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Returns the line count<br />Editor.Line &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Puts/Gets a line of the editor<br />Editor.InsertLine &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Inserts a new line<br />Editor.DeleteLine &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Deletes a line<br />Editor.Save &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Saves the editor to a file, not implemented<br />Editor.SaveAs &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Saves the editor to a new file, not implemented<br />Editor.SendMessage &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SendMessage API for test purposes only<br /></code></pre><br />As you can see, I have some unimplemented stuff and other that doesn’t work.<br />Some hits from your part may help pushing this project forward.<br />In particular, how to setup the output window colors and how to save an editor content to file.<br /><br />The other 2 problems I found (maybe bugs) are the EM_GETLINECOUNT message sent to the edit window. It returns 1 line less than it should. <br />The second problem is the EM_LINEINDEX message, that does not return -1 if the index is bigger than the last line.<br /><br />I’m open to new ideas and I want to discuss if the object structure I’d chosen is really the best.<br /><br />Currently the scripts have the “vbs” file extension, but I’m considering to change it to “ras”<br /><br />Attached are the Addin DLL and some demo scripts. If wanted I can supply the sources too.<br /><br />Regards,<br /><br />Biterider<br /><br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=3328" target="_blank">RA3_Scripting.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2011-05-01 07:20:37 by Biterider</div>
   </div>
   <div class="post" id="post-214351">
    <div class="subject"><a href="#post-214351">Re: Scripting for RadASM 3</a></div>
    <div class="body">New upload. I&#039;ve corrected some bugs and added a new script demo.<br /><br />Biterider</div>
    <div class="meta">Posted on 2011-05-07 01:54:27 by Biterider</div>
   </div>
  </div>
 </body>
</html>