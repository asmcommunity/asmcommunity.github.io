<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Converting ASM file from TASM TO MASM - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26177" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26177">Converting ASM file from TASM TO MASM</a></p>
   <div class="post" id="post-190501">
    <div class="subject"><a href="#post-190501">Converting ASM file from TASM TO MASM</a></div>
    <div class="body">Hi!
I'm trying to change asm file written in TASM in to MASM. I think I have changed 80% of the file but I'm stuck on some a error which looks simple but is complicated.

All errors are same, compiler doesn't understand what (,) comma is? 

 Call GetModuleHandle,0
 Call ExitProcess,0

ERRORS:
masm.asm(80) : error A2008: syntax error : ,
masm.asm(83) : error A2008: syntax error : ,

thanks,
TADA

PS: I'm using IDE-ASM</div>
    <div class="meta">Posted on 2000-11-18 00:58:00 by TADA</div>
   </div>
   <div class="post" id="post-190502">
    <div class="subject"><a href="#post-190502">Converting ASM file from TASM TO MASM</a></div>
    <div class="body">In MASM, 'CALL' does not take any parameters, thats the error you get.

Looks to me you should be using 'INVOKE' there in place of 'CALL'</div>
    <div class="meta">Posted on 2000-11-18 01:25:00 by TTom </div>
   </div>
   <div class="post" id="post-190503">
    <div class="subject"><a href="#post-190503">Converting ASM file from TASM TO MASM</a></div>
    <div class="body">yeah i also wonder why this is not working in MASM

DDO_CreateSurface equ 16

.....


mov eax,
push eax
call [ eax+DDO_CreateSurface]

....

eh?</div>
    <div class="meta">Posted on 2000-11-18 08:30:00 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-190504">
    <div class="subject"><a href="#post-190504">Converting ASM file from TASM TO MASM</a></div>
    <div class="body">It seems like you're trying to do com in asm. Hremmm.... someone really should devote a web page to that, huh?

Please post a interface definition (either link or function members) with their parameters. COM calls must be explicitly correct or they make nasty GPFs.

All I could tell from your post is that *IF* lp_main_direct_draw_object is cast as the proper interface, and it inherits just from IUnknown, and DDO_CreateSurface is the first custom function of the interface, and it requires no parameters, then the code looks OK.

(This DirectX stuff seems popular, I'm gonna have to make some support stuff for it soon I believe)</div>
    <div class="meta">Posted on 2000-11-18 18:11:00 by TTom </div>
   </div>
  </div>
 </body>
</html>