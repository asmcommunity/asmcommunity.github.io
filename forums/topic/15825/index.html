<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>RegReplaceKey how to ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15825" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15825">RegReplaceKey how to ?</a></p>
   <div class="post" id="post-122595">
    <div class="subject"><a href="#post-122595">RegReplaceKey how to ?</a></div>
    <div class="body">Hello,<br />how do you work with RegReplaceKey ?<br /><br /><br />I create a regkey 'AA' and then i try:<br /><br />RegReplaceKeyA PROTO :DWORD,:DWORD,:DWORD,:DWORD<br />RegReplaceKey equ &lt;RegReplaceKeyA&gt;<br /><br />.data<br />REGKeyHandle    dd 0<br />keyname1        db 'AA',0<br />keyname2        db 'BB', 0<br /><br />.code<br />invoke RegReplaceKeyA,80000001h,addr keyname1,addr keyname2,REGKeyHandle<br /><br />or<br /><br />invoke RegReplaceKeyA,80000001h,addr keyname2,addr keyname1,REGKeyHandle<br /><br />booth dont work...</div>
    <div class="meta">Posted on 2003-10-27 14:02:49 by xanthos</div>
   </div>
   <div class="post" id="post-122632">
    <div class="subject"><a href="#post-122632">RegReplaceKey how to ?</a></div>
    <div class="body">From MSDN<br /><br /><div class="quote"><br />The RegReplaceKey function replaces the file backing a registry key and all its subkeys with another file, so that when the system is next started, the key and subkeys will have the values stored in the new file. <br /><br />LONG RegReplaceKey(<br />  HKEY hKey,         // handle to open key<br />  LPCTSTR lpSubKey,  // subkey name<br />  LPCTSTR lpNewFile, // data file<br />  LPCTSTR lpOldFile  // backup file<br />);<br /></div></div>
    <div class="meta">Posted on 2003-10-27 21:29:51 by japheth</div>
   </div>
  </div>
 </body>
</html>