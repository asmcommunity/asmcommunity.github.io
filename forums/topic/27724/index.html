<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>toolbar color - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27724" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27724">toolbar color</a></p>
   <div class="post" id="post-197689">
    <div class="subject"><a href="#post-197689">toolbar color</a></div>
    <div class="body">Is it possible to change a toolbar's background and button color?

Thomas</div>
    <div class="meta">Posted on 2001-04-20 15:54:00 by Thomas</div>
   </div>
   <div class="post" id="post-197690">
    <div class="subject"><a href="#post-197690">toolbar color</a></div>
    <div class="body">Yes.
Is black OK?
 invoke CreateToolbarEx,hWin,WS_CHILD or WS_CLIPSIBLINGS or WS_VISIBLE,
	300,1,0,0,ADDR tbb,
	1,16,16,0,0, sizeof TBBUTTON
 mov hToolBar,eax
 invoke SetClassLong,eax,GCL_HBRBACKGROUND,8
You promised me to think of time function - remember :)</div>
    <div class="meta">Posted on 2001-04-20 16:24:00 by The Svin</div>
   </div>
   <div class="post" id="post-197691">
    <div class="subject"><a href="#post-197691">toolbar color</a></div>
    <div class="body">Hmm it doesn't seem to work. SetClassLong succeeds but nothing changes. :confused:

Thomas
P.S. I will try to rewrite FileTimeToSystemTime, problem is I don't know if the math will be correct. But I can make a program that tries both functions (API & own function) and compares the results for various filetimes.

This message was edited by Thomas, on 4/20/2001 6:26:17 PM</div>
    <div class="meta">Posted on 2001-04-20 18:25:00 by Thomas</div>
   </div>
   <div class="post" id="post-197692">
    <div class="subject"><a href="#post-197692">toolbar color</a></div>
    <div class="body">I've checked it. It worked - turned the toolbar to black.
Do you need the whole code?
The Svin.</div>
    <div class="meta">Posted on 2001-04-21 05:56:00 by The Svin</div>
   </div>
   <div class="post" id="post-197693">
    <div class="subject"><a href="#post-197693">toolbar color</a></div>
    <div class="body">Yes, please send it to me, maybe I forgot something stupid.

Thomas</div>
    <div class="meta">Posted on 2001-04-21 08:00:00 by Thomas</div>
   </div>
   <div class="post" id="post-197694">
    <div class="subject"><a href="#post-197694">toolbar color</a></div>
    <div class="body">I figured out ther problem but couldn't solve it. The problem is that my toolbar has a flat toolbar style. With this style set, your method doesn't work. When I remove the TBSTYLE_FLAT it works, but I want to keep the toolbar flat.
Any other ideas?

Thomas

Edit:
I think I'll just use a rebar control with a transparent toolbar on it. The background color/bitmap of a rebar control can be changed...

This message was edited by Thomas, on 4/21/2001 1:48:23 PM</div>
    <div class="meta">Posted on 2001-04-21 12:30:00 by Thomas</div>
   </div>
  </div>
 </body>
</html>