<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Is Win32 program running in Windows running inside a virtual - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2600" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2600">Is Win32 program running in Windows running inside a virtual</a></p>
   <div class="post" id="post-16538">
    <div class="subject"><a href="#post-16538">Is Win32 program running in Windows running inside a virtual</a></div>
    <div class="body">Probably seems like a stupid question to most of you, but something I really need to know. I guess it must be, due to the multitasking nature of the OS.</div>
    <div class="meta">Posted on 2001-12-28 17:29:18 by ClownHat</div>
   </div>
   <div class="post" id="post-16539">
    <div class="subject"><a href="#post-16539">Is Win32 program running in Windows running inside a virtual</a></div>
    <div class="body">No, it runs in protected mode. Even win32 console apps don't run in V86 mode; otherwise, how could you use 80x86 instructions, registers, etc.</div>
    <div class="meta">Posted on 2001-12-28 18:00:19 by eet_1024</div>
   </div>
   <div class="post" id="post-16541">
    <div class="subject"><a href="#post-16541">Is Win32 program running in Windows running inside a virtual</a></div>
    <div class="body">So, when one Windows program modifies a register, how do the rest keep running unaffected? Or is that what protected mode entails?<br />Sorry, I'm new to this very low level stuff.</div>
    <div class="meta">Posted on 2001-12-28 18:04:27 by ClownHat</div>
   </div>
   <div class="post" id="post-16544">
    <div class="subject"><a href="#post-16544">Is Win32 program running in Windows running inside a virtual</a></div>
    <div class="body">I believe (not 100% sure about that, but experts will correct me...)<br />that the only cases a Win32 prog is running into a VMM is when it is debugged or emulated (ie anti-virus software)</div>
    <div class="meta">Posted on 2001-12-28 18:52:37 by Axial</div>
   </div>
   <div class="post" id="post-16552">
    <div class="subject"><a href="#post-16552">Is Win32 program running in Windows running inside a virtual</a></div>
    <div class="body"><div class="quote"><br />So, when one Windows program modifies a register, how do the rest keep running unaffected? Or is that what protected mode entails?<br />Sorry, I'm new to this very low level stuff. </div><br /><br />Ive wondered to about this sometimes. If i was gonna make an operating system, the only thing i came up with to get around this problem is to keep the stack saved and the registers saved for every program. And when its that programs time to do some code, it restores everything from the saved variables. Then when its turn is over, it saves everything.<br /><br />But i really have no idea how they actually do it.</div>
    <div class="meta">Posted on 2001-12-28 20:38:03 by ChimpFace9000</div>
   </div>
   <div class="post" id="post-16554">
    <div class="subject"><a href="#post-16554">Is Win32 program running in Windows running inside a virtual</a></div>
    <div class="body">Phew, I'm not alone in being confused about that then.<br /><br />I thought the same thing as you did, about the register's states being saved, and then I figured that maybe the OS was the only thing to only use the <em>real</em> registers, and that the actual processes were given a space in memory to use as fake registers - which to me, IS a virtual machine.<br />Pah, I dunno.</div>
    <div class="meta">Posted on 2001-12-28 20:42:58 by ClownHat</div>
   </div>
   <div class="post" id="post-16557">
    <div class="subject"><a href="#post-16557">Is Win32 program running in Windows running inside a virtual</a></div>
    <div class="body">Your idea sounds better than mine. Sounds faster.</div>
    <div class="meta">Posted on 2001-12-28 21:21:36 by ChimpFace9000</div>
   </div>
   <div class="post" id="post-16558">
    <div class="subject"><a href="#post-16558">Is Win32 program running in Windows running inside a virtual</a></div>
    <div class="body">Saving and restoring is how it's done.<br /><br />The register values are saved when switching out of a thread, and the registers are restored when switching back into the thread.<br /><br />Emulating the x86 is highly undesirable, as you can't use the published optimizations. The 386 and later (includes Pentium) have memory management features that allow an OS writer to create virtual memory.</div>
    <div class="meta">Posted on 2001-12-28 21:43:18 by tank</div>
   </div>
   <div class="post" id="post-16565">
    <div class="subject"><a href="#post-16565">Is Win32 program running in Windows running inside a virtual</a></div>
    <div class="body">I believe that it is the OS's responsiblilty to preserve the registers during a task switch.<br /><br /><em>Understanding the Linux Kernal</em> by O'Reilly is a good book to read if your into low level behind the scenes.</div>
    <div class="meta">Posted on 2001-12-29 00:47:55 by eet_1024</div>
   </div>
  </div>
 </body>
</html>