<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>why my program chrashs wehen I call wsprintf ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12595" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12595">why my program chrashs wehen I call wsprintf ?</a></p>
   <div class="post" id="post-97465">
    <div class="subject"><a href="#post-97465">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">this pretty cute programm cause a crash of its self:<br />.data <br />	checkdrives	DWORD	0<br />	formattext	DB		&quot;%s		%d&quot;, 0<br />	formatbuffer	DB		150 DUP(0)<br />	formattemp	DB		150 DUP(0)<br /><br /><br />.code <br />start: <br />	;INVOKE GetLogicalDrives<br />	;MOV checkdrives, EAX<br />	<br />	INVOKE wsprintf, ADDR formatbuffer, ADDR formattext, checkdrives<br />	INVOKE MessageBox, NULL, formatbuffer, checkdrives, NULL<br />	INVOKE ExitProcess, NULL<br />END start <br /><br /><br />By the way, have I use GetLogicalDrives right ?</div>
    <div class="meta">Posted on 2003-04-17 07:26:31 by Forginforcer</div>
   </div>
   <div class="post" id="post-97467">
    <div class="subject"><a href="#post-97467">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">wsprintf crashes because it expected 4 parameter and you only passed 3 parameters. PS: No you got it wrong<br /><br /><div class="quote"><br />DWORD GetLogicalDrives(VOID)<br /> <br /><br />Parameters<br /><br />This function has no parameters. <br /><br />Return Values<br /><br />If the function succeeds, the return value is a bitmask representing the currently available disk drives. Bit position 0 (the least-significant bit) is drive A, bit position 1 is drive B, bit position 2 is drive C, and so on. <br />If the function fails, the return value is zero. <br /></div></div>
    <div class="meta">Posted on 2003-04-17 07:33:08 by roticv</div>
   </div>
   <div class="post" id="post-97470">
    <div class="subject"><a href="#post-97470">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">Year, I understoot, but I wanted to choose these cute BITs.<br /><br />P.S. Even now its crashs at wsprintf</div>
    <div class="meta">Posted on 2003-04-17 07:40:09 by Forginforcer</div>
   </div>
   <div class="post" id="post-97474">
    <div class="subject"><a href="#post-97474">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">reread my previous post... the format string is &quot;%s %d&quot;, thus it is expected that you pass 4 parameters and not 3.</div>
    <div class="meta">Posted on 2003-04-17 08:09:19 by roticv</div>
   </div>
   <div class="post" id="post-97476">
    <div class="subject"><a href="#post-97476">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">I'm sorry to be a ultra-twit !<br />Thats just my way of life:<br />&gt; sittting in front of my 2 computers.<br />&gt; organsiate girls who go under the table<br />&gt; hear musik all the time, even at night. I have about 50 fafourite songs. thats one of them : <a target="_blank" href="http://bbs-fachdemontage.de/BISON/ForThoseWhoDied.mp3">http://bbs-fachdemontage.de/BISON/ForThoseWhoDied.mp3</a><br />Its not illegal, its a free mp3.<br />&gt;And to do programming. Imaginee some commands, an wonder why it doesnt work, although I was hard to invent.<br /><br />Please accept me.<br /><br />Thanks a lot !:stupid:</div>
    <div class="meta">Posted on 2003-04-17 08:14:46 by Forginforcer</div>
   </div>
   <div class="post" id="post-97479">
    <div class="subject"><a href="#post-97479">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">Two computers,girls,music... You are a very lucky man,Forginforcer:alright: :)</div>
    <div class="meta">Posted on 2003-04-17 08:27:10 by Vortex</div>
   </div>
   <div class="post" id="post-97481">
    <div class="subject"><a href="#post-97481">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">Auspiciousness, I have solved my prob.<br />P.S.<br />THX, but I cant find the right girl, because the righ girls !<br />I want to get a very nice girl, who is very affectionate, faithfull and intelligent (that you will never find).<br />Have you heard the cool musik ?<br />I sometimes dream that I can sing so.<br />Even when I have medievil songs, where a very cool gilr sing I dream that I have the same voice. :cool: :confused:</div>
    <div class="meta">Posted on 2003-04-17 08:36:57 by Forginforcer</div>
   </div>
   <div class="post" id="post-97482">
    <div class="subject"><a href="#post-97482">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">Forginforcer,<br /><br />If the question is &quot;who is right person?&quot;... The person who understands you and who<br />shares your feelings and ideas.<br /><br />I am afraid,the moderators are coming here. :) So,better to conclude here this touchy subject. :)<br /><br />Good luck mon ami:alright:<br /><br />Vortex</div>
    <div class="meta">Posted on 2003-04-17 08:44:56 by Vortex</div>
   </div>
   <div class="post" id="post-97484">
    <div class="subject"><a href="#post-97484">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">Okay, as conclusion:<br />Newbies, dont be so silly to make the mistake I made.<br />Here is the right code:<br />__________________<br />.data<br />checkdrives	DWORD	&quot;5&quot;, 0<br />formattext	DB		&quot;%s		%dM Bytes&quot;, 0<br />formatbuffer	DB		150 DUP(0)<br />formattemp	DB		150 DUP(0)<br /><br />.code<br />INVOKE wsprintf, ADDR formatbuffer, ADDR formattext, ADDR checkdrives, ADDR checkdrives<br />	INVOKE MessageBox, NULL, ADDR formatbuffer, ADDR formatbuffer, NULL<br />?????????????????????????<br /><br />P.S. You mean the moderators don like girls ? :confused: :grin: :grin: :grin:</div>
    <div class="meta">Posted on 2003-04-17 08:52:19 by Forginforcer</div>
   </div>
   <div class="post" id="post-97485">
    <div class="subject"><a href="#post-97485">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">Yes,that's the correct code.<br /><br />P.S. : If we continue to talk about that subject,the moderators will move<br />this thread to the &quot;Heap&quot; section. :) We don't want this to happen. :)<br /><br />Vortex</div>
    <div class="meta">Posted on 2003-04-17 08:57:22 by Vortex</div>
   </div>
   <div class="post" id="post-97683">
    <div class="subject"><a href="#post-97683">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">First of all, you should get rid of those girls, they're obviously ruining your concentration. How do you expect to learn to program with all these distractions? You can send them over to me. :grin:<br /><br />Third of all, the code you have doesn't do anything useful, does it? :P</div>
    <div class="meta">Posted on 2003-04-18 07:16:47 by Sephiroth3</div>
   </div>
   <div class="post" id="post-97705">
    <div class="subject"><a href="#post-97705">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">@Sephiroth3 coool :grin: :cool: <br /><br />I wanted to list al my logical drives, but I'm not able to. :confused:</div>
    <div class="meta">Posted on 2003-04-18 08:52:44 by Forginforcer</div>
   </div>
   <div class="post" id="post-97751">
    <div class="subject"><a href="#post-97751">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">Okay. This is how you do it:<br /><br /><pre><code><br />.bss<br />drives db 79 dup&#40;?&#41;<br />.code<br />start&#58;<br />call GetLogicalDrives<br />mov edi,ADDR drives<br />mov ecx,0x203a41<br />the_loop&#58;<br />shr eax,1<br />jae no_drive<br />mov dword ptr &#91;edi&#93;,ecx<br />add edi,3<br />no_drive&#58;<br />inc ecx<br />cmp cl,0x5b<br />jb the_loop<br />dec edi<br />stosb<br />invoke MessageBoxA,ADDR drives,ADDR blah,MB_OK<br />ret<br />blah db &quot;The drives&quot;,0<br />end start<br /></code></pre><br /><br />I'm not familiar with MASM, but I think that's how it would be written.</div>
    <div class="meta">Posted on 2003-04-18 11:55:49 by Sephiroth3</div>
   </div>
   <div class="post" id="post-97753">
    <div class="subject"><a href="#post-97753">why my program chrashs wehen I call wsprintf ?</a></div>
    <div class="body">Hey Thanks !<br /><br />I just have a visitor at my - my friend Valle, I will try your solution later !<br /><br />Thanks !<br /><br />Deep regard FF</div>
    <div class="meta">Posted on 2003-04-18 12:01:02 by Forginforcer</div>
   </div>
  </div>
 </body>
</html>