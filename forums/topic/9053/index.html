<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Program test - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9053" />
    <link rel="next" href="../?id=9053&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=24">IDE usage &amp; development</a> &raquo; <a href="../?id=9053">Program test</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=9053&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=9053&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="9053" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=9053&amp;page=2">&gt;</a><a href="../?id=9053&amp;page=2">&raquo;</a></form>   <div class="post" id="post-66479">
    <div class="subject"><a href="#post-66479">Program test</a></div>
    <div class="body">Hi,<br /><br />I',m making a change to ResEdit so it will extract all resources<br />from binary files, not just dialogs.<br /><br />I thought before I put the changes in ResEdit and probably screw<br />it up I would write a sample program to test the routines.<br /><br />I think the only resources I have not done so far is RCDATA and Font.<br /><br />ExtractRsrc will also display Cursors, Icons, Grp Cursors, Grp Icons,<br />and Bitmaps images.<br /><br />You can right click on the image to save it or close it.<br /><br />Let me know how it works and if it runs clean I will put the routines<br />in ResEdit.<br /><br />I fixed the Version resource bug that Pone had,<br />plus I added some used friendly features and<br />check guards.<br /><br />Now you can open a file as hex, update it and<br />save it to it's orignal format.<br /><br />Fixed a bug if the an image color count is 256.<br /><br />Now checking for MENUEX type menus.<br /><br />Fixed some misc bugs for some wierd types of resources.<br />Plus the program now checks for compressed files.<br /><br />Fixed Silas first bug, still need his VB pgm to<br />test his second bug.<br /><br />You can now extract message tables if they are not Unicode,<br />I need a pgm with a Unicode message table to test with.<br /><br />You can now extract message tables if they are non Unicode<br />or Unicode.<br /><br />You can now extract, display, and save <br />gif, jpg, wmf, and emf type resources from PE and res files.<br /><br />You can now extract, display, and save animated<br />Icons and Cursors.<br /><br />Fixed Silas VB PE bug and any other file<br />that has strange alignments for image groups.<br /><br />Fixed the bug if you are extracting resources<br />from non english PE files.<br />Plus you can now extract, display, and save<br />AVI resources.<br /><br />Fixed the bug for saving some types of images.<br /><br />There is a Images.exe included in the zip<br />that has several types of images.<br />I'm including the source with this zip.<br /><br />Thanks,<br /><br />Ewayne<br /><br />Previous downloads (398)</div>
    <div class="meta">Posted on 2002-11-19 16:42:54 by Ewayne</div>
   </div>
   <div class="post" id="post-66589">
    <div class="subject"><a href="#post-66589">Program test</a></div>
    <div class="body">Hi Ewayne,<br /><br />Great idea !!<br /><br />Works on WinME. (FYI-there was one time when I clicked on an icon and it displayed properly in the right window..then instead of right-clicking, I chose 'Save' from the file menu and the 'Save File' requester appeared with my icon showing on top of it. I could not duplicate this again after I saw it happen...I'll try later when I'm not so tired and sleepy and brain-dead!!)</div>
    <div class="meta">Posted on 2002-11-20 07:57:01 by gscundiff</div>
   </div>
   <div class="post" id="post-66601">
    <div class="subject"><a href="#post-66601">On W98</a></div>
    <div class="body">The version section generated a fault when exploring the left pane of an exe file.<br /><br />It dropped down to a &quot;01&quot;, when I click it, is when I got the fault.<br /><br />Regards,  P1<br /><br />Here's the .rc file, if it might help.<br /><br />#include &quot;\masm32\include\resource.h&quot;<br /><br />1 ICON MOVEABLE PURE LOADONCALL DISCARDABLE &quot;Main.ICO&quot;<br /><br />// Do NOT use dashes in FileName!<br />FontFile BINFILE SOMEFONT.TTF<br /><br /><br />// Version stamp for this .EXE<br /><br />VS_VERSION_INFO      VERSIONINFO<br />FILEVERSION          1,0,0,0<br />PRODUCTVERSION       1,0,0,0<br />FILEFLAGSMASK        VS_FFI_FILEFLAGSMASK<br />FILEFLAGS            (VS_FF_PRERELEASE | VS_FF_DEBUG)<br />FILEOS               VOS__WINDOWS32          <br />FILETYPE             VFT_APP<br />FILESUBTYPE          VFT2_UNKNOWN<br />BEGIN<br /> BLOCK &quot;VarFileInfo&quot;<br /> BEGIN<br />    VALUE &quot;Translation&quot;, 0x0409, 1252<br /> END<br /> BLOCK &quot;StringFileInfo&quot;<br /> BEGIN<br />    BLOCK &quot;040904E4&quot;<br />    BEGIN<br />       VALUE &quot;CompanyName&quot;,     &quot;My Corporation\0&quot;<br />       VALUE &quot;FileDescription&quot;, &quot;Font File Installer.\0&quot;<br />       VALUE &quot;FileVersion&quot;,     &quot;1.0.0.0\0&quot;<br />       VALUE &quot;InternalName&quot;,    &quot;MY-Font.EXE\0&quot;<br />       VALUE &quot;LegalCopyright&quot;,  &quot;Copyright ? Me 2002, All Rights Reserved.\0&quot;<br />       VALUE &quot;LegalTrademarks&quot;, &quot;None.\0&quot;<br />       VALUE &quot;OriginalFilename&quot;, &quot;My-Font.EXE\0&quot;<br />       VALUE &quot;ProductName&quot;,     &quot;Font File Installer.\0&quot;<br />       VALUE &quot;ProductVersion&quot;,  &quot;1.0.0.0\0&quot;<br />    END<br /> END<br />END</div>
    <div class="meta">Posted on 2002-11-20 08:42:58 by Pone</div>
   </div>
   <div class="post" id="post-66602">
    <div class="subject"><a href="#post-66602">Program test</a></div>
    <div class="body">To gscundiff:<br /><br />I did not put any whistles, bells or make sure the<br />user did the right thing type stuff in the sample<br />program.<br /><br />You are suppose to use the right mouse button to<br />save an image.:)<br /><br />Probably what happened is when you display an Icon,<br />Cursor, or Bitmap there is no text in the edit<br />window so the SaveFile dialog will not open, but<br />if you display a Group Icon or Group Cursor there<br />will be text in the edit window so the SaveFile<br />dialog will open and I think the image is topmost<br />so the image will appear on top of the dialog box<br />and the only thing it would save is the text in<br />the edit window.<br /><br />If anyone thinks the sample program would be worth<br />having as a tool I will change the program to be<br />more user friendly.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2002-11-20 08:47:50 by Ewayne</div>
   </div>
   <div class="post" id="post-66606">
    <div class="subject"><a href="#post-66606">Program test</a></div>
    <div class="body">To Pone:<br /><br />Thanks for the feedback.<br /><br />I could only find two programs with Versions in<br />them to test on.<br /><br />I was afraid that there would be some programs<br />out there with Versions that it might not work<br />with.<br /><br />I would like to meet the person(s) that designed<br />the Version and it's assocated structures and<br />give them a piece of my mind.<br /><br />They are harder to untangle then dialogs.<br /><br />It looks like where it got confused is that the<br />VarFileInfo is before the StringFileInfo and the<br />documentation that I have says you can not do that.<br /><br />That's what's nice about some of the MS's docs<br />they are wrong sometimes and not right sometimes.<br /><br />I will see if I can fix that.<br /><br />Ewayne</div>
    <div class="meta">Posted on 2002-11-20 09:10:02 by Ewayne</div>
   </div>
   <div class="post" id="post-66649">
    <div class="subject"><a href="#post-66649">Program test</a></div>
    <div class="body"><strong><div class="quote"><br />That's what's nice about some of the MS's docs they are wrong sometimes and not right sometimes.<br /></div></strong><br /><br />:) ;) :grin:</div>
    <div class="meta">Posted on 2002-11-20 16:41:42 by gscundiff</div>
   </div>
   <div class="post" id="post-66762">
    <div class="subject"><a href="#post-66762">Program test</a></div>
    <div class="body">To Pone and the rest,<br /><br />I fixed the Version resource bug, you can now<br />have the VarFileInfo at the beginning or the end.<br /><br />Question:<br />I don't know very much about Version resources<br />(As a matter of fact there is a lot I don't know about).<br /><br />Anyhow can you have more then one VarFileInfo and<br />StringFileInfo groups?<br /><br />Does the \0&quot; mean zero termination?<br /><br />I made some other changes to ExtractRsrc:<br /><br />Made it more user friendly.<br /><br />Now you can open a file as hex, update it and<br />save it to it's orignal format.<br /><br />You can go to the first post on this thread for<br />the update.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2002-11-21 09:35:05 by Ewayne</div>
   </div>
   <div class="post" id="post-66776">
    <div class="subject"><a href="#post-66776">Where's the new code?</a></div>
    <div class="body">Thanks,  P1</div>
    <div class="meta">Posted on 2002-11-21 11:53:08 by Pone</div>
   </div>
   <div class="post" id="post-66930">
    <div class="subject"><a href="#post-66930">Program test</a></div>
    <div class="body">Hi,<br /><br />roticv pointed out a bug if an image color count<br />is 256.<br /><br />I fixed that.<br /><br />You can go to the first post on this thread for<br />the update.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2002-11-22 11:49:08 by Ewayne</div>
   </div>
   <div class="post" id="post-67183">
    <div class="subject"><a href="#post-67183">Program test</a></div>
    <div class="body">If i am not wrong, /0 means null terminated in c and c++.<br /><br />Ewayne, now your program display the verison information prefectly. I tested out on a couple of the M$ dlls, and the infomation should be correct.</div>
    <div class="meta">Posted on 2002-11-24 07:54:21 by roticv</div>
   </div>
   <div class="post" id="post-67194">
    <div class="subject"><a href="#post-67194">Program test</a></div>
    <div class="body">oh ya...<br /><br />Just a minor bug, the dialog ID of the dumped resource is wrong. It should not be 0, should be the ID.</div>
    <div class="meta">Posted on 2002-11-24 09:13:11 by roticv</div>
   </div>
   <div class="post" id="post-67211">
    <div class="subject"><a href="#post-67211">Program test</a></div>
    <div class="body">To roticv:<br /><br />The ID's for the dialogs used to be there and one<br />of the changes I made removed them, but they are<br />back again.<br /><br />Plus fixed a bug when displaying the text about<br />certain types of group Icons.<br /><br />You can go to the first post on this thread for<br />the update.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2002-11-24 13:15:19 by Ewayne</div>
   </div>
   <div class="post" id="post-67497">
    <div class="subject"><a href="#post-67497">Program test</a></div>
    <div class="body">Hi,<br /><br />I forgot to check for MENUEX type menus.<br /><br />You can go to the first post on this thread for<br />the update.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2002-11-25 22:39:51 by Ewayne</div>
   </div>
   <div class="post" id="post-68026">
    <div class="subject"><a href="#post-68026">Program test</a></div>
    <div class="body">Hi,<br /><br />I fixed some misc bugs for some wierd types of resources.<br />Plus the program now checks for compressed files.<br /><br />I think I'm about ready to put the routines in ResEdit for AsmEdit.<br /><br />You can go to the first post on this thread for<br />the update.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2002-11-29 00:19:59 by Ewayne</div>
   </div>
   <div class="post" id="post-68094">
    <div class="subject"><a href="#post-68094">Program test</a></div>
    <div class="body">Hi Ewayne,<br /><br />If any bug is found, I will keep you informed. Currently I found no bugs :grin:. Oh ya... I was hoping to see support for messagetable.</div>
    <div class="meta">Posted on 2002-11-29 07:55:46 by roticv</div>
   </div>
   <div class="post" id="post-68107">
    <div class="subject"><a href="#post-68107">Program test</a></div>
    <div class="body">Hi roticv,<br /><br />Send me a file with a message table and I will<br />see what I can do.<br /><br />Ewayne</div>
    <div class="meta">Posted on 2002-11-29 10:03:01 by Ewayne</div>
   </div>
   <div class="post" id="post-68108">
    <div class="subject"><a href="#post-68108">Program test</a></div>
    <div class="body">Hi Ewayne,<br /><br />Have a look at user32.dll and kernel32.dll. Good examples of program that use message table resoruces. :grin:</div>
    <div class="meta">Posted on 2002-11-29 10:18:17 by roticv</div>
   </div>
   <div class="post" id="post-68110">
    <div class="subject"><a href="#post-68110">Program test</a></div>
    <div class="body">To roticv:<br /><br />I was afraid you would find one.<br /><br />Thanks !! :( <br /><br />Ewayne</div>
    <div class="meta">Posted on 2002-11-29 10:38:25 by Ewayne</div>
   </div>
   <div class="post" id="post-68111">
    <div class="subject"><a href="#post-68111">Program test</a></div>
    <div class="body">hahah.. I found out that they hd messagetable some time ago while messing with your program :grin: Soon all the resources would be covered.. that would be nice.</div>
    <div class="meta">Posted on 2002-11-29 10:45:53 by roticv</div>
   </div>
   <div class="post" id="post-68113">
    <div class="subject"><a href="#post-68113">Program test</a></div>
    <div class="body">I've found some bugs... In the interface, if I extract from a file, extract another and cancel to come back to the first, it crashes. Also, I can't extract a vb program I made as it crashes too. I just downloaded it so it must be the updated version I used.<br /><br />Other than that, it's great!!</div>
    <div class="meta">Posted on 2002-11-29 11:20:23 by Silas</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=9053&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=9053&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="9053" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=9053&amp;page=2">&gt;</a><a href="../?id=9053&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>