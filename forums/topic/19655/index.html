<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Safe Initialization and Scripting for ActiveX Controls - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19655" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19655">Safe Initialization and Scripting for ActiveX Controls</a></p>
   <div class="post" id="post-151247">
    <div class="subject"><a href="#post-151247">Safe Initialization and Scripting for ActiveX Controls</a></div>
    <div class="body">Hi all,<br /><br />I am writing an asp on a remote server on a local network. When a user clicks on the name of a word dot file I want to start word with this specific dot file. My fist attempt was to create an object with javascript &quot;new ActivXObject(&quot;Shell.Application&quot;). This is not possible due to permission restrictions.<br /><br />I have learnt that it is possible to write an own activeX controll to handle the word automation and to mark it as safe for scripting in the registry. Does anyone have more information how to do this in assembler or an example of an activeX dll written in assembler. I have read some on <a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/workshop/components/activex/safety.asp">this</a> link.<br /><br />Best regards</div>
    <div class="meta">Posted on 2004-10-13 13:39:26 by minor28</div>
   </div>
   <div class="post" id="post-151319">
    <div class="subject"><a href="#post-151319">Safe Initialization and Scripting for ActiveX Controls</a></div>
    <div class="body">I worked on a Document Control App that use a .DOT for features with MASM32 program to Control the process.  I will give you an outline of what I did, but you will need to wrap it in a COM object for your .asp project to use it.<br /><br />Due to Word.8 limitations with .DOTs on the Commandline, I had to pass the name of file.DOC through an .INI file in the Temp folder.<br /><br />In a regular .exe file.<br />1.  Looked up the Current Word to make sure it was high enough for the .dot to work.  Produce a error message, if it did not.<br />2.  Write out file name of .doc from Commandline to .ini for document to work with.  The .dot reads it and loads the right .doc file with it starts.<br />3.  Start it with a CreateProcess call with the WinWord.exe location read in from registry ( Some people have more than one loaded. ).  With the Commandline parameters set to start Word with my .dot file.<br /><br />With web stuff like this, watch your permissions and security with all these programs.<br /><br />Regards,  P1  8)</div>
    <div class="meta">Posted on 2004-10-15 17:21:40 by Pone</div>
   </div>
   <div class="post" id="post-151335">
    <div class="subject"><a href="#post-151335">Safe Initialization and Scripting for ActiveX Controls</a></div>
    <div class="body">Hi Pone,<br /><br />Thanks for your answer. The problem is the COM thing, security and permission. I have written an ordinary working dll to start winword.exe. I will work on it.<br /><br />Regards</div>
    <div class="meta">Posted on 2004-10-16 08:56:05 by minor28</div>
   </div>
   <div class="post" id="post-151374">
    <div class="subject"><a href="#post-151374">Safe Initialization and Scripting for ActiveX Controls</a></div>
    <div class="body">Hi minor28,<br /><br />couldn't you start the word application with<br /><br />CreateObject(&quot;Word.Application&quot;)<br /><br />Possibly this doesn't help much, but at least you don't need a &quot;Shell.Application&quot; object.<br /><br />Japheth</div>
    <div class="meta">Posted on 2004-10-17 13:17:07 by japheth</div>
   </div>
   <div class="post" id="post-151383">
    <div class="subject"><a href="#post-151383">Safe Initialization and Scripting for ActiveX Controls</a></div>
    <div class="body">I have a web page with word tempates (*.dot). Clicking on a template should start an Word with this dot-file. The dot file has a startup macro which should run. I want the word instance to be separated from the iexplorer. I can't quit and release the word automation i a proper way, I think. That's why I use shell. Even if I want to use word automation I don't think it will work because of security purposes. The dll must be registered as safe. Now I am trying to write a com dll to be registered as safe. This dll will start word. I have never written a com dll so I have much to learn.<br /><br />Best regards</div>
    <div class="meta">Posted on 2004-10-17 17:06:11 by minor28</div>
   </div>
  </div>
 </body>
</html>