<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>RadAsm Request: Duplicate Project - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26045" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26045">RadAsm Request: Duplicate Project</a></p>
   <div class="post" id="post-189763">
    <div class="subject"><a href="#post-189763">RadAsm Request: Duplicate Project</a></div>
    <div class="body">Hi Ketil,<br /><br />Could we have a &quot;Duplicate Project&quot; option, which takes the current active project and duplicates everything into another project? At the moment I just copy the folder then rename every file to the new project name and then edit the project.rap file.<br /><br />If this could get automated that would be sweet. <br /><br />Cheers,<br />Jimmy</div>
    <div class="meta">Posted on 2007-07-05 19:50:36 by JimmyClif</div>
   </div>
   <div class="post" id="post-189766">
    <div class="subject"><a href="#post-189766">Re: RadAsm Request: Duplicate Project</a></div>
    <div class="body">hi JC,<br />RA already has &quot;Create Template&quot; option.<br />menu: Project-&gt;Create Template<br />you can duplicate projects with that option. yes?</div>
    <div class="meta">Posted on 2007-07-06 11:58:03 by drizz</div>
   </div>
   <div class="post" id="post-189768">
    <div class="subject"><a href="#post-189768">Re: RadAsm Request: Duplicate Project</a></div>
    <div class="body">True, haven&#39;t thought about using a Template... I thought more along the lines of &quot;this version needs to be a little different than the other one&quot; Or creating a copy to do a major dirty hack because you something needs to be fixed immediately and then going back to the other one and implement it properly later. <br /><br />For now I&#39;ll use a Template, or I ponder how I can possibly free up some time for an addin (unlikely) ;)<br /><br /></div>
    <div class="meta">Posted on 2007-07-06 12:28:36 by JimmyClif</div>
   </div>
   <div class="post" id="post-189769">
    <div class="subject"><a href="#post-189769">Re: RadAsm Request: Duplicate Project</a></div>
    <div class="body"><div class="quote">(unlikely) ;)</div>come on, it can&#39;t be that hard&nbsp; ;) look for example at &quot;Project Zipper&quot; addin -Or-&nbsp; Radasm source &quot;Tpl\CreateTpl.asm&quot;.</div>
    <div class="meta">Posted on 2007-07-06 12:51:32 by drizz</div>
   </div>
   <div class="post" id="post-189772">
    <div class="subject"><a href="#post-189772">Re: RadAsm Request: Duplicate Project</a></div>
    <div class="body">Thanks for the guilt trip... I see what I can do :)</div>
    <div class="meta">Posted on 2007-07-07 08:37:38 by JimmyClif</div>
   </div>
   <div class="post" id="post-204918">
    <div class="subject"><a href="#post-204918">Re: RadAsm Request: Duplicate Project</a></div>
    <div class="body">drizz,<br /><br />Do you still have the Project Zipper Code ? I can&#039;t seem to find it and it&#039;s not available from Ketil&#039;s site either.<br /><br />I&#039;ll try to bang this thing out over the next few days.&nbsp; :!:</div>
    <div class="meta">Posted on 2008-03-04 13:40:27 by JimmyClif</div>
   </div>
   <div class="post" id="post-204926">
    <div class="subject"><a href="#post-204926">Re: RadAsm Request: Duplicate Project</a></div>
    <div class="body">Are you getting old?&nbsp; :P :) It&#039;s in the addins file http://www.radasm.com/projects/Addins.zip<br /><br />cheers</div>
    <div class="meta">Posted on 2008-03-05 01:40:16 by drizz</div>
   </div>
   <div class="post" id="post-204937">
    <div class="subject"><a href="#post-204937">Re: RadAsm Request: Duplicate Project</a></div>
    <div class="body"><div class="quote"><br />Are you getting old?&nbsp; :P <br /></div><br /><br />Seems so :(<br /><br />Thanks though... :thumbsup:</div>
    <div class="meta">Posted on 2008-03-05 11:45:04 by JimmyClif</div>
   </div>
   <div class="post" id="post-205013">
    <div class="subject"><a href="#post-205013">Re: RadAsm Request: Duplicate Project</a></div>
    <div class="body">Alright, I hacked something together while my kids were screaming in my ears :-/ I had quite a rough time as for each time I wanted to test it I had to uninstall the addin, close RadAsm, open RadAsm, install the plugin and run it. This was very inconvenient and demoralizing. I wonder if there is a better way to do this.<br /><br />Anyway... the addin works. Due to a design error subdirectories such as \Res\ with files named the same as the Original Main file will have to be manually renamed. Like if the Main project was called &quot;SaveProjectAs&quot; and there is a file inside the \Res\ folder named SaveProjectAsDlg.rc it will have to be manually renamed to WhateverTheNewNameOfTheProjectIsDlg.rc<br /><br />I can live with it. Either that or I can not scan the files and replace every occurence of &quot;SaveProjectAs&quot; to &quot;WhateverTheNewNameOfTheProjectIs&quot;.<br /><br />What else is wrong? For some reason which escapes me one can not run the Addin twice in a row. Or twice at all while RadAsm is running. <br /><br />Also I don&#039;t like it being under &quot;Tools&quot; I would prefer it being under the &quot;File&quot; \ &quot;New Project&quot; \ &quot;Open Project&quot; tab, but again - I can live with it.<br /><br />Complainers Welcome... Bug Fixers, Enhancers even more.</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=2565" target="_blank">Save Project As Addin.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2008-03-21 16:07:23 by JimmyClif</div>
   </div>
   <div class="post" id="post-205034">
    <div class="subject"><a href="#post-205034">Re: RadAsm Request: Duplicate Project</a></div>
    <div class="body">Hi Jimmy, been buisy lately (read: lazy)&nbsp; :P<br /><br />About your addin, WHERE do i start&nbsp; :D<br /><br /><div class="quote"><br />Alright, I hacked something together while my kids were screaming in my ears :-/ I had quite a rough time as for each time I wanted to test it I had to uninstall the addin, close RadAsm, open RadAsm, install the plugin and run it. This was very inconvenient and demoralizing. I wonder if there is a better way to do this.<br /></div>Setup a second copy of RA somewhere. Multiple copies work just fine and don&#039;t clash. <br />Set your addin output directory to that of RA copy addin dir (via /OUT:&quot;second copy addin dir\$7&quot;, or via &quot;Main Project files&quot; in project menu).<br />You can even set up &quot;Run&quot; and &quot;Debug&quot; command to point to second copy.<br /><br /><div class="quote"><br />Anyway... the addin works. Due to a design error subdirectories such as \Res\ with files named the same as the Original Main file will have to be manually renamed. Like if the Main project was called &quot;SaveProjectAs&quot; and there is a file inside the \Res\ folder named SaveProjectAsDlg.rc it will have to be manually renamed to WhateverTheNewNameOfTheProjectIsDlg.rc</div>Take a look in RA source and see how Ketil handles it (hint: search for &quot;ProWizFixLine&quot; and &quot;ProWizFinish&quot;, ProWizFinish is the function that creates project from template)<br /><br /><div class="quote"><br />What else is wrong? For some reason which escapes me one can not run the Addin twice in a row. Or twice at all while RadAsm is running. <br /></div>Bug in zeroing buffers. Solution:<br /><pre><code>	; Create Directory with new name<br />	invoke RtlZeroMemory,o$ szFromFolder, s$ szFromFolder<br />	invoke RtlZeroMemory,o$ szDestFolder, s$ szDestFolder</code></pre><br /><br /><div class="quote"><br />Also I don&#039;t like it being under &quot;Tools&quot; I would prefer it being under the &quot;File&quot; \ &quot;New Project&quot; \ &quot;Open Project&quot; tab, but again - I can live with it.</div><br />in AddMenu change&nbsp; &quot;mov edx,6&quot; to 0. 6 is id of the menu item &quot;Tools&quot;. This is not all, you might wan&#039;t to use insert menu rather than append. And don&#039;t forget to add RAM_CLOSE hook to EAX that you missed!<br /><br />Hope that helped 8) Beside the things listed above addin works ok&nbsp; :thumbsup:<br /><br />Cheers<br /><br /><br /><br /></div>
    <div class="meta">Posted on 2008-03-28 21:42:47 by drizz</div>
   </div>
   <div class="post" id="post-205045">
    <div class="subject"><a href="#post-205045">Re: RadAsm Request: Duplicate Project</a></div>
    <div class="body">drizz,<br /><br />Thank You. I don&#039;t have that much time anymore to get knee deep into these things. I write many versions of the same prog lately which differ in minor things or I maintain the few programs at work which make my job easier. <br /><br />I&#039;ll try the duplicate RadAsm trick. Wonders me how I didn&#039;t think of it :) and also thanks for pointing out the bug(s), looks like I tried to cheat and messed up ;)<br /><br />I&#039;ll move the menu item and fix all the mentionned stuff. I doubt I will have a look at the RA source... I tried it with the Project Zipper source and didn&#039;t last all too long. Chances are that I&#039;ll hack my own buggy&#160; &quot;ProWizFixLine&quot; and &quot;ProWizFinish&quot; in. :shrug:<br /><br />Thanks a lot for the feedback. I&#039;ll get to all these things in the next few days.<br /></div>
    <div class="meta">Posted on 2008-03-29 18:02:55 by JimmyClif</div>
   </div>
  </div>
 </body>
</html>