<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>SetTimer - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=793" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=793">SetTimer</a></p>
   <div class="post" id="post-4905">
    <div class="subject"><a href="#post-4905">SetTimer</a></div>
    <div class="body">i cant get a timer to function properly<br /><br />if i say this<br /><br />invoke SetTimer,hWnd,idtimer,400,NULL<br /><br />i get 0 returned in eax ; in other words the function failed<br /><br />if i use <br /><br />invoke SetTimer,NULL,idtimer,400,NULL<br /> 0 is not returned but...<br /> i get no WM_TIMER message sent to the que<br />if anyone has run into this problem please explain<br /><br />do i have to search the que for the message<br />idtimer  should be returned in wParam<br />:(</div>
    <div class="meta">Posted on 2001-08-25 23:24:18 by titan</div>
   </div>
   <div class="post" id="post-4916">
    <div class="subject"><a href="#post-4916">SetTimer</a></div>
    <div class="body">Hmmm. You'd better check the simple stuff like if hWnd contains the correct handle (it's not hWin by any chance?). If not, I found this in MSDN:<br /><br /><div class="quote">The WM_TIMER message is a low-priority message. The GetMessage and PeekMessage functions retrieve this message only when no other higher-priority messages are in the thread's message queue. </div> <br /><br />But I don't see why your window would receive any more msg's then any other window.<br /><br />And this piece of text explains why the function succeeded if hWnd is NULL:<br /><br /><div class="quote"><strong>Parameters</strong><br /><em>hWnd</em><br />Handle to the window to be associated with the timer. This window must be owned by the calling thread. If this parameter is NULL, no window is associated with the timer and the nIDEvent parameter is ignored. <br /><em>nIDEvent </em><br />Specifies a nonzero timer identifier. If the hWnd parameter is NULL, this parameter is ignored. <br /></div><br /><br />If you're still stuck after double checking your code, try Iczillions tute on common controls, it contains a timer to make a progressbar move.</div>
    <div class="meta">Posted on 2001-08-26 01:42:16 by Qweerdy</div>
   </div>
   <div class="post" id="post-4930">
    <div class="subject"><a href="#post-4930">SetTimer</a></div>
    <div class="body">titan,<br /><br />Heres a quick Prostart example.<br /><br />I set a Timer in Main when you launch the prog.<br /><br />Click on the File menu then click Test to set the second.<br /><br />In each case a message box indicates success or not.<br /><br />Both SetTimers set on my two machines.:)<br /><br /><br /><a target="_blank" href="http://www.wfcravener.com/downloads/timer.zip">Get example here.</a></div>
    <div class="meta">Posted on 2001-08-26 04:28:50 by bcraven</div>
   </div>
  </div>
 </body>
</html>