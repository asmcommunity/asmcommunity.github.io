<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Accessing ports under NT/XP - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24618" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24618">Accessing ports under NT/XP</a></p>
   <div class="post" id="post-179713">
    <div class="subject"><a href="#post-179713">Accessing ports under NT/XP</a></div>
    <div class="body">Hi<br />I want to post here a little assay I was experimenting a time ago. It is an object that has the capability to dis/en-able the access to hardware ports. As some of us can remember, this was possible on older OSs to access the CMOS values or other hardware components. In my case I experimenting with the parallel communication ports to play in user mode with an application Iâ€™m writing like the well known LapLink. <br /><br />The object can perform the switching due a driver that is installed from within the object data and finally removed when no longer needed. The driver code per se is based on a driver written by Four-F I adapted a little bit.<br /><br />Regards,<br /><br />Biterider<br /><br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1559" target="_blank">Demo13.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-04-17 12:10:37 by Biterider</div>
   </div>
   <div class="post" id="post-179772">
    <div class="subject"><a href="#post-179772">Re: Accessing ports under NT/XP</a></div>
    <div class="body">Iirc you don&#39;t need a driver to do port access, if you&#39;re willing to use an undocumented NT call... you might want to check out <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=20093.0">this post</a> :)<br /></div>
    <div class="meta">Posted on 2006-04-18 08:19:59 by f0dder</div>
   </div>
   <div class="post" id="post-179776">
    <div class="subject"><a href="#post-179776">Re: Accessing ports under NT/XP</a></div>
    <div class="body">Hum, interesting. The DirectIO.exe doesn&#39;t work on my system but I will translate it to see if I can use the code. Thanks for the hint.<br /><br />Biterider</div>
    <div class="meta">Posted on 2006-04-18 09:50:14 by Biterider</div>
   </div>
   <div class="post" id="post-179781">
    <div class="subject"><a href="#post-179781">Re: Accessing ports under NT/XP</a></div>
    <div class="body"><div class="quote"><br />Hum, interesting. The DirectIO.exe doesn&#39;t work on my system but I will translate it to see if I can use the code. Thanks for the hint.<br /><br />Biterider<br /></div><br />Hm, okay - might be interesting single-stepping it to see which call fails and with which error code. It *is* undocumented, I just thought it would work from NT4 up.<br /></div>
    <div class="meta">Posted on 2006-04-18 11:18:54 by f0dder</div>
   </div>
   <div class="post" id="post-179785">
    <div class="subject"><a href="#post-179785">Re: Accessing ports under NT/XP</a></div>
    <div class="body">Hi<br />The code is OK. My mistake. <br />To adjust the IOPL, you have to reboot the box after the first run. That and the fact that the code must be executed under administrative right make it a little annoying. For the moment I prefer the gost-driver approach.<br /><br />Btw, reading some text about the undocumented api, I discovered that the DEP protection can be easily deactivated by software, which makes the whole strategy completely ineffective. Sometimes I was surprised what the big heads of MS are doing...&nbsp; :shock:<br /><br />Biterider<br /></div>
    <div class="meta">Posted on 2006-04-18 12:19:35 by Biterider</div>
   </div>
   <div class="post" id="post-179787">
    <div class="subject"><a href="#post-179787">Re: Accessing ports under NT/XP</a></div>
    <div class="body">Well, driver approach requires administrative rights as well - and I bet that turning off DEP also does. Is IOPL stuff per-user or systemwide? If it&#39;s systemwide, driver approach is probably better...<br /></div>
    <div class="meta">Posted on 2006-04-18 12:24:00 by f0dder</div>
   </div>
   <div class="post" id="post-179803">
    <div class="subject"><a href="#post-179803">Re: Accessing ports under NT/XP</a></div>
    <div class="body">Hi<br />The driver method seems not to require special rights to run, at least my tests on a non administrative account show this. The current downside is that the code is not prepared for multiple instances but I think I can correct the situation with a counter on the driver side and tons of fault tolerant code.<br /><br />Biterider<br /></div>
    <div class="meta">Posted on 2006-04-18 14:44:00 by Biterider</div>
   </div>
   <div class="post" id="post-179804">
    <div class="subject"><a href="#post-179804">Re: Accessing ports under NT/XP</a></div>
    <div class="body">Hm, wtf? You can load a driver with a limited user account? That shouldn&#39;t be possible!<br /></div>
    <div class="meta">Posted on 2006-04-18 14:46:36 by f0dder</div>
   </div>
   <div class="post" id="post-179835">
    <div class="subject"><a href="#post-179835">Re: Accessing ports under NT/XP</a></div>
    <div class="body">I closer look into the accounts I checked the app shows that they are all admin accounts. I opened a new limited user account and the SCManager failed as expected (as usual you are right&nbsp; ;)).<br /><br />Biterider</div>
    <div class="meta">Posted on 2006-04-19 07:56:30 by Biterider</div>
   </div>
   <div class="post" id="post-179839">
    <div class="subject"><a href="#post-179839">Re: Accessing ports under NT/XP</a></div>
    <div class="body">*phew* - I was just about to get afraid :)</div>
    <div class="meta">Posted on 2006-04-19 08:02:19 by f0dder</div>
   </div>
  </div>
 </body>
</html>