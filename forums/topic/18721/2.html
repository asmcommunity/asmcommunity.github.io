<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>System lib - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18721" />
  <link rel="prev" href="../?id=18721&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=18721">System lib</a></p>
   <div class="post" id="post-145461">
    <div class="subject"><a href="#post-145461">System lib</a></div>
    <div class="body">I've added a few functions to the lib, mostly just error to string stuff. Of particular interest might be the DLLMsgIdToString. I had read at MSDN that if you load a library using LOAD_LIBRARY_AS_DATAFILE in Win9x that you could not use the higher resource functions, only LoadResource, FindResource etc... So I wrote a function to allow for loading a DLL as a data file while still extracting the message from it's resources. The advantage is that none of the external stuff is resolved so it does not load any other DLL's with the one you need.<br /><br />However when I had finished testing it I gave it a shot on Win95 OSR0 and it worked, but so does FormatMessage, I left it in in case someone is interested but it is much bigger and more complex than it needs to be :) In short it is there for educational purposes only.<br /><br /><pre><code>DLLMsgIdToString<br />	Extracts a message from a resource based message table. This function<br />	extracts the string from the raw resource data. In order to do this it<br />	makes use of only LoadResource and related functions. In addition to<br />	providing the same functionality of DLLErrorToString, it also allows<br />	for a String to be passed as the dwTableID in case you have given the<br />	message table a string identifier. There is no facility for string IDs<br />	for the message number however, any attempt to pass one will result in<br />	a return of -1. Should the message table ID number or name not be known<br />	just set it to zero and the first found will be used.<br /><br />	Parameters&#58;<br />		dwErrorCode = Error code to convert, 0 for the last error<br />		pMsgDll = The name of a DLL that contains the message resources<br />		dwTableID = ID number of the table &#40;NULL for the first one in the file&#41;<br />		pString = Pointer to a buffer to recieve the resulting message<br />		cbString = Size of the buffer in bytes<br /><br />	Returns the number of characters copied to the buffer, -1 otherwise<br /><br />	Tested GoAsm &amp; MASM</code></pre></div>
    <div class="meta">Posted on 2004-07-05 19:14:25 by donkey</div>
   </div>
  </div>
 </body>
</html>