<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>window handle - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26886" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26886">window handle</a></p>
   <div class="post" id="post-193465">
    <div class="subject"><a href="#post-193465">window handle</a></div>
    <div class="body">hi, i was wondering how i could get a windows handle?

what im doing is getting the window from the mouse point using WindowFromPoint and i want to send the handle of that window to an editbox, but i have no idea how to in asm :(.

thanks for any help :).</div>
    <div class="meta">Posted on 2001-02-14 00:09:00 by hehe</div>
   </div>
   <div class="post" id="post-193466">
    <div class="subject"><a href="#post-193466">window handle</a></div>
    <div class="body"><pre><code>WindowFromPoint PROTO :DWORD,:DWORD</code></pre>

The win32.hlp file is misleading here, you put the 2 co-ordinates
in the 2 DWORD parameters.

To get the screen co-ordinates, I think you need to use SetCapture
and trap the WM_MOUSEMOVE message to get the co-ordinates. This will
involve converting them between client and screen co-ordinates with
the two conversion functions, ScreenToClient() and ClientToScreen()

Regards,

hutch@pbq.com.au

edit added code tags

This message was edited by Hiroshimator, on 2/16/2001 7:48:20 PM</div>
    <div class="meta">Posted on 2001-02-14 02:07:00 by hutch--</div>
   </div>
   <div class="post" id="post-193467">
    <div class="subject"><a href="#post-193467">window handle</a></div>
    <div class="body">hi hutch, sorry i didnt phrase my question right:

what im making is an API spy, for my first program in win32 asm and so far this is my code:

invoke SendMessage, WindowID, WM_GETTEXT, 1024, addr buffer
invoke SendMessage, TextBoxID, WM_SETTEXT, 0, addr buffer
		
invoke GetClassName, WindowID, addr buffer, SizeOf buffer
invoke SendMessage, TextBoxID2, WM_SETTEXT, 0, addr buffer

the next box TextBoxID3 is for the windows handle, but im not sure how to get it? :(</div>
    <div class="meta">Posted on 2001-02-14 14:02:00 by hehe</div>
   </div>
   <div class="post" id="post-193468">
    <div class="subject"><a href="#post-193468">window handle</a></div>
    <div class="body">im sorry to post again about this, but i really cant figure it out. has anyone made an api spy that knows how to retrieve a windows handle#? 

thanks for any help.</div>
    <div class="meta">Posted on 2001-02-16 19:31:00 by hehe</div>
   </div>
  </div>
 </body>
</html>