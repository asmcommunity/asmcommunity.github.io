<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Listbox Help.. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7397" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=7397">Listbox Help..</a></p>
   <div class="post" id="post-53784">
    <div class="subject"><a href="#post-53784">Listbox Help..</a></div>
    <div class="body">I'm new to asm, when I try to add a string to the listbox, it doesn't work, even if I use addr, like<br /><br />invoke SendMessage,listbox,LB_ADDSTRING,0,addr string<br /><br />There are no errors when I don't use addr, but it doesn't put the string in the listbox, but when I do use addr I get a message that says invalid value</div>
    <div class="meta">Posted on 2002-08-17 14:15:38 by CyberGuy</div>
   </div>
   <div class="post" id="post-53786">
    <div class="subject"><a href="#post-53786">Listbox Help..</a></div>
    <div class="body">This is Masm syntax, Fasm syntax is to use ptr instead or addr, like<br /><br />invoke SendMessage,listbox,LB_ADDSTRING,0,ptr string<br />or<br />invoke SendMessage,listbox,LB_ADDSTRING,0,<br /><br />but then again, I'm new to Fasm, so that might also be totally out of the way...</div>
    <div class="meta">Posted on 2002-08-17 14:39:29 by Natix</div>
   </div>
   <div class="post" id="post-53787">
    <div class="subject"><a href="#post-53787">didn't work</a></div>
    <div class="body">Neither methods worked, ptr returned an invalid value error, and  returned a invalid size of operand error</div>
    <div class="meta">Posted on 2002-08-17 14:47:57 by CyberGuy</div>
   </div>
   <div class="post" id="post-53788">
    <div class="subject"><a href="#post-53788">Listbox Help..</a></div>
    <div class="body">doh!<br /><br />I think it's complaining about listbox :o <br /><br />can you post some other code too? might help :)</div>
    <div class="meta">Posted on 2002-08-17 14:58:16 by Natix</div>
   </div>
   <div class="post" id="post-53796">
    <div class="subject"><a href="#post-53796">Listbox Help..</a></div>
    <div class="body">Is listbox a variable containing handle? Then it should be:<br /><pre><code><br />invoke SendMessage,&#91;listbox&#93;,LB_ADDSTRING,0,string<br /></code></pre></div>
    <div class="meta">Posted on 2002-08-17 15:29:26 by Tomasz Grysztar</div>
   </div>
   <div class="post" id="post-53814">
    <div class="subject"><a href="#post-53814">Listbox Help..</a></div>
    <div class="body">&quot;invoke SendMessage,,LB_ADDSTRING,0,string&quot; returns no errors, but it doesn't add the string to the listbox, and listbox does contain a handle. In C++ you have to use (LPARAM)string to convert the string, but how do you do that in FASM?</div>
    <div class="meta">Posted on 2002-08-17 18:12:49 by CyberGuy</div>
   </div>
   <div class="post" id="post-53815">
    <div class="subject"><a href="#post-53815">Listbox Help..</a></div>
    <div class="body">what is string? how is it define?<pre><code>t1 DB &quot;Test&quot;, 0<br />...<br />invoke SendMessage, &#91;listbox&#93;, LB_ADDSTRING, NULL, t1</code></pre>try this for testing purposes, if this works then the string &quot;variable&quot; you originally declared doesn't contain a string but a number.</div>
    <div class="meta">Posted on 2002-08-17 18:19:20 by stryker</div>
   </div>
   <div class="post" id="post-53819">
    <div class="subject"><a href="#post-53819">Listbox Help..</a></div>
    <div class="body">it didn't work, there were no errors but it didn't put the string in the listbox, I seem to need to convert the string into a specific format. Does anyone know how?</div>
    <div class="meta">Posted on 2002-08-17 18:44:52 by CyberGuy</div>
   </div>
   <div class="post" id="post-53822">
    <div class="subject"><a href="#post-53822">Listbox Help..</a></div>
    <div class="body">really? are you sure  is really the handle to the listbox? Try this sample.</div>
    <div class="meta">Posted on 2002-08-17 19:33:28 by stryker</div>
   </div>
   <div class="post" id="post-54517">
    <div class="subject"><a href="#post-54517">Listbox Help..</a></div>
    <div class="body">thanks alot, I just made a really careless mistake that caused the whole thing not to work</div>
    <div class="meta">Posted on 2002-08-22 16:58:26 by CyberGuy</div>
   </div>
  </div>
 </body>
</html>