<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>finit - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13999" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=13999">finit</a></p>
   <div class="post" id="post-108169">
    <div class="subject"><a href="#post-108169">finit</a></div>
    <div class="body">Do we really have to use this instruction nowadays?<br />It's only used in the days when the FPU and processor EDIT:CPU were separate units right?</div>
    <div class="meta">Posted on 2003-06-24 19:53:45 by david</div>
   </div>
   <div class="post" id="post-108171">
    <div class="subject"><a href="#post-108171">finit</a></div>
    <div class="body">Well, you could use FNINIT instead, and not execute the FWAIT intrinsic before the instruction. This has problems on a 486 in DOS mode though.</div>
    <div class="meta">Posted on 2003-06-24 21:01:19 by donkey</div>
   </div>
   <div class="post" id="post-108199">
    <div class="subject"><a href="#post-108199">finit</a></div>
    <div class="body">So...on pentium and above no need for this opcode?<br />( I can ignore it? )</div>
    <div class="meta">Posted on 2003-06-25 05:59:06 by david</div>
   </div>
   <div class="post" id="post-108204">
    <div class="subject"><a href="#post-108204">finit</a></div>
    <div class="body">Yes, you can<br /><br />From agner.hlp, chapter 26<br /><div class="quote"><br />The assembler automatically inserts a WAIT for this purpose before the following instructions: FCLEX, FINIT, FSAVE, FSTCW, FSTENV, FSTSW. You can omit the WAIT by writing FNCLEX, etc. My tests show that the WAIT is unneccessary in most cases because these instructions without WAIT will still generate an interrupt on exceptions except for FNCLEX and FNINIT on the 80387. (There is some inconsistency about whether the IRET from the interrupt points to the FN.. instruction or to the next instruction). <br /></div></div>
    <div class="meta">Posted on 2003-06-25 06:47:06 by greenant</div>
   </div>
   <div class="post" id="post-108207">
    <div class="subject"><a href="#post-108207">finit</a></div>
    <div class="body">good. thanks. :)</div>
    <div class="meta">Posted on 2003-06-25 07:25:58 by david</div>
   </div>
   <div class="post" id="post-108260">
    <div class="subject"><a href="#post-108260">finit</a></div>
    <div class="body"><div class="quote"><br />So...on pentium and above no need for this opcode?<br />( I can ignore it? ) </div><br />No.  The FPU requires <strong>finit</strong>.  However, as long as your target OS is not DOS, you can ignore it.  The OS is supposed to handle it for you, be it Windows, Unix or linux.<br /><br />In fact, a sane OS issues <strong>finit</strong> at the OS init time, and then, uses <strong>f(n)save/frstor</strong> combination to provide appropriate environment for an app.  So, as a programmer, you don't have to worry about <strong>finit</strong> unless you are building your own OS.</div>
    <div class="meta">Posted on 2003-06-25 17:45:06 by Starless</div>
   </div>
   <div class="post" id="post-108262">
    <div class="subject"><a href="#post-108262">finit</a></div>
    <div class="body">That was enlightening info. thanks!</div>
    <div class="meta">Posted on 2003-06-25 18:07:29 by david</div>
   </div>
   <div class="post" id="post-108271">
    <div class="subject"><a href="#post-108271">finit</a></div>
    <div class="body">I agree you may not need finit unless you make heavy use of the FPU. If you have several procedures using it, any leftover data in the data registers could rapidly fill up the very limited number of registers and render all calculations useless.<br /><br />It's just a simple precaution to initialize the FPU within each procedure to ensure you have a clean system to work with. And it is even more important if you also use MMX/SSE instructions.<br /><br />Raymond</div>
    <div class="meta">Posted on 2003-06-25 23:20:22 by Raymond</div>
   </div>
  </div>
 </body>
</html>