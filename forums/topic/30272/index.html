<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>converting 8086 to a86 program - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30272" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=30272">converting 8086 to a86 program</a></p>
   <div class="post" id="post-213308">
    <div class="subject"><a href="#post-213308">converting 8086 to a86 program</a></div>
    <div class="body">sorry for the double post. but who could help me up with this code? :( it wont run on a86 but runs perfectly on 8086. please help me. <br /><br /><pre><code><br />JMP BEGIN<br />MES:DB &#039;ASCII CHARACTERS&#039;<br />MES3 DB &#039;PASSWORD INCORRECT!DENIED ACCESS!$&#039;<br />MES2 db &#039;PASSWORD: $&#039;<br />MES1 db &#039;RETRY: $&#039;<br />MSG: DB &#039;Please enter the fan number: $&#039;<br />MSG1: DB &#039;Fan No. 1 has been successfully turned on$&#039;<br />MSG2: DB &#039;Fan No. 2 has been successfully turned on$&#039;<br />MSG3: DB &#039;Fan No. 3 has been successfully turned on$&#039;<br />MSG4: DB &#039;Fan No. 4 has been successfully turned on$&#039;<br />MSG1A: DB &#039;Fan No. 1 is not working, contact the electrician immediately$&#039;<br />MSG2A: DB &#039;Fan No. 2 is not working, contact the electrician immediately$&#039;<br />MSG3A: DB &#039;Fan No. 3 is not working, contact the electrician immediately$&#039;<br />MSG4A: DB &#039;Fan No. 4 is not working, contact the electrician immediately$&#039;<br />MSG1B: DB &#039;Fan No. 1 has been successfully shut down$&#039;<br />MSG2B: DB &#039;Fan No. 2 has been successfully shut down$&#039;<br />MSG3B: DB &#039;Fan No. 3 has been successfully shut down$&#039;<br />MSG4B: DB &#039;Fan No. 4 has been successfully shut down$&#039;<br />MSG1C: DB &#039;Fan No. 1 is still on$&#039;<br />MSG2C: DB &#039;Fan No. 2 is still on$&#039;<br />MSG3C: DB &#039;Fan No. 3 is still on$&#039;<br />MSG4C: DB &#039;Fan No. 4 is still on$&#039;<br />MSG5: DB &#039;Do you still want to continue?(y/n): $&#039;<br />MSG6: DB &#039;Thank you for using the program... &nbsp;:) bye!$&#039;<br />MSG7: DB &#039;Do you want to turn on or off a fan?&lt;o/f&gt;: $&#039;<br />MSG8: DB &#039;You entered a wrong answer! Please follow the instructions $&#039;<br />MSG10: DB &#039;Press 1 to turn on all the fans OR 2 to turn it on one at a time $&#039; <br />MSG12: DB &#039;Press 1 to turn off all the fans OR 2 to turn it off one at a time $&#039;<br />MSG9A: DB &#039;Fan Nos. 1 2 3 &amp; 4 has been successfully turned on$&#039;<br />MSG11A: DB &#039;Fan Nos. 1 2 3 &amp; 4 has been successfully shut down$&#039;<br />MSG9: DB &#039;Are you sure you dont want to continue?(y/n): $&#039;<br /><br /><br />ASTERISK:			<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,09H<br /> &nbsp; &nbsp; &nbsp; &nbsp;LEA DX,ASK<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;RET<br />ASK: DB &#039;#$&#039;<br /><br /><br />SPACE: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;ENDLINE SUBROUTINE<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,02<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DX,00AH<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DX,00DH<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;RET<br />CLEAR:			 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;CLEAR SCREEN SUBROUTINE<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AX,03<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 10H<br /> &nbsp; &nbsp; &nbsp; &nbsp;RET<br />CENTER: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;CENTER ALIGNMENT OF CURSOS SUBROUTINE			<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,02<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DH,12<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DL,20<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 10H<br /> &nbsp; &nbsp; &nbsp; &nbsp;RET<br /> &nbsp; &nbsp; &nbsp; &nbsp;<br />ORIGIN:<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,02<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DH,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DL,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 10H<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;RET<br /> &nbsp; &nbsp; &nbsp; <br />WRONG1: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;IF THE SYNTAX ENTERED IS WRONG IT WILL GO HERE <br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL CLEAR<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL CENTER<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,09<br /> &nbsp; &nbsp; &nbsp; &nbsp;LEA DX,MSG8<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL SPACE<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,02<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DH,13<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DL,20<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 10H &nbsp; &nbsp; &nbsp; &nbsp;<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,09<br /> &nbsp; &nbsp; &nbsp; &nbsp;LEA DX,MSG5<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,01<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP AL,06EH<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE NO<br /><br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP AL,04EH<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE NO<br /><br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP AL,059H<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE YES1<br /><br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP AL,079H<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE YES1<br /> &nbsp; &nbsp; &nbsp; &nbsp;<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL WRONG1<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL CLEAR<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,02<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DH,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DL,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 10H<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br /> &nbsp; &nbsp; &nbsp; &nbsp;YES1:<br /> &nbsp; &nbsp; &nbsp; &nbsp;<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;RET<br /><br /><br />BEGIN:<br /><br /><br />CALL CLEAR		;clear the screen<br />CALL CENTER<br />MOV AH,09H		;display string<br />LEA DX,MES2		;prints Enter password<br />INT 21H<br />MOV BL,3<br />AGAIN:<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,07		;direct keyboard input<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,AL		;move the input al to bh<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,0DH<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE &nbsp;AGAIN<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL ASTERISK<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,&#039;e&#039;		<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE AGAIN1		;if equal jump to again<br /> &nbsp; &nbsp; &nbsp; &nbsp;JNE WRONG		;if not to wrong<br />AGAIN1:<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,07<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,AL<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,0DH<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE INVALID9<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL ASTERISK<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,08H<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE AGAIN<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,&#039;d&#039;		<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE AGAIN2<br /> &nbsp; &nbsp; &nbsp; &nbsp;JNE WRONG<br />AGAIN2:<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,07<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,AL<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL ASTERISK<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,&#039;r&#039;		<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE AGAIN3<br /> &nbsp; &nbsp; &nbsp; &nbsp;JNE WRONG<br />INVALID9:<br /> &nbsp; &nbsp; &nbsp; &nbsp; CALL INVALID8<br />AGAIN3:<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,07<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,AL<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL ASTERISK<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,&#039;i&#039;		<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE AGAIN4<br /> &nbsp; &nbsp; &nbsp; &nbsp;JNE WRONG<br />AGAIN4:<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,07<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21h<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,AL<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL ASTERISK<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,&#039;a&#039;		<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE AGAIN5<br /> &nbsp; &nbsp; &nbsp; &nbsp;JNE WRONG<br />AGAIN5:<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,07<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21h<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,AL<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL ASTERISK<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,&#039;n&#039;		<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE AGAIN6<br /> &nbsp; &nbsp; &nbsp; &nbsp;JNE WRONG<br />AGAIN6:<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,07<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21h<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,AL<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL ASTERISK<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,&#039;7&#039;		<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE AGAIN7<br /> &nbsp; &nbsp; &nbsp; &nbsp;JNE WRONG<br />INVALID8:<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL INVALID<br />AGAIN7:<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,07<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,AL<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,0DH	;compare the input with the enter key<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE EXIT<br /> &nbsp; &nbsp; &nbsp; &nbsp;JNE WRONG<br />WRONG:<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,07<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,AL<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL ASTERISK<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BH,0DH	;compare the input with the enter key<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE INVALID<br /> &nbsp; &nbsp; &nbsp; &nbsp;JNE WRONG<br />INVALID:<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL CLEAR<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL CENTER<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,09<br /> &nbsp; &nbsp; &nbsp; &nbsp;LEA DX,MES1	;prints retry password<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;DEC BL		;decrements bl until 3 attempts<br /> &nbsp; &nbsp; &nbsp; &nbsp;CMP BL,0<br /> &nbsp; &nbsp; &nbsp; &nbsp;JE INVALID2<br /> &nbsp; &nbsp; &nbsp; &nbsp;JMP AGAIN<br />INVALID2:<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL CLEAR<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL CENTER<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,09		;print password failed!!!<br /> &nbsp; &nbsp; &nbsp; &nbsp;LEA DX,MES3<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 21H<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 20H<br />EXIT:<br /> &nbsp; &nbsp; &nbsp; &nbsp;CALL CLEAR<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV AH,02<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV BH,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DH,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;MOV DL,00<br /> &nbsp; &nbsp; &nbsp; &nbsp;INT 10H<br /><br />;START OF THE MAIN PROGRAM<br /><br />START:<br />CALL SPACE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;START OF MAIN PROGRAM<br />MOV AH,09 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;1ST QUESTION<br />LEA DX,MSG7 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />INT 21H<br /><br />MOV AH,01<br />INT 21H<br /><br />CMP AL,04FH &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;COMPARING OF CHARACTER<br />JE TURNON<br /><br />CMP AL,06FH &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;COMPARING OF CHARACTER<br />JE TURNON<br /><br />CMP AL,046H &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;COMPARING OF CHARACTER<br />JE TURNOFF<br /><br />CMP AL,066H &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;COMPARING OF CHARACTER<br />JE TURNOFF<br /><br /><br /><br />CALL WRONG1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;CATCH CHARACTERS THAT ARE NOT VALID<br />CALL CLEAR<br />CALL ORIGIN<br />JMP START:<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;IF YOU WANT TO TURN ON A FAN<br />TURNON:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG10<br />INT 21H<br /><br />MOV AH,08<br />INT 21H<br /><br />CMP AL,031h &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;IF YOU WANT TO TURN ON ALL THE FANS<br />JE FANALL<br /><br />CMP AL,032h &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;IF YOU WANT TO TURN ON THE FAN ONE AT A TIME<br />JE FAN1X1<br /><br />CALL WRONG1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;MAKE IT A SUBROUTINE<br />CALL CLEAR<br />CALL ORIGIN<br />JMP TURNON<br /><br />FANALL: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;IF FAN ALL IS CHOSEN<br />MOV AL,0001<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0001<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,01<br />JE ON1A<br />JNE OFF1A<br /><br />HERE1: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br /><br />MOV AL,0010<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0010<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,01<br />JE ON2A<br />JNE OFF2A<br /><br />HERE2:<br /><br />MOV AL,0011<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0011<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,01<br />JE ON3A<br />JNE OFF3A<br /><br />HERE3:<br /><br />MOV AL,0100<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0100<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,01<br />JE ON4A<br />JNE OFF4A<br /><br />ON1A:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG1<br />INT 21H<br /><br />JMP HERE1<br /><br />OFF1A:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG1A<br />INT 21H<br /><br />JMP HERE1<br /><br />ON2A:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG2<br />INT 21H<br /><br />JMP HERE2<br /><br />OFF2A:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG2A<br />INT 21H<br /><br />JMP HERE2<br /><br />ON3A:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG3<br />INT 21H<br /><br />JMP HERE3<br /><br />OFF3A:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG3A<br />INT 21H<br /><br />JMP HERE3<br /><br />ON4A:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG4<br />INT 21H<br /><br />JMP NEXT<br /><br />OFF4A:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG4A<br />INT 21H<br /><br />JMP NEXT<br /><br /><br />FAN1X1:<br />CALL SPACE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;IF YOU CHOSE TO TURN ON THE FAN 1BY1<br />MOV AH,09<br />LEA DX,MSG<br />INT 21H<br /><br />MOV AH,01<br />INT 21H<br /><br />CMP AL,031h<br />JE FAN1<br /><br />CMP AL,032h<br />JE FAN2<br /><br />CMP AL,033h<br />JE FAN3<br /><br />CMP AL,034h<br />JE FAN4<br /><br /><br />CALL WRONG1<br />CALL CLEAR<br />CALL ORIGIN<br />JMP &nbsp;TURNON<br /><br />FAN1:<br />MOV AL,0001<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0001<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,01<br />JE ON1<br />JNE OFF1<br /><br />ON1:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG1<br />INT 21H<br /><br />JMP NEXT<br /><br />OFF1:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG1A<br />INT 21H<br /><br />JMP NEXT<br /> &nbsp; <br /> &nbsp; <br />FAN2:<br />MOV AL,0010<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0010<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,02<br />JE ON2<br />JNE OFF2<br /><br />ON2:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG2<br />INT 21H<br /><br />JMP NEXT<br /><br />OFF2:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG2A<br />INT 21H<br /><br />JMP NEXT<br /><br />FAN3:<br />MOV AL,0011<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0011<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,03<br />JE ON3<br />JNE OFF3<br /><br />ON3:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG3<br />INT 21H<br /><br />JMP NEXT<br /><br />OFF3:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG3A<br />INT 21H<br /><br />JMP NEXT<br /><br /><br />FAN4:<br />MOV AL,0100<br />MOV DX,378h<br />OUT DX,AL<br /><br /><br />MOV AL,0100<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,04<br />JE ON4<br />JNE OFF4<br /><br />ON4:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG4<br />INT 21H<br /><br />JMP NEXT<br /><br />OFF4:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG4A<br />INT 21H<br /><br />NEXT: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;ASK THE USER IF HE/SHE WANTS TO CONTINUE<br />CALL SPACE<br /><br />MOV AH,09<br />LEA DX,MSG5<br />INT 21H<br /><br />MOV AH,01<br />INT 21H<br /><br />CMP AL,06EH<br />JE NO<br /><br />CMP AL,04EH<br />JE NO<br /><br />CMP AL,059H<br />JE YES<br /><br />CMP AL,079H<br />JE YES<br /><br /><br />CALL WRONG1<br />CALL CLEAR<br />CALL ORIGIN<br />JMP NEXT<br /><br /><br />NO: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;IF THE ASWER IS NO<br />MOV AH,02<br />MOV BH,00<br />MOV DH,13<br />MOV DL,20<br />INT 10H &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />JMP END<br /><br />YES: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;IF THE ANSWER IS YES<br />CALL CLEAR<br />CALL ORIGIN<br />JMP START:<br /><br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;IF THE USER CHOSE TO TURN OFF THE FANS<br />TURNOFF:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG12<br />INT 21H<br /><br />MOV AH,08<br />INT 21H<br /><br />CMP AL,031h<br />JE FANALLO<br /><br />CMP AL,032h<br />JE FAN1X1O<br /><br />CALL WRONG1<br />CALL CLEAR<br />CALL ORIGIN<br />JMP &nbsp;TURNOFF<br /><br />FANALLO: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;IF THE USER CHOSE TO TURN OF ALL THE FANS<br />MOV AL,0000<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0000<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,00<br />JE OFF1B<br />JNE ON1B<br /><br />HERE1O:<br /><br />MOV AL,0000<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0000<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,00<br />JE OFF2B<br />JNE ON2B<br /><br />HERE2O:<br /><br />MOV AL,0000<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0000<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,00<br />JE OFF3B<br />JNE ON3B<br /><br />HERE3O:<br /><br />MOV AL,0000<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0000<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,00<br />JE OFF4B<br />JNE ON4B<br /><br />ON1B:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG1C<br />INT 21H<br /><br />JMP HERE1O<br /><br />OFF1B:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG1B<br />INT 21H<br /><br />JMP HERE1O<br /><br />ON2B:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG2C<br />INT 21H<br /><br />JMP HERE2O<br /><br />OFF2B:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG2B<br />INT 21H<br /><br />JMP HERE2O<br /><br />ON3B:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG3C<br />INT 21H<br /><br />JMP HERE3O<br /><br />OFF3B:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG3B<br />INT 21H<br /><br />JMP HERE3O<br /><br />ON4B:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG4C<br />INT 21H<br /><br />JMP NEXT<br /><br />OFF4B:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG4B<br />INT 21H<br /><br />JMP NEXT<br /><br /><br />FAN1X1O: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;IF THE USER CHOSE TO TURN OF THE FAN 1BY1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG<br />INT 21H<br /><br />MOV AH,01<br />INT 21H<br /><br />CMP AL,031h<br />JE FANO1<br /><br />CMP AL,032h<br />JE FANO2<br /><br />CMP AL,033h<br />JE FANO3<br /><br />CMP AL,034h<br />JE FANO4<br /><br />CALL WRONG1<br />CALL CLEAR<br />CALL ORIGIN<br />JMP TURNOFF<br /><br /><br />FANO1:<br />MOV AL,0000<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0000<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,00<br />JE &nbsp;OFFO1<br />JNE ONO1<br /><br />ONO1:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG1C<br />INT 21H<br /><br />JMP NEXT<br /><br />OFFO1:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG1B<br />INT 21H<br /><br />JMP NEXT<br /><br />FANO2:<br />MOV AL,0000<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0000<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,00<br />JE &nbsp;OFFO2<br />JNE ONO2<br /><br />ONO2:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG2C<br />INT 21H<br /><br />JMP NEXT<br /><br />OFFO2:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG2B<br />INT 21H<br /><br />JMP NEXT &nbsp; <br /><br />FANO3:<br />MOV AL,0000<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0000<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,00<br />JE &nbsp;OFFO3<br />JNE ONO3<br /><br />ONO3:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG3C<br />INT 21H<br /><br />JMP NEXT<br /><br />OFFO3:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG3B<br />INT 21H<br /><br />JMP NEXT &nbsp; <br /><br />FANO4:<br />MOV AL,0000<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0000<br />MOV DX,379h<br />IN &nbsp;AL,DX<br /><br />CMP AL,00<br />JE &nbsp;OFFO4<br />JNE ONO4<br /><br />ONO4:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG4C<br />INT 21H<br /><br />JMP NEXT<br /><br />OFFO4:<br />CALL SPACE<br />MOV AH,09<br />LEA DX,MSG4B<br />INT 21H<br /><br />JMP NEXT<br /> &nbsp; <br /><br />END:<br />MOV AH,09<br />LEA DX,MSG9<br />INT 21H<br /><br />MOV AH,01<br />INT 21H<br /><br />CMP AL,06EH<br />JE START<br /><br />CMP AL,04EH<br />JE START<br /><br />CMP AL,059H<br />JE YEAHMEN!<br /><br />CMP AL,079H<br />JE YEAHMEN!<br /><br />CALL WRONG1<br />CALL CLEAR<br />CALL ORIGIN<br />CALL SPACE<br />JMP END:<br /><br />YEAHMEN!:<br />CALL CLEAR<br />CALL CENTER<br />MOV AH,09<br />LEA DX,MSG6<br />INT 21H &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />INT 20H<br /></code></pre><br /><br /><span style="font-size:8pt><em>Edit by SpooK: CODE tags are your friend.</em></span></div>
    <div class="meta">Posted on 2010-10-07 11:47:43 by redprintz</div>
   </div>
   <div class="post" id="post-213309">
    <div class="subject"><a href="#post-213309">Re: converting 8086 to a86 program</a></div>
    <div class="body">What happens with a86? &quot;won&#039;t run&quot; isn&#039;t much to go on.<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="meta">Posted on 2010-10-07 13:00:04 by fbkotler</div>
   </div>
   <div class="post" id="post-213310">
    <div class="subject"><a href="#post-213310">Re: converting 8086 to a86 program</a></div>
    <div class="body"><strong>redprintz</strong>,<br /><br />Why it <em>should</em> compile? <strong>mov al, 0100</strong> is a no-no in A86 land, for example.</div>
    <div class="meta">Posted on 2010-10-07 14:06:27 by baldr</div>
   </div>
   <div class="post" id="post-213311">
    <div class="subject"><a href="#post-213311">Re: converting 8086 to a86 program</a></div>
    <div class="body">ikr!. :( <br />but can my teacher said that we would run the program using a86. as you can see the program is all about turning on a fan and off using assembly language and parallel ports. any hints on what can i do with the mov al,0100? is mov al,02h? please help me out. and there&#039;s also a problem saying &quot;jump &lt;128&gt;&quot; on some labels and call functions. please help. it&#039;s already due tomorrow and i need to fix the program.</div>
    <div class="meta">Posted on 2010-10-08 00:35:59 by redprintz</div>
   </div>
   <div class="post" id="post-213312">
    <div class="subject"><a href="#post-213312">Re: converting 8086 to a86 program</a></div>
    <div class="body">I missed the &quot;mov al, 0100&quot; problem - good catch, baldr! The reason it won&#039;t assemble is that a86 treats any number beginning with a &#039;0&#039; as hex! If it were 100 decimal, it would fit (you understand that, I hope!). But 100 decimal doesn&#039;t make much sense. Judging from the &quot;pattern&quot;, it looks to me as if those numbers are supposed to be binary. According to the manual (a86 has a nice manual!) a86 indicates binary as &quot;100xB&quot;, for example. What&#039;s 8086 (I ASSume you mean the emulator, not the CPU) think &quot;0100&quot; means? If they&#039;re supposed to be binary, you could also represent them as 0, 1, 2, 4 (0100 would be 4, not 2 - you almost got that right). This applies to the numbers that you&#039;re &quot;out&quot;ing to the port, and comparison to the the numbers the port is &quot;in&quot;ing to al - not all the numbers in your program! (&quot;in&quot; overwrites al, so there&#039;s no point in loading something into it first - as you do repeatedly - but it won&#039;t hurt)<br /><br />There is no &quot;jump &lt;128&gt;&quot;. Unconditional &quot;jmp&quot; comes in two sizes. So do conditional jumps - apparently a86 doesn&#039;t know about the three-byte size - they weren&#039;t available before 80386, I&#039;m surprised &quot;8086&quot; lets you do it. Isaacson recommends &quot;IF cond JMP&quot;. Read chapter 8, at least!<br /><br />The usual way, if a conditional jump exceeds 128 bytes, and &quot;near&quot; jumps aren&#039;t available, is:<br /><br /><pre><code><br />; je foo - out of range<br />jne lillypad<br />jmp foo<br />lillypad:<br />; ...<br /></code></pre><br /><br />This is what &quot;IF cond JMP&quot; would generate.<br /><br />Tomorrow, eh? Good luck.<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="meta">Posted on 2010-10-08 02:24:46 by fbkotler</div>
   </div>
   <div class="post" id="post-213313">
    <div class="subject"><a href="#post-213313">Re: converting 8086 to a86 program</a></div>
    <div class="body">Thanks for the advice guys. but does anyone of you know how to make GUI on a 80x25 windows? for example an outline of a box or something. :) i just need the finishing touches. do you think it&#039;ll work on my circuit?</div>
    <div class="meta">Posted on 2010-10-08 08:19:12 by redprintz</div>
   </div>
   <div class="post" id="post-213314">
    <div class="subject"><a href="#post-213314">Re: converting 8086 to a86 program</a></div>
    <div class="body">I dunno, post the schematic! :)<br /><br />Seriously, if it works, it works. That doesn&#039;t mean it&#039;s &quot;right&quot; - code that &quot;works&quot; but has bugs in it is easy!<br /><br />Drawing the outline of a box isn&#039;t difficult...<br /><br />http://en.wikipedia.org/wiki/Box-drawing_characters<br /><br />A &quot;GUI&quot; really ought to be mouse-enabled... or at least handle arrow-keys, etc. You haven&#039;t got time to do a decent job with it. The trick to getting &quot;extended&quot; keys is that the &quot;get char&quot; interrupt (int 21h/1, int 21h/7, int 21h/8) returns zero - do it again to find out which key you&#039;ve got. Alternately, use the bios int 16h/0 - if al is zero, look in ah to find out which key... Mouse is on int 33h, as I recall.<br /><br />Here&#039;s an example that draws a box (and some other &quot;fancy&quot; text). This code is so old that I started it in a86, then discovered Nasm ( http://www.nasm.us ). The a86 version didn&#039;t get as far as the box, so I&#039;ll attach the Nasm version. I&#039;ll zip it up with the assembled .com file so you don&#039;t have to deal with still a third assembler. (But when you finish this class, get yourself a real assembler! Masm/Tasm/Nasm/Fasm/Jwasm... or register a86 and get a386 - a86 is a toy!) It writes &quot;direct to screen memory&quot;, so probably won&#039;t work in a &quot;windowed&quot; dox-box (alt-enter to go to full-screen mode, as I recall). Might not work at all any more... you can try it, and look at the code anyway...<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=3261" target="_blank">chello8.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2010-10-08 14:09:13 by fbkotler</div>
   </div>
   <div class="post" id="post-213315">
    <div class="subject"><a href="#post-213315">Re: converting 8086 to a86 program</a></div>
    <div class="body"><strong>redprintz</strong>,<br /><br />GUI does mean graphic mode, doesn&#039;t it?</div>
    <div class="meta">Posted on 2010-10-08 15:13:57 by baldr</div>
   </div>
   <div class="post" id="post-213316">
    <div class="subject"><a href="#post-213316">Re: converting 8086 to a86 program</a></div>
    <div class="body">True. I suspect that what Redprintz is looking for is a &quot;Pitiful Text User Interface&quot;. PTUI! :)<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="meta">Posted on 2010-10-08 15:44:29 by fbkotler</div>
   </div>
   <div class="post" id="post-213317">
    <div class="subject"><a href="#post-213317">Re: converting 8086 to a86 program</a></div>
    <div class="body"><strong>redprintz</strong>,<br /><br />If you&#039;re trying to design windowing system in 80x25, take heed: no overlapped windows. Split this scarce visible space as you want, but don&#039;t aim for useless concept (derived from desktop paradigm): why in the name of seventh hell someone would need window if all that he/she can see is its border?</div>
    <div class="meta">Posted on 2010-10-08 17:09:00 by baldr</div>
   </div>
   <div class="post" id="post-213339">
    <div class="subject"><a href="#post-213339">Re: converting 8086 to a86 program</a></div>
    <div class="body">We actually tried interfacing it with the circuit. I don&#039;t have the schematics but the circuit is just easy. But it seems that we can&#039;t actually &quot;turn it on/off&quot; the fans. :( forget the GUI part. lol, what i need now is just to run the program. anyone that has free time willing to help me debug my code? Pretty please? :)<br />It&#039;s our exam week already and the project was extended 1 week. So basically we need it to run this until friday. I think I&#039;m going crazy now. Are the codes good? I mean the inputs and outputs. I can&#039;t do this on my own.&nbsp; :sad:<br /><br />Btw, I am running this program under vista. LOL<br />I know that it&#039;s wrong but I&#039;m desperate. I have this other computer that is WinXP but FFS it doesn&#039;t have any parallel ports installed. :(</div>
    <div class="meta">Posted on 2010-10-12 23:52:09 by redprintz</div>
   </div>
   <div class="post" id="post-213340">
    <div class="subject"><a href="#post-213340">Re: converting 8086 to a86 program</a></div>
    <div class="body">You like old folk music? You know &quot;Barbara Allen&quot;?<br /><br /><div class="quote"><br />And slowly, slowly she drew up<br />And slowly she drew nigh him<br />And the only words to him did say<br />Young man, I think you&#039;re dyin&#039;.<br /></div><br /><br />If you can&#039;t do it on your own, I think you&#039;re gonna flunk the course! But I suppose we can try to help you debug it. Once again, &quot;what happens?&quot; Does the program appear to run, but the fans don&#039;t turn on and off? Or does the program crash when you attempt to &quot;out&quot; a byte to a port? (&quot;this program has performed an illegal operation and will be shut down&quot;?) Are you trying to step through it with d86 (or other debugger) to see what&#039;s happening? We started off here with something that &quot;runs perfectly in 8086&quot;. How true is that? Did it actually turn fans on and off?<br /><br />&quot;Are the codes good? I mean the inputs and outputs.&quot;<br /><br />Dunno, let&#039;s take a look...<br /><br /><pre><code><br />FANALL:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;IF FAN ALL IS CHOSEN<br />MOV AL,0001<br />MOV DX,378h<br />OUT DX,AL<br /><br />MOV AL,0001 ; useless!<br />MOV DX,379h<br />IN&nbsp; AL,DX<br /><br />CMP AL,01<br />JE ON1A<br />JNE OFF1A<br /></code></pre><br /><br />I&#039;m ASSuming that those numbers are expressed in binary, &quot;0001xB&quot; for a86, etc.<br /><br />I rather doubt if that is correct. I hope I remember this as being more complicated than it is... I think what you need to do is:&nbsp; poll the &quot;busy&quot; bit in the status port until it goes off, put your byte on the data port, set the &quot;strobe&quot; bit in the control port for at least 5 microseconds, turn it back off and repeat. In order to read anything from the data port (other than the last thing written to it), you may need to enable bidirectional port (bit 5 in the control port), and probably poll the status port some more. None of this may apply to your circuit... if you&#039;re lucky.<br /><br />What I would do, I think, is to set the &quot;masterwork&quot; aside for now, and write a bare minimum program that will turn *any* fan on - keep bashin&#039; on it until it does! Then fit what you&#039;ve learned back into the main program. Have you got any example code with your circuit - or in your textbook - that you can go by? A &quot;spec sheet&quot; that tells what the circuit is expecting to see, at least? Does your teacher - or grad students, perhaps - offer help sessions?<br /><br />Ralf Brown&#039;s &quot;ports.lst&quot; has the &quot;tables&quot; for the bits under port 3BCh, if that helps you find it easier. They&#039;ll be the same for ports 378h, 379h, and 37Ah... if those are the right ports - I ASSume you got those numbers from somewhere.<br /><br />If your OS won&#039;t let you touch the ports, of course, you&#039;ll need a new OS. Last time I ran Windows (win98), it was gettin&#039; pissy about it - the IDE controller wouldn&#039;t work in a dos-box... I think the parallel port did... but you could boot to real dos then. I imagine it&#039;s gotten worse. If all else fails, you might be able to run from a live CD...<br /><br />http://www.freedos.org/<br /><br />What&#039;s the setup in the Lab - or the machine on which your teacher will evaluate your program? Shoot for as close as that as you can get. (I&#039;m assuming you have this circuit at home/dorm. If you have to work in the lab... wow...)<br /><br />Nobody around here is going to do your homework for you, but we&#039;ll help, if we can. But we haven&#039;t got the circuit... and most of us don&#039;t use a86... so you&#039;re really going to have to do the bulk of it on your own. Sleep next week. :)<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="meta">Posted on 2010-10-13 03:56:20 by fbkotler</div>
   </div>
   <div class="post" id="post-213343">
    <div class="subject"><a href="#post-213343">Re: converting 8086 to a86 program</a></div>
    <div class="body">Thanks for this interesting information. Really helpful</div>
    <div class="meta">Posted on 2010-10-13 08:43:37 by autoreg</div>
   </div>
   <div class="post" id="post-213344">
    <div class="subject"><a href="#post-213344">Re: converting 8086 to a86 program</a></div>
    <div class="body">Thank you frank. But unfortunately our professor didn&#039;t teach us anything about &quot;poll the &quot;busy&quot; bit in the status port until it goes off, put your byte on the data port, set the &quot;strobe&quot; bit in the control port for at least 5 microseconds, turn it back off and repeat. In order to read anything from the data port (other than the last thing written to it), you may need to enable bidirectional port (bit 5 in the control port), and probably poll the status port some more.&quot; that. so basically i was a bit lost there. LOL. He only give us this syntax:<br />This for outputs<br /><pre><code><br />MOV DX, 300H ;I/O PORT ADDRESS IS 300h<br />MOV AL, 0FFH&nbsp; ; OUTPUT DATA SENT IS FFh<br />OUT DX,AL&nbsp; &nbsp; &nbsp; ;SEND FFh TO PORT 300h</code></pre><br />And this for inputs<br /><pre><code><br />MOV DX, 310h ; I/O PORT ADDRESS IS 310h<br />IN&nbsp; &nbsp; AL, DX&nbsp; &nbsp;  ; AL CONTAINS AN INPUT<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;DATA FROM PORT 310h</code></pre><br /><br />When I try it out on EMU8086 it works but unfortunately it&#039;s just an emulator. so the parallel port is not connected to any circuits. the program just works. when i tried it with a86 it still works but when i connect it to the fans it&#039;s like the program is not connected to the circuits at all. it&#039;s still the same w/ or w/o the parallel port. it just runs. like if i press &quot;1&quot; it says <br /><pre><code><br />Fan No. 1 is not working, contact the electrician immediately<br />Fan No. 2 is not working, contact the electrician immediately<br />Fan No. 3 is not working, contact the electrician immediately<br />Fan No. 4 is not working, contact the electrician immediately<br /></code></pre><br /><br />So when i see this i tell myself &quot;Oh, it&#039;s not yet connected to the circuit or the parallel port so maybe it doesn&#039;t detect any inputs from the circuit thus &quot;<br />Fan No. 1 is not working, contact the electrician immediately&quot; and so on. but when i connect it it&#039;s still the same.<br /><br />No one is helping me. I&#039;m just alone at this. Even my classmates don&#039;t share w/ each other. lol.<br />Thank you again sir. :)</div>
    <div class="meta">Posted on 2010-10-13 09:08:11 by redprintz</div>
   </div>
   <div class="post" id="post-213347">
    <div class="subject"><a href="#post-213347">Re: converting 8086 to a86 program</a></div>
    <div class="body">No, classmates aren&#039;t supposed to help each other. That would be called &quot;cheating&quot;. Personally, I&#039;d call it &quot;cooperating to solve a problem&quot;. But they&#039;re more interested in &quot;rating&quot; one student as &quot;better&quot; than another than in teaching you to cooperate to solve problems. (Do not get the grumpy old man started on the educational system!)<br /><br />If your professor didn&#039;t explain anything about polling the status port (or give you something to read about it), maybe you don&#039;t have to do it, with your circuit. The syntax you show applies to any port, but what you need to &quot;tell&quot; it differs. You wouldn&#039;t expect to do the same thing with the keyboard controller port as you&#039;d do with the Real Time Clock port, even though you&#039;d use the same &quot;in&quot; and &quot;out&quot; instructions. If you don&#039;t &quot;know&quot; what your circuit expects, you&#039;ll have to try to figure it out. Figuring out ports by trial-and-error isn&#039;t easy, in my experience!<br /><br />Start with something simple, just read the status port, and see what it says...<br /><br /><pre><code><br />; org 100h - I don&#039;t think a86 needs this<br /><br />mov dx, 379h<br />in al, dx<br /><br />call show_al_bin<br /><br />mov ah, 4Ch&nbsp; ; exit subfunction<br />int 21h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; call Good Ol&#039; Dos<br />;------------------------------------------<br /><br />show_al_bin:<br />push cx<br />push dx<br /><br />mov cx, 8&nbsp; ; 8 bits to print<br /><br />show_al_bin_top:<br />rcl al, 1&nbsp; &nbsp;  ; rotate al and set/clear carry flag<br />mov dl, &#039;0&#039; ; start with &#039;0&#039;<br />adc dl, 0&nbsp;  ; &quot;add with carry&quot; - make it &#039;1&#039;... or not<br /><br />push ax&nbsp; &nbsp; ; save al, we&#039;re using it<br />mov ah, 2 ; print character in dl subfunction<br />int 21h&nbsp; &nbsp;  ; call Good Ol&#039; Dos<br />pop ax&nbsp; &nbsp; &nbsp; ; get al back<br /><br />loop show_al_top ; do it 8 times<br /><br />pop dx<br />pop cx<br />ret<br />; end - I don&#039;t think a86 needs this<br />;--------------------------------<br /></code></pre><br /><br />That&#039;s untested, and may need some help to assemble with a86 (it was a long time ago I last used a86!), but you can probably get it going. Then try writing something to the data port...<br /><br /><pre><code><br />...<br />call show_al_bin<br /><br />mov dx, 378h<br />mov al, 1&nbsp; &nbsp; &nbsp; &nbsp; ; we don&#039;t care if it&#039;s binary, hex, or decimal!<br />out dx, al<br /><br />mov dx, 379h<br />in al, dx<br />call show_al_bin<br />...<br /></code></pre><br /><br />... and read the status port again to see if anything has changed. Try reading the data port, too. I would expect it to show what you just wrote to it, but maybe not...<br /><br />If the leftmost bit of the status port is a &#039;1&#039;, that&#039;s the &quot;busy&quot; bit, and maybe you do have to wait for it. If the data port always reads the same thing even after you write something else to it - especially if it&#039;s always all &#039;1&#039;s - that might be a sign that the OS is messin&#039; with ya. As I recall, that&#039;s what happened when I tried to read the IDE controller port in a Windows &quot;dos box&quot;, but in &quot;real dos&quot; the same code read the hard drive fine. I don&#039;t know what you can do if that&#039;s happening.<br /><br />See if you can learn anything from it. I know time&#039;s getting short...<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="meta">Posted on 2010-10-14 06:39:24 by fbkotler</div>
   </div>
   <div class="post" id="post-213348">
    <div class="subject"><a href="#post-213348">Re: converting 8086 to a86 program</a></div>
    <div class="body">Thank you for that sir. Now my problem is creating a flow chart. ughh. it doesn&#039;t get any better than this. <br />anyways. I&#039;ve encountered visustin v6.0 but the problem is it&#039;s not cracked or you could say it&#039;s not for free.<br />does anyone here knows a source code to flowchart generator? damn it. tomorrow is the deadline and i&#039;m gonna be toast!</div>
    <div class="meta">Posted on 2010-10-14 09:09:42 by redprintz</div>
   </div>
   <div class="post" id="post-213349">
    <div class="subject"><a href="#post-213349">Re: converting 8086 to a86 program</a></div>
    <div class="body"><div class="quote"><br />does anyone here knows a source code to flowchart generator?<br /></div><br /><br />Perhaps <a target="_blank" href="http://live.gnome.org/Dia">Dia</a> will help.</div>
    <div class="meta">Posted on 2010-10-14 12:45:31 by SpooK</div>
   </div>
  </div>
 </body>
</html>