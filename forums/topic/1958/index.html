<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>In Masm32 CGI assembly how does one get enviroment variables - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1958" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1958">In Masm32 CGI assembly how does one get enviroment variables</a></p>
   <div class="post" id="post-12601">
    <div class="subject"><a href="#post-12601">In Masm32 CGI assembly how does one get enviroment variables</a></div>
    <div class="body">Does anyone know how to get the Enviroment <br />Variables so one can know if it's null,( and <br /><br />might be cool to print them tOo!)<br />So you can know when to bypass calling StdIn<br />because if there's no data, the CGI just <br /><br />stalls and times out,<br /><br />It really revolves something like around <br />pQuery = getenv(&quot;QUERY_STRING&quot;);<br /><br />if (pQuery != NULL)<br /><br />I'm using POST though instead of QUERY_STRING, though<br /><br />Basically so I don't need a seperate html<br />page for data entry<br /><br /><br />Here's what I did in a C cgi<br /><br />CGI<br /><br /><a target="_blank" href="http://www.busybeesolutions.com/cgi-bin/intro/">http://www.busybeesolutions.com/cgi-bin/intro/</a><br /><br />einstein.exe<br /><br />Source<br /><br /><a target="_blank" href="http://www.busybeesolutions.com/sourcefiles/ei">http://www.busybeesolutions.com/sourcefiles/ei</a><br /><br />nstein.htm<br /><br />Thank Andy<br /><br />:stupid:</div>
    <div class="meta">Posted on 2001-11-20 09:37:18 by andy981</div>
   </div>
   <div class="post" id="post-12602">
    <div class="subject"><a href="#post-12602">Here is the CGI einstien.exe</a></div>
    <div class="body"><a target="_blank" href="http://www.busybeesolutions.com/cgi-bin/intro/einstein.exe">http://www.busybeesolutions.com/cgi-bin/intro/einstein.exe</a><br /><br /><br />:stupid:</div>
    <div class="meta">Posted on 2001-11-20 09:39:34 by andy981</div>
   </div>
   <div class="post" id="post-12603">
    <div class="subject"><a href="#post-12603">In Masm32 CGI assembly how does one get enviroment variables</a></div>
    <div class="body">There is the GetEnvironmentVariable API, but I'm not sure if its what you want.....<br /><br />Mirno</div>
    <div class="meta">Posted on 2001-11-20 09:56:48 by Mirno</div>
   </div>
   <div class="post" id="post-12604">
    <div class="subject"><a href="#post-12604">How does that work</a></div>
    <div class="body">invoke GetEnvironmentVariable,ADDR Buffer2,(LENGTHOF <br />Buffer2 - 1) <br /><br />This did not work?<br />But I'm just guessing</div>
    <div class="meta">Posted on 2001-11-20 10:10:15 by andy981</div>
   </div>
   <div class="post" id="post-12606">
    <div class="subject"><a href="#post-12606">In Masm32 CGI assembly how does one get enviroment variables</a></div>
    <div class="body">This code worked for me:<br /><br /><pre><code><br />.386<br />.model flat,stdcall<br />option casemap&#58;none<br /><br />include \masm32\include\windows.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\kernel32.inc<br /><br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br /><br /><br />.data<br />env         db &quot;PATH&quot;,0<br />buffer      db 2048 dup &#40;0&#41;<br /><br />.code<br />start&#58;<br />    invoke GetEnvironmentVariable, ADDR env, ADDR buffer, 2048<br />    invoke MessageBox, NULL, ADDR buffer, NULL, MB_OK<br /><br />    invoke ExitProcess, eax<br />end start<br /></code></pre><br /><br />Mirno</div>
    <div class="meta">Posted on 2001-11-20 10:37:30 by Mirno</div>
   </div>
   <div class="post" id="post-12626">
    <div class="subject"><a href="#post-12626">In Masm32 CGI assembly how does one get enviroment variables</a></div>
    <div class="body">I wrote an example that answers all your questions. Put test.html and cgitest.exe in the same folder and open test.html. The rest speaks for itself.<br /><br />Thomas</div>
    <div class="meta">Posted on 2001-11-20 14:26:56 by Thomas</div>
   </div>
   <div class="post" id="post-12636">
    <div class="subject"><a href="#post-12636">Thanks Thomas and Mirno too!</a></div>
    <div class="body">This is Great, now I can have the post html in the exe it self,<br />I had to go out earlier, but It had dawned on to me that<br />Mirno had an idea, I mean Instead of &quot;path&quot; for the string<br />in variable use &quot;Request Method&quot;.<br /> <br /> Hopefuly in Time I can build a universal way to get data in,<br />for CGI's at the moment, I'm just considering numbers in.<br />  But, I was thinking have an array with the addresses of<br />seperate empty strings, then load the contents of each<br />field, to be manipulated as needed, In the seperate string variables.<br />  Anyway THanks  Thomas, Your definately a Wizard<br /><br />                      Andy<br /><br />:)</div>
    <div class="meta">Posted on 2001-11-20 15:19:31 by andy981</div>
   </div>
   <div class="post" id="post-12639">
    <div class="subject"><a href="#post-12639">In Masm32 CGI assembly how does one get enviroment variables</a></div>
    <div class="body">I'm dumb-founded. I guess I should write a FAsm to MASM32 converter.</div>
    <div class="meta">Posted on 2001-11-20 15:43:34 by eet_1024</div>
   </div>
  </div>
 </body>
</html>