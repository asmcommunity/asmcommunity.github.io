<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>The Web Browser Saga Continues... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=812" />
    <link rel="next" href="../?id=812&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=812">The Web Browser Saga Continues...</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=812&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=812&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="812" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=812&amp;page=2">&gt;</a><a href="../?id=812&amp;page=2">&raquo;</a></form>   <div class="post" id="post-5040">
    <div class="subject"><a href="#post-5040">The Web Browser Saga Continues...</a></div>
    <div class="body">Ernie / Japheth,<br /><br />You two are just too cool for one message board...<br /><br />Anyway, I fixed the problems I found with the code. The only<br />thing I didn't implement was resizing. But thats really simple<br />to do.<br /><br />The attachement is in the format I would like to use for the<br />&quot;ClientSites&quot; subfolder of the MASM COM SDK. I haven't<br />written the documents or add-ins just yet. The latest version<br />of the code is in the \source\browser folder.<br /><br />When I'm finished with the package I'll post it here again or<br />maybe I could get it included with a future service pack...<br /><br />Xtreme</div>
    <div class="meta">Posted on 2001-08-27 08:27:37 by Xtreme</div>
   </div>
   <div class="post" id="post-5121">
    <div class="subject"><a href="#post-5121">The Web Browser Saga Continues...</a></div>
    <div class="body">Very very very impressive work.  This is obviously a fundamental  work in a new area for ASM. I'm going to have to find some time to study this in some detail (so I can steal your best tricks).<br /><br />Seems I did miss the boat on debuggers (I really don't use em ever), gonna have to make that change to CoLib to make the relations show in the symbols too (I'll just steal the relations you worked out here).<br /><br /><br />And also major congratulations on creating the worlds smallest (under 10K byte) web browser.             ;-)</div>
    <div class="meta">Posted on 2001-08-27 22:09:22 by Ernie</div>
   </div>
   <div class="post" id="post-5130">
    <div class="subject"><a href="#post-5130">The Web Browser Saga Continues...</a></div>
    <div class="body">Xtreme:<br /><br />wow, i'm impressed too. Xtreme you da man.<br /><br />dr phil :)<br /><br />question: the C++ version is 60k, assembler version is 10k... is that the best the C++ compiler can do? also i notice the C++ version also loads OLEAUT32.DLL (614k) on top of the OLE32.DLL (790k), can this be avoided in the C++ version?</div>
    <div class="meta">Posted on 2001-08-27 22:51:34 by phil</div>
   </div>
   <div class="post" id="post-5141">
    <div class="subject"><a href="#post-5141">The Web Browser Saga Continues...</a></div>
    <div class="body">This is something I've always wanted in asm, great work Xtreme!<br />:alright: <br /><br />Thomas</div>
    <div class="meta">Posted on 2001-08-28 02:52:52 by Thomas</div>
   </div>
   <div class="post" id="post-5145">
    <div class="subject"><a href="#post-5145">The Web Browser Saga Continues...</a></div>
    <div class="body">:alright: <br /><br />Xtreme, I think there is no need to define segments for each vtable as in your code:<br /><br /><pre><code><br />        @@IUnknown segment dword<br />        vtblIUnknown&#58;<br />                dd      offset QueryInterface<br />                dd      offset AddRef<br />                dd      offset Release<br />        @@IUnknown ends<br /><br /></code></pre><br /><br />without the segment definitions the resulting exe will be considerably smaller.<br /><br />japheth</div>
    <div class="meta">Posted on 2001-08-28 04:02:42 by japheth</div>
   </div>
   <div class="post" id="post-5160">
    <div class="subject"><a href="#post-5160">The Web Browser Saga Continues...</a></div>
    <div class="body">Thanks Everyone!,<br /><br />Last night I began working on the tutorials (Papers folder). I'm<br />going to continue to add new features to the browser demo:<br /><br />1. Executing &quot;external&quot; functions from Web page script.<br />2. Handling all events<br />3. &quot;Invoking&quot; Web page script from application code<br />4. &quot;Talking&quot; directly to the HTML page.<br /><br />Then I'll begin work on the QEditor Add-Ins and other examples:<br /><br />1. Namespace contol (the right-side of &quot;Organize Favorites&quot;)<br />2. Media Player<br />3. XML Parser<br />4. <br /><br /><br /><br /><br />Ernie,<br /><br />Go for it. Lets work together to create/consolidate include files<br />into one folder (your existing \com\include folder) for new include<br />files (Browser, Media Player, Shell, etc.). <br /><br /><br /><br /><br />Phil,<br /><br />I believe the C++ compiler is padding not to mention that it uses<br />cluttered, messy header files. I may have also linked with more<br />libs than necessary too.<br /><br /><br /><br /><br />Japheth,<br /><br />Another excellent suggestion. I'll give it a try this evening...</div>
    <div class="meta">Posted on 2001-08-28 08:42:50 by Xtreme</div>
   </div>
   <div class="post" id="post-5170">
    <div class="subject"><a href="#post-5170">The Web Browser Saga Continues...</a></div>
    <div class="body">Japheth,<br /><br />These segment defs are used in createobject:<br /><br /><pre><code><br />        mov &#40;Object ptr &#91;ebx&#93;&#41;.iUnknown.lpVtbl, offset vtblIUnknown                     ; save the offset&#40;pointer&#41; to the interface VTABLE in lpVtbl<br />        mov &#40;Object ptr &#91;ebx&#93;&#41;.iOleWindow.lpVtbl, offset vtblIOleWindow                 ; save the offset&#40;pointer&#41; to the interface VTABLE in lpVtbl<br />        mov &#40;Object ptr &#91;ebx&#93;&#41;.iOleClientSite.lpVtbl, offset vtblIOleClientSite         ; save the offset&#40;pointer&#41; to the interface VTABLE in lpVtbl<br />        mov &#40;Object ptr &#91;ebx&#93;&#41;.iOleInPlaceSite.lpVtbl, offset vtblIOleInPlaceSite       ; save the offset&#40;pointer&#41; to the interface VTABLE in lpVtbl<br />        mov &#40;Object ptr &#91;ebx&#93;&#41;.iDispatch.lpVtbl, offset vtblIDispatch                   ; save the offset&#40;pointer&#41; to the interface VTABLE in lpVtbl<br />        mov &#40;Object ptr &#91;ebx&#93;&#41;.iDocHostUIHandler.lpVtbl, offset vtblIDocHostUIHandler   ; save the offset&#40;pointer&#41; to the interface VTABLE in lpVtbl<br />        mov &#40;Object ptr &#91;ebx&#93;&#41;.iDocHostShowUI.lpVtbl, offset vtblIDocHostShowUI         ; save the offset&#40;pointer&#41; to the interface VTABLE in lpVtbl<br /></code></pre></div>
    <div class="meta">Posted on 2001-08-28 10:46:49 by Xtreme</div>
   </div>
   <div class="post" id="post-5181">
    <div class="subject"><a href="#post-5181">The Web Browser Saga Continues...</a></div>
    <div class="body">I removed the segment defs and the above code from<br />createobject. I'm not sure if it works or not because it<br />crashed (intermittently) on Win2K originally and thats<br />what I'm using now.<br /><br />I'll have more info tomorrow morning.</div>
    <div class="meta">Posted on 2001-08-28 12:40:38 by Xtreme</div>
   </div>
   <div class="post" id="post-5188">
    <div class="subject"><a href="#post-5188">The Web Browser Saga Continues...</a></div>
    <div class="body">Win2k-128MB-850-Laptop<br /><br />Doesn't work at all. <br /><br />I don't know what to provide more info because I don't know how to use a debugger.<br /><br />EDIT: I use MSIE 5.5</div>
    <div class="meta">Posted on 2001-08-28 13:23:29 by Kenny</div>
   </div>
   <div class="post" id="post-5190">
    <div class="subject"><a href="#post-5190">The Web Browser Saga Continues...</a></div>
    <div class="body">Thanks for the conformation Kenny.<br />I'll add the fix to the ToDo list.<br /><br />Any volunteers to test on the other platforms? When reporting<br />tell us your browser version... (MSIE 6.0 final is out today)<br /><br /><strong>Updated Wednesday, Aug. 29</strong><br /><br />1) Win95 -<br /><br />2) Win98 - Xtreme/IE6.0 Last Beta (WORKS)<br /><br />3) 98SE - AndyCar/IE 5.0 (WORKS) <br /><br />4) WinME -<br /><br />5) Win2K - Xtreme/IE6.0 (WORKS), Kenny/IE5.5 (?) <br /><br />6) WinXP -<br /><br />7) WinNT - <br /><br />8) WinCE -</div>
    <div class="meta">Posted on 2001-08-28 13:32:02 by Xtreme</div>
   </div>
   <div class="post" id="post-5202">
    <div class="subject"><a href="#post-5202">Volunteer on  98SE</a></div>
    <div class="body">Extreme, I'll be playing with it on 98SE, IE 5.0<br /><br />P.S. Nice work!</div>
    <div class="meta">Posted on 2001-08-28 15:39:59 by Andycar</div>
   </div>
   <div class="post" id="post-5215">
    <div class="subject"><a href="#post-5215">The Web Browser Saga Continues...</a></div>
    <div class="body">Win2k, IE 5.50.4522.1800.. works like a charm:)</div>
    <div class="meta">Posted on 2001-08-28 17:16:27 by Thomas</div>
   </div>
   <div class="post" id="post-5269">
    <div class="subject"><a href="#post-5269">The Web Browser Saga Continues...</a></div>
    <div class="body">Xtreme,<br /><br />What I meant was to remove the segment definitions from your vtable definitions, for example:<br /><br /><pre><code><br />;;;;;;;@@IUnknown segment dword<br />        vtblIUnknown&#58;<br />                dd      offset QueryInterface<br />                dd      offset AddRef<br />                dd      offset Release<br />;;;;;;;@@IUnknown ends<br /></code></pre><br /><br />thats all. No other changes (in CreateObject) are needed.<br /><br />As you can see in the MAP file, every segment such defined results in an additional section in the exe, which is unnecessary.<br /><br />japheth</div>
    <div class="meta">Posted on 2001-08-29 01:57:48 by japheth</div>
   </div>
   <div class="post" id="post-5291">
    <div class="subject"><a href="#post-5291">The Web Browser Saga Continues...</a></div>
    <div class="body">Hi Everybody,<br /><br />I tried removing the segment definitions but the assembler<br />croaks: &quot;error A2108: use of register assumed to ERROR&quot;.<br /><br /><pre><code><br />;*********************************************<br />; CLIENT SITE VTABLE STRUCTS <br />;*********************************************<br />        ;@@IUnknown segment dword<br />        vtblIUnknown&#58;<br />                dd      offset QueryInterface<br />                dd      offset AddRef<br />                dd      offset Release<br />        ;@@IUnknown ends<br /><br /><br />        ;@@IOleWindow segment dword<br />        vtblIOleWindow&#58;<br />                dd      offset QueryInterface<br />                dd      offset AddRef<br />                dd      offset Release<br />                dd      offset IOleWindow@GetWindow<br />                dd      offset IOleWindow@ContextSensitiveHelp<br />        ;@@IOleWindow ends<br /></code></pre><br /><br />It works on <strong>Win2K</strong> now. It had something to do with the<br />events handling not being complete. Thats done now! I'm still<br />working on the papers and add-ins. I'll post ALPHA2 of the<br />package soon .<br /><br /><em>See the Platform testing list above. I'll edit that message with<br />new info as it becomes available.</em></div>
    <div class="meta">Posted on 2001-08-29 08:45:48 by Xtreme</div>
   </div>
   <div class="post" id="post-5304">
    <div class="subject"><a href="#post-5304">The Web Browser Saga Continues...</a></div>
    <div class="body">Xtreme,<br /><br />MASM is right, it dont want code label in data sections, so it needs to be changed to:<br /><br /><pre><code><br />;        @@IUnknown segment dword<br />        vtblIUnknown label dword<br />                dd      offset QueryInterface<br />                dd      offset AddRef<br />                dd      offset Release<br />;        @@IUnknown ends<br /></code></pre><br /><br />What I'm currently are more concerned about is that the browser does not run under Windows NT 4.0 SR5. It tells me an E_FAIL when calling &quot;Navigate&quot;. I use IE5.<br /><br />Has anybody been able to run the app under this constellation? <br /><br />japheth</div>
    <div class="meta">Posted on 2001-08-29 12:23:56 by japheth</div>
   </div>
   <div class="post" id="post-5309">
    <div class="subject"><a href="#post-5309">The Web Browser Saga Continues...</a></div>
    <div class="body">Japheth,<br /><br />Try this exe on NT4.0.<br /><br />I had to zip it to upload it...</div>
    <div class="meta">Posted on 2001-08-29 13:15:01 by Xtreme</div>
   </div>
   <div class="post" id="post-5310">
    <div class="subject"><a href="#post-5310">The Web Browser Saga Continues...</a></div>
    <div class="body">haha! Okie :) I'll take a look when you post the updated file :)<br /><br />Untill then :)</div>
    <div class="meta">Posted on 2001-08-29 14:07:41 by Kenny</div>
   </div>
   <div class="post" id="post-5314">
    <div class="subject"><a href="#post-5314">The Web Browser Saga Continues...</a></div>
    <div class="body">Its above. Named &quot;browser.zip&quot;</div>
    <div class="meta">Posted on 2001-08-29 14:16:33 by Xtreme</div>
   </div>
   <div class="post" id="post-5325">
    <div class="subject"><a href="#post-5325">doesnt work :(</a></div>
    <div class="body">it doesnt work on <br /> Win98SE, IE 5.00.2614.3500<br /><br />just a white screen :(<br />or maybe i dont know how to start it.<br /><br />TBD</div>
    <div class="meta">Posted on 2001-08-29 16:03:30 by TBD</div>
   </div>
   <div class="post" id="post-5346">
    <div class="subject"><a href="#post-5346">The Web Browser Saga Continues...</a></div>
    <div class="body">the broswer worked on my win 98 SE box.<br /><br />dr phil :)</div>
    <div class="meta">Posted on 2001-08-29 19:48:02 by phil</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=812&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=812&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="812" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=812&amp;page=2">&gt;</a><a href="../?id=812&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>