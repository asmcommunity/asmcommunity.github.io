<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>visual styles with dll - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21232" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21232">visual styles with dll</a></p>
   <div class="post" id="post-160670">
    <div class="subject"><a href="#post-160670">visual styles with dll</a></div>
    <div class="body">Hi there,<br />I tried to enable XP visual styles for my DLL, which implements an IExplorer deskband (similar to google toolbar). So I searched around a while, checked googletoolbar.dll and found that I need to embed a manifest.xml as resourceid 2 inside my dll (same in google toolbar). The content is ok, and is also quite equal to my google reference dll.<br /><br />But it still does not make my controls have the new visual style :(<br /><br />Additionally I found a hint to return DOCHOSTUIFLAG_THEME in GetHostInfo in IDocHostUIHandler interface, but this does not help too.</div>
    <div class="meta">Posted on 2005-06-01 07:23:14 by beaster</div>
   </div>
   <div class="post" id="post-160672">
    <div class="subject"><a href="#post-160672">Re: visual styles with dll</a></div>
    <div class="body">Hi<br /><br />the resource id should be 1, and type 24 (RT_MANIFEST)</div>
    <div class="meta">Posted on 2005-06-01 08:19:03 by sapero</div>
   </div>
   <div class="post" id="post-160686">
    <div class="subject"><a href="#post-160686">Re: visual styles with dll</a></div>
    <div class="body">No, ID 1 is for standalone programs and 2 for dynamic libraries. Resource type is 24 alright.<br /><br />http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/userex/cookbook.asp<br /><br />Perhaps some of your controls are doing custom drawing? :?:</div>
    <div class="meta">Posted on 2005-06-01 11:40:03 by QvasiModo</div>
   </div>
   <div class="post" id="post-160688">
    <div class="subject"><a href="#post-160688">Re: visual styles with dll</a></div>
    <div class="body">i dont have custom controls, a simple combobox and a dialog with some standard controls. Now I even tried to activate the manifest manually, calling CreateAclCtx and ActivateAclCtx, but still old-school-look :-/</div>
    <div class="meta">Posted on 2005-06-01 13:07:23 by beaster</div>
   </div>
   <div class="post" id="post-160690">
    <div class="subject"><a href="#post-160690">Re: visual styles with dll</a></div>
    <div class="body">Beats me then. I&#39;ve never done deskbands. Sorry! :sad:</div>
    <div class="meta">Posted on 2005-06-01 13:32:37 by QvasiModo</div>
   </div>
  </div>
 </body>
</html>