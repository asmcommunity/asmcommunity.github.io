<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Modules - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=535" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=535">Modules</a></p>
   <div class="post" id="post-3225">
    <div class="subject"><a href="#post-3225">Modules</a></div>
    <div class="body">Hutch, during my many years of programming under DOS, I've always used a modular approach i.e. splitting my source code into different files each one dealing with a specific part of the program. This was achieved by placing a label at the start of each file and then referencing it from my main program interface, when I tried to do this in MASM32 I got assembler errors like illegal use of global or local label. Does this mean I have to have all my source code in one (huge) file<br />:confused:</div>
    <div class="meta">Posted on 2001-08-07 14:53:40 by Mel</div>
   </div>
   <div class="post" id="post-3230">
    <div class="subject"><a href="#post-3230">Examples</a></div>
    <div class="body">This was posted by Karim in another post but its an example of what your looking to do.<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/attachment.php?s=&amp;postid=2871">http://www.asmcommunity.net/board/attachment.php?s=&amp;postid=2871</a><br /><br />Good luck,<br />Betrayed</div>
    <div class="meta">Posted on 2001-08-07 16:52:55 by Betrayed</div>
   </div>
   <div class="post" id="post-3242">
    <div class="subject"><a href="#post-3242">Modules</a></div>
    <div class="body">Mel,<br /><br />There are a couple of ways of doing modular coding in MASM, the INCLUDE directive is probably the most flexible as it allows you to add complete files that retain the scope of the GLOBAL variables in the data sections. You can include parts of files or just small bits which have algorithms at any point in your code.<br /><br />The alternative approach is the seperate module which can either be linked into the main program with LINK options or alternatively, you build a set of seperate modules into a library and include the library with the INCLUDELIB directive. In the second approach, I prefer the library method as it is fully extendable to as many modules as you like and it does not need the individual files added to the link command line.<br /><br />The MASM32 lib is built this way and there is a plugin DLL in MASM32 for writing library modules. The code wizaed prostart uses the INCLUDE directive for seperate files so that the source is not concentrated in one larger file.<br /><br />Regards,<br /><br /><a href="mailto:hutch@pbq.com.au">hutch@pbq.com.au</a></div>
    <div class="meta">Posted on 2001-08-07 19:03:46 by hutch--</div>
   </div>
   <div class="post" id="post-3246">
    <div class="subject"><a href="#post-3246">Modules</a></div>
    <div class="body">Afternoon, Mel.<br /><br />Use 'EXTERNDEF' in each of your modules for each proc or definition you need to make accessible.<br /><br />Look up how to use this directive in the QEditor MASM Reference. Depending on which file you declare the proc, etc in,  it'll declare your proc as external, public, or not at all.:alright: <br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2001-08-08 01:30:26 by Scronty</div>
   </div>
   <div class="post" id="post-3247">
    <div class="subject"><a href="#post-3247">Modules</a></div>
    <div class="body">Thanks Hutch, I had a feeling it must be possible to do this but I needed someone to point me in the right direction. The library approach looks the most flexible way to go and I shall go along with that:alright:</div>
    <div class="meta">Posted on 2001-08-08 01:32:14 by Mel</div>
   </div>
   <div class="post" id="post-3248">
    <div class="subject"><a href="#post-3248">Modules</a></div>
    <div class="body">Also thanks for your tips Scronty &amp; Betrayed, most informative:alright:</div>
    <div class="meta">Posted on 2001-08-08 01:34:57 by Mel</div>
   </div>
  </div>
 </body>
</html>