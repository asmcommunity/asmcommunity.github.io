<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Small challenge - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29696" />
  <link rel="prev" href="../?id=29696&amp;page=3" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=29696">Small challenge</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=29696&amp;page=1" style="">&laquo;</a><a href="../?id=29696&amp;page=3" style="">&lt;</a><input type="hidden" name="id" value="29696" /><input type="number" name="page" min="1" max="4" step="1" value="4" onchange="this.form.submit();" /></form>   <div class="post" id="post-209810">
    <div class="subject"><a href="#post-209810">Re: Small challenge</a></div>
    <div class="body">Heh, fun to see my Yodel stuff being used again, last time I touched it was... April 2003, I think :)</div>
    <div class="meta">Posted on 2009-12-03 03:40:49 by f0dder</div>
   </div>
   <div class="post" id="post-209811">
    <div class="subject"><a href="#post-209811">Re: Small challenge</a></div>
    <div class="body">Stunned at this reaction to such a simple problem!<br />Apparently, we&#039;re not being challenged enough.<br /></div>
    <div class="meta">Posted on 2009-12-03 04:47:40 by Homer</div>
   </div>
   <div class="post" id="post-209813">
    <div class="subject"><a href="#post-209813">Re: Small challenge</a></div>
    <div class="body">Well, I haven&#039;t done any actual asm in ages, so it was good fun.<br />The thing with this problem is that it *appears* simple, but current CPUs really don&#039;t have any adequate instructions for handling the problem. Even with SSSE3 you don&#039;t get *exactly* what you want.&nbsp; You can shift the individual bytes by multiplying, but that only works for left shifts... so you need to correct the final result with a right shift (unless ofcourse you design the rest of your logic to also work with values that are shifted up by 3 bits, so it won&#039;t matter).<br />Also you still need two steps to get from bytes to dwords. You need to do an intermediate word step first.</div>
    <div class="meta">Posted on 2009-12-03 05:53:10 by Scali</div>
   </div>
   <div class="post" id="post-214859">
    <div class="subject"><a href="#post-214859">Re: Small challenge</a></div>
    <div class="body">Well, my brother had problems with his computer, and decided to replace his CPU, motherboard and memory.<br />His old stuff wasn&#039;t really that old, it was a Core i7 860 with 8 GB of memory.<br />I got it cheap, and it was a nice upgrade from my trusty old Core2 Duo.<br />So far I haven&#039;t had any problems with it... The memory was a tad finnicky (it&#039;s high-performance memory from Corsair, with heatsinks on and all that, requires overvolting to run at the advertised speeds, which are also outside the spec of the Core i7&#039;s memory controller), but I think I have found stable settings.<br /><br />Anyway, I wanted to see if the turbo was working correctly, and find out just how fast it is... so I ran this yodel stuff on it:<br /><pre><code>test21-ANSI C LUT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000202 ticks (effective 5.672 clk/iteration)<br />test09-r22 LUT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000203 ticks (effective 5.700 clk/iteration)<br />test18-r22 mega-LUT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000203 ticks (effective 5.700 clk/iteration)<br />test19-lingo12&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000203 ticks (effective 5.700 clk/iteration)<br />test20-lingo12 SSSE3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000203 ticks (effective 5.700 clk/iteration)<br />test17-Scali SSSE3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000219 ticks (effective 6.150 clk/iteration)<br />test02-Scali2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000234 ticks (effective 6.571 clk/iteration)<br />test07-ANSI C 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000234 ticks (effective 6.571 clk/iteration)<br />test08-ANSI C 2 handoptimized ...000234 ticks (effective 6.571 clk/iteration)<br />test15-Scali SSE2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000234 ticks (effective 6.571 clk/iteration)<br />test10-drizz&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000249 ticks (effective 6.992 clk/iteration)<br />test03-Scali3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000250 ticks (effective 7.020 clk/iteration)<br />test11-sysfce2-2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000265 ticks (effective 7.441 clk/iteration)<br />test06-ANSI C 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000266 ticks (effective 7.469 clk/iteration)<br />test01-Scali1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000281 ticks (effective 7.890 clk/iteration)<br />test05-Ultrano&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000312 ticks (effective 8.761 clk/iteration)<br />test16-Scali MMX+SSSE3&nbsp; &nbsp; &nbsp; &nbsp; ...000343 ticks (effective 9.631 clk/iteration)<br />test14-Scali MMX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000374 ticks (effective 10.502 clk/iteration)<br />test13-ti_mo_n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000436 ticks (effective 12.243 clk/iteration)<br />test04-sysfce2-1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000437 ticks (effective 12.271 clk/iteration)<br />test12-sysfce2-3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000889 ticks (effective 24.963 clk/iteration)</code></pre><br /><br />One problem though: the turbo means it is cheating!<br />Yodel requests the clockspeed of the CPU, which is reported as 2.8 GHz. This clockspeed is fixed though... Intel has made RDTSC work on a fixed frequency, so neither downclocking (power saving modes) nor overclocking (turbo modes) will be reflected in RDTSC.<br />I have however checked with CPU-Z on the side, since that reports the actual clockspeed, and then you see the turbo kicking in, going up to 3.4 GHz.<br />So that means yodel&#039;s cycle count estimates are off... and it&#039;s going to be quite difficult to get accurate readings when the clockspeed is variable. I suppose the best way is to disable both speedstep and turbo, so the CPU is fixed at its stock speed of 2.8 GHz.<br />Nevertheless, the absolute times in ticks seem pretty nice. 202 ticks for the fastest run, where my Core2 Duo at 3 GHz did 234 ticks.<br />It also seems that the LUT-approach took a bit more distance from the others, so I guess caching is more efficient on this CPU.<br /><br />Edit: and here are some results of a friend&#039;s AMD quadcore:<br /><pre><code>test19-lingo12&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000327 ticks (effective 7.871 clk/iteration)<br />test04-sysfce2-1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000359 ticks (effective 8.641 clk/iteration)<br />test14-Scali MMX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000344 ticks (effective 8.280 clk/iteration)<br />test10-drizz&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000359 ticks (effective 8.641 clk/iteration)<br />test01-Scali1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000374 ticks (effective -1.#IO clk/iteration)<br />test07-ANSI C 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000374 ticks (effective 9.002 clk/iteration)<br />test15-Scali SSE2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000375 ticks (effective 9.026 clk/iteration)<br />test02-Scali2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000390 ticks (effective 9.387 clk/iteration)<br />test03-Scali3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000405 ticks (effective 9.748 clk/iteration)<br />test06-ANSI C 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000405 ticks (effective 9.748 clk/iteration)<br />test08-ANSI C 2 handoptimized ...000406 ticks (effective 9.772 clk/iteration)<br />test05-Ultrano&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000437 ticks (effective 10.519 clk/iteration)<br />test13-ti_mo_n&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000437 ticks (effective 10.519 clk/iteration)<br />test09-r22 LUT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000531 ticks (effective 12.781 clk/iteration)<br />test11-sysfce2-2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000546 ticks (effective 13.142 clk/iteration)<br />test18-r22 mega-LUT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ...000546 ticks (effective 13.142 clk/iteration)<br />test12-sysfce2-3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ...000592 ticks (effective 14.249 clk/iteration)</code></pre></div>
    <div class="meta">Posted on 2011-08-14 15:27:31 by Scali</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=29696&amp;page=1" style="">&laquo;</a><a href="../?id=29696&amp;page=3" style="">&lt;</a><input type="hidden" name="id" value="29696" /><input type="number" name="page" min="1" max="4" step="1" value="4" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>