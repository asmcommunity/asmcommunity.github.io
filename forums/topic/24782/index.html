<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Easy Code tutorials - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24782" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24782">Easy Code tutorials</a></p>
   <div class="post" id="post-181070">
    <div class="subject"><a href="#post-181070">Easy Code tutorials</a></div>
    <div class="body"><span style="font-size:10pt><strong>In this section there will be Easy Code small and dedicated tutorials, specially oriented to visual projects, for you to learn easily how to program applications with this IDE.</strong></span><br /><br />Enjoy Easy Code!<br /><br />Ramon<br /></div>
    <div class="meta">Posted on 2006-05-26 13:39:27 by rsala</div>
   </div>
   <div class="post" id="post-181071">
    <div class="subject"><a href="#post-181071">How to add child controls</a></div>
    <div class="body"><span style="font-size:12pt><strong>Adding child controls</strong></span><br /><br />The attached help file shows how to add child controls to a window and how to receive control messages in its own window procedure. Anyway, in most cases the window procedure for a child control is not needed and it&#39;s enough processing the messages received by its owner window through the <strong>WM_COMMAND</strong> and/or <strong>WM_NOTIFY</strong> messages.<br /><br />Enjoy it!<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1649" target="_blank">ADDCTRLS.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-26 13:41:24 by rsala</div>
   </div>
   <div class="post" id="post-181072">
    <div class="subject"><a href="#post-181072">How to get the handle to child controls</a></div>
    <div class="body"><span style="font-size:12pt><strong>Getting child controls handle</strong></span><br /><br />The attached help file shows how to get the handle for a child control using its control ID. The handle for a control is needed in many operations with child controls.<br /><br />Enjoy it!<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1650" target="_blank">CTRLIDS.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-26 13:43:00 by rsala</div>
   </div>
   <div class="post" id="post-181073">
    <div class="subject"><a href="#post-181073">Advanced message loop control</a></div>
    <div class="body"><span style="font-size:12pt><strong>Controlling application message loop</strong></span><br /><br />The attached help file shows how to get full control over the application message loop. In most cases it is quite enough to process messages in their corresponding procedures. Anyway, you can have more control over application messages if you need.<br /><br />Enjoy it!<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1651" target="_blank">MESSAGES.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-26 13:44:23 by rsala</div>
   </div>
   <div class="post" id="post-181074">
    <div class="subject"><a href="#post-181074">MDI applications</a></div>
    <div class="body"><span style="font-size:12pt><strong>MDI applications</strong></span><br /><br />The attached file shows how MDI windows work. The Easy Code application includes an MDI application as an example (<strong>Examples</strong> folder in Easy Code installation directories).<br /><br />Enjoy it!<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1652" target="_blank">MDIApps.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-26 13:46:01 by rsala</div>
   </div>
   <div class="post" id="post-181075">
    <div class="subject"><a href="#post-181075">How to create windows at run time</a></div>
    <div class="body"><span style="font-size:12pt><strong>Creating windows at run time</strong></span><br /><br />The <strong>Create.zip</strong> attached help file shows how to create a window at run time. In the <strong>SDIApp.zip</strong> attached Easy Code example project, you can see how to do it.<br /><br />Enjoy it!<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1653" target="_blank">Create.zip</a></li>
      <li><a href="../../attachments/?id=1654" target="_blank">SDIApp.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-26 13:47:17 by rsala</div>
   </div>
   <div class="post" id="post-181076">
    <div class="subject"><a href="#post-181076">How to use object procedures</a></div>
    <div class="body"><span style="font-size:12pt><strong>Object procedures</strong></span><br /><br />The <strong>ObjProcs.zip</strong> attached help file shows how to use object procedures properly and how to write code in them.<br /><br />Enjoy it!<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1655" target="_blank">ObjProcs.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-26 13:49:16 by rsala</div>
   </div>
   <div class="post" id="post-181077">
    <div class="subject"><a href="#post-181077">Modal windows</a></div>
    <div class="body"><span style="font-size:12pt><strong>Modal windows</strong></span><br /><br />The <strong>ModalWin.zip</strong> attached help file shows how to use <strong>Window</strong> and/or <strong>DialogBox</strong> objects to create modal windows in visual projects.<br /><br />Enjoy it!<br /><br /><br /><strong>REMARKS</strong>: You should never hide a modal window.<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1656" target="_blank">ModalWin.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-26 13:51:06 by rsala</div>
   </div>
   <div class="post" id="post-181078">
    <div class="subject"><a href="#post-181078">How to use the TabStrip control</a></div>
    <div class="body"><span style="font-size:12pt><strong>TabStrip common control</strong></span><br /><br />Once unzipped the attached <strong>TabStrip.zip</strong> file, you will have a folder named <strong>TabStrip</strong> with a whole project and a help file inside. You can see how easy it is to program an application using a Tab control. Have a look at the project and read the help file.<br /><br /><br /><strong>REMARKS: The TabStrip project needs Easy Code version 1.00.0012 or later.</strong><br /><br />Enjoy it!<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1657" target="_blank">TabStrip.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-26 13:52:52 by rsala</div>
   </div>
   <div class="post" id="post-181079">
    <div class="subject"><a href="#post-181079">How to put an icon in the task bar</a></div>
    <div class="body"><span style="font-size:12pt><strong>Put an icon in the task bar</strong></span><br /><br />Once unzipped the attached <strong>Memory.zip</strong> file, you will have a folder named <strong>Memory</strong> with a whole project that tells you the total and available System memory. You can see how easy is to program an application having an icon in the taskbar.<br /><br /><br />Enjoy it!<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1658" target="_blank">Memory.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-26 13:54:32 by rsala</div>
   </div>
   <div class="post" id="post-181080">
    <div class="subject"><a href="#post-181080">Raw data and files</a></div>
    <div class="body"><span style="font-size:12pt><strong>Raw data and files</strong></span><br /><br />The Easy Code resource editor has been made to allow the user to create all kind of resources and, at the same time, make it as easy as possible, but being limited for the syntax of the resource compiler (RC.EXE). As a result, you can add accelerators, menus, images (icon, cursor or bitmap), strings, a version resource and Raw Data.<br /><br />A raw data resource permit the inclusion of binary data directly in the executable file and it specifies one or more integers or strings of characters. Integers can be specified in decimal, octal or hexadecimal format. RC compiler does not automatically append a terminating null character to a string. The string is a sequence of the specified ANSI (byte) characters unless explicitly qualified as a wide-character string with the <strong>L</strong> prefix (Unicode).<br /><br />The block of data begins on a <strong>DWord</strong> boundary and RC performs no padding or alignment of data within the raw-data block. It is the programmer&#39;s responsibility to ensure the proper alignment of data within the block.<br /><br />The following are some examples of raw data:<br /><br /><strong>10,20,30,40</strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Four integer (16-bit) values.<br /><strong>&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;</strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Four byte (8-bit) values.<br /><strong>&quot;Readme.txt\0&quot;</strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Double-quoted text to specify it is a string (null-terminated).<br /><br /><strong>L&quot;Readme.txt\0&quot;</strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Unicode null-terminated string (<strong>L</strong> means Unicode, otherwise it is ANSI)<br /><strong>&quot;\r&quot;</strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; A control character (8-bit) correspondig to ASCII 13 (&lt;<strong>C</strong>arriage <strong>R</strong>eturn&gt;).<br /><strong>0x40</strong>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  A Hex integer (16-bit) value corresponding to 64 decimal.<br /><br /><br />This raw data has to be typed exactly the same in the Easy Code Raw Data resources window so that RC does not generate any error at compile time. In fact, raw data resources are usually used for binary data or, eventually, for ANSI strings, as strings defined in a <strong>String table</strong> are always Unicode.<br /><br />In some cases, it would be interesting to add a whole file as a resource. As the RC compiler has no way to do that, Easy Code has a user-defined resource to accomplish this task. User-defined resources must have a value greater than 255, so Easy Code has the <strong>RT_FILEDATA</strong> reserved word (value 256). In the resource editor, adding a file is done in the Raw Data resources window. So, how does Easy Code know if it is raw data or a file name? It just looks in the <strong>Res</strong> folder for a file having the typed name. If it exists, an <strong>RT_FILEDATA</strong> resource will be created. To find it at run time, you will have to specify <strong>RT_FILEDATA</strong> in the <strong>&#39;ResourceType&#39;</strong> parameter of the <strong>FindResource</strong> function. On the other hand, if there is no file in <strong>Res</strong> folder having the typed name, a normal <strong>RCDATA</strong> resource will be created and it will be found as <strong>RCDATA</strong> type.<br /><br />Note that a file name could be treated as normal raw data if the file it specifies is not found in <strong>Res</strong> folder, but if it was entered without double quotes, the RC compiler will generate an error. On the other hand, if the file name is double-quoted, it will be treated as a Raw data string (<strong>RCDATA</strong> type).<br /><br />Ramon<br /></div>
    <div class="meta">Posted on 2006-05-26 13:56:14 by rsala</div>
   </div>
   <div class="post" id="post-181081">
    <div class="subject"><a href="#post-181081">Checking previous instances</a></div>
    <div class="body"><span style="font-size:12pt><strong>Checking previous instances</strong></span><br /><br />In some applications is not possible to have more than one instance running at a time (i.e the ECPlayer or MIDIPlay examples included in <strong>Easy Code\Examples</strong>). When that is the case, or for any reason you want just one instance to be running, you must check it during the main window creation. In Classic projects you have to write all the code to find out whether there is already another instance running and, if there is one, returning -1 in order not to continue the creation of the window. In Visual projects that is really simple with the <strong>App</strong> object. This interesting object may be referenced in any part of the code and has several properties (see the Easy Code help). One of them, <strong>Previous</strong>, always returns the handle to the window of a previous instance (if any). You just have to check the <strong>App.Previous</strong> and if it is <strong>NULL</strong> no other instance is running, so you can go ahead. Otherwise, the returned value will be the handle to the main window of the already running instance. The best place for checking previous instances is in the <strong>WM_CREATE</strong> message. For example:<br /><br /><span style="font-family:Courier New"><span style="font-size:10pt>	.If uMsg == WM_CREATE<br /> 		.If App.Previous != NULL<br />			Return (-1)	<br />		.EndIf<br />		<br />	.ElseIf uMsg == WM_CLOSE<br />		Invoke IsModal, hWnd<br />		.If Eax<br />			Invoke EndModal, hWnd, IDCANCEL<br />			Return TRUE<br />		.EndIf<br />	.Endif<br /></span></span><br /><br /><br />On the other hand, if you want to show the instance which is running and bring it to top, write the following code:<br /><br /><br /><span style="font-family:Courier New"><span style="font-size:10pt>	.If uMsg == WM_CREATE<br /> 		.If App.Previous != NULL<br />			Invoke ShowWindow, App.Previous, SW_SHOWNORMAL<br />			Invoke SetForegroundWindow, App.Previous<br />			Return (-1)	<br />		.EndIf<br />		<br />	.ElseIf uMsg == WM_CLOSE<br />		Invoke IsModal, hWnd<br />		.If Eax<br />			Invoke EndModal, hWnd, IDCANCEL<br />			Return TRUE<br />		.EndIf<br />	.Endif<br /></span></span><br /><br /><br />If another instance is running (<strong>App.Previous</strong> != <strong>NULL</strong>) and you do not want it to run, then you should return <strong>-1</strong>. No other way of exitting the applicaction is recommended as Easy Code creates brushes, fonts and other resources for Windows and Controls in Visual projects. Returning <strong>-1</strong> will destroy the window before being shown and will release all associated resources. You can have a look at the <strong>MIDIPlay</strong> example (available from Easy Code version 1.00.0017 or later) which uses the <strong>App</strong> object to avoid more than one instance to be running at a time.<br /><br />Enjoy it!<br /></div>
    <div class="meta">Posted on 2006-05-26 14:00:32 by rsala</div>
   </div>
   <div class="post" id="post-181082">
    <div class="subject"><a href="#post-181082">The App object</a></div>
    <div class="body"><span style="font-size:12pt><strong>The App object</strong></span><br /><br /><br />The <strong>App</strong> object is only available in visual projects and it stores useful information about the running application. Using this object avoids having to declare global variables to access the required information anywhere in the project. It has the following members:<br /><br /><br /><strong>Accel</strong> - HACCEL type containing the handle to the accelerator table, if any, or <strong>NULL</strong>.<br /><br /><strong>CommandLine</strong> - LPSTR type pointing to the effective addres of the command line (excluding the program name and path).<br /><br /><strong>FileName</strong> - LPSTR type pointing to the effective addres of the executable file name.<br /><br /><strong>Header</strong> - LPSTR type pointing to the effective addres of the header (the text in <strong><u>H</u>eader</strong> field of the Project properties).<br /><br /><strong>Instance</strong> - HINSTANCE type containing the handle to the instance.<br /><br /><strong>Main</strong> - HWND type containig the handle to the main window (start up window).<br /><br /><strong>Major</strong> - LONG type containig the major version.<br /><br /><strong>Minor</strong> - LONG type containig the minor version.<br /><br /><strong>Path</strong> - LPSTR type pointing to the effective addres of the path for the application.<br /><br /><strong>Previous</strong> - HWND type containing the handle to the main window of a previous instance, if any, or <strong>NULL</strong> (see previous topic).<br /><br /><strong>Revision</strong> - LONG type containig the revision of the version.<br /><br /><br />The <strong>App</strong> object is used like a structure and may be invoked anywhere in the project. Here are some examples:<br /><br /><strong>Invoke GetWindowText, App.Main, lpszBuf, MAX_PATH</strong><br /><strong>Invoke LoadString, App.Instance, IDS_STRING, lpszBuf, MAX_PATH</strong><br /><strong>Invoke SetWindowText, App.Main, App.FileName</strong><br /><strong>Invoke SetCurrentDirectory, App.Path</strong><br /><br /><br />So, using the <strong>App</strong> object saves time and makes accessing application&#39;s data easier.<br /><br />Ramon<br /></div>
    <div class="meta">Posted on 2006-05-26 14:05:50 by rsala</div>
   </div>
   <div class="post" id="post-181083">
    <div class="subject"><a href="#post-181083">Static or dynamic linking?</a></div>
    <div class="body"><span style="font-size:12pt><strong>Static and dynamic linking</strong></span><br /><br />Visual projects need to link the Easy Code visual library as it manages the appearance and behavior of all existing objects (windows and controls). You can link it statically (default option) and the size of the final executable file will be larger but it will have no dependency, or you can link it dynamically and the size of your application will be smaller, but then you will have to join the <strong>ECDll100.dll</strong> (located in the <strong>Lib\Dynamic</strong> subdirectory of the Easy Code application path) when distributing your application. The only advantage of dynamic linking (apart from the smaller size of the executable file) is that you just need a copy of the <strong>ECDll100.dll</strong> in the System directory (usually <strong>\WINNT\SYSTEM32</strong> for Windows NT/XP/2K and <strong>\WINDOWS\SYSTEM</strong> for Windows 95/98), even though you have a lot of Easy Code made applications. Also, the <strong>ECDll100.dll</strong> might be in the application&#39;s directory, but then you should have to place a copy in each Easy Code application&#39;s folder (if the project was built in Debug mode, then the <strong>ECDll10d.dll</strong> will be needed instead). So, take into account the following:<br /><br />- Statically linked applications do not need any other Easy Code file, as the executable file already includes the visual library.<br /><br />- If your application was dynamically linked, you should join the <strong>ECDll100.dll</strong> file with the executable. If you distribute your application with an installer program, it should place the <strong>ECDll100.dll</strong> file in the System directory.<br /><br />- If the executable was dynamically linked, but built in Debug mode, then the <strong>ECDll10d.dll</strong> file has to be joined instead. Take that into account, even though it is not very usual distributing applications in Debug mode.<br /><br />- The best place for the run-time <strong>ECDll100.dll</strong> or <strong>ECDll10d.dll</strong> files is the System directory. In that way, only a copy of them is needed even though there are many Easy Code applications installed. If not, you should place a copy of <strong>ECDll100.dll</strong> (or <strong>ECDll10d.dll</strong>) in each Easy Code application&#39;s folder.<br /><br />- If you always distribute your dynamically linked applications in Release mode (which is the usual way), you just need to join the <strong>ECDll100.dll</strong> file (<strong>ECDll10d.dll</strong> is not needed at all). On the other hand, if the application was built in Debug mode, then the <strong>ECDll10d.dll</strong> file will be needed instead, but Debug building is just for developing the application in order to find and fix bugs. Once it works fine, the program is built in Release mode for being distributed.<br /><br /><br />Llinking the Easy Code visual library statically gives the advantage of having an executable file which has no dependency, so no other Easy Code file has to be distributed with it, even though the .exe file is a little larger. That is not usually a problem as assembly made applications are much smaller than any other programming language, but anyway you decide.<br /><br /><br />Enjoy it!<br /><br />Ramon<br /></div>
    <div class="meta">Posted on 2006-05-26 14:07:17 by rsala</div>
   </div>
   <div class="post" id="post-181084">
    <div class="subject"><a href="#post-181084">Menus</a></div>
    <div class="body"><span style="font-size:12pt><strong>Menus</strong></span><br /><br /><br />There are two ways of building a menu in Easy Code depending on the type of project, visual or classic. The first way is creating a menu resource in the <strong>Resource Editor</strong> and then setting it to a window using the <strong>SetMenu</strong> API function, usually in the <strong>WM_CREATE</strong> message. The second way (just for visual projects) sets the menu automatically to the window for which the <strong>Menu Editor</strong> was opened and allows you to assign the accelerator keys at hte same time.<br /><br /><br /><strong>First method (the classic way)<br />==================</strong><br /><br />Open the <strong>Menu Editor</strong> dialog box by clicking <strong><u>P</u>roject</strong>--&gt;<strong>Add <u>R</u>esource</strong>--&gt;<strong><u>M</u>enu</strong>, design the menu you want. See the Easy Code help (<strong>The Menu Editor</strong> topic) to learn how the menu Editor works. Then, in your code, load the menu resource and set it to a window so that it can be used.<br /><br /><br /><br /><br /><strong>Second method (just for visual projects)<br />========================</strong><br /><br />In visual projects you can design and set a menu in the same way (first method) but, besides, you can make a menu to be automatically set to a window. To do so, open the <strong>Menu Editor</strong> but using the <strong><u>T</u>ools</strong>--&gt; <strong><u>M</u>enu Editor</strong> menu option (or <strong>&lt;Ctrl+M&gt;</strong>), while the window which you want the menu to be set to is the active window. Then, you will be able to design a menu and add accelerator keys which will be automatically set to the active window (that mentioned in the Menu Editor&#39;s caption). After that, you can test the window (<strong><u>B</u>uild</strong>--&gt;<strong><u>T</u>est &lt;Window name&gt;</strong> or <strong>&lt;Shift+F5&gt;</strong>) to see how the menu looks like. The Easy Code visual library takes care of the menu and its accelerator keys (if any), so you do not have to do anything else.<br /><br />Two projects using both methods are attached. <strong>Project1.zip</strong> uses the first method, where a menu resource is created in the <strong>Resource Editor</strong> an then it is loaded and set to Window1 in the <strong>WM_CREATE</strong> message. <strong>Project2.zip</strong> uses the second method, and it can be seen by testing Window1.<br /><br /><br /><br />Enjoy it!<br /><br />Ramon<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1659" target="_blank">Project1.zip</a></li>
      <li><a href="../../attachments/?id=1660" target="_blank">Project2.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-26 14:11:15 by rsala</div>
   </div>
  </div>
 </body>
</html>