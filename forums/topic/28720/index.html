<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Paths in Windows Vista - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=28720" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=28720">Paths in Windows Vista</a></p>
   <div class="post" id="post-202887">
    <div class="subject"><a href="#post-202887">Paths in Windows Vista</a></div>
    <div class="body">I am just beginning to learn assembly language and would like to know if it is necessary to setup the paths in Vista like i would have had to do in Windows 95/98SE? By path I mean the locations of tams\bin... \inc.. ect.. I know where and how to do this in vista but am curious if it is necessary.. I will be using RADASM also if that helps thanks in advance. -JBP</div>
    <div class="meta">Posted on 2007-09-12 18:54:50 by JBP</div>
   </div>
   <div class="post" id="post-202888">
    <div class="subject"><a href="#post-202888">Re: Paths in Windows Vista</a></div>
    <div class="body">The need for, and use of, relative and environmental paths will most likely never change as they are the only sure way to specify *where* something is without too much complexity.<br /><br />Personally, I still use simple batch files that have direct path declarations on Vista.<br /><br />If you are talking about path configuration within something like RadASM, unless the paths are apart of the &quot;PATH&quot; environment variable, you need to properly set those paths up.</div>
    <div class="meta">Posted on 2007-09-12 19:01:59 by SpooK</div>
   </div>
   <div class="post" id="post-202889">
    <div class="subject"><a href="#post-202889">Re: Paths in Windows Vista</a></div>
    <div class="body">Thanks a lot. could you possibly send me the batch file for vista that you mentioned.. I would modify it for my system using TASM</div>
    <div class="meta">Posted on 2007-09-12 19:10:07 by JBP</div>
   </div>
   <div class="post" id="post-202903">
    <div class="subject"><a href="#post-202903">Re: Paths in Windows Vista</a></div>
    <div class="body">Hmm... I just use standard batch files.<br /><br />Here is a condensed example that assumes NASM is in C:\nasm32\bin... apply the same concept for TASM or whatever...<br /><br /><pre><code><br />@ECHO OFF<br />C:\nasm32\bin\nasm.exe -o test.obj test.asm<br /></code></pre><br /><br />If you have spaces in your path, quote the string like so...<br /><br /><pre><code><br />@ECHO OFF<br />&quot;C:\Program Files\nasm32\bin\nasm.exe&quot; -o test.obj test.asm<br /></code></pre><br /><br />Use Google to find more info, as BATCH files are a thoroughly documented subject and you can find some great guides on the net.<br /><br />HtH.</div>
    <div class="meta">Posted on 2007-09-13 13:25:45 by SpooK</div>
   </div>
   <div class="post" id="post-202907">
    <div class="subject"><a href="#post-202907">Re: Paths in Windows Vista</a></div>
    <div class="body">You could always do what I do, although it&#039;s not very popular and most people tend to gripe about it because it doesn&#039;t look very elagant in IDE&#039;s.. but I use notepad and batch files for development which lead me to using batch sources to save time, heres an example...<br /><br /><pre><code>;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />; @echo off<br />; rem Project Information<br />; set project=oop_demo<br />; set version=0.1<br />; rem Path Information<br />; set BIN=\NASM32\Bin<br />; set LIB=\NASM32\Lib\Win32<br />; rem Development Tools<br />; set AS=nasm.exe<br />; set LD=polink.exe<br />; set RC=porc.exe<br />; rem Build Settings<br />; set subsystem=windows<br />; set libraries=kernel32.lib user32.lib<br />; set debug_mode=0<br />; set view_log=1<br />; rem Build Application<br />; goto assemble_source<br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br /><br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />;<br />; Copyright (c) 2007 Bryant Keller<br />; All rights reserved.<br />;<br />; Redistribution and use in source and binary forms, with or without<br />; modification, are permitted provided that the following conditions<br />; are met:<br />; 1. Redistributions of source code must retain the above copyright<br />;&nbsp; &nbsp; notice, this list of conditions and the following disclaimer.<br />; 2. Redistributions in binary form must reproduce the above copyright<br />;&nbsp; &nbsp; notice, this list of conditions and the following disclaimer in the<br />;&nbsp; &nbsp; documentation and/or other materials provided with the distribution.<br />;<br />; THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS&#039;&#039; AND<br />; ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE<br />; IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE<br />; ARE DISCLAIMED.&nbsp; IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE<br />; FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL<br />; DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS<br />; OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)<br />; HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT<br />; LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY<br />; OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF<br />; SUCH DAMAGE.<br />;<br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />%INCLUDE &#039;\Nasm32\Inc\Win32\Windows.INC&#039;<br />%INCLUDE &#039;\Nasm32\Inc\Win32\Kernel32.INC&#039;<br />%INCLUDE &#039;\Nasm32\Inc\Win32\User32.INC&#039;<br />%INCLUDE &#039;\Nasm32\Inc\Nasm32.INC&#039;<br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />ENTRY Start<br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />STRUC CTEST<br />	._virt_func_table	RESD	1<br />	._virt_data_table	RESD	1<br />	.myDWord		RESD	1<br />	.myWord			RESW	1<br />	.myByte			RESB	1<br />	.myPadding		RESB	1<br />ENDSTRUC<br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />%DEFINE CTEST_PTR_FUNC_TABLE	CTEST_VT<br />%DEFINE CTEST_PTR_DATA_TABLE	CTEST_DT<br /><br />%DEFINE _index_MethodA	0<br />%DEFINE _index_MethodB	1<br />%DEFINE _index_MethodC	2<br /><br />%DEFINE _index_vDataA	0<br />%DEFINE _index_vDataB	1<br />%DEFINE _index_vDataC	2<br /><br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />.DATA<br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />CTEST_vDataA	DB	&quot;Hello, World!&quot;, 0<br />CTEST_vDataB	DW	256<br />CTEST_vDataC	TIMES	1024 DD 44434241h<br />		DD	0<br /><br />CTEST_VT	DD	CTEST_MethodA, CTEST_MethodB, CTEST_MethodC<br />CTEST_DT	DD	CTEST_vDataA, CTEST_vDataB, CTEST_vDataC<br /><br />szTitle		DB	&quot;Raw OOP Demo&quot;, 0<br />szMessage	DB	&quot;This is global data copied into our virtual member!&quot;, 13, 10<br />		DB	&quot;Interesting stuff isn&#039;t it!&quot;, 0<br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />.CODE<br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />CTEST_INITIALIZATION:<br />	%IFDEF CTEST_PTR_FUNC_TABLE<br />		; Setup Virtual Function Table<br />		mov	DWORD , CTEST_PTR_FUNC_TABLE<br />	%ENDIF<br /><br />	%IFDEF CTEST_PTR_DATA_TABLE<br />		; Setup Virtual Data Table<br />		mov	DWORD , CTEST_PTR_DATA_TABLE<br />	%ENDIF<br /><br />	mov	EAX, ECX<br />	ret<br /><br />PROC CTEST_MethodA<br />	push	ECX<br />	mov	EAX, <br />	push	DWORD MB_OK<br />	push	DWORD <br />	push	DWORD <br />	push	DWORD NULL<br />	INVOKE	MessageBoxA<br />	pop	ECX<br />	mov	EAX, ECX<br />	ret<br />ENDPROC<br /><br />PROC CTEST_MethodB<br />.arg1	ARGD<br />	push	ECX<br />	mov	EAX, <br />	mov	WORD , 1024<br />	xor	EBX, EBX<br />	mov	BX, WORD <br />	push	EBX<br />	push	DWORD <br />	INVOKE	RtlZeroMemory<br />	pop	ECX<br />	mov	EAX, ECX<br />	ret<br />ENDPROC<br /><br />PROC CTEST_MethodC <br />.arg1	ARGD<br />.arg2	ARGD<br />LOCALS<br />	LOCAL	_vdt, DWORD<br />ENDLOCALS<br />	push	ECX<br />		mov	EAX, <br />		mov	VAR(_vdt), EAX<br />		push	DWORD ARGV(.arg1)<br />		push	DWORD <br />		INVOKE	lstrcpyA<br />		mov	EAX, VAR(_vdt)<br />		push	DWORD MB_OK<br />		push	DWORD ARGV(.arg2)<br />		push	DWORD <br />		push	DWORD NULL<br />		INVOKE	MessageBoxA<br />	pop	ECX<br />	mov	EAX, ECX<br />	ret<br />ENDPROC<br /><br />PROC Start<br />LOCALS<br />	LOCAL	pObj, CTEST<br />ENDLOCALS<br />	lea	ECX, VAR(pObj)<br />	CALL	CTEST_INITIALIZATION<br />	mov	EAX, <br />	call	DWORD <br />	push	1024<br />	mov	EAX, .CTEST._virt_func_table<br />	call	DWORD <br />	push	OFFSET szTitle<br />	push	OFFSET szMessage<br />	mov	EAX, .CTEST._virt_func_table<br />	call	DWORD <br />	xor	EAX, EAX<br />	push	EAX<br />	INVOKE	ExitProcess<br />	ret<br />ENDPROC<br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::<br />; :assemble_source<br />; &quot;%BIN%\%AS%&quot; -f win32 &quot;%project%.bat&quot; -o &quot;%project%.obj&quot; &gt;&gt; &quot;%project%.log&quot;<br />;<br />; :compile_resource<br />; if not exist &quot;%project%.rc&quot; set RESFILE=<br />; if not exist &quot;%project%.rc&quot; goto link_objects<br />; set RESFILE=&quot;%project%.res&quot;<br />; echo&nbsp; Compiling: %project%.rc &gt;&gt; &quot;%project%.log&quot;<br />; &quot;%BIN%\%RC%&quot; /v /r &quot;%project%.rc&quot; &gt;&gt; &quot;%project%.log&quot;<br />;<br />; :link_objects<br />; if %debug_mode%==0 set LDDEBUG=/RELEASE /ENTRY:main /LIBPATH:&quot;%LIB%&quot;<br />; if %debug_mode%==1 set LDDEBUG=/DEBUG /DEBUGTYPE:CV /ENTRY:main /LIBPATH:&quot;%LIB%&quot; /INCREMENTAL:NO<br />; echo&nbsp; Linking: %project%.obj &gt;&gt; &quot;%project%.log&quot;<br />; &quot;%BIN%\%LD%&quot; /nologo /SUBSYSTEM:%subsystem% /VERSION:%version% %LDDEBUG% %libraries% &quot;%project%.obj&quot; %RESFILE% &gt;&gt; &quot;%project%.log&quot;<br />;<br />; :cleanup_directory<br />; if exist &quot;%project%.obj&quot; del &quot;%project%.obj&quot;<br />; if exist &quot;%project%.res&quot; del &quot;%project%.res&quot;<br />; if %view_log%==1 type %project%.log<br />; if exist &quot;%project%.log&quot; del &quot;%project%.log&quot;<br />; if %view_log%==1 pause<br />;:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::</code></pre><br /><br />Assemblers ignore anything after comments while the command line will jump over your code due to the &quot;goto&quot; statement; the command line doesn&#039;t bother with the semi-colons. Honestly I do this out of sure laziness, I can&#039;t be arsed keeping up to date with the latest IDE&#039;s features and batch scripting doesn&#039;t change much, if any. I can build my source by double clicking the file and edit it by right clicking and selecting &quot;Edit&quot; from the dropdown menu. I can change from debug to release by modifing switches, or even change assemblers by changing a few settings. I can&#039;t remember when I started doing this.. probably around 2004 when I finished toying around with Dev-IDE&#039;s source-level debugger and threw it into oblivion with a bunch of other semi-unfinished code I have. :lol:<br /><br />I like it, it works great, but if you decide to pass your code on to other people, you might want to strip the batch code out into a separate file otherwise people <u>will</u> complain about you writing &quot;obfuscated&quot; code. I get that all the time, that&#039;s why if you look on my projects page I always clean up my source to &quot;pretty&quot; MASM code.<br /><br />Regards,<br />Bryant Keller<br /><br /><strong>EDIT:</strong> Btw, in this NASM version there is no INC path set because NASM always has issues with searching for includes so I just do it manually in the source. In my MASM/PoASM/GoASM sources you would see an extra line between &#039;set BIN&#039; and &#039;set LIB&#039; for &#039;set INC&#039; to set the base includes directory.</div>
    <div class="meta">Posted on 2007-09-13 16:30:22 by Synfire</div>
   </div>
   <div class="post" id="post-202908">
    <div class="subject"><a href="#post-202908">Re: Paths in Windows Vista</a></div>
    <div class="body">Very handy&nbsp; 8)</div>
    <div class="meta">Posted on 2007-09-13 16:45:12 by LocoDelAssembly</div>
   </div>
  </div>
 </body>
</html>