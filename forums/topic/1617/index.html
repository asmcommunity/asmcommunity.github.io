<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>SP2 Error assembling Bstrlib - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1617" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=1617">SP2 Error assembling Bstrlib</a></p>
   <div class="post" id="post-10349">
    <div class="subject"><a href="#post-10349">SP2 Error assembling Bstrlib</a></div>
    <div class="body">Just bolted service pack 2 on to Masm32 <br />having completed SP1.<br />gone in to the C:\masm32\COM\colib\bstrLib folder and typed make. but I got the following :-<br /><br /> Assembling: bstrCat.asm<br /> Assembling: bstrGetCL.asm<br /> Assembling: bstrInString.asm<br /> Assembling: bstrLeft.asm<br /> Assembling: bstrMid.asm<br /> Assembling: bstrRight.asm<br /> Assembling: DW2BSTR.asm<br /> Assembling: GetPrivateProfileBSTRING.asm<br /> Assembling: NameFromPathName.asm<br /> Assembling: NewNameToPathName.asm<br />NewNameToPathName.asm(53) : error A2006: undefined symbol : lstrcpyW<br />NewNameToPathName.asm(55) : error A2006: undefined symbol : lstrcatW<br /> Assembling: NewPathToPathName.asm<br />NewPathToPathName.asm(52) : error A2006: undefined symbol : lstrcpyW<br />NewPathToPathName.asm(62) : error A2006: undefined symbol : lstrcatW<br /> Assembling: PathFromPathName.asm<br /> Assembling: WritePrivateProfileBSTRING.asm<br /><br /><br />Any ideas anyone ?<br />I didn't do any make in between adding service pack 1 and service pack 2, don't know if that might be the problem or not.<br /><br />Kev.</div>
    <div class="meta">Posted on 2001-10-26 13:29:16 by krugman</div>
   </div>
   <div class="post" id="post-10361">
    <div class="subject"><a href="#post-10361">SP2 Error assembling Bstrlib</a></div>
    <div class="body">Kev,<br /><br />The bstr library is Ernie Murphy's work but it looks like the problem is the include files from MASM32 are ANSI as standard where the functions that are failing are calling UNICODE versions.<br /><br />There is a utility in the BIN directory called l2incW.exe that will create UNICODE includes so what I would be inclined to do is make a seperate directory for unicode include files and creat a set with this utility.<br /><br />You may have to modify the MAKE batch file to set the paths corectly but it should work OK.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2001-10-26 17:52:24 by hutch--</div>
   </div>
   <div class="post" id="post-10485">
    <div class="subject"><a href="#post-10485">SP2 Error assembling Bstrlib</a></div>
    <div class="body">OK, I'll give that a whirl. Thanks.<br /><br />Kev.</div>
    <div class="meta">Posted on 2001-10-28 13:28:01 by krugman</div>
   </div>
   <div class="post" id="post-10765">
    <div class="subject"><a href="#post-10765">SP2 Error assembling Bstrlib</a></div>
    <div class="body">Whoops, seems I forgot something.<br /><br />Yeah, the MASM32 'standard' as defined by hutch pretty much excludes any unicode support. For some things, I've hacked these into his include files (the libs are fine as is). SO, since my builds don't bark at me, I forget I've made these changes.<br /><br />The prototype for the W API versions are the same as for the A (ascii) versions, just add that W to a copy of the same function proto.</div>
    <div class="meta">Posted on 2001-10-30 19:19:32 by Ernie</div>
   </div>
   <div class="post" id="post-10809">
    <div class="subject"><a href="#post-10809">SP2 Error assembling Bstrlib</a></div>
    <div class="body">I have made a tool for generating .inc files that solve this, by supporting<br />both ansi/unicode, depending on some flags you define. But hutch<br />doesn't seem to like this :/. I can upload the tool if you want to have<br />a look at it.</div>
    <div class="meta">Posted on 2001-10-31 05:15:30 by f0dder</div>
   </div>
   <div class="post" id="post-10844">
    <div class="subject"><a href="#post-10844">SP2 Error assembling Bstrlib</a></div>
    <div class="body">OK, thanks for all the help on this guys. But don't put any more of your effort in to this, I am not likely to use this library in the near future. What happened was I downloaded the service packs and then after installing SP2, I wasn't sure which bits would need re-making, so I did a search for all of the make.bat files in the MASM32 tree, and ran them all. All ran OK, apart from that one.<br /><br />So, Thanks again.<br /><br />Kev.</div>
    <div class="meta">Posted on 2001-10-31 10:59:43 by krugman</div>
   </div>
  </div>
 </body>
</html>