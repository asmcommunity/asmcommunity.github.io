<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Crazy question: Win32asm programming with VC++ 6? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27059" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27059">Crazy question: Win32asm programming with VC++ 6?</a></p>
   <div class="post" id="post-194416">
    <div class="subject"><a href="#post-194416">Crazy question: Win32asm programming with VC++ 6?</a></div>
    <div class="body">Just asking if anyone has tried.  I tried porting Iczelion's tutorial #2(message box), but no luck.  I am still a beginner at this.  I know all db directives have to be turned into C++ variable types.  I managed to firgure out most of the includes(windowsx.h,winuser.h). But I keep getting an error like "cant find external @win16main" or similar.  Just wondering if anyone has tried it and made it work.  I like the VC6 debugger so.... I can put int 3 into my code and use it as a just in time debugger, but I dont think I can get source in the dissasembly window. Probably better off just using MASM, but gotta try? no?

Oops, first time poster.  I wanted this post to go to the General forum, but I think it went to MASM instead, sorry.



This message was edited by asm_happy, on 2/28/2001 6:08:35 PM</div>
    <div class="meta">Posted on 2001-02-28 18:04:00 by asm_happy</div>
   </div>
   <div class="post" id="post-194417">
    <div class="subject"><a href="#post-194417">Crazy question: Win32asm programming with VC++ 6?</a></div>
    <div class="body">Do you mean use the VC++ 6 IDE with the masm assembler? If so, i would love to know how.</div>
    <div class="meta">Posted on 2001-03-01 01:04:00 by HeroInc</div>
   </div>
   <div class="post" id="post-194418">
    <div class="subject"><a href="#post-194418">Crazy question: Win32asm programming with VC++ 6?</a></div>
    <div class="body">Using the VC6 ide with masm is no big deal. Make a folder called
"asm files", and make a proper build rule for that folder. Presto.

You wont have syntax highlighting or intellisense or any of the
other nice features though.</div>
    <div class="meta">Posted on 2001-03-01 03:24:00 by f0dder</div>
   </div>
   <div class="post" id="post-194419">
    <div class="subject"><a href="#post-194419">Crazy question: Win32asm programming with VC++ 6?</a></div>
    <div class="body">You put 'limited' syntax hilighting in, by adding the assembler keywords into the usertype.dat file, then switching asm to c/c++ file type (you can change the registry to do it for you). Then all keywords strings and things come out fine :-)

I also use the linker,debugger and resource editor, which all integrates nicely :-)

So until an assembler IDE comes close to the VC IDE I'm sticking with it.

umbongo</div>
    <div class="meta">Posted on 2001-03-01 04:45:00 by umbongo</div>
   </div>
   <div class="post" id="post-194420">
    <div class="subject"><a href="#post-194420">Crazy question: Win32asm programming with VC++ 6?</a></div>
    <div class="body">Thanks, I'll see if I can figure this one out. Im not sure what f0dder means by a proper build rule.  In my test I was using inline assembly, mean I was actually using the the C++ compiler. Are you saying I can make a build rule to use MASM instead?

I may have VC6 but I find asm more understandable than C++.</div>
    <div class="meta">Posted on 2001-03-01 17:09:00 by asm_happy</div>
   </div>
   <div class="post" id="post-194421">
    <div class="subject"><a href="#post-194421">Crazy question: Win32asm programming with VC++ 6?</a></div>
    <div class="body">A custom build rule will let you use the masm assembler within VC++ like this:-

create an empty workspace

Add the asm file to your project:-

project->add to project->files... then select the .asm file you want


then go to the FileView tab in workspace, right-click the .asm file and choose settings.

Select the custom build tab and type into the commands window :-

\masm32\bin\ml.exe /nologo /coff /Zf /c /Sa $(InputName).asm

or whatever options you want

then put 

$(InputName).obj

as the output name

The linker will run to link your program automatically. If you select /coff as the debug output you can also use all the abilities of the debugger (set breakpoints, step through code etc etc)

The errors masm outputs are the right format for VC++ to interpret them also, this means that if you double-click and assembly error it will take you to that line.

umbongo</div>
    <div class="meta">Posted on 2001-03-02 05:26:00 by umbongo</div>
   </div>
   <div class="post" id="post-194422">
    <div class="subject"><a href="#post-194422">Crazy question: Win32asm programming with VC++ 6?</a></div>
    <div class="body">If you search the comp.lang.asm.x86 posts you'll find someone who wrote a patch file for Visual Studio that makes all the changes for syntax highlighting and I think VS will build them right without custom build rules.  If anyone else remembers the post, they might have more info.  There seems to be many links with a search for 'MASM Visual Studio'<img src=" http://www.hiroshimator.com/asmcommunity/messageboard/images/smiley23.gif
bitRAKE</div>
    <div class="meta">Posted on 2001-03-02 05:58:00 by bitRAKE</div>
   </div>
  </div>
 </body>
</html>