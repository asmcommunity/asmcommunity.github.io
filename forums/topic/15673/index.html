<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Zombie file - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15673" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=15673">Zombie file</a></p>
   <div class="post" id="post-121481">
    <div class="subject"><a href="#post-121481">Zombie file</a></div>
    <div class="body">Could not find the appropriate keywords for the search so..<br /><br />Scenario:<br /><br />a file is opened by some proggy with flags that do not allow delete operation on that file<br />the proggy crashes before closing that file.. so the file remains &quot;in use&quot;<br /><br />My questions:<br /><br /><br />is there a way I can get the handle used for openning that file?<br /><br />or is it at all possible to &quot;free&quot; that file from its imaginary users?<br /><br /><br /><br />no reboots please :tongue:<br /><br /><br /><br /><br />-- delete me --<br /><br />I checked the task list.. found 3 instances of Excel<br />that crashed, killed them which &quot;unlocked&quot; the file</div>
    <div class="meta">Posted on 2003-10-16 09:12:21 by Azrim</div>
   </div>
   <div class="post" id="post-121538">
    <div class="subject"><a href="#post-121538">Zombie file</a></div>
    <div class="body">When an app crashes, these types of handles it took get released just like in a normal exit:<br />Heap<br />Files<br />Loaded libraries<br />GDI objects<br />(I know of experience)<br />The following are not instantly (or ever) released:<br />DirectSound objects (if cooperative level is set to desktop)<br />MIDIin/out handles</div>
    <div class="meta">Posted on 2003-10-17 06:40:51 by Ultrano</div>
   </div>
   <div class="post" id="post-121546">
    <div class="subject"><a href="#post-121546">Zombie file</a></div>
    <div class="body">Reboot, and don't run Excel :tongue:</div>
    <div class="meta">Posted on 2003-10-17 07:54:43 by sluggy</div>
   </div>
   <div class="post" id="post-121684">
    <div class="subject"><a href="#post-121684">Zombie file</a></div>
    <div class="body">Hi Azrim!<br /><br />Do you know if the crashing program is multithreaded?  If so, and depending on the operating system, you might be able to find an offending orphaned process and kill that process.  This *might* let you delete the file without a reboot.  Otherwise, I don't have any suggestions.<br /><br />Charles<br /><br />PS to Sluggy: I never have trouble with Excel:grin: !</div>
    <div class="meta">Posted on 2003-10-18 15:39:47 by cdquarles</div>
   </div>
   <div class="post" id="post-121696">
    <div class="subject"><a href="#post-121696">Zombie file</a></div>
    <div class="body">Excel just crashed every time I tried to select some cells after turning &quot;Auto Filter&quot; on<br />... 3 times in a row, I got the file over email.. no macros.. <br />Just a microsoftish style application behaviour I guess.</div>
    <div class="meta">Posted on 2003-10-18 16:56:06 by Azrim</div>
   </div>
   <div class="post" id="post-121713">
    <div class="subject"><a href="#post-121713">Zombie file</a></div>
    <div class="body">Hi Azrim,<br /><br />Which version do you have?  I am using the 2002 version (with Office XP), and I tried to duplicate your problem; but I have never had a problem with it.  I am also using Windows XP Professional.  My version is multithreaded.  Post your OS version and Excel version.  It is possible that your problem is related to the file that you received.  I can kill threads (processes) if necessary.<br /><br />Charles</div>
    <div class="meta">Posted on 2003-10-18 20:46:42 by cdquarles</div>
   </div>
   <div class="post" id="post-121770">
    <div class="subject"><a href="#post-121770">Zombie file</a></div>
    <div class="body">AFAIK , killing a thread won't solve problems. It'll just bring more. No file handles get released when a thread terminates - unlike when the whole process ends. <br />Azrim, any chance you have installed bad (irrelevant for your os) version of DCOM ?</div>
    <div class="meta">Posted on 2003-10-19 14:18:02 by Ultrano</div>
   </div>
   <div class="post" id="post-121803">
    <div class="subject"><a href="#post-121803">Zombie file</a></div>
    <div class="body">Hi Ultrano,<br /><br />Okay.  I have an executable open that spawned subprocesses.  The executable dies, which should have killed the subprocesses; but a file or files have attributes marked which tell the operating system that these files are still in use by a program that terminated abnormally.  Since we don't know which operating system is in use, we don't know whether the original executable left running duplicates of itself holding handles to said files.  If there are no such processes running, then I don't see how this problem can be solved short of logging off or a full restart.  Since this particular problem has never happened to me, I was just speculating.  Microsoft Office applications do make backup copies of files that were in use just in case it crashes so that you can start over at the point where it made a backup copy.  Sometimes these get left behind, but restarting the application and opening the file and then saving it normally will clear these.  I have had a power supply go down while using the computer to create a Word document.  All I had to do was reopen the file.  This, though, isn't what Azrim is talking about if I understand him correctly.<br /><br />Azrim, did you have AutoSave on when you ran Excel, by the way?<br /><br />Thanks for the info,<br /><br />Charles</div>
    <div class="meta">Posted on 2003-10-20 00:04:03 by cdquarles</div>
   </div>
   <div class="post" id="post-121805">
    <div class="subject"><a href="#post-121805">Zombie file</a></div>
    <div class="body">Hi Ultrano,<br /><br />He he and slap head (always read the whole original post)!  Azrim checked his task list and found three instances of Excel in the list.  When he killed them, the file's in use attribute was cleared.  However, I don't think that we will be able to help him find out why he had a problem with the file in the first place without more info.<br /><br />Charles</div>
    <div class="meta">Posted on 2003-10-20 00:10:47 by cdquarles</div>
   </div>
   <div class="post" id="post-121816">
    <div class="subject"><a href="#post-121816">Zombie file</a></div>
    <div class="body">sorry, I was &quot;offline&quot; a bit more than I expected :( <br /><br /><br />Sysinfo:<br /><br />Win2k SP 4, Excel 2000 (9.0.3821 SR-1)<br /><br />I got the file over e-mail from a &quot;friend&quot; that was using a newer version of Office <br />i do not have the original file now.. nor the original email..<br /><br />I will try to reproduce this behavior in a moment.<br /><br />You could be right about DCOM<br /><br />I do have a lot of stuff on this computer<br />.NET Enterprise, SQL Server 2000, Win2k Res. Kit, ..etc.</div>
    <div class="meta">Posted on 2003-10-20 02:37:55 by Azrim</div>
   </div>
   <div class="post" id="post-121833">
    <div class="subject"><a href="#post-121833">Zombie file</a></div>
    <div class="body">Hi Azrim,<br /><br />If you can, upgrade to Excel 2002.  Excel 2000 had a lot of teething problems related to (IMO) a poor implementation of unicode handling.  Excel 97 was ASCII.  Excel 2002 fixed a lot of unicode related bugs.  <br /><br />Charles</div>
    <div class="meta">Posted on 2003-10-20 10:01:03 by cdquarles</div>
   </div>
   <div class="post" id="post-121864">
    <div class="subject"><a href="#post-121864">Zombie file</a></div>
    <div class="body">tnx all,<br /><br /><br />I should ask.. by just knowing the file name <br />how can I get a list of processes that have open file handles to that file?</div>
    <div class="meta">Posted on 2003-10-20 13:40:04 by Azrim</div>
   </div>
   <div class="post" id="post-121899">
    <div class="subject"><a href="#post-121899">Zombie file</a></div>
    <div class="body">Hi Azrim,<br /><br />Go to <a target="_blank" href="www.sysinternals.com">www.sysinternals.com</a> and download every free tool they have.  They have a number of file monitors, process monitors, etc.<br /><br />Charles</div>
    <div class="meta">Posted on 2003-10-20 21:27:20 by cdquarles</div>
   </div>
   <div class="post" id="post-121925">
    <div class="subject"><a href="#post-121925">Zombie file</a></div>
    <div class="body">Thanks,<br /><br /><br />one more thing, :( muhahahaha I just love office</div>
    <div class="meta">Posted on 2003-10-21 03:14:58 by Azrim</div>
   </div>
   <div class="post" id="post-121939">
    <div class="subject"><a href="#post-121939">Zombie file</a></div>
    <div class="body">it's a grammar error, that's why it's underlined.</div>
    <div class="meta">Posted on 2003-10-21 05:04:18 by Ultrano</div>
   </div>
   <div class="post" id="post-121945">
    <div class="subject"><a href="#post-121945">Zombie file</a></div>
    <div class="body">yes, but why not another color<br /><br />&quot;Delete repeated word&quot;</div>
    <div class="meta">Posted on 2003-10-21 05:43:06 by Azrim</div>
   </div>
   <div class="post" id="post-122035">
    <div class="subject"><a href="#post-122035">Zombie file</a></div>
    <div class="body"><div class="quote"><br />it's a grammar error, that's why it's underlined. </div>grammar errors are in green by default.<br />red is just for errors in typing: spelling, double word, etc.</div>
    <div class="meta">Posted on 2003-10-21 21:31:01 by bitRAKE</div>
   </div>
   <div class="post" id="post-122039">
    <div class="subject"><a href="#post-122039">Zombie file</a></div>
    <div class="body">Hi Azrim,<br /><br />BTW, Excel 2000 cannot read 2002 or later format files.  If your friend did not save it in 97 or 2000 format, your version cannot handle it.  That's probably why it crashed on you.<br /><br />Charles</div>
    <div class="meta">Posted on 2003-10-21 22:51:38 by cdquarles</div>
   </div>
  </div>
 </body>
</html>