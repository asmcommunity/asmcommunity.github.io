<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Keyboard Hook SendMessage - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18320" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18320">Keyboard Hook SendMessage</a></p>
   <div class="post" id="post-141964">
    <div class="subject"><a href="#post-141964">Keyboard Hook SendMessage</a></div>
    <div class="body">The problem:<br /><br />I have a problem realizing a keyboard hook which should fill the activated <br />edit field in the active window with defined content. <br /><br />To reach this a windows message WM_SETTEXT is sent to the active <br />edit field (in which the cursor is placed).<br /><br />There are the 3 essential code lines in the hook-DLL:<br /><br />	invoke	GetFocus<br />	mov	hFocus,eax<br />	invoke	SendMessage, hFocus, WM_SETTEXT, 0, ADDR szText<br /><br />This seems to work fine with NOTEPAD, WORDPAD, EXCEL, IE a.s.o. But not in<br />WORD!<br /><br />In WORD, the messages affect only combo-boxes, but not the &quot;text-window&quot;.<br />Possibly GetFocus returns the wrong handle ?!? <br /><br /><br />Thank you for your help.</div>
    <div class="meta">Posted on 2004-05-24 05:43:56 by Mainframe</div>
   </div>
   <div class="post" id="post-142008">
    <div class="subject"><a href="#post-142008">Keyboard Hook SendMessage</a></div>
    <div class="body">I came across a similar problem a while back I think - I was trying to send bits of text to other active applications and the WM_SETTEXT message was the first thing I tired (unsucessfully). After that I tried sending the keystrokes with SendInput - worked ok - but on long strings of text it tended to overload the keyboard buffer. <br /><br />The best way I found was to use a WH_JOURNALPLAYBACK hook and send the keystrokes as WM_CHAR messages which has worked really well.<br /><br />Hope this helps <br /><br />Mark</div>
    <div class="meta">Posted on 2004-05-24 13:02:23 by MurkyT</div>
   </div>
  </div>
 </body>
</html>