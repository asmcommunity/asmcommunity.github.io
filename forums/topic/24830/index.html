<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Could anyone give me a MS Agent example in OBJASM? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24830" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24830">Could anyone give me a MS Agent example in OBJASM?</a></p>
   <div class="post" id="post-181400">
    <div class="subject"><a href="#post-181400">Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">OBJASM sounds great. It supports COM.<br />I want to use MS Agent in my program.<br />I know MS agent is a COM object. <br />Could anyone give me a MS Agent example in OBJASM?<br />Thank you very much!</div>
    <div class="meta">Posted on 2006-06-05 03:07:40 by guidry</div>
   </div>
   <div class="post" id="post-181405">
    <div class="subject"><a href="#post-181405">Re: Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">Hi Guidry<br />I haven’t written any example using the MS Agent, but reading the SDK, it seems basic COM stuff. I can help you if you have interested in developing or translating an example from the MS download page (<a target="_blank" href="http://www.microsoft.com/msagent/default.asp">http://www.microsoft.com/msagent/default.asp</a>). <br />First of all, you need the interface definitions. I attached the file I get using Japheths ComView (<a target="_blank" href="http://www.japheth.de">http://www.japheth.de</a>) and modified to the proper ObjAsm32 syntax.<br /><br />Regards,<br /><br />Biterider<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1675" target="_blank">AgentServerObjects.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-06-05 15:42:42 by Biterider</div>
   </div>
   <div class="post" id="post-181407">
    <div class="subject"><a href="#post-181407">Could anyone translate that AGENT Program in OBJASM?</a></div>
    <div class="body">Thanks for your advice. But I would appreciate it more if there could be more details.<br /><strong>Nan wrote and posted an example for using MS agent </strong> four years ago.<br />That program uses some basic OOP ideas when calling that COM.<br />How I wish if there is anyone could<strong> translate that in OBJASM.</strong>Since MS Agent can do text to speech with lips movement simulation when the character is talking. And a lot of animation. It&#39;s cool.<br />So I want to use MS Agent in my program.<br /><strong>The Nan&#39;s example is as the attached zip file.</strong><br />That program would be better if written in OBJASM.<br />Could any one give me some advice to translate and modify Nan&#39;s program into OBJASM?<br />PS:MS Agent and its components (SAPI4, TTS engine, character files) can be downloaded at:<br />http://www.microsoft.com/msagent/downloads/user.asp</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1676" target="_blank">agentASM.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-06-05 22:22:38 by guidry</div>
   </div>
   <div class="post" id="post-181408">
    <div class="subject"><a href="#post-181408">Re: Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">Hi<br />Here is a fast translation of NaNs work to ObjAsm32. Now it’s up to you to enhance it&nbsp; :).<br /><br />Regards,<br /><br />Biterider<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1677" target="_blank">MS_Agent.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-06-06 02:35:01 by Biterider</div>
   </div>
   <div class="post" id="post-181415">
    <div class="subject"><a href="#post-181415">Re: Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">Sorry, I forgot to add an important file.&nbsp; ;)<br /><br />Biterider</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1680" target="_blank">MSAgent.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-06-06 15:23:12 by Biterider</div>
   </div>
   <div class="post" id="post-181419">
    <div class="subject"><a href="#post-181419">Thank you very much...</a></div>
    <div class="body">Thank you very much. I&#39;ll give it a try as soon as possible. <br />It&#39;s so nice of you to translate that for us.<br />You are really an expert. Maybe you can provide that piece of&nbsp; code as another example file in your next version of OBJASM, so that people know how to utilize OBJASM more!<br /> :)</div>
    <div class="meta">Posted on 2006-06-06 19:13:03 by guidry</div>
   </div>
   <div class="post" id="post-181546">
    <div class="subject"><a href="#post-181546">Re: Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">I agree, there needs to be more OA32 samples supplied with the package (perhaps it is time to add some kind of auto-update executable tool to the package in order to perform &#39;smart updates&#39;?), especially we should be pushing the COM support (then we can drag in some more newbie asmcoders from the higher langs since they won&#39;t stare at 16 bit examples of asm and make the mistake of thinking that lowlevel asm is the only asm).<br /><br />Now that you are joining the ranks of the OA32 fan club, perhaps you might like to submit one or more suitable samples? :)<br /></div>
    <div class="meta">Posted on 2006-06-10 02:45:59 by Homer</div>
   </div>
   <div class="post" id="post-184345">
    <div class="subject"><a href="#post-184345">Re: Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">guidry,<br /><br />The msagent application I wrote back then was my very first hack at anything COM related (yes, I like bitting off more than I can chew).&nbsp; So its no surprise you&#39;d need a translation ;) .&nbsp; Biterider&#39;s translation is excellent (and now in my archive ~ thank you very much).&nbsp; I apologize I&#39;ve never come back to clean it up any better.<br /><br />I was planning on making an OOP Class Object out of MsAgent as well as MsSpeech.&nbsp; I still may get around to doing them both, but there is little need in for either in my current projects.&nbsp; If I do I will post it here first.<br /><br />Regards,<br />:NaN:</div>
    <div class="meta">Posted on 2006-08-08 22:12:40 by NaN</div>
   </div>
   <div class="post" id="post-185850">
    <div class="subject"><a href="#post-185850">Re: Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">Hi Nan:<br />&nbsp;  Both of you are experts. Making Assembly OOP isn&#39;t easy at all. But you made it.<br />&nbsp;  You said that you are planning on making an OOP Class Object out of MsAgent as well as MsSpeech. That&#39;s a good news for us. Very eager to see your masterpiece.<br /><br />Regards, <br />Guidry</div>
    <div class="meta">Posted on 2006-10-11 20:30:44 by guidry</div>
   </div>
   <div class="post" id="post-185856">
    <div class="subject"><a href="#post-185856">Re: Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">Hi guidry<br />The next release of ObjAsm32 has some new examples using SAPI and MS_Agent object. This release will be finished in the next few days.<br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2006-10-12 07:36:19 by Biterider</div>
   </div>
   <div class="post" id="post-185930">
    <div class="subject"><a href="#post-185930">Re: Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">That&#39;s a good news for us!<br /><br />Besides, I find a website which provides many free MsAgent characters there. So many characters that you can&nbsp; even use them to play a story for your kids! <br />http://www.msagentring.org/chars.aspx</div>
    <div class="meta">Posted on 2006-10-13 22:14:16 by guidry</div>
   </div>
   <div class="post" id="post-185933">
    <div class="subject"><a href="#post-185933">Re: Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">Thanks for the link.<br /><br />BTW:&nbsp; I&#39;ve had no time as of yet to return to this.&nbsp; <br /><br />Also, I want to make it clear that Bitrider is the real torch bearer these days.&nbsp; I dont know where he finds the time, but his work is excellent.&nbsp; I&#39;m very happy with the quallity his sources as well as the overall ObjAsm32 system (he still associates me to his product but I dont know why).&nbsp; I may have had a hand is getting the topic of OOP in MASM32 going, however IMO, Biteriders skill in this area has exceeded my own.&nbsp;  Any credit desrved belongs to him.&nbsp; I only pointed him in the right direction when things were getting off the ground ~ now i got to catch up....<br /><br />Regards,<br />:NaN:<br /></div>
    <div class="meta">Posted on 2006-10-14 00:09:42 by NaN</div>
   </div>
   <div class="post" id="post-186146">
    <div class="subject"><a href="#post-186146">How to sink events from a COM server with OBJASM</a></div>
    <div class="body">&nbsp; &nbsp; I think MS Agent is very suitable to demonstrate the power and beauty of OBJASM. <br />&nbsp; &nbsp; First of all, it&#39;s&nbsp; interesting and attractive. You&#39;ll see the cute character&#39;s animations after hard working, and that&#39;s&nbsp; really a treat. It&#39;s&nbsp; less boring than programming other programs. Second, MS Agent is a standard COM component, very suitable for OOP programming.<br />However I encounter a problem when I want to use the notification data sink to deal with the events happened on&nbsp; MS Agent character. For example, if we want the agent character to say ?You double clicked me? while we double-click on the agent&nbsp; character, we should use the IagentNotifySink interface to deal with the STDMETHOD dblclick event which is defined in AgentseverObjects.inc generated by COMVIEW and modified by Biterider. <br />&nbsp; &nbsp; I can&#39;t find a way as: <br /> <strong>Event ondbClick, messageID&nbsp; </strong> to deal with that. Because I can&#39;t find any information about the the ID numbers in the associated inc files.&nbsp; So Japheth&#39;s Server Event Support macros in DISPHLP.INC seems not work here, either.<br />&nbsp; &nbsp;&nbsp; I&nbsp; look at the example C++ codes in SDK provided by Microsoft, and it says: <em>You must implement either the IAgentNotifySink or the IAgentNotifySinkEx interface, and create and register an object of that type following COM conventions</em>:<br /><br /><em>// Create a notification sink<br />pSinkEx = new AgentNotifySinkEx;<br />pSinkEx-&gt;AddRef();<br />// And register it with Microsoft Agent<br />hRes = pAgentEx-&gt;Register((IUnknown *)pSinkEx, &amp;lNotifySinkID);</em><br /><br />Where class<em> AgentNotifySinkEx </em> is defined by ? <em>public IagentNotifySinkEx</em>? somewhere.<br /><br />And the event sink is like this:<br /><br /><em>STDMETHODIMP AgentNotifySinkEx::DblClick(long dwCharID, short fwKeys, long x, long y) {<br />//&nbsp; Do something when db-clicked.......<br />	return NOERROR;<br />}</em>&nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp;&nbsp;The COM notification event sink can be implemented by using STDMETHODIMP in C++, but how can we implement&nbsp; IagentNotifySinkEx in OBJASM, and it seems that we can&#39;t explicitly use Icall because the sink is called by events, can we?&nbsp; I am not an experienced programmer to extract the rule on my own anyhow. :sad:<br />&nbsp; &nbsp; <strong> Could anyone possibly kindly give me any specific example of MSAGENT with at least double-click event sink handling based on&nbsp; Biterider&#39;s MSAGENT or anything else?</strong>&nbsp; I hate to bother anyone, but I can&#39;t find support elsewhere. The assembly programming web pages seem to be fewer and fewer...</div>
    <div class="meta">Posted on 2006-10-23 01:31:56 by guidry</div>
   </div>
   <div class="post" id="post-186148">
    <div class="subject"><a href="#post-186148">Re: Could anyone give me a MS Agent example in OBJASM?</a></div>
    <div class="body">Hi guidry<br />The Event approach is for window messages only and would not work for COM notifications.<br />You have to work with ?EventSinks? (a COM interface that you have to create) and register it with the MS_Agent COM object. Starting from this moment, you will receive notifications to this interface.<br /><br />An example that can help you a bit is Demo16/Test_4.<br /><br />Regards,<br /><br />Biterider<br /></div>
    <div class="meta">Posted on 2006-10-23 07:18:19 by Biterider</div>
   </div>
  </div>
 </body>
</html>