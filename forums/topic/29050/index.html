<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>More Info Needed In Process Enumeration - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29050" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=113">Low Level Concepts</a> &raquo; <a href="../?id=29050">More Info Needed In Process Enumeration</a></p>
   <div class="post" id="post-205235">
    <div class="subject"><a href="#post-205235">More Info Needed In Process Enumeration</a></div>
    <div class="body">There is this tool that fetches the list of all the running processes and then flags all those processes that are dangerous. Now getting the list of all the running processes is trivial and has been discussed on the forums infinite times. What I ask is how does the tool decides wheather a process is dangerous or not. My first thought was that this tool monitors all the api calls of all the processes and then based on that info it determines the dangerous processes but this can&#039;t be true since system processes uses almost same apis that are used by dangerous processes (like accessing registries and files on disk etc.). Any ideas?</div>
    <div class="meta">Posted on 2008-05-04 12:58:40 by shakuni</div>
   </div>
   <div class="post" id="post-205236">
    <div class="subject"><a href="#post-205236">Re: More Info Needed In Process Enumeration</a></div>
    <div class="body">Maybe it has an internal list of dangerous processes? Or it just flags all processes that use hooks?<br /><br />Just FYI... I&#039;m blindly guessing here&nbsp; :lol:</div>
    <div class="meta">Posted on 2008-05-04 15:36:35 by JimmyClif</div>
   </div>
   <div class="post" id="post-205238">
    <div class="subject"><a href="#post-205238">Re: More Info Needed In Process Enumeration</a></div>
    <div class="body">I&#039;d suggest that probably just looks for dubious api functions like CreateRemoteThread.... <br /></div>
    <div class="meta">Posted on 2008-05-05 23:20:29 by Homer</div>
   </div>
   <div class="post" id="post-205246">
    <div class="subject"><a href="#post-205246">Re: More Info Needed In Process Enumeration</a></div>
    <div class="body">Yeah, I was gonna say, looking for API calls that could potentially be dangerous, and maybe even lookiing for certain combinations of them (if you see XX and YY together, flag as more dangerous), or maybe even looking to see if it&#039;s calling the native functions itself (which is probably only used by either people trying to learn about the native API, or people who have something to hide).</div>
    <div class="meta">Posted on 2008-05-08 06:25:51 by Bobbias</div>
   </div>
   <div class="post" id="post-205247">
    <div class="subject"><a href="#post-205247">Re: More Info Needed In Process Enumeration</a></div>
    <div class="body">Can you tell us what this tool is?<br /><br />I want to rule out the possibility of something trivial like using a database of filenames of known spyware tools or the like :)</div>
    <div class="meta">Posted on 2008-05-08 09:01:28 by f0dder</div>
   </div>
   <div class="post" id="post-205250">
    <div class="subject"><a href="#post-205250">Re: More Info Needed In Process Enumeration</a></div>
    <div class="body"><div class="quote">Can you tell us what this tool is?<br /><br />I want to rule out the possibility of something trivial like using a database of filenames of known spyware tools or the like </div><br />System Mechanic.</div>
    <div class="meta">Posted on 2008-05-08 11:51:23 by shakuni</div>
   </div>
   <div class="post" id="post-206707">
    <div class="subject"><a href="#post-206707">Re: More Info Needed In Process Enumeration</a></div>
    <div class="body">you can hook NtOpenProcess&nbsp; to protect your process, if some thread want try to open process and process handle is you, return false.</div>
    <div class="meta">Posted on 2009-01-13 07:24:38 by mnzn2530</div>
   </div>
   <div class="post" id="post-206708">
    <div class="subject"><a href="#post-206708">Re: More Info Needed In Process Enumeration</a></div>
    <div class="body">that&#039;ll only work if your hook is global...</div>
    <div class="meta">Posted on 2009-01-13 09:15:34 by evlncrn8</div>
   </div>
   <div class="post" id="post-206710">
    <div class="subject"><a href="#post-206710">Re: More Info Needed In Process Enumeration</a></div>
    <div class="body">.. and it won&#039;t protect the Zw ancestor.<br /></div>
    <div class="meta">Posted on 2009-01-14 03:40:38 by Homer</div>
   </div>
  </div>
 </body>
</html>