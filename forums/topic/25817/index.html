<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Help with a notepad - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25817" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25817">Help with a notepad</a></p>
   <div class="post" id="post-188324">
    <div class="subject"><a href="#post-188324">Help with a notepad</a></div>
    <div class="body">Im getting some troubles doing a notepad in assembler the first problem its that i cant use int21h i must use int10h and i dont know how to capture those keys:<br /><br />arrows keys<br />home key<br />end key<br />backspace key<br />pgup &amp; pgdn key<br /><br />if somebody can.....please give me a hand with this!!!</div>
    <div class="meta">Posted on 2007-03-06 06:31:43 by J_Osv</div>
   </div>
   <div class="post" id="post-188330">
    <div class="subject"><a href="#post-188330">Re: Help with a notepad</a></div>
    <div class="body">Check out <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=24671.0"><u>THIS THREAD</u></a>.<br /><br />Look up BIOS INT 16h.</div>
    <div class="meta">Posted on 2007-03-06 17:23:10 by SpooK</div>
   </div>
   <div class="post" id="post-188387">
    <div class="subject"><a href="#post-188387">Re: Help with a notepad</a></div>
    <div class="body">Spook&#39;s post should be more than enough for you in order to learn what you have to do to handle those keys but one addition to this is that you can poll the Keyboard Microcontroller manually and read the scan code yourself. After the scan code is read, you can translate it to the key that it represents and then take action.<br /><br />Here is an example for polling the Keyboard Microcontroller at port 0x64:<br /><br /><pre><code>.WaitForOutput:<br />&nbsp; &nbsp; IN&nbsp; &nbsp; &nbsp; AL , 0x64<br />&nbsp; &nbsp; TEST&nbsp; &nbsp; AL , 0x01<br />&nbsp; &nbsp; JZ&nbsp; &nbsp; &nbsp; .WaitForOutput<br />&nbsp; IN&nbsp; &nbsp; &nbsp; AL , 0x60</code></pre><br /><br />The AL register will be filled with the scan code of the character printed to the screen. The .WaitForOutput loop waits for a key to be pressed. You can read Chapter 20 of the book Art of Assembly by Randall Hyde to see the table of scan codes and etc.<br /><br />Another easy way to handle this problem is to use INT 0x16. These are two procedures that I have written in my <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=25693.0">OASML 2.0</a> library.<br /><br /><pre><code>; ------------------------------<br />ReadChar PROC<br />&nbsp; COMMENT *<br />&nbsp; &nbsp; Description : Wait for a character to be entered onto the console window and return<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the ASCII code in the AL register and the Scan code in the AH register.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The function would then echo the character to the window. See note(s).<br /><br />&nbsp; &nbsp; Calling Convention : Register.<br /><br />&nbsp; &nbsp; Parameter(s) :<br />&nbsp; &nbsp; &nbsp; -None-<br /><br />&nbsp; &nbsp; Stack Usage: 2 Bytes.<br /><br />&nbsp; &nbsp; Note : 1) The Scan code will be returned in the AH register and the ASCII code of the<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; character in the AL register.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2) The ReadChar function echoes the entered character to the window.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3) Also see the ReadCharNE (Read Character No Echo) function.<br /><br />&nbsp; &nbsp; Example : Wait for the user to enter a key on the keyboard and return the values according<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to the above notes.<br /><br />&nbsp; &nbsp; .CODE<br />&nbsp; &nbsp; &nbsp; Call&nbsp; &nbsp; ReadChar ; Call the function<br />&nbsp; &nbsp; &nbsp; ; AH = Key&#39;s Scan Code<br />&nbsp; &nbsp; &nbsp; ; AL = Key&#39;s ASCII Code<br />&nbsp; *<br />&nbsp; @@__ReadCharLoop:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; The main loop to get the keystrokes<br />&nbsp; &nbsp; MOV&nbsp; &nbsp; &nbsp;AH , 01h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Check Keystroke function<br />&nbsp; &nbsp; DW&nbsp; &nbsp; &nbsp; 16CDh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; Issue the interrupt<br />&nbsp; &nbsp; JZ&nbsp; &nbsp; &nbsp; @@__ReadCharLoop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Keep checking until a key is pressed<br />&nbsp; PUSH&nbsp; &nbsp; AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; AH = Scan Code , AL = ASCII Code<br />&nbsp; MOV&nbsp; &nbsp; &nbsp;AH , 00h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Get Keystroke function<br />&nbsp; DW&nbsp; &nbsp; &nbsp; 16CDh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; Issue the interrupt<br />&nbsp; MOV&nbsp; &nbsp; &nbsp;AH , 0Eh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Print character function<br />&nbsp; DW&nbsp; &nbsp; &nbsp; 10CDh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; Issue the interrupt<br />&nbsp; POP&nbsp; &nbsp; &nbsp;AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; AH = Scan Code, AL = ASCII Code<br />&nbsp; RET&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; Return to the calling procedure<br />ReadChar ENDP<br />; ------------------------------<br />ReadCharNE PROC<br />&nbsp; COMMENT *<br />&nbsp; &nbsp; Description : Wait for a character to be entered onto the console window and return<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; the ASCII code in the AL register and the Scan code in the AH register.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; The function does not echo the character to the screen. See note(s).<br /><br />&nbsp; &nbsp; Calling Convention : Register.<br /><br />&nbsp; &nbsp; Parameter(s) :<br />&nbsp; &nbsp; &nbsp; -None-<br /><br />&nbsp; &nbsp; Stack Usage: 2 Bytes.<br /><br />&nbsp; &nbsp; Note : 1) The Scan code will be returned in the AH register and the ASCII code of the<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; character in the AL register.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;2) The ReadCharNE function does not echo the entered character to the window.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;3) Also see the ReadChar (Read Character) function.<br /><br />&nbsp; &nbsp; Example : Wait for the user to enter a key on the keyboard and return the values according<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; to the above notes.<br /><br />&nbsp; &nbsp; .CODE<br />&nbsp; &nbsp; &nbsp; Call&nbsp; &nbsp; ReadCharNE ; Call the function<br />&nbsp; &nbsp; &nbsp; ; AH = Key&#39;s Scan Code<br />&nbsp; &nbsp; &nbsp; ; AL = Key&#39;s ASCII Code<br />&nbsp; *<br />&nbsp; @@__ReadCharNELoop:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; Keep checking for keystrokes<br />&nbsp; &nbsp; MOV&nbsp; &nbsp; &nbsp;AH , 01h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Check keystrokes function<br />&nbsp; &nbsp; DW&nbsp; &nbsp; &nbsp; 16CDh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; Issue the interrupt<br />&nbsp; &nbsp; JZ&nbsp; &nbsp; &nbsp; @@__ReadCharNELoop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Keep doing this until a key is pressed<br />&nbsp; PUSH&nbsp; &nbsp; AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; AH = Scan Code, AL = ASCII Code<br />&nbsp; MOV&nbsp; &nbsp; &nbsp;AH , 00h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Get keystroke function<br />&nbsp; DW&nbsp; &nbsp; &nbsp; 16CDh&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; Issue the interrupt<br />&nbsp; POP&nbsp; &nbsp; &nbsp;AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; AH = Scan Code, AL = ASCII Code<br />&nbsp; RET&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; Return to the calling procedure<br />ReadCharNE ENDP<br />; ------------------------------</code></pre><br /><br />Good luck.</div>
    <div class="meta">Posted on 2007-03-11 03:43:05 by XCHG</div>
   </div>
  </div>
 </body>
</html>