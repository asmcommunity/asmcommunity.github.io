<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Static Linking - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=28376" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=28376">Static Linking</a></p>
   <div class="post" id="post-200818">
    <div class="subject"><a href="#post-200818">Static Linking</a></div>
    <div class="body">Hi,
What is better for smaller code and memory usage:
static linking or LoadLibrary,GetProcAddress and call eax?
Does the function from DLL was included in my exe file if I use a static linking?

Thanks</div>
    <div class="meta">Posted on 2001-06-12 12:00:00 by linka</div>
   </div>
   <div class="post" id="post-200819">
    <div class="subject"><a href="#post-200819">Static Linking</a></div>
    <div class="body">Correct me if I'm wrong but as "DLL" stands for <strong>Dynamic Link</strong> Library, I don't think dlls can be linked staticly. DLLs contain the actual code for the functions, when a dll is linked dynamically with a lib (i.e. a library created for the dll), only substitutions for the actual functions are placed inside your program. For example, when you use the function MessageBox from user32.dll, a small piece of code in user32.lib is paced in your program, usually a single jump to the function. This piece of code is called in your program whenever it wants to call the messagebox function. So it's not the actual functions that are included, only a piece of code that calls them, you will always need the dll.
Another method of using DLLs is loadlibrary/getprocaddress. But this just creates a lot of overhead. As for each function you use, you have to call getprocaddress first. That's not efficient and spaceconsuming. It can be useful though in some cases.
Then there are static libraries, like m32lib inside the masm32 package. These libraries contain the actual code, and this code is included in your program, so you don't need any external files after assembling. 
I hope this will make some things clear,

Thomas</div>
    <div class="meta">Posted on 2001-06-12 16:54:00 by Thomas</div>
   </div>
   <div class="post" id="post-200820">
    <div class="subject"><a href="#post-200820">Static Linking</a></div>
    <div class="body">Thank you so much for your help!
I red MSDN linking DLLs explicitly&implicitly
and now all is clear for me.
Thanks Tomas!</div>
    <div class="meta">Posted on 2001-06-12 21:13:00 by linka</div>
   </div>
  </div>
 </body>
</html>