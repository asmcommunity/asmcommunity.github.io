<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>design a listbox (Transparent Backround) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10257" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10257">design a listbox (Transparent Backround)</a></p>
   <div class="post" id="post-76980">
    <div class="subject"><a href="#post-76980">design a listbox (Transparent Backround)</a></div>
    <div class="body">Hey I want to make a listbox, which has TRANSPARENT Backround and uses green Text. I stored a listbox in my *.res (Dialog). Now i used this code to do what I want:<br /><br />.elseif uMsg == WM_CTLCOLORLISTBOX<br />    m2m myDC,wParam<br />    mov ecx,lParam<br />    RGB 0,255,0<br />    invoke SetTextColor,myDC,eax<br />    invoke SetBkMode,myDC,TRANSPARENT<br />    invoke GetStockObject,NULL_BRUSH<br />    return eax<br /><br />So, at the beginning everything seems to work well, but if I &quot;Drag 'n' Drop&quot; a file into listbox, then everything goes mad. One text writes onto another and when I marked one item then it stays Blue, even when I mark another one. Thats Shit!<br /><br />So can you tell me how to prevent of that. In my eyes, I tried nearly everything.<br /><br />thanx Flyke<br /><br /><br />P.S.: Here is my &quot;Drag 'n' Drop&quot;-code-event, maybe you need to solve my problem:<br /><br />.elseif uMsg == WM_DROPFILES<br />    invoke DragQueryFile,wParam,0,addr buffer1,128<br />    invoke SendDlgItemMessage,hwndDlg,ListBoxID,LB_GETCURSEL,0,0<br />    inc eax<br />    mov edx,eax<br />    invoke SendDlgItemMessage,hwndDlg,ListBoxID,LB_INSERTSTRING,edx,addr buffer1<br />    invoke SendDlgItemMessage,hwndDlg,ListBoxID,LB_SETCURSEL,edx,0<br /><br /><br /><br />-eof-</div>
    <div class="meta">Posted on 2003-01-18 05:04:28 by ChigpA</div>
   </div>
   <div class="post" id="post-77021">
    <div class="subject"><a href="#post-77021">design a listbox (Transparent Backround)</a></div>
    <div class="body"><pre><code>WM_DROPFILES&#58;<br />	...<br />	invoke	GetDlgItem, hwndDlg, ListBoxID<br />	invoke	RedrawWindow, eax, 0, 0, RDW_INVALIDATE</code></pre></div>
    <div class="meta">Posted on 2003-01-18 09:47:07 by comrade</div>
   </div>
  </div>
 </body>
</html>