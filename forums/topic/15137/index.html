<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Ntdll Help - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15137" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15137">Ntdll Help</a></p>
   <div class="post" id="post-117647">
    <div class="subject"><a href="#post-117647">Ntdll Help</a></div>
    <div class="body">I know this subject has been talked about before but i hope im going at another angle then others but it most likelly not and original idea..<br /><br />as you all know people ask all the time on how to load a dll directly from the exe with out a having to creating it as a file...<br /><br />I figure at some point in time the dll has to be loaded into memory and pointed to by an address...<br /><br />When you run LoadLibraryA it then runs<br />LoadLibraryExA and then LoadLibraryExW<br /><br />A is for testing the Ansi Strings namelly the dll dir and name... then<br />W for unicode testing of the Dir and dll name<br /><br />Then it Runs another api called LdrEnumerateLoadedModules which seems to point to the base address of 00400000<br /><br />eventually it runs the rest of these<br />LdrLoadDll<br />LdrProcessRelocationBlock<br />LdrQueryApplicationCompatibilityGoo<br />LdrQueryImageFileExecutionOptions<br />LdrQueryProcessModuleInformation<br />LdrRelocateImage<br /><br />the only problem im having is that these are mostly undocumented API's <br /><br />is there a place that does have them documented..</div>
    <div class="meta">Posted on 2003-09-10 04:56:05 by devilsclaw</div>
   </div>
   <div class="post" id="post-117652">
    <div class="subject"><a href="#post-117652">Ntdll Help</a></div>
    <div class="body">I think Matt Pietrek  had an article about that in an MSDN journal, maybe you can find a link to it on <a target="_blank" href="http://www.wheaty.net/">his site</a></div>
    <div class="meta">Posted on 2003-09-10 05:31:21 by Hiroshimator</div>
   </div>
   <div class="post" id="post-117684">
    <div class="subject"><a href="#post-117684">Ntdll Help</a></div>
    <div class="body">thanks i will take a look there..</div>
    <div class="meta">Posted on 2003-09-10 12:23:18 by devilsclaw</div>
   </div>
   <div class="post" id="post-118062">
    <div class="subject"><a href="#post-118062">Ntdll Help</a></div>
    <div class="body">Some of these api are documented on <a target="_blank" href="http://undocumented.ntinternals.net">undocumented.ntinternals.net</a><br />Often, it's not a real, full documentation as you could expect in msdn, but it could help.</div>
    <div class="meta">Posted on 2003-09-14 06:35:38 by Chrishka</div>
   </div>
   <div class="post" id="post-118105">
    <div class="subject"><a href="#post-118105">Ntdll Help</a></div>
    <div class="body">thanks.. thanks alot. i took a look at the site and it seems it might be what i was looking for...</div>
    <div class="meta">Posted on 2003-09-14 12:42:01 by devilsclaw</div>
   </div>
   <div class="post" id="post-118108">
    <div class="subject"><a href="#post-118108">Ntdll Help</a></div>
    <div class="body">this looks like what i need..<br /><br /><br />LdrLoadDll<br /><br /><br />NTSYSAPI <br />NTSTATUS<br />NTAPI<br />LdrLoadDll(<br /><br />  IN PWCHAR               PathToFile OPTIONAL,<br />  IN ULONG                Flags OPTIONAL,<br />  IN PUNICODE_STRING      ModuleFileName,<br />  OUT PHANDLE             ModuleHandle );<br /><br /><br /><br /><br /><br /><br />Flags<br />See WINAPI LoadLibraryEx for possibbilitied flags.<br /><br />ModuleHandle<br />Address of MZ header in virtual memory of caller's process.</div>
    <div class="meta">Posted on 2003-09-14 14:07:19 by devilsclaw</div>
   </div>
   <div class="post" id="post-118112">
    <div class="subject"><a href="#post-118112">Ntdll Help</a></div>
    <div class="body">Glad I could help you.</div>
    <div class="meta">Posted on 2003-09-14 14:14:21 by Chrishka</div>
   </div>
   <div class="post" id="post-118113">
    <div class="subject"><a href="#post-118113">Ntdll Help</a></div>
    <div class="body">yeah thanks again..</div>
    <div class="meta">Posted on 2003-09-14 14:15:32 by devilsclaw</div>
   </div>
  </div>
 </body>
</html>