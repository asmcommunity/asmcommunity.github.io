<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Base 7 Converter - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30687" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=30687">Base 7 Converter</a></p>
   <div class="post" id="post-215103">
    <div class="subject"><a href="#post-215103">Base 7 Converter</a></div>
    <div class="body">Hey,<br />I am writing an assembly program that take a decimal and converts it to base 7. It is not a requirement for it to be displayed back to the user in the correct order. The order can be backwards. So far I have this code...I am not sure where I am going wrong with it. Any ideas would be AWESOME!<br /><pre><code><br /><br />TITLE MASM Template&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (main.asm)<br /><br /><br />INCLUDE Irvine32.inc<br />.data<br /><br />base7 BYTE &quot;Base 7 (In reverse order) is &quot;,0<br /><br /><br />.code<br />main PROC<br /><br />call readdec<br /><br />mov edx,OFFSET base7<br />call WriteString<br /><br /><br /><br />mov bl, 7<br />begin1:<br />div bl<br /><br /><br />cmp ah,0<br />je theend<br />mov ax,ah<br />call writedec<br />mov ax,al<br />jmp begin1<br /><br />theend:<br />mov ax,ah<br />call writedec<br /><br />call crlf<br /><br />&nbsp; &nbsp; exit<br />main ENDP<br /><br />END main<br /></code></pre><br /><br />I understand what I need to do...I need to divide, check if the remainder is 0, print out the remainder, and then move the quotient into eax to start the process over again. <br /><br />What I&#039;m having trouble with is understading how to mov the registars to eax so that they can be displayed back to the user using the &quot;call writedec&quot; function. I am also new to the syntax of things, so bear with me in stupid little mistakes.<br /><br />Thanks in advance everyone!<br /><br />-Mallard</div>
    <div class="meta">Posted on 2011-09-28 19:57:29 by msmallard</div>
   </div>
   <div class="post" id="post-215104">
    <div class="subject"><a href="#post-215104">Re: Base 7 Converter</a></div>
    <div class="body"><div class="quote">What I&#039;m having trouble with is understading how to mov the registars to eax so that they can be displayed back to the user using the &quot;call writedec&quot; function.</div>Don&#039;t be afraid to use other registers such as esi edi ebp, AFAIK irvine32 library functions preserve all registers. If that is not enough there is always STACK. PUSH and POP - LIFO.<br /><br /><pre><code>	call readdec<br />	mov edx,OFFSET base7<br />	call WriteString<br />	mov ebx,eax<br />	mov ecx,7<br />do:	<br />	mov eax,ebx<br />	xor edx,edx; requirement for div, high dword of EDX:EAX = 0 <br />	div ecx<br />	mov ebx,eax<br />	mov eax,edx<br />	call writedec<br />	call crlf<br />	or ebx,ebx<br />	jnz do</code></pre><br />	<pre><code>	call readdec<br />	mov edx,OFFSET base7<br />	call WriteString<br />	mov ecx,7<br />do:	<br />	xor edx,edx <br />	div ecx<br />	push edx; preserving edx not needed, but we&#039;ll do it anyway<br />	push eax<br />	mov eax,edx<br />	call writedec<br />	call crlf<br />	pop eax<br />	pop edx; <br />	or eax,eax<br />	jnz do<br /><br /></code></pre><br /><br /></div>
    <div class="meta">Posted on 2011-09-29 10:25:03 by drizz</div>
   </div>
   <div class="post" id="post-215105">
    <div class="subject"><a href="#post-215105">Re: Base 7 Converter</a></div>
    <div class="body">You&#039;ve got some &quot;fairly serious&quot; errors in your code, as posted:<br /><pre><code><br />...<br />mov ax,ah<br />...<br />mov ax,al<br />...<br />mov ax,ah<br /></code></pre><br />These instructions don&#039;t exist! I think you&#039;ll find that your assembler burps up an error message when you try it. Changing &quot;mov&quot; to &quot;movzx&quot; would work, but may not be the way you want to do it. Study the code Drizz posted!<br /><br />&quot;div&quot; is kind of a &quot;funny&quot; instruction, in that the two operands are not the same size...<br /><pre><code><br />div bl<br /></code></pre><br />divides a 16-bit number (ax) by an 8-bit number (bl), and puts the quotient in al and the remainder in ah.<br /><pre><code><br />div ebx<br /></code></pre><br />divides the 64-bit number edx:eax (edx times 4G + eax) by ebx, and puts the quotient in eax and the remainder in edx.<br /><br />If ah or edx are not zero before the &quot;div&quot;, you&#039;ll get unexpected results. If the result won&#039;t fit into the destination (which would happen if ah &gt;= bl or edx &gt;= ebx) it causes a CPU exception. This used to be reported as &quot;division by zero error&quot; (What? I didn&#039;t divide by zero!). In Linux, it&#039;s reported as &quot;floating point error&quot; (What? I didn&#039;t use any floating point!). This is a common beginner error, and can be very confusing!<br /><br />Note that Drizz does:<br /><pre><code><br />xor edx, edx<br /></code></pre><br />just before the &quot;div&quot;. That&#039;s why!<br /><br />You&#039;ve got the general idea right... pretty near...<br /><div class="quote"><br />I understand what I need to do...I need to divide, check if the remainder is 0, print out the remainder, and then move the quotient into eax to start the process over again.<br /></div><br />Actually, you don&#039;t care if the remainder is zero or not - you want to print it either way. When the quotient is zero, you&#039;re done.<br /><br />Good start... carry on!<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="meta">Posted on 2011-09-29 14:02:13 by fbkotler</div>
   </div>
   <div class="post" id="post-215110">
    <div class="subject"><a href="#post-215110">Re: Base 7 Converter</a></div>
    <div class="body">Hey guys...So I got base 7 to work with both of you helping me. Your hints helped alot!!!<br /><br /><br /><br />Here&#039;s the finished product<br /><br /><pre><code><br />; There is some more stuff above this but this is the main block where the magic happens :D<br /><br />call crlf<br /><br />mov edx,OFFSET base7<br />call WriteString<br /><br /><br />mov bl, 7<br />mov eax,var<br /><br /><br />start123:<br />div bl<br /><br />mov cl,al ; quotient<br />mov ch,ah ; remainder<br /><br />cmp al,0<br />je done123<br /> mov eax, 0<br />mov al,ch<br />call WriteDec<br />mov al,cl<br />jmp start123<br /><br />done123:<br />mov eax,0<br />mov al,ch<br />call WriteDec<br />mov al,cl<br />call WriteDec<br /><br />call crlf<br /><br /><br />&nbsp; &nbsp; exit<br />main ENDP<br /><br />END main<br /><br /></code></pre><br /><br />Thanks guys!!! I am enjoying assembly code much much more than any other language I&#039;ve encountered. It&#039;s quite enjoyable!<br /><br />P.S. This program prints it backwards. This presents my next little project :D<br /><br />-Mallard</div>
    <div class="meta">Posted on 2011-09-30 12:34:47 by msmallard</div>
   </div>
   <div class="post" id="post-215114">
    <div class="subject"><a href="#post-215114">Re: Base 7 Converter</a></div>
    <div class="body">I&#039;m not sure this is quite &quot;right&quot;. After you exit the loop, you print the last remainder, which is correct, and then you print the quotient. Do you want to do that? If you enter 7, and convert it to base 7, it should print &quot;10&quot;, right? (&quot;01&quot;, since they&#039;re reversed) Don&#039;t you get &quot;010&quot;? Does no harm, I guess. You can save one (slow) &quot;div&quot; by comparing the quotient to the base (instead of zero), and exiting the loop - in that case, you&#039;d want to print the quotient.<br /><br />&quot;irvine32.inc&quot; is for Windows, of course, but there&#039;s a &quot;port&quot; of it to Linux, which I&#039;ve downloaded but haven&#039;t tried. Maybe I will... I could be wrong about the extra digit.<br /><br />In any case, to reverse the output, note that Drizz says that the stack is a &quot;LIFO&quot; (last in, first out) structure. This can be useful! Push &#039;em as you get &#039;em, and then pop &#039;em off and print &#039;em... There are other ways to do it, but that&#039;s an &quot;easy&quot; way.<br /><br />Best,<br />Frank<br /><br /><br /></div>
    <div class="meta">Posted on 2011-10-01 08:03:04 by fbkotler</div>
   </div>
  </div>
 </body>
</html>