<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Hooking advice needed - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9102" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9102">Hooking advice needed</a></p>
   <div class="post" id="post-66922">
    <div class="subject"><a href="#post-66922">Hooking advice needed</a></div>
    <div class="body">Hi there!<br />I need some advice here.<br />I have to code an app which will hook the file system activity, and since i?m a little bit out of practice i?d like to have some advice on different possible methods.<br />It?s a quick &amp; dirty thing so no state-of-the art is needed. By this i mean that i?d like to avoid low level drivers and the such. Maybe API hooking? All i need to do is to hook WriteFile globally i guess.<br />Any link/pointer?<br />Thanks!<br /><br /><br />Latigo</div>
    <div class="meta">Posted on 2002-11-22 11:06:57 by latigo</div>
   </div>
   <div class="post" id="post-66947">
    <div class="subject"><a href="#post-66947">Hooking advice needed</a></div>
    <div class="body">I'm not sure how much of a help this will be to you (since I don't know offhand what method(s) they used), but hasn't the source for filemon been released?</div>
    <div class="meta">Posted on 2002-11-22 13:42:33 by Will</div>
   </div>
   <div class="post" id="post-66957">
    <div class="subject"><a href="#post-66957">Hooking advice needed</a></div>
    <div class="body">There are some methods to do what you want to do. 9x uses DOS to do a lot off things (Yes, 9x use int 21h). You must search info about VxDCall. It is an undocumented function of kernel. Maybe you know about that. So, you want some links. Here is an interesting one:<br /><br /><br /><a target="_blank" href="http://oralse.cx">http://oralse.cx</a><br /><br />Just a comment: Use it well.<br /><br /><br /><strong>No virii links here! - bazik</strong></div>
    <div class="meta">Posted on 2002-11-22 15:19:18 by Kecol</div>
   </div>
   <div class="post" id="post-66979">
    <div class="subject"><a href="#post-66979">Hooking advice needed</a></div>
    <div class="body">Thanks very much guys, but that?s just the type of thing i was trying to avoid :)<br />I?m looking for a more ?superficial? approach.<br />Thanks again.<br /><br />Latigo</div>
    <div class="meta">Posted on 2002-11-22 18:11:48 by latigo</div>
   </div>
   <div class="post" id="post-67040">
    <div class="subject"><a href="#post-67040">Hooking advice needed</a></div>
    <div class="body">Hi Latigo,<br /><br />If you're interested in API hooking maybe take a look at <a target="_blank" href="http://mitglied.lycos.de/yoda2k/snippets/MsgHack.zip">this</a> program by y0da with source. It shows you how to hook MessageBoxA, but it's in C. It's not too hard to write your own routine to modify IAT entries, I can attach one I wrote if you like. There's also <a target="_blank" href="http://www.codeguru.com/dll/apihijack.shtml">APIHijack</a> but I've found it a little buggy.<br /><br />If you want to see what files programs are accessing though, may I suggest <a target="_blank" href="http://www.sysinternals.com/ntw2k/source/filemon.shtml">filemon</a>, I've found it very useful for this. Will, you are right, the filemon source is available on the website.<br /><br />-stormix</div>
    <div class="meta">Posted on 2002-11-23 07:26:01 by stormix</div>
   </div>
   <div class="post" id="post-67315">
    <div class="subject"><a href="#post-67315">Thanks!</a></div>
    <div class="body">Thanks Dude!<br /><br />Latigo</div>
    <div class="meta">Posted on 2002-11-25 03:45:11 by latigo</div>
   </div>
  </div>
 </body>
</html>