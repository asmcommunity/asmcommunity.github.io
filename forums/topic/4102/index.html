<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>using MASM with c++ - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4102" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4102">using MASM with c++</a></p>
   <div class="post" id="post-28024">
    <div class="subject"><a href="#post-28024">using MASM with c++</a></div>
    <div class="body">hello, <br /><br />i'm new to this. well, not completely new, but my knowledge is too limited  to solve my problem.<br /><br />i have a working win32 c++ program which works fine, but i need a fast calculating routine.<br /><br />so i wrote an assembler procedure for testing purposes which should be called from the c++ program.<br /><br />here's the *.asm-file:<br /><br />===========================================================<br />.386<br />.387<br />.model flat, stdcall<br />option casemap:none<br /><br />ASMPROC proto STDCALL<br /><br />.data<br />PUBLIC dummy <br />dummy DWORD 66 <br /><br /><br />.code<br />start:<br /><br />ASMPROC PROC<br /><br /> LOCAL test:DWORD<br /><br /> mov eax, <br /> sub eax, 06h<br /> mov , eax    <br /><br /> ret<br />ASMPROC ENDP<br /><br />END start<br />===========================================================<br /><br /><br /><br />ok, i got the object-file and included in my c++-projekt, which has the following lines of code at the beginning:<br /><br /><br />===========================================================<br /><br />...<br />extern void STDCALL ASMPROC(void);<br />...<br /><br />===========================================================<br /><br /><br />it doesn't work when i try to call ASMPROC(), gives an undefined reference.<br /><br />i'm desperate...please help<br />thank you</div>
    <div class="meta">Posted on 2002-03-09 08:17:02 by 08/15</div>
   </div>
   <div class="post" id="post-28027">
    <div class="subject"><a href="#post-28027">using MASM with c++</a></div>
    <div class="body">You could try to use inline assembler like this:<br /><br />__asm {<br />some code<br />}<br />or<br />__asm xor eax, eax<br /><br /><br />and you must have ml.exe in your bin directory.</div>
    <div class="meta">Posted on 2002-03-09 08:30:10 by ante</div>
   </div>
   <div class="post" id="post-28028">
    <div class="subject"><a href="#post-28028">using MASM with c++</a></div>
    <div class="body">i should have mentioned that i'm using Dev-C++ and mingW-compiler.<br /><br />you're right, but really want to keep the asm stuff separate from the c++ code. so i decided to link the object files together (btw, it works for just accessing data).<br /><br />thx for your idea!</div>
    <div class="meta">Posted on 2002-03-09 08:40:39 by 08/15</div>
   </div>
   <div class="post" id="post-28033">
    <div class="subject"><a href="#post-28033">Hello 08/15</a></div>
    <div class="body">Using Masm with C++  I learned here, I use Visual C++ though<br />but maybe you will find enough info here in this post<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=2891">http://www.asmcommunity.net/board/index.php?topic=2891</a><br /><br />I started the post, and make a search using my user name for more,<br /><br />I hope you can glue the pieces together with this info, to use Masm with C++<br /><br />Andy</div>
    <div class="meta">Posted on 2002-03-09 09:35:07 by andy981</div>
   </div>
   <div class="post" id="post-28036">
    <div class="subject"><a href="#post-28036">using MASM with c++</a></div>
    <div class="body">thx very much:grin: <br />looks very promising, i'll try it that way<br /><br />andy, what do all those options mean?<br />like /Z and stuff</div>
    <div class="meta">Posted on 2002-03-09 10:06:25 by 08/15</div>
   </div>
   <div class="post" id="post-28155">
    <div class="subject"><a href="#post-28155">using MASM with c++</a></div>
    <div class="body">it works now, thanks again.<br /><br />one question remains: how do i let an ASM-proc return a value?<br /><br /><br />:stupid:</div>
    <div class="meta">Posted on 2002-03-10 09:06:28 by 08/15</div>
   </div>
   <div class="post" id="post-28161">
    <div class="subject"><a href="#post-28161">using MASM with c++</a></div>
    <div class="body">I think the return value should be in eax.<br />So you could try to just move it to eax</div>
    <div class="meta">Posted on 2002-03-10 10:13:53 by ante</div>
   </div>
  </div>
 </body>
</html>