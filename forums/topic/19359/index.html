<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Sniffing without WSAIoctl()? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19359" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19359">Sniffing without WSAIoctl()?</a></p>
   <div class="post" id="post-149381">
    <div class="subject"><a href="#post-149381">Sniffing without WSAIoctl()?</a></div>
    <div class="body">It has always bothered me that I have to have administrator privelages to use WSAIoctl() given SIO_RCVALL to sniff all inbound/outbound packets. Is there any alternative to sniff without using this function? Thanks.</div>
    <div class="meta">Posted on 2004-09-08 14:05:42 by ben</div>
   </div>
   <div class="post" id="post-149421">
    <div class="subject"><a href="#post-149421">Sniffing without WSAIoctl()?</a></div>
    <div class="body">You could try hooking up these APIs<br /><br /><ul><br />[*]send<br />[*]sendto<br />[*]recv<br />[*]recvfrom<br />[*]WSASend<br />[*]WSASendTo (not sure)<br />[*]WSARecv<br />[*]WSARecvFrom (not sure)<br /></div>
    <div class="meta">Posted on 2004-09-09 07:07:25 by Nildo</div>
   </div>
   <div class="post" id="post-149458">
    <div class="subject"><a href="#post-149458">Sniffing without WSAIoctl()?</a></div>
    <div class="body">I don't think you'll be able to do that without administrator privileges, either :P When you think about it, there's nothing illogical about that requirement. Imagine what would happen if people visiting a school library could install a program that sniffs packets going to and fro when other users log on to the machine.<br /><br />I don't quite understand why you need to sniff packets on a machine that isn't owned by the user of the program, though. If there are ways to do that, they are most likely the consequence of programming errors, and they may not be consistent across operating system versions.</div>
    <div class="meta">Posted on 2004-09-09 12:00:33 by Sephiroth3</div>
   </div>
   <div class="post" id="post-149463">
    <div class="subject"><a href="#post-149463">Sniffing without WSAIoctl()?</a></div>
    <div class="body">Hooking winsock won't give you the same as raw sockets... and as Sephiroth says, there's a reason admin access is required. If you don't like this, and have a legitimate need for non-admin raw sockets, install a system service that allows apps from other users to register with it and let it handle the raw I/O.</div>
    <div class="meta">Posted on 2004-09-09 12:15:50 by f0dder</div>
   </div>
   <div class="post" id="post-149491">
    <div class="subject"><a href="#post-149491">Sniffing without WSAIoctl()?</a></div>
    <div class="body"><div class="quote">I don't think you'll be able to do that without administrator privileges, either :P When you think about it, there's nothing illogical about that requirement. </div><br />Under most circumstances you're right, but my friends dorm has computers supplied by the school in each room and none of them have admin for some reason. Since he's pursuing a CS major, it seems a little nonsensical to be restricted this much.  :? <br /><br />Thanks for the info.</div>
    <div class="meta">Posted on 2004-09-09 17:01:26 by ben</div>
   </div>
   <div class="post" id="post-149539">
    <div class="subject"><a href="#post-149539">Sniffing without WSAIoctl()?</a></div>
    <div class="body">Okay, then maybe he could ask the dude in charge of the computers to set him up, or if he can't be bothered, your friend could just reinstall Windows.</div>
    <div class="meta">Posted on 2004-09-10 11:32:22 by Sephiroth3</div>
   </div>
  </div>
 </body>
</html>