<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Indexing and Looping Problems - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19915" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19915">Indexing and Looping Problems</a></p>
   <div class="post" id="post-152861">
    <div class="subject"><a href="#post-152861">Indexing and Looping Problems</a></div>
    <div class="body">My program has 3 problems. First, I take two address and loop for each address.<br /><pre><code><br />.DATA<br />temp		BYTE	&quot;badaasdfasdf&quot;,0<br />temp2		BYTE	&quot;adaasdfasdfasd&quot;,0<br />temp3		BYTE	&quot;daadfasdfasdfas&quot;,0<br /><br />.CODE<br />lea eax, temp<br />lea ebx, temp3<br /></code></pre><br /><br />I tried adding 01h to eax until it's greater than ebx. I tried adding 010h. I tried subtracting the two and then adding one. I either get 2 address (by adding the 010h), or a I many. Is there a way to just get the three?<br /><br /><br />The next problem is, I take a pushed address, like ebx, and I want the first 16 bytes. I take  and push it for another proc, then I want the next byte. I tried adding 4 to eax, adding 1, and shifting right 4. Nothing works. It just crashes.<br /><br /><br />The last problem is very close to the second problem. Instead of push , I want to print it, but only if only certain characters. I take my variable used for ouput and lea into ecx. I want to compare the value at ebx and make sure it's a good character, then move it into the output variable. I have the ouput part working with another program, but not with this one. I can't test it with this one because I need to fix problem 2 before this would work. I still can't loop through ebx. The way the output thing works is, I mov al,  then mov BYTE PTR , al. Then, I add 2 to output, so when it prints, there is a space between each character.<br /><br />Anyone know what my looping problems are?</div>
    <div class="meta">Posted on 2004-11-13 20:30:55 by sjaguar13</div>
   </div>
   <div class="post" id="post-152862">
    <div class="subject"><a href="#post-152862">Indexing and Looping Problems</a></div>
    <div class="body">Hopefully, I have made good assumptions about your goals.  Please, provide more info if I'm too far off track...<br /><br />1) There is no concept of FOR EACH in assembly - you have to construct it. This is one possible implementation using string pointers:<br /><pre><code>.DATA<br />temp0    BYTE   &quot;badaasdfasdf&quot;,0 <br />temp1    BYTE   &quot;adaasdfasdfasd&quot;,0 <br />temp2    BYTE   &quot;daadfasdfasdfas&quot;,0 <br /><br />MyList \<br />    DWORD OFFSET temp0<br />    DWORD OFFSET temp1<br />    DWORD OFFSET temp2<br />;   DWORD OFFSET tempN ; as many as you want...<br />    DWORD 0<br /><br />.CODE<br />    lea ebx, MyList<br />ForEach&#58;<br />    mov eax, &#91;ebx&#93;<br />    add ebx, 4<br />    test eax, eax<br />    je Exit<br />.<br />.  ; do the stuff with string in EAX<br />.<br />    jmp ForEach<br />Exit&#58;</code></pre>2) Have to add 16 to EBX to get the bytes after the 16. Don't shift an address in a register - it has no meaning.<br /><br />3) You should have this one solved now.</div>
    <div class="meta">Posted on 2004-11-13 20:47:23 by bitRAKE</div>
   </div>
   <div class="post" id="post-152869">
    <div class="subject"><a href="#post-152869">Indexing and Looping Problems</a></div>
    <div class="body">Thanks for the reply! The MyList thing works perfectly! I do have a question, though. What does test eax, eax do? They are equal, so wouldn't it always jump?<br /><br />The adding 16 is a bit confusing. I added it and the loop worked, it printed out 16 numbers, but they weren't the right numbers.<br /><br /><pre><code><br />.DATA <br />temp0    BYTE   &quot;badaasdfasdf&quot;,0 <br />temp2    BYTE   &quot;adaasdfasdfasd&quot;,0<br /></code></pre><br />With that, I take 'b' and push it into a convert-to-hex proc. I tested that proc several times, and it works. I only get the first number, or sometimes the first four numbers right in hex. The remaining 12 is usually 00 with some random stuff in the middle.<br /><br />The second part should print out the characters themselves, but just the first 16. Adding 16 to it prints out everything.<br /><br />I should get:<br />62 61 64 61 61 73 64 66 61 73 64 66  00 00 00 00 badaasdfasdf<br /><br />00 00 00 00  can be anything, whatever is left in memory. If I had &quot;1111111122222222333333334444444455555555&quot; I should get:<br />31 31 31 31 31 31 31 31 32 32 32 32 32 32 32 32 1111111122222222<br /><br />For my print loop, I mov 16 into ecx, print , add eax, 16, and then loop. That would prints:<br />31 33 35 61 66 20 00 00 00 00 00 00 00 03 00 00 111111112222222233333333444444445555555533333333444444445555555555555555asdfasdfasdfas<br /><br />Hopefully that made it a little more clear. Maybe your code does do that, but my other code is what's messed up.</div>
    <div class="meta">Posted on 2004-11-14 02:06:14 by sjaguar13</div>
   </div>
   <div class="post" id="post-152872">
    <div class="subject"><a href="#post-152872">Indexing and Looping Problems</a></div>
    <div class="body">TEST is <u>exactly</u> like AND - <u>except</u> the result is not kept.  Basically, it is a quick way to test for zero because the processor can take advantage of the result not needing to be stored. ( :idea: Similarly, CMP is <u>exactly</u> like SUB.)<br /><br />Yes, we are in agreement on the rest. Seeing a larger section of your code would be the only way to diagnose further.</div>
    <div class="meta">Posted on 2004-11-14 03:38:07 by bitRAKE</div>
   </div>
   <div class="post" id="post-152905">
    <div class="subject"><a href="#post-152905">Indexing and Looping Problems</a></div>
    <div class="body"><pre><code><br />lineBuffer proc<br />		push ebp		;saving ebp<br />		mov ebp, esp		;copy stack pointer<br />		pushad			;push registers<br />		mov eax, &#91;ebp+8&#93;	;address<br />		mov ebx, eax		;make copy<br /><br />		push eax		;push address<br />		call hexDWPrint		;convert address to hex<br /><br />		mov ecx, 16		;mov 16 into ecx for looping<br />theLoop&#58;	push &#91;eax&#93;		;this is 1 byte in the address pushed<br />		call hexBPrint		;converts that byte to hex<br /><br />goodchar&#58;	add eax, 16		;next byte<br />		loop theLoop		;loop for 16 times<br />		<br />		output bracket1		;print &#91;<br /><br />		mov ecx, 16		;mov 16 into ecx for looping<br />printer&#58;	output &#91;ebx&#93;		;print the character<br />		add ebx, 16		;next byte<br />		loop printer		;loop until 16 characters are printed<br /><br />		output bracket2		;output &#93;<br />		<br /><br />		popad			;pop registers<br />		pop ebp			;retrive ebp<br />		ret 4			;return 4<br /><br />lineBuffer endp<br /><br /><br /><br /><br /><br />hexBPrint proc<br />		push 	ebp		;saving ebp<br />		mov 	ebp, esp	;copy stack pointer<br />		pushad			;push registers<br />		mov 	eax, &#91;ebp+8&#93;	;ascii character<br /><br />            	lea    ebx,dum+1     	; address for last character<br />            	mov    ecx,2            ; number of characters<br />forCount&#58;   	mov    edx,eax          ; copy pattern<br />            	and    edx,0fh   	; zero all but last hex digit<br />            	cmp    edx,9            ; digit?<br />            	jnle   elseLetter       ; letter if not<br />            	or     edx,30h          ; convert to character<br />            	jmp    endifDigit<br />elseLetter&#58; 	add    edx,'A'-10       ; convert to letter<br />endifDigit&#58;<br />            	mov    BYTE PTR &#91;ebx&#93;,dl; copy character to memory<br />            	dec    ebx              ; point at next character<br />            	shr    eax,4            ; shift one hex digit right<br />            	loop   forCount         ; repeat<br /><br />		output dum		;output byte in hex<br /><br /><br />		popad			;pop registers<br />		pop ebp			;retrive ebp<br />		ret 4			;return 4<br />hexBPrint endp<br /></code></pre><br /><br />One address from MyList is pushed and then lineBuffer is called.</div>
    <div class="meta">Posted on 2004-11-14 11:10:43 by sjaguar13</div>
   </div>
  </div>
 </body>
</html>