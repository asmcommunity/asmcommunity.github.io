<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Project Builder 2.1 release - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13964" />
    <link rel="next" href="../?id=13964&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=24">IDE usage &amp; development</a> &raquo; <a href="../?id=13964">Project Builder 2.1 release</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=13964&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=13964&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="13964" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=13964&amp;page=2">&gt;</a><a href="../?id=13964&amp;page=2">&raquo;</a></form>   <div class="post" id="post-107912">
    <div class="subject"><a href="#post-107912">Project Builder 2.1 release</a></div>
    <div class="body">A few weeks ago i posted with version 2.0 of Project Builder (PB), well i've struggled (around exams and other minor obstacles) to produce the next version and here it is: version 2.1 I've added a dialog to allow you to edit the way it builds the project without having to fiddle with PInfo.dat. The last version couldn't deal with files from outside of the project folder - thats been fixed. Additionally it can now handle files with the same &quot;stem&quot; ie since 'pb2.asm' and 'pb2.rc' both build to 'pb2.obj', it just overwrote one before - this is now fixed. I've also commented it a bit better - as it was a mess before.<br /><br />Unfortunately it can still only deal with MASM files, as i have not a clue as to how to use anything else. However, it has a small problem with creating Libraries (.LIB) when the commandline becomes large - it seems that lib.exe cannot handle long command lines - any suggestions for dealing with that?<br /><br />Whilst writing PB, i noticed something that i felt could be added to RadASM: PB became rather large as i wrote it and so i closed up all the procedures - great feature btw. But as i continued i found that closing 50 odd procedures was rather time consuming. So it would be great if there was some feature to make them all close up (if there isn't one already)<br /><br />Heres the source/DLL etc. If you find any bugs, let me know - it hasn't been tested too thoroughly yet.<br /><br />Ossa<br /><br />Edit:<br /><br />100 downloads. Attachment deleted. New upload on next page.</div>
    <div class="meta">Posted on 2003-06-22 14:51:12 by Ossa</div>
   </div>
   <div class="post" id="post-107915">
    <div class="subject"><a href="#post-107915">Project Builder 2.1 release</a></div>
    <div class="body">Hi Ossa<br /><br />Nice PB.<br />To close all procs hit Alt+Ctrl+PgUp or click one of the three buttons in lower left corner of edit window.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-06-22 15:12:25 by KetilO</div>
   </div>
   <div class="post" id="post-108679">
    <div class="subject"><a href="#post-108679">How does BP2 work</a></div>
    <div class="body">Hi Ossa,<br /><br />I am trying to checkyour adding, but I am not able. Can you explain me how does it work.<br /><br />I have read your readme.txt but I do not know how to fill the diferents fields it show me without crash it.<br /><br />Thank you very much indeed.<br />ipadilla</div>
    <div class="meta">Posted on 2003-06-29 11:48:41 by ipadilla</div>
   </div>
   <div class="post" id="post-108801">
    <div class="subject"><a href="#post-108801">Project Builder 2.1 release</a></div>
    <div class="body">ipadilla,<br /><br />do you mean adding binaries, adding source files to binaries or adding source files?<br /><br />if you mean adding source files, type in the path (or relative path) in the box or use the ... button to use the dialog to get it. Then click Add or what ever.<br /><br />Sorry i can not be more helpful, but my computer is not working at the moment, so i can't check out what you mean... i will try to give a more comprehensive answer when i can<br /><br />Ossa</div>
    <div class="meta">Posted on 2003-06-30 11:46:17 by Ossa</div>
   </div>
   <div class="post" id="post-108811">
    <div class="subject"><a href="#post-108811">pb2</a></div>
    <div class="body">Hi Ossa,<br /><br />Thank you very much, you are very kind. <br />Take all the time you need, I am nor in a harry.<br />I`ll try again.<br /><br />ipadilla</div>
    <div class="meta">Posted on 2003-06-30 12:44:36 by ipadilla</div>
   </div>
   <div class="post" id="post-109022">
    <div class="subject"><a href="#post-109022">Project Builder 2.1 release</a></div>
    <div class="body">Hi Ossa,<br /><br />Could you email me a couple of paragraphs about your addin to include in the help file?</div>
    <div class="meta">Posted on 2003-07-02 09:44:33 by donkey</div>
   </div>
   <div class="post" id="post-109176">
    <div class="subject"><a href="#post-109176">Project Builder 2.1 release</a></div>
    <div class="body">Hi donkey,<br /><br />Yeah i can do that - just give me a while to sort my computer out. Its completely messed up.<br /><br />btw. Just a general thing: Don't try to use PB to make LIBs - its completely screwed up, i'll try to fix it soon (maybe at the week end)<br /><br />Ossa</div>
    <div class="meta">Posted on 2003-07-03 13:27:14 by Ossa</div>
   </div>
   <div class="post" id="post-109256">
    <div class="subject"><a href="#post-109256">Project Builder 2.1 release</a></div>
    <div class="body">HI, could anyone tell me why the following might not work:<br /><br /><pre><code><br />; ****************************************<br />; returns whether a project is open or not<br />; ****************************************<br /><br />IsProjectOpen PROC<br /><br />	; =====================================<br />	; Check appropriate member of ADDINDATA<br />	; =====================================<br /><br />	mov edx, lpDStruct<br />	mov eax, &#91;edx&#93;&#91;ADDINDATA.fProject&#93;<br />	ret<br />IsProjectOpen ENDP<br /></code></pre><br /><br />the lpDStruct is global and was set in the InstallDLL procedure:<br /><br /><pre><code><br />	invoke SendMessage, hWin, AIM_GETDATA, 0, 0<br />	mov lpDStruct, eax<br /></code></pre><br /><br />The function seems not to work all of the time, but i seem unable to define eactly <em>when</em>  this happens<br /><br />I guess it could be something to do with the rest of the code, but i can't fiind anything. Any suggestions?<br /><br />Ossa</div>
    <div class="meta">Posted on 2003-07-04 15:15:11 by Ossa</div>
   </div>
   <div class="post" id="post-109257">
    <div class="subject"><a href="#post-109257">Project Builder 2.1 release</a></div>
    <div class="body">I don't use that syntax so I'm not sure but try this:<br /><br />mov edx, lpDStruct<br />mov eax, .ADDINDATA.fProject</div>
    <div class="meta">Posted on 2003-07-04 15:28:50 by donkey</div>
   </div>
   <div class="post" id="post-109258">
    <div class="subject"><a href="#post-109258">Project Builder 2.1 release</a></div>
    <div class="body">Thnx donkey,<br /><br />I will try that.<br /><br />The problem only occurs very rarely, so it will be a day or so before it will have been tested enough to say whether it works.<br /><br />Ossa</div>
    <div class="meta">Posted on 2003-07-04 15:32:48 by Ossa</div>
   </div>
   <div class="post" id="post-109365">
    <div class="subject"><a href="#post-109365">Project Builder 2.1 release</a></div>
    <div class="body">Hi donkey,<br /><br />I decided that it would be best for this to be in a FAQ/HowTo type format, hope this is ok. I am posting it here as it will answer ipadilla's question at the same time<br /><br />I have also got a few more known issues:<br />- The LIB builder doesn't really build libs properly<br />- If you press OK, but have not fulfilled some requirement and cause the dialog to complain somehow, then press cancel, then go back into the dialog, some of the data will have been deleted<br />- The build will not work unless you have recreated the source directory structure in the build directory<br />- Clicking &quot;OK&quot; when a binary does not have name will cause RadASM to exit with PB giving a warning<br />- Sometimes the dialog will not recognise that a file is from inside the project directory and will give the full path instead<br />- Sometimes when a project open, PB seems to think that there is no project open &amp; will not let the project be built<br />- Sometimes the project will not build at all, but when RadASM (and therefore PB) is closed and reopened, it builds fine<br /><br />I suspect that the last 3 issues are connected, and am currently looking into why they occur (with little success).<br /><br />The first 4 issues are being dealt with, and will be fixed shortly (will be inthe next release).<br /><br />------------------------------------------------------<br /><br />What is PB?<br />- PB stands for Project Builder<br />- It is an AddIn for KetilO's RadASM<br />- You can use it to build projects with one or many source files that produce 1 or many binary files.<br />- It can create binaries of types LIB, DLL and EXE (both Windows and Console)<br />- It currently only supports MASM, but this will hopefully be changed soon<br /><br />How do i get PB to build my projects?<br />- First you must setup the project building options (see below)<br />- Then all you have to do, is simply click on the &quot;PB: Build Projects&quot; menu item in the &quot;Project&quot; menu in RAdASM, when you have the appropriate project open<br />- The output from the Build will then appear in the output window.<br />- Any errors will cause the build to stop with that file<br />- You can then double click on the errors to get RadASM to take you to the postion of the error in your code<br /><br />How do i set up the project options?<br />- First, you must have a project created and open in RadASM<br />- Then select the &quot;PB: Edit Project Settings&quot; item in the &quot;Project&quot; menu of RadASM<br />- Next you must add the source files to the project (see below)<br />- The binaries must then be setup/added (see below)<br />- Finaly, just click OK<br /><br />How do i add source files to my project?<br />- Unfortunately, currently source files must be added one at a time<br />- To add a source file:<br />- Either type in the file name in the &quot;File Name&quot; box in the &quot;Add File&quot; section, or click the &quot;...&quot; button to get the &quot;Select source file&quot; dialog, where you can select any file that you want<br />- When entering the source file names by hand, if the file is in the project directory, only the path relative to the project directory is needed. However,if it is outside this directory, a fully qualified path is required (eg C:\Projects\QuickProjects\LHT\Src\Hash.asm)<br />- Next, click the &quot;Add File&quot; button<br />- The file will then appear in the list box to the left<br /><br />How do i remove source files from the build?<br />- Simply select the file that you want to remove in the listbox and then click on the &quot;Delete File&quot; button (no, this does not delete the file from you HDD)<br />- A note should be made that if you remove a source file, but leave it as part of the source for one of the binaries, when you come to click &quot;OK&quot;, the dialog will inform you that this has happened and willnot let you exit using &quot;OK&quot; untilyou have fixed this problem<br /><br />How do i add a new binary to the project?<br />- Just click the &quot;Add Binary&quot; button at the bottom of the dialog<br /><br />How do i remove a binary from the project?<br />- make sure that the tab you have selected is the one that you want to delete, then click on the &quot;Delete Binary&quot; button<br />- note that there must be at least one binary in a project<br /><br />How do i setup a binary?<br />- This depends a lot on what sort of binary you want to create, but some parts are common to all, for the specific parts, see below the &quot;common&quot; section below:<br />+ Common:<br />  # You must enter a name for the binary in the &quot;Binary Name (NO Extension)&quot; field (and as you may guess, don't add the extension (eg .lib) here)<br />  # You must add all of the source files needed for this binary to the source file list (above) and thenuse thatto add them to the binary source list:<br />    &gt; See above to add source files to the project<br />    &gt; To add the source files to the binary, they must be added one by one.<br />    &gt; Select the file that you want to add in the source file list at the top of the dialog<br />    &gt; Then press the &quot;Add Source File&quot; button<br />    &gt; Repeat this until all the source files are added<br />  # The output sub directory must be set, this field can be blank in which case, it will appear in the project directory, or it can specify the subdir where the binary will be placed when built (this MUST be ended with a '\' character)<br />  # Type: this is the type of binarythat you want to create (its a drop down box, just select the one that you want)<br />+ Windows EXE:<br />  # no other fields are required, although the &quot;extra switches&quot; field can be used, the current commandline looks like this:<br />    \masm32\bin\Link /OUT:&lt;Output EXE File/Path&gt; /nologo /MACHINE:IX86 /INCREMENTAL:YES /SUBSYSTEM:WINDOWS &lt;Extra Switches&gt; &lt;Input OBJ File/Path List&gt;<br />+ Console EXE:<br />  # Basically the same as the windows EXE, the current commandline is:<br />    \masm32\bin\Link /OUT:&lt;Output EXE File/Path&gt; /nologo /MACHINE:IX86 /INCREMENTAL:YES /SUBSYSTEM:CONSOLE &lt;Extra Switches&gt; &lt;Input OBJ File/Path List&gt;<br />+ DLL:<br />  # A DEF file must be specified:<br />    &gt; Add the DEF file as a source file as specified above<br />    &gt; Select the def file in the source file list<br />    &gt; Click the &quot;Use Current Selection&quot; button<br />  # Again the &quot;Extra switches&quot; field can be used, current commandline:<br />    \masm32\bin\Link /OUT:&lt;Output EXE File/Path&gt; /nologo /MACHINE:IX86 /DLL /INCREMENTAL:YES /DEF:&lt;Input DEF File/Path&gt; /SUBSYSTEM:WINDOWS &lt;Extra Switches&gt; &lt;Input OBJ File/Path List&gt;<br />+ LIB:<br />  # As stated above, there areproblems with this at the moment, but in the forthcoming version, the commandline is as follows (&quot;Extra switches&quot; can be used here as well):<br />    \masm32\bin\Link -lib /INCREMENTAL:YES /nologo /OUT:&lt;Output EXE File/Path&gt; &lt;Extra Switches&gt; &lt;Input OBJ File/Path List&gt;<br /><br />How do i save the changesto the project options?<br />- Just click the &quot;OK&quot; button<br /><br />How do i set a build path?<br />- Type it in in the box at the bottom of the dialog (remember the trailing '\')<br /><br />------------------------------------------------------<br /><br />Can anyone who uses TASM or any other assembler/linker combination give me the equivalent commandlines? Sorry, but at the moment the code will only deal with source files with the &quot;asm&quot; extension, and resources with the &quot;rc&quot; extension<br /><br />If you find any bugs (other than those mentioned above) could you please let me know.<br /><br />Ossa</div>
    <div class="meta">Posted on 2003-07-05 20:07:06 by Ossa</div>
   </div>
   <div class="post" id="post-109371">
    <div class="subject"><a href="#post-109371">Project Builder 2.1 release</a></div>
    <div class="body">Thanks Ossa,<br /><br />I'll put it in the next update of the help file. I have created your page and will proof it when I get a chance tomorrow. Do you want me to add the known issues or would you rather leave them out?</div>
    <div class="meta">Posted on 2003-07-05 20:18:32 by donkey</div>
   </div>
   <div class="post" id="post-109415">
    <div class="subject"><a href="#post-109415">Project Builder 2.1 release</a></div>
    <div class="body">donkey<br /><br />could you just putin the last 3 known issues? The first 4 will be solved soon, so there's no need to have them there<br /><br />soory, also thnx for the try to fix that procedure, but it doesn't seem to have worked.<br /><br />Ossa</div>
    <div class="meta">Posted on 2003-07-06 05:24:29 by Ossa</div>
   </div>
   <div class="post" id="post-109432">
    <div class="subject"><a href="#post-109432">Project Builder 2.1 release</a></div>
    <div class="body">Hi  Ossa,<br /><br />Thankyou very much for your explanation that will be really helpful.<br /><br />The best regards<br />ipadilla</div>
    <div class="meta">Posted on 2003-07-06 10:22:46 by ipadilla</div>
   </div>
   <div class="post" id="post-109439">
    <div class="subject"><a href="#post-109439">Project Builder 2.1 release</a></div>
    <div class="body">Hi Ossa,<br /><br />The only other thing I can suggest for the problem is to make sure that all of your buffers are large enough to hold their respective data. I had an intermittent problem like this where a pointer was being overwritten by an undersized buffer sitting directly behind it in the data section. It was difficult to track down because there was ofcourse no error and the acutal location of the overwrite was unrelated to the pointer. In my case it depended on the legnth of a return string from GetPrivateProfileString.</div>
    <div class="meta">Posted on 2003-07-06 12:07:18 by donkey</div>
   </div>
   <div class="post" id="post-109444">
    <div class="subject"><a href="#post-109444">Big PB Bug Fix!</a></div>
    <div class="body">Hi,<br /><br />ok, here's the latest version of PB.<br /><br />I think i now know why some people might have been having troube using it: the directory structure in the build folder had to be manually created, this might not have been obvious, but i've sorted that out. The things fixed are:<br /><br />- The LIB builder doesn't really build libs properly<br />- If you press OK, but have not fulfilled some requirement and cause the dialog to complain somehow, then press cancel, then go back into the dialog, some of the data will have been deleted<br />- The build will not work unless you have recreated the source directory structure in the build directory<br />- Clicking &quot;OK&quot; when a binary does not have name will cause RadASM to exit with PB giving a warning<br />- Sometimes the dialog will not recognise that a file is from inside the project directory and will give the full path instead<br /><br />All now work/behave properly<br /><br />Ossa</div>
    <div class="meta">Posted on 2003-07-06 13:31:38 by Ossa</div>
   </div>
   <div class="post" id="post-109445">
    <div class="subject"><a href="#post-109445">Project Builder 2.1 release</a></div>
    <div class="body">by the way, could someone get rid of the original file at the start of this thread?<br /><br />Ossa</div>
    <div class="meta">Posted on 2003-07-06 13:32:52 by Ossa</div>
   </div>
   <div class="post" id="post-109465">
    <div class="subject"><a href="#post-109465">Project Builder 2.1 release</a></div>
    <div class="body">Hi (again),<br /><br />I think i've discovered <em>when</em> the problem with the menu occurs:<br /><br />Problem:<br />- Sometimes when a project open, PB seems to think that there is no project open &amp; will not let the project be built<br /><br />How to create it:<br />1) Open RadASM, make sure that you do this by choosing the link to the executablerather than by double clicking an associated file (eg .rap)<br />2) Open a project, do not let the &quot;Project&quot; popup menu open after the project is open<br />3) Open a source file from the project (ie by double clicking in the dockable &quot;project&quot; toolbar)<br />4) Click on the &quot;Project&quot; menu <br /><br />+++ The PB menu itms will be grayed out +++<br /><br />5) Close the source file window<br />6) Click on the &quot;Project&quot; menu <br /><br />+++ The PB menu itms will be enabled +++<br /><br />7) reopen the source file<br />8) Click on the &quot;Project&quot; menu <br /><br />+++ The PB menu itms will be enabled +++<br /><br /><br />Has anyone (especially KetilO) got any ideas on why this occurs?<br /><br />I have looked at donkey's suggestion that there might be a buffer before it that overflows into the lpDStruct variable (see code below), but have discounted this as the cause for 2 reasons:<br />1) The fact that the variable is not set again later, but does work later<br />2) The fact that all the global vaiables that would be used before the problem event occurs are defined after this global (with the exception of 2 paths (buffers for these are 300 bytes) defined about 3kB back in memory and the hInstance DWORD)<br /><br />The relevent code for is below:<br /><br />From the InstallDll function:<br /><pre><code><br />	invoke SendMessage, hWin, AIM_GETDATA, 0, 0<br />	mov lpDStruct, eax<br /></code></pre><br />From the DllProc function:<br /><pre><code><br />	.elseif eax==AIM_INITMENUPOPUP<br />	<br />		; =============================<br />		; do appropriate enable/disable<br />		; =============================<br /><br />		mov eax, lpHStruct<br />		mov eax, &#91;eax&#93;&#91;ADDINHANDLES.hMenu&#93;<br /><br />		invoke GetSubMenu, eax, 4<br />		mov hMnu, eax<br /><br />		invoke IsProjectOpen<br />		.if eax==TRUE<br />			mov ecx, MF_ENABLED<br />		.else<br />			mov ecx, MF_GRAYED<br />		.endif<br />		<br />		push ecx<br />		invoke EnableMenuItem, hMnu, nMenuDlgID, ecx<br />		pop ecx<br />		invoke EnableMenuItem, hMnu, nMenuID, ecx<br /></code></pre><br />The IsProjectOpen procedure:<br /><pre><code><br />; ****************************************<br />; returns whether a project is open or not<br />; ****************************************<br /><br />IsProjectOpen PROC<br /><br />	; =====================================<br />	; Check appropriate member of ADDINDATA<br />	; =====================================<br /><br /><br />	mov edx, lpDStruct<br />	mov eax, &#91;edx&#93;&#91;ADDINDATA.fProject&#93;<br /><br />	ret<br />IsProjectOpen ENDP<br /></code></pre><br />The global definition:<br /><pre><code><br />.data?<br />.<br />.<br />.<br />lpDStruct			dd ?<br /></code></pre><br />Any ideas?<br /><br />Ossa</div>
    <div class="meta">Posted on 2003-07-06 15:58:43 by Ossa</div>
   </div>
   <div class="post" id="post-109515">
    <div class="subject"><a href="#post-109515">Project Builder 2.1 release</a></div>
    <div class="body">Hi Ossa<br /><br />This is the problem:<br /><br /><pre><code><br />	invoke GetSubMenu, eax, 4<br />	mov hMnu, eax<br /></code></pre> <br /><br />If the project has an autoload file and the edit window is maximized you are enabeling the Format menu.<br /><br />Do thie additional check:<br /><pre><code><br />mov	edx,4<br />;Adjust topmost popup if maximized<br />mov	eax,&#91;lpDStruct&#93;<br />.if &#91;eax&#93;.ADDINDATA.fMaximized<br />	inc	edx<br />.endif<br />;Get handle of Project popup<br />mov	eax,&#91;lpHStruct&#93;<br />invoke GetSubMenu,&#91;eax&#93;.ADDINHANDLES.hMenu,edx<br />mov	hMnu,eax<br /></code></pre> <br /><br />KetilO</div>
    <div class="meta">Posted on 2003-07-07 02:25:10 by KetilO</div>
   </div>
   <div class="post" id="post-109542">
    <div class="subject"><a href="#post-109542">Project Builder 2.1 release</a></div>
    <div class="body">Hi Ossa<br /><br />One more suggestion.<br /><br />Just before you start building the project, add this code:<br /><br /><pre><code><br />IDM_FILE_SAVEALLFILES	equ 40009<br />mov eax,lpHStruct<br />invoke SendMessage,&#91;eax&#93;.ADDINHANDLES.hWnd,WM_COMMAND,IDM_FILE_SAVEALLFILES,0<br /></code></pre> <br /><br />And all changed files will be saved before build.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-07-07 07:00:08 by KetilO</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=13964&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=13964&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="13964" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=13964&amp;page=2">&gt;</a><a href="../?id=13964&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>