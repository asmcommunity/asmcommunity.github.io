<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>DOWNLOAD: Win32Asm COM Wizard 1.0 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9359" />
    <link rel="next" href="../?id=9359&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=9359">DOWNLOAD: Win32Asm COM Wizard 1.0</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=9359&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=9359&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="9359" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=9359&amp;page=2">&gt;</a><a href="../?id=9359&amp;page=2">&raquo;</a></form>   <div class="post" id="post-69163">
    <div class="subject"><a href="#post-69163">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Hello All,<br /><br />Heres the COM Wizard. You can make objects with properties and methods but not events yet. The wizard doesnt generate HTAs yet as well.<br /><br />Double-Click &quot;COM Object Wizard.hta&quot; to run the wizard.<br /><br /><br /><br /><strong>25 Downloads, no comments?</strong></div>
    <div class="meta">Posted on 2002-12-04 23:27:42 by Xtreme</div>
   </div>
   <div class="post" id="post-69176">
    <div class="subject"><a href="#post-69176">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">very nice ideea for a wizard ... groovy about box :alright: <br />now i must understand this stuph :tongue: <br /><br />maybe in the future an example would be great ... step by step</div>
    <div class="meta">Posted on 2002-12-05 00:58:19 by TBD</div>
   </div>
   <div class="post" id="post-69254">
    <div class="subject"><a href="#post-69254">COM Wizard Tutorial #1: HelloWorld Object</a></div>
    <div class="body">Keep in mind that this is only version 1.0 beta. I'll add a lot more features and documentation for the wizard as time passes.<br /><br />For now, lets start with a simple tutorial and create the &quot;HelloWorld Object&quot;. The HelloWorld object will have 1 property, named &quot;SomeNumber&quot; and 1 method named &quot;HelloWorld&quot;.<br /><ul><br />[*]Launch the Wizard by clicking the &quot;COM Object Wizard.hta&quot; file.<br /><br />[*]On the Wizard interface click Add on the <strong>Properties List</strong>.<br /><br />[*]When the <strong>Property Editor</strong> dialog appears, change the example <strong>Property Name</strong> to <em>SomeNumber</em>.<br /><br />[*]Leave the example setting for <strong>Property Type</strong> as <em>DWORD</em>.<br /><br />[*]Notice when you entered the <strong>Property Name</strong> that the <strong>Help String</strong> changed automatically. This string appears as documentation for your property; as in the object browser for VB.<br /><br />[*]Now the property is complete. Click OK to add your property to the <strong>Properties List</strong> on the Wizard interface.<br /><br />[*]If you need to change anything about this property from now on, select the property in the <strong>Properties List</strong> and click Edit.<br /><br />[*]On the Wizard interface click Add on the <strong>Methods List</strong>.<br /><br />[*]When the <strong>Method Editor</strong> dialog appears, change the example <strong>Method Name</strong> to <em>HelloWorld</em>.<br /><br />[*]Below the blue horizontal line there are boxes for up to 5 method parameters. For now, just leave the example parameters as they are. I.E., the HelloWorld method will have two parameters: <em>MyFirstParameter</em> and <em>MySecondParameter</em>.<br /><br />[*]Now the method is complete. Click OK to add your method to the <strong>Method List</strong> on the Wizard interface.<br /><br />[*]If you need to change anything about this method from now on, select the method in the <strong>Method List</strong> and click Edit.<br /><br />[*]Now, click Create Project on the Wizard Interface.<br /><br />[*]In the <strong>Project Name</strong> box, enter <em>HelloWorld</em>. (This is the name of our project <em>and</em> COM object).<br /><br />[*]Next, click the <strong>Browse Button</strong> and select a folder to create the project files in.<br /><br />[*]Check the <strong>Build Project</strong> and <strong>Show Project Folder</strong> checkboxes.<br /><br />[*]Last, click OK on the Create Project window.<br /><br />The Wizard will run the <strong>make.bat</strong> file to build the COM object and Register it with RegSvr32. While the project is building, look for <em>GOOD BUILD</em> on line number 4 of the command window. The project folder should then display in Windows Explorer.<br /><br /><strong>Congratulations! You just created a COM object in Win32ASM!</strong><br /><br />Want to see it work now? Just copy the following code in to a file with an &quot;.hta&quot; extension (I.E., index.hta). Run the hta file and click the link. Methods are generated with sample code that displays a messagebox with the method name on it. If you run this sample hta and click the link, you should see a message box with ERROR in the title and HelloWorld in the message area.<br /><br /><pre><code><br />&lt;html&gt;<br />	&lt;head&gt;<br />		&lt;script language=&quot;JScript&quot;&gt;<br />			function a&#40;&#41;<br />			&#123;<br />				var obj = new ActiveXObject&#40;&quot;HelloWorld&quot;&#41;;<br />				obj.HelloWorld&#40;0,0&#41;;<br />			&#125;<br />		&lt;/script&gt;<br />	&lt;/head&gt;<br />	&lt;body&gt;<br />		&lt;a href=&quot;#&quot; onClick=&quot;a&#40;&#41;&quot;&gt;HelloWorld&#40;0,0&#41;;&lt;/a&gt;<br />	&lt;/body&gt;<br />&lt;/html&gt;<br /></code></pre></div>
    <div class="meta">Posted on 2002-12-05 12:26:22 by Xtreme</div>
   </div>
   <div class="post" id="post-69291">
    <div class="subject"><a href="#post-69291">Roadmap for the COM Wizard</a></div>
    <div class="body"><strong>Version 1.0 Beta:</strong><br />Uploaded - See Above Post<br /><br /><strong>Version 2.0 Beta:</strong><br />1. Selection of all text in dialogs so example entries are easier to type-over.<br />2. Project Creation/Build progress bar.<br />3. Wizard code optimization.<br />4. Ability to add additional Interfaces.<br />5. Example HTA generation.<br />6. Arbitrary number of parameters in methods.<br />7. Implement Events.<br /><br /><strong>Version 1.0 FINAL:</strong><br /> 1. Production quality tool that generates production quality COM objects.</div>
    <div class="meta">Posted on 2002-12-05 16:14:41 by Xtreme</div>
   </div>
   <div class="post" id="post-69344">
    <div class="subject"><a href="#post-69344">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Im all <strong><em>About</strong></em> this COM wizard... Nice work... (wink, wink, nudge, nudge)<br /><br />And Err, I like you taste... :grin: <br /><br />: NaN :</div>
    <div class="meta">Posted on 2002-12-05 19:09:56 by NaN</div>
   </div>
   <div class="post" id="post-69345">
    <div class="subject"><a href="#post-69345">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">You should see her sister :grin: <br /><br />Has anyone build a COMponent with the wizard yet? Even a little one?</div>
    <div class="meta">Posted on 2002-12-05 19:19:12 by Xtreme</div>
   </div>
   <div class="post" id="post-69346">
    <div class="subject"><a href="#post-69346">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Ya, well kinda... I made piece-o-crap build so far.. but i have not populated it with anything practicle... <br /><br />Still tinkering :)<br /><br />(( Im impressed on the format however ~ im not to web savy ))<br />NaN<br /><br /><br /><strong>PS:</strong> In the CreateProject Window, you should add a field to give the person the option to create a new folder in the specified directory...  (as well, if possible, remember the directory path for future uses).</div>
    <div class="meta">Posted on 2002-12-05 19:24:27 by NaN</div>
   </div>
   <div class="post" id="post-69348">
    <div class="subject"><a href="#post-69348">More Suggestions</a></div>
    <div class="body">Another suggestion is an options box, to set up properties.  Such as an optional 'undo' batch file to unregister the object.<br /><br />To keep new commers from polluting their registry any more than it is ;)<br /><br />More thought to come, im sure.. :alright:<br /><br />:nan:</div>
    <div class="meta">Posted on 2002-12-05 19:50:23 by NaN</div>
   </div>
   <div class="post" id="post-69350">
    <div class="subject"><a href="#post-69350">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Hmm... Ok.. heres the Deal on my Machine..<br /><br />Its not outputing the .tlb file.. I get a script error:<br /><br />Line:612<br />Char: 4<br />Error: Object Doesnt Support This Property or Method<br /><br />As well, after all events (even after i close the about box), i get the standard window pop-up:<br /><br /> The page cannot be displayed <br /><br />From microsoft...<br /><br />Perhaps there is some &quot;special&quot; install location? Or is there files im supposed to make public via %path%??<br /><br />Cause it stops short here... (the make output is):<br /><pre><code>Building 'TestCreate' COM Object DLL<br /><br />1&#41; Generating TestCreate.tlb from TestCreate.idl<br /><br /><br />rsrc.rc &#40;5&#41;&#58; error RC2135 &#58; file not found&#58; TestCreate.tlb<br />CVTRES &#58; fatal error CVT1101&#58; cannot open rsrc.res for reading<br /><br />2&#41; Assembling TestCreate.asm<br /><br />3&#41; Linking without resources<br /><br />4&#41; GOOD BUILD<br />Bad command or file name<br /><br />5&#41; Registered COM Object with Regsvr32<br /><br />Press any key to continue . . .<br /></code></pre><br /><br />(Again, this ball starts rolling because the .tlb file is not generated).<br />:me shrugs:<br />NaN</div>
    <div class="meta">Posted on 2002-12-05 20:02:25 by NaN</div>
   </div>
   <div class="post" id="post-69351">
    <div class="subject"><a href="#post-69351">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Cool,<br /><br />Added features:<br /><br />1. Save options to registry<br />2. Generate Undo.bat<br /><br />Does your Browse Window look like the one below?<br />You can add a new folder from the highlighted button.</div>
    <div class="meta">Posted on 2002-12-05 20:12:43 by Xtreme</div>
   </div>
   <div class="post" id="post-69352">
    <div class="subject"><a href="#post-69352">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Nope...  The highlighted button doesnt exist for me.. Does this have something to do with the fact it also generates the indicated error? (ie, my win98se is not up to par with some verion of os?)<br /><br />(had me worried i put my foot in my mouth there ;) .  Its not been the first time &lt;g&gt; )<br /><br />:nan:</div>
    <div class="meta">Posted on 2002-12-05 20:20:47 by NaN</div>
   </div>
   <div class="post" id="post-69354">
    <div class="subject"><a href="#post-69354">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">NaN,<br /><br />You need <strong>&quot;midl.exe&quot;</strong>. My copy is located at <strong>&quot;C:\Program Files\Microsoft SDK\Bin&quot;</strong> and is apart of the PATH variable so it can be run from any folder.<br /><br />Let's see where it can be downloaded.....<br /><br />....Well it seems to only be installed w/ the MS PSDK. So I've zipped it up and attached it to this message. I'll include it with the next beta and final version of the Wizard. Unzip it to your System (or System32 on NT) folder.</div>
    <div class="meta">Posted on 2002-12-05 20:24:26 by Xtreme</div>
   </div>
   <div class="post" id="post-69362">
    <div class="subject"><a href="#post-69362">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">OK,<br /><br /><strong>For Windows 9x machines</strong><br /><br /><br /><ul><br />[*]The Windows 98/ME Shell <strong><em>might</em></strong> not be 100% compatible with the Wizard. I'm looking into this...<br /><br />[*]Code on line 612 of the Wizard needs to be fixed to call on &quot;Command.com&quot; instead of &quot;cmd&quot;. All of you 9x'ers will get a &quot;Object Doesnt Support This Property or Method&quot; error. Nan, will you post a list of Command.com command-line switches? (ie, from DOS call &quot;command/?&quot;)<br /><br />[*]Also the Wizard needs a DOS applet from Microsoft named <strong>midl.exe</strong> to generate the Type Library for your COM object. I will include this applet in the next upload.<br /><br />[*]The Wizard also needs <strong>Regsvr32</strong> to register the COM object with the system. I thought this shipped on all MS OSes? Maybe Nan's %PATH% is incomplete?<br /><br /><br /><br />We'll get it all figured out.... ;)</div>
    <div class="meta">Posted on 2002-12-05 20:41:21 by Xtreme</div>
   </div>
   <div class="post" id="post-69365">
    <div class="subject"><a href="#post-69365">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Thanx. I have it.. I have MS VC++ installed... but i suspect its because its not pathed.<br /><br />I manually edited the make file to:<br /><br />path=%path%;C:\progra~1\devstu~1\vc\bin<br /><br />And got me one step closer, but then it sends back this error box:<br /><br />&quot;A required .DLL file, MSPDB50.DLL, was not found.&quot;<br /><br />Im doing a search for it as I type this... <br /><br />(it doesnt exist on my system :rolleyes:)<br />:nan:</div>
    <div class="meta">Posted on 2002-12-05 20:43:41 by NaN</div>
   </div>
   <div class="post" id="post-69368">
    <div class="subject"><a href="#post-69368">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body"><pre><code>C&#58;\Program Files\DevStudio&gt;command /?<br />Starts a new copy of the Windows Command Interpreter.<br /><br />COMMAND &#91;&#91;drive&#58;&#93;path&#93; &#91;device&#93; &#91;/E&#58;nnnnn&#93; &#91;/L&#58;nnnn&#93; &#91;/U&#58;nnn&#93; &#91;/P&#93; &#91;/MSG&#93;<br />                       &#91;/LOW&#93; &#91;/Y &#91;/&#91;C|K&#93; command&#93;&#93;<br />  &#91;drive&#58;&#93;path    Specifies the directory containing COMMAND.COM.<br />  device          Specifies the device to use for command input and output.<br />  /E&#58;nnnnn        Sets the initial environment size to nnnnn bytes.<br />                  &#40;nnnnn should be between 256 and 32,768&#41;.<br />  /L&#58;nnnn         Specifies internal buffers length &#40;requires /P as well&#41;.<br />                  &#40;nnnn should be between 128 and 1,024&#41;.<br />  /U&#58;nnn          Specifies the input buffer length &#40;requires /P as well&#41;.<br />                  &#40;nnn should be between 128 and 255&#41;.<br />  /P              Makes the new Command Interpreter permanent &#40;can't exit&#41;.<br />  /MSG            Stores all error messages in memory &#40;requires /P as well&#41;<br />  /LOW            Forces COMMAND to keep its resident data in low memory.<br />  /Y              Steps through the batch program specified by /C or /K.<br />  /C command      Executes the specified command and returns.<br />  /K command      Executes the specified command and continues running.<br /><br /></code></pre><br />Hope it helps..<br />NaN</div>
    <div class="meta">Posted on 2002-12-05 20:47:05 by NaN</div>
   </div>
   <div class="post" id="post-69369">
    <div class="subject"><a href="#post-69369">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Well you got me there... :)<br /><br />I dunno why, cause i definitely didnt take it out, but C:\WINDOWS\SYSTEM was not placed in the startup path, at least on my system...<br /><br />However, the .DLL i mentioned above doesnt exist on my system at all.  Wierd..<br /><br />NaN</div>
    <div class="meta">Posted on 2002-12-05 20:51:52 by NaN</div>
   </div>
   <div class="post" id="post-69372">
    <div class="subject"><a href="#post-69372">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Ok... got it all hacked now.<br /><br />I *do* have it after all.. Im a moron, and typed in MSPDB500.dll (one to many zeros) in the search...<br /><br />Turns out its in the MASM\BIN dir.<br /><br />So this run around has been enough headache for me, Im going to pernamently modify my path... to include VC++ and MASM..<br /><br />(( I personally dont want to, but I give in ~ Call me wierd (or a control freak), but i like programs to be self contained, and not need to rely on things that im not directly aware of, secretly behind the schenes))<br /><br />NaN</div>
    <div class="meta">Posted on 2002-12-05 20:59:17 by NaN</div>
   </div>
   <div class="post" id="post-69377">
    <div class="subject"><a href="#post-69377">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Thanks Nan,<br /><br />I looked at the command-line switches you posted. I won't have to change what I've got. I'll just need to detect the OS in use via the &quot;Navigator Agent&quot; and run &quot;command.com&quot; or &quot;cmd.exe&quot;.<br /><br />As far as the script errors go, you may need to download: &quot;<a target="_blank" href="http://msdn.microsoft.com/downloads/sample.asp?url=/MSDN-FILES/027/001/733/msdncompositedoc.xml&amp;frame=true">Windows Scripting Componets 5.6</a>&quot;</div>
    <div class="meta">Posted on 2002-12-05 21:13:13 by Xtreme</div>
   </div>
   <div class="post" id="post-69385">
    <div class="subject"><a href="#post-69385">Thanx</a></div>
    <div class="body">As you can tell, im not so web savy ;)<br /><br />Nor have i gone beyond simply reading how to make com's.  I knew you had to use MIDL and create and IDL.  But i never knew you had to have all this other crap set up.  To be honest, i've never had a need to make one yet.<br /><br />Kinda irritated to be honest.  This is why i hate C++ and love MASM.  Masm is nicely contained and doesnt require all this crap.<br /><br />I set up my path to include VC\BIN, and MASM\BIN.  Rebooted. Got another error.  Can't find its oaidl.idl (found in VC\INCLUDE).  So i change my path again and add this.  It refused to recognize it.  I assume its cause its not an .exe extension. Cause there is a path to the proper folder now, and the oaidl.idl and the rest of them are there!<br /><br />It would be nice to get all these 'bumps' understood, and packaged into one folder for MASM development.  Cause it would be nice to NOT expect every new COM'r to have VC++ or something alike.  (Even tho i have it installed, and it still does me no good from its installed arrangements, outside of VC++ itself).<br /><br />:nAn:<br />:stupid:</div>
    <div class="meta">Posted on 2002-12-05 21:25:04 by NaN</div>
   </div>
   <div class="post" id="post-69389">
    <div class="subject"><a href="#post-69389">DOWNLOAD: Win32Asm COM Wizard 1.0</a></div>
    <div class="body">Success!!!! <br /><br />Ok... here is what i managed to research on this whole MIDL business:<br /><br />It needs:<ul><br />[*]MSPDB50.DLL <br />[*]CL.EXE<br />[*]C1.DLL<br />[*]MIDL.EXE<br />[*]MIDL setup path: MIDL <strong>/I Path_to_Directory_OF_IDLs</strong> MyCom.IDL<br /><br /><br />Hmmm.. I dunno if CL and C1.DLL is non-propriatery, or MIDL for that fact?<br /><br />At anyrate, could you add an 'options' box to specify a MIDL include path for the /I switch??  (i can copy the rest outa VC++ and keep it contained under a MASM path)<br /><br />PS: I finally got a full make, with no errors.  However, i did modify the make file to include an /I path (shown above) and this in the begining:<pre><code>@echo off<br />path=%path%;C&#58;\windows\system<br />echo.<br />echo Building 'Ctest' COM Object DLL</code></pre><br /><br />I suggest you add this into the template as well, cause other OS's may be the same as me, and not directly 'path' out the system dir (where REGSVR32.EXE exists on my 98 OS).  (( Trust me, i didnt remove any paths, so im left assuming it was never there, or some installer f&amp;cked it up for me :rolleyes: )).  Besides, its not pernament, it only modifies the path for the existance of the batch file, then the path resets to normal anyways.<br /><br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-12-05 21:49:43 by NaN</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=9359&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=9359&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="9359" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=9359&amp;page=2">&gt;</a><a href="../?id=9359&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>