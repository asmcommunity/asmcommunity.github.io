<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ints in PM - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10733" />
  <link rel="prev" href="../?id=10733&amp;page=4" />  <link rel="next" href="../?id=10733&amp;page=6" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10733">ints in PM</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=10733&amp;page=1" style="">&laquo;</a><a href="../?id=10733&amp;page=4" style="">&lt;</a><input type="hidden" name="id" value="10733" /><input type="number" name="page" min="1" max="6" step="1" value="5" onchange="this.form.submit();" /><a href="../?id=10733&amp;page=6">&gt;</a><a href="../?id=10733&amp;page=6">&raquo;</a></form>   <div class="post" id="post-99873">
    <div class="subject"><a href="#post-99873">protected mode / OS (was ints in PM)</a></div>
    <div class="body"><strong> to f0dder </strong><br /><br />I am not aiming at speed issues here, as you might notice in SOLAR OS source code i am curently rdrawing screen every frame :) <br /><br />I aim at simple, i aim at my own way/concepts i dislike walking other paths instead of my own...esp when their path is determined by comercialism and wrong technical assumptions<br /><br />I do not see why i should check every jump/syscall i make ... IMHO they are :<br />1) Wrong and then the program needs to be reworked<br />2) OK and then the check is stupid and done every time for  NOTHING .. <br /><br />Come on maybe first time to see if it is ok but doing it agin and again is like me redrawing screen everytime :P at least i have a reason i am lazy :P<br /><br />I will not trash cache at task switch because i use cooperative multitasking... works perfect <br />I will look into that &quot;carefull task scheduler&quot; when the time comes for preemtive multitasking... i am just happy as it is now<br /><br />_bugs_always show up? hehehe i know <br /><br />Maybe people should be more carefull about OOP design and C++  and huge teams? <br />Maybe they should release source code so more people take a look at it and many eyes will find the bug faster. <br /><br />Or mybe the will just have to deal with it them selfes... if they want closed propietary software.<br /><br />... ring0 dangerous :)) hahahaha make me laough today... <br /><br />You mean that all those applications i use to run on old DOS days like 3DStudio, Wordperfet, Ventura etc etc that owned the whole memory like in ring0 ....  where all dangerous? ... what did they do? make fun of me?<br /><br />I do not see how ring0 is dangerouse... really ... if done properly i mean :)<br /><br />Design the API decently...OK<br /><br />But  to reduce API calls...hmmm?<br /><br />Is that not the ideea of an API functions to be usefull and to be called many many times... at least more than once in a while?<br /><br />Well i know my OS is stable... I can let it run for centurys and it will not GPF or need a restart :)<br />(yes i know i do not have many applications now) but we will see in the future...<br /><br />Besides why sould a OS be &quot;unstable&quot; wtf can happen?<br /><br /><div class="quote"><br />It's nice that you're playing around and all, but if you think you're building an &quot;OS&quot; you're delusional  - this is at best a toy kernel with some pretty wrong assumptions.<br /></div><br /><br />My friend... i carefylly considered ALL assumptions with PROs and CONS and in fully understanding them and the consequences I HAVE CHOOSEEN to be diferent and go my own way . <br /><br />I consider OTHERS are wrong but i will fight and die for their right to be so :) trust me<br /><br />I just want to implement my own thinking about an OS and i also stated that I will use time to implement OTHERS points of view also...so we cand have a FAIR set of OPTIONS and test acordingly<br /><br />This is indeed my own OS and you can call it &quot;a toy&quot;... <br /><br />but an OS is just a set of base software functions that interfaces you with the hardarw and offers you a way to design applications for that computer ...<br /><br />I have interfaces for :<br />-mouse,keyboard,memory,kernel,State Machines,GUI,Events,FDD,HDD... and you can do applications in my OS... it is not yet finished and there is much work to be done indeed <br /><br />but i still like to think of it as on OS ... thank you</div>
    <div class="meta">Posted on 2003-04-28 15:19:28 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-99874">
    <div class="subject"><a href="#post-99874">protected mode / OS (was ints in PM)</a></div>
    <div class="body"><div class="quote"><br />Paging makes memory mapping (files, IO) possible.<br /><br />Paging, because of fixed size and native CPU support, is easy to handle when doing virtual memory / OS paging.<br /><br />Of course bogdan will claim that VM is bad, that apps should handle VM themselves if they need it, that all the protection is slow and unnecessary etc. </div><br />Why mapp memory out of RAM, I can't see the use, using eg a file on a HDD as RAM can't be an titz-ripper. Isn't it better to use RAM as RAM and HDD as storage memory not working memory?<br />I'm not sure about the virtual memory thing, have I gotten it wrong if virtual memory can be memory that doesn't exist, which would enable usage of memory that you don't have? (I don't like the idea of living/using resurces one doesn't have)<br /><br />My definition of an OS is basically &quot;late&quot; at school day night hours:<br /><em>Operating System, deals with the basic stuff like supplying memory manager, task swithing, basic gfx calls, hardware interface functions (like BeepSysSummer, just beep the F* sys speaker for me, or PrintText print the text at &quot;this loaction&quot; to &quot;that IO device&quot; (may it be a printer, a terminal, the screen or whatever). The kernel is just the core that glues it all together, and keeps the weels spinning.</em><br /><br />(I think I better get some sleep before school starts, I'll check the forum tomorrow, so god night friends (or be we foes after these posts ;)))</div>
    <div class="meta">Posted on 2003-04-28 15:35:01 by scientica</div>
   </div>
   <div class="post" id="post-99875">
    <div class="subject"><a href="#post-99875">protected mode / OS (was ints in PM)</a></div>
    <div class="body">Yes fodder VirtualMemory is bad...<br /><br />It is alzy solution and trust me i use it a lot because i am lazy...esp in comercial applications i wrote...<br />But i dosent mean i have to also THINK is is good. I know it is bad.<br /><br />Basicaly an application that needs huge ammounts ot memory should  be aware of just home many RAM is there available on a machine and act acordingly ...yes eventualy use HDD for a private swap if it needs to... <br /><br />To let the OS guess your needs for you is convenient and lazy...wastes time  eh... etc etc <br /><br />But so very much used today... because it means you do less work <br /><br />Indeed the &quot;big &quot; advantages of pagins over segmentation is the auto VM feature of x86 CPU that work only with paging. <br /><br />That is because when a page is not actually present in memory...lets say at adress 2.5Gigabytes <br />(anybody has 3Gigabytes here ? i guess yes)... <br /><br />Well IF you do not have 2.5G RAM ... then the CPU will generate a &quot;page fault&quot; exception... the handler to this exception could just download that page (and its next few in set) to RAM from HDD and of course send some other pages to safe storage on HDD to make a few free space...<br /><br />Imagine what happens IF the application that just loosed &quot;a few&quot; pages wants them back at the next task switch and if the 2-3 applications that swap eachother will actually also need eachothers to function properly... :) i have seen that huge HDD activity from nowhere on Linux and Windows so many times.... :(<br /><br />Well the big advantage is that AFTER the exception code the program that generated it can be RESTARTED just where it was interupted and it will just belive it has the needed memory...<br /><br /><br />Segmentation also make it possible for many applications to &quot;belive&quot; that they are actually running at address 0x40000000 when they are in fact at diferent physical locations in RAM... but it does not offer a simple convenient...<br /><br />There are way to many tings abut paging and segmentation to be explained here but maybe we sould...hehe<br /><br />Like TLB, and the fact that paging takes up huge ammounts of system memory to keep track of every 4K page in status OS RAM... also the sad gfact that segmentation is indeed limited to 8192 segments...and each program needs at leas 2 of them (code and data) but maybe more <br />...<br /><br />Well novices... feel free to ask me anytime ...</div>
    <div class="meta">Posted on 2003-04-28 15:37:32 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-99877">
    <div class="subject"><a href="#post-99877">protected mode / OS (was ints in PM)</a></div>
    <div class="body">BTW f0dder,<br /><br />There are not some many tons of ring0 &lt;--&gt; ring3 switches in modern OS like Win9x and WinNT/2K/XP as one might think. (yes WinNT/2K also)<br /><br />They knowed it is going to be slow so they use a trick: Many many components of the OS (vital ones like the GDI and kernel parts for example) are runned like simple ring3 applications ...this helps reduce the &quot;tons&quot; of ring switches... and compromites the system stblility :(...<br /><br />Because the OS might work ... but with a damaged GDI or memory alocator wtf can one still use it for? maybe conect from another computer via terminal and restart it :D (aka Linux style)<br /><br />There would not be any need of copy on write if those important system components would have been protected via &quot;protection&quot; in ring0 ... but it would be awfull slow...hmmm at least they think so...<br /><br />I am not so sure myself, i will check it out when i implement it myself</div>
    <div class="meta">Posted on 2003-04-28 15:52:54 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-99880">
    <div class="subject"><a href="#post-99880">protected mode / OS (was ints in PM)</a></div>
    <div class="body">ok, reducing the harshness a bit (sorry).<br /><br /><div class="quote"><br />I do not see why i should check every jump/syscall i make ... IMHO they are :<br />1) Wrong and then the program needs to be reworked<br />2) OK and then the check is stupid and done every time for NOTHING .. <br /></div><br />Of course this depends on what you're aiming at. For a &quot;real OS&quot;, you *need* checking - lots of people are trying to be malicious and you want to stop them. Even on your own OS, which won't be targetted, it's still nice not having too simple software faults resulting in reboots or kernel panics. Even with extensive testing, you wont catch every bug. If you know of a way to get 100% test coverage, let me know.<br /><br /><div class="quote"><br />I will not trash cache at task switch because i use cooperative multitasking... works perfect <br />I will look into that &quot;carefull task scheduler&quot; when the time comes for preemtive multitasking... i am just happy as it is now<br /></div><br />Cache trashing will only happen once you actually switch task. (Sure, scheduler will use some cache, but so will all IRQs. It's your responsible to program those very low-level aspects well). With a decent algorithm for the scheduler, cache trashing effects shouldn't be too bad.<br /><br />As for the DOS days... I'm glad we're past those days. Single tasking, yuck. A lot of other bad things not related to the current thread. True, you didn't see crashing applications that much back then. True, applications have grown too huge, and there's a lot of careless developers out there. I also remember badly programmed software from back then, though. And being annoyed at rebooting. And I remember cooperative multitasking fron win3.x and being annoyed how one bad app could make the entire system run sluggish (at best) or even worse, lock it up. I also remember software development in unprotected environments, and weeh am I happy about ring3, paging, separated process spaces, etc.<br /><br /><div class="quote"><br />Besides why sould a OS be &quot;unstable&quot; wtf can happen?<br /></div><br />Your kernel is probably &quot;stable&quot; enough - but the whole environment widely open to be trashed by any app that has a little flaw here or there.<br /><br /><div class="quote"><br />This is indeed my own OS and you can call it &quot;a toy&quot;...<br /></div><br />Nah, it's a kernel - a OS is a kernel + &quot;all those extra things&quot;.<br /><br />Well, not much point in discussing most of these things, they're higly subjective.<br /><br />scientica,<br /><div class="quote"><br />Why mapp memory out of RAM, I can't see the use, using eg a file on a HDD as RAM can't be an titz-ripper. Isn't it better to use RAM as RAM and HDD as storage memory not working memory?<br /></div><br />memory mapped files are a convenient way of handling file access in some situations. It's generally slower than a block based approach, but in a lot of situations the ease of use means more than the speed. I wouldn't use it for stuff like file copy or file checksumming or anything similar requiring hi-speed though (well, not the implementations in the environments I work with - on some architectures it's probably possible to implement very well-working MMF). <br /><br /><div class="quote"><br />I'm not sure about the virtual memory thing, have I gotten it wrong if virtual memory can be memory that doesn't exist, which would enable usage of memory that you don't have? (I don't like the idea of living/using resurces one doesn't have)<br /></div><br />Tjaaah, it's somewhat vague. When done correctly, you dont &quot;live off resources you don't have&quot; - the swap to disk aspect handles situations where something goes wrong, situations where you have a temporary need for a large amount of memory, etc. Basically most of the time you won't be using more memory than what is physically available, and when you do - you wont run into trouble.<br /><br />There's other parts handled by paging that I see as part of VM too. Virtual Memory space... keep processes separated from eachother (no accidental overwrites), keep memory fragmentation localized to processeses (because linear memory is mapped to physical, memory fragmentation is much less of an issue). Being able to remap physical addresses (mapping linear framebuffers, device buffers, . . .).<br /><br /><div class="quote"><br />Basicaly an application that needs huge ammounts ot memory should be aware of just home many RAM is there available on a machine and act acordingly ...yes eventualy use HDD for a private swap if it needs to... <br /></div><br />Nobody says you can't do that in a virtual memory OS. For some/many applications, using the OS defined disk based memory will be enough (especially if enough care is taken to design this, of course). In other situations, you might need to do your own virtual memory thingamajig (audio editors are a good example of this), and you do. Applications with very high memory demands tend to be run without much else going on in the system, so they should be able to query available memory and work from those assumptions (ie, there wont be another app grapping a huge chunk of memory). And _if_ that happens, well, it's the users fault, and he pays the penalty of possible disk swapping. And you avoid out of memory crashes.<br /><br /><div class="quote"><br />Segmentation also make it possible for many applications to &quot;belive&quot; that they are actually running at address 0x40000000 when they are in fact at diferent physical locations in RAM... but it does not offer a simple convenient...<br /></div><br />Apart from the protection features of separate process spaces, it offers the convenience that relocs do not have to be applied, and thus you can page in the executable directly from disk without (m)any further fixes. Some of the same can be achieved with segmentation, but I dislike segmentation.<br /><br />Hum, wasteful keeping track of pages. You don't need much more than 4meg to map the entire 4GB address space of x86 with 4k pages (well, some internal OS memory tables too). Let's assume extreme++ waste and say 32megs are allocated to handle 4GB of memory... what's the problem here? One could also use 4meg pages for large memory allocations.<br /><br />Sure, there's overhead for paging. There'd overhead for security. You have to weigh the overhead against the benefits. For a consumer OS (and especially a server OS), I'd say a lot of overhead can be acceptable.<br /><br />Reducing r3&lt;&gt;r0 switches... make kernel functions do more (&quot;everything in the kernel&quot; - I don't like this general attitude, but there's sense in having kernel functions that do _some_ processing), or you can do more operations in ring3. There's security tradeoffs - and you wouldn't want to keep kernel mode objects in ring3 acessible memory.<br /><br /><div class="quote"><br />They knowed it is going to be slow so they use a trick: Many many components of the OS (vital ones like the GDI and kernel parts for example) are runned like simple ring3 applications ...this helps reduce the &quot;tons&quot; of ring switches... and compromites the system stblility ... :(<br /></div><br />NT5 runs well. I haven't gotten NT5 to crash by accident (except when doing ring0 coding, but what can you expect there). There's a few issues here and there (the kernel crash from ring3 by doing console output is very stupid), but generally it's a pretty stable system.<br /><br />Well, enough.<br />If we shall discuss very subjective things, at least we need to define a context. The context I've been arguing from is &quot;multiprocess multiuser multipurpose real-world assume-human-errors&quot;.</div>
    <div class="meta">Posted on 2003-04-28 16:28:40 by f0dder</div>
   </div>
   <div class="post" id="post-99916">
    <div class="subject"><a href="#post-99916">protected mode / OS (was ints in PM)</a></div>
    <div class="body"><div class="quote"><br />NT5 runs well. I haven't gotten NT5 to crash by accident (except when doing ring0 coding, but what can you expect there). There's a few issues here and there (the kernel crash from ring3 by doing console output is very stupid), but generally it's a pretty stable system.</div><br />It' not tha hard from ring3 either... (I think I've been albe to to crash every system I've tried, including 2k, haven't tested them all though)<br /><br />f0dder, &quot;all those extra things&quot; doeas that mean stuff like samll games, simple text editor, video players, audio player, GUI/shell? (btw, do you know some good docs on paging, cant seem to find any simple docs, only docs assuming you already know paging to learn paging %-/ )</div>
    <div class="meta">Posted on 2003-04-28 23:45:17 by scientica</div>
   </div>
   <div class="post" id="post-99957">
    <div class="subject"><a href="#post-99957">protected mode / OS (was ints in PM)</a></div>
    <div class="body">&quot;all those extra things&quot;... well, at least a GUI. A shell, perhaps. Administration tools. With linux distros, linux is the kernel, and GNU/Linux is the OS. With windows... well, it's somewhat hard to separate the kernel, but there's still the kernel and the rest. Most OSes are like that (I don't really consider DOS an OS ;-)<br /><br />As for docs on paging... the intel systems programming manual has extensive documentation about the mechanisms.</div>
    <div class="meta">Posted on 2003-04-29 02:30:43 by f0dder</div>
   </div>
   <div class="post" id="post-99960">
    <div class="subject"><a href="#post-99960">protected mode / OS (was ints in PM)</a></div>
    <div class="body"><div class="quote"><br />btw, do you know some good docs on paging, cant seem to find any simple docs, only docs assuming you already know paging to learn paging %-/ </div>Here is one link, but I wish I could find the other one I had:<br /><a target="_blank" href="http://courses.ece.uiuc.edu/ece291/archive/archive-f2000/class-information/class-outline.html">http://courses.ece.uiuc.edu/ece291/archive/archive-f2000/class-information/class-outline.html</a><br />Look at lectures for Oct.12.</div>
    <div class="meta">Posted on 2003-04-29 02:39:11 by bitRAKE</div>
   </div>
   <div class="post" id="post-99986">
    <div class="subject"><a href="#post-99986">Hi</a></div>
    <div class="body">Take a look at the attachment...,<br />Can I addressing the whole 4 GB, by only depending on prefix?</div>
    <div class="meta">Posted on 2003-04-29 04:12:27 by realvampire</div>
   </div>
   <div class="post" id="post-99987">
    <div class="subject"><a href="#post-99987">protected mode / OS (was ints in PM)</a></div>
    <div class="body">if your assembler can't handle &quot;mov , al&quot; in realmode (ie, automatically put the prefix), I suggest finding a different assembler.<br /><br />Acessing memory that way isn't legal in a normal environment... but you can switch temporarily to pmode and do a few hacks to make it work... voodoo mode, unreal pmode, real big mode, whatever those various hacks have been called. I doubt Emu8086 would handle that though - it only handles 16bit mode, doesn't it? If so, have a look at <a target="_blank" href="http://bochs.sf.net">http://bochs.sf.net</a></div>
    <div class="meta">Posted on 2003-04-29 04:18:53 by f0dder</div>
   </div>
   <div class="post" id="post-99989">
    <div class="subject"><a href="#post-99989">Owww.,</a></div>
    <div class="body">So accessing mem that way is illegal?. Mov ,al using prefix?</div>
    <div class="meta">Posted on 2003-04-29 04:26:12 by realvampire</div>
   </div>
   <div class="post" id="post-99990">
    <div class="subject"><a href="#post-99990">protected mode / OS (was ints in PM)</a></div>
    <div class="body">Should be, I'm rather confident I did it in the past :grin:<br />Just note that unless you &quot;fiddle around&quot;, this will give problems when you cross segment boundaries.<br /><br />The thing to do is switch to pmode, and change fs+gs to base0, limit4g, then change back.<br /><br />have a look here: <a target="_blank" href="http://www.nondot.org/sabre/os/files/ProtectedMode/segments.html#flat">http://www.nondot.org/sabre/os/files/ProtectedMode/segments.html#flat</a><br />...<br />I prefer real 32bit mode.</div>
    <div class="meta">Posted on 2003-04-29 04:30:52 by f0dder</div>
   </div>
   <div class="post" id="post-99995">
    <div class="subject"><a href="#post-99995">I dont understand...</a></div>
    <div class="body">How to set FS and GS? just simply do this step?<br /><br /><pre><code><br /> Mov ax,0FFFFh<br /> mov FS,ax<br /> mov GS,ax<br /></code></pre><br /><br />....? :confused:<br /><br /><div class="quote"><br /><br />GDT  dw  GDT_length - 1<br />        dd  GDT<br />        dw  0<br /><br /></div><br /> <br /> What value should I put ? There?<br /><br /><pre><code><br /><br /> mov ax,DS<br /> shl eax,4<br /> mov &#91;GDT+2&#93;,eax  ;where is it? dw 0? or dw GDT_length -1 ?<br /><br /></code></pre></div>
    <div class="meta">Posted on 2003-04-29 04:41:05 by realvampire</div>
   </div>
   <div class="post" id="post-99997">
    <div class="subject"><a href="#post-99997">protected mode / OS (was ints in PM)</a></div>
    <div class="body">Another routine to do it...<br /><a target="_blank" href="http://www.df.lth.se/~john_e/gems/gem0022.html">http://www.df.lth.se/~john_e/gems/gem0022.html</a><br /><br />And, quoting some other site:<br /><div class="quote"><br />For those who do not know: Flat Real Mode is done by starting in Real Mode DOS, switching to 32 bit Protected Mode, loading the segment registers with selectors which point to descriptors set to a segment size of 4GB and switching back to Real Mode while keeping the segment register values set in Protected Mode. One may expect what you are back in the standard Real Mode, but - due to the fact that the 386 does not reset the segment limits while switching back to Real Mode - you have full 32 bit access to the whole memory while using 16 bit code.<br /><br />This sounds great (it is), but there is one big problem: You must start in Real Mode rather than in V86. Most people today are using PM OSses, and the few still having DOS are often using EMM386. In both cases you cannot switch to PM because the CPU is already in it, your code runs at PL 3 and the switch will not work.<br /><br />If you want that more than one or two people out of 100 are able to start the program without problems you should forget this method and use another, like DPMI instead.<br /></div></div>
    <div class="meta">Posted on 2003-04-29 04:51:45 by f0dder</div>
   </div>
   <div class="post" id="post-102454">
    <div class="subject"><a href="#post-102454">wooooohooooo!</a></div>
    <div class="body">not with your help, but finally i got a completely working gfx-mode. the problem was A20. with it disabled i read that there are memory holes everywhere in size of 1 mb - exactly matching to the black bar in the middle of the screen. furthermore i couldn't really access memory beyond 1mb (that caused another weired problem). just by enabling it with 4 lines of code everything worked fine!<br /><br />but i'm still riddeling about the mouse, i don't get it working. as i already mentioned i can enable it and it partially works. but when i move the mouse <strong>nothing</strong> happens (i.e no interrupt is called), but after doing that the keyboard also seems to be disabled (i.e. no react on keystrokes). i've tried several code-variants, but nothing worked. i digged through the information you gave me, but i do everything according to it.<br /><br />any help for me? some further infos?</div>
    <div class="meta">Posted on 2003-05-11 13:32:58 by hartyl</div>
   </div>
   <div class="post" id="post-102496">
    <div class="subject"><a href="#post-102496">Hartyl,</a></div>
    <div class="body">I have enable it too. But Im not sure I can access it. How did you access it. And what is the mark it was succeed. Can I see your code ?<br /><br />:alright:<br /><br />Can I running my Switch mode from DOS(Because it was .Com), and put the GDT value at PSP  ?<br /><br /><br /><pre><code><br />Where GDT is DS value shifted left by 4.<br />GDT        dw  0xF, GDT, 0, 0, 0xFFFF, 0, 0x9200, 0x8F<br /><br /><br /></code></pre></div>
    <div class="meta">Posted on 2003-05-11 17:42:30 by realvampire</div>
   </div>
   <div class="post" id="post-102630">
    <div class="subject"><a href="#post-102630">Re: Hartyl,</a></div>
    <div class="body"><div class="quote"><br />I have enable it too. But Im not sure I can access it. How did you access it. And what is the mark it was succeed. Can I see your code ?<br /></div><br />here is the code i use:<br /><pre><code><br />;enable A20<br />  mov al,0xd1<br />  out 0x64,al ;get statusbyte to port 0x60<br />  mov al,0xdf ;set A20-bit and cpu-bit not to reset it<br />  out 0x60,al ;write it back<br /></code></pre><br /><br /><div class="quote"><em>Originally posted by realvampire </em><br />Can I running my Switch mode from DOS(Because it was .Com), and put the GDT value at PSP  ?<br /></div><br />h??? what do you mean by &quot;switch mode&quot; and whats up with dos and .com? and finally: what's PSP?<br />understanding &quot;railwaystation&quot; here...<br /><br /><br />i'd like to point you out to my problem, again. yesterday i tried the complete code from SolarOS just for testing. in SolarOS itself the mouse completely works, but in my code... same problem. do you initialize more than i do, <strong>BogdanOntanu</strong>, or have i overseen something?</div>
    <div class="meta">Posted on 2003-05-12 12:50:33 by hartyl</div>
   </div>
   <div class="post" id="post-102637">
    <div class="subject"><a href="#post-102637">protected mode / OS (was ints in PM)</a></div>
    <div class="body">Well there are many steeps in PS/2 initializations:<br />-enable device in keyboard controller, yeah mouse and keyboard share the same controller, hence the starnge keyboard behavoiur if mouse works heratic, <br /><br />-but indeed the Interupt is the most important stuff there, have you enabled it in the PIC? ---IRQ12 i mean<br /><br />-also you can not start and output data to mouse/controller, esp on today fast CPU's one must wait for ACK from controller and also wait for the FA=&gt;ACK from PS/2  mouse<br /><br />Well i must say SOLAR OS also has some problems with mouse initializations esp on a HP kayak PC...but rarely and a new resetup usually clears them<br /><br /><br />But Keyboard and Mouse must both use working IRQ's handlers for everything to be ok.</div>
    <div class="meta">Posted on 2003-05-12 14:26:40 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-102696">
    <div class="subject"><a href="#post-102696">I dont understand...</a></div>
    <div class="body">Line A20 enabled are used for memory is not it? If I have enable it, how to access the memory? Its above 1MB and DS:SI cannot do that.</div>
    <div class="meta">Posted on 2003-05-12 21:44:25 by realvampire</div>
   </div>
   <div class="post" id="post-102742">
    <div class="subject"><a href="#post-102742">protected mode / OS (was ints in PM)</a></div>
    <div class="body">Realvampire,<br /><br />A20 line is an artifact left over from the 80286 era. <br /><br />At that time the 80286 CPU was able to acces memory up to 16M. A mistake in CPU made it able to acces 64K ABOVE 1M even in standard real mode 8086 like mode of operation. <br /><br />The bug was related to making a segment base to FFFF that shifted left one digit inside CPU and adding the offset made it possible to acces memory just a little above 1M. <br /><br />Need to say that this &quot;feature&quot; was crashing the old 8086 applications that assumed the memory will WRAP arround and all memory above 1M will actually be above zero. <br /><br />BUt this feature was also nice because after all one could have 1M+64Kb at hiw dispossal. To make everybody happy the PC hardware motherboards proviced a way to ENABLE/DISABLE this feature via a few OUTs to a free port....and guess ot the keyboard controller had a few bits free :P<br /><br />The disable was default mode and it actually hold A20 line at ZERO. This way memory above 1M was translate to 0.<br /><br /><br />So enabling A20 does nothing but allow CPU to not bee crippled by forcefully keeping memory line A20 at ZERO<br /><br />It is NOT allowing you byt itself to acces memory ABOVE 2Mega for example.<br />Normal Real Mode can not acces that memory (but Unreal can)...<br /><br />And trying to use DS:DI is useless unless you want to use that little 64K above 1M.<br /><br />Should use DS:EDI to try and access 32 bit memory but the CPU in real mode has some internal LIMITS setup and will trim EDI to DI  ...<br /><br />The Unreal mode (aka go fast in Protected mode, and load GDT with new limits then return in real mode could help as f0dder told you...but is somehow useless if already in protected mode or V86</div>
    <div class="meta">Posted on 2003-05-13 01:48:41 by BogdanOntanu</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=10733&amp;page=1" style="">&laquo;</a><a href="../?id=10733&amp;page=4" style="">&lt;</a><input type="hidden" name="id" value="10733" /><input type="number" name="page" min="1" max="6" step="1" value="5" onchange="this.form.submit();" /><a href="../?id=10733&amp;page=6">&gt;</a><a href="../?id=10733&amp;page=6">&raquo;</a></form>  </div>
 </body>
</html>