<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Right-aligned menu - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26985" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26985">Right-aligned menu</a></p>
   <div class="post" id="post-194012">
    <div class="subject"><a href="#post-194012">Right-aligned menu</a></div>
    <div class="body">Hi!

I've succeeded once writing in C++ a right-aligned help menu but I can't do it in ASM. Here a code fragment:

<pre><code>
LOCAL mii :MENUITEMINFO

mov mii.cbSize, SIZEOF MENUITEMINFO
mov mii.fMask, MIIM_TYPE

invoke GetMenuItemInfo, hEditorMenu, EDITOR_MENU_HILFE, 0, ADDR mii

mov mii.fType, MFT_RIGHTJUSTIFY
mov mii.dwTypeData, 0

?!?

invoke SetMenuItemInfo, hEditorMenu, EDITOR_MENU_HILFE, 0, ADDR mii
</code></pre>

Near <pre><code>?!?</code></pre> there's something missing. Could anybody help me, please?

Thanx a lot!

stem</div>
    <div class="meta">Posted on 2001-02-22 16:59:00 by stem</div>
   </div>
   <div class="post" id="post-194013">
    <div class="subject"><a href="#post-194013">Right-aligned menu</a></div>
    <div class="body">Well there is two ways of doing this. In a resource file you can just specifiy the HELP attribute like this:

POPUP "Help", HELP
BEGIN
    MENUITEM "About", IDM_ABOUT
END

This will show the help menu on the right, simply replace the text inside the "Help" with whatever you want your menu called.
Or create your menu at run time using the MF_HELP attribute.

Hope this helps!
See ya,
Ben</div>
    <div class="meta">Posted on 2001-02-22 19:23:00 by cyberben</div>
   </div>
   <div class="post" id="post-194014">
    <div class="subject"><a href="#post-194014">Right-aligned menu</a></div>
    <div class="body"><pre><code>
POPUP "Help", HELP
</code></pre>

I get "invalid numeric expression".</div>
    <div class="meta">Posted on 2001-02-23 05:51:00 by stem</div>
   </div>
   <div class="post" id="post-194015">
    <div class="subject"><a href="#post-194015">Right-aligned menu</a></div>
    <div class="body">Hi,

I am using it this way in my resource file:

<pre><code>
#define IDM_GET 1
#define IDM_EXIT 2
#define IDM_HELP_ME 3

FirstMenu MENU
{
 POPUP "&File"
 {
  MENUITEM "&Get", IDM_GET
  MENUITEM "&Exit", IDM_EXIT
 }
 POPUP "&Help",HELP
 {
  MENUITEM "&Help me",IDM_HELP_ME
 }
}
</code></pre>

In my cases this works! :D Hope this helps you! :rolleyes:

Stefan</div>
    <div class="meta">Posted on 2001-02-23 06:26:00 by Stefan Krause</div>
   </div>
   <div class="post" id="post-194016">
    <div class="subject"><a href="#post-194016">Right-aligned menu</a></div>
    <div class="body">Hi,
Yes, this is explained in the Menu tutorial of Iczelion.
Just have a look...</div>
    <div class="meta">Posted on 2001-02-23 06:57:00 by Vom-bonjour:-()</div>
   </div>
  </div>
 </body>
</html>