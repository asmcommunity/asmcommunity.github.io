<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Serial Ports and windows - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7519" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7519">Serial Ports and windows</a></p>
   <div class="post" id="post-54627">
    <div class="subject"><a href="#post-54627">Serial Ports and windows</a></div>
    <div class="body">Hi,  I am trying to wrestle control of COM1 from windows 98, and need some help.<br /><br />So far I have written a simple vb gui (just a simple form) that loads a dynamic vxd that I wrote as well. The vb and the vxd loads and responds correctly. <br /><br />My problem is with gaining control of the serial port. I have tried virtualizing the port, stealing the port and other things, yet nothing lets the port become active so to speak. If I invoke the debugger, I can read from the serial ports registers (COM1, 03F8-03FF) and all registers read &quot;FF&quot;. As though its not there and the data bus is just floating.<br /><br />So I wrote another vb gui that uses the vb comm control. It runs and listens to whatever is coming in on the serial port and pastes it onto a text box, and works correctly.  So obviously the serial port works, and when I invoke the debugger while it's running, I can read the serial port's registers correctly. No more FF's.<br /><br />Does anyone have a clue what is going on? Can windows be intercepting the debuggers attempts to read the ports? I thought the debugger had 100% access to the machine (it runs in ring 0), how could it not see the serial port at all times?<br /><br />Thanks.</div>
    <div class="meta">Posted on 2002-08-23 11:09:26 by sceptor</div>
   </div>
   <div class="post" id="post-54680">
    <div class="subject"><a href="#post-54680">Serial Ports and windows</a></div>
    <div class="body">To answer my own question. Yes windows does indeed trap I/O access.<br />I just started reading Karen Hazzah's book on writing vxd's. Paqe 13, spelled it out.<br /><br />So off to read page 14 LOL.</div>
    <div class="meta">Posted on 2002-08-23 18:08:23 by sceptor</div>
   </div>
  </div>
 </body>
</html>