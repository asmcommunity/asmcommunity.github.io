<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>RadASM 3.0 bugtest - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30013" />
  <link rel="prev" href="../?id=30013&amp;page=1" />  <link rel="next" href="../?id=30013&amp;page=3" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=42">RadASM</a> &raquo; <a href="../?id=30013">RadASM 3.0 bugtest</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=30013&amp;page=1" style="">&laquo;</a><a href="../?id=30013&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="30013" /><input type="number" name="page" min="1" max="4" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=30013&amp;page=3">&gt;</a><a href="../?id=30013&amp;page=4">&raquo;</a></form>   <div class="post" id="post-212144">
    <div class="subject"><a href="#post-212144">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">A suggestion:You could add the option to use format xpmanifest in the projects?<br /><br />Thanks :)<br /><br /><br />:o)</div>
    <div class="meta">Posted on 2010-06-23 14:48:16 by Everdoh</div>
   </div>
   <div class="post" id="post-212184">
    <div class="subject"><a href="#post-212184">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hello Ketil, and thank you for your hard work in creating this wonderful program!<br />Is there any chance you are thinking about a 64-bit version?<br /></div>
    <div class="meta">Posted on 2010-07-01 12:39:57 by c051n3</div>
   </div>
   <div class="post" id="post-212188">
    <div class="subject"><a href="#post-212188">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi Everdoh<br /><br />xpmanifest can be added with Resource / Manifest.<br /><br />KetilO</div>
    <div class="meta">Posted on 2010-07-02 00:29:53 by KetilO</div>
   </div>
   <div class="post" id="post-212189">
    <div class="subject"><a href="#post-212189">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi c051n3<br /><br />Will not happend in many years.<br /><br />KetilO</div>
    <div class="meta">Posted on 2010-07-02 00:31:33 by KetilO</div>
   </div>
   <div class="post" id="post-212190">
    <div class="subject"><a href="#post-212190">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">LOL, people want a 64bit oopasm model too, well someone send me a free 64bit system and I&#039;ll get right on it!<br />Ketilo, keep on rockin.<br /></div>
    <div class="meta">Posted on 2010-07-02 00:59:30 by Homer</div>
   </div>
   <div class="post" id="post-212191">
    <div class="subject"><a href="#post-212191">Re: RadASM 3.0 bugtest</a></div>
    <div class="body"><br />New upload. If you are updating, use Tools / Check for Updates.<br /><br />Version 3.0.0.6 2010-07-02<br />--------------------------<br />o Added support for FreeBASIC.<br />o Fixed bugs.<br /><br />KetilO</div>
    <div class="meta">Posted on 2010-07-02 06:33:39 by KetilO</div>
   </div>
   <div class="post" id="post-212608">
    <div class="subject"><a href="#post-212608">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi KetilO<br />I started to translate the OA addin for RA3 and found some heavy changes on the addin interface to the main program. I have found a solution for most of my problems, like using the menu, managing the output windows, getting the word under the cursor, etc. BTW, in that last case i found that sending the private message REM_GETWORDFROMPOS to the Edit window i get what i want but i am not able to know beforhand the size of the buffer i need to allocate. Is there a solution for that?<br /><br />The main reason i write these lines is because i need to enumerate all code editors (MdiChilds tagged with ID_EDITCODE). The way I&#039;m doing it is using the EnumChildWindows API to get all MDI childs. The I check the GWL_IF field to see if the are in the ID_FIRSTCHILD to ID_LASTCHILD range and finally i get the filename using GetWindowText. Now, my problem is that i can not identify the type of the editor. I want to filter out only those editors tagged with ID_EDITCODE. Can you give me a hint how to perform it?<br /><br />TIA<br /><br />Biterider</div>
    <div class="meta">Posted on 2010-08-10 15:33:08 by Biterider</div>
   </div>
   <div class="post" id="post-212611">
    <div class="subject"><a href="#post-212611">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi Biterider<br /><br />REM_GETWORDFROMPOS:<br />Sorry, no way to know the size needed.<br /><br />The GWL_USERDATA of the mdi child holds the handle of the editor.<br />The GWL_ID of the editor window will contain ID_EDITCODE for all code edit windows.<br /><br />invoke GetWindowLong,hMdiChild,GWL_USERDATA<br />invoke GetWindowLong,eax,GWL_ID<br /><br />KetilO</div>
    <div class="meta">Posted on 2010-08-10 17:10:15 by KetilO</div>
   </div>
   <div class="post" id="post-212641">
    <div class="subject"><a href="#post-212641">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi KetilO<br />I want to continue working on the Addin this weekend but i miss some important information. Can your briefly explain what your are doing during the parsing process, what inormation you are gattering and how can i get access to it?<br /><br />TIA<br /><br />Biterider<br /><br />PS: coding a bit more i came to the AIM_PARSEDONE message. In previous versions i got an ID in the lParam and then i could get the file name using lpGetFileNameFromID. Now, there is no such a function. Is there a way to get the file name?</div>
    <div class="meta">Posted on 2010-08-13 03:28:21 by Biterider</div>
   </div>
   <div class="post" id="post-212660">
    <div class="subject"><a href="#post-212660">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi Biterider<br /><br />When a project is opend I read the filenames from the project file and add it to the project browser (RAProject:RPBM_SETITEM). Then I read the file into memory and send it to the parser (RAProperty:PRM_PARSEFILE).<br />The parsed data is stored as a series of PROPERTIES structures. Each PROPERTIES structure is immediatly followed by one or more zero terminated strings. In RadASM 3.0.0.7 I have added an easy way to add properties. Just send a PRM_ADDPROPERTYITEM message to the property window. wParam=0, lParam=lpPROPERTYITEM.<br /><br /><pre><code><br />PRM_ADDPROPERTYITEM &nbsp; &nbsp;equ WM_USER+49 &nbsp; &nbsp;;wParam=0, lParam=lpPROPERTYITEM<br /><br />PROPERTYITEM struct<br /> &nbsp;nType	DWORD ?				;Type 1 to 255<br /> &nbsp;nOwner	DWORD ?				;Project file ID<br /> &nbsp;nLine	DWORD ?				;Line number<br /> &nbsp;nEndLine	DWORD ?				;Line number<br /> &nbsp;lpszStr	DWORD ?				;Pointer to one or more zero terminated strings<br /> &nbsp;nParts	DWORD ?				;Number of zero terminated strings<br />PROPERTYITEM ends<br /></code></pre><br /><br />Cant see any reason to know the filename. AIM_PARSEFILE contains the pre parsed file in lParam. wParam has the project file id.<br /><br />KetilO</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=3241" target="_blank">RadASM3007.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2010-08-14 04:16:12 by KetilO</div>
   </div>
   <div class="post" id="post-212669">
    <div class="subject"><a href="#post-212669">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi KetilO<br />I added the new definitions to the RAProperty.inc file. The reason for knowing the filename is that the addin is doing also some parsing to gatter extra information. Now, without knowing which file it belongs, most of the new info is useless. I tried to get the filename from the FileID using this code<br /><pre><code>&nbsp; &nbsp; mov eax, .pHandles<br />&nbsp; &nbsp; mov edi, .ADDINHANDLES.hProjectBrowser<br />&nbsp; &nbsp; xor ebx, ebx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;ITEM ID = 0<br />&nbsp; &nbsp; .while TRUE<br />&nbsp; &nbsp; &nbsp; invoke SendMessage, edi, RPBM_FINDNEXTITEM, ebx, 0&nbsp; ;eax -&gt; PBITEM<br />&nbsp; &nbsp; &nbsp; .if eax == NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; .break<br />&nbsp; &nbsp; &nbsp; .else<br />&nbsp; &nbsp; &nbsp; &nbsp; mov ebx, .PBITEM.id <br />&nbsp; &nbsp; &nbsp; &nbsp; .if ebx == dID<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lea eax, .PBITEM.szitem<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .break<br />&nbsp; &nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; .endw<br /></code></pre><br /><br />Running it after all is loaded retunrs the expected file names, but at the moment of parsing, the Project Browser has no idea about the IDs, returning NULL for each request.<br />Do you have suggestions on how I could proceed?<br /><br />Biterider</div>
    <div class="meta">Posted on 2010-08-14 16:06:57 by Biterider</div>
   </div>
   <div class="post" id="post-212683">
    <div class="subject"><a href="#post-212683">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi Biterider<br /><br />Yes, you are right. The project browser was updated after the parsing was done.<br />I have moved the parsing a few lines down so the project browser does contain the info before the parsing is done.<br /><br />SendMessage,hProjectBrowser,RPBM_FINDITEM,pid,NULL should now return a pointer to the PBITEM structure, no need to loop through them all.<br /><br />KetilO</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=3244" target="_blank">RadASM3007.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2010-08-15 02:56:16 by KetilO</div>
   </div>
   <div class="post" id="post-212703">
    <div class="subject"><a href="#post-212703">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi KetilO<br />The last changes work as a charm. I’ll stop coding here for this weekend and want to share my experience using RA3 and coding for it.<br /><br />I was looking for the general strategy for the addins and found a problem that I want try to describe. An addin is designed for a special purpose for a code language, i.e. masm. Now when you create or load a new project, the addin should be able to decide if it should activate or not based on the project information. In RA2 you sent 2 messages to the addins so they know that a new project was started and I’m missing them.<br /><br />Another change in RA3 is that the addins doesn’t have “options” anymore. Is it your intention that the addins manage the options by themselves? <br /><br />A problem I faced when I debug the addin is the SEH protection that doesn’t enable me to use INT 3 to trigger a debugger. For the moment I attach a debugger to the running process before the INT 3 which works but is not so comfortable. Maybe a flag in the ini file to disable the SEH protection for debugging purposes can be a nice solution.<br /><br />Doubleclicking on the editor tabs doesn’t close them anymore. This was a nice feature in a RAD environment that I’m missing very much. Also the undo persistence over sessions was a nice and useful feature that I’m missing.<br /><br />To avoid confusion with different releases of the addin inc files I suggest to use some sort of version numbering.<br /><br />The menu drawing has a glitch on some PC but I don’t know what setting does it trigger. I suspect that it is some font size that sets the menu item height. As you can see, there is a 2 pixel border, possibly drawn when you render the background (picture attached).<br /><br />I notice a performance boost when loading a project which is very positive on slow machines. The reworked interface seems clean and tidy. Also the project manager and its new features are a nice addition. The new auto complete are also very welcome. These additions improve the user experience a lot. All in one, a good step forward!<br /><br />Biterider</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=3245" target="_blank">Glitch.JPG</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2010-08-15 13:14:13 by Biterider</div>
   </div>
   <div class="post" id="post-212892">
    <div class="subject"><a href="#post-212892">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi KetilO<br />This weekend I did some progress porting the old code. While doing it I found some bugs.<br />- New editor files marked as &quot;(Untitled)&quot; are saved as &quot;(Untitled)&quot; without asking for a name.<br />- When the Listbox is shown, it doesnt hide when you change to another editor window.<br />- When the listbox is shown, window scrolling with the mouse wheel should be disabled to avoid scrolling the text behind the listbox. Maybe it can be used to scroll within the listbox itself.<br /><br />RA2 had a mechanism to subclass the editor window to catch i.e. the WM_CHAR message when more than one addin is present. Subclassing the editor window directly when AIM_MDIACTIVATE is fired doesn’t work since the messages are sent always in the same order to all addins. This prevents a correct unsublassing since it should be done in reverse order. This behaviour is seen in the following message dump (red and blue are the outputs of 2 different addins):<br /><br />AIM_RASELCHANGE, hWnd = 000809F2h, wParam = 018748B8h, lParam = 0012EC22h<br />AIM_RASELCHANGE, hWnd = 000809F2h, wParam = 018748B8h, lParam = 0012EC22h<br />AIM_MDIACTIVATE, hWnd = 000809F2h, wParam = 000809F2h, lParam = 00050962h<br />AIM_MDIACTIVATE, hWnd = 000809F2h, wParam = 000809F2h, lParam = 00050962h<br />AIM_RASELCHANGE, hWnd = 00050962h, wParam = 001C65F0h, lParam = 0012F02Eh<br />AIM_RASELCHANGE, hWnd = 00050962h, wParam = 001C65F0h, lParam = 0012F02Eh<br />AIM_MDIACTIVATE, hWnd = 00050962h, wParam = 000809F2h, lParam = 00050962h<br />AIM_MDIACTIVATE, hWnd = 00050962h, wParam = 000809F2h, lParam = 00050962h<br />AIM_MDIACTIVATE, hWnd = 00050962h, wParam = 00050962h, lParam = 000809F2h<br />AIM_MDIACTIVATE, hWnd = 00050962h, wParam = 00050962h, lParam = 000809F2h<br />AIM_RASELCHANGE, hWnd = 000809F2h, wParam = 018748B8h, lParam = 0012F02Eh<br />AIM_RASELCHANGE, hWnd = 000809F2h, wParam = 018748B8h, lParam = 0012F02Eh<br />AIM_MDIACTIVATE, hWnd = 000809F2h, wParam = 00050962h, lParam = 000809F2h<br />AIM_MDIACTIVATE, hWnd = 000809F2h, wParam = 00050962h, lParam = 000809F2h<br /><br />How is it intended to work in RA3?<br /><br />Have you found some time to think about the &quot;Project messages&quot; from my previous post?<br /><br />Regards,<br /><br />Biterider<br /></div>
    <div class="meta">Posted on 2010-08-22 14:37:03 by Biterider</div>
   </div>
   <div class="post" id="post-212898">
    <div class="subject"><a href="#post-212898">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi Biterider<br /><br />Thanks for the bug report, I will look into it.<br /><br />In RadASM 3.0 there is no need to unsubclass. Just subclass when you get an AIM_FILEOPENED with wParam=ID_EDITCODE<br /><br />RadASM 3007 hase some new addin messages.<br /><br />KetilO</div>
    <div class="meta">Posted on 2010-08-23 04:41:26 by KetilO</div>
   </div>
   <div class="post" id="post-212899">
    <div class="subject"><a href="#post-212899">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">New upload. If you are updating, use Tools / Check for Updates.<br /><br />Version 3.0.0.7 2010-08-23<br />--------------------------<br />0 Added double click on a tab to close it.<br />o Added AIM_PROJECTCLOSE, AIM_PROJECTCLOSED, AIM_PROJECTOPEN and AIM_PROJECTOPENED addin messages.<br />o Added hidden option to disable SEH handling. Section , NoSEH=1<br />&nbsp; Uesful when debugging addins.<br />o Added click on statusbar to shopw / hide output window.<br />o Added Empty Undo Buffer to Edit menu.<br />o Fixed bug with Comment / Uncomment. Did not work as it should for languages other than assembly.<br /><br />KetilO</div>
    <div class="meta">Posted on 2010-08-23 04:42:14 by KetilO</div>
   </div>
   <div class="post" id="post-212906">
    <div class="subject"><a href="#post-212906">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi KetilO<br />Thank you for the changes. May it be possible to post the updated inc files from the ...\Masm\Projects\Addins\Inc folder?<br />In particular Addin.inc was not updated from the download of version 3007.<br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2010-08-23 11:07:42 by Biterider</div>
   </div>
   <div class="post" id="post-212982">
    <div class="subject"><a href="#post-212982">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi KetilO<br />May you provide access to the &nbsp;image list used for the CodeCompleteListBox (hCC) to add new icons? What is the size of the used icons?<br />And short example showing the use of CCM_ADDLIST/CC_COLOR/CC_ADDLIST should also be useful.<br /><br />Thanks<br /><br />Biterider</div>
    <div class="meta">Posted on 2010-08-28 03:48:08 by Biterider</div>
   </div>
   <div class="post" id="post-213005">
    <div class="subject"><a href="#post-213005">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi Biterider<br /><br />invoke GetWindowLong,hCC,0 returns a pointer to this structure:<br /><pre><code><br />RACC struct<br />&nbsp; style		dd ?<br />&nbsp; backcolor	dd ?<br />&nbsp; textcolor	dd ?<br />&nbsp; hfont		dd ?<br />&nbsp; fredraw		dd ?<br />&nbsp; itemheight	dd ?<br />&nbsp; cursel		dd ?<br />&nbsp; count		dd ?<br />&nbsp; topindex	dd ?<br />&nbsp; hmem		dd ?<br />&nbsp; lpmem		dd ?<br />&nbsp; cbsize		dd ?<br />&nbsp; himl		dd ?<br />RACC ends<br /></code></pre><br /><br />The size of the icons are 16x16.<br /><br />CCM_ADDLIST wParam=0,lParam pointer to a CC_ADDLIST structure<br />CC_ADDLIST items<br />lpszList is a pointer to a comma separated list of words<br />lpszFilter is a pointer to the string used to filter words to add. The filter is case insensitive.<br />Example: Filter=abc will add all words that starts with abc or ABC.<br />nType is the icon to be used.<br />CC_COLOR is the colors used to draw the listbox.<br /><br />KetilO<br /><br /></div>
    <div class="meta">Posted on 2010-08-30 02:13:55 by KetilO</div>
   </div>
   <div class="post" id="post-213264">
    <div class="subject"><a href="#post-213264">Re: RadASM 3.0 bugtest</a></div>
    <div class="body">Hi KetilO<br />I found a problem using the context ListBox. It happens when i insert a string using CCM_ADDITEM that contains a &quot;[&quot; character, like &quot;&quot;. The item is displayed correctly, but when i select it and press &lt;ENTER&gt; nothing is inserted. Experimenting a bit, it seems that the inserted string is hacked when this character is found.<br /><br />Another issue related to the insertion if items of the context ListBox is that i wanted to use wildcards to filter the the selection. The wildcards are typed as regular characters on the edited line and when you select the wanted item, the string containing the wildcards should be replaced. This works with the &quot;?&quot; but doesntwith the &quot;*&quot; character. The original string is replaced up to the &quot;*&quot;, stopping there. I think you are searching back the beginning of the source string until you find a separator character. An alternative would be to store the index of the first character that fired the context ListBox and replace the source up to this place.<br /><br />I&#039;m using 16x16 icons for the context ListBox imagelist. The ListBox items are drawn with a height of 14 pixels (see attachment) which produces an ugly effect on the icons.<br /><br />Regards,<br /><br />Biterider</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=3255" target="_blank">ScreenShot22.jpg</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2010-10-03 04:29:15 by Biterider</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=30013&amp;page=1" style="">&laquo;</a><a href="../?id=30013&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="30013" /><input type="number" name="page" min="1" max="4" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=30013&amp;page=3">&gt;</a><a href="../?id=30013&amp;page=4">&raquo;</a></form>  </div>
 </body>
</html>