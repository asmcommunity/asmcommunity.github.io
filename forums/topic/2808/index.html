<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>About hooks ... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2808" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2808">About hooks ...</a></p>
   <div class="post" id="post-18072">
    <div class="subject"><a href="#post-18072">About hooks ...</a></div>
    <div class="body">It is possible enumerate all hooks in the system ? Ideas?</div>
    <div class="meta">Posted on 2002-01-07 17:05:10 by elmenda</div>
   </div>
   <div class="post" id="post-18076">
    <div class="subject"><a href="#post-18076">About hooks ...</a></div>
    <div class="body">No you can't, you can only pass messages on to the next hook in the chain. <br />But i have to ask: what do you gain by enumerating other hooks? The only possibility i can see there is to mess with those other hooks, which you shouldn't do, you cannot predict what you will break and how unstable the system will become.</div>
    <div class="meta">Posted on 2002-01-07 17:51:05 by sluggy</div>
   </div>
   <div class="post" id="post-18078">
    <div class="subject"><a href="#post-18078">About hooks ...</a></div>
    <div class="body">I can think of a really good idea why to iterate hooks, at least to find out what process they belong to... to catch sniffers or other trojans and spyware... not the least of which, could be the FBI sniffer we so often hear of in the news lately... and then act upon that process accordingly.<br /><br />You can write a driver that starts while windows is booting and hook all the hook api calls and then keep your own log on who called them... that might help a little...<br /><br /><br /><br />Thanks,<br />_Shawn</div>
    <div class="meta">Posted on 2002-01-07 18:19:07 by _Shawn</div>
   </div>
   <div class="post" id="post-18079">
    <div class="subject"><a href="#post-18079">About hooks ...</a></div>
    <div class="body"><div class="quote"><em>catch sniffers or other trojans and spyware... </em></div><br />Good idea, but MS have not provided a mechanism for enumerating the hooks, unless it is in an undocumented dll. After looking at the doco, it appears the most you could get anyway is a function ptr, not the handle to the hook. And you cannot necessarily unload the hook; a logger would use a global hook which loads the hook dll into every process, releasing the hook only unloads the dll from the process it was unhooked in, not the other processes.<br />Also, think of the hook chain as a linked-list. If you delete an item from the middle of the list, you have to be able to connect up the items on either side of it. Imagine the chaos it would produce on your system if you deleted a hook from the middle of the chain, and didn't connect up the surrounding hooks properly, you would not be able to predict what would happen. Imagine the wrong process getting the wrong mouse or keyboard messages. It could lead to a nuclear meltdown :)</div>
    <div class="meta">Posted on 2002-01-07 19:09:46 by sluggy</div>
   </div>
   <div class="post" id="post-18131">
    <div class="subject"><a href="#post-18131">About hooks ...</a></div>
    <div class="body">sluggy i think _shawn was talking about api-hooks...<br />i don't think you can enumerate all hooks with a simple<br />global hook... btw as far i know hooks can only catch<br />messages and hardware-input... so patching user32.dll<br />or writing a device-driver(?no experience with that?)<br />are the only methods i can think of... and ~if~ you done<br />that you CAN get the hook-Handle and every info you<br />want...</div>
    <div class="meta">Posted on 2002-01-08 03:30:19 by mob</div>
   </div>
  </div>
 </body>
</html>