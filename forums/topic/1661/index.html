<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>getting path information from &quot;browse for folder&quot; - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1661" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1661">getting path information from &quot;browse for folder&quot;</a></p>
   <div class="post" id="post-10602">
    <div class="subject"><a href="#post-10602">getting path information from &quot;browse for folder&quot;</a></div>
    <div class="body">hi,<br />I am new to win32asm, I tried to make a small program thet retrieves folder location from user and then,create a new folder <br />at location's path,<br />The problem is that i couldn't get the right path information from the 'Browse For Folder' dialog .I used the 'SHGetPathFromIDList'<br />function but yeilded wrong info.So, what is the problem?</div>
    <div class="meta">Posted on 2001-10-29 12:03:11 by hosam_shahin</div>
   </div>
   <div class="post" id="post-10607">
    <div class="subject"><a href="#post-10607">getting path information from &quot;browse for folder&quot;</a></div>
    <div class="body">Sorry for the C code, but it works, and shouldn't be too bothersome<br />to convert to asm.<br /><br /><pre><code><br />BROWSEINFO	bi;<br />ITEMIDLIST	*iil;<br /><br />bi.hwndOwner = hwnd;<br />bi.pidlRoot = NULL;<br />bi.pszDisplayName = buf;<br />bi.lpszTitle = lang_string&#40;1000&#41;;<br />bi.ulFlags = BIF_RETURNONLYFSDIRS;<br />bi.lpfn = NULL;<br />bi.lParam = NULL;<br />bi.iImage = 0;<br />iil = SHBrowseForFolder&#40;&amp;bi&#41;;<br />// check if iil==NULL, and handle error<br />SHGetPathFromIDList&#40;iil, buf&#41;;<br /></code></pre></div>
    <div class="meta">Posted on 2001-10-29 12:43:44 by f0dder</div>
   </div>
   <div class="post" id="post-10646">
    <div class="subject"><a href="#post-10646">getting path information from &quot;browse for folder&quot;</a></div>
    <div class="body">Do not forget to CoTaskMemFree() the PIDL handle from SHBrowseForFolder().</div>
    <div class="meta">Posted on 2001-10-29 19:15:32 by comrade</div>
   </div>
   <div class="post" id="post-10665">
    <div class="subject"><a href="#post-10665">getting path information from &quot;browse for folder&quot;</a></div>
    <div class="body">hosam_shahin,<br /><br />have a look in the MASM32 library for a function that is called &quot;BrowseForFolder&quot;. It calls the dialog box you are after with the option of setting the text for both the title bar and the lower message.<br /><br />The source code for it is available in the m32lib directory so you can see how its done as well.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2001-10-30 02:21:58 by hutch--</div>
   </div>
   <div class="post" id="post-10674">
    <div class="subject"><a href="#post-10674">getting path information from &quot;browse for folder&quot;</a></div>
    <div class="body"><div class="quote"><br />Do not forget to CoTaskMemFree() the PIDL handle from SHBrowseForFolder().<br /></div><br />Thanks for that little bit, comrade - I hadn't even been thinking about this :(.<br />:stupid:</div>
    <div class="meta">Posted on 2001-10-30 05:10:01 by f0dder</div>
   </div>
   <div class="post" id="post-10753">
    <div class="subject"><a href="#post-10753">getting path information from &quot;browse for folder&quot;</a></div>
    <div class="body">f0dder, thanx to you ..I did it!:alright:</div>
    <div class="meta">Posted on 2001-10-30 16:35:40 by hosam_shahin</div>
   </div>
  </div>
 </body>
</html>