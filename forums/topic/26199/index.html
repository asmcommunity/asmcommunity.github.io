<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Resource Script - Adding a AVI - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26199" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26199">Resource Script - Adding a AVI</a></p>
   <div class="post" id="post-190602">
    <div class="subject"><a href="#post-190602">Resource Script - Adding a AVI</a></div>
    <div class="body">in the windows API documentation it says I can load an AVI from the resource.. Ok.. I know how to add an ICON.. also a BITMAP. but, how whould I add an AVI to a resorce script?

Thank you all in advance. 

Jason</div>
    <div class="meta">Posted on 2000-11-22 11:58:00 by tudisco</div>
   </div>
   <div class="post" id="post-190603">
    <div class="subject"><a href="#post-190603">Resource Script - Adding a AVI</a></div>
    <div class="body">No tag specifically for AVI. You must include the AVI as a custom resource and then load it with FindResource/LoadResource/LockResource functions.</div>
    <div class="meta">Posted on 2000-11-22 19:51:00 by Iczelion </div>
   </div>
   <div class="post" id="post-190604">
    <div class="subject"><a href="#post-190604">Resource Script - Adding a AVI</a></div>
    <div class="body">that is what I thought... But the API docs said somthing about using MAKEINTRESOURCE macro.. I tried making a custom resource and using MAKEINTRESOURCE.. but I had no luck with that. So I just embeded it into my program... When I need it, I spit it out into a file and load it.. I don't know how to load an AVI using win32 API with a resource handle. If someone could give me a clue that would be cool.

Jason</div>
    <div class="meta">Posted on 2000-11-22 21:09:00 by tudisco </div>
   </div>
   <div class="post" id="post-190605">
    <div class="subject"><a href="#post-190605">Resource Script - Adding a AVI</a></div>
    <div class="body">ignore MAKEINTRESOURCE. It's a C macro. We have no need for it in our asm program. Just replace it with the ID of your AVI resource.

If your resource ID is defined in .rc file as:
#define ID_AVI 1000

In your code,

ID_AVI equ 1000
.....
invoke FindResource,hInstance,ID_AVI,RT_RCDATA
mov hResource,eax
invoke LoadResource,hInstance,hResource
mov ResourceHandle,eax
invoke LockResource,ResourceHandle

There, you have the pointer to your AVI data</div>
    <div class="meta">Posted on 2000-11-22 21:49:00 by Iczelion </div>
   </div>
   <div class="post" id="post-190606">
    <div class="subject"><a href="#post-190606">Resource Script - Adding a AVI</a></div>
    <div class="body">Thanks a bunch...  Going to try that that right now! 

thanks for helping.. :) .. Very nice of you..

jason</div>
    <div class="meta">Posted on 2000-11-23 02:57:00 by tudisco </div>
   </div>
  </div>
 </body>
</html>