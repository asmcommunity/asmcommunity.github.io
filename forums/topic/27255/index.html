<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>new command - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27255" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27255">new command</a></p>
   <div class="post" id="post-195310">
    <div class="subject"><a href="#post-195310">new command</a></div>
    <div class="body">one of the basic commands in a OOP language is the new() command to create a new object.

How could I implement this in ASM?
Imagine, the object consists of a couple of methods, a data structure for the object and a pre-defined virtual table with a given sorting of method call-in-addresses.

beaster.</div>
    <div class="meta">Posted on 2001-03-16 06:02:00 by beaster</div>
   </div>
   <div class="post" id="post-195311">
    <div class="subject"><a href="#post-195311">new command</a></div>
    <div class="body">Do you have MASM32 Service Pack 2? Look inside for the COM section.

  There you will find the "Inside CoLob" document, and all the source code for making COM objects.

  In short, you define a ClassItem structure, and pass this to the AllocObject procedure of CoLib. AllocObject reads out the information in the ClassItem, creates, initializes (runs an optional constructor too) a new object, and returns a reference to it.</div>
    <div class="meta">Posted on 2001-03-16 08:10:00 by Ernie</div>
   </div>
   <div class="post" id="post-195312">
    <div class="subject"><a href="#post-195312">new command</a></div>
    <div class="body">Actually, with a whole day of hindsight behind me now, I think perhaps a better discussion of classed, objects, and NEW may be found in my "Creating a COM object in ASM" tutorial. 

Understanding the nuances of CoLib in one shot is kinda a streatch, and this tut describes a much simpler object, perhaps an initially more useful one.

But in the long run, CoLib will do a lot more grunt work for you.</div>
    <div class="meta">Posted on 2001-03-16 16:24:00 by Ernie</div>
   </div>
  </div>
 </body>
</html>