<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>IServiceProvider/ITimerService? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14593" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=14593">IServiceProvider/ITimerService?</a></p>
   <div class="post" id="post-112898">
    <div class="subject"><a href="#post-112898">IServiceProvider/ITimerService?</a></div>
    <div class="body">Greetings everybody, <br />Does anyone have any info on the <strong>IServiceProvider::QueryService</strong> method? I'm trying to get a pointer to the <strong>ITimerService</strong> interface and I don't have any idea as to what is required for the first parameter of the method. The prototype is as follows:<br /><br />HRESULT QueryService(          <br />    REFGUID guidService,<br />    REFIID riid,<br />    void **ppv<br />);<br /><br />guidService:  Unique identifier of the service (a SID). <br />riid:  Unique identifier of the interface the caller wishes to receive for the service. <br /><br />The second parameter should be <strong>IID_ITimerService</strong>. What about the first?<br />Is there a specific timer associated <strong>SID</strong> on Win2K? <br /><br /><br />Or equivalently, What is the <strong>SID</strong> associated with the <strong>Windows Timer Service</strong> (<strong>W32Timer</strong>)?<br /></div>
    <div class="meta">Posted on 2003-08-03 21:41:38 by Poimander</div>
   </div>
   <div class="post" id="post-112909">
    <div class="subject"><a href="#post-112909">IServiceProvider/ITimerService?</a></div>
    <div class="body">Hi Poimander,<br /><br />its totally up to the object what is accepts as SID.<br />Some SIDs are defined for windows shell and IE in shlguid.h for example.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-08-04 00:14:21 by japheth</div>
   </div>
   <div class="post" id="post-113022">
    <div class="subject"><a href="#post-113022">IServiceProvider/ITimerService?</a></div>
    <div class="body">Hi <strong>japheth</strong>,<br />Apparently only a few objects actually support the <strong>IServiceProvider</strong><br />interface, but I still haven't been able to get a pointer to the <strong>ITimerService</strong>. There is very little info on the net, so it appears the <strong>ITimerService</strong> interface isn't really supported in practice, otherwise <strong>MS</strong> would have produced dedicated examples of it's usage by now.</div>
    <div class="meta">Posted on 2003-08-04 18:49:37 by Poimander</div>
   </div>
   <div class="post" id="post-116224">
    <div class="subject"><a href="#post-116224">IServiceProvider/ITimerService?</a></div>
    <div class="body">Here you go Poimander, from comdef.h<br /><br />struct __declspec(uuid(&quot;3050F35F-98B5-11CF-BB82-00AA00BDCE0B&quot;)) ITimerService;</div>
    <div class="meta">Posted on 2003-08-30 00:08:01 by djinn</div>
   </div>
  </div>
 </body>
</html>