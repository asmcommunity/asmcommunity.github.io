<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>test of :POINT - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26727" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26727">test of :POINT</a></p>
   <div class="post" id="post-192760">
    <div class="subject"><a href="#post-192760">test of :POINT</a></div>
    <div class="body">between code tags 
<pre><code>:POINT</code></pre>
not between code tags
 :POINT

This message was edited by Hiroshimator, on 2/1/2001 12:03:47 AM</div>
    <div class="meta">Posted on 2001-02-01 00:02:00 by Hiroshimator</div>
   </div>
   <div class="post" id="post-192761">
    <div class="subject"><a href="#post-192761">test of :POINT</a></div>
    <div class="body">Checking the tags:

<pre><code>

    indentation

<brackets>

   weird    spacing   here ; cause I want it like this
...-----....-------...----.-.-----.-.----.--.----.----


</code></pre>

seeya</div>
    <div class="meta">Posted on 2001-02-01 00:13:00 by Ernie</div>
   </div>
   <div class="post" id="post-192762">
    <div class="subject"><a href="#post-192762">test of :POINT</a></div>
    <div class="body">hmm it eats the first?

and my net connection is gone with everything but netscape, can't even FTP or IRC what's up with that?</div>
    <div class="meta">Posted on 2001-02-01 00:53:00 by Hiroshimator</div>
   </div>
   <div class="post" id="post-192763">
    <div class="subject"><a href="#post-192763">test of :POINT</a></div>
    <div class="body">et voila fixed</div>
    <div class="meta">Posted on 2001-02-01 02:25:00 by Hiroshimator</div>
   </div>
   <div class="post" id="post-192764">
    <div class="subject"><a href="#post-192764">test of :POINT</a></div>
    <div class="body">;---------------------------------------------------------------------
; the following prototypes are for polymorphic interface names, since
;  MASM does not assosciate the ptr typedefs with a particular struct.
;
; These particular comflicting interfaces lead to the new name decoration
;
; problem interfaces (polymprphic)
;  IDispatch_GetTypeInfo   comethod4 ?
;  IRecordInfo_GetTypeInfo comethod2 ?
;  ITypeLib_GetTypeInfo    comethod3 ?
;
;---------------------------------------------------------------------
<pre><code>

option expr32
option casemap:none
option dotname

IFNDEF          OAIDL_INC
OAIDL_INC       EQU        1

;---------------------------------------------------------------------
; coinvoke MACRO 
;
; invokes an abritrary COM interface 
;
; revised 12/29/00 to check for edx as a param and force compilation error
;                   (thanks to Andy Car for a how-to suggestion)
; revised 7/18/00 to pass pointer in edx not eax to aviod confusion with
;   parmas passed with ADDR  (Jeremy Collake's excellent suggestion)
; revised 5/4/00 for member function name decoration
; see http://ourworld.compuserve.com/homepages/ernies_world/coinvoke.htm
;
; pInterface    pointer to a specific interface instance
; Interface     the Interface's struct typedef
; Function      which function or method of the interface to perform
; args          all required arguments 
;                   (type, kind and count determined by the function)
;
coinvoke MACRO pInterface:REQ, Interface:REQ, Function:REQ, args:VARARG
    LOCAL istatement, arg
    FOR arg, <args>     ;; run thru args to see if edx is lurking in there
        IFIDNI <&arg>, <edx>
            .ERR <edx is not allowed as a coinvoke parameter>
        ENDIF
    ENDM
    istatement CATSTR <invoke (Interface PTR).&Interface>,<_>,<&Function, pInterface>
    IFNB <args>     ;; add the list of parameter arguments if any
        istatement CATSTR istatement, <, >, <&args> 
    ENDIF 
    mov edx, pInterface
    mov edx, 
    istatement
ENDM

 
;---------------------------------------------------------------------
; equate primitives for use with other structures besides .IF
SUCCEEDED   TEXTEQU     <!!SIGN?>
FAILED      TEXTEQU     <!!SUCCEEDED>

;---------------------------------------------------------------------
; tests the value in eax to determine if the previous COM call
; issued a passing hresult
.IF_SUCCEEDED MACRO
    test eax, eax
    .IF SUCCEEDED
ENDM

;---------------------------------------------------------------------
; tests the value in eax to determine if the previous COM call
; issued a failing hresult
.IF_FAILED   MACRO
    test eax, eax
    .IF FAILED
ENDM

DECIMAL_SETZERO MACRO ddec:REQ
; #define DECIMAL_SETZERO(dec) {(dec).Lo64 = 0; (dec).Hi32 = 0; (dec).signscale = 0;}
    lea eax, ddec
    mov (DECIMAL PTR ).Lo32,  0
    mov (DECIMAL PTR ).Mid32, 0
    mov (DECIMAL PTR ).Hi32,  0
    mov (DECIMAL PTR ).signscale, 0
ENDM






L MACRO sText:REQ
    LOCAL str, chr, flag
    ;; generates a wide character string 
    ;; useage:       sztext   wchar   L(<Hello World \|\|\0>)
    ;; generates:    sztext   WORD    "H","e","l","l","o","," ",
    ;;                                "W","o","r","l","d","!","!",0
    ;; max string length is 57 chars (MASM line length limit)
    ;;  use multiple non-zero term strings in sequence for longer strings
    ;;  (zero term the last of course)
        str  TEXTEQU < >
        flag TEXTEQU <.>
        FORC chr, <&sText> 
            IFDIF flag, <\>
                IFDIF str, < >
                    str CATSTR str, <,>
                ENDIF
            ENDIF
            IFDIF flag, <\>
                IFIDN <&chr>, <\>
                    flag CATSTR <\>
                ELSE
                    str CATSTR str, <">, <&chr>, <">
                ENDIF
            ELSE
                flag CATSTR <none> 
                ;; check for a pipe (exclamation point)
                IFIDN <&ch</div>
    <div class="meta">Posted on 2001-02-01 02:29:00 by Ernie</div>
   </div>
  </div>
 </body>
</html>