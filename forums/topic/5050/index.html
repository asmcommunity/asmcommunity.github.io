<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>M32Lib update... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5050" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5050">M32Lib update...</a></p>
   <div class="post" id="post-35491">
    <div class="subject"><a href="#post-35491">M32Lib update...</a></div>
    <div class="body">Hey all,<br /><br /> I was playing around with the MASM32.lib 'ColorDialog' function, and discovered it has one short coming.  You can not chose the color Black because the function returns 0 if you hit cancle as well.<br /><br />To me this was no good.  So i made some simple changes and fixed a bug in it (EDI was not being preserved ~ I dunno how it didnt cause a Fault, but anyways).<br /><br />With this version, It acts 100% the same, except that upon returning from the function, the ZERO FLAG will be set or cleared depending on if the CANCLE button was hit or not.<br /><br /><pre><code>     invoke ColorDialog, hWnd, NULL, CC_FULLOPEN<br />     jz @Cancle_Pressed<br />     mov hColor, eax<br />     ...</code></pre><br /><br />This works quite nicely now, so i thought i would post it for anyone interested.  You will need to overwrite your old ColorDlg.asm file in the M32LIB directory with this, and recompile your library with the MAKE.bat in the same directory.  Then it will be updated into your MASM32.LIB.<br /><br />Enjoy<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-04-28 20:46:30 by NaN</div>
   </div>
  </div>
 </body>
</html>