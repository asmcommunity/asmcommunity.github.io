<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Disabling File Process in Use - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24643" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24643">Disabling File Process in Use</a></p>
   <div class="post" id="post-180052">
    <div class="subject"><a href="#post-180052">Disabling File Process in Use</a></div>
    <div class="body">Hi Guys<br /><br /><br />How to enable a file to be opened when it is in use ?<br /><br />I mean, the GetOpenFileName and CreateFile apis, when opens a file that is in uses returns on eax the value of 0-1, meaning tyhat this file is being used by another process.<br /><br />How can i get acess to that file ? I mean, how can i open it ?<br /><br />Do i need to make a copy of it ? If it is, how can i copy a file whose prcess is being used ?<br /><br /><br />Best Regards<br /><br />Guga</div>
    <div class="meta">Posted on 2006-04-22 11:35:37 by Beyond2000!</div>
   </div>
   <div class="post" id="post-180063">
    <div class="subject"><a href="#post-180063">Re: Disabling File Process in Use</a></div>
    <div class="body">The other process(es) that have the file open need to open the file with a non-zero share flag - ie, allow either FILE_SHARE_READ or FILE_SHARE_WRITE - or both.<br /></div>
    <div class="meta">Posted on 2006-04-22 14:14:04 by f0dder</div>
   </div>
   <div class="post" id="post-180064">
    <div class="subject"><a href="#post-180064">Re: Disabling File Process in Use</a></div>
    <div class="body">If a file is locked nad NOT shared for reading/writing, then you CANNOT gain access to it in any &#39;normal&#39; way.</div>
    <div class="meta">Posted on 2006-04-22 14:14:55 by ti_mo_n</div>
   </div>
   <div class="post" id="post-180099">
    <div class="subject"><a href="#post-180099">Re: Disabling File Process in Use</a></div>
    <div class="body">Hi Guys<br /><br />Tks..but.. i´m still confused about this.<br /><br />The problem started when i got infected&nbsp; and tried to remove the damn file from my computer. The only tool that was able to remove that was karpesky. It disabled somehow the attibutes of the file and deleted it.<br /><br /><br />This is what i needed to know. How this can be done. I mean, removing or changing the attibutes of a file (even when it is being used) to delete it, or jyst to allow opening it to see what a hell is happening with that file.<br /><br />F00der...i know that someone may misinterpretate this kind of suject here...So, can you pls, help me ? May i explain exactly what is happenning here on PM ?<br /><br />I need urgent help.<br /><br />Best Regards<br /><br />Guga</div>
    <div class="meta">Posted on 2006-04-23 17:18:59 by Beyond2000!</div>
   </div>
   <div class="post" id="post-180108">
    <div class="subject"><a href="#post-180108">Re: Disabling File Process in Use</a></div>
    <div class="body">One way is to queue the file to be Moved when the system is rebooted, and create a run-once registry key to execute a small script or exe that deletes the Moved file(s) when the system has rebooted.<br />This is how many common antivirus-style programs achieve what you are asking, without resorting to any dirty tricks.</div>
    <div class="meta">Posted on 2006-04-23 20:38:06 by Homer</div>
   </div>
   <div class="post" id="post-180118">
    <div class="subject"><a href="#post-180118">Re: Disabling File Process in Use</a></div>
    <div class="body">Guga, if you just need to delete a file, you can boot into &quot;rescue console&quot; mode from an XP or 2k install CD. Perhaps &quot;safe mode with command prompt&quot; (from the F8-at-boot) menu will even be enough.<br /><br />There&#39;s probably some method to *force* all handles to a file to be closed, but I haven&#39;t looked into this. You could grab a tool like &quot;WhoLockMe&quot; to see which processes has your file open though, and then manually kill those processes... then you should be able to delete the file.<br /></div>
    <div class="meta">Posted on 2006-04-24 01:16:03 by f0dder</div>
   </div>
   <div class="post" id="post-180132">
    <div class="subject"><a href="#post-180132">Re: Disabling File Process in Use</a></div>
    <div class="body">Hi Guys<br /><br />Tks a LOT<br /><br />I´ll boot under console mode and delete that damn thing.<br /><br />About wholockme i´ll take a look at it, thsi may be good to at least knows what a hell is happening with some files when i have no more access to it. And maybe trace the damn virus the next time, and not only the infected file.<br /><br />Tks a LOT, guys :)<br /><br />Best Regards,<br />Guga<br /><br /></div>
    <div class="meta">Posted on 2006-04-24 11:53:07 by Beyond2000!</div>
   </div>
   <div class="post" id="post-180133">
    <div class="subject"><a href="#post-180133">Re: Disabling File Process in Use</a></div>
    <div class="body">Glad to have helped :)<br /></div>
    <div class="meta">Posted on 2006-04-24 13:49:18 by f0dder</div>
   </div>
  </div>
 </body>
</html>