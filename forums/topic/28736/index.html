<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>FileTime calculation - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=28736" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=28736">FileTime calculation</a></p>
   <div class="post" id="post-203041">
    <div class="subject"><a href="#post-203041">FileTime calculation</a></div>
    <div class="body">Hello<br /><br />I have made a little app for deleting files in folders.<br />I want to upgrade it, and add to the application the possibility to erase file older than x days ...<br /><br />In a edit box, the user can put the number of day to keep the files ...<br />But&nbsp; how can i substract from the FIletime file the (for example) three days and after that compare the calculated time with the selected filetime of the file...<br /><br />Thanks a lot&nbsp; ;)</div>
    <div class="meta">Posted on 2007-09-24 13:47:17 by Bros</div>
   </div>
   <div class="post" id="post-203045">
    <div class="subject"><a href="#post-203045">Re: FileTime calculation</a></div>
    <div class="body">Uh uh uh - I know that one..&nbsp; :D<br /><br />Look into <a target="_blank" href="http://msdn2.microsoft.com/en-us/library/ms724284.aspx">FILETIME</a> the Struct and <a target="_blank" href="http://msdn2.microsoft.com/en-us/library/ms724950.aspx">SYSTEMTIME</a> the struct. Also look at the Api&#039;s named <a target="_blank" href="http://msdn2.microsoft.com/en-us/library/ms724280.aspx">FileTimeToSystemTime</a> and <a target="_blank" href="http://msdn2.microsoft.com/en-us/library/ms724948.aspx">SystemTimeToFileTime</a>.<br /><br />Using the Transfer back and forth you can figure out what date it is. But to do calculations on the time itself, like adding, deducting days etc, you need to convert the FileTime to to days since 01.01.1601 as explained <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=20066.msg153751#msg153751">here</a> by KetilO.<br /><br />Good Luck - JimmyClif</div>
    <div class="meta">Posted on 2007-09-24 17:46:39 by JimmyClif</div>
   </div>
   <div class="post" id="post-203059">
    <div class="subject"><a href="#post-203059">Re: FileTime calculation</a></div>
    <div class="body">Thanks It work very well<br /><br /> ;)<br /><br />Bros</div>
    <div class="meta">Posted on 2007-09-25 07:29:21 by Bros</div>
   </div>
  </div>
 </body>
</html>