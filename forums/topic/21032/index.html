<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>AsmCtrl.asm is still killing the explorer when closing it - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21032" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21032">AsmCtrl.asm is still killing the explorer when closing it</a></p>
   <div class="post" id="post-159397">
    <div class="subject"><a href="#post-159397">AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body">Is the asmctrl.ocx still killing the IE in the current state or I am trying an old one?&nbsp; :shock:</div>
    <div class="meta">Posted on 2005-04-29 12:55:38 by lacika</div>
   </div>
   <div class="post" id="post-159405">
    <div class="subject"><a href="#post-159405">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body"><br />Hello,<br /><br />it depends what AsmCtrl.ocx you mean. The one supplied with MASM32 still is buggy (and I&#39;m afraid this won&#39;t change&nbsp; cause the author has lost interest in this subject). The one on my site should work with IE.<br /><br /><br /></div>
    <div class="meta">Posted on 2005-04-29 20:10:33 by japheth</div>
   </div>
   <div class="post" id="post-159408">
    <div class="subject"><a href="#post-159408">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body">Thank you. I have some little fears from that code on your page :) because I got a lot of errors when assembling - settings, I am sure it can work, just how -, I am absolutely beginner in COM and I&#39;d have to fill it with a lot of datas. That&#39;s why I was trying the other one. Don&#39;t have any suggestion where that masm32 asmctrl is buggy?<br /><br />Btw my problems are the next errors when linking your asmctrl:<br /><br /><br />C:\MASM32\LIB\kernel32.lib : warning LNK4064: conflicting subsystem; image may not run<br />C:\MASM32\LIB\advapi32.lib : warning LNK4064: conflicting subsystem; image may not run<br />C:\MASM32\LIB\user32.lib : warning LNK4064: conflicting subsystem; image may not run<br />C:\MASM32\LIB\gdi32.lib : warning LNK4064: conflicting subsystem; image may not run<br />C:\MASM32\LIB\oleaut32.lib : warning LNK4064: conflicting subsystem; image may not run<br />C:\MASM32\LIB\ole32.lib : warning LNK4064: conflicting subsystem; image may not run<br />C:\MASM32\LIB\uuid.lib : warning LNK4064: conflicting subsystem; image may not run<br />&nbsp;  Creating library RELEASE\AsmCtrl.lib and object RELEASE\AsmCtrl.exp<br />AsmCtrl.obj : error LNK2001: unresolved external symbol _IID_IUnknown<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IUnknown<br />CAsmProp.obj : error LNK2001: unresolved external symbol _IID_IUnknown<br />AsmCtrl.obj : error LNK2001: unresolved external symbol _IID_IClassFactory<br />CAsmClass.obj : error LNK2001: unresolved external symbol _GUID_NULL<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IPersist<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IPersistStream<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IPersistStorage<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IDataObject<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IOleObject<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IOleWindow<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IOleInPlaceFrame<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IOleInPlaceObject<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IOleInPlaceSite<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IViewObject<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IViewObject2<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IDispatch<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IEnumConnections<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IConnectionPoint<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IEnumConnectionPoints<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IConnectionPointContainer<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IProvideClassInfo<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IOleControl<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IOleControlSite<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_ISpecifyPropertyPages<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IPersistStreamInit<br />CAsmClass.obj : error LNK2001: unresolved external symbol _IID_IPersistPropertyBag<br />CAsmClass.obj : error LNK2001: unresolved external symbol _CLSID_StockFontPage<br />CAsmClass.obj : error LNK2001: unresolved external symbol _CLSID_StockColorPage<br />CAsmProp.obj : error LNK2001: unresolved external symbol _IID_IPropertyPage<br />RELEASE\AsmCtrl.dll : fatal error LNK1120: 28 unresolved externals<br /><br />What I&#39;m doing wrong?</div>
    <div class="meta">Posted on 2005-04-30 04:50:07 by lacika</div>
   </div>
   <div class="post" id="post-159411">
    <div class="subject"><a href="#post-159411">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body"><br />Don&#39;t use the libraries coming with MASM32 Version 8+, they lack some parts vital for COM. Use the versions from MS Platform SDK and/or read the article about MASM32 problems on my site.<br /><br /></div>
    <div class="meta">Posted on 2005-04-30 06:58:35 by japheth</div>
   </div>
   <div class="post" id="post-159412">
    <div class="subject"><a href="#post-159412">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body">Thanks a lot, I see...</div>
    <div class="meta">Posted on 2005-04-30 07:10:41 by lacika</div>
   </div>
   <div class="post" id="post-159446">
    <div class="subject"><a href="#post-159446">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body">I am watching it, um... I have a problem. I assemble, link, it works, I am happy. After Ichange a line or anything, assemble, link, no error, but I cannot register anymore, error No 5 when running regsvr32.exe with it. Maybe it isn&#39;t the changing which is the cause but then what?&nbsp; :shock:</div>
    <div class="meta">Posted on 2005-05-01 18:24:40 by lacika</div>
   </div>
   <div class="post" id="post-159457">
    <div class="subject"><a href="#post-159457">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body"><br />I dont know. Be sure the type library is included in the resources. To test this load the dll with comview and check if there is typeinfo available.<br /></div>
    <div class="meta">Posted on 2005-05-02 04:31:20 by japheth</div>
   </div>
   <div class="post" id="post-159460">
    <div class="subject"><a href="#post-159460">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body">Hm. The typelib is in the rc file, I mean included. Anything around registering? Sorry if I am asking too much, my experiences are only for the general win32 programming, nothing with COM. Maybe the error isn&#39;t showing because of the little changes but cause of the multiple registering-unregistering? Yours doesn&#39;t do that?</div>
    <div class="meta">Posted on 2005-05-02 05:20:39 by lacika</div>
   </div>
   <div class="post" id="post-159462">
    <div class="subject"><a href="#post-159462">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body"><br />Usually you can register/unregister as many times as you like. If you register a dll, regsrv32 will call dll entry point DllRegisterServer, that&#39;s all. I would suggest you to post the modifications or - if absolutely necessary - email me the binary.<br /> </div>
    <div class="meta">Posted on 2005-05-02 05:43:11 by japheth</div>
   </div>
   <div class="post" id="post-159463">
    <div class="subject"><a href="#post-159463">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body">I sent the email, thank you.</div>
    <div class="meta">Posted on 2005-05-02 05:55:29 by lacika</div>
   </div>
   <div class="post" id="post-159465">
    <div class="subject"><a href="#post-159465">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body"><br />I got your dll. There *is* a problem with it, it cannot be loaded with LoadLibrary. Using a PE file dumper I can see that there is an invalid IAT entry!? How do you link this binary?<br /><br /></div>
    <div class="meta">Posted on 2005-05-02 06:23:31 by japheth</div>
   </div>
   <div class="post" id="post-159473">
    <div class="subject"><a href="#post-159473">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body">link /DLL /LIBPATH:lib /OUT:AsmCtrl.dll /MAP:AsmCtrl.map /DEF:AsmCtrl.def AsmCtrl.obj CAsmClass.obj CAsmProp.obj rsrc.res kernel32.lib advapi32.lib user32.lib gdi32.lib<br /><br />But how can the MS linker - btw 5.00.7022, not the newest but works - produce wrong code? And... once or twice it made correct file. Pulling out my hair.</div>
    <div class="meta">Posted on 2005-05-02 09:20:25 by lacika</div>
   </div>
   <div class="post" id="post-159479">
    <div class="subject"><a href="#post-159479">Re: AsmCtrl.asm is still killing the explorer when closing it</a></div>
    <div class="body">I found it. I had two bad libraries, the MS linker didn&#39;t say it, just swallow, swallow, an other linker stopped, I changed... it works, even with the MS. Sorry for my suffering, thank you for the help!&nbsp; :lol:</div>
    <div class="meta">Posted on 2005-05-02 13:53:09 by lacika</div>
   </div>
  </div>
 </body>
</html>