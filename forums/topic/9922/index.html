<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Align Text to Bottom in Edit Control? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9922" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9922">Align Text to Bottom in Edit Control?</a></p>
   <div class="post" id="post-74061">
    <div class="subject"><a href="#post-74061">Align Text to Bottom in Edit Control?</a></div>
    <div class="body">how can I align the text to the bottom in an (multiline) editcontrol ?<br /><br />default is aligned to the top:<br /><pre><code>+------------------+<br />|Hello             |<br />|World!            |<br />|                  |<br />|                  |<br />+------------------+</code></pre>But I want it aligned to the bottom like this:<pre><code>+------------------+<br />|                  |<br />|                  |<br />|Hello             |<br />|World!            |<br />+------------------+</code></pre><br />Any ideas? I played around with EM_GETRECT and EM_SETRECT, but still cant get it right :(</div>
    <div class="meta">Posted on 2003-01-02 16:52:09 by savage</div>
   </div>
   <div class="post" id="post-74079">
    <div class="subject"><a href="#post-74079">Align Text to Bottom in Edit Control?</a></div>
    <div class="body">You can perhaps get size of text (vertical), and use <strong>EM_SETRECTNP</strong> to set the top area (<strong>height of edit control</strong> - <strong>height of text</strong>).</div>
    <div class="meta">Posted on 2003-01-02 18:39:34 by comrade</div>
   </div>
   <div class="post" id="post-74188">
    <div class="subject"><a href="#post-74188">Align Text to Bottom in Edit Control?</a></div>
    <div class="body">thnx guys, i have it working now. :alright:<br /><br />I use EM_GETLINECOUNT and GetTextMetrics to calculate the total vertical height of the text.<br /><br />But if I use a different font/size it doesnt align properly. I think its because GetTextMetrics doesnt return the size in pixels. Any other way to get the font's height in pixels? I've tried GetTextExtentPoint32 but it returns the same height as GetTextMetrics :(</div>
    <div class="meta">Posted on 2003-01-03 16:49:38 by savage</div>
   </div>
   <div class="post" id="post-74214">
    <div class="subject"><a href="#post-74214">Align Text to Bottom in Edit Control?</a></div>
    <div class="body"><strong>GetTextExtentPoint32</strong> works fine for me. I would suggest you use it in combination with <strong>GetDC(hEdit)</strong>.</div>
    <div class="meta">Posted on 2003-01-03 18:58:14 by comrade</div>
   </div>
   <div class="post" id="post-74287">
    <div class="subject"><a href="#post-74287">Align Text to Bottom in Edit Control?</a></div>
    <div class="body">Oops, I used WM_SETFONT the set the font of the editcontrol so I totally forgot to select the fonthandle into the devicecontext, thats why it kept returning the same values :o <br /><br />:stupid: <br /><br />But it works great now, thanks guys! :alright:</div>
    <div class="meta">Posted on 2003-01-04 07:59:20 by savage</div>
   </div>
  </div>
 </body>
</html>