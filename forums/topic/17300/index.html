<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Get EXE name without API...!(KnowledgeBase-KB) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17300" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=17300">Get EXE name without API...!(KnowledgeBase-KB)</a></p>
   <div class="post" id="post-134061">
    <div class="subject"><a href="#post-134061">Get EXE name without API...!(KnowledgeBase-KB)</a></div>
    <div class="body">Hi All....I think Everybody know how to Get Path Name and File Name <br />With the Help of API's....<br /><br />But how to do it without the Help of API....?<br />Ya, We can do it by digging thru the Stacks &amp; Environment database it self...<br />Here the program......<br /><br /><em><strong>NOTE:-&gt;ONLY WORKS on 9X systems</strong></em></div>
    <div class="meta">Posted on 2004-02-18 11:40:13 by zakham</div>
   </div>
   <div class="post" id="post-134214">
    <div class="subject"><a href="#post-134214">Get EXE name without API...!(KnowledgeBase-KB)</a></div>
    <div class="body">How about approaching the question like this?<br /><br /><pre><code>FS -&gt; Thread Information Block<br />       V<br />      30h -&gt; ??? process database<br />              V<br />             10h -&gt; ???<br />                     V<br />                    3Ch -&gt; unicode string with drive, path and filename<br /><br />MOV	EAX, FS&#58;&#91;30h&#93;<br />MOV	EAX, &#91;EAX + 10h&#93;<br />MOV	EAX, &#91;EAX + 3Ch&#93;</code></pre></div>
    <div class="meta">Posted on 2004-02-19 13:35:48 by Cuby</div>
   </div>
  </div>
 </body>
</html>