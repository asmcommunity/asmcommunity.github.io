<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>an error when linker via RadAsm - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4801" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=42">RadASM</a> &raquo; <a href="../?id=4801">an error when linker via RadAsm</a></p>
   <div class="post" id="post-33651">
    <div class="subject"><a href="#post-33651">an error when linker via RadAsm</a></div>
    <div class="body">Hi,<br /><br />I'm learning asm still. I found this wonderfull util here. And an example which I had tested that working while manually linking. But now I couln't use this util any. The tasm linker gave a lot of unresolved external 'GetModuleHandleA'<br />......<br />......<br /><br />so whats wrong. These were an .inc file which I already included. Btw, I coldn't understand, what are those |||| chars in linker options. Isn't it import import32.lib?<br /><br />any idea?</div>
    <div class="meta">Posted on 2002-04-15 22:22:16 by cakmak</div>
   </div>
   <div class="post" id="post-33652">
    <div class="subject"><a href="#post-33652">an error when linker via RadAsm</a></div>
    <div class="body">did you put (near the top of your source file, after your .x86... .model, etc):<br />include windows.inc<br />include kernel32.inc<br />includelib kernel32.lib<br /><br />and setup your paths correctly?<br />you will need to import kernel32.lib to use GetModuleHandleA (code is above - or you could manually link it in the linker by changing the cli options)</div>
    <div class="meta">Posted on 2002-04-15 22:57:53 by jademtech</div>
   </div>
   <div class="post" id="post-33669">
    <div class="subject"><a href="#post-33669">an error when linker via RadAsm</a></div>
    <div class="body">Hi  cakmak<br /><br />The '||||' are a replacement for ',,,,'.<br />The replacement is necessary to 'fool' the RadASM parser and are replaced by ',,,,' in the final stage. Myself I use masm so I cant remember the assembler / linker commandline options for tasm.<br />If you replace the 'O' with 'OT' you will see the final assemble / link command line that RadASM produces. This might help you understand what is going on.<br /><br />KetilO</div>
    <div class="meta">Posted on 2002-04-16 02:30:49 by KetilO</div>
   </div>
   <div class="post" id="post-33717">
    <div class="subject"><a href="#post-33717">How can I put in order in &quot;Tasm.ini&quot; for a command</a></div>
    <div class="body">OK. If I manually edit &quot;Tasm.ini&quot; it may do the job nearly. Nearly because I can modify it meaningful only as shown below;<br /><br /><br />	.<br />	.<br />3=5,OT,$B\tlink32.EXE /x /V4.0 /Tpe /aa /c ,3,||import32.lib||,4<br />	.<br />	.<br />this is insufficient, this line must be include a sentence(or signify number) for &quot;.exe&quot;<br />the result commandline must be like;<br /><br />tlink32 -x /V4.0 /Tpe /aa /c file_name.obj,file_name.exe,,import32.lib,,file_name.res<br /><br />Now, I can not replace &quot;file_name.exe&quot; sentence via tasm.ini.<br />because the second &quot;file_name&quot; is for file_name.exe and when I replace &quot;5&quot; as signify number, it only uses right &quot;5&quot;, not file_name.exe! I used so because as I understand if 4 -&gt; .res file; if 3 -&gt; .obj file; if 5 -&gt; .exe file... so anyone knows to using the .ini files? I dont want to wright everything for every project.<br />	And one more, the ini files includes an option for library paths, but as linking it only look for in project directory. Why? Uhm! one minute! I resolved my second question. Hey!, I didn't delete this second part because maybe will useful for someone. I removed /L option and the compiler looked for &quot;All Path&quot; in my system until found. Btw, my first part of question waits for...</div>
    <div class="meta">Posted on 2002-04-16 14:46:06 by cakmak</div>
   </div>
   <div class="post" id="post-33720">
    <div class="subject"><a href="#post-33720">an error when linker via RadAsm</a></div>
    <div class="body">Hi  cakmak<br /><br />I am sorry. My knowledge on tasm is limitted.<br />Maybe this test project can help.<br />It has a dialog and uses .inc and .lib files.<br /><br />Be aware that changing tasm.ini does not affect old projects.<br /><br />I think the link command should look like:<br /><br />3=5,OT,$B\tlink32.EXE /x /V4.0 /Tpe /aa /c ,3,5,|import32.lib||,4 <br /><br />KetilO</div>
    <div class="meta">Posted on 2002-04-16 15:37:54 by KetilO</div>
   </div>
   <div class="post" id="post-33726">
    <div class="subject"><a href="#post-33726">I only need a colon</a></div>
    <div class="body">Hi KetilO,<br /><br /> Before many thanks for your advices! And last I only need a colon(,) after .obj name.<br />I mean between .obj and .exe. Because for now commandline looks like;<br /><br />..../Tpe /aa /c import32.lib hello.exe,.....<br /><br />but I needed;<br /><br />..../Tpe /aa /c import32.lib, hello.exe,.....<br />                            ^<br />                           above<br /><br />many thanks again. I want to use this!<br /><br />Regards</div>
    <div class="meta">Posted on 2002-04-16 16:19:56 by cakmak</div>
   </div>
   <div class="post" id="post-33727">
    <div class="subject"><a href="#post-33727">a mistake...</a></div>
    <div class="body">my sign(^) went wrong place. But colon is there. :)</div>
    <div class="meta">Posted on 2002-04-16 16:22:46 by cakmak</div>
   </div>
   <div class="post" id="post-33737">
    <div class="subject"><a href="#post-33737">an error when linker via RadAsm</a></div>
    <div class="body">Hu  cakmak<br /><br />Here is the line:<br /><br />5,OT,$B\tlink32.EXE -x /V4.0 /Tpe /aa /c ,3,|,5,||C:\Tasm\Lib\import32.lib||,4<br /><br />If you have the enviroment set up, then you dont need the path in C:\Tasm\Lib\import32.lib<br /><br />KetilO</div>
    <div class="meta">Posted on 2002-04-16 17:04:54 by KetilO</div>
   </div>
   <div class="post" id="post-33758">
    <div class="subject"><a href="#post-33758">heyooooo...</a></div>
    <div class="body">Thank you very very much ASM guru!<br /><br /> This tool wonderful! Again thanks for your patience.<br /><br /><br />Best Regards:alright: :alright:</div>
    <div class="meta">Posted on 2002-04-16 18:48:45 by cakmak</div>
   </div>
  </div>
 </body>
</html>