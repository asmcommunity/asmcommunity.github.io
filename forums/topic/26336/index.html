<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Passing data Visual Basic  - DLL made in MAsm - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26336" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26336">Passing data Visual Basic  - DLL made in MAsm</a></p>
   <div class="post" id="post-191160">
    <div class="subject"><a href="#post-191160">Passing data Visual Basic  - DLL made in MAsm</a></div>
    <div class="body">How I can make a DLL in MASM32 that it can to pass data to a receive from a procedure made in Visual Basic ?</div>
    <div class="meta">Posted on 2000-12-16 11:36:00 by JR</div>
   </div>
   <div class="post" id="post-191161">
    <div class="subject"><a href="#post-191161">Passing data Visual Basic  - DLL made in MAsm</a></div>
    <div class="body">You can write DLL (MyDll.DLL) code in MASM as usually , e.c. :
...
MyGodFunc PROC EXPORT par1:DWORD, par2:LPSTR, result:DWORD
...
MyGodFunc ENDP

Then define in VB:
Declare Function MyGodFunc Lib "MyDll.DLL" (ByVal par1 As Long, ByVal par2 As String, ByRef result As Long) As Long

Real life examples:

Declare Function RegOpenKeyA Lib "ADVAPI32.DLL" (ByVal hkey As Long, ByVal sSubkey As String, ByRef hkeyResult As Long) As Long

Declare Function RegCloseKey Lib "ADVAPI32.DLL" (ByVal hkey As Long) As Long

Hope that helps.</div>
    <div class="meta">Posted on 2000-12-16 11:56:00 by AndyCar </div>
   </div>
   <div class="post" id="post-191162">
    <div class="subject"><a href="#post-191162">Passing data Visual Basic  - DLL made in MAsm</a></div>
    <div class="body">There is a good book on this subject and even though I can't say I have read it, but it might help.

It is called "Win32 API for the VB programmer" or something like that.</div>
    <div class="meta">Posted on 2000-12-16 14:06:00 by drsmith </div>
   </div>
   <div class="post" id="post-191163">
    <div class="subject"><a href="#post-191163">Passing data Visual Basic  - DLL made in MAsm</a></div>
    <div class="body">Gee, as long as you intend it to be used from VB, why not give your functions a COM object wrapper?


Just plugging my site.   :-)

http://here.is/COMinASM</div>
    <div class="meta">Posted on 2000-12-16 20:06:00 by Ernie</div>
   </div>
  </div>
 </body>
</html>