<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Coding OOP / Objects in ASM... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6191" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6191">Coding OOP / Objects in ASM...</a></p>
   <div class="post" id="post-44503">
    <div class="subject"><a href="#post-44503">Coding OOP / Objects in ASM...</a></div>
    <div class="body">does anybody knows how code objects directly in ASM ?<br /><br />For example:<br /><br />class myClass{<br />   var myVariable;     <br />    function setVariable(){<br />          this.myVariable = &quot;Hello ASM Coder&quot;;<br />    }<br />}<br /><br />with the call:<br /><br />// init class<br />myNiceClass = new myClass();<br /><br />// now set variable<br />myNiceClass.setVariable();<br /><br />//and print<br />print (myNiceClass.myVariable);<br /><br /><br />How would this look, if I would code this directly in ASM ?<br /><br />Thx for any comment <br />:) <br /><br /><br />Zero</div>
    <div class="meta">Posted on 2002-06-21 06:51:06 by Zero</div>
   </div>
   <div class="post" id="post-44527">
    <div class="subject"><a href="#post-44527">Coding OOP / Objects in ASM...</a></div>
    <div class="body">This question gets asked over and over.... do a search on the board, you'll find some good results.</div>
    <div class="meta">Posted on 2002-06-21 09:06:13 by Asm_Freak</div>
   </div>
   <div class="post" id="post-44542">
    <div class="subject"><a href="#post-44542">Coding OOP / Objects in ASM...</a></div>
    <div class="body"><strong>Asm_Freak</strong>, in my opinion, it doesnt get asked enought ;) .  But you do have a point, one should try the search function first if they remember to do so...<br /><br /><strong>Zero</strong>, Since a rock nearly missed my house by a meager 75,000 km, last week.  Im in a more caring mood these days and decided to to a litteral 1:1 translation of your example code with our (Thomas and I) OOP Model:<br /><br /><strong>The Class Definition File</strong><pre><code>IFNDEF _myClass_<br />_myClass_ equ 1<br /><br />&#91;b&#93;; --============================================<br />; #CLASS&#58;    myClass <br />; #VERSION&#58;  1.0<br />; --============================================<br />; Built by NaN's Object Class Creator<br />; _ Sept 19, 2001<br />;<br />; By NaN &#40; &#91;email&#93;jaymeson@hotmail.com&#91;/email&#93; &#41;<br />; &#91;url&#93;http&#58;//nan32asm.cjb.net&#91;/url&#93;<br />;<br />; --============================================<br />; #AUTHOR&#58; NaN <br />; #DATE&#58;   Sept. 25, 2001<br />;<br />; #DESCRIPTION&#58;<br />;<br />;          Test &quot;Hello World&quot; class for example.<br />;<br />; --============================================<br />; CLASS METHOD PROTOS<br />; --============================================<br />&#91;/b&#93;   myClass_Init    PROTO  &#58;DWORD<br /><br />&#91;b&#93;; --============================================<br />; FUNCTION POINTER PROTOS<br />; --============================================<br />&#91;/b&#93;   myCl_destructorPto    TYPEDEF  PROTO  &#58;DWORD <br />   myCl_PrintPto    TYPEDEF  PROTO  &#58;DWORD<br />   myCl_SetVariablePto    TYPEDEF  PROTO  &#58;DWORD<br /><br />&#91;b&#93;; --============================================<br />; CLASS STRUCTURE<br />; --============================================<br />&#91;/b&#93;   CLASS myClass, myCl<br />      CMETHOD destructor      ; MUST BE THE FIRST, OR OBJECTS.INC WILL FAIL<br />      CMETHOD Print           ; Used to create a Message Box, and Print the Variable Data<br />      CMETHOD SetVariable     ; Used to fill the internal buffer with a text string<br />      PrivateBuffer     dd    32 dup&#40;?&#41;  ; 128 byte buffer<br />   myClass ENDS<br /><br />.data<br /><br />   BEGIN_INIT <br />      dd offset myCl_destructor_Funct<br />      dd offset myCl_Print_Funct<br />      dd offset myCl_SetVariable_Funct<br />      dd 32 dup&#40; 0 &#41;          ; 32 NULL's for initial buffer.<br />   END_INIT<br /><br />.code<br />&#91;b&#93;; --============================================<br />; #METHOD&#58;      CONSTRUCTOR &#40;NONE&#41;<br />;<br />; #DESCRIPTION&#58; Empty Constructor, that does nothing specific..<br />;<br />; --============================================<br />&#91;/b&#93;myClass_Init  PROC uses edi esi lpTHIS&#58;DWORD<br />   SET_CLASS myClass<br />   SetObject edi, myClass<br /><br /><br />   ReleaseObject edi<br />   ret<br />myClass_Init ENDP<br /><br />&#91;b&#93;; --============================================<br />; #METHOD&#58;      destructor &#40;NONE&#41;<br />;<br />; #DESCRIPTION&#58; Empty Destructor, that does nothing specific..<br />;<br />; --============================================<br />&#91;/b&#93;myCl_destructor_Funct  PROC uses edi lpTHIS&#58;DWORD <br />   SetObject edi, myClass<br /><br /><br />   ReleaseObject edi<br />   ret<br />myCl_destructor_Funct  ENDP<br /><br />&#91;b&#93;; --============================================<br />; #METHOD&#58;      Print&#40;&#41;<br />;<br />; #DESCRIPTION&#58; Creates a Message Box with the String Data, IF and only IF the string<br />;               string is set using the SetVariable Method..<br />;<br />; --============================================<br />&#91;/b&#93;myCl_Print_Funct  PROC uses edi lpTHIS&#58;DWORD<br />   SetObject edi, myClass<br />   <br />   mov al, BYTE PTR &#91;edi&#93;.PrivateBuffer                  ; Get first buffer byte<br />   cmp al, 0                                             ; See if its NULL<br />   je @F                                                 ; Yes, then dont print, and exit<br />      invoke MessageBox, NULL, addr &#91;edi&#93;.PrivateBuffer, ; Print Out the Message<br />                         NULL, MB_OK                     ;<br />   @@&#58;                                                   ; Exit<br />   ReleaseObject edi<br />   ret<br />myCl_Print_Funct  ENDP<br /><br />&#91;b&#93;; --============================================<br />; #METHOD&#58;      SetVariable&#40;&#41;<br />;<br />; #DESCRIPTION&#58; Fills a private class buffer with string data..<br />;<br />; --============================================<br />&#91;/b&#93;myCl_SetVariable_Funct  PROC uses edi lpTHIS&#58;DWORD<br />   SetObject edi, myClass<br />   .data<br />      SetDataString  db &quot;Hello ASM Coder, this is the NaN/Thomas OOP model!&quot;,0<br />   .code<br />   <br />   invoke StrLen, addr SetDataString<br />   mov edx, eax<br />   invoke MemCopy, addr SetDataString, addr &#91;edi&#93;.PrivateBuffer, edx<br />   <br />   ReleaseObject edi<br />   ret<br />myCl_SetVariable_Funct  ENDP<br /><br />ENDIF</code></pre><br /><br /><strong>The Main File</strong><pre><code>.386<br />.model flat,stdcall<br />option casemap&#58;none<br /><br />include \masm32\include\windows.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\masm32.inc<br /><br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\masm32.lib<br /><br />include \masm32\include\Objects.inc                   ; Our Object Include Macro Set<br />include myClass.asm                                   ; The Class Definition File<br /><br />.data?<br />&#91;b&#93;   myNiceClass  dd ?                                  ; Class Instance Handle<br />&#91;/b&#93;<br />.code<br />start&#58;<br /><br />&#91;b&#93;   mov myNiceClass, $NEW&#40; myClass &#41;                   ; init class&#58; myNiceClass = new myClass&#40;&#41; <br />   <br />   METHOD myNiceClass, myClass, SetVariable           ; now set variable&#58; myNiceClass.setVariable&#40;&#41;; <br /><br />   METHOD myNiceClass, myClass, Print                 ; and print&#58; print &#40;myNiceClass.myVariable&#41;; <br />   <br />   DESTROY myNiceClass                                ; Must Clean up when finished.<br />&#91;/b&#93;<br />   invoke ExitProcess, NULL<br />end start<br />end</code></pre><br /><br />As well, below is the compiled source.<br />Look it up in the \Masm32\OOP dir as well for more examples,<br />and please feel free to ask questions, but take them to the COM<br />section (since OOP more or less fits in this catagory ;) )<br /><br />Enjoy<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-06-21 10:42:08 by NaN</div>
   </div>
   <div class="post" id="post-44550">
    <div class="subject"><a href="#post-44550">Coding OOP / Objects in ASM...</a></div>
    <div class="body"><strong>Asm_Freak</strong>:<br />Yep. You are right. For the search before asking... really forgot to do so ;) Normally I kill the people at my own board, if they don?t do so... Sorry :( <br /><br /><strong>NaN</strong>:<br />Yes. This is EXACTLY what I searched for ! Give me some time to check and understand it ;) <br /><br />:alright:  Congrats for 1111 posts !<br /><br />Zero:</div>
    <div class="meta">Posted on 2002-06-21 10:59:02 by Zero</div>
   </div>
  </div>
 </body>
</html>