<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Working folder being changed - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=602" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=602">Working folder being changed</a></p>
   <div class="post" id="post-3593">
    <div class="subject"><a href="#post-3593">Working folder being changed</a></div>
    <div class="body">I'm writing a small app and upon exit it saves its various setting in a .dat file in the base directory.<br /><br />I've run into a problem when I use the OpenFile Dialog to load a file. It must affect the base directory of the program so that when I exit the .dat file gets created in the folder from which I loaded the other file. <br /><br />Is there any way to reset the directory to which the .dat file gets saved or maybe specify it somehow in its path address.<br /><br />I'm sure that this is a simple problem but off hand I can't find any solution.</div>
    <div class="meta">Posted on 2001-08-12 20:53:11 by EÃ³in</div>
   </div>
   <div class="post" id="post-3616">
    <div class="subject"><a href="#post-3616">Working folder being changed</a></div>
    <div class="body">There's a number of things you can do. Firts, you could GetCurrentDirectory<br />on program startup, and SetCurrentDirectory before writing your file.<br />But since you can change program working folder when doing shortcuts,<br />this is a bad solution imo.<br /><br />A better (but tougher) solution would be to GetCommandLine and<br />parse this, since it has the executable filename as the first part.<br />Split off the filename and the rest of the commandline, and you will<br />be left with the directory your program executable is in. Be sure to<br />handle cases where the program file is enquoted (&quot; &quot;), and also cases<br />where it isn't. Damn win32, it should be consequent and ALWAYS<br />quote the filename.... but it isn't.</div>
    <div class="meta">Posted on 2001-08-13 00:55:05 by f0dder</div>
   </div>
   <div class="post" id="post-3623">
    <div class="subject"><a href="#post-3623">Working folder being changed</a></div>
    <div class="body">use GetAppPath (from m32lib) to get full  path of your app<br />use SetCurrentDirectory to set directory you need<br />if you want OpenFile to open in the particular directory use <br />fullpath names (or just directory) with the structure to set current directory <br />you need for the dialog</div>
    <div class="meta">Posted on 2001-08-13 03:49:21 by The Svin</div>
   </div>
   <div class="post" id="post-3624">
    <div class="subject"><a href="#post-3624">Working folder being changed</a></div>
    <div class="body">you can also use the GetModuleFileName and strip of the <br />exe name. This prevents you from ugly fights against the <br />different possibilities of ordering the &quot; signs in the command line.</div>
    <div class="meta">Posted on 2001-08-13 03:54:44 by beaster</div>
   </div>
   <div class="post" id="post-3634">
    <div class="subject"><a href="#post-3634">Working folder being changed</a></div>
    <div class="body">GetAppPath is actually using <br />GetModuleFileName to retrive the app path</div>
    <div class="meta">Posted on 2001-08-13 05:12:43 by The Svin</div>
   </div>
   <div class="post" id="post-3646">
    <div class="subject"><a href="#post-3646">Working folder being changed</a></div>
    <div class="body">Nice beaster, I hadn't thought of that way to do it :)</div>
    <div class="meta">Posted on 2001-08-13 08:38:26 by f0dder</div>
   </div>
  </div>
 </body>
</html>