<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>About  the difference for Text Macro and Macro Procedure, Macro Function - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29171" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=29171">About  the difference for Text Macro and Macro Procedure, Macro Function</a></p>
   <div class="post" id="post-206032">
    <div class="subject"><a href="#post-206032">About  the difference for Text Macro and Macro Procedure, Macro Function</a></div>
    <div class="body">I think Macro Procedure is the super set, so it can accomplish all the tasks finished by Text Macro and Macro Function. But why does MASM still provide Text Macro and Macro Function to bu used in program?</div>
    <div class="meta">Posted on 2008-10-04 01:04:45 by qlmi</div>
   </div>
   <div class="post" id="post-206035">
    <div class="subject"><a href="#post-206035">Re: About  the difference for Text Macro and Macro Procedure, Macro Function</a></div>
    <div class="body">for buildtime macros, we usually wish to express a syntactical statement, but for runtime macros, we want to exitm and express a value into a register.<br /></div>
    <div class="meta">Posted on 2008-10-04 04:50:47 by Homer</div>
   </div>
   <div class="post" id="post-206036">
    <div class="subject"><a href="#post-206036">Re: About  the difference for Text Macro and Macro Procedure, Macro Function</a></div>
    <div class="body"><div class="quote"><br />for buildtime macros, we usually wish to express a syntactical statement, but for runtime macros, we want to exitm and express a value into a register.<br /><br /></div><br /><br />but which is buildtime macro, which is runtime macro?</div>
    <div class="meta">Posted on 2008-10-04 08:18:48 by qlmi</div>
   </div>
   <div class="post" id="post-206045">
    <div class="subject"><a href="#post-206045">Re: About  the difference for Text Macro and Macro Procedure, Macro Function</a></div>
    <div class="body">A runtime macro generally ends with a statement like EXITM &lt;EAX&gt;<br />This implies that the output of the macro is to be shoved directly into EAX register, ready for use within the code that called the macro.<br /><br />Buildtime macros generally don&#039;t return values in this way - instead, they express sourcecode - once such a macro has been completely &#039;expanded&#039; into a series of plaintext sourcecode statements, the assembler will then interpret them - first it Expands the macro into plaintext, then it Interprets the expanded series of statements.<br />We use these to compose the sourcecode differently depending on the inputs presented to the macro.<br />This means we don&#039;t need to write several versions of some very similar block of code.<br /><br />But just to confuse you - theres no reason why a buildtime macro can&#039;t emit a runtime macro !!!<br />Its possible to write a macro that creates a macro !<br /><br /><br /></div>
    <div class="meta">Posted on 2008-10-04 21:26:41 by Homer</div>
   </div>
   <div class="post" id="post-206054">
    <div class="subject"><a href="#post-206054">Re: About  the difference for Text Macro and Macro Procedure, Macro Function</a></div>
    <div class="body">Oh, a very difficult topic! <br />Basically, I want to know when I should use text macro, when I should use macro procedure, and&nbsp; macro function.</div>
    <div class="meta">Posted on 2008-10-05 02:36:39 by qlmi</div>
   </div>
   <div class="post" id="post-206055">
    <div class="subject"><a href="#post-206055">Re: About  the difference for Text Macro and Macro Procedure, Macro Function</a></div>
    <div class="body">Use string equates where the macro is working specifically on string manipulation,and at buildtime.<br />Otherwise use macros to express either repeats of a common block of code, or slight variations of them.<br />The purpose of a macro is not to hide whats really happening in a block of code, but to eliminate laborious typing of quite similar blocks of code.<br /></div>
    <div class="meta">Posted on 2008-10-05 04:07:43 by Homer</div>
   </div>
  </div>
 </body>
</html>