<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ADO Testers wanted... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14954" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14954">ADO Testers wanted...</a></p>
   <div class="post" id="post-116040">
    <div class="subject"><a href="#post-116040">ADO Testers wanted...</a></div>
    <div class="body">Hiroshimator reciently inspired me to get into the wonderful world of ADO (ActiveX Data Objects).  You need to have it installed on your computer.  If not it will tell you such.<br /><br />This is working on my Win98SE, but i have not tested it on any other machine.  If you could download and play with it, and lemme know your machine as well as if it worked or not, it would be apprechiated ;)<br /><br />How the GUI works:<ul><br />[*]A new XML database file will be created on C:\ASM_DB.XML evertime you run<br />[*]It will be formated to four generic text fields, and set to have three records<br />[*]Lastly it will be saved and closed, and you will be given the GUI to work with.<br />[*]Open opens this file again<br />[*]Close closes this file again<br />[*]Update will save any field changes to the current record<br />[*]Add will add a new record to the end of the database<br />[*]Delete will delete the current record<br />[*]First moves to the beginning of the database<br />[*]Prev moves to the previous record<br />[*]Next moves to the next record<br />[*]Last moves to the last record<br />[*]Save saves back to the file C:\ASM_DB.XML any modifications you have done. Note that they will be destroyed the next time you run the example.  If your currious about the XML file, open it in an editor.<br /><br /><br />This example only creates one file at all times.  However, when your finished with it, you will have to manually delete it from C:\.  <br /><br />Thanks for your help.  I aim to eventually work this into a RadASM add-in utility, and i will be releasing a number of OOP classes regarding ADO and related stuff in the near future as well..<br /><br />Regards,<br />:NaN:</div>
    <div class="meta">Posted on 2003-08-28 21:43:51 by NaN</div>
   </div>
   <div class="post" id="post-116041">
    <div class="subject"><a href="#post-116041">ADO Testers wanted...</a></div>
    <div class="body">Seems to work fine in Win2K SP4. I got no errors at any rate and everything worked as expected.</div>
    <div class="meta">Posted on 2003-08-28 21:52:11 by donkey</div>
   </div>
   <div class="post" id="post-116043">
    <div class="subject"><a href="#post-116043">ADO Testers wanted...</a></div>
    <div class="body">Thats a good sign ;)<br /><br />Im pretty happy with it, i plan on either replacing, or (if i have the source) reworking the Snippets add-in, to allow more ogranization, and searching features.<br /><br />Should be a worthy first-time practical project using this.  The four fields are to be: Topic, Function, Notes, and Code respectively. <br /><br />I tested it by placing the entire source in the multiline edit, one record per file, and it handled it no problem.<br /><br />At anyrate, thanks for the Win2000 confirmation<br />:alright:<br />Regards,<br />:NaN:</div>
    <div class="meta">Posted on 2003-08-28 22:03:19 by NaN</div>
   </div>
   <div class="post" id="post-116046">
    <div class="subject"><a href="#post-116046">ADO Testers wanted...</a></div>
    <div class="body">This thing seems out of date :grin: <br />telling me i dont have ado 2.5 installed. The newest version of microsofts MDAC active x library is already version 2.7  (thats what i have installed)<br />so i cant run it :( <br /><br />would have been interesting, cause i am a DB programmer myself (but not in asm :tongue:  )</div>
    <div class="meta">Posted on 2003-08-28 22:25:43 by Ranma_at</div>
   </div>
   <div class="post" id="post-116047">
    <div class="subject"><a href="#post-116047">ADO Testers wanted...</a></div>
    <div class="body">Same for me: ADO 2.5 not installed.<br /><br />If I look with COMView I see ADO versions 2.0, 2.1, 2.5, 2.6 and 2.7 being installed. From there I have no problems creating a RecordSet object with ADO 2.5.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-08-28 22:28:18 by japheth</div>
   </div>
   <div class="post" id="post-116048">
    <div class="subject"><a href="#post-116048">ADO Testers wanted...</a></div>
    <div class="body">Hmm.. wierd..<br /><br />Im loading the CLSID from registry as &quot;ADODB.Recordset.2.5&quot;<br /><br />I will make it the standard &quot;ADODB.Recordset&quot;<br /><br />Perhaps this will work. Below is the same thing revised to this...<br /><br />Thanks for your help!<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2003-08-28 22:46:47 by NaN</div>
   </div>
   <div class="post" id="post-116051">
    <div class="subject"><a href="#post-116051">ADO Testers wanted...</a></div>
    <div class="body">is running now ;)  (on xp pro)</div>
    <div class="meta">Posted on 2003-08-28 22:59:16 by Ranma_at</div>
   </div>
   <div class="post" id="post-116052">
    <div class="subject"><a href="#post-116052">ADO Testers wanted...</a></div>
    <div class="body">Still fine here.</div>
    <div class="meta">Posted on 2003-08-28 23:09:39 by donkey</div>
   </div>
   <div class="post" id="post-116070">
    <div class="subject"><a href="#post-116070">ADO Testers wanted...</a></div>
    <div class="body">Works fine on WinNT4 WS SP6a + ADO 2.6</div>
    <div class="meta">Posted on 2003-08-29 02:48:41 by Morris</div>
   </div>
   <div class="post" id="post-116077">
    <div class="subject"><a href="#post-116077">ADO Testers wanted...</a></div>
    <div class="body">I have ADO <strong>2.1</strong> . Win98SE. I get this:<br /><br />ADO caused an invalid page fault in<br />module &lt;unknown&gt; at 0084:00000001.<br />Registers:<br />EAX=00000000 CS=0167 EIP=00000001 EFLGS=00010246<br />EBX=0063fc04 SS=016f ESP=0063fa54 EBP=0063fa90<br />ECX=d0b50860 DS=016f ESI=0116f92c FS=40ff<br />EDX=1f34b6d8 ES=016f EDI=005100ac GS=0000<br />Bytes at CS:EIP:<br />00 00 00 00 00 00 00 16 00 04 0a 65 04 70 00 65 <br />Stack dump:<br />004024f9 0116fbf0 00510a4c 00000008 00000000 00000000 0000000a 00000000 80020004 00000000 0116f92c 0063fbb8 00510a4c 00510a08 0116fbf0 0063fbb0 <br /><br /><br />the previous sample showed the message &quot;ADO 2.5 not installed&quot;</div>
    <div class="meta">Posted on 2003-08-29 04:06:26 by Ultrano</div>
   </div>
   <div class="post" id="post-116144">
    <div class="subject"><a href="#post-116144">ADO Testers wanted...</a></div>
    <div class="body">Yes.. thanks for pointing this out.  Since i made the modification from &quot;Recordset.2.5&quot; to just &quot;Recordset&quot;, it allowed the COM to instanciate *whatever* version you what.  I was relying on the the previous descriptor to filter out non-compliant versions. <br /><br />I will have to wip up some test code to now check the version as well... (no biggy, i guess its the price i pay to take short cuts...)<br /><br />Thanks for testing!<br />:NaN:</div>
    <div class="meta">Posted on 2003-08-29 12:41:28 by NaN</div>
   </div>
   <div class="post" id="post-116150">
    <div class="subject"><a href="#post-116150">ADO Testers wanted...</a></div>
    <div class="body">NaN,<br /><br />I simple check the CurVer key for minimum version check.  It should be easy to parse &quot;ADODB.Recordset.2.7&quot; for want you need.<br /><br />Regards,  P1 :cool:</div>
    <div class="meta">Posted on 2003-08-29 13:48:35 by Pone</div>
   </div>
   <div class="post" id="post-116198">
    <div class="subject"><a href="#post-116198">Hopefully one last time...</a></div>
    <div class="body">Ok... Hopefully this should handle all cases.<br /><br />It will accept any registered values from HKCR\ADODB.Recordset\CurVer == &quot;ADODB.Recordset.2.5&quot; or greater (.2.6, .2.7).<br /><br />Could all who have tested once before, try this version, and let me know how it turns out, and what version your running ( i worked in a popup box to let you know what it finds for you ;) )<br /><br />Thanks again!<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2003-08-29 19:33:40 by NaN</div>
   </div>
   <div class="post" id="post-116206">
    <div class="subject"><a href="#post-116206">ADO Testers wanted...</a></div>
    <div class="body">Hi NaN,<br /><br />Works fine - 2KSP4 ADODB.Recordset Version 2.5.</div>
    <div class="meta">Posted on 2003-08-29 20:43:16 by donkey</div>
   </div>
   <div class="post" id="post-116221">
    <div class="subject"><a href="#post-116221">ADO Testers wanted...</a></div>
    <div class="body">Hi, works on XP, V2.7.<br /><br />Theoretically it shouldnt be necessary with COM to do version checks by hand. In the type library there exist (at least) 2 recordset iids, one beginning with 00000555- (RecordSet21), the other beginning with 00000556- (_RecordSet). I guess that you wont get a valid interface pointer to _RecordSet with ADO version 2.1.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-08-30 00:04:30 by japheth</div>
   </div>
   <div class="post" id="post-116239">
    <div class="subject"><a href="#post-116239">ADO Testers wanted...</a></div>
    <div class="body">:grin:<br />It works for me now (at ado version 2.1)<br />msgbox, Your Version Is:, ADODB.Recordset.2.1<br />msgbox, Error, You do not have ADO v2.5 installed<br />exit</div>
    <div class="meta">Posted on 2003-08-30 02:14:06 by Ultrano</div>
   </div>
   <div class="post" id="post-116257">
    <div class="subject"><a href="#post-116257">ADO Testers wanted...</a></div>
    <div class="body">The first one you posted and the last one both work fine with Win98osr2, MDAC 2.5</div>
    <div class="meta">Posted on 2003-08-30 07:42:43 by djinn</div>
   </div>
   <div class="post" id="post-116263">
    <div class="subject"><a href="#post-116263">ADO Testers wanted...</a></div>
    <div class="body">Excellent, At least i now have a working template for furture projects.<br /><br />Japheth, thanks for pointing this out.  I looked at the COM object class itself for a version property, but i only found it in the IConnection interface.  Im still learning ADO in some respects, so i didnt want to trust this out right.  Doing it &quot;by hand&quot; wasnt much of a chor at all, i used my CString.Compare to determing it:<br /><pre><code>    invoke RegOpenKeyEx,    HKEY_CLASSES_ROOT, addr szC_L_S_I_D2, 0, KEY_READ, addr hKey<br />    .if&#40; ! eax &#41;<br />        mov hStr, $NEW&#40; CString, NULL &#41;<br />        invoke RegQueryValueEx, hKey, 0,0,0,0, addr keySize<br />        <br />        METHOD hStr, CString.AllocBuffer, keySize<br />        mov keySize, $EAX&#40; hStr, CString.GetLength &#41;<br />                        <br />        invoke RegQueryValueEx, hKey, 0,0,0, $EDX&#40; hStr, CString.GetAddr &#41;, addr keySize<br />        .if&#40; eax == ERROR_SUCCESS &#41;<br />            <br />            METHOD hStr, CString.UpdateBuffer<br /> invoke MessageBox, NULL, $EDX&#40; hStr, CString.GetAddr &#41;, CStr&#40;&quot;Your Version Is&#58;&quot;&#41;, MB_OK            <br />            METHOD hStr, CString.Compare, addr szC_L_S_I_D3<br />            .if&#40; eax &gt; 1 &#41;  ; Less than<br />                <br />                jmp @Fail<br />                <br />            .endif<br />                                        <br />        .endif <br />        invoke RegCloseKey, hKey<br />        DESTROY hStr<br />    .endif</code></pre><br /><br />where CLSID2 = &quot;\ADODB.Recordset\CurVer<br />and   CLSID3 = &quot;ADOBD.Recordset.2.5&quot;<br /><br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2003-08-30 09:15:41 by NaN</div>
   </div>
   <div class="post" id="post-157103">
    <div class="subject"><a href="#post-157103">ADO Testers wanted...</a></div>
    <div class="body">Hi, anyone can upload de source again?.<br /><br />Greets and thanks.</div>
    <div class="meta">Posted on 2005-02-17 03:27:22 by r00t</div>
   </div>
  </div>
 </body>
</html>