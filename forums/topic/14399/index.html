<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>MD5 hashing lib. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14399" />
    <link rel="next" href="../?id=14399&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=14399">MD5 hashing lib.</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=14399&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=14399&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="14399" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=14399&amp;page=2">&gt;</a><a href="../?id=14399&amp;page=2">&raquo;</a></form>   <div class="post" id="post-111335">
    <div class="subject"><a href="#post-111335">MD5 hashing lib.</a></div>
    <div class="body">I needed some MD5 hashing routines a few days ago for my tiny POP3 mail program that I'm working on (for MD5 authentication), and searched around here and on the internet and found nothing but needless bloat.   I don't need much speed for what I'm doing so I wrote this with size in mind, although compared to other implementations it's still fast.  Hope you all can make use of it.<br /><br />The source file, .h and .inc include files for C and ASM, and a working LIB file is included in the download.  See readme.txt or one of the include files for notes on how to use it.<br /><br />Feel free to offer suggestions on how to make it smaller.  ;D</div>
    <div class="meta">Posted on 2003-07-20 22:34:19 by iblis</div>
   </div>
   <div class="post" id="post-111337">
    <div class="subject"><a href="#post-111337">MD5 hashing lib.</a></div>
    <div class="body">I was just thinking, &quot;Gee it would be nice to have a good hashing function&quot;... and voila!<br /><br />This is great work <strong>Iblis</strong>!  Very clean and well written.  Your source is soooo pretty to look at too &lt;lol&gt;<br /><br /><br />I have a general idiots question tho, how likely is two keys to generate the same hash code?  (I dont know anything about the MD5 spec).  To safely use this routine for hashing strings etc., would i need to build a linked list type hashing table to ensure i can safely access the right data with a hash code??  Or can i trust that two different keys will give two different hash codes...  (Sorry if this is a dumb question.  I havent dealt with hash tables in years).<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-07-20 23:08:12 by NaN</div>
   </div>
   <div class="post" id="post-111345">
    <div class="subject"><a href="#post-111345">MD5 hashing lib.</a></div>
    <div class="body">Hi NaN, thanks ;)<br /><br /><br /><div class="quote"><br />how likely is two keys to generate the same hash code?</div>I don't think it's very likely at all, although as with any hashing method, there is still a chance.   But MD5 was designed to produce very sensitive hashes.  If you change even one bit in the data stream, you'll see evidence of this.<br /><br /><br /><div class="quote"><br />To safely use this routine for hashing strings etc., would i need to build a linked list type hashing table to ensure i can safely access the right data with a hash code??</div>I guess that depends on how big your hash table is and how much data you plan to put in it, since you must take the hash_code modulo table_size to produce the table index.  It's always a good idea to have some mechanism for handling collisions.<br /><br /><br />MD5 is typically used for checking data integrity and such.  I don't think it's used much as a hashing function for hash tables, although there's no reason why it can't be.  ;)   But if you want lightning fast speed you're probably better of with some other hashing method.</div>
    <div class="meta">Posted on 2003-07-21 00:06:07 by iblis</div>
   </div>
   <div class="post" id="post-112272">
    <div class="subject"><a href="#post-112272">MD5 hashing lib.</a></div>
    <div class="body"><div class="quote">1 Executive Summary<br />This document describes the MD5 message-digest algorithm. The algorithm takes as input a message of arbitrary length and produces as output a 128-bit &quot;fingerprint&quot; or &quot;message digest&quot; of the input. It is conjectured that it is computationally infeasible to produce two messages having the same message digest, or to produce any message having a given prespecified target message digest. The MD5 algorithm is intended for digital signature applications, where a large file must be &quot;compressed&quot; in a secure manner before being encrypted with a private (secret) key under a public-key cryptosystem such as RSA.</div><br /><br />Well this seem kinda confident in it ;) .  One more question.  What the Heck in RSA? (and dont say &quot;public key cryptosystem&quot; &lt;lol&gt;.<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-07-28 23:33:24 by NaN</div>
   </div>
   <div class="post" id="post-112279">
    <div class="subject"><a href="#post-112279">MD5 hashing lib.</a></div>
    <div class="body"><a target="_blank" href="http://www.rsasecurity.com/rsalabs/faq/3-1.html">http://www.rsasecurity.com/rsalabs/faq/3-1.html</a></div>
    <div class="meta">Posted on 2003-07-29 01:00:05 by iblis</div>
   </div>
   <div class="post" id="post-112280">
    <div class="subject"><a href="#post-112280">MD5 hashing lib.</a></div>
    <div class="body">Very well written code! Thanks for sharing! <img src="http://www.asmcommunity.net/board/images/icons/icon14.gif" /></div>
    <div class="meta">Posted on 2003-07-29 01:45:14 by bazik</div>
   </div>
   <div class="post" id="post-112281">
    <div class="subject"><a href="#post-112281">MD5 hashing lib.</a></div>
    <div class="body">Hi Iblis.<br /><br />Great code! <br />I will port it to FASM these days. ( Without changing your name of course <br />:grin:  )</div>
    <div class="meta">Posted on 2003-07-29 02:01:13 by JohnFound</div>
   </div>
   <div class="post" id="post-115323">
    <div class="subject"><a href="#post-115323">MD5 hashing lib.</a></div>
    <div class="body">Hi Bazik, JohnFound.   Thank you both.<br /><br />Feel free to port it to FASM, and when you do, be sure to let me know.  :)</div>
    <div class="meta">Posted on 2003-08-24 20:41:38 by iblis</div>
   </div>
   <div class="post" id="post-156802">
    <div class="subject"><a href="#post-156802">MD5 hashing lib.</a></div>
    <div class="body">Can you post the download again please. I'm looking for MD5 hash now too.<br /><br />Thanks.</div>
    <div class="meta">Posted on 2005-02-08 08:33:59 by V Coder</div>
   </div>
   <div class="post" id="post-156812">
    <div class="subject"><a href="#post-156812">MD5 hashing lib.</a></div>
    <div class="body">Don't use MD5 it's not secure.  Find another alternative.</div>
    <div class="meta">Posted on 2005-02-08 12:06:07 by mark_larson</div>
   </div>
   <div class="post" id="post-156824">
    <div class="subject"><a href="#post-156824">MD5 hashing lib.</a></div>
    <div class="body">Not much else you can do if you use, what is it, APOP? authentication with pop3, since that's what the standard dictates. It should be enough for that kind of auth anyway, as what you have to send back to the server is MD5(random_server_string+the_password) - ie, there's a dynamic factor here, it's not like bruteforcing a unix passwd :)</div>
    <div class="meta">Posted on 2005-02-08 18:19:31 by f0dder</div>
   </div>
   <div class="post" id="post-156829">
    <div class="subject"><a href="#post-156829">MD5 hashing lib.</a></div>
    <div class="body">Actually, I'm just looking for any easily implementable 128 bit hash. Not for security. I will hash a long number and then sort the hash in an array, searching for collisions with binary search.<br /><br />Actually I'm also looking for an iterative, not recursive, binary search tree algorithm.</div>
    <div class="meta">Posted on 2005-02-08 20:35:12 by V Coder</div>
   </div>
   <div class="post" id="post-156866">
    <div class="subject"><a href="#post-156866">MD5 hashing lib.</a></div>
    <div class="body">I was part of a distributed project that was trying to show that MD5 is insecure due to collisions.  After we had been up and running for 4 months, some researchers could generate a collision a 100% the time with MD5 in an hour using an algorithm.  That's a problem.   Second since they were able to so easily generate a collision, it would not surprise me if they eventually will be able to get the unencrypted password.  So MD5 has been declared insecure.  And if you are going to use it, you never send a password that has been hashed with MD5 over the network.  If you have to send a password over the network use something else to encrypt it.</div>
    <div class="meta">Posted on 2005-02-09 11:29:21 by mark_larson</div>
   </div>
   <div class="post" id="post-156867">
    <div class="subject"><a href="#post-156867">MD5 hashing lib.</a></div>
    <div class="body"><strong>(in the context of POP3 email servers using APOP authentication)</strong><br />Verifying that you have a collision requires you to test the md5sum, right? So in that case, you would have to hammer the server with generated MD5s. Good servers block if you hammer. Also, you only get *one* chance of getting it right, next time you you try the random generated string prepended to the password is different, so it's a different MD5 you'd have to send.<br /><br />So, while I definitely wouldn't use MD5 for a password database, it should be safe enough for this kind of auth'ing.</div>
    <div class="meta">Posted on 2005-02-09 11:37:19 by f0dder</div>
   </div>
   <div class="post" id="post-159208">
    <div class="subject"><a href="#post-159208">Re: MD5 hashing lib.</a></div>
    <div class="body">Phew.&nbsp; It&#39;s been months since I&#39;ve been back to Win32ASM.&nbsp; Hi everyone ;)<br /><br />I don&#39;t know what happened to the old library files I uploaded, but as I have had multiple requests for it in my PM inbox, I managed to relocate it on an old backup CD I burnt, so here it is.&nbsp; Enjoy.</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=563" target="_blank">md5lib.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-04-21 14:42:43 by iblis</div>
   </div>
   <div class="post" id="post-159209">
    <div class="subject"><a href="#post-159209">Re: MD5 hashing lib.</a></div>
    <div class="body">Hey iblis, long time no see - nice to see you again! :)<br /><br />The board&#39;s been hacked a couple of times and stuff, I think all attachments were wiped out :/<br /></div>
    <div class="meta">Posted on 2005-04-21 15:08:00 by f0dder</div>
   </div>
   <div class="post" id="post-159212">
    <div class="subject"><a href="#post-159212">Re: MD5 hashing lib.</a></div>
    <div class="body">Hey f0dder.<br /><br />That sucks.&nbsp; I guess PHPBB had some pretty bad security holes?<br />And what happened to the domain?</div>
    <div class="meta">Posted on 2005-04-21 17:09:45 by iblis</div>
   </div>
   <div class="post" id="post-159213">
    <div class="subject"><a href="#post-159213">Re: MD5 hashing lib.</a></div>
    <div class="body">*very* bad security holes indeed, and new ones all the time :)<br /><br />The domain works fine, I think the reason we see the IP so often is because of a configuration issue, or perhaps reverse DNS.<br /></div>
    <div class="meta">Posted on 2005-04-21 17:12:22 by f0dder</div>
   </div>
   <div class="post" id="post-185786">
    <div class="subject"><a href="#post-185786">Re: MD5 hashing lib.</a></div>
    <div class="body">For the record, I&#39;ve just used this lib in yet another project, it&#39;s gold as far as I am concerned&nbsp; 8)</div>
    <div class="meta">Posted on 2006-10-08 06:40:27 by Homer</div>
   </div>
   <div class="post" id="post-185791">
    <div class="subject"><a href="#post-185791">Re: MD5 hashing lib.</a></div>
    <div class="body">Hey, iblis<br />is it right?<br />input:abc<br />hash:8faae823bba223c561ea7008dee23464<br /><pre><code>include MD5.inc<br />includelib MD5.lib<br /><br />.const<br />	IDC_ABOUT	equ	101<br />	IDC_EDITTEXT	equ	102<br />	IDC_EDITHASH	equ	103<br />	IDD_DIALOG	equ	100<br />	IDI_ICON	equ	200<br /><br />	MAXSIZE		equ	260<br /><br />.data<br />	bfBuffer	db MAXSIZE dup (0)<br />	szAboutCaption	db &#39;about md5hasher&#39;,0<br />	szAboutText	db &#39;md5hasher&#39;,13,10,&#39;by Greg Hoyer aka iblis&#39;,13,10,&#39;7-20-2003&#39;,0<br /><br />.data?<br />	hInstance	HINSTANCE ?<br />	ctxt		MD5CTXT &lt;&gt;<br />	hash		MD5HASH &lt;&gt;<br />	strn		db 33 dup(?)&nbsp; ; use dw for unicode<br /><br />.code<br /><br />DlgProc proc uses ebx EDX edi esi hWnd:HWND,uMsg:UINT,wParam:WPARAM,lParam:LPARAM<br /><br />	.if uMsg==WM_INITDIALOG<br />		invoke	LoadIconA,hInstance,IDI_ICON<br />		invoke	SendMessageA,hWnd,WM_SETICON,1,eax<br />		invoke	SendDlgItemMessageA,hWnd,IDC_EDITTEXT,WM_SETTEXT,0,0<br />	.elseif uMsg==WM_CLOSE<br />		invoke EndDialog,hWnd,0<br />	.elseif uMsg==WM_COMMAND<br />		mov	eax,wParam<br />		mov	edx,wParam<br />		shr	edx,16<br />		.if	edx==BN_CLICKED<br />			.if	ax==IDC_ABOUT<br />				invoke	MessageBoxA,hWnd,addr szAboutText,addr szAboutCaption,MB_OK or MB_ICONASTERISK<br />			.endif<br />		.elseif edx==EN_CHANGE<br />			.if	ax==IDC_EDITTEXT<br />				invoke GetDlgItemText,hWnd,IDC_EDITTEXT,offset bfBuffer,MAXSIZE<br />				invoke MD5_Startup<br />				invoke MD5_Init, offset ctxt<br />				invoke MD5_Read, offset ctxt, offset bfBuffer, SIZEOF bfBuffer<br />				invoke MD5_Digest, offset ctxt, offset hash<br />				invoke MD52String, offset hash, offset strn, 0<br />				invoke SendDlgItemMessage,hWnd,IDC_EDITHASH,WM_SETTEXT,0,offset strn<br />			.endif<br />		.endif<br />	.else<br />		mov eax,FALSE<br />		ret<br />	.endif<br />	mov eax,TRUE<br />	ret<br /><br />DlgProc endp<br /><br />start:<br />	invoke	GetModuleHandle,0<br />	mov	hInstance,eax<br /><br />	invoke	DialogBoxParam,hInstance,IDD_DIALOG,0,addr DlgProc,0<br />	invoke	ExitProcess,eax<br /><br />end start<br /></code></pre><br /><pre><code>#include &lt;/masm32/include/resource.h&gt;<br /><br />100 DIALOGEX MOVEABLE PURE LOADONCALL DISCARDABLE	117, 108, 208, 41, 0<br />STYLE DS_SYSMODAL | 0x0004 | DS_CENTER | WS_CAPTION | WS_SYSMENU | WS_VISIBLE | WS_OVERLAPPED<br />CAPTION &quot;md5 hasher&quot;<br />FONT 8, &quot;MS Sans Serif&quot;, 700, 0 /*FALSE*/<br />BEGIN<br />&nbsp; &nbsp; EDITTEXT&nbsp; &nbsp; &nbsp; &nbsp; 102, 	24,2,182,12, ES_AUTOHSCROLL | ES_LEFT, , 0<br />&nbsp; &nbsp; EDITTEXT&nbsp; &nbsp; &nbsp; &nbsp; 103, 	24,14,182,12, ES_AUTOHSCROLL | ES_READONLY | ES_LEFT, , 0<br />&nbsp; &nbsp; PUSHBUTTON&nbsp; &nbsp; &nbsp; &quot;&amp;about&quot;, 101, 	168,28,38,13, 0, , 0<br />&nbsp; &nbsp; LTEXT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &quot;text :&quot;, -1, 	6,3,17,9, SS_LEFT, , 0<br />&nbsp; &nbsp; LTEXT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &quot;hash :&quot;, -1, 	2,15,21,8, SS_LEFT, , 0<br />END<br /><br />200 ICON MOVEABLE PURE LOADONCALL DISCARDABLE &quot;xxx.ICO&quot;<br /></code></pre></div>
    <div class="meta">Posted on 2006-10-08 09:11:24 by dcskm4200</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=14399&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=14399&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="14399" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=14399&amp;page=2">&gt;</a><a href="../?id=14399&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>