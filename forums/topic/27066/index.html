<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Unicode,Win2k - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27066" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27066">Unicode,Win2k</a></p>
   <div class="post" id="post-194443">
    <div class="subject"><a href="#post-194443">Unicode,Win2k</a></div>
    <div class="body">How do I detect Win2k or NT and how do I
convert from Unicode to Ansi / Ansi to Unicode ?
:confused:</div>
    <div class="meta">Posted on 2001-03-01 08:29:00 by KetilO</div>
   </div>
   <div class="post" id="post-194444">
    <div class="subject"><a href="#post-194444">Unicode,Win2k</a></div>
    <div class="body">To detect NT/2k, use GetVersionEx. To convert to and from unicode/ansi use: MultiByteToWideChar and WideCharToMultiByte. You could also, of course, do it manually by expanding byte characters into words and vice versa if you are only dealing with ascii characters (ascii characters map directly to 0-255 unicode). When working with unicode strings, be sure to remember that a null terminated wide character array is not actually a UNICODE_STRING in the strict sense. A UNICODE_STRING is a datatype that holds the string with the size, maximum size, and pointer to the wide character array. 

Tootaloo,
Jeremy</div>
    <div class="meta">Posted on 2001-03-01 08:41:00 by jcollake</div>
   </div>
   <div class="post" id="post-194445">
    <div class="subject"><a href="#post-194445">Unicode,Win2k</a></div>
    <div class="body">I've never run across the UNICODE_STRING structure before. But yep, it's in the newer editions of MSDN. 

Leave it to microsoft to use the same term for two different things.

A unicode string and a wide character string are the same things, basically words replace bytes, and for ascii (code page zero), they map together 1 to 1.

A UNICODE_STRING is as described, seems like an expansion of the BSTR concept.

But, if the API function you are using asks for a wzs or a wide char or wchar_t string, it wants a lower case unicode string (not the structured kind).</div>
    <div class="meta">Posted on 2001-03-01 17:18:00 by Ernie</div>
   </div>
   <div class="post" id="post-194446">
    <div class="subject"><a href="#post-194446">Unicode,Win2k</a></div>
    <div class="body">Some functions that seemed to be undocumented were actually documented in the DDKs.  (Pietrek mentions this in some of his writings.)  I believe that UNICODE_STRING has been a part of NT driver software since NT's beginnings.</div>
    <div class="meta">Posted on 2001-03-02 17:54:00 by tank</div>
   </div>
   <div class="post" id="post-194447">
    <div class="subject"><a href="#post-194447">Unicode,Win2k</a></div>
    <div class="body">Thank you for your help.
My app now also runs on Win2k.</div>
    <div class="meta">Posted on 2001-03-05 05:05:00 by KetilO</div>
   </div>
  </div>
 </body>
</html>