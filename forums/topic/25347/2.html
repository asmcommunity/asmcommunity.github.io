<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>COM Files - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25347" />
  <link rel="prev" href="../?id=25347&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25347">COM Files</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=25347&amp;page=1" style="">&laquo;</a><a href="../?id=25347&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="25347" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-185516">
    <div class="subject"><a href="#post-185516">Re: COM Files</a></div>
    <div class="body"><div class="quote">Do you know if a similar unrestricted MASM/license comes with Visual C++ 2005 (Express), off-hand???</div><br /><br />I&#39;m not too sure about the Express version, but ML.EXE is included in VS2K5 Standard Edition. So having a copy of that, the EULA which is included states no restrictions on use (as far as what you can create with it, etc). Also, the EULA.TXT in 2K5SE states that the 2K5SE EULA superseeds the license of all microsoft applications included with the installation. This makes since because you can&#39;t very well have people buy the software, then tell them they must obey the freeware license. I kinda lucked out on that, as I didn&#39;t haven&#39;t to pay for my copy, it was given to me for participating in a microsoft promotion.<br /></div>
    <div class="meta">Posted on 2006-09-25 02:49:54 by Synfire</div>
   </div>
   <div class="post" id="post-185521">
    <div class="subject"><a href="#post-185521">Re: COM Files</a></div>
    <div class="body">Thank you guys for your answers!<br />Just about the offsets: What I meant is, if I have a code like<br /><pre><code>.code<br />db 65536 DUP (?)<br />Init: ...<br />END</code></pre><br />Will the Label Init be zero again? (I don&#39;t do 32-Bit Stuff).</div>
    <div class="meta">Posted on 2006-09-25 04:39:18 by Firefall</div>
   </div>
   <div class="post" id="post-185523">
    <div class="subject"><a href="#post-185523">Re: COM Files</a></div>
    <div class="body"><strong>vid:</strong> since masm doesn&#39;t output PE executables, it doesn&#39;t build the final relocations, the linker does. The MS linker puts relocations in .reloc, which is located after .data. No, not a lot of flexibility there, but you don&#39;t need it for &quot;standard stuff&quot;, which is what Microsoft&#39;s tools were made for :). Same goes for relocation type, I&#39;ve only ever seen one reloc type.<br /><br />If you need more flexibility, you either use a more flexible linker (GNU ld comes to mind), or output PE directly with something like fasm (which is what I do for my loader stub for my PE packer/protector).<br /><br /><strong>Firefall:</strong><br />The address of your label will depend on base address and a couple of other things - but because of the data declaration (which *will* go in the .code section), it will be at least 64k.<br /></div>
    <div class="meta">Posted on 2006-09-25 04:58:28 by f0dder</div>
   </div>
   <div class="post" id="post-185535">
    <div class="subject"><a href="#post-185535">Re: COM Files</a></div>
    <div class="body">It may seem like MASM does all that stuff, but it actually passes information to the linker inside the object file and triggers the linker to execute.<br /><br />Try removing link.exe from the bin directory when you don&#39;t pass MASM the &quot;/c&quot; option, and see what happens ;)</div>
    <div class="meta">Posted on 2006-09-25 13:50:42 by SpooK</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=25347&amp;page=1" style="">&laquo;</a><a href="../?id=25347&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="25347" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>