<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>what tasks are running? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=505" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=505">what tasks are running?</a></p>
   <div class="post" id="post-3015">
    <div class="subject"><a href="#post-3015">what tasks are running?</a></div>
    <div class="body">I am trying to write a program which logs all use of a computer.<br /><br />how can I get a list of all running tasks on a system?<br />I only realy need the number of tasks but a list on names would be good too.<br /><br />I am working in win32 assembly but I am new to programming for windows so go easy on me :-)<br /><br /><br />Derek Robson<br /><a href="mailto:robsonde@hotmail.com">robsonde@hotmail.com</a></div>
    <div class="meta">Posted on 2001-08-04 22:02:49 by robsonde</div>
   </div>
   <div class="post" id="post-3019">
    <div class="subject"><a href="#post-3019">what tasks are running?</a></div>
    <div class="body">Well i took this from some SubHuman's post but just because i had it handy :)<br />Take a look at ToolHelp32 API. It's what you need for a high level modules and processes 'administration'<br /><br />Here are the API names:<br /><br />CreateToolhelp32Snapshot <br />Heap32First <br />Heap32ListFirst <br />Heap32ListNext <br />Heap32Next <br />Module32First <br />Module32Next <br />Process32First <br />Process32Next <br />Thread32First <br />Thread32Next <br />Toolhelp32ReadProcessMemory <br /><br />If you ain't got any help file on these APIs check MSDN (<a target="_blank" href="www.msdn.microsoft.com">www.msdn.microsoft.com</a>)<br /><br />Bye!<br /><br />Latigo<br /><br />PS: Check at <a target="_blank" href="www.win32asm.cjb.net">www.win32asm.cjb.net</a> cos (i think) there is some ToolHelp source code :)</div>
    <div class="meta">Posted on 2001-08-04 22:25:35 by latigo</div>
   </div>
   <div class="post" id="post-3028">
    <div class="subject"><a href="#post-3028">what tasks are running?</a></div>
    <div class="body">I dont know if that is any help......<br /><br />I was hoping to find a win32 api that is just in kernal32 or something.<br /><br />I dont know anything about ToolHelp32.<br /><br />sorry for being stupid</div>
    <div class="meta">Posted on 2001-08-05 00:43:10 by robsonde</div>
   </div>
   <div class="post" id="post-3039">
    <div class="subject"><a href="#post-3039">what tasks are running?</a></div>
    <div class="body">Hey!<br />You are not stupid!<br /><br />&gt;  dont know if that is any help......<br /><br />Yes , that is help. I'm telling you that the APIs you are looking for reside in ToolHelp.dll (%WindowsRoot%\System\ToolHelp.dll). They are a bunch of APIs that give and receive information about the current processes/modules in the system at a given moment.<br /><br />&gt; I was hoping to find a win32 api that is just in kernal32 or something<br /><br />Well i don't know if this is part of the Win32 implementation or if its an addenum to the system, but who cares. And the fact that they do not reside inside kernel32.dll has nothing to do with it. Just use them.<br /><br />&gt; I dont know anything about ToolHelp32. <br /><br />Should have you known something about it you would have not asked from starters. Check Microsoft's site for more info about ToolHelp.<br /><br />&gt; sorry for being stupid<br /><br />Again..you are not being stupid.<br /><br /><br />That's all i can say, if you want to neglect my advice then do it.<br /><br /><br />Latigo.<br /><br /><br />PS: i had a rough nite.</div>
    <div class="meta">Posted on 2001-08-05 04:30:17 by latigo</div>
   </div>
   <div class="post" id="post-3043">
    <div class="subject"><a href="#post-3043">what tasks are running?</a></div>
    <div class="body">Maybe these old tutorials help you to understand what<br />says latigo.<br /><br />Windows 2k has toolhelp32 support but NT does not.</div>
    <div class="meta">Posted on 2001-08-05 05:09:21 by n u M I T_o r</div>
   </div>
   <div class="post" id="post-3047">
    <div class="subject"><a href="#post-3047">what tasks are running?</a></div>
    <div class="body">That helps lots!!<br /><br />I think I will be able to do something now....<br /><br />I have only had a quick look over files but it looks like just the toy for me.<br /><br />it is very late at night/morning in my world so i will get some sleep and play tomorrow.<br /><br />thanks so much for the help</div>
    <div class="meta">Posted on 2001-08-05 07:17:52 by robsonde</div>
   </div>
  </div>
 </body>
</html>