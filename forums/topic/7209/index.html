<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>RadASM custom control demo. Spread sheet / Grid - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7209" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=42">RadASM</a> &raquo; <a href="../?id=7209">RadASM custom control demo. Spread sheet / Grid</a></p>
   <div class="post" id="post-52191">
    <div class="subject"><a href="#post-52191">RadASM custom control demo. Spread sheet / Grid</a></div>
    <div class="body">Hi all<br /><br />Here is a demo of the control in spread sheet and grid mode.<br />I am struggeling to decide what number format to use. Packed BCD floating point or binary floating point.<br /><br />Packed BCD vs Binary<br /><pre><code><br />		Packed BCD		Binary<br />---------------------------------------------------------------------<br />Ascii to float	Fast and simple		Slow<br />Float to ascii	Fast and simple		Slow and complex<br />Formatting	Simple, slow on sci	Simple, fast on sci<br />Roundoff	Simple and fast		A total mess<br />Add		Slow			Fast using FPU<br />Sub		Slow			Fast using FPU<br />Mul		Very slow		Fast using FPU<br />Div		Very slow		Fast using FPU<br /></code></pre> <br /><br />There is not a lot of example code on floating point convertions. If you know of any code / tut on this subject or just some idea, let me know.<br /><br />Comments, suggestions and bug reports welcome.<br /><br />KetilO</div>
    <div class="meta">Posted on 2002-08-08 03:15:49 by KetilO</div>
   </div>
   <div class="post" id="post-52196">
    <div class="subject"><a href="#post-52196">RadASM custom control demo. Spread sheet / Grid</a></div>
    <div class="body">I thnk the FPU handles BCD number loading and storing. But perhaps with some good number conversion routines binary would be the better option.<br /><br />Have you checked out the code supplied with masm32.lib, it contains number conversion routins, I think the files are dwtoa.asm, atodw.asm, fptoa(2).asm &amp; atofp.asm.</div>
    <div class="meta">Posted on 2002-08-08 06:29:49 by EÃ³in</div>
   </div>
   <div class="post" id="post-52202">
    <div class="subject"><a href="#post-52202">RadASM custom control demo. Spread sheet / Grid</a></div>
    <div class="body">Hi  E?in<br /><br />Yes, binary is the prefered format as it allows use of the FPU.<br />I am aware of the functions in masm32.lib, but they are not even close to what I need. I have had a look at ATOFP, it is very slow, there are better ways to do it. My concern is the float to ascii when I want a fixed number of decimals.<br />My idea so far is:<br /><br />Lets say I want 2 decimals.<br /><br />1. Multiply by 1000<br />2. Convert to packed BCD<br />3. Check if LSD&gt;=5, if so add 0.01<br /><br />This will work but is there a better way?<br /><br />KetilO</div>
    <div class="meta">Posted on 2002-08-08 07:54:30 by KetilO</div>
   </div>
  </div>
 </body>
</html>