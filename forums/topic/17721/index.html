<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>A fun macro allow Set val = New Object - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17721" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=17721">A fun macro allow Set val = New Object</a></p>
   <div class="post" id="post-136869">
    <div class="subject"><a href="#post-136869">A fun macro allow Set val = New Object</a></div>
    <div class="body">Fix a bit to work with ObjAsm32 ;)<br /> <br /><div class="quote"><br /><br />.................<br />Set MACRO p@r@meter:vararg<br />	LOCAL $txt,t@,$command,$var,t1@	<br />	$txt EQU &lt;p@r@meter&gt;<br />		 <br />	t@ INSTR $txt,&lt;=&gt;<br />	if t@<br />		$var SUBSTR $txt,1,t@-1<br />		$var CATSTR &lt;mov &gt;,$var,&lt;,eax&gt;<br />		$command SUBSTR $txt,t@+1				<br />	endif<br />	t@ INSTR $command,&lt;invoke &gt;<br />	IF t@ 					<br />	$command	<br />	ELSE	<br />		t1@ INSTR $command,&lt;New &gt;<br />		IF t1@<br />			$command<br />		ELSE			<br />			$command CATSTR &lt;mov eax,&gt;,$command<br />			$command<br />		ENDIF	<br />	ENDIF<br />	$var	<br />endm<br /><br /></div><br /><br />Testing :<br /><div class="quote"><br />   ClsOnLButtonDown proc hwnd:HWND,myDblClk:BYTE,x:DWORD,y:DWORD,keyFlags:DWORD<br />	LOCAL result :DWORD<br />	LOCAL test1:DWORD <br />	Set result = invoke MessageBox,NULL,CTXT(&quot;Hello World&quot;),CTXT(&quot;Hello&quot;),MB_OKCANCEL<br />	.if result==IDOK	<br />		Set test1= CTXT(&quot;Hello from Set&quot;)	 <br />		invoke MessageBox,NULL,test1,CTXT(&quot;Hello&quot;),MB_OK<br />	.endif		<br />	ret<br />ClsOnLButtonDown endp<br /></div><br /><br />Modified to accept New ( which use in ObjAsm32 ).<br /><div class="quote"><br />.data<br />pVar Pointer NULL<br />.code<br />Set  pVar=New Obj<br /></div></div>
    <div class="meta">Posted on 2004-03-24 06:59:08 by dreamweaver</div>
   </div>
  </div>
 </body>
</html>