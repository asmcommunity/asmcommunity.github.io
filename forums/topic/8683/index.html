<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Getting the content of a foreign edit-control - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8683" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=8683">Getting the content of a foreign edit-control</a></p>
   <div class="post" id="post-63857">
    <div class="subject"><a href="#post-63857">Getting the content of a foreign edit-control</a></div>
    <div class="body">Hi @ all<br /><br />Does someone of you know how to read the content of a foreign edit-control? Foreign means, that this control doesn't belong to my program. If the mouse moves over an edit-control the program should read it out. That's all. Getting the handle of this control was no problem. But I can't read the text with WM_GETTEXT message. The editmessage doesn't work too.<br /><br />I hope you could help me<br /><br />:( Marwin</div>
    <div class="meta">Posted on 2002-10-29 04:49:54 by Marwin</div>
   </div>
   <div class="post" id="post-63859">
    <div class="subject"><a href="#post-63859">Getting the content of a foreign edit-control</a></div>
    <div class="body">Did you try SendMessage, hwnd, WM_GETTEXT,,?<br /><br />PostMessage, GetWindowText, etc will not work, but SendMessage should work.</div>
    <div class="meta">Posted on 2002-10-29 05:11:21 by Four-F</div>
   </div>
   <div class="post" id="post-63860">
    <div class="subject"><a href="#post-63860">Getting the content of a foreign edit-control</a></div>
    <div class="body"><div class="quote"><em>PostMessage, GetWindowText, etc will not work, but SendMessage should work. </em></div>Unless the edit box has custom handling (ie not default) for the WM_GETTEXT message, in which case you are out of luck.<br /><br />Marwin, this wouldn't happen to be a password field would it? :eek: :grin:</div>
    <div class="meta">Posted on 2002-10-29 05:20:19 by sluggy</div>
   </div>
   <div class="post" id="post-63864">
    <div class="subject"><a href="#post-63864">Getting the content of a foreign edit-control</a></div>
    <div class="body">Oh, yes. Why not? Such little tool is quite helpfull, or not?<br /><br />:) Marwin</div>
    <div class="meta">Posted on 2002-10-29 05:45:52 by Marwin</div>
   </div>
   <div class="post" id="post-63865">
    <div class="subject"><a href="#post-63865">Getting the content of a foreign edit-control</a></div>
    <div class="body">This method doesn't work under 2k and xp...<br />For NT systems, you can consider using remote thread instead.</div>
    <div class="meta">Posted on 2002-10-29 06:15:40 by C.Z.</div>
   </div>
   <div class="post" id="post-63875">
    <div class="subject"><a href="#post-63875">Getting the content of a foreign edit-control</a></div>
    <div class="body">check <a target="_blank" href="http://freespace.virgin.net/james.brown7/winspy.html">WinSpy++</a> 45k zip<br /><br />WinSpy++ can obtain the following window properties:<br /><ul><br />[*]Window Class and Name. <br />[*]Window procedure address. <br />[*]All window styles and extended styles. <br />[*]Window properties (set using the SetProp API call). <br />[*]Complete Child and Sibling window relationships. <br />[*]Scrollbar positional information. <br />[*]Full window Class information. <br /> <br /><br />New in version 1.5!<br /><ul> <br />[*]Retrieve passwords from password-edit controls! <br />[*]Edit window styles! <br />[*]Alter window captions! <br />[*]Show / Hide / Enable / Disable / Adjust any window in the system! <br />[*]Massively improved user-interface! <br />[*]View the complete system window hierarchy! <br /> <br /><br />source available in C too ...<br /><br /> posted on this messageboard couple of times (found 4 times :grin: )</div>
    <div class="meta">Posted on 2002-10-29 08:23:24 by TBD</div>
   </div>
   <div class="post" id="post-63880">
    <div class="subject"><a href="#post-63880">Getting the content of a foreign edit-control</a></div>
    <div class="body"><div class="quote"><em>Oh, yes. Why not? Such little tool is quite helpfull, or not?</em></div><br /><a target="_blank" href="http://spiff.tripnet.se/~iczelion/files/revealer.zip">Password Revealer</a> <br /><br /><div class="quote"><em>This method doesn't work under 2k and xp...</em></div><br />If you mean SendMessage,,WM_GETTEXT,,? it works!<br />At least under w2k. I did it many times.<br /><br /><strong>Marwin</strong>, if you still unsuccessful with SendMessage and PassvordReveler did not help,<br />you have to hook your edit control. I've attached some ex.<br />Can't remember if i tested it under nt, but anyway it should work.<br />Run Target.exe, then RTH.exe, and play with Get/Set/Spy buttons.<br />Hope this helps.</div>
    <div class="meta">Posted on 2002-10-29 09:05:09 by Four-F</div>
   </div>
   <div class="post" id="post-63882">
    <div class="subject"><a href="#post-63882">Getting the content of a foreign edit-control</a></div>
    <div class="body"><strong>Four-F:</strong> remotetexthunter works on NT4SP6 :alright:  - nice!</div>
    <div class="meta">Posted on 2002-10-29 09:07:59 by TBD</div>
   </div>
   <div class="post" id="post-63890">
    <div class="subject"><a href="#post-63890">Getting the content of a foreign edit-control</a></div>
    <div class="body">Ok, sorry guys. Sending a WM_GETTEXT message works very well. But not if you're sending it to the wrong window. The hook procedure returns the handle in wParam, and I sent the message to lParam. :stupid: Now it works great (under Win98SE).<br /><br />:):) Marwin</div>
    <div class="meta">Posted on 2002-10-29 13:51:00 by Marwin</div>
   </div>
   <div class="post" id="post-63892">
    <div class="subject"><a href="#post-63892">Getting the content of a foreign edit-control</a></div>
    <div class="body">Maybe you can look at a program source of one of our members, Vom-Bonjour... it does exactly what you want.<br />The source are released both on the MASM32 package as an example, and in Iczelion's website (Get&amp;Set)...</div>
    <div class="meta">Posted on 2002-10-29 14:12:18 by JCP</div>
   </div>
   <div class="post" id="post-63937">
    <div class="subject"><a href="#post-63937">Getting the content of a foreign edit-control</a></div>
    <div class="body">Four-F, I meant editboxes with the ES_PASSWORD bit set. :) <br />Password Revealer works fine and I'd say you did it the best way; approaches other than hooking would fail in one Windows version or another.</div>
    <div class="meta">Posted on 2002-10-30 02:59:29 by C.Z.</div>
   </div>
   <div class="post" id="post-63947">
    <div class="subject"><a href="#post-63947">Getting the content of a foreign edit-control</a></div>
    <div class="body">In case any of you managed to spot what bomb01 wrote about it not being possible to read password fields in 2K and XP, you *can* read it by sending it a WM_GETTEXT, but it is already encrypted so it will mean nothing to you.</div>
    <div class="meta">Posted on 2002-10-30 04:23:27 by sluggy</div>
   </div>
  </div>
 </body>
</html>