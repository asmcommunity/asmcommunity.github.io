<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>hlep need, about using WIN32 MACRO's inside HLA code ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20081" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=17">Iczelion's Tutorials</a> &raquo; <a href="../?id=20081">hlep need, about using WIN32 MACRO's inside HLA code ?</a></p>
   <div class="post" id="post-153891">
    <div class="subject"><a href="#post-153891">hlep need, about using WIN32 MACRO's inside HLA code ?</a></div>
    <div class="body">Hi everyone !<br /><br />My aim is to train myself with resources (exactly here : icons).<br />I adapted in HLA one sample program I found in the MSDN library, about changing the icon of an *.exe (calc) by copying it from another one (winmine).<br /><br />I think my code is rather accurate now, except that I have trouble with the following topics :<br /><br />the functions FindResource and UpdateResource use MACRO's named :<br />1' - MAKEINTRESOURCE which returns a lpStr ;<br />2' - MAKELANGID which returns a word specifying a language ID ;<br /><br />My questions are :<br />1 - how is it to use properly the macro-call (MAKEINTRESOURCE or MAKELANGID)  inside a HLA function-call (FindResource or UpdateResource) AND how do I know the value to pass to that macro ;<br />2 - if need, how can I eventually bypass that macro-call, replacing it by the number or the name of the resource I'm trying to locate (that is : how to locate the Icon resource in the *.exe (winmine) ;<br /><br />Here is my code :<br /><br /><pre><code>program Icons;<br /><br />#include&#40; &quot;stdlib.hhf&quot; &#41;<br />#include&#40; &quot;fileio.hhf&quot; &#41;<br />#include&#40; &quot;w.hhf&quot; &#41;<br /><br />static<br />	hFich1&#58;		dword;<br />	hRessource1&#58;	dword;<br />	hResLoad&#58;	dword;<br />	lpResLock&#58;	dword;	<br />	hUpdateRes&#58;	dword;<br />	dwSizeRes&#58;	dword;<br />	bE_U_R&#58;	 	dword;<br />	bFreeLib&#58;		dword;<br />	bresult&#58;		dword;<br />endstatic;<br /><br />begin Icons;<br /><br />	// STEP 1 - load *.exe from which find the resource &#40;WINMINE.EXE&#41;<br /><br />	w.LoadLibrary&#40;&quot;C&#58;\WINNT\system32\winmine.exe&quot;&#41;;<br />	mov&#40;eax,hFich1&#41;;<br />	stdout.put&#40;nl,&quot; hFich1 &quot;,hFich1&#41;;<br /><br /><br />	// STEP 2 - find resource into *.exe &#40;ICON&#41;<br /><br />	w.FindResource<br />	&#40; <br />		hFich1, <br />		#1,		//MAKEINTRESOURCE&#40;?&#41;,  &#91;color=red&#93;&lt;-- what is here to pass as a param. value ?&#91;/color&#93;		&quot;RT_ICON&quot;<br />	&#41;;<br />	mov&#40;eax,hRessource1&#41;;<br />	stdout.put&#40;nl,&quot; hRessource1 &quot;,hRessource1&#41;;<br /><br /><br />	// STEP 3 - load resource from *.exe<br /><br />	w.LoadResource&#40;hFich1,hRessource1&#41;;<br />	mov&#40;eax,hResLoad&#41;;<br />	stdout.put&#40;nl,&quot; hResLoad &quot;,hResLoad&#41;;<br /><br /><br />	// STEP 4 - lock resource<br /><br />	w.LockResource&#40;hResLoad&#41;;<br />	mov&#40;eax,lpResLock&#41;;<br />	stdout.put&#40;nl,&quot; lpResLock &quot;,lpResLock&#41;;<br /><br /><br />	// STEP 5 - open file to which add the resource &#40;CALC_COPY.EXE&#41;<br /><br />	w.BeginUpdateResource&#40;&quot;C&#58;\WINNT\system32\calc_copy.exe&quot;,false&#41;;<br />	mov&#40;eax,hUpdateRes&#41;;<br />	stdout.put&#40;nl,&quot; hUpdateRes &quot;,hUpdateRes&#41;;<br /><br />	// pre-STEP 6 - size of resource<br />	w.SizeofResource&#40;hFich1,hRessource1&#41;;<br />	mov&#40;eax,dwSizeRes&#41;;<br />	stdout.put&#40;nl,&quot; dwSizeRes &quot;,dwSizeRes&#41;;<br /><br />	// STEP 6 - add resource to the updatelist<br /><br />	w.UpdateResource<br />	&#40;<br />	hUpdateRes,<br />	&quot;RT_ICON&quot;,<br />	#1,<br />	1,		//MAKELANGID  &#91;color=red&#93;&lt;-- what is here to pass as a param. value ?&#91;/color&#93;	&#40;LANG_NEUTRAL,SUBLANG_NEUTRAL&#41;,<br />	lpResLock,<br />	dwSizeRes<br />	&#41;;<br />	mov&#40;eax,bresult&#41;;<br />	stdout.put&#40;nl,&quot; bresult &quot;,bresult&#41;;<br /><br /><br />	// STEP 7 - write changes to updated file &#40;CALC.EXE&#41;<br /><br />	w.EndUpdateResource&#40;hUpdateRes, false&#41;;<br />	mov&#40;eax,bE_U_R&#41;;<br />	stdout.put&#40;nl,&quot; bE_U_R &quot;,bE_U_R&#41;;<br /><br /><br />	// STEP 8 - clean up<br /><br />	w.FreeLibrary&#40;hFich1&#41;;<br />	mov&#40;eax,bFreeLib&#41;;<br />	stdout.put&#40;nl,&quot; bFreeLib &quot;,bFreeLib&#41;;<br /><br />end Icons;</code></pre><br /><br />Who can help me finding what is wrong here ?<br />(I hope I was clear enough, in other case, I give more explanations  :oops: )<br /><br />Thanks a lot for answering or eventually redirecting me to another more appropriate forum...<br /><br />Juan,<br />Belgium.</div>
    <div class="meta">Posted on 2004-12-08 05:05:49 by Juan</div>
   </div>
  </div>
 </body>
</html>