<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Debugger Protection - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25404" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25404">Debugger Protection</a></p>
   <div class="post" id="post-185767">
    <div class="subject"><a href="#post-185767">Debugger Protection</a></div>
    <div class="body">Hey there guys,<br /><br />Like the topic is stated I am wondering on how to protect an exe file being debugged and protect my exe file against setting breakpoints etc..<br />Can you guys help me further on. I have no idea where to start. I just want to protect it against all debuggers out there especially SoftICE and Ollydbg.</div>
    <div class="meta">Posted on 2006-10-07 06:23:07 by Veggy</div>
   </div>
   <div class="post" id="post-185769">
    <div class="subject"><a href="#post-185769">Re: Debugger Protection</a></div>
    <div class="body">i suggest you to start by learning PE structure. for example write app to display PE headers.<br /><br />after that write program that just adds section to PE</div>
    <div class="meta">Posted on 2006-10-07 08:08:47 by vid</div>
   </div>
   <div class="post" id="post-185770">
    <div class="subject"><a href="#post-185770">Re: Debugger Protection</a></div>
    <div class="body">Any recommandations about books etc.. on that?<br /><br />*edit* <br /><br />I just found out Iczelion did a few PE tutorials. Will those cover enough or do you recommend reading other books also? </div>
    <div class="meta">Posted on 2006-10-07 08:34:15 by Veggy</div>
   </div>
   <div class="post" id="post-185777">
    <div class="subject"><a href="#post-185777">Re: Debugger Protection</a></div>
    <div class="body">hmm, IczLion&#39;s is far from complete... but can explain many things for you for beginning.<br /><br />i would suggest also some reference, and downloading anything you can find on subject.<br /><br /><a target="_blank" href="http://en.wikibooks.org/wiki/Reverse_Engineering/PE">http://en.wikibooks.org/wiki/Reverse_Engineering/PE</a><br /><a target="_blank" href="http://board.flatassembler.net/topic.php?t=5616">http://board.flatassembler.net/topic.php?t=5616</a></div>
    <div class="meta">Posted on 2006-10-07 11:59:27 by vid</div>
   </div>
   <div class="post" id="post-185778">
    <div class="subject"><a href="#post-185778">Re: Debugger Protection</a></div>
    <div class="body">Veggy<br /><br />If you don&#39;t embed symbols in your executable, ie. if you don&#39;t create a &quot;debug&quot; version of your exe, then although it can still be disassembled in a debugger, the disassembly will be difficult to follow.&nbsp; Frankly, if anyone tried to follow and use such a disassembly that would be more time consuming than writing the source from scratch in the first place.<br /><br />Do you want to protect against such disassembly to protect your source or is there some other concern that you have?</div>
    <div class="meta">Posted on 2006-10-07 16:43:28 by jorgon</div>
   </div>
   <div class="post" id="post-185780">
    <div class="subject"><a href="#post-185780">Re: Debugger Protection</a></div>
    <div class="body">Hello Veggy,<br /><br />Write a good solid protection scheme that is difficult to cr*ck.&nbsp; Don&#39;t even dream of impossible.<br /><br /><div class="quote">Frankly, if anyone tried to follow and use such a disassembly that would be more time consuming than writing the source from scratch in the first place.</div> <br />You got to be kiddin jorgon!&nbsp; There&#39;s a million programs out there with cr*cks and keygens.&nbsp; They weren&#39;t all shipped with debug symbols.&nbsp; That would be like leaving the bank door open.&nbsp; However locking the door won&#39;t stop robbers ;)<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2006-10-07 18:37:19 by czDrillard</div>
   </div>
   <div class="post" id="post-185782">
    <div class="subject"><a href="#post-185782">Re: Debugger Protection</a></div>
    <div class="body"><div class="quote"><br />Veggy<br /><br />If you don&#39;t embed symbols in your executable, ie. if you don&#39;t create a &quot;debug&quot; version of your exe, then although it can still be disassembled in a debugger, the disassembly will be difficult to follow.&nbsp; Frankly, if anyone tried to follow and use such a disassembly that would be more time consuming than writing the source from scratch in the first place.<br /><br />Do you want to protect against such disassembly to protect your source or is there some other concern that you have?<br /></div><br /><br />Hey there guys,<br /><br />Well the thing is I want to protect my exe file against the possibility to set a breakpoint on the writeprocessmemory api. </div>
    <div class="meta">Posted on 2006-10-08 02:08:30 by Veggy</div>
   </div>
   <div class="post" id="post-185783">
    <div class="subject"><a href="#post-185783">Re: Debugger Protection</a></div>
    <div class="body">No protection scheme will hold up for long however there are a few tricks that will hold off the lesser attacks. Obfuscating your code is always a good idea, write as much spaghetti code as you can and embed data in the code section. Multiple threads using synchronisation objects can make it difficult to trace code. There are plenty of white papers on detecting debuggers/disassemblers such as SoftIce that can let you shut down when it is present in memory, google around a bit and you&#39;ll find a few. Try running an exception handler within your application, you can have your app hang on INT3 fairly easily. Change the AEDebug key for the run of your app, that will redirect the final handler to another application of your choosing, just be sure to change it back.<br /><br />The best you can ever hope for is to buy a bit of time, all protection schemes fail eventually since the tools to reverse engineer applications are incredibly powerful and becoming more so everyday.</div>
    <div class="meta">Posted on 2006-10-08 02:56:03 by donkey</div>
   </div>
   <div class="post" id="post-185785">
    <div class="subject"><a href="#post-185785">Re: Debugger Protection</a></div>
    <div class="body">There&#39;s a plethora of antidebug tricks being employed in the wild.<br />Check out http://www.woodmann.com/forum/index.php for more information, this is not the right forum for such discussions.<br />Note that I&#39;ve written a userland debugger which is immune to almost all of the known antidebug methods (it uses lookahead analysis).<br /></div>
    <div class="meta">Posted on 2006-10-08 04:15:24 by Homer</div>
   </div>
   <div class="post" id="post-185788">
    <div class="subject"><a href="#post-185788">Re: Debugger Protection</a></div>
    <div class="body">Okay guys thanks for all the help and tips, I will start reading on all of them.</div>
    <div class="meta">Posted on 2006-10-08 07:02:49 by Veggy</div>
   </div>
   <div class="post" id="post-185800">
    <div class="subject"><a href="#post-185800">Re: Debugger Protection</a></div>
    <div class="body"><div class="quote"><br />Change the AEDebug key for the run of your app, that will redirect the final handler to another application of your choosing, just be sure to change it back.<br /></div><br />It&#39;s not a good idea to play with that kind of registry values. And do consider what happens *if* your program crashes or exits unexpectedly without restoring the key... it&#39;s not like it&#39;s going to buy you a lot anyway.<br /><br />Code obfuscation is one of the few things that does work pretty well, but you should use automated tools to do it and keep your source code clean - for your own sake.<br /><br />Softice detection is fairly useless - anybody that&#39;s able to use that debugger will hide it (there&#39;s several public tools out there to do that, and then there&#39;s some private and <strong>very</strong> powerful tools). Softice detection will mainly piss off programmers that can&#39;t run your grame/program/whatever just because they have softice <em>installed</em>, not even running, on their machine.<br /><br />Multiple threads, synchronization and use of SEH is a good step, it makes it annoying to trace your code. Do yourself a favor and have a RELEASE/DEBUG build set up, so you can actually debug your own code when built in debug mode :)<br /></div>
    <div class="meta">Posted on 2006-10-08 17:13:37 by f0dder</div>
   </div>
  </div>
 </body>
</html>