<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>LINK : fatal error L1104: \masm32\lib\kernel32.lib : not val - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1639" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=1639">LINK : fatal error L1104: \masm32\lib\kernel32.lib : not val</a></p>
   <div class="post" id="post-10465">
    <div class="subject"><a href="#post-10465">LINK : fatal error L1104: \masm32\lib\kernel32.lib : not val</a></div>
    <div class="body">From Iczelion Tutorial No.2. <br /><br />.386 <br />.model flat,stdcall <br />option casemap:none <br />include \masm32\include\windows.inc <br />include \masm32\include\kernel32.inc <br />includelib \masm32\lib\kernel32.lib <br />include \masm32\include\user32.inc <br />includelib \masm32\lib\user32.lib <br /><br />.data <br />MsgBoxCaption  db &quot;Iczelion Tutorial No.2&quot;,0 <br />MsgBoxText       db &quot;Win32 Assembly is Great!&quot;,0 <br /><br />.code <br />start: <br />invoke MessageBox, NULL, addr MsgBoxText, addr MsgBoxCaption, MB_OK <br />invoke ExitProcess, NULL <br />end start <br /><br />When I type ml msgbox.asm I get <br />LINK : fatal error L1104: \masm32\lib\kernel32.lib : not valid library<br />if I comment it out I get<br />LINK : fatal error L1104: \masm32\lib\user32.lib : not valid library<br /><br /><br />I have tried it with the Lib I got from Hutch's down load and also the one  from Readiosys but I still get the same message. I can assemble and run a Hello World but any includelib gets me these errors. Should I try getting it from MS? If so can anybody tell me which PSDK-FULL.&lt;N&gt;.cab has the Lib in it (or if this is what I want to get)?  Any suggestions would be greatly appreciated.</div>
    <div class="meta">Posted on 2001-10-28 09:43:34 by Steve</div>
   </div>
   <div class="post" id="post-10496">
    <div class="subject"><a href="#post-10496">LINK : fatal error L1104: \masm32\lib\kernel32.lib : not val</a></div>
    <div class="body">Strange. What OS do you run?<br /><br />Do you have another version of LINK, maybe an older one that doesn't know about import libs?<br /><br />Post your MAKE (or whatever) file.<br /><br />:)<br /><br />Oops, I see that you typed ML. You need some command line options. Take a look at the .BAT files that are in \MASM32\BIN. You'll need something like this:<br /><br />\masm32\bin\ml /c /coff %1.asm<br />\masm32\bin\Link /SUBSYSTEM:WINDOWS %1.obj<br /><br />Hope this helps. :)</div>
    <div class="meta">Posted on 2001-10-28 16:31:20 by S/390</div>
   </div>
   <div class="post" id="post-10498">
    <div class="subject"><a href="#post-10498">LINK : fatal error L1104: \masm32\lib\kernel32.lib : not val</a></div>
    <div class="body">I have downloaded link from 3 dif places on the net in the past couple of weeks. I'm running win98. I guess I better learn about make files (don't know nutin' bout that :) I'll play around with your suggestions, Thanks.</div>
    <div class="meta">Posted on 2001-10-28 17:07:47 by Steve</div>
   </div>
   <div class="post" id="post-10499">
    <div class="subject"><a href="#post-10499">LINK : fatal error L1104: \masm32\lib\kernel32.lib : not val</a></div>
    <div class="body">Tried command line args and got <br />msgbox.obj : fatal error L1101: invalid object module<br />Object file offset: 1 Record type: 4c<br /><br /><br />Am I supposed to perform some kind of manipulation of the LIB folder before I use it or is it ready to go once unzipped?:confused:  Thanks</div>
    <div class="meta">Posted on 2001-10-28 17:21:21 by Steve</div>
   </div>
   <div class="post" id="post-10502">
    <div class="subject"><a href="#post-10502">LINK : fatal error L1104: \masm32\lib\kernel32.lib : not val</a></div>
    <div class="body">The LIB folder should be good to go as is.<br /><br />Sounds link you may have a LINK version problem. MASM32 ships with 5.12.8078 (I'm using 6.00.8447). You'll also need MSPDB50.DLL to go with it.<br /><br />The /coff switch should generate the correct .OBJ format.<br /><br />That's about all I can think of. :)</div>
    <div class="meta">Posted on 2001-10-28 17:42:50 by S/390</div>
   </div>
   <div class="post" id="post-10539">
    <div class="subject"><a href="#post-10539">LINK : fatal error L1104: \masm32\lib\kernel32.lib : not val</a></div>
    <div class="body"><div class="quote"><br />msgbox.obj : fatal error L1101: invalid object module <br />Object file offset: 1 Record type: 4c <br /></div><br />Sounds very much like you're assembling to OMF format... which is<br />bad :). &quot;ml /c /coff blah.asm&quot; is the basic cmdline for &quot;correct&quot; assembly.<br />Also, make sure you don't have a dog-old linker version somewhere<br />in your path that gets executed instead of the one from masm32..</div>
    <div class="meta">Posted on 2001-10-29 00:11:59 by f0dder</div>
   </div>
   <div class="post" id="post-10751">
    <div class="subject"><a href="#post-10751">LINK : fatal error L1104: \masm32\lib\kernel32.lib : not val</a></div>
    <div class="body">Thanks for the help guys.  I got it!</div>
    <div class="meta">Posted on 2001-10-30 16:32:07 by Steve</div>
   </div>
   <div class="post" id="post-10766">
    <div class="subject"><a href="#post-10766">LINK : fatal error L1104: \masm32\lib\kernel32.lib : not val</a></div>
    <div class="body">Cool. And you're welcome.<br /><br />Now you can start to have some real fun! :)</div>
    <div class="meta">Posted on 2001-10-30 19:35:14 by S/390</div>
   </div>
  </div>
 </body>
</html>