<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>threading model question - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4054" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=4054">threading model question</a></p>
   <div class="post" id="post-27674">
    <div class="subject"><a href="#post-27674">threading model question</a></div>
    <div class="body">Hi to all, <br />well i've another problem with my COM project <br /><br />Well i've created a dll activex that exports an object with methods and events with the apartment threading model <br />That component has to create an extra thread every time <br />its instanced <br /><br />When i use that component in a standard exe it works well <br />well i can call methods and retrive events correctly <br /><br />When i use it in an exe activex with the &quot;thread per object&quot; option set and i create some instances of that object i can call methods correctly but when events occurs the component in the dll activex crashes <br />From the debug it seems that crashes when i do: <br />ptr-&gt;Fire_OnConnected(); /* Firing event*/ <br /><br />The ptr is the pointer to the class in the dll activex <br />Well i've to generate events this way coz i'm in a separate thread (the extra thread i told u before) and that pointer is saved in the local memory of the thread at its creation <br /><br />The error that occurs seems to be an access fault coz it tries to read in some wrong address in memory <br /><br />The fact that the component is working well in a standard exe and it only gives problem in an exe activex when trying to communicate form separate threads makes me think that the problem should be related to the threading model used ? <br />Is it wrong to use the single thread apartment model in the component developing in the dll activex ? <br /><br />Tnx a lot <br />NikDH</div>
    <div class="meta">Posted on 2002-03-07 12:24:39 by NikDH</div>
   </div>
  </div>
 </body>
</html>