<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Desktop listview revisited - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18821" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=18821">Desktop listview revisited</a></p>
   <div class="post" id="post-145737">
    <div class="subject"><a href="#post-145737">Desktop listview revisited</a></div>
    <div class="body">Recently I was asked how to extract the full path from an item on the desktop. I had written a demo that would get the display name and position for someone here and have expanded it to include translating the PIDL that is stored in the item lParam to a fully qualified path. Since the IDL that the PIDL is pointing to is resident in the desktop process, it must first be copied to our process then we can use standard SH* functions that accept a PIDL. Here is the project that demos how to do it if anyone is interested, it is fully compatible with all Windows versions I have tested on (NT4, Win95OSR0, Win98SE and Win2K). Though this will work on all Windows versions, it looks best with Common Controls V4.71 or better.<br /><br />The original demo was only NT compatible, which presented a few problems (and comments) that I have fixed up in this version. For Win9x it uses a few undocumented API functions for interprocess memory allocation (ordinal imports), but since those OS versions will no longer be updated this should not present any problems. The NT execution path only uses documented functions to insure future compatibility:<br /><br /><a target="_blank" href="http://donkey.visualassembler.com/files/LVDesktop9xNT.zip">I have moved the file to my website</a></div>
    <div class="meta">Posted on 2004-07-09 12:19:19 by donkey</div>
   </div>
   <div class="post" id="post-145783">
    <div class="subject"><a href="#post-145783">Desktop listview revisited</a></div>
    <div class="body">fun :)</div>
    <div class="meta">Posted on 2004-07-09 23:49:23 by Homer</div>
   </div>
  </div>
 </body>
</html>