<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ini files - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4836" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4836">ini files</a></p>
   <div class="post" id="post-33907">
    <div class="subject"><a href="#post-33907">ini files</a></div>
    <div class="body">wondering if anyone could help with ini files maybe some examples   also what would i invoke to count the kerys in a ini file <br /><br />like the   etc... so i can see how many keys exist</div>
    <div class="meta">Posted on 2002-04-17 22:29:36 by illwill</div>
   </div>
   <div class="post" id="post-33912">
    <div class="subject"><a href="#post-33912">ini files</a></div>
    <div class="body">In MSDN, look up &quot;Registry Functions&quot;. Under &quot;Obsolete functions&quot; you'll see a list of API's to work with ini files :)<br />You can use GetPrivateProfileSectionNames to get the names of all the sections and then count the number of names.<br />Note that this is the easy to code / slow to run version. A simple CreateFile / ReadFile solution would definately be faster.</div>
    <div class="meta">Posted on 2002-04-18 00:49:49 by Qweerdy</div>
   </div>
   <div class="post" id="post-33934">
    <div class="subject"><a href="#post-33934">ini files</a></div>
    <div class="body">I endorse the use of the registry too. It is simple to deal with, there are APIs to do everything for you. It is also fast. The only time i would use an ini file is when you are wanting to save large amounts of data. Take a look through the MASM examples, there are three different registry example files (<em>REGKEY2</em> and <em>ENUMKEYS</em> and <em>REGDEMO</em>), and you should find a registry library or two on Icz's site.</div>
    <div class="meta">Posted on 2002-04-18 08:38:21 by sluggy</div>
   </div>
   <div class="post" id="post-33935">
    <div class="subject"><a href="#post-33935">ini files</a></div>
    <div class="body">A good idea for a LIB is some routines that allow you to switch between using the registry and using an INI file.  Getting values would be transparent as to where they are stored.  Conversion would have to be made: registry &lt;--&gt; INI.</div>
    <div class="meta">Posted on 2002-04-18 09:01:08 by bitRAKE</div>
   </div>
   <div class="post" id="post-33945">
    <div class="subject"><a href="#post-33945">ini files</a></div>
    <div class="body">well unfortunatly the program im making is an addon to a crappy program that uses .ini files for everything i saves ,modifies etc.. the only registry entry it has is for its uninstall key which is kinda got me trying to figure out how to set the currentdir of the install directory  &quot;UninstallString&quot;=&quot;C:\\Program Files\\programthatsux\\programthatsux.exe /uninstall&quot;  how would i shave off the programthatsux.exe /uninstall  from the buffer that gets the reg key so i can just have it say X:\\Program Files\\programthatsux  in the buffer?</div>
    <div class="meta">Posted on 2002-04-18 11:02:19 by illwill</div>
   </div>
   <div class="post" id="post-33957">
    <div class="subject"><a href="#post-33957">ini files</a></div>
    <div class="body">u can use a GetPathOnly func from MASM32Lib from MASM32v<br />7<br /><pre><code>Invoke GetPathOnly, ADDR string, ADDR buffer</code></pre></div>
    <div class="meta">Posted on 2002-04-18 13:22:51 by NEMO</div>
   </div>
   <div class="post" id="post-33984">
    <div class="subject"><a href="#post-33984">ini files</a></div>
    <div class="body">Or you could search from the end of the string towards the start, looking for the first instance of &quot;\\&quot;, then put a NULL char there, then you can just use the current string pointer is calling an API function. If using this method, be aware that your buffer will still be the same size even though your string is shorter (you don't want memory leaks now :) )</div>
    <div class="meta">Posted on 2002-04-18 17:26:40 by sluggy</div>
   </div>
   <div class="post" id="post-33998">
    <div class="subject"><a href="#post-33998">ini files</a></div>
    <div class="body"><div class="quote"><br />I endorse the use of the registry too. It is simple to deal with, there are APIs to do everything for you. It is also fast. </div><br /><br />not only that, you can set an even larger smorgasbord of permissions, too :)</div>
    <div class="meta">Posted on 2002-04-18 20:55:03 by jademtech</div>
   </div>
  </div>
 </body>
</html>