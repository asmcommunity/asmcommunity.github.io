<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Ado - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14858" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=14858">Ado</a></p>
   <div class="post" id="post-115313">
    <div class="subject"><a href="#post-115313">Ado</a></div>
    <div class="body">With some convincing from Hiroshimator, Im working with the ADO.Recordset interface to whip up a simple database.<br /><br />Things are going quite well thanks to his help with as vbs example, however, im haveing one problem.  For some reason i get an error when calling IUnknown::Release() on the pIAdoRecordset.  I know the pIAdoRecordset handle is valid, because it makes a visible database on my harddrive and set as i programmed it to.  Here is the debug outputs:<pre><code>eax = 00000001 &#40;ADO.asm, 117&#41;  &#40;1== Created Instance, 0 == Failed&#41;<br />eax = 00000000, put_CursorLocation &#40;ADO.asm, 123&#41;<br />eax = 00000000, put_CursorType &#40;ADO.asm, 126&#41;<br />eax = 00000000, put_LockType &#40;ADO.asm, 129&#41;<br />eax = 00000000, put_get_Fields &#40;ADO.asm, 132&#41;<br />eax = 00000000, put_get_Fields &#40;ADO.asm, 135&#41;<br />eax = 00000000, Append &#40;ADO.asm, 147&#41;<br />eax = 00000000 &#40;ADO.asm, 156&#41;<br />eax = 00000000, AddNew &#40;ADO.asm, 176&#41;<br />eax = 00000000, Update &#40;ADO.asm, 187&#41;<br />eax = 00000000, Save &#40;ADO.asm, 203&#41;<br />eax = 00000000, Close &#40;.\mod\CAdo.asm, 147&#41;<br />eax = 00000001, IUnknown&#58;Release &#40;.\mod\CAdo.asm, 149&#41;</code></pre><br />With exception to the first line (non com call), everything else is.  So a 0 == success, and 1 == error.<br /><br />Can anyone add your thoughts as to why it may be doing this??  Is there another ways to close the ADO.Recordset interface?<br /><br />Thanks in advance!<br />:NaN:</div>
    <div class="meta">Posted on 2003-08-24 19:36:47 by NaN</div>
   </div>
   <div class="post" id="post-115314">
    <div class="subject"><a href="#post-115314">Ado</a></div>
    <div class="body">Nevermind, should have searched the net first :rolleyes:<br /><br /><div class="quote">Return Value<br />Returns the resulting value of the reference count, which is used for diagnostic/testing purposes only</div><br /><br />I will assume then that it is releasing properly...<br />:NaN:</div>
    <div class="meta">Posted on 2003-08-24 19:44:02 by NaN</div>
   </div>
   <div class="post" id="post-116220">
    <div class="subject"><a href="#post-116220">reference count</a></div>
    <div class="body">NaN,<br /><br />Unless there's a reason you haven't mentioned, doesn't a return of one indicate that you still have a reference to the recordset hanging around somewhere?</div>
    <div class="meta">Posted on 2003-08-29 23:40:23 by djinn</div>
   </div>
   <div class="post" id="post-116264">
    <div class="subject"><a href="#post-116264">Ado</a></div>
    <div class="body">Yes it does... When i posted i thought it ment error...<br /><br />But what was happening was from an evening of making mistakes, and GPF's, one instance never closed... ( had a bugger of a time working out SafeArray issues ~ ADO is very finiky with this, it doesn return error, it crashes! )<br /><br />I now have it under control, and i have yet to see it return 1 since ;)<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-08-30 09:20:01 by NaN</div>
   </div>
   <div class="post" id="post-118251">
    <div class="subject"><a href="#post-118251">Like to see the code to this sample</a></div>
    <div class="body">I would really like to see the code to your sample. I am beginning to put together a demo myself using ado and I am having problems accessing all of the com methods available.<br /><br />Thanks,<br />Liamo</div>
    <div class="meta">Posted on 2003-09-15 17:35:07 by Liamo</div>
   </div>
   <div class="post" id="post-118273">
    <div class="subject"><a href="#post-118273">Ado</a></div>
    <div class="body">Which interfaces / methods are you haveing trouble with... Everything works fine from what i have done (early binding on everything).<br /><br />I would share the code, but its my OOP class stuff and not finished.  I have gotten side tracked learning how to write my own COM classes (I plan to database GUID's and some other stuff).<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-09-15 19:19:57 by NaN</div>
   </div>
   <div class="post" id="post-118476">
    <div class="subject"><a href="#post-118476">ADO</a></div>
    <div class="body">Thanks for the reply NaN<br />I will try to post my sample next week as i have some tidying to do on the code and work is busy at the moment.<br /><br />Liamo</div>
    <div class="meta">Posted on 2003-09-17 17:15:23 by Liamo</div>
   </div>
  </div>
 </body>
</html>