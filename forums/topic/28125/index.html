<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>pop-up menu - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=28125" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=28125">pop-up menu</a></p>
   <div class="post" id="post-199477">
    <div class="subject"><a href="#post-199477">pop-up menu</a></div>
    <div class="body">In my program I have a toolbar and a menu bar.
I wish to make an pop-up menu when this app is minimized to
to tray.
Is there some way to use the same menu bar I use in my program?

I tryed to do that :

    .elseif uMsg == WM_SHELLNOTIFY

        .if wParam==IDI_TRAY
            
            .if lParam == WM_RBUTTONDOWN
            
				invoke GetCursorPos,addr pt
				invoke SetForegroundWindow,hWnd

                                invoke GetSubMenu,PopUpMenu,1
                        
				invoke TrackPopupMenu,eax,TPM_RIGHTALIGN or TPM_RIGHTBUTTON,pt.x,pt.y,NULL,hWnd,NULL
				invoke PostMessage,hWnd,WM_NULL,0,0


but, in this case, I get 2 problems :

1 - I just can put one of the menu's pop-ups (in this case I used the second);
2 - I don't know why, but, I when I click over one of the popup's itens in the
pop-up menu I get from the icon in the system tray, the icon is destroyed and the
window is not restaured. This didn't occours when I had this code (no pop-up menu) :

    .elseif uMsg == WM_SHELLNOTIFY

        .if wParam==IDI_TRAY
            
            .if lParam == WM_RBUTTONDOWN
            
                        invoke  CapProc


If somebody can help, I will be very gratefull.


    Sergio A.S. de Aguiar

    ssaguiar

My program is for use with a video capture board, compatible with video for
windows and can let you watch image from it in your computer
and also capture video and grab frames in bmp and jpg (it uses a comercial
dll to do it), it can also send a home page to a client that connects to it (at
this time this home-page is just to demonstrate how to do it, but it will be
later to authenticate an username and a password, and then send another page
with an java applet to begin sending grabbed frames in jpg to the connected
client as soon as he authenticated successfully).

If anyone wants this source code and the executable, just ask it, and I'll 
send it.</div>
    <div class="meta">Posted on 2001-05-19 21:05:00 by ssaguiar</div>
   </div>
   <div class="post" id="post-199478">
    <div class="subject"><a href="#post-199478">pop-up menu</a></div>
    <div class="body">I am not sure, but take a look at T. Milos's
package called Tools on the source-code page
here at iczelion. It seems that he can get a
popup menu from a tray icon.</div>
    <div class="meta">Posted on 2001-05-23 04:17:00 by Larry Hammick</div>
   </div>
  </div>
 </body>
</html>