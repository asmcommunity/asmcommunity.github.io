<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Dll to static lib - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16411" />
  <link rel="prev" href="../?id=16411&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16411">Dll to static lib</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=16411&amp;page=1" style="">&laquo;</a><a href="../?id=16411&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="16411" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-130421">
    <div class="subject"><a href="#post-130421">Dll to static lib</a></div>
    <div class="body">Hi.<br /><br />@Gismo: Ja, hab' ich. M?chtest du die Dll gerne nutzen ?<br />@f0dder: Is it possible or not ? The Dll uses no resources.<br /><br />Regards,<br />Nordwind64</div>
    <div class="meta">Posted on 2004-01-12 04:53:07 by Nordwind64</div>
   </div>
   <div class="post" id="post-130432">
    <div class="subject"><a href="#post-130432">Dll to static lib</a></div>
    <div class="body">It is indeed possible, but requires work... you're basically creating one single .obj file from a PE image, converting PE relocs to COFF OBJ relocs, and adding exports from the DLL into the symbol table. COFF and PE are quite related, but it's still a lot of work.<br /><br />You'll probably have problems if the DLL is packed or encrypted in any way, and such a layer (whether it's for size or protection or from sheer stupidity) will have to be removed first.<br /><br />There more to it than this, though. You will have to call some extra code per DLL that's converted to static lib, to fill it's imports and call DllMain. If you're very unlucky, you'll have to handle TLS and other stuff too, but fortunately that stuff isn't used in many DLLs.<br /><br />The reason DLLs with resources wont work, is that there's no way (that I know of, anyway) to &quot;register&quot; resources with windows at runtime - if it's not referenced in the PE headers, it's unusable. You could perhaps fix this by not letting the static-version-of-DLL have normal Resource imports, but rather your own functions handling the stuff, but then you're doing a lot of work and might as well use the DLL or find some other library.<br /><br />Also, be aware of potential copyright violations...</div>
    <div class="meta">Posted on 2004-01-12 07:47:05 by f0dder</div>
   </div>
   <div class="post" id="post-130453">
    <div class="subject"><a href="#post-130453">Dll to static lib</a></div>
    <div class="body">minor28,<br /><br />This thread is about converting DLLs to static libs; but if you are interested about creating import libs from DLLs,you can have a look at <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=13805">here</a></div>
    <div class="meta">Posted on 2004-01-12 13:35:05 by Vortex</div>
   </div>
   <div class="post" id="post-130488">
    <div class="subject"><a href="#post-130488">Dll to static lib</a></div>
    <div class="body">Yes, I was confused about dll-&gt;static lib conversion. I didn't knew the meening of static lib but I do now. <br /><br />One allways learn anything new.<br /><br />Regards</div>
    <div class="meta">Posted on 2004-01-13 02:00:05 by minor28</div>
   </div>
   <div class="post" id="post-130519">
    <div class="subject"><a href="#post-130519">Dll to static lib</a></div>
    <div class="body">Hi, <br /><br />@Nordwind64<br />ja gerne.<br />Hast du es geschafft eine statische lib zu erzeugen?<br />Wenn ja, macht es Dir was aus sie weiterzugeben?<br /><br /><br />Gru?<br />Gismo</div>
    <div class="meta">Posted on 2004-01-13 11:51:23 by Gismo</div>
   </div>
   <div class="post" id="post-130521">
    <div class="subject"><a href="#post-130521">Dll to static lib</a></div>
    <div class="body">Keep it in english please :(</div>
    <div class="meta">Posted on 2004-01-13 12:35:44 by f0dder</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=16411&amp;page=1" style="">&laquo;</a><a href="../?id=16411&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="16411" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>