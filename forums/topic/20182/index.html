<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>[Screenshot, capture] How to simply do it ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20182" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20182">[Screenshot, capture] How to simply do it ?</a></p>
   <div class="post" id="post-154590">
    <div class="subject"><a href="#post-154590">[Screenshot, capture] How to simply do it ?</a></div>
    <div class="body"><pre><code>http&#58;//diablo2oo2.di.funpic.de/stuff/bmp.screenshot.zip</code></pre><br /> this code dosnt use clipboard.<br /><br />anyway i also would like to know how to write the bmp file from clipboard<br /><br /><pre><code>invoke keybd_event,VK_SNAPSHOT,0,0,0<br />	invoke keybd_event,VK_SNAPSHOT,0,KEYEVENTF_KEYUP,0<br />	invoke OpenClipboard,0<br />	invoke GetClipboardData,CF_BITMAP	;or CF_DIB ?<br />	;... what now?<br />	<br />	invoke CloseClipboard<br />	invoke ExitProcess,0</code></pre></div>
    <div class="meta">Posted on 2004-12-22 06:05:29 by diablo2oo2</div>
   </div>
   <div class="post" id="post-154592">
    <div class="subject"><a href="#post-154592">[Screenshot, capture] How to simply do it ?</a></div>
    <div class="body">Have you read the other posts on this topic??<br />http://www.win32asmcommunity.net/board/viewtopic.php?t=20170</div>
    <div class="meta">Posted on 2004-12-22 07:21:51 by dev_zero</div>
   </div>
   <div class="post" id="post-154593">
    <div class="subject"><a href="#post-154593">[Screenshot, capture] How to simply do it ?</a></div>
    <div class="body">Actually it is that he posted in the wrong thread, but I could not merge the threads.... or do not know how to</div>
    <div class="meta">Posted on 2004-12-22 07:26:25 by roticv</div>
   </div>
   <div class="post" id="post-154596">
    <div class="subject"><a href="#post-154596">[Screenshot, capture] How to simply do it ?</a></div>
    <div class="body">hello, diablo2oo2.<br /><br />your Proc and Allanon's Proc work fine.<br />but the pixels that captured from screen is less than the ACS capture soft  captured from screen.<br /><br /><br />regards</div>
    <div class="meta">Posted on 2004-12-22 09:50:08 by dcskm4200</div>
   </div>
   <div class="post" id="post-157095">
    <div class="subject"><a href="#post-157095">WS_EX_LAYERED and CAPTUREBLT</a></div>
    <div class="body">Hi, diablo2oo2<br /><br />About  http://diablo2oo2.di.funpic.de/stuff/bmp.screenshot.zip <br /><br />Your screenshot.exe can't capture layered windows (WS_EX_LAYERED) on Win2k, XP etc.<br /><br />Let's fix it:<br />1) open screenshot.exe as binary,<br />2) find 2000CC00,<br />3) replace it with 2000CC40.<br /><br />For screenshot.asm it means:<br /><br />invoke BitBlt,memdc,0,0,dwWidth,dwHeight,hdc,0,0,SRCCOPY or CAPTUREBLT  (instead of just SRCCOPY)<br /><br />But since WINDOWS.INC of MASM32-v.8 doesn't contain CAPTUREBLT constant yet -<br /><br />you must insert to screenshot.asm :<br /><br />CAPTUREBLT equ 40000000h</div>
    <div class="meta">Posted on 2005-02-16 20:44:33 by kero</div>
   </div>
  </div>
 </body>
</html>