<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Serial Port &amp; AsmIo/WinIo - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2021" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2021">Serial Port &amp; AsmIo/WinIo</a></p>
   <div class="post" id="post-12933">
    <div class="subject"><a href="#post-12933">Serial Port &amp; AsmIo/WinIo</a></div>
    <div class="body">From the TASM individual (me) who refuses to switch a 354KB .ASM pgm to MASM.  I found in one of my TASM .txt files a make file for DLL's and to use 'implib.exe' to build a .lib - both worked fine.  The pgm assembled w/ no errors, but still did not work - no comm. w/ the machine.<br /><br />However, I noted in one of Hutch's responses to someone else that you should use LoadLibrary and GetProcAddr and you must push the params manually.  This is  probably a stupid question, but if I push the params, does this mean I also have to pop them manually or will the funct. call do it?</div>
    <div class="meta">Posted on 2001-11-24 13:08:33 by DaveTX47</div>
   </div>
   <div class="post" id="post-12944">
    <div class="subject"><a href="#post-12944">Serial Port &amp; AsmIo/WinIo</a></div>
    <div class="body">Dave,<br /><br />When you manually call a procedure with LoadLibrary() GetProcAddress() the stack manipulation depends on the calling convention. With windows API calls they are almost exclusively STDCALL so you push your parameters in reverse order when you make the call and the STDCALL procedure cleans up the stack on return.<br /><br />Now here is a little bait to further play with MASM, the different object file formats where MASM is COFF as against TASM using the OLD OMF format cash out in smaller EXE files when built in MASM.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2001-11-24 16:49:43 by hutch--</div>
   </div>
   <div class="post" id="post-12951">
    <div class="subject"><a href="#post-12951">Serial Port &amp; AsmIo/WinIo</a></div>
    <div class="body">Sorry Hutch, but don't understand what 'cash out' means.  Borland states OMF is the Intel object file format.</div>
    <div class="meta">Posted on 2001-11-24 20:37:49 by DaveTX47</div>
   </div>
  </div>
 </body>
</html>