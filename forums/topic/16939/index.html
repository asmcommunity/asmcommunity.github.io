<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>nasm, user/supervisor, ... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16939" />
    <link rel="next" href="../?id=16939&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16939">nasm, user/supervisor, ...</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=16939&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=16939&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="16939" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=16939&amp;page=2">&gt;</a><a href="../?id=16939&amp;page=2">&raquo;</a></form>   <div class="post" id="post-131392">
    <div class="subject"><a href="#post-131392">nasm, user/supervisor, ...</a></div>
    <div class="body">Ho humm, a couple of questions, related to other threads around here.<br /><br />First, on nasm macros. In masm, we have the capability to return a value from a macro, so stuff like `dd CText(&quot;blah&quot;)'  or &quot;invoke blah, CText(&quot;Blah!&quot;)'  can be done. I looked over the nasm macro reference (rather briefly, admitted), but wasn't able to find such a feature :(<br /><br />Second, some kernel-mode question. Is there a (documented or not) way of setting page permissions from kernel mode? I know it's possible to set READ/WRITE permission, but I really want to get at the user/supervisor bit. And frankly, because of the way NT manages the pagetables, I'd rather not have to modify them myself if I can avoid it.</div>
    <div class="meta">Posted on 2004-01-22 17:52:13 by f0dder</div>
   </div>
   <div class="post" id="post-131406">
    <div class="subject"><a href="#post-131406">nasm, user/supervisor, ...</a></div>
    <div class="body">There no exist such a feature in nasm, basically nasm replaces the text<br />defined in the macro and manipulate in the correct way,<br />with what you have defined before in the macro body, also you can use the option at command line<br /> -lnameOfListFile to see how is this replacement done.<br /><br /> There are local labels for macros and context, the first is used for generate diferent labels....<br /> when you use the same macro serious times and you whant 'write' a label you will get a error like<br /> redeclaration of xName... this can be solved using locals macro labels,<br /> this is that you use in a macro and a like internal counter is incremented,<br /> and you can use the name in other macro but with other internal value (follow a secuence)... or<br /> like the context (or scope) of a local with proc, you can reuse the name calling the<br /> same macro serious times.<br /><br /> The context labels can be accessed from diferent macros,<br />  this is have a 'global' scope in(between) the macros, only if exist a context... (created with %push %pop directives to the preprocessor<br />  this is a LIFO)<br /><br /> In nasm, there exist a very easy way of do the thing invk &quot;str&quot;, 1, eax<br /><br />%macro invk 1-*<br /> 	%rep %0-1<br />		%ifstr %1<br />			;<br />			jmp %%skip_this_in_code<br />			%%str ;create a local label (there exist a internal counter to nasm, that generate a secuence)<br />				db %1,0<br />			%%skip_this_in_code<br />			;__SECT__<br />			push dword %%str<br />		%else<br />			push dword %1<br />		%endif<br />	%endrep<br />	%if %1_defined<br />		call %1<br />	%else<br />		call [%1]<br />	%endif<br />%endmacro<br /><br />Here I comment some lines, for show two difrent ways of do the same thing, like is now, insert the text<br />in the code and skeep it and push the local macro label %%str, if you uncomment the lines,<br />and comment the line and comment jmp %%skip_this_in_code, you have other way, switch to data section<br />mark the label return to the code section and push like in the anterior way...... also see that %%name is really a label<br />is manipulated like that at the end by nasm.....<br />... also see that the local counter for the locals labels is only incremented 'after' you define a label, not in a instruction like jmp, that not generate a label<br />when you use invk MessageBox, NULL, &quot;hello&quot;, Three&quot;, MB_OK, the macro will be<br />evaluated and produce the correct secuence, also see that you can pass<br />a no limit of arguments (this is marked with the marks of how many arguments you whant,<br />at the declaration line, you see 1-*), this mark the less and the most arguments that the<br />macro can accept, in this case 1 to 'infinity' marked with *... also I think maybe there exist a limit..<br />but I think is a linked list that handle the arguments... dont remember :S....<br /><br />Ok, to much text and I think I not explain the point.... :D<br /><br />See that you can create a label for example, and still there, or you can assign a number to a<br />thing, and after the execution of the macro still there the value<br />I use this in a macro that I have (I not return nothing, but can still access the definitions that I do inside,<br />handle locals, also I will like provide some like blocks,<br />for accept locals not at procedure level, but for a loop level, and like was sayed before (dunno where)<br />dont overload the function if is recursive, only have the space for the local where necesary...<br />but thatis a later work<br /><br />I think I can superate in a lot of way the proc/invoke in masm, the only real limitation that I find is that<br />I can not check for the size of a thing... because in nasm there no exist such a thing, there no exist<br />such a thing...... for example, in fact in nasm there no exist structs.. exist address+displacement ;), also...<br />for look like other assemblers there exist a macro... yea macros are used for this, that handle the struct thing....<br /><br />struc aStructure<br />.name1 resb 1<br />.name2 resb 1<br />.name3 resd 1<br />endstruc<br /><br /><br />And for acces, if you have in data section:<br />aVarOrLabelOrAddress resb aStructure_size ;there no exist sizeof.. there no exist.. sizes.. or some like that.. tracing of sizes...<br /><br />you do....<br />mov eax, aVarOrLabelOrAddress<br />xor ebx, ebx<br />mov , ebx ;you zeroise the first two elements (also they are only address)... also see that<br />; there is no warning or some when you do this, because nasmw dont have check for size of variables...<br />; or nasm dont have types ..... only other things and such ;)<br />mov , bx<br />;or<br />mov , bx ; This is only for not need remember each displacement, and read<br />symbolic names... that have more meaning that a mov , bx<br /><br /><br /><br /><br />Hope if you read to this place... no, no exist a return directive or some like that for the preprocessor,<br />what you define inside a macro, can be used outside.<br /><br /><br />And hope too that I explain well... :S<br /><br />If still having questions.. simple do the question ;), about the other question I dunno... I think some other people can help in tht.. :D<br /><br />Have a nie day or night.</div>
    <div class="meta">Posted on 2004-01-22 23:07:24 by rea</div>
   </div>
   <div class="post" id="post-131408">
    <div class="subject"><a href="#post-131408">nasm, user/supervisor, ...</a></div>
    <div class="body">&gt; In masm, we have the capability to return a value from a macro, so stuff like `dd CText(&quot;blah&quot;)' or<br />&gt; &quot;invoke blah, CText(&quot;Blah!&quot;)' can be done. I looked over the nasm macro reference (rather briefly,<br />&gt; admitted), but wasn't able to find such a feature.<br /><br />I have not finded any macro instruction in NASM like the &quot;exitm&quot; of MASM, but there are some ways<br />to do things like:<br /><br />invoke blah, CText &quot;Blah!&quot;<br /><br />or<br /><br />invoke blah, addr <br /><br />You can use the &quot;%ifidn&quot; macro instruction in the &quot;invoke&quot; macro to select what parameter<br />begins with &quot;CText&quot; or &quot;addr&quot;; something like:<br /><br />%ifidn %1, CText<br />%rotate 1<br />.data<br />%%blah db %1, 0<br />.text<br />push dword %%blah<br />%endif<br /><br />I did not test this, but I suppose that must work. I saw something seemed to this in the<br />nguga _ADDR macro.<br /><br />I wait that this can help you<br /><br />&gt; Is there a (documented or not) way of setting page permissions from kernel mode?<br /><br />Sorry. I'm curious. Do you search some kernel mode function to set page permissions, <br />something like the win32 user mode VirtualProtextEx?<br /><br />------<br />nmt</div>
    <div class="meta">Posted on 2004-01-23 00:18:09 by n u M I T_o r</div>
   </div>
   <div class="post" id="post-131409">
    <div class="subject"><a href="#post-131409">nasm, user/supervisor, ...</a></div>
    <div class="body">hgb, that was a lot of text - that didn't help at all :)<br />I'm not interesting in various &quot;invoke&quot; macros for nasm, I already know how to do that.<br />I need something like masm's exitm, so I can do generic stuff.<br />Guess I might just skip nasm and go fasm, if that can't do what I want... well ;)<br />Besides, &quot;jmp skip_data&quot; is such a silly thing to do.<br /><br /><div class="quote"><br />Sorry. I'm curious. Do you search some kernel mode function to set page permissions, <br />something like the win32 user mode VirtualProtextEx?<br /></div><br />Sortof. Such an API actually exists in kernelmode, however as far as I can see, it only does the same protection flags as VirtualProtect... ie, the read/write/execute stuff (execute of course not being supported on x86). What I need, as stated before, is a way to toggle the user/supervisor bit.</div>
    <div class="meta">Posted on 2004-01-23 00:45:31 by f0dder</div>
   </div>
   <div class="post" id="post-131413">
    <div class="subject"><a href="#post-131413">nasm, user/supervisor, ...</a></div>
    <div class="body">hehe, I know that...  was much :D<br /><br />There only exist %exitrep that break the actual %rep block. There no exist a directive for exit the actual macro... I will question for that.....  :D, if you whant in the times that that directive is not handled, then you will try handle in other way how you get out of the macro... (that will require some %if and such...).<br /><br />What you refer to generic stuff... also I will like to know for see if cn be handled or not.<br /><br /><br />The definitions that you do in the macro, are accesible after you execute, In that way there is not necesity of return nothing.<br /><br />have a nice day or night.</div>
    <div class="meta">Posted on 2004-01-23 01:51:35 by rea</div>
   </div>
   <div class="post" id="post-131414">
    <div class="subject"><a href="#post-131414">nasm, user/supervisor, ...</a></div>
    <div class="body">Taking a stab at the second question, others may have a better handle on this, but I think unless you're mapping your own pages as an MDL, where you can specify the access mode as either KernelMode or UserMode, you're stuck modifying the U/S bit of the PDE/PTE arrays directly (a la icedump PAGEFLAG). I'm not exactly sure that the MDL AccessMode setting actually modifies the U/S bit, but there may be a way to tell...<br /><br />In reading Sven Schrieber's Exploring Windows 2000 Memory sample chapter, you may have seen it online here:<br /><br /><a target="_blank" href="http://www.informit.com/isapi/product_id~%7B6D5ACA10-5AB0-4627-81E5-65B9F6E080AC%7D/st~%7B6EB673C6-2B46-498B-A653-803F5FC3AA6E%7D/content/index.asp">http://www.informit.com/isapi/product_id~%7B6D5ACA10-5AB0-4627-81E5-65B9F6E080AC%7D/st~%7B6EB673C6-2B46-498B-A653-803F5FC3AA6E%7D/content/index.asp</a><br /><br />He discusses how the memory manager API functions MmGetPhysicalAddress and MmIsAddressValid access the PDE and PTE arrays, the base addresses are defined as constants (beginning at linear address 0xC0000000) and appear as &quot;magic numbers&quot; within the functions.  I haven't seen any other reference to accessing these arrays (in)directly in any of my driver references.<br /><br />The other interesting thing he discusses is Watching PTEs Change Their States using his w2k_mem utility. For example, by viewing the output he could tell that 4 PTEs found at a certain address, part of the image of win32k.sys, had been swapped out because their P bit indicated a nonpresent page.  <br /><br />I mention this simply because one might be able to check the U/S bit of a selected PTE in a similar way. (I'm thinking here of confirming if the MDL AccessMode is directly tied to the U/S bit).<br /><br /><br />EDIT: Re the whole MDL business, this is a good example I've made use of, also demonstrated by Four-F in one of his untranslated driver tuts.<br /><br /><a target="_blank" href="http://www.osr.com/ntinsider/2000/sharing_memory.htm">http://www.osr.com/ntinsider/2000/sharing_memory.htm</a><br />Sharing Memory Between Drivers and Applications</div>
    <div class="meta">Posted on 2004-01-23 02:39:31 by Kayaker</div>
   </div>
   <div class="post" id="post-131415">
    <div class="subject"><a href="#post-131415">nasm, user/supervisor, ...</a></div>
    <div class="body">'Undocumented Windows NT' also seems to have some info about accessing the PTE to display page flags (and even some source code) .. dunno if it's obsolete by now .. anyway, check out page 6 of<br /><br /><a target="_blank" href="http://www.windowsitlibrary.com/Content/356/04/6.html">http://www.windowsitlibrary.com/Content/356/04/6.html</a></div>
    <div class="meta">Posted on 2004-01-23 03:07:29 by Jibz</div>
   </div>
   <div class="post" id="post-131420">
    <div class="subject"><a href="#post-131420">nasm, user/supervisor, ...</a></div>
    <div class="body">I don't need to &quot;break out&quot; of the macro (though if that facility is not there - lame). I need to *return* a value from the macro.<br /><br /><div class="quote"><br />The definitions that you do in the macro, are accesible after you execute, In that way there is not necesity of return nothing.<br /></div><br />Yes, but that's just not good enough for me. I cannot do statements like &quot;dd macro(&quot;blah&quot;)&quot;, I would have to do &quot;macro(&quot;blah&quot;)&quot;, followed by &quot;dd symbol_left_from_macro&quot;. This also means you wouldn't be able to use the macro directly multiple times in a invoke/call macro... nasm's macro feature seems to be pretty limited, after all.<br /><br />Kayaker, Jibz - thanks. I'll have a look.<br />The business of changing the PTEs directly isn't that bad in itself... make a lin-&gt;phys mapping for CR3 (etc), modify the PTEs necessary. Big deal. What I'm worried about is that these PTEs might be reconstructed from MDLs, and thus have the U/S bit reset? If I use one of the kernel-mode memory allocs calls, is there a call to get to the associated MDLs?<br /><br />I guess I'll have to do some more reading, tracing, and disassembly... and play around ;)</div>
    <div class="meta">Posted on 2004-01-23 05:28:39 by f0dder</div>
   </div>
   <div class="post" id="post-131434">
    <div class="subject"><a href="#post-131434">Fodder's a turncoat...lol</a></div>
    <div class="body">NASM now is it?<br /><br />As far as I know the U/S bit (bit 2 of a PDE) is used in conjunction with the WP bit of CR0 to deny access of CPL0 to user mode pages. Here's something to play with:      <br /><br />      mov     ecx,eax<br />      shr     eax,16h               ; Page Dir Index, PDI<br />      shl     eax,2                 ; size of PDE = PDE offset<br />      mov     eax,   ; Page Dir Base + PDE offset<br />      test    eax,1<br />      jz      $+043h                ; if then mask PTE valid<br />      test    eax,80h<br />      jnz     $+01ah<br />      mov     eax,ecx<br />      shr     eax,0Ah<br />      and     eax,3FFFFCh           ; mask pte page frame number<br />      add     eax,0C0000000h        ; add Page Table Base       <br />      mov     eax,             ; get PTE<br />      test    eax,1<br />      jz      $+011h                ; if 4MB page<br />      and     eax,0FFFFF000h        ; Mask Page Frame Number<br />      and     ecx,0FFFh<br />      add     eax,ecx               ; add byte offset to physical address<br />      jmp     $+017h<br />      xor     eax,eax<br />      jmp     $+13h<br />      and     eax,0FFC00000h<br />      and     ecx,3FFFFFh<br />      add     eax,ecx<br />      jmp     $+04h<br />      xor     eax,eax<br /><br />That will help you find the PDE you are looking for. It's a disassembly of &quot;GetPhysicalAddress&quot;. Here's a break down of it you may find useful:<br /><br /><br />pagestuff:<br /><br />        push ds<br />        mov ds,GlobalSel<br /><br />        mov eax,GDTbase<br />        add eax,050h                ; &quot;TSS&quot; offset location in GDT<br />        mov esi,eax<br />        call DescriptorAddress<br />        mov esi,eax        <br />        mov edi,markaddr<br />        add edi,0100h    <br />        mov eax,dword ptr   ; offset &quot;PDBR in TSS<br />        <br />        mov eax,0967ba000h            ; &quot;Logical ADDRESS&quot;<br />        ;call PageLookUp<br />        ;jmp point<br /><br />        mov ecx,eax<br />        ;and eax,0FFFFF000h<br />        shr eax,16h <br />        shl eax,2 <br />        sub eax,03FD00000h <br /><br />        mov eax,dword ptr    ;*remove this and unhide point for entry addr*<br />        ;jmp point                ;**********<br /><br />        test eax,01h<br />        jnz $+09h<br />        mov eax,0FFFFFFFFh        ; Use FF's to indicate not present<br />        jmp point<br />        test eax,080h<br />        jnz FourMPage<br /><br />FourKPage:<br />        mov eax,ecx<br />        shr eax,0Ah<br />        and eax,3FFFFCh           ; mask pte page frame number<br />        sub eax,040000000h        ; (add C0000000) add Page Table Base     <br />        mov eax,            ; get PTE<br />        ;jmp point<br />        test eax,01h<br />        jnz $+09<br />        mov eax,0FFFFFFFFh        ; Use FF's to indicate not present<br />        jmp point<br /><br />FourMPage:<br />        and eax,0FFFFF000h        ; Mask Page Frame Number<br />        and ecx,0FFFh<br />        add eax,ecx         <br />        <br />point:<br />        mov dword ptr ,eax<br />        pop ds<br />        jmp restorePF<br />dump:<br />        mov esi,eax<br />        push es                         <br />        push ds<br />        pop es<br />        mov ecx,0400h<br />        cld<br />        rep movsd                         ;dump stack contents  <br />        pop es<br />        pop ds<br />        jmp restorePF<br /><br />DumpPageDir:<br /><br />        push ds<br />        mov ds,GlobalSel<br />        mov eax,0c0300000h<br />        add eax,0000h                   ;offset<br />        mov edi,markaddr<br />        add edi,0100h<br />        mov esi,eax<br />        push es                         <br />        push ds<br />        pop es<br />        mov ecx,0400h<br />        cld<br />        rep movsd  <br />        pop es<br />        pop ds<br />        jmp restorePF</div>
    <div class="meta">Posted on 2004-01-23 10:35:45 by mrgone</div>
   </div>
   <div class="post" id="post-131435">
    <div class="subject"><a href="#post-131435">nasm, user/supervisor, ...</a></div>
    <div class="body">Turncoat? Like, why? For using nasm for projects where it fits? Anyway, guess I'll stop using nasm and go fasm from now on, if it has the macro features I need (which I have a strong suspicion it does).<br /><br />Thanks for trying to help, but... I don't really have a problem in dealing with page tables manually - I'd just rather avoid if if there's kernel routines to do what I want, for various reasons. The code's pretty ugly btw ^_^<br /><br /><div class="quote"><br />As far as I know the U/S bit (bit 2 of a PDE) is used in conjunction with the WP bit of CR0 to deny access of CPL0 to user mode pages.<br /></div><br />Rather, I would say that the WP bit is used to deny R0 code write access to user pages that are marked as read-only. With the WP bit clear, R0 code can write to read-only user pages without causing an exception, which is of course not good in a system that requires Copy-On-Write.<br /><br />Anyway, I'll have a go at writing some driver test code either tonight, or tomorrow.</div>
    <div class="meta">Posted on 2004-01-23 10:52:13 by f0dder</div>
   </div>
   <div class="post" id="post-131438">
    <div class="subject"><a href="#post-131438">I use MASM</a></div>
    <div class="body">Hutch's is best!</div>
    <div class="meta">Posted on 2004-01-23 11:15:40 by mrgone</div>
   </div>
   <div class="post" id="post-131440">
    <div class="subject"><a href="#post-131440">nasm, user/supervisor, ...</a></div>
    <div class="body">MASM is okay for writing high-level assembly code... but that where I'd use a high-level language instead. It's nowhere as flexible as, say, fasm - and lacks things like direct binary output.<br /><br />Besides, MASM is not Hutches, he just threw together masm + some crappy powerbasic stuff + a bunch of other peoples work and called it MASM32. That's great and all, and there's some work in maintaining it, but... heh.</div>
    <div class="meta">Posted on 2004-01-23 11:26:37 by f0dder</div>
   </div>
   <div class="post" id="post-131576">
    <div class="subject"><a href="#post-131576">nasm, user/supervisor, ...</a></div>
    <div class="body">I not think is lame, only was not used for us ..... hehe, I supose was a miss there ;), also I think some like that can be easy implemented??.. because I read some bug reports, and find one that in anterior versions exitrep will break all the reps.. even nexted... also we can take this anterior 'fail' and only exit the macro, then take the expression in case of one and insert the toker in that place...<br /><br /><br />;) Have a nice day or night.</div>
    <div class="meta">Posted on 2004-01-25 00:48:23 by rea</div>
   </div>
   <div class="post" id="post-131589">
    <div class="subject"><a href="#post-131589">nasm, user/supervisor, ...</a></div>
    <div class="body">hmmmm,<br /><div class="quote"><br />Besides, MASM is not Hutches, he just threw together masm + some crappy powerbasic stuff + a bunch of other peoples work and called it MASM32. That's great and all, and there's some work in maintaining it, but... heh.<br /></div><br />I know you haven't got much talent in the basic area so I suggest that this wisecrack is just a tinge of bitchyness for being a little off the pace. :tongue: <br /><br />Now as you don't seem to be able to manage much in the line of assembler yourself and need to use a C++ compiler as a crutch, perhaps you need to learn the old lesson that people in glass houses should not throw stones. :grin: <br /><br />Regards,<br />http://www.asmcommunity.net/board/cryptmail.php?tauntspiders=in.your.face@nomail.for.you&amp;id=2f46ed9f24413347f14439b64bdc03fd</div>
    <div class="meta">Posted on 2004-01-25 05:50:23 by hutch--</div>
   </div>
   <div class="post" id="post-131593">
    <div class="subject"><a href="#post-131593">nasm, user/supervisor, ...</a></div>
    <div class="body">I like MASM a lot, and I never found it a problem that it doesn't have binary output. I just wrote a tool that can extract the .text section from a PE file, so I get the binary code that way (ofcourse it also works on binaries generated with C/C++ or other languages :)).<br />And I still get all the low- and highlevel features that MASM offers, which I fail to find in any other assemblers.<br /><br />Anyway, just my 2 cents, perhaps you would like to write such a tool aswell, or use mine.</div>
    <div class="meta">Posted on 2004-01-25 06:01:25 by Henk-Jan</div>
   </div>
   <div class="post" id="post-131598">
    <div class="subject"><a href="#post-131598">nasm, user/supervisor, ...</a></div>
    <div class="body"><div class="quote"><br />Anyway, just my 2 cents, perhaps you would like to write such a tool aswell, or use mine.<br /></div><br />In situations where I want binary output, I prefer what nasm/fasm can give me, it offers a bit more control. Furthermore, fasm is able to do something I never really succeeded in doing with masm - *really* putting everything in one section, and having 100% control over the order of things. This was quite important when doing the stub for my exe packer/krypter.<br /><br />For more advanced stuff, I made a tool for converting PE files into my own format... relocations, imports, everything. This works quite well, and lets me write the &quot;level2&quot; code of my packer/krypter in just about any language I want.</div>
    <div class="meta">Posted on 2004-01-25 06:20:05 by f0dder</div>
   </div>
   <div class="post" id="post-131601">
    <div class="subject"><a href="#post-131601">nasm, user/supervisor, ...</a></div>
    <div class="body"><div class="quote">In situations where I want binary output, I prefer what nasm/fasm can give me, it offers a bit more control.</div><br /><br />Well I haven't used nasm much, and not used fasm at all, so I'm not sure what extra control they can give. All I can say is that I never found MASM lacking the control I need.<br /><br /><div class="quote">Furthermore, fasm is able to do something I never really succeeded in doing with masm - *really* putting everything in one section, and having 100% control over the order of things.</div><br /><br />What do you mean by that exactly? If you put everything in the .code section in MASM, you get it where it's supposed to be, right?</div>
    <div class="meta">Posted on 2004-01-25 06:23:28 by Henk-Jan</div>
   </div>
   <div class="post" id="post-131602">
    <div class="subject"><a href="#post-131602">nasm, user/supervisor, ...</a></div>
    <div class="body"><div class="quote"><br />What do you mean by that exactly? If you put everything in the .code section in MASM, you get it where it's supposed to be, right?<br /></div><br />Not exactly - try putting your imports in the code section... it's possible to do this with /MERGE, but with /MERGE you don't have any control over the section ordering.</div>
    <div class="meta">Posted on 2004-01-25 06:27:11 by f0dder</div>
   </div>
   <div class="post" id="post-131604">
    <div class="subject"><a href="#post-131604">nasm, user/supervisor, ...</a></div>
    <div class="body">/MERGE is a linker option though, not a MASM option. So the issue is slightly different I guess. I thought you were talking about the assembler only, and dumping raw code... But you want to dump PE code. I guess in that case, you would need to look at a linker in the case of MASM. Or... build the entire binary image manually... or use some macros that can take care of the jobs that the linker does, and put the stuff in the binary the way you want it :)<br /><br />Anyway, whatever works for you, I suppose.</div>
    <div class="meta">Posted on 2004-01-25 06:39:07 by Henk-Jan</div>
   </div>
   <div class="post" id="post-131605">
    <div class="subject"><a href="#post-131605">nasm, user/supervisor, ...</a></div>
    <div class="body"><div class="quote"><br />Anyway, whatever works for you, I suppose.<br /></div><br />Exactly. Fasm does this job like a charm, without me having to write my own linker, or building a PE by hand with masm code and dumping that. And when doing direct binary output, I still prefer fasm/nasm - since there's no &quot;ripcode&quot; additional step.</div>
    <div class="meta">Posted on 2004-01-25 06:44:29 by f0dder</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=16939&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=16939&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="16939" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=16939&amp;page=2">&gt;</a><a href="../?id=16939&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>