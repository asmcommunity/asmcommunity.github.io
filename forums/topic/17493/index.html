<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Taking screeshot and save it - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17493" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=17493">Taking screeshot and save it</a></p>
   <div class="post" id="post-135368">
    <div class="subject"><a href="#post-135368">Taking screeshot and save it</a></div>
    <div class="body">Hello<br /><br />All day i have beein searching for some code to take a screenshot of everything of the screen and save it to like C:\Pictures.<br />I should save it as .BMP.<br /><br />actully i want to save alot of pictures in just a short time<br />pic001.bmp<br />pic002.bmp<br />pic003.bmp<br />etc etc<br />but how to do that i probably solve by my self ;)</div>
    <div class="meta">Posted on 2004-03-08 10:59:42 by bj1500</div>
   </div>
   <div class="post" id="post-135377">
    <div class="subject"><a href="#post-135377">Taking screeshot and save it</a></div>
    <div class="body">I don't have the exact steps to do this.<br /><br />So this is me taking a shot in the dark....<br /><br />I would call GetDesktopWindow() to get the HANDLE to the desktop.<br /><br />Then, GetDC() would get me the handle to the DeviceContext.<br /><br />Using that I think it is possible to create another DC that is compatible with your desktop, so basically making another bitmap that is the same size ... that is CreateCompatibleDC.<br /><br />I'm kind of stuck here, but you would need to copy the desktop DC to the one you created and then save that out to a bmp ... of course.<br /><br />Be sure to release the DC though.<br /><br />Sorry I wasn't of any more help.</div>
    <div class="meta">Posted on 2004-03-08 13:27:15 by gorshing</div>
   </div>
   <div class="post" id="post-135389">
    <div class="subject"><a href="#post-135389">Taking screeshot and save it</a></div>
    <div class="body">Iczelion has the answer, or at least most of it: see <a target="_blank" href="http://spiff.tripnet.se/~iczelion/files/CapScreen.txt">here</a>.</div>
    <div class="meta">Posted on 2004-03-08 14:41:44 by Frank</div>
   </div>
   <div class="post" id="post-135392">
    <div class="subject"><a href="#post-135392">Taking screeshot and save it</a></div>
    <div class="body">gorshing<br /><br />thanks for trying to help me.<br />and Frank, Thank you <br />it works perfect now.</div>
    <div class="meta">Posted on 2004-03-08 15:15:50 by bj1500</div>
   </div>
   <div class="post" id="post-135484">
    <div class="subject"><a href="#post-135484">Taking screeshot and save it</a></div>
    <div class="body">I have no idea what i'm about to say, but i make a lucky guess :tongue::<br />If you want to take the screenshot manually, i guess you could use the print screen button from the keyboard, and as you know; windows takes a screenshot and saves it to clipboard. Then you can propably access it with GetClipboardData -func, with CF_BITMAP flag.. :confused:</div>
    <div class="meta">Posted on 2004-03-09 11:35:44 by Petroizki</div>
   </div>
   <div class="post" id="post-135495">
    <div class="subject"><a href="#post-135495">Taking screeshot and save it</a></div>
    <div class="body">Looks like I was a little off ;)<br /><br />Oh well ... no harm, no foul<br /><br />:cool:</div>
    <div class="meta">Posted on 2004-03-09 13:16:41 by gorshing</div>
   </div>
  </div>
 </body>
</html>