<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>MessageBox without WinAPI - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12527" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12527">MessageBox without WinAPI</a></p>
   <div class="post" id="post-96928">
    <div class="subject"><a href="#post-96928">MessageBox without WinAPI</a></div>
    <div class="body">Hello,<br /><br />Need a simple code for a PE Loader to make a Messagebox<br />without WinAPI needed.<br /><br />Need only Captiontext, Text and OK Button.<br /><br />Thanks.</div>
    <div class="meta">Posted on 2003-04-15 09:29:10 by Fred</div>
   </div>
   <div class="post" id="post-96941">
    <div class="subject"><a href="#post-96941">MessageBox without WinAPI</a></div>
    <div class="body">Have a look at this.<br /><br /><a target="_blank" href="http://www.programmingjournal.com/issue4/art3/">http://www.programmingjournal.com/issue4/art3/</a><br /><br />Get the address of LoadLibrary and GetProcAddress and then use them to load user32.dll and to get the address of MessageBox.</div>
    <div class="meta">Posted on 2003-04-15 10:03:24 by roticv</div>
   </div>
   <div class="post" id="post-96942">
    <div class="subject"><a href="#post-96942">MessageBox without WinAPI</a></div>
    <div class="body">there's no way to do it without _any_ windows API.<br />The way roticv is hinting is reasonable. Find kernel32 (grab a kernel32 proc addr from the IAT and backscan - be sure to do this in a SEH, and backscan by 4k, and be sure that you pick an import that is _NOT_ forwarded to another DLL)).<br /><br />If you write your own GetProcAddress, you also need to handle ordinals and forwarded exports. Iirc, rheingolds code handle neither.</div>
    <div class="meta">Posted on 2003-04-15 10:07:24 by f0dder</div>
   </div>
   <div class="post" id="post-96984">
    <div class="subject"><a href="#post-96984">Re: MessageBox without WinAPI</a></div>
    <div class="body"><div class="quote"><br />Hello,<br /><br />Need a simple code for a PE Loader to make a Messagebox<br />without WinAPI needed.<br /><br />Need only Captiontext, Text and OK Button.<br /><br />Thanks. </div><br /><br />I remember that you or someone else already asked it before.<br /><br />BTW, wrong forum, moved from MASM32.<br /><br /><br />EDIT:<br /><br />Yep, you already asked:<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=9373">http://www.asmcommunity.net/board/index.php?topic=9373</a><br /><br />And comrade attached a solution on this thread. Wonder why you ask again...</div>
    <div class="meta">Posted on 2003-04-15 11:54:32 by bazik</div>
   </div>
   <div class="post" id="post-96989">
    <div class="subject"><a href="#post-96989">MessageBox without WinAPI</a></div>
    <div class="body">because he's dull? ^_^</div>
    <div class="meta">Posted on 2003-04-15 12:03:10 by f0dder</div>
   </div>
  </div>
 </body>
</html>