<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>detecting desktop activity - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21208" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21208">detecting desktop activity</a></p>
   <div class="post" id="post-160514">
    <div class="subject"><a href="#post-160514">detecting desktop activity</a></div>
    <div class="body">my jabber client can detect when i haven&#39;t moved my mouse or pressed a key on the keyboard for a while.&nbsp; is there an easier way to keep track of that than resorting to hooks.&nbsp; i&#39;m just not a fan of system hooks and i guess i would have to use the CBT hook for that.&nbsp; is there a less intrusive way to do that?</div>
    <div class="meta">Posted on 2005-05-27 07:59:06 by rdaneel</div>
   </div>
   <div class="post" id="post-160521">
    <div class="subject"><a href="#post-160521">Re: detecting desktop activity</a></div>
    <div class="body">You could use low-level mouse and keyboard system hooks, they use less resources but work only on NT, XP and 2K.</div>
    <div class="meta">Posted on 2005-05-27 17:52:54 by QvasiModo</div>
   </div>
   <div class="post" id="post-160525">
    <div class="subject"><a href="#post-160525">Re: detecting desktop activity</a></div>
    <div class="body">rdaneel, have a look if the jabber client works in non-admin mode... if it does, there&#39;s probably another way :) (jabber is opensource, right? you could ask the developers how they do it, and post back here).<br /></div>
    <div class="meta">Posted on 2005-05-27 19:45:15 by f0dder</div>
   </div>
   <div class="post" id="post-179501">
    <div class="subject"><a href="#post-179501">Re: detecting desktop activity</a></div>
    <div class="body">Yeah, it uses normal windows hooks.&nbsp; At least the client I use does.&nbsp; I ended up using the new GetLastInputInfo api call in Win2K+ since we only use XP.<br /><br />Dave</div>
    <div class="meta">Posted on 2006-04-12 20:28:09 by rdaneel</div>
   </div>
   <div class="post" id="post-179893">
    <div class="subject"><a href="#post-179893">Re: detecting desktop activity</a></div>
    <div class="body">Ideas:<br /><br />1- check out WH_FOREGROUNDIDLE hook.<br />2- check out the SC_SCREENSAVE notification :)<br /></div>
    <div class="meta">Posted on 2006-04-20 01:26:35 by Homer</div>
   </div>
   <div class="post" id="post-184539">
    <div class="subject"><a href="#post-184539">Re: detecting desktop activity</a></div>
    <div class="body">You could also use GetCursorPos and GetKeyboardState apis monitoring for difference&#39;s to the previous state.<br />While this would remove the dependency on hooks I&#39;m not sure if it would be less taxing on the system.<br /> :sad:</div>
    <div class="meta">Posted on 2006-08-17 08:59:38 by asmrixstar</div>
   </div>
  </div>
 </body>
</html>