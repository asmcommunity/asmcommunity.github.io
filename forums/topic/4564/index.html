<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Binary Trees - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4564" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=4564">Binary Trees</a></p>
   <div class="post" id="post-31921">
    <div class="subject"><a href="#post-31921">Binary Trees</a></div>
    <div class="body">Here's some snippets on creating the barebones of a binary tree using ASM. I know that there are a lot of optimizations that should be done and topics like deleting from a tree, that should be included here but since I have a lot of things to do, I'll leave it up to those who will use it. If I can find a time, I'll release some examples, together with the updated linked list project.<br /><br /><strong>CurNode == rootNode</strong><pre><code>&#91;size=9&#93;<br />PrefixPrint PROC CurNode&#58;DWORD<br />                       <br />    mov     eax, CurNode<br />    or      eax, eax<br />    jnz     @F<br />    ret<br />    <br />    @@&#58;<br />    <br />        push    eax<br />        invoke  dwtoa, &#40;BINTREE PTR&#91;eax&#93;&#41;.ID, OFFSET tmpBufr<br />        invoke  SendDlgItemMessage, wHndle, IDE_BINTREEOUTPUT, EM_REPLACESEL, NULL, OFFSET Newline<br />        invoke  SendDlgItemMessage, wHndle, IDE_BINTREEOUTPUT, EM_REPLACESEL, NULL, OFFSET tmpBufr<br />        pop     eax<br />        push    eax<br />        mov     eax, &#40;BINTREE PTR&#91;eax&#93;&#41;.ptLeft<br />        invoke  PrefixPrint, eax<br />        pop     eax<br />        mov     eax, &#40;BINTREE PTR&#91;eax&#93;&#41;.ptRight<br />        invoke  PrefixPrint, eax<br />        <br />    ret<br />     <br />PrefixPrint ENDP<br />&#91;/size&#93;</code></pre><br /><strong>IDValue == id/key of the structure</strong><br /><pre><code>&#91;size=9&#93;<br />CreateNode PROC IDValue&#58;DWORD<br /><br />    invoke  GetProcessHeap<br />    mov     hPrcs, eax<br />    invoke  HeapAlloc, eax, HEAP_ZERO_MEMORY, SIZEOF BINTREE<br />    mov     hMem, eax<br />    <br />    mov     edx, IDValue<br />    mov     &#40;BINTREE PTR &#91;eax&#93;&#41;.ID, edx<br />    mov     &#40;BINTREE PTR &#91;eax&#93;&#41;.ptLeft, NULL<br />    mov     &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight, NULL<br />    <br />    ret<br /><br />CreateNode ENDP<br />&#91;/size&#93;</code></pre><strong>CurNode == rootNode<br />IDValue == id/key of the structure</strong><pre><code>&#91;size=9&#93;<br />FindASpot PROC CurNode&#58;DWORD, IDValue&#58;DWORD<br /><br />    mov     eax, CurNode<br />    or      eax, eax<br />    jnz     @@NodeNotNull<br />    ret<br />    <br />    @@NodeNotNull&#58;<br />    <br />        mov     edx, IDValue<br />        push    eax<br />        push    edx<br />    <br />        cmp     edx, &#40;BINTREE PTR &#91;eax&#93;&#41;.ID<br />        jl      @@GoLeft<br />        ja      @@GoRight<br />        <br />        invoke  MessageBox, NULL, OFFSET BinTreeError, OFFSET BinTreeTitle, MB_OK<br />        pop     edx<br />        pop     eax<br />        ret<br />        <br />        @@GoLeft&#58;<br />        <br />            cmp     &#40;BINTREE PTR &#91;eax&#93;&#41;.ptLeft, NULL<br />            jne     @@RecurseOnLeft<br />            <br />                push    eax<br />                invoke  CreateNode, edx<br />                pop     ecx<br />                mov     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptLeft, eax<br />                jmp     @@FoundASpot<br />            <br />            @@RecurseOnLeft&#58;<br />            <br />                mov     eax, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptLeft<br />                invoke  FindASpot, eax, edx<br />                jmp     @@FoundASpot<br />            <br />        @@GoRight&#58;<br />        <br />            cmp     &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight, NULL<br />            jne     @@RecurseOnRight<br />            <br />                push    eax<br />                invoke  CreateNode, edx<br />                pop     ecx<br />                mov     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptRight, eax<br />                jmp     @@FoundASpot<br />            <br />            @@RecurseOnRight&#58;<br />            <br />                mov     eax, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight<br />                invoke  FindASpot, eax, edx<br />                <br />        @@FoundASpot&#58;<br />        <br />            pop     edx<br />            pop     eax<br /><br />            ret<br /><br />FindASpot ENDP<br />&#91;/size&#93;</code></pre><strong>nNode == rootNode</strong><pre><code>&#91;size=9&#93;<br />DestroyTree PROC nNode&#58;DWORD<br /><br />    mov     eax, nNode<br />    or      eax, eax<br />    jnz     @F<br />    ret<br />    <br />    @@&#58;<br />    <br />        push    eax<br />        mov     eax, &#40;BINTREE PTR&#91;eax&#93;&#41;.ptLeft<br />        invoke  DestroyTree, eax<br />        pop     eax<br />        push    eax<br />        mov     eax, &#40;BINTREE PTR&#91;eax&#93;&#41;.ptRight<br />        invoke  DestroyTree, eax<br />        pop     eax<br />        invoke  HeapFree, hPrcs, NULL, eax<br />        <br />    ret<br /><br />DestroyTree ENDP<br />&#91;/size&#93;</code></pre>The use of the Win32 API and the structure fields should be <strong>self explanatory</strong>. If you have questions tell me.<br /><br />BTW, bitRAKE`s gonna love this because it has a lot of <strong>recursion</strong> :grin:<br /><br />Have Fun!!! :grin:</div>
    <div class="meta">Posted on 2002-04-01 00:36:41 by stryker</div>
   </div>
   <div class="post" id="post-31982">
    <div class="subject"><a href="#post-31982">Do you have a download on this Tree</a></div>
    <div class="body">Hi Stryker<br /><br />Can you send the whole program?, Then I can disect and maybe figure it out, THis is funny I just came back from my Data Structures class in C++, and binary trees was the lecture, and I have to write a Binary Tree program in C++ too<br />Wow!<br /><br />Andy</div>
    <div class="meta">Posted on 2002-04-01 10:56:22 by andy981</div>
   </div>
   <div class="post" id="post-31993">
    <div class="subject"><a href="#post-31993">Binary Trees</a></div>
    <div class="body">I would love to release the source but the problem is, this is also my homework :) My professor knows this board and I don't want to ... I'll just post a part of the whole code on how to do it. This should suffice your question but not totally.<pre><code>&#91;size=9&#93;<br />            @@BTN_ADDTOBTREE&#58;<br />        <br />            invoke  GetDlgItemInt, hWnd, IDE_INTOBTREE, OFFSET bState, FALSE<br />            <br />            cmp     rootNode, NULL<br />            jne     @@rootExists<br />            <br />                invoke  CreateNode, eax<br />                mov     rootNode, eax<br />                jmp     @@PRINTCURRENTBINTREE<br />            <br />            @@rootExists&#58;<br />            <br />                invoke  FindASpot, rootNode, eax<br />                <br />            @@PRINTCURRENTBINTREE&#58;<br />            <br />                invoke  SetDlgItemText, hWnd, IDE_BINTREEOUTPUT, NULL<br />                invoke  PrefixPrint, rootNode<br />                jmp     @@RETURN_TRUE&#91;/size&#93;</code></pre>Assuming we clicked a button called AddToTree...<br />1. First we get the key/id number of the node from an edit box.<br />2. We then check if a root node exists,<br /><br />if not we will call CreateNode, the return value will be the pointer in memory that was allocated.<br /><br />if it exists we will call the FindASpot procedure, what this does is it will recurse until it finds the right spot to place the leaf node.<br /><br />3. Then print the current members of the current tree.<br /><br /><br />I forgot to add these 2 things on how to print the tree. :)<pre><code>&#91;size=9&#93;<br />InfixPrint PROC CurNode&#58;DWORD<br /><br />    mov     eax, CurNode<br />    or      eax, eax<br />    jnz     @F<br />    ret<br />    <br />    @@&#58;<br />    <br />        push    eax<br />        mov     eax, &#40;BINTREE PTR&#91;eax&#93;&#41;.ptLeft<br />        invoke  InfixPrint, eax<br />        pop     eax<br />        push    eax<br />        invoke  dwtoa, &#40;BINTREE PTR&#91;eax&#93;&#41;.ID, OFFSET tmpBufr<br />        invoke  SendDlgItemMessage, wHndle, IDE_BINTREEOUTPUT, EM_REPLACESEL, NULL, OFFSET Newline<br />        invoke  SendDlgItemMessage, wHndle, IDE_BINTREEOUTPUT, EM_REPLACESEL, NULL, OFFSET tmpBufr<br />        pop     eax<br />        mov     eax, &#40;BINTREE PTR&#91;eax&#93;&#41;.ptRight<br />        invoke  InfixPrint, eax<br />        <br />    ret<br /><br />InfixPrint ENDP<br /><br />PostfixPrint PROC CurNode&#58;DWORD<br />                       <br />    mov     eax, CurNode<br />    or      eax, eax<br />    jnz     @F<br />    ret<br />    <br />    @@&#58;<br />    <br />        push    eax<br />        mov     eax, &#40;BINTREE PTR&#91;eax&#93;&#41;.ptLeft<br />        invoke  PostfixPrint, eax<br />        pop     eax<br />        push    eax<br />        mov     eax, &#40;BINTREE PTR&#91;eax&#93;&#41;.ptRight<br />        invoke  PostfixPrint, eax<br />        <br />        pop     eax<br />        invoke  dwtoa, &#40;BINTREE PTR&#91;eax&#93;&#41;.ID, OFFSET tmpBufr<br />        invoke  SendDlgItemMessage, wHndle, IDE_BINTREEOUTPUT, EM_REPLACESEL, NULL, OFFSET Newline<br />        invoke  SendDlgItemMessage, wHndle, IDE_BINTREEOUTPUT, EM_REPLACESEL, NULL, OFFSET tmpBufr<br />        <br />    ret<br />     <br />PostfixPrint ENDP&#91;/size&#93;</code></pre>If spring semester is over I'll release the whole source. ;) Here are the structures and &quot;variables&quot; I used <pre><code>&#91;size=9&#93;<br />_DATA SEGMENT<br />    Newline                 DB 0Dh, 0Ah, 0<br />    BinTreeTitle            DB &quot;stryker&quot;, 0<br />    BinTreeError            DB &quot;Cannot Add To The Tree. Current&quot;, 0Dh, 0Ah<br />                            DB &quot;ID Value Already Exists On The Tree.&quot;, 0<br />_DATA ENDS<br /><br />_BSS SEGMENT<br />    tmpBufr                 DB 9 DUP&#40;?&#41;<br />    bState                  DD ?<br />    hPrcs                   DD ?<br />    hMem                    DD ?<br />    rootNode                DD ?<br />    wHndle                  DD ?<br />_BSS ENDS<br /><br />BINTREE STRUCT<br />    ID          DD ?<br />    ptLeft      DD ?<br />    ptRight     DD ?<br />BINTREE ENDS<br />&#91;/size&#93;</code></pre></div>
    <div class="meta">Posted on 2002-04-01 12:07:23 by stryker</div>
   </div>
   <div class="post" id="post-32014">
    <div class="subject"><a href="#post-32014">Binary Trees</a></div>
    <div class="body"><div class="quote"><em>Originally posted by stryker </em><br />I would love to release the source but the problem is, this is also my homework :) My professor knows this board and I don't want to ... </div><br /><br />Why don't you just copyright your work with your real name...<br />Since the day of posting is also shown on the board it will validate your claim that this is your material...<br /><br />For me... Code snippets are nice (for proof of concept), but don't really help when I'm just learning about a topic...<br /><br />I do understand your concern and will just have to wait till you leave school for this program :)<br /><br />Sliver</div>
    <div class="meta">Posted on 2002-04-01 13:22:27 by Sliver</div>
   </div>
   <div class="post" id="post-32235">
    <div class="subject"><a href="#post-32235">Binary Trees</a></div>
    <div class="body">Here's another one on <strong>searching for a node in the tree</strong><pre><code>&#91;size=9&#93;<br />BSearch PROC nNode&#58;DWORD, IDValue&#58;DWORD<br /><br />    mov     eax, nNode<br />    mov     edx, IDValue<br /><br />    @@SwingNode&#58;<br /><br />        cmp     eax, NULL<br />        je      @@BSearchExit<br /><br />        cmp     edx, &#40;BINTREE PTR &#91;eax&#93;&#41;.ID<br />        jl      @@GoLeft<br />        ja      @@GoRight<br />        ret<br /><br />        @@GoLeft&#58;<br /><br />            mov     eax, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptLeft<br />            jmp     @@SwingNode<br /><br />        @@GoRight&#58;<br /><br />            mov     eax, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight<br />            jmp     @@SwingNode<br /><br />    @@BSearchExit&#58;<br /><br />        xor     eax, eax<br />        ret<br /><br />BSearch ENDP<br />&#91;/size&#93;</code></pre>The return value will be in EAX, if it returns 0 then the key/id doesn't exists, else ...<br /><br />Preliminary call: invoke BSearch, rootNode, IDorKeyToSearch<br /><br /><br />Have Fun!!! :grin:</div>
    <div class="meta">Posted on 2002-04-02 23:49:45 by stryker</div>
   </div>
   <div class="post" id="post-32338">
    <div class="subject"><a href="#post-32338">Binary Trees</a></div>
    <div class="body">Here's another update. This one will <strong>count all the nodes in a tree.</strong><pre><code>&#91;size=9&#93;<br />BCount PROC nNode&#58;DWORD, nCount&#58;DWORD<br /><br />    mov     eax, nCount<br />    mov     ecx, nNode<br />    or      ecx, ecx<br />    jz      @F<br />    inc     eax<br />    push    ecx<br />    mov     ecx, &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptLeft<br />    invoke  BCount, ecx, eax<br />    pop     ecx<br />    mov     ecx, &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptRight<br />    invoke  BCount, ecx, eax<br />    @@&#58;<br />    <br />    ret<br />    <br />BCount ENDP<br />&#91;/size&#93;</code></pre>Return value will be in eax.<br /><br />Preliminary Call: <strong>invoke BCount, rootNode, 0</strong><br /><br /><br />Have Fun!!! :grin:</div>
    <div class="meta">Posted on 2002-04-03 23:10:20 by stryker</div>
   </div>
   <div class="post" id="post-32341">
    <div class="subject"><a href="#post-32341">Binary Trees</a></div>
    <div class="body">I forgot: To those who wants to optimized the procedures, I'll give you a hint: There are redundant codes and too much overkill parameters on the procedures. ;) You can initialize some parts even before a procedure is called.</div>
    <div class="meta">Posted on 2002-04-03 23:43:18 by stryker</div>
   </div>
   <div class="post" id="post-32585">
    <div class="subject"><a href="#post-32585">Binary Trees</a></div>
    <div class="body">Here's another update:<br /><pre><code>&#91;size=9&#93;<br />Max PROC A&#58;DWORD, B&#58;DWORD<br /><br />    mov     eax, A<br />    mov     edx, B<br />    cmp     eax, edx<br />    jb      @F<br />        ret<br />    @@&#58;<br />        mov     eax, edx<br />        ret<br />    <br />Max ENDP<br /><br />BHeight PROC nNode&#58;DWORD<br /><br />    mov     ecx, nNode<br />    or      ecx, ecx<br />    jnz     @F<br />    mov     eax, -1<br />    ret<br />    @@&#58;<br />    <br />        push    ecx<br />        mov     ecx, &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptLeft<br />        invoke  BHeight, ecx<br />        pop     ecx<br />        push    eax<br />        mov     ecx, &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptRight<br />        invoke  BHeight, ecx<br />        pop     edx<br />        inc     eax<br />        inc     edx<br />        invoke  Max, eax, edx<br />        ret<br /><br />BHeight ENDP<br /><br />BLevel PROC nNode&#58;DWORD<br /><br />    mov     ecx, nNode<br />    or      ecx, ecx<br />    jnz     @F<br />    xor     eax, eax<br />    ret<br />    @@&#58;<br />    <br />        push    ecx<br />        mov     ecx, &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptLeft<br />        invoke  BLevel, ecx<br />        pop     ecx<br />        push    eax<br />        mov     ecx, &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptRight<br />        invoke  BLevel, ecx<br />        pop     edx<br />        inc     eax<br />        inc     edx<br />        invoke  Max, eax, edx<br />        ret<br /><br />BLevel ENDP<br />&#91;/size&#93;</code></pre><ul><br />[*]<strong>BHeight</strong> will give you the height of the tree.<br />[*]<strong>BLevel</strong> will give you the level of the tree.<br />[*]Preliminary Call: invoke Function, rootNode<br />[*]Return Value/s : in EAX.<br /><br />Have Fun!!! :grin:</div>
    <div class="meta">Posted on 2002-04-05 23:56:03 by stryker</div>
   </div>
   <div class="post" id="post-32852">
    <div class="subject"><a href="#post-32852">Delete function</a></div>
    <div class="body">Hi Stryker<br /><br />Maybe you can do me a big favor,<br />Sorry for polutting the site with C++<br />but maybe you have done Binary Tree in C++<br />and I can't seem to get a working delete function going<br />here is what Is the worth while part I have<br /><br /><br />int tree::remove(NodePtr tPtr,int key)<br />{<br /><br />int rt_child = 0, lft_child = 0;<br />NodePtr ptr = tPtr, parent = tPtr,dltPtr, S = tPtr, save = tPtr;<br />if (root == NULL)<br />    return 0;<br />else<br />{<br />if (ptr == NULL) <br />return 0;<br />//this is good because it finds the parent<br />while (ptr != NULL &amp;&amp; ptr-&gt;myKey != key) {<br />    parent = ptr;<br />    if (key &lt; ptr-&gt;myKey) ptr = ptr-&gt;left;<br />    else ptr = ptr-&gt;right;<br />}<br /><br />}<br />}<br /><br />Do you have any ideas!</div>
    <div class="meta">Posted on 2002-04-08 22:46:28 by andy981</div>
   </div>
   <div class="post" id="post-32856">
    <div class="subject"><a href="#post-32856">Binary Trees</a></div>
    <div class="body">I have one in C but it's on the other computer at my home. When I get back I'll post the source. :)<br /><br />Since I don't have my tools right now, I'll just give you some ideas on how to work it out.<br /><br />1. First you need to search for the key inside the tree and check if it exists, if it does there are 3 cases you need to consider:<br /><br />Case 1: If the node to be deleted is a leaf, meaning no right and left child, just deallocate it and nullify the pointer of the parent(left or right whichever it points to the deallocated node). You also need to be careful if it's the root node.<br /><br />Case 2: If the node has only one child(either left or right), just update the parent of that node to point to the child of the node deallocated. Meaning if I have a tree like this A-&gt;B-&gt;C and I want to remove B just make A point to C and deallocate B. Again you need to be careful on which pointer(left or right) to update.<br /><br />Case 3: If the node has two children, There are 2 ways to solve it. From the node to be deallocated:<br /><br />1. Find the largest value on the left subtree and pick that value to replace the node to be deallocated then resort to either cases 1 and 2.<br /><br />2. Find the smallest value on the right subtree and pick that value to replace the node to be deallocated then resort to either cases 1 and 2.</div>
    <div class="meta">Posted on 2002-04-08 22:59:28 by stryker</div>
   </div>
   <div class="post" id="post-32857">
    <div class="subject"><a href="#post-32857">Thanks That will really help</a></div>
    <div class="body">I sent a zip of what I already have done<br /><br />It should run and quite easily if you have Visual C++<br /><br />just put in a folder and click the dsw file<br /><br />the function in question is <br /><br />the class function <br /><br />called<br />int tree::remove(NodePtr tPtr,int key)<br /><br /><br />in the implementation file tree.cpp<br /><br />THanks Andy</div>
    <div class="meta">Posted on 2002-04-08 23:30:13 by andy981</div>
   </div>
   <div class="post" id="post-32859">
    <div class="subject"><a href="#post-32859">Binary Trees</a></div>
    <div class="body">Here's my Binary Trees in C. Sorry for the ugly text positions on the console, this was just a testbed. :)</div>
    <div class="meta">Posted on 2002-04-09 00:09:01 by stryker</div>
   </div>
   <div class="post" id="post-32895">
    <div class="subject"><a href="#post-32895">Thanks Thats Cool!</a></div>
    <div class="body">That should help a lot,<br /><br />I'll test it more later today, I'm sure the delete will work,<br /><br />Andy</div>
    <div class="meta">Posted on 2002-04-09 07:10:45 by andy981</div>
   </div>
   <div class="post" id="post-33999">
    <div class="subject"><a href="#post-33999">Binary Trees</a></div>
    <div class="body">Yes, I'm back from my vacation and will go for another one tomorrow. :)<br /><br />Here's the final installment for the binary trees. I don't know if this one works perfectly but I did my best to hunt down the bugs. :)<br /><br />To remove a node from the tree, just pass the <strong>root node</strong> and the <strong>key</strong> of the node to delete and call <strong>BDelete</strong>.<pre><code>&#91;size=9&#93;<br />BRemove PROC nParent&#58;DWORD, nNode&#58;DWORD<br /><br />    mov     ecx, nParent<br />    mov     eax, nNode<br /><br />    cmp     &#40;BINTREE PTR &#91;eax&#93;&#41;.ptLeft, NULL<br />    jne     @@CheckRightNode<br />    cmp     &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight, NULL<br />    jne     @@ChildOnRight<br /><br />    ;Leaf Node<br /><br />    cmp     eax, rootNode<br />    jne     @F<br />    mov     rootNode, 0<br />    jmp     @@DeallocateNode<br />    @@&#58;<br /><br />    cmp     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptLeft, eax<br />    jne     @@NullifyRight<br />    mov     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptLeft, NULL<br />    jmp     @@DeallocateNode<br /><br />    @@NullifyRight&#58;<br /><br />        mov     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptRight, NULL<br />        jmp     @@DeallocateNode<br /><br />    @@CheckRightNode&#58;<br /><br />        cmp     &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight, NULL<br />        jne     @@TwoChildren<br /><br />        ;Child On Left<br /><br />        or      ecx, ecx<br />        jnz     @F<br /><br />            mov     ecx, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptLeft<br />            mov     rootNode, ecx<br />            jmp     @@DeallocateNode<br /><br />        @@&#58;<br /><br />            cmp     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptLeft, eax<br />            je      @@JoinLeft<br /><br />            mov     edx, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptLeft<br />            mov     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptRight, edx<br />            jmp     @@DeallocateNode<br /><br />        @@JoinLeft&#58;<br /><br />            mov     edx, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptLeft<br />            mov     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptLeft, edx<br />            jmp     @@DeallocateNode<br /><br />    @@ChildOnRight&#58;<br /><br />        ;Child On Right<br /><br />        or      ecx, ecx<br />        jnz     @F<br /><br />            mov     ecx, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight<br />            mov     rootNode, ecx<br />            jmp     @@DeallocateNode<br /><br />        @@&#58;<br /><br />            cmp     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptLeft, eax<br />            je      @@JoinRight<br /><br />            mov     edx, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight<br />            mov     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptRight, edx<br />            jmp     @@DeallocateNode<br /><br />        @@JoinRight&#58;<br /><br />            mov     edx, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight<br />            mov     &#40;BINTREE PTR &#91;ecx&#93;&#41;.ptLeft, edx<br />            jmp     @@DeallocateNode<br /><br />    @@TwoChildren&#58;<br /><br />        ;Two Child Nodes<br /><br />        mov     edx, eax<br />        mov     ecx, eax<br />        mov     eax, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptLeft<br /><br />        @@FindTheLargestKey&#58;<br /><br />            cmp     &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight, NULL<br />            je      @@Replace<br />            mov     ecx, eax<br />            mov     eax, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight<br />            jmp     @@FindTheLargestKey<br /><br />        @@Replace&#58;<br /><br />            ;Just copy the contents to its new location<br /><br />            push    &#40;BINTREE PTR &#91;eax&#93;&#41;.pID<br />            pop     &#40;BINTREE PTR &#91;edx&#93;&#41;.pID<br /><br />            ;Process other structure field names.<br /><br />            ;Revert to the 2 cases above. Because the one to replace<br />            ;cannot be and will not have 2 child nodes. The one to replace<br />            ;will either fall into cases 1 and 2 which is either a leaf node<br />            ;or a node with only one child.<br /><br />            invoke  BRemove, ecx, eax<br />            ret<br /><br />    @@DeallocateNode&#58;<br /><br />        invoke  HeapFree, hPrcs, NULL, eax<br />        ret<br /><br />BRemove ENDP<br /><br />BDelete PROC nNode&#58;DWORD, IDValue&#58;DWORD<br /><br />    mov     eax, nNode<br />    mov     edx, IDValue<br /><br />    @@SwingNode&#58;<br /><br />        or      eax, eax<br />        jz      @@BSearchExit<br /><br />        cmp     edx, &#40;BINTREE PTR &#91;eax&#93;&#41;.pID<br />        jl      @@GoLeft<br />        ja      @@GoRight<br /><br />        invoke  BRemove, ecx, eax<br />        ret<br />        @@GoLeft&#58;<br /><br />            mov     ecx, eax<br />            mov     eax, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptLeft<br />            jmp     @@SwingNode<br /><br />        @@GoRight&#58;<br /><br />            mov     ecx, eax<br />            mov     eax, &#40;BINTREE PTR &#91;eax&#93;&#41;.ptRight<br />            jmp     @@SwingNode<br /><br />    @@BSearchExit&#58;<br /><br />        xor     eax, eax<br />        ret<br /><br />BDelete ENDP&#91;/size&#93;</code></pre>I'll be in Lake Tahoe tomorrow, then to Vegas then to Grand Canyon then to Utah... So long suckerz... :grin:<br /><br />And no I didn't went to prison or jail!!! :grin:</div>
    <div class="meta">Posted on 2002-04-18 21:19:06 by stryker</div>
   </div>
   <div class="post" id="post-34010">
    <div class="subject"><a href="#post-34010">Binary Trees</a></div>
    <div class="body"><div class="quote"><em>Originally posted by stryker </em><br />I'll be in Lake Tahoe tomorrow, then to Vegas then to Grand Canyon then to Utah... So long suckerz... :grin:<br /></div><br /><br />When your from Mars you obviously want to get in the sites while you have the chance...<br /><br />Lucky bastard :)<br /><br />Sliver</div>
    <div class="meta">Posted on 2002-04-19 01:19:19 by Sliver</div>
   </div>
  </div>
 </body>
</html>