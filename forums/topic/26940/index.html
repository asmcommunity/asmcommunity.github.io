<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Using listboxes - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26940" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26940">Using listboxes</a></p>
   <div class="post" id="post-193714">
    <div class="subject"><a href="#post-193714">Using listboxes</a></div>
    <div class="body">Could anyone please enlighten me on how I might:

1. Change the background color of a listbox.
2. Right-Align text in a listbox.

I looked on MS's website, and it said the style flag for right-alignment was 64 (if I remember correctly)...  When I tried to "OR" this value with the other flags, I had no success.  As for changing the background color, I'm completely lost.  WM_DISABLE flag disables it, but doesn't gray it out.  The listbox was created within a dialog template, if that matters any.  I can live with the left-alignment, I suppose, but the white-while-disabled thing is annoying the hell out of me.

Thanks in advance for any tips anyone can provide.  Still hoping one of these days this connection will stay up long enough to download that API reference.</div>
    <div class="meta">Posted on 2001-02-18 16:26:00 by Q</div>
   </div>
   <div class="post" id="post-193715">
    <div class="subject"><a href="#post-193715">Using listboxes</a></div>
    <div class="body">Could anyone please enlighten me on how I might:

1. Change the background color of a listbox.
 
Very easy:
    .if uMsg == WM_CTLCOLORLISTBOX
    
    invoke SetBkMode,wParam,2            ; 1 = TRANSPARENT or 2 = OPAQUE
    invoke SetTextColor,wParam,00ffCF00h ; text color value
    invoke SetBkColor,wParam,  000000ffh ; Backgrn color value
    invoke CreateSolidBrush,   0000ff00h ; brush color value

:)
forge</div>
    <div class="meta">Posted on 2001-02-19 01:05:00 by forge</div>
   </div>
   <div class="post" id="post-193716">
    <div class="subject"><a href="#post-193716">Using listboxes</a></div>
    <div class="body">Beautiful!!
Solved the other problem just this morning.

Thanks again.</div>
    <div class="meta">Posted on 2001-02-19 04:03:00 by Q</div>
   </div>
  </div>
 </body>
</html>