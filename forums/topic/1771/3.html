<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Demos for next version of MASM32 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1771" />
  <link rel="prev" href="../?id=1771&amp;page=2" />  <link rel="next" href="../?id=1771&amp;page=4" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1771">Demos for next version of MASM32</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=1771&amp;page=1" style="">&laquo;</a><a href="../?id=1771&amp;page=2" style="">&lt;</a><input type="hidden" name="id" value="1771" /><input type="number" name="page" min="1" max="4" step="1" value="3" onchange="this.form.submit();" /><a href="../?id=1771&amp;page=4">&gt;</a><a href="../?id=1771&amp;page=4">&raquo;</a></form>   <div class="post" id="post-12235">
    <div class="subject"><a href="#post-12235">Demos for next version of MASM32</a></div>
    <div class="body">sorry,my home page should be this : <a target="_blank" href="http://www.jingtao.org">http://www.jingtao.org</a><br /> and this is the demo cutting files using file-mapping.I did know it had some errors but woked very good by my test.</div>
    <div class="meta">Posted on 2001-11-16 05:43:47 by smallwaves</div>
   </div>
   <div class="post" id="post-12267">
    <div class="subject"><a href="#post-12267">Alarm, Countdown Timer, Stopwatch in win32 ASM</a></div>
    <div class="body">Hutch-- and all,<br /><br />Attached is a zip file with jacts.asm clock.ico &amp;<br />rsrc.rc for a program I use at least once a day to<br />remind me to get up and do &quot;something&quot; or watch<br />a TV program.  It was the second asm program I <br />finished but the one that got me started in MASM32.  Include this with 7.0, or just look and <br />put it to use if handy.<br /><br />I wanted something like this but the only freeware <br />utilities I could find were written in VB and <br />required this DLL or another and ended up as <br />multi-megabyte downloads.  This ends up as a 12K<br />exe file and hardly registers on the CPU <br />utilization indicators.<br /><br />It uses the DateTimePicker controls to set a date<br />&amp; time for an &quot;alarm&quot; or you can set a certain<br />number of hours/minutes/seconds till the alarm <br />sounds.  The alarm can be any sound which can be<br />handled with the PlaySound API.  A stopwatch <br />feature is also available.<br /><br />farrier</div>
    <div class="meta">Posted on 2001-11-16 14:12:25 by farrier</div>
   </div>
   <div class="post" id="post-12273">
    <div class="subject"><a href="#post-12273">Demos for next version of MASM32</a></div>
    <div class="body">Hutch: could you add these constants to windows.inc? They are winsock 2 specific and used for the function WSASelectEvent. I couldn't find them in the current windows.inc<br /><br /><pre><code><br />FD_READ_BIT                     equ 0<br />FD_WRITE_BIT                    equ 1<br />FD_OOB_BIT                      equ 2<br />FD_ACCEPT_BIT                   equ 3<br />FD_CONNECT_BIT                  equ 4<br />FD_CLOSE_BIT                    equ 5<br />FD_QOS_BIT                      equ 6<br />FD_GROUP_QOS_BIT                equ 7<br />FD_ROUTING_INTERFACE_CHANGE_BIT equ 8<br />FD_ADDRESS_LIST_CHANGE_BIT      equ 9<br /><br /><br />FD_MAX_EVENTS                   equ 10<br />FD_ALL_EVENTS                   equ &#40;1 SHL FD_MAX_EVENTS&#41; - 1<br /><br />WSANETWORKEVENTS STRUCT<br />    lNetworkEvents      dd  ?<br />    iErrorCode          dd  FD_MAX_EVENTS dup &#40;?&#41;<br />WSANETWORKEVENTS ENDS<br /></code></pre><br /><br />Thomas</div>
    <div class="meta">Posted on 2001-11-16 14:47:31 by Thomas</div>
   </div>
   <div class="post" id="post-12278">
    <div class="subject"><a href="#post-12278">la da di la di da</a></div>
    <div class="body">here hutch, catch. It was very easy to convert the C source to asm,<br />it took a lot longer to convert the htmlhelp.h to htmlhelp.inc. Icky.<br />Feel free to include htmlhelp.inc and htmlhelp.lib as part of standard<br />masm32 distro (htmlhelp.inc isn't 100% complete though, there<br />was a struct I didn't convert 100% and such).<br /><br />And of course include the app as a demo. Don't go changing around<br />the sources though, they are as they should be. I used relative<br />paths, and people will just have to learn to use INCLUDE and LIB<br />and deal with it... or at least take the time to edit the source and<br />put in the semi-absolute paths. They'll need source editing anyway<br />to point to a .col or .chm file.<br /><br />Have fun.</div>
    <div class="meta">Posted on 2001-11-16 15:33:08 by f0dder</div>
   </div>
   <div class="post" id="post-12280">
    <div class="subject"><a href="#post-12280">Demos for next version of MASM32</a></div>
    <div class="body">Geeh, it's just too easy to remember to forget to actually attach<br />your stuff, giggle.<br />:stupid:</div>
    <div class="meta">Posted on 2001-11-16 15:35:31 by f0dder</div>
   </div>
   <div class="post" id="post-12281">
    <div class="subject"><a href="#post-12281">Demos for next version of MASM32</a></div>
    <div class="body">How about adding an _WINDOW_INC equ so we have a standard way of checking to see if its installed. So far ive just been checking for WM_CREATE. Just a suggestion.</div>
    <div class="meta">Posted on 2001-11-16 16:16:39 by ChimpFace9000</div>
   </div>
   <div class="post" id="post-12282">
    <div class="subject"><a href="#post-12282">Demos for next version of MASM32</a></div>
    <div class="body">Huh?</div>
    <div class="meta">Posted on 2001-11-16 16:31:42 by f0dder</div>
   </div>
   <div class="post" id="post-12283">
    <div class="subject"><a href="#post-12283">Demos for next version of MASM32</a></div>
    <div class="body">ChimpFace9000,<br /><br />I have seen this type of stuff in VB coding but I just don't see the point of a dead equate in the windows.inc file when the easiest way to see if its there is to cheack at the top of the file.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2001-11-16 17:10:35 by hutch--</div>
   </div>
   <div class="post" id="post-12284">
    <div class="subject"><a href="#post-12284">Demos for next version of MASM32</a></div>
    <div class="body">El hutchesson, what is this thingy chimpface wants? Details, please.</div>
    <div class="meta">Posted on 2001-11-16 17:28:22 by f0dder</div>
   </div>
   <div class="post" id="post-12285">
    <div class="subject"><a href="#post-12285">Demos for next version of MASM32</a></div>
    <div class="body">What i mean is, say you have one include file that you have for all you asm files. And with that inc flie you need the windows inc file to be included too. So in case you forget to put an include windows.inc at the top of your asm file you put this in you inc file...<br /><br /><pre><code>ifndef _WINDOWS_INC<br />include windows.inc<br />endif</code></pre><br /><br />Then if windows.inc isnt included, _WINDOW_INC would not have been defined, and then windows.inc would be included. If _WINDOWS_INC is defined, then windows.inc isnt included. <br /><br />Did that make sense?</div>
    <div class="meta">Posted on 2001-11-16 17:43:33 by ChimpFace9000</div>
   </div>
   <div class="post" id="post-12289">
    <div class="subject"><a href="#post-12289">Demos for next version of MASM32</a></div>
    <div class="body">Yes, it made sense, and I actually believe it's pretty useful... that<br />way you don't get screwed if you include header files multiple times.<br /><br />But oh well, since windows.inc is as monolithic as it is :/, it's not too<br />much of an issue.</div>
    <div class="meta">Posted on 2001-11-16 18:06:45 by f0dder</div>
   </div>
   <div class="post" id="post-12298">
    <div class="subject"><a href="#post-12298">Demos for next version of MASM32</a></div>
    <div class="body">Btw everybody, feel free to comment on the hhlookup... I see it's<br />been downloaded 8 times... feedback! :grin:</div>
    <div class="meta">Posted on 2001-11-16 20:43:24 by f0dder</div>
   </div>
   <div class="post" id="post-12318">
    <div class="subject"><a href="#post-12318">Demos for next version of MASM32</a></div>
    <div class="body">f0dder: I haven't had the chance to actually try it but thanks for converting the headers.. I definitely plan to create htmlhelp for my HTTPFT program.<br /><br />Thanks :alright: <br /><br />Thomas</div>
    <div class="meta">Posted on 2001-11-17 03:47:56 by Thomas</div>
   </div>
   <div class="post" id="post-12333">
    <div class="subject"><a href="#post-12333">Demos for next version of MASM32</a></div>
    <div class="body">fOdder,<br /><br />After setting the inc/lib directory paths and adjusting the HHFILE textequ (using single backslashes instead of two in the filepath..and pointing it to my platsdk.col file), and also putting uuid.lib in the same folder as the .asm was in (it wouldn't pick it up from my libs dir)...THEN it works GREAT !! :alright: <br /><br />There's lots of interesting code you've whipped up in there too. I am again, inspired!<br /><br />BTW: In your earlier post you mentioned your use of relative paths for the incs/libs...<br /><br />&lt;windows.inc&gt;<br /><br />It wouldn't take. How should that work?</div>
    <div class="meta">Posted on 2001-11-17 06:26:10 by gscundiff</div>
   </div>
   <div class="post" id="post-12338">
    <div class="subject"><a href="#post-12338">Demos for next version of MASM32</a></div>
    <div class="body">The big problem with the relative paths is that hutch uses an old<br />win3.x function for spawning apps, instead of CreateProcess, and<br />thus cannot specify an environment block to ml.exe. This means<br />ml.exe in effect ignores your INCLUDE and LIB paths, and you have<br />to specify the semi-absolute paths as (almost?) all masm32 examples do.<br />Hutch defends this by &quot;you can always edit the batch files included<br />with masm32&quot;. True. But still a bit cheesy, and I would still need<br />to specify some paths myself, as the environment variables aren't<br />there (well, it's some months since I played around with this, and<br />according to my memory, the env. variables weren't present).<br />All there is to it is to GetEnvironmentStrings(), use that in CreateProcess,<br />and use CreateProcess instead of WinExec (it's not too hard to<br />write a wrapper around CreateProcess that does this and is as<br />easy to call as WinExec).<br /><br />That's why I use editplus (or masmed) for editing, and a cmd.exe<br />for calling ml.exe and link.exe myself (usuall through batch files).<br />If you're on win9x, you must edit autoexec.bat to include<br />SET INCLUDE=c:\masm32\include<br />SET LIB=c:\masm32\lib<br />(or add to them with semicolon-separation if you already have include<br />and lib environments), and then reboot to take effect. If you open<br />a command.com, you can also set these variables temporarily, to<br />test out before you reboot.<br /><br />If you're on nt/2k/xp, go to system properties, advanced tab, environment<br />variables, and set INCLUDE and LIB in the &quot;user variables for &lt;user&gt;&quot;.<br />You might need to close cmd.exe and other apps and open again<br />for them to use the new env variables, but you do not need to reboot.<br /><br />After you have done this, open a cmd.exe or command.com and<br />try my mk.bat. If it works, life is jolly :).</div>
    <div class="meta">Posted on 2001-11-17 08:35:15 by f0dder</div>
   </div>
   <div class="post" id="post-12339">
    <div class="subject"><a href="#post-12339">Demos for next version of MASM32</a></div>
    <div class="body">By the way, the double-backslashes work fine on my system :).<br />Yeah, they should be changed to single-backslashes... silly me.<br />But it *works* on my system. Weird.<br /><br />It's also weird you had to put uuid.lib in your folder... it ought to<br />be picked up automatically... perhaps it's not included in the masm32<br />libs? I have deleted the masm32 libs, and now exclusively use the<br />libs from platformsdk. I realized I had libs from masm32, lcc, vc++,<br />and platformsdk... and this was taking too much space. So I just<br />deleted all the crusty old libs and set up all my tools to use platformsdk.<br />&quot;The latest and the greatest&quot; :).<br /><br />The only part of masm32 I really use now are the header files.<br />And sometimes I look through the examples, although that's not<br />very often either. But I'm still happy that hutch and iczelion care to<br />put this tremendous effort into this package. Especially the whole<br />header file mess (windows.inc structure conversion... bloody boring<br />to do by hand).<br /><br />I don't particularly enjoy the monolithic nature of windows.inc, but<br />with the processor I have, it's not *too* much of a problem. I pity<br />people with slower boxes though.</div>
    <div class="meta">Posted on 2001-11-17 08:42:06 by f0dder</div>
   </div>
   <div class="post" id="post-12364">
    <div class="subject"><a href="#post-12364">Demos for next version of MASM32</a></div>
    <div class="body">fOdder,<br /><br />Thanks for the explanation on relative paths. I'll definately setup my system that way now.<br /><br />I've encountered problems with WinExec not displaying ComboBox text, so I've been using  ShellExecute instead. And what's the deal with CreateProcess (or multiple-CreateProcess) and the way it leaks memory? A big problem after several dozen builds with IDE's that use it...User Resources dive like the Titanic!<br /><br />I did have uuid.lib in my libs directory. It was from Hutch's pkg 953kb-12.02.97. I also tried the newer one from the PSDK 1237kb-07.26.01 but it said it couldn't find either one. So I just slapped it into the same folder the .asm was in. Haven't bothered to suss out why yet.<br /><br />-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-<br /><br />Hutch,<br /><br />I'm still too green in Win32asm to contribute much of anything to your v7 package, but I thought I'd try something at least...<br /><br />It's a snippet I picked up from some LordRhesus code that uses AppendMenu to setup a Right-Click dropdown menu in a program.</div>
    <div class="meta">Posted on 2001-11-17 12:12:25 by gscundiff</div>
   </div>
   <div class="post" id="post-12367">
    <div class="subject"><a href="#post-12367">Demos for next version of MASM32</a></div>
    <div class="body">Hmm, CreateProcess leaking? You might want to CloseHandle<br />on pi.hProcess and pi.hThread if you don't use them, that might<br />be the cause of the leaks.<br /><br />ShellExecute is okay, though it doesn't offer as much flexibility as<br />CreateProcess. It's *very* good for launching &quot;files&quot; though, because<br />it handles filetype associations.</div>
    <div class="meta">Posted on 2001-11-17 12:20:39 by f0dder</div>
   </div>
   <div class="post" id="post-12383">
    <div class="subject"><a href="#post-12383">please, an option for dos</a></div>
    <div class="body">hi hutch,<br />could you include in your package a separate linker for 16 bit dos programs, and an option in IDE what kind of project to build, dos or win executable? that would make life alot easier to begginers like me who want to write asm DOS programs for learning purposes (all books about asm programming i have deal with writting proggies for DOS not for win32).</div>
    <div class="meta">Posted on 2001-11-17 15:23:35 by Unregiztered</div>
   </div>
   <div class="post" id="post-12389">
    <div class="subject"><a href="#post-12389">Demos for next version of MASM32</a></div>
    <div class="body">f0dder,<br /><br />A little knowledge is a dangereous thing, if you really want to use the environment for handling the paths of the LIB and INCLUDE directories, you take advantage of the Virtual Machine component of all of the 32 bit versions of windows and set the path in the batch file you choose to use to build the project.<br /><br />This way you can avoid the exact problem that is addressed in the semi absolute paths in MASM32, getting the wrong version of LINK, the wrong versions of the libraries and the countless errors that follow from doing so.<br /><br />Putting these paths in the autoexec.bat file restricts the user to one programming environment where MASM32 was designed specifically to co-exist with others and the only safe way to do this is to set the paths in the source file.<br /><br />There are multiple way of building files under masm, the problem with non standardisation is that few people can get examples going when they are built in ways that are not documented properly. With the standardisation in MASM32 it allows code to be passed around without all of the associated problems of not finding the appropriate binaries, libraries, includes, nmake and other compatibility problems.<br /><br />===============================================<br />The big problem with the relative paths is that hutch uses an old win3.x function for spawning apps, instead of CreateProcess, and thus cannot specify an environment block to ml.exe.<br />===============================================<br /><br />A little investigation will show that WinExec is directly mapped to CreateProcess within the appropriate system DLL. If I remember correctly, the demo code you sent me some time ago to manipulate the environment block rebooted my machine when I ran it so this type of &quot;advanced&quot; programming is the type I avoid.<br /><br />The advantage of the technique I use in MASM32 is that it is reliable and it is not subject to variation across different versions of windows.<br /><br />The other problem with this approach is that ML.EXE can use an environment set at the command prompt so messing around with unreliable code is no gain here.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2001-11-17 17:22:52 by hutch--</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=1771&amp;page=1" style="">&laquo;</a><a href="../?id=1771&amp;page=2" style="">&lt;</a><input type="hidden" name="id" value="1771" /><input type="number" name="page" min="1" max="4" step="1" value="3" onchange="this.form.submit();" /><a href="../?id=1771&amp;page=4">&gt;</a><a href="../?id=1771&amp;page=4">&raquo;</a></form>  </div>
 </body>
</html>