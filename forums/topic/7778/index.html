<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Is User Admin? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7778" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7778">Is User Admin?</a></p>
   <div class="post" id="post-56416">
    <div class="subject"><a href="#post-56416">Is User Admin?</a></div>
    <div class="body">Hi all, can anyone show me some (MASM) code to tell if the current user is Admin or not?  Or direct me to a website?  I need to know if the user is Admin or has Admin rights so my program can display some values from the Registry that the Admins can only set.  I was going to add this feature to my program when I wrote in VB but never gotten around to it, all I remember was that is has to do with tokens or SID or something.<br /><br />Any help much appreciated!</div>
    <div class="meta">Posted on 2002-09-06 17:56:08 by Gunner</div>
   </div>
   <div class="post" id="post-56418">
    <div class="subject"><a href="#post-56418">Is User Admin?</a></div>
    <div class="body"><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=7655">http://www.asmcommunity.net/board/index.php?topic=7655</a> :)</div>
    <div class="meta">Posted on 2002-09-06 18:44:05 by stryker</div>
   </div>
   <div class="post" id="post-56421">
    <div class="subject"><a href="#post-56421">Is User Admin?</a></div>
    <div class="body">Odd that I didn't find that post stryker cause I did a search of the board before my post. Hmmm<br /><br />Thanks</div>
    <div class="meta">Posted on 2002-09-06 18:49:34 by Gunner</div>
   </div>
   <div class="post" id="post-56424">
    <div class="subject"><a href="#post-56424">Is User Admin?</a></div>
    <div class="body">lol, that thread doesn't contain any key words of Is Admin or whatever but it does contain similar purpose to what your after.<br /><br />Don't worry. :grin:</div>
    <div class="meta">Posted on 2002-09-06 18:58:33 by stryker</div>
   </div>
   <div class="post" id="post-56429">
    <div class="subject"><a href="#post-56429">Is User Admin?</a></div>
    <div class="body">I would simply call the IsUserAnAdmin API :grin: <br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/isuseranadmin.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/isuseranadmin.asp</a></div>
    <div class="meta">Posted on 2002-09-06 19:47:24 by bazik</div>
   </div>
   <div class="post" id="post-56431">
    <div class="subject"><a href="#post-56431">Is User Admin?</a></div>
    <div class="body">IsUserAnAdmin.<br />Jeesh, how'd I miss this one?  Anyway, this is for Win 2K and higher:<br />Minimum operating systems:<br />Windows 2000<br /><br />So this function would work on 2000 and XP.  How about something that would work on NT4 an maybe lower?<br /><br /><br />Ok ya crazy penguin, just tried it and DUH, it is not in my user32.lib/inc, how do I updated my lib files?  I do have the platform sdk installed with the header and include files....</div>
    <div class="meta">Posted on 2002-09-06 19:59:42 by Gunner</div>
   </div>
   <div class="post" id="post-56471">
    <div class="subject"><a href="#post-56471">Is User Admin?</a></div>
    <div class="body"><div class="quote"><br />So this function would work on 2000 and XP.  How about something that would work on NT4 an maybe lower?<br /></div><br /><br />&quot;Lower&quot; than NT 4.0 are no security rights. Or do you mean NT 3.51? :)<br /><div class="quote"><em>Originally posted by Gunner </em><strong><br /><br />Ok ya crazy penguin, just tried it and DUH, it is not in my user32.lib/inc, how do I updated my lib files?  I do have the platform sdk installed with the header and include files.... </div><br /><br />Well, download the PlatformSDK, copy the *.lib files to the MASM32 lib directory and run the &quot;rebuild.bat&quot; (\masm32\rebuild.bat) to rebuild the include files. That should work ;)<br /><br /><br />I wrote &quot;download&quot;, because you really need the latest SDK. The &quot;IsUserAnAdmin&quot; function is part of the shortly released MS Middleware APIs, so I doubt it will be documented in earlier SDKs.</div>
    <div class="meta">Posted on 2002-09-07 03:27:05 by bazik</div>
   </div>
   <div class="post" id="post-56472">
    <div class="subject"><a href="#post-56472">Is User Admin?</a></div>
    <div class="body">gunner,<br /><br />shouldn't the link I just gave enough for win NT/2K/XP.<br /><br />quoting from this link: <a target="_blank" href="http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q118626&amp;">http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q118626&amp;</a><div class="quote">HOWTO: Determine Whether a Thread Is Running in User Context of Local Administrator Account<br /><br />The information in this article applies to:<br /><br />Microsoft Win32 Application Programming Interface (API), when used with:<br />the operating system: Microsoft Windows NT<br /><br />the operating system: Microsoft Windows 2000<br /><br />the operating system: Microsoft Windows XP</div>Instead of updating the .lib files you can use LoadLibrary/GetProcAddress...</div>
    <div class="meta">Posted on 2002-09-07 03:31:26 by stryker</div>
   </div>
   <div class="post" id="post-56473">
    <div class="subject"><a href="#post-56473">Is User Admin?</a></div>
    <div class="body">Rob,<br /><br />You can use the complete XP set of libraries if you have a late enough platformsdk but be aware that a couple of the libraries that have no APIs in them cause a problem with the L2INCA utility so the trick is to delete them out as you don't use them and keep going until the whole set build OK into the matching include files.<br /><br />Its no big deal to do and it means you have a complete set for XP and lower.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-09-07 03:31:35 by hutch--</div>
   </div>
   <div class="post" id="post-56499">
    <div class="subject"><a href="#post-56499">Is User Admin?</a></div>
    <div class="body">Thank you all!  I have some things to play around with now.  Never thought about LoadLibrary/GetProcAddress, still new to this great thing ya know ;-)</div>
    <div class="meta">Posted on 2002-09-07 07:32:46 by Gunner</div>
   </div>
  </div>
 </body>
</html>