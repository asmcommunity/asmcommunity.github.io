<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Procedure Calling - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16534" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=16534">Procedure Calling</a></p>
   <div class="post" id="post-128579">
    <div class="subject"><a href="#post-128579">Procedure Calling</a></div>
    <div class="body">Hi All,<br /><br />Just a couple of quick questions - I am doing some tutorials to get upto speed on HLA, currently Iczelion's &quot;Simple Window&quot; tutorial.  Firstly I'm I correct in assuming that win32.hhf is now named w.hhf.  Secondly - in this tutorial the procedure WndProc is defined and called, however in the w.hhf header file the procedure WndProc differs in syntax and variable declaration. I am correct in assuming that the syntax error during &quot;build&quot; is caused by the WndProc in the tutorial not being indentical to WndProc in the w.hhf.<br /><br />The &quot;build&quot; error specifically is - <br /><br />Error in file &quot;CV.hla&quot; at line 28 :<br />syntax error, unexpected UndefID.<br />Near: &lt;&lt; nodisplay &gt;&gt;<br /><br /><br />Thanks<br /><br />Marc</div>
    <div class="meta">Posted on 2003-12-21 15:49:24 by Krug</div>
   </div>
   <div class="post" id="post-128580">
    <div class="subject"><a href="#post-128580">Procedure Calling</a></div>
    <div class="body">Krug, <br /><br />Yes you're right win32.hhf is now w.hhf. I think you may be using an old win32 HLA example program. The 'nodisplay' option should be '@nodisplay'.  Some of iczelion's tutorials have been converted to HLA syntax. They are probably in the examples package at webster. <br /><br />Here's the code for the tut03: <br /><br /><pre><code> <br /><br />// Iczelion's tutorial #3&#58; A Simple Window<br /><br />program aSimpleWindow;<br />#include&#40; &quot;w.hhf&quot; &#41;			// Standard windows stuff.<br />#include&#40; &quot;strings.hhf&quot; &#41;	// Defines HLA string routines.<br />#include&#40; &quot;memory.hhf&quot; &#41;	// Defines &quot;NULL&quot; among other things.<br />#include&#40; &quot;args.hhf&quot; &#41;		// Command line parameter stuff.<br />#include&#40; &quot;conv.hhf&quot; &#41;<br /><br /><br />static<br />	hInstance&#58;		dword;<br />	CommandLine&#58;	string;<br />	<br />readonly<br /><br />	ClassName&#58;	string &#58;= &quot;SimpleWinClass&quot;;<br />	AppName&#58;	string &#58;= &quot;Our First Window&quot;;<br />	<br /><br /><br />static GetLastError&#58;procedure; @external&#40; &quot;__imp__GetLastError@0&quot; &#41;;<br /><br /><br />// The window procedure.  Since this gets called directly from<br />// windows we need to explicitly reverse the parameters &#40;compared<br />// to the standard STDCALL declaration&#41; in order to make HLA's<br />// Pascal calling convention compatible with Windows.<br />//<br />// This is actually a function that returns a return result in<br />// EAX.  If this function returns zero in EAX, then the event<br />// loop terminates program execution.<br /><br />procedure WndProc&#40; hWnd&#58;dword; uMsg&#58;uns32; wParam&#58;dword; lParam&#58;dword  &#41;;<br />	@nodisplay;<br />	@stdcall;	<br />	<br />begin WndProc;<br /><br />	// If the WM_DESTROY message comes along, then we've<br />	// got to post a message telling the event loop that<br />	// it's time to quit the program.  The return value in<br />	// EAX must be false &#40;zero&#41;.  The GetMessage function<br />	// will return this value to the event loop which is<br />	// the indication that it's time to quit.<br />	<br />	if&#40; uMsg = w.WM_DESTROY &#41; then<br />	<br />		w.PostQuitMessage&#40; 0 &#41;;<br />		sub&#40; eax, eax &#41;;<br />		<br />	else<br />	<br />		// If a WM_DESTROY message doesn't come along,<br />		// let the default window handler process the<br />		// message.  Whatever &#40;non-zero&#41; value this function<br />		// returns is the return result passed on to the<br />		// event loop.<br />		<br />		w.DefWindowProc&#40; hWnd, uMsg, wParam, lParam &#41;;<br />		<br />	endif;<br />	<br />end WndProc;<br /><br /><br />	<br />// WinMain-<br />//<br />// This is the &quot;main&quot; windows program.  It sets up the<br />// window and then enters an &quot;event loop&quot; processing<br />// whatever messages are passed along to that window.<br />// Since our code is the only code that calls this function,<br />// we'll use the Pascal calling conventions for the parameters.<br /><br />procedure WinMain<br />&#40;<br />	hInst&#58;		dword;<br />	hPrevInst&#58;	dword;<br />	CmdLine&#58;	string;<br />	CmdShow&#58;	dword<br />&#41;;	<br />	@nodisplay;<br /><br />var<br />	wc&#58;		w.WNDCLASSEX;<br />	msg&#58;	w.MSG;<br />	hwnd&#58;	dword;<br />	<br />begin WinMain;<br /><br /><br />	// Set up the window class &#40;wc&#41; object&#58;<br />	<br />	mov&#40; @size&#40; w.WNDCLASSEX &#41;, wc.cbSize &#41;;<br />	mov&#40; w.CS_HREDRAW | w.CS_VREDRAW, wc.style &#41;;<br />	mov&#40; &amp;WndProc, wc.lpfnWndProc &#41;;<br />	mov&#40; 0, wc.cbClsExtra &#41;;<br />	mov&#40; 0, wc.cbWndExtra &#41;;<br />	<br />	mov&#40; hInstance, wc.hInstance &#41;;<br />	mov&#40; w.COLOR_WINDOW+1, wc.hbrBackground &#41;;<br />	mov&#40; NULL, wc.lpszMenuName &#41;;<br />	mov&#40; ClassName, wc.lpszClassName &#41;;<br />	<br />	// Get the icons and cursor for this application&#58;<br />	<br />	w.LoadIcon&#40; NULL, val w.IDI_APPLICATION &#41;;<br />	mov&#40; eax, wc.hIcon &#41;;<br />	mov&#40; eax, wc.hIconSm &#41;;<br />	<br />	w.LoadCursor&#40; NULL, val w.IDC_ARROW &#41;;<br />	mov&#40; eax, wc.hCursor &#41;;<br />	<br />	<br />	// Okay, register this window with Windows so it<br />	// will start passing messages our way.  Once this<br />	// is accomplished, create the window and display it.<br />	<br />	w.RegisterClassEx&#40; wc &#41;;<br />	w.CreateWindowEx<br />	&#40; <br />		0, <br />		ClassName, <br />		AppName, <br />		w.WS_OVERLAPPEDWINDOW,<br />		w.CW_USEDEFAULT,<br />		w.CW_USEDEFAULT,<br />		w.CW_USEDEFAULT,<br />		w.CW_USEDEFAULT,<br />		0,<br />		0,<br />		hInst,<br />		NULL<br />	&#41;;<br />	mov&#40; eax, hwnd &#41;;<br />	<br /><br />	w.ShowWindow&#40; hwnd, w.SW_SHOWNORMAL &#41;;<br />	w.UpdateWindow&#40; hwnd &#41;;<br />	<br />	// Here's the event loop that processes messages<br />	// sent to our window.  On return from GetMessage,<br />	// break if EAX contains false and quit the<br />	// program.<br />	<br />	forever<br />	<br />		w.GetMessage&#40; msg, NULL, 0, 0 &#41;;<br />		breakif&#40; !eax &#41;;<br />		w.TranslateMessage&#40; msg &#41;;<br />		w.DispatchMessage&#40; msg &#41;;<br />		<br />	endfor;<br />	mov&#40; msg.wParam, eax &#41;;<br />	<br /><br />end WinMain;<br /><br />	<br />begin aSimpleWindow;<br /><br />	// Get this process' handle&#58;<br />	<br />	w.GetModuleHandle&#40; NULL &#41;;<br />	mov&#40; eax, hInstance &#41;;<br />	<br />	// Get a copy of the command line string passed to this code&#58;<br />	<br />	mov&#40; arg.cmdLn&#40;&#41;, CommandLine &#41;;<br />	<br /><br />	<br />	WinMain&#40; hInstance, NULL, CommandLine, w.SW_SHOWDEFAULT &#41;;<br />	<br />	// WinMain returns a return code in EAX, exit the program<br />	// and pass along that return code.<br />	<br />	w.ExitProcess&#40; eax &#41;;	<br /><br />end aSimpleWindow;<br /><br /><br /></code></pre></div>
    <div class="meta">Posted on 2003-12-21 16:03:19 by Odyssey</div>
   </div>
   <div class="post" id="post-128623">
    <div class="subject"><a href="#post-128623">Procedure Calling</a></div>
    <div class="body">Odyssey,<br /><br />Thanks for the reply , program now assembling and when run windows gives a dialog box with message &quot;Unhandled Exception Error&quot; - Am I missing something obvious?  <br /><br />NB This happens with tutorial 4 as well<br /><br />Regards<br /><br /><br />Marc</div>
    <div class="meta">Posted on 2003-12-22 05:52:34 by Krug</div>
   </div>
   <div class="post" id="post-128727">
    <div class="subject"><a href="#post-128727">Procedure Calling</a></div>
    <div class="body"><div class="quote"><br />Odyssey,<br /><br />Thanks for the reply , program now assembling and when run windows gives a dialog box with message &quot;Unhandled Exception Error&quot; - Am I missing something obvious?  <br /><br />NB This happens with tutorial 4 as well<br /><br />Regards<br /><br /><br />Marc </div><br /><br />Hmmm....<br />What OS are you using?<br />I cut and pasted the sample program given earlier and it compiled and ran just fine under XP.<br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-12-23 10:42:20 by rhyde</div>
   </div>
   <div class="post" id="post-128745">
    <div class="subject"><a href="#post-128745">Procedure Calling</a></div>
    <div class="body">Works under win98 and winME as well, copied and pasted exactly as shown.</div>
    <div class="meta">Posted on 2003-12-23 13:13:21 by Kain</div>
   </div>
   <div class="post" id="post-128747">
    <div class="subject"><a href="#post-128747">More Info</a></div>
    <div class="body">All,<br /><br />Currently running XP Professional.  Using RadASM as IDE, when using run instruction (from Make menu) in RadASM the &quot;Unhandled Exception Error&quot; dialog box appears and the simple window does not, however went to command prompt and ran tutorial3.exe and the simple window appeared with no error message.  Seems strange - any thoughts on why error message is generated when using RadASM?<br /><br />Thanks<br /><br /><br />Marc</div>
    <div class="meta">Posted on 2003-12-23 13:23:49 by Krug</div>
   </div>
  </div>
 </body>
</html>