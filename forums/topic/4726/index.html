<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>masm32 and Windows NT - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4726" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4726">masm32 and Windows NT</a></p>
   <div class="post" id="post-33176">
    <div class="subject"><a href="#post-33176">masm32 and Windows NT</a></div>
    <div class="body">Hi! Just a quick question:<br /><br /> At work, the computers here are Windows NT platform. I brought in my masm32 package so i could get some coding done at work when it's quiet. But every time I try to compile something it comes out wrong. The resulting executable when run causes NT to spit out a message saying it has encountered an invalid instruction. Furthermore, no matter what kind of program it is, a console box pops up much like I was running a DOS program.<br /><br />Anybody seen this? I've tried it on at least 5 computers...<br /><br />--Chorus</div>
    <div class="meta">Posted on 2002-04-11 20:59:12 by chorus</div>
   </div>
   <div class="post" id="post-33178">
    <div class="subject"><a href="#post-33178">masm32 and Windows NT</a></div>
    <div class="body">Perhaps if you post a bit of code that you are having problems with, and your compile command, we can tell you what is wrong... for what it is worth, i do all my work on NT/Win2K with hutch's package, and have never had a problem......</div>
    <div class="meta">Posted on 2002-04-11 21:08:30 by sluggy</div>
   </div>
   <div class="post" id="post-33265">
    <div class="subject"><a href="#post-33265">masm32 and Windows NT</a></div>
    <div class="body">chorus,<br /><br />I've only written 5 sizable ASM programs for WIN32 but I can tell you that 4 of them gave the same illegal operation error when first run on an NT4 or WIN2000 machine.  I did all of my developement on WIN95 machines and the programs were quite happy with the way they were written, no complaints from the program or WIN95.  Only after running on NT4 and getting the address of the offending instruction did I notice the, usually, dumb programming errors that WIN95 ignored!<br /><br />About the DOS boxes; I have no idea.:confused: <br /><br />farrier</div>
    <div class="meta">Posted on 2002-04-12 19:12:04 by farrier</div>
   </div>
   <div class="post" id="post-33266">
    <div class="subject"><a href="#post-33266">masm32 and Windows NT</a></div>
    <div class="body">erm, the dos box comes up every time when you use console assmble and link instead of the  other one's.</div>
    <div class="meta">Posted on 2002-04-12 19:23:10 by dionysus</div>
   </div>
   <div class="post" id="post-33267">
    <div class="subject"><a href="#post-33267">ok...</a></div>
    <div class="body">Well aparently today I'm lucky. The machine I'm on today that works.<br /><br />However, other machines still give me problems. (And yes, I'm familiar with the console box that comes up during assembly).<br /><br />here's what exactly happens.<br />  -- I write the code<br />  -- I choose &quot;Assemble And Link&quot;<br />  -- The program assembles without any errors or warning<br />  -- I run the program and a *DOS box* appears and immediately it crashes with the following dialog box:<br />           16 bit MS-DOS Subsystem<br />            h:\WinASM\game\gamecam.exe<br />           The NTVDM CPU has encountered an illegal instruction.<br />           CS:04f6 IP:11ed OP:63 65 73 73 00<br />           Terminate Ignore<br /><br />it doesn't matter if I choose Terminate or Ignore, either way it closes out<br /><br />The program runs perfectly fine if I compile it at home and then bring it to work. But if I recompile the source code it nukes out on me. It seems to think it's a 16 bit dos program.<br /><br />I think I'll just stay on this particular computer and not worry about it.<br /><br />Thanks all<br /><br />--Chorus</div>
    <div class="meta">Posted on 2002-04-12 19:59:47 by chorus</div>
   </div>
   <div class="post" id="post-33268">
    <div class="subject"><a href="#post-33268">masm32 and Windows NT</a></div>
    <div class="body">I ment.... if you chose console assemble and link instead of   the normal assemble and link.  when you run your app it will open a dos box every time.</div>
    <div class="meta">Posted on 2002-04-12 20:10:41 by dionysus</div>
   </div>
   <div class="post" id="post-33272">
    <div class="subject"><a href="#post-33272">masm32 and Windows NT</a></div>
    <div class="body">chorus,<br /><br />It hard to say what is going on but MASM32 is targetted at Win NT among others and it is tested on WinNT4 using a default installation with service pack 6a.<br /><br />What you will need to ensure is that the code you write works correctly on Win NT4 as there are some differences and occasional incompatibilities between Win9x and NT.<br /><br />I would be inclined to check things like access rights and similar as a default installation of NT4 has no problems at all with MASM32 and all of it works correctly.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-04-12 20:54:42 by hutch--</div>
   </div>
   <div class="post" id="post-33278">
    <div class="subject"><a href="#post-33278">masm32 and Windows NT</a></div>
    <div class="body"><div class="quote"><br />chorus,<br /><br />What you will need to ensure is that the code you write works correctly on Win NT4 as there are some differences and occasional incompatibilities between Win9x and NT.<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a> </div><br /><br />I think the problem isn't about the code sine the executable compiled in his home works fine on the machines at work ...<br /><br />The masm32 package also works fine on NT as alot mentioned ... so the only thing lift to conclude is that the machines at your work are missed up ...:grin: <br /><br />well actually I'm not sure of what I'm saying but I'm just trying to help ...:tongue:</div>
    <div class="meta">Posted on 2002-04-12 21:30:45 by code1101</div>
   </div>
   <div class="post" id="post-33284">
    <div class="subject"><a href="#post-33284">It must be the machines... I think</a></div>
    <div class="body">Well, I've come to the basic conclusion that Code1101 has: the machines are messed. Now typically I wouldn't blame it on the machines, but I can't think of anything else.<br /><br />It seems that if I compile my code at home (even something like a Hello World) it'll run on any computer.<br />If I compile it on at least 4 computers at work.. it'll crash on any computer.<br />However, there is one computer I found today that will compile properly on NT. Interestingly enough, if I code it on a NT machine that's &quot;misbehaving&quot; it'll still crash when I bring it to the NT machine that compiles correctly.<br /><br />Thanks everybody for the tips, though! I guess there's just a couple of machines that don't like me... maybe I did something wrong to them in another life.<br /><br />Later<br /><br />--Chorus</div>
    <div class="meta">Posted on 2002-04-12 22:21:41 by chorus</div>
   </div>
   <div class="post" id="post-33288">
    <div class="subject"><a href="#post-33288">masm32 and Windows NT</a></div>
    <div class="body">Just for kicks, search for an old ML.exe and LINK.exe in the path on the offending machines. My guess is a version problem.</div>
    <div class="meta">Posted on 2002-04-13 01:07:02 by SFinegan</div>
   </div>
   <div class="post" id="post-33292">
    <div class="subject"><a href="#post-33292">masm32 and Windows NT</a></div>
    <div class="body">Make sure you save / restore EBX ESI EDI in your procs. 9x often let's it run, but NT based systems usually crash if you don't follow the convention. :)</div>
    <div class="meta">Posted on 2002-04-13 02:59:47 by S/390</div>
   </div>
   <div class="post" id="post-33302">
    <div class="subject"><a href="#post-33302">masm32 and Windows NT</a></div>
    <div class="body">Also, you are not trying to use interrupts in your app, are you? Or access ports? You cannot do either in NT.</div>
    <div class="meta">Posted on 2002-04-13 05:34:48 by sluggy</div>
   </div>
   <div class="post" id="post-33313">
    <div class="subject"><a href="#post-33313">hmm..</a></div>
    <div class="body">Hi!<br />  Hey guys, ... didn't know about the interrupts/ports thing in Windows NT. However, I'm doing neither of those things. There are two different programs I'm working on that are not compiling. One is a skeleton for a tile-based game world. It generates a random set of coloured tiles and blits them to the screen. It works by setting aside a memory DC and bitmap and doing the linear transformations on the memory bitmap and then copying it to the screen. The other program is a text veiwer that I'm just starting to do (I eventually want to code my own edit control). Neither one does anything fancy... that's what I don't get.<br /><br />And I'm very careful with the USES directive... I've been burned a couple of times with that one... :)<br /><br />What I did look into was the illegal instruction. Above I posted a message that was shown to me by a dialog box, and it said the offending op was Hex 63 which turns out to be ARPL r/m16,r16. I don't use this anywhere in my program (I don't even know what it does!)<br /><br />Strange stuff...<br />Thanks for all the pointers guys! As I program more and more on NT machines I'm going to have to keep those things in mind anyways :)<br /><br />--Chorus</div>
    <div class="meta">Posted on 2002-04-13 09:17:22 by chorus</div>
   </div>
   <div class="post" id="post-33316">
    <div class="subject"><a href="#post-33316">Re: hmm..</a></div>
    <div class="body"><div class="quote"><em>One is a skeleton for a tile-based game world. It generates a random set of coloured tiles and blits them to the screen. It works by setting aside a memory DC and bitmap and doing the linear transformations on the memory bitmap and then copying it to the screen</em></div>Hah!! I have also written the same type of game, but i did it in a totally different way. If you get stuck, we can compare notes :)</div>
    <div class="meta">Posted on 2002-04-13 09:31:33 by sluggy</div>
   </div>
  </div>
 </body>
</html>