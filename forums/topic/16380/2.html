<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Program Runs, Window doesnt Appear - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16380" />
  <link rel="prev" href="../?id=16380&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16380">Program Runs, Window doesnt Appear</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=16380&amp;page=1" style="">&laquo;</a><a href="../?id=16380&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="16380" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-127352">
    <div class="subject"><a href="#post-127352">Program Runs, Window doesnt Appear</a></div>
    <div class="body">I think you'll be happy with MASM. Most of the examples you'll find are MASM, and I think it's fair to say that most here use, or at least know MASM, and will be able to help with any problems. :)</div>
    <div class="meta">Posted on 2003-12-10 22:52:15 by S/390</div>
   </div>
   <div class="post" id="post-127408">
    <div class="subject"><a href="#post-127408">mm...</a></div>
    <div class="body">well i code NASM win32 assembly since 1999  , and started with <br /><br />the first visual assembler project :<br /><br /><a target="_blank" href="http://www.fortunecity.com/skyscraper/lycos/403/">http://www.fortunecity.com/skyscraper/lycos/403/</a><br /><br />and it was based on   NASM .<br /><br /><br />if some one wants to start code with NASM i recomend to download this package<br /><br />TomCat's Win32 Programming with NASM: w32nasm.zip, w32nasm.txt<br /><a target="_blank" href="ftp://ftp.szif.hu/pub/demos/tool/w32nasm.zip">ftp://ftp.szif.hu/pub/demos/tool/w32nasm.zip</a> <br /><br />there are a lot of examples there.<br /><br /><br />then you can use NAGOA RAD IDE for NASM   , that has a lot of macros to help you code.<br /><br /><br /><br />your problem is that you do not understand the stack , and use parameters like<br /><br />ebp+8 etc.....   without knoing what your are doing  ,  then the RET ...  the RET in NASM is REAl assembly  not like in MASM ...<br /><br /><br /><br /><br />parameter can be esp+4 depends on the aproax you do.<br /><br />then you have to restore the stack   .<br /><br /><br /><br />look what you have done:<br /><br /><br />DisreguardMessageA:<br />	push dword PARAM4<br />	push dword PARAM3<br />	push dword PARAM2<br />	push dword <br />	call <br />	leave<br />	ret  <br /><br /><br />?????<br /><br /><br />mmmm  do you no assembly?<br /><br /><br /><br /><br /><br /><br />i will show an example my be can help you.<br />imagine a rotin that use 3 arguments:<br /><br />push arg_3<br />push arg_2<br />push arg_1<br />CALL rotin <br /><br /><br />stack is :<br /><br />arg_3 = esp+12<br />arg_2 = esp+8<br />arg_1 = esp+4<br /> <br /><br /><br />rotin:<br /><br />; here we use or not the arguments...<br />; but then we have to restore the stack !!!<br /><br />ret 12 ;  VERY IMPORTANT !!!<br /><br /><br /><br /><br />push arg_3<br />push arg_2<br />push arg_1<br />call rotin<br /><br /><br />stack is :<br /><br />arg_3 = esp+12<br />arg_2 = esp+8<br />arg_3 = esp+4<br /><br /><br /><br />if we use stack frame    :<br /><br /><br /><br /><br /><br />the our arguments are at diferent position :)<br /><br /><br /><br />becouse we pushed ebp in to the stack !<br /><br />rotin :<br /><br />push ebp                   ;   same of     enter 0,0<br />mov ebp,esp              ;   <br /><br />know arguments are here<br /><br />arg_1  = esp+8<br />arg_2  = esp+12<br />arg_3 =  esp+16<br />ebp    =  esp +4<br />              esp<br /><br /><br />but we sad     -&gt;  mov   ebp,esp  <br /><br />so ebp = esp<br /><br />lets use ebp then <br /><br /><br />so the arguments are  ( using stack frame ) :<br /><br />arg_1  = ebp+8<br />arg_2  = ebp+12<br />arg_3 =  ebp+16<br /><br /><br />stack in win32 is organized in 32 bits = 4 bytes .<br /><br /><br /><br />so we walk on the stack adding 4 :)<br /><br /><br /><br /><br />rotin :<br /><br />push ebp        ; make stack frame <br />mov ebp,esp<br /><br />; use or not the arguments.....<br /><br />mov esp,ebp  ; destroy stack frame<br />pop ebp         <br />ret 16              ;      supose that the last argument is ebp+16   so ret 16<br /><br /><br /><br /><br /><br />formula is    RET   4 x ( number arguments)<br /> <br /><br /><br /><br /><br />if you want to use NASM NAGOA it is like this :<br /><br /><br /><br />proc rotina , arg_1,arg_2,arg_3<br /><br />;use or not arguments<br /><br />endproc<br /><br /><br /><br /><br />i hope i help :)<br /><br /><br />some links :<br /><br />old win32n.inc<br /><br /><a target="_blank" href="http://194.65.3.199/win32asm/examples.html">http://194.65.3.199/win32asm/examples.html</a><br /><br /><br />using NASM NAGOA.INC :<br /><br /><a target="_blank" href="http://sapp.telepac.pt/win32asm/">http://sapp.telepac.pt/win32asm/</a><br /><br /><a target="_blank" href="http://groups.yahoo.com/group/win32-nasm-users/">http://groups.yahoo.com/group/win32-nasm-users/</a></div>
    <div class="meta">Posted on 2003-12-11 12:32:13 by Nguga</div>
   </div>
   <div class="post" id="post-127412">
    <div class="subject"><a href="#post-127412">Program Runs, Window doesnt Appear</a></div>
    <div class="body">thanks. perhaps there's hope for a future with nasm after all.<br />my whole stack manipulation is pretty stupid now that im looking at it.. i didnt really look at it before because i figured the problem would happen before WndProc.  :tongue: :notsure:</div>
    <div class="meta">Posted on 2003-12-11 12:44:37 by bnice2137</div>
   </div>
   <div class="post" id="post-127418">
    <div class="subject"><a href="#post-127418">Program Runs, Window doesnt Appear</a></div>
    <div class="body"><div class="quote"><br />The problem is in CreateWindowEx. Somehow the return value is 0 and the error code is ERROR_INVALID_WINDOW_HANDLE but I could not figure out why. </div><br /><br />A bit off topic, but it's strange we got different error codes from the same call.<br />Maybe because we used different OS vesions? :confused:<br />And anyway both error codes are absurd! :grin:</div>
    <div class="meta">Posted on 2003-12-11 14:14:09 by QvasiModo</div>
   </div>
   <div class="post" id="post-127422">
    <div class="subject"><a href="#post-127422">Program Runs, Window doesnt Appear</a></div>
    <div class="body">just posting using NASM without any proc macro<br /><br />%include &quot;\lab\vasm\inc\nagoa.inc&quot;<br /><br /><br /><br />AppName   db 'My First Window',0<br />ClassName db 'Simple WindowClass',0<br />wc resb WNDCLASSEX_size<br />msg resb MSG_size<br />hInstance dd 0 	<br />CommandLine dd	0<br />hParentWnd dd 0<br /><br /><br /><br />..start:<br />	push  0<br />	call GetModuleHandleA<br />	mov dword , eax<br />	invoke WinMain<br />	push eax<br />	call ExitProcess<br /><br />WinMain:<br />	mov dword ,WNDCLASSEX_size<br />	mov dword , CS_HREDRAW | CS_VREDRAW<br />	mov dword , WndProc<br />	mov dword , 0<br />	mov dword , 0<br />	mov dword eax, 	<br />	mov dword , eax<br />	mov dword , COLOR_WINDOW + 1<br />	mov dword , 0 <br />	mov dword , ClassName<br />	mov dword , 0<br />	push dword IDC_ARROW<br />	push dword <br />	call LoadCursorA<br />	mov dword , eax<br />	push dword IDI_APPLICATION<br />	push dword <br />	call LoadIconA<br />	mov dword , eax<br />	push wc	<br />	call RegisterClassExA<br />	push dword 0<br />	push dword <br />	push dword 0<br />	push dword 0<br />	push dword CW_USEDEFAULT<br />	push dword CW_USEDEFAULT<br />	push dword CW_USEDEFAULT<br />	push dword CW_USEDEFAULT<br />	push dword WS_CAPTION + WS_MAXIMIZEBOX + WS_MINIMIZEBOX + WS_SIZEBOX | WS_SYSMENU + WS_VISIBLE<br />	push dword AppName<br />	push dword ClassName<br />	push dword WS_EX_CLIENTEDGE + WS_EX_WINDOWEDGE<br />	call CreateWindowExA<br />	mov dword , eax<br />	push dword SW_SHOWDEFAULT<br />	push dword <br />	call ShowWindow<br />	push dword <br />	call UpdateWindow<br />       <br />       .MSGloop <br />       call GetMessage, msg, NULL, 0, 0 <br />       cmp eax, 0 <br />       je .fin <br />       call TranslateMessage, msg  <br />       call DispatchMessage, msg<br />       jmp .MSGloop <br />       .fin <br />       mov eax, dword<br />       ret <br /><br />  WndProc:<br />  push ebp<br />  mov ebp,esp<br />  mov eax, dword  <br />  cmp eax, WM_DESTROY<br />  jne .next_1 <br />  call PostQuitMessage, 0<br />  .next_1 <br />  call DefWindowProc, , , , <br />  mov esp,ebp<br />  pop ebp<br />  ret 16</div>
    <div class="meta">Posted on 2003-12-11 14:32:19 by Nguga</div>
   </div>
   <div class="post" id="post-127426">
    <div class="subject"><a href="#post-127426">Program Runs, Window doesnt Appear</a></div>
    <div class="body"><pre><code>call DefWindowProc, &#91;ebp+8&#93;, &#91;ebp+12&#93;, &#91;ebp+16&#93;,&#91;ebp+20&#93;</code></pre> <br />Didn't know NASM could do that. Isn't it the same as MASM's invoke? ;)</div>
    <div class="meta">Posted on 2003-12-11 14:49:40 by QvasiModo</div>
   </div>
   <div class="post" id="post-127449">
    <div class="subject"><a href="#post-127449">Program Runs, Window doesnt Appear</a></div>
    <div class="body">its a macro in NAGOA inc it also does this :<br /><br /><br /><br />call  MessageBox, 0, &quot;Assembler is easy.&quot;, &quot;NASM (Netwide Assembler)&quot;, 0<br /><br /><br />call WriteConsole, , {&quot;hello&quot;, 13, 10}, 7, n, 0<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><a target="_blank" href="http://www.artolindsay.com/invoke.htm">http://www.artolindsay.com/invoke.htm</a>   :)<br /><br /><br /><br /><br /><br />just found this links:<br /><br /><a target="_blank" href="http://www.gametutorials.com/Tutorials/Win32/Win32_Pg1.htm">http://www.gametutorials.com/Tutorials/Win32/Win32_Pg1.htm</a><br /><br /><a target="_blank" href="http://www.relisoft.com/win32/winnie.html">http://www.relisoft.com/win32/winnie.html</a></div>
    <div class="meta">Posted on 2003-12-11 18:11:05 by Nguga</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=16380&amp;page=1" style="">&laquo;</a><a href="../?id=16380&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="16380" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>