<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>The amusing code of conversion of hexadecimal character digi - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3789" />
    <link rel="next" href="../?id=3789&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=3789">The amusing code of conversion of hexadecimal character digi</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=3789&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=3789&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="3789" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=3789&amp;page=2">&gt;</a><a href="../?id=3789&amp;page=2">&raquo;</a></form>   <div class="post" id="post-25558">
    <div class="subject"><a href="#post-25558">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">; by Stepan Polovnikov<br />; al-char 			;; xx30. xx39 | xx41. xx46<br />	 aam 	 10h 	;; 0300. 0309 | 0401. 0406<br />	 aad 	 9 	;; 001B. 0024 | 0025. 002A<br />	 sub 	 al, 1Bh 	;; 0000. 0009 | 000A. 000F<br />Optimization of a size of the code.</div>
    <div class="meta">Posted on 2002-02-23 02:56:49 by Nexo</div>
   </div>
   <div class="post" id="post-25572">
    <div class="subject"><a href="#post-25572">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">Ha!<br />I finally can see it :)<br />Stepan is a very good asm programmer and my friend.<br />We spend a lot of time exchanging ideas and procs and given each<br />other puzzles to solve (BTW we both havilly use tbls).<br />The thing is that couple months ago he said that long ago he had<br />found solution how to convert HEX symbol to HEX digit unbranched way<br />by 6 clocks, and asked me if I was able to figure it out or may be write<br />faster.<br />The funny thing is that I found 4 clocks solution right away a sent it<br />to him. After that I didn't see his original solution until now - until<br />this very post of yours :)<br />(BTW when your first appiered here I thought that it may be Stepan<br />fooling me around :) )<br />My solution was:<br /><br />	cmp al,41h<br />	sbb  cl,cl<br />	sub  al,'A'-0Ah<br />	and  cl,7<br />	add  al,cl<br /><br />Stepa, eto ne ti chasom durish menya zdes?</div>
    <div class="meta">Posted on 2002-02-23 07:09:00 by The Svin</div>
   </div>
   <div class="post" id="post-25593">
    <div class="subject"><a href="#post-25593">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">What? :cool: We together work in one department in research institute of resources of computer technology.<br />Five more years back at university I saw his library of operation with hexadecimal digits.<br />Some lines:<br />macro _Hex2Asc<br />cmp al, 10 	;; cf=1 [00:09] cf=0 [0A:0F]<br />ifndef optSize<br />sbb ah, ah 	;; FF:FF-00:00<br />add al, '0' +7 	;; 37:40-41:45<br />and ah, 7 	;; 07:07-00:00<br />sub al, ah 	;; 30:39-41:45<br />else<br />sbb al, 69h 	;; 96:9F-A1:A5<br />das 		;; 30:39-41:45<br />endif<br />endm<br /><br />macro _Asc2Hex<br />ifndef optSize<br />cmp al, 'A' 	;; cf=1 [30:39] cf=0 [41:45]<br />sbb ah, ah 	;; FF:FF-00:00<br />add al, 10-'A' 	;; F9:02-0A:0F<br />and ah, 7 	;; 07:07-00:00<br />add al, ah 	;; 00:09-0A:0F<br />else<br />aam 10h 	;; 0300:0309-0401:0406 <br />aad 9 		;; 001B:0024-0025:002A <br />sub al, 1Bh 	;; 0000:0009-000A:000F <br />endif<br />endm<br /><br />It is the best code what I ever saw.</div>
    <div class="meta">Posted on 2002-02-23 11:08:50 by Nexo</div>
   </div>
   <div class="post" id="post-25610">
    <div class="subject"><a href="#post-25610">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">Say hellow from Shaska The Svin to him when you see him next<br />time.<br />Principles of the code shown was independnlty developed<br />by several developers over the world, which often happend<br />'cause usually we rare share knowlidge and communicate less<br />then rest of programmers world :)<br />For example working on replacing slow div instruction I figured out<br />how to do it with fraction mul. In couple years I read it Anger.hlp<br />where Fog called it Terje Mathisen method :)<br />I guessed we invented the same wheel :)<br />As to HEX to ASCII, there is something that might be<br />interest for you, I wrote it several years ago and still <br />find it usefull<br />Last three years I also see algos used my mask,<br />I have no idea if they took it from me or figured out independently<br />only in two of the algos the authors mentioned me :)<br /><br /><pre><code><br />OPTION PROLOGUE&#58;NONE<br />OPTION EPILOGUE&#58;NONE<br />fastadw proc<br />mov edx,eax<br />shl eax,4  <br />and edx,0FFFF0000h     	<br />mov ebx,eax<br />shr edx,12<br />and eax,0ff0h   <br />shr bh,4         <br />shr al,4        <br />and ebx,0f0f00h <br />mov ecx,edx<br />shl ebx,8       <br />add eax,06060606h <br />and edx,0ff0h<br />add ebx,eax	<br />shr ch,4<br />mov eax,ebx	<br />shr dl,4<br />and ebx,10101010h <br />and ecx,0f0f00h<br />shr ebx,4	<br />shl ecx,8<br />sub eax,ebx	<br />add edx,06060606h<br />shl ebx,3	<br />add eax,2a2a2a2ah <br />add ecx,edx<br />add eax,ebx	<br />mov edx,ecx<br />bswap eax	<br />;################################################<br />and ecx,10101010h<br />shr ecx,4<br />sub edx,ecx<br />shl ecx,3<br />add edx,2a2a2a2ah<br />add edx,ecx<br />bswap edx<br />ret<br />fastadw endp<br /><br />fastadwsz proc FORCENOFRAME<br />;dest&#58;DWORD<br /><br />call fastadw<br />mov ecx,dest<br />mov dword ptr &#91;ecx&#93;,edx<br />mov dword ptr &#91;ecx+4&#93;,eax<br />mov byte ptr &#91;ecx+8&#93;,0<br />ret 4<br />fastadwsz endp<br /><br />fastadws proc FORCENOFRAME<br />; dest&#58;DWORD<br />call fastadw<br />mov ecx,dest<br />mov dword ptr &#91;ecx&#93;,edx<br />mov dword ptr &#91;ecx+4&#93;,eax<br />ret 4<br />fastadws endp<br /><br />fastadwszsp proc FORCENOFRAME<br />;dest &#58;DWORD<br />call fastadw<br />mov ebx,dest<br />mov dword ptr &#91;ebx&#93;,edx<br />mov byte ptr &#91;ebx+4&#93;,' '<br />mov dword ptr &#91;ebx+5&#93;,eax<br />mov byte ptr &#91;ebx+9&#93;,0<br />ret 4<br />fastadwszsp endp<br /><br />OPTION PROLOGUE&#58;DefaultOption<br />OPTION EPILOGUE&#58;DefaultOption<br /></code></pre></div>
    <div class="meta">Posted on 2002-02-23 13:41:19 by The Svin</div>
   </div>
   <div class="post" id="post-25611">
    <div class="subject"><a href="#post-25611">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">As illustration what I meant here is  some articale I found<br />in inet (compare it with one of Stepa's algo)<br /><pre><code><br /><br />        cmp     al,10           ; if x &lt; 10, set CF = 1<br />        sbb     al,69h          ; 0-9&#58; 96h .. 9Fh,  A-F&#58; A1h..A6h<br />        das                     ; 0-9&#58; subtr. 66h -&gt; 30h-39h,<br />                                ; A-F&#58; subtr. 60h -&gt; 41h..46h<br /><br />                                                  Gem writer&#58; Norbert Juffa<br />                                                   last updated&#58; 1998-03-16<br /></code></pre><br /><br />To crearify Stepan's name in the issue :) I can say that the same<br />method I used in DOS progs dated 1997 when I had no idea who the hell is Norbert Juffa, The Gem writer :)<br />As for contest it was a couple months ago as I said, why Stepan<br />didn't say that he wrote already the simular code? <br />Maybe he was too disappointed that I figured out it in a fly :)<br />Srtange men we are, asm programmers - all I can say :)</div>
    <div class="meta">Posted on 2002-02-23 14:00:00 by The Svin</div>
   </div>
   <div class="post" id="post-25632">
    <div class="subject"><a href="#post-25632">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">Alex,<br /><br />I have been watching this discussion with some interest. I have an algorithm I am working on in<br />PowerBASIC inline assembler that must convert a byte to string and have a leading comma which is then appended to the end of and existing buffer.<br /><br />The way I am doing it is to fill up 4 bytes with padding, the comma then the ascii number and writing the DWORD to the end of the existing written data.<br /><pre><code><br />    --,9    1 digit<br />    -,99    2 digits<br />    ,199    3 digits<br /></code></pre><br />When I wrote this about 2 years ago, I mixed inline asm with high level functions and it works fine but i think I can get a measurable speed increase by doing the byte to ascii conversion on the fly and this is where the algos that have been discussd here appeal to me.<br /><br />Let me know what you think in terms of putting an ascii number into a DWORD memory location by doing high speed conversions on the fly.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-02-23 18:06:28 by hutch--</div>
   </div>
   <div class="post" id="post-25639">
    <div class="subject"><a href="#post-25639">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">It seems to be possible do fast, but I don't get the task clear.<br />What's need to be done?<br />In terms of:<br />Input? Output?</div>
    <div class="meta">Posted on 2002-02-23 19:18:43 by The Svin</div>
   </div>
   <div class="post" id="post-25658">
    <div class="subject"><a href="#post-25658">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">Alex,<br /><br />Sorry, I should have made more sense of it. The input is a BYTE in AL, the output I need is the string data for the ascii number in decimal written into a DWORD in normal string order as follows,<br /><pre><code><br />    --,9    1 digit<br />    -,99    2 digits<br />    ,199    3 digits<br /></code></pre><br />I can add the padding and comma myself. I post strip the padding in one pass which I am satisfied with, what I am trying to gain is not farming out the BYTE to an external ascii number conversion.<br /><br />I am using for an algo that outputs byte data as a sequence of DB statements,<br /><br />DB 1,2,3,4,5, etc ....<br /><br />Hope this makes sense.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-02-23 22:47:50 by hutch--</div>
   </div>
   <div class="post" id="post-25672">
    <div class="subject"><a href="#post-25672">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">Why you do not make the elementary sequential optimization of commands? The command &quot; and edx, 0FFFF0000h &quot; is absolutely not necessary.<br /><br />shld edx,eax,20<br />shl eax, 4 		<br />mov ebx, eax 		<br />mov ecx, edx 		<br />and eax, 0FF0h<br />and edx, 0FF0h<br />shr bh, 4<br />shr ch, 4<br />shr al, 4<br />shr dl, 4<br />and ebx, 0F0F00h<br />and ecx, 0F0F00h<br />shl ebx, 8<br />shl ecx, 8<br />add edx, ecx<br />add eax, ebx<br />lea ecx, <br />lea ebx, <br />shr ecx, 4<br />shr ebx, 4 	<br />and ecx, 1010101h<br />and ebx, 1010101h <br />sub edx, ecx<br />sub eax, ebx 	<br />lea edx, <br />lea eax, <br />bswap edx<br />bswap eax<br /><br />Relative decrease of clock ticks with 33 up to 24 (137.5 %).<br />But here it is a lot of delays for PPro (usage of registers of a various digit capacity).<br />Usage of the old scheme and MMX will give decrease of clock ticks with 33 up to 9 (336 %)<br />n09 	 dq 00909090909090909h<br />n07 	 dq 00707070707070707h<br />n37 	 dq 03737373737373737h<br /><br />bswap eax<br />shld ecx, eax, 32-4<br />and ecx, 0F0F0F0Fh<br />and eax, 0F0F0F0Fh<br />movd mm1, eax<br />movd mm0, ecx<br />punpcklbw mm0, mm1<br />movq mm1, mm0<br />pcmpgtb mm1, <br />paddb mm0, <br />pandn mm1, <br />psubb mm0, mm1<br />movq , mm0</div>
    <div class="meta">Posted on 2002-02-24 03:09:27 by Nexo</div>
   </div>
   <div class="post" id="post-25678">
    <div class="subject"><a href="#post-25678">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">The Svin, Stepan spoke, that this code<br />cmp al, 10<br />sbb al, 69h<br />das<br />Was taken from Dr. Dobb`s Journal August 1990 (Letters).<br />Really this code it was mentioned in some source file somewhere 1984. <br />;)</div>
    <div class="meta">Posted on 2002-02-24 04:29:42 by Nexo</div>
   </div>
   <div class="post" id="post-25697">
    <div class="subject"><a href="#post-25697">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body"><strong>Nexo</strong>, you can also do a qword in 9 cycles on Athlon. :)<br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=3801">http://www.asmcommunity.net/board/index.php?topic=3801</a><br /><br />Cycle per cycle the Athlon beats any IA-32 chip - 24 instructions in 9 cycles is pretty good! :)  To do this the loop alignment must be ((($ + 15) AND -16) + 7).  Otherwise, it can take up to 3 cycles more per iterration!</div>
    <div class="meta">Posted on 2002-02-24 09:53:34 by bitRAKE</div>
   </div>
   <div class="post" id="post-25702">
    <div class="subject"><a href="#post-25702">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">Hi, bitRAKE.<br /><br />I have made some analysis of the code for processor AthlonXP.<br />; 	 movq mm4, <br />; 	 movq mm5, <br />; 	 movq mm6, <br />; 	 movq mm7, <br /><br />	 movq mm0,  	; +1 clk<br />	 add eax, 8<br />	 add edx, 16<br />	 dec ecx 		; +1 clk<br />	 movq mm1, mm0<br />	 psrlq mm0,4 	; +1 clk<br />	 pand mm1, mm4<br />	 pand mm0, mm4<br />	 paddb mm1, mm5 	; +1 clk<br />	 paddb mm0, mm5<br />	 movq mm3, mm1 	; +1 clk<br />	 movq mm2, mm0 	; +1 clk<br />	 pcmpgtb mm3, mm6 	; +1 clk<br />	 pcmpgtb mm2, mm6<br />	 psubusb mm3, mm7 	; +2 clk<br />	 psubusb mm2, mm7<br />	 paddb mm1, mm3 	; +2 clk<br />	 paddb mm0, mm2<br />	 movq mm2, mm0 	; +2 clk<br />	 punpckhbw mm0, mm1; +1 clk<br />	 punpcklbw mm2, mm1; +1 clk<br />	 movq , mm0<br />	 movq , mm2; +2 clk<br />Total 17 clock ticks.<br /><br />Below my alternative of the code follows.<br />; 	 movq mm4, <br />; 	 movq mm5, <br />; 	 movq mm6, <br />; 	 movq mm7, <br /><br />	 movq mm0,  	; +1 clk<br />	 add eax, 8<br />	 add edx, 16<br />	 dec ecx 		; +1 clk<br />	 movq mm1, mm0<br />	 psrlq mm0,4 	; +1 clk<br />	 pand mm1, mm4<br />	 pand mm0, mm4<br />	 movq mm3, mm1 	; +1 clk<br />	 movq mm2, mm0<br />	 pcmpgtb mm3, mm5 	; +1 clk<br />	 pcmpgtb mm2, mm5 	; +1 clk<br />	 paddb mm1, mm6<br />	 paddb mm0, mm6<br />	 pandn mm3, mm7 	; +1 clk<br />	 pandn mm2, mm7<br />	 psubb mm1, mm3 	; +2 clk<br />	 psubb mm0, mm2<br />	 movq mm2, mm0 	; +2 clk<br />	 punpckhbw mm0, mm1; +1 clk<br />	 punpcklbw mm2, mm1; +1 clk<br />	 movq , mm0<br />	 movq , mm2; +2 clk<br />Total 15 clock ticks.<br /><br />My code has less dependences of registers and as a result 2 clock ticks are released.</div>
    <div class="meta">Posted on 2002-02-24 11:39:49 by Nexo</div>
   </div>
   <div class="post" id="post-25703">
    <div class="subject"><a href="#post-25703">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">Nexo, having tested both, they perform the same?  Both have the alignment problem as well.  They are 72 bytes long - the decode bandwidth is at maximum when performing at 9 clock cycles.  It will not get faster than that without getting smaller.   There are 6 groups of 3 instructions, and 3 groups of two instructions.  Here is a picture of the decode part:</div>
    <div class="meta">Posted on 2002-02-24 12:24:12 by bitRAKE</div>
   </div>
   <div class="post" id="post-25704">
    <div class="subject"><a href="#post-25704">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">After the instructions are decoded, then the processor rearranges them to reduce dependancies.  Your algo is technically better, but the processor does that for me.</div>
    <div class="meta">Posted on 2002-02-24 12:28:42 by bitRAKE</div>
   </div>
   <div class="post" id="post-25718">
    <div class="subject"><a href="#post-25718">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">bitRAKE, I tested only linear execution (without cycle). I made real measurements of execution of the code. They were confirmed with programs &quot; VTune (TM) Performance Analyzer &quot; and &quot; AMD CodeAnalyst &quot;. <br />1. You in one group have dependences which do not allow to be executed to group for one clock tick. Even it is not possible.<br />2. In the document &quot; AMD Athlon Processor x86 Code Optimization Guide &quot; (pages 289-292) can be seen, that MMX commands are executed for two clock ticks in the block of execution! <br />3. AMD the processor has physically two blocks of execution MMX (AMD Athlon Processor Technical Brief, page 3), therefore on two clock ticks can be executed two MMX commands if is not present dependence.<br />4. Three commands are simultaneously executed only in blocks of execution of integer operations (IEU/ALU), but MMX commands are executed in blocks FADD/MMX and FMUL/MMX.<br /><br />Therefore yours 9 clock ticks are erratic.</div>
    <div class="meta">Posted on 2002-02-24 14:17:31 by Nexo</div>
   </div>
   <div class="post" id="post-25719">
    <div class="subject"><a href="#post-25719">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">Hi, hutch--.<br />As a first approximation my code of your task looks so:<br />; Input: al-number<br />; Output: eax-chars<br />	 movzx 	 eax, al<br />	 cmp 	 eax, 10<br />	 jb 	 @@ 1<br />	 mov 	 ecx, '-,'shl 16<br />	 cmp 	 eax, 100<br />	 jb 	 @@ 10<br />	 mov 	 edx, 51EB851Fh<br />	 mov 	 ebx, eax<br />	 mul 	 edx<br />	 shr 	 edx, 5<br />	 imul 	 eax, edx,-100<br />	 lea 	 ecx, <br />	 add 	 eax, ebx<br />	 shl 	 ecx, 16<br />@@ 10:<br />	 mov 	 edx, 0CCCCCCCDh<br />	 mov 	 ebx, eax<br />	 mul 	 edx<br />	 shr 	 edx, 3<br />	 imul 	 eax, edx,-10<br />	 shl 	 edx, 8<br />	 add 	 eax, ebx<br />	 lea 	 ecx, <br />	 add 	 eax, ecx<br />	 bswap 	 eax<br />	 ret<br />@@ 1:<br />	 shl 	 eax, 24<br />	 add 	 eax, ' 0,--'<br />	 ret</div>
    <div class="meta">Posted on 2002-02-24 14:18:36 by Nexo</div>
   </div>
   <div class="post" id="post-25722">
    <div class="subject"><a href="#post-25722">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">Hutch, I have absolutely forgotten about the best alternative :) , that it is possible to use the table with a size in 1 Kilobytes.<br />movzx eax, al<br />mov eax, </div>
    <div class="meta">Posted on 2002-02-24 14:43:10 by Nexo</div>
   </div>
   <div class="post" id="post-25724">
    <div class="subject"><a href="#post-25724">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body"><div class="quote">Hope this makes sense. </div> <br />Last question: unsigned? (in your example was 199,<br />I assume unsigned. Right?</div>
    <div class="meta">Posted on 2002-02-24 15:28:02 by The Svin</div>
   </div>
   <div class="post" id="post-25730">
    <div class="subject"><a href="#post-25730">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body">Alex, Nexo,<br /><br />A friend of mine, Jibz dug up an algo he had which more or less did the job perfectly, it took the BYTE data in AL and wrote the output to  which saved me doing the register transfer I had done when interfacing with a number of HLL routines.<br /><br />This is the code below, the slight notation difference is because it is PowerBASIC inline asm.<br /><pre><code><br />' @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br /><br />        ! push ecx<br /><br />        ! xor ecx, ecx<br />      more1&#58;<br />        ! aam<br />        ! push eax<br />        ! inc ecx<br />        ! shr ax, 8<br />        ! jnz more1<br />      more2&#58;<br />        ! pop eax<br />        ! add al, &amp;H30<br />        ! stosb<br />        ! loop more2<br /><br />        ! mov al, &quot;,&quot;    ; formatting<br />        ! stosb<br /><br />        ! pop ecx<br /><br />' @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br /></code></pre><br />he also gave me another one that he thought was probably faster but the quantum leap in performance was done by this one. It is plugged in the middle of a very messy algo that loads a file, sequentialy reads through it, converts each byte to its ascii equivalent, formats it in rows of 16 ascii bytes and trims the end of the buffer at the correct length.<br /><br />When I get the time, I would like to rewrite the complete algo as it was based on a different set of asumptions when I first wrote it and I think there are still some performance gains left in doing so.<br /><br />Regards &amp; thanks to both for your effort.<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-02-24 16:44:11 by hutch--</div>
   </div>
   <div class="post" id="post-25745">
    <div class="subject"><a href="#post-25745">The amusing code of conversion of hexadecimal character digi</a></div>
    <div class="body"><div class="quote"><br />Therefore yours 9 clock ticks are erratic. </div>Yes, I have read the same material many times - I don't believe all that I have read.  I tested 4,000 times loop with average of 9 cycles - I don't think this is 'erratic'?  I will do a more thorough test - I need to know what is really taking place within the CPU.  I have many questions that I must answer for my own code analysis program.  The picture above is just the decode, not the execution - I know those groupings can not execute together.  <em>Please read the sentence before the picture!</em>  Do you know why it must be aligned at 16+7 to get this speed?<div class="quote"><u>Instruction Control Unit</u><br />The instruction control unit (ICU) is the control center for the AMD Athlon processor. The ICU controls the following resources?the centralized in-flight reorder buffer, the integer scheduler, and the floating-point scheduler. In turn, the ICU is responsible for the following functions?MacroOP dispatch, MacroOP retirement, register and flag dependency resolution and renaming, execution resource management, interrupts, exceptions, and branch mispredictions.<br /><br />The ICU takes the three MacroOPs per cycle from the early decoders and places them in a centralized, fixed-issue reorder buffer. This buffer is organized into 24 lines of three MacroOPs each. The reorder buffer allows the ICU to track and monitor up to 72 in-flight MacroOPs (whether integer or floating-point) for maximum instruction throughput. The ICU can simultaneously dispatch multiple MacroOPs from the reorder buffer to both the integer and floating-point schedulers for final decode, issue, and execution as OPs. In addition, the ICU handles exceptions and manages the retirement of MacroOPs.</div>Above is the part that interests me.<br /><br />Also if you look at page 231, Table 4, you will see that all three execution units can process MMX instructions - this is in document 22007J - August 2001.  So you are quite plainly wrong about only 2 MMX instructions executing at once.  :)</div>
    <div class="meta">Posted on 2002-02-24 18:37:50 by bitRAKE</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=3789&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=3789&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="3789" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=3789&amp;page=2">&gt;</a><a href="../?id=3789&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>