<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Re: Resource Injection? (Dll, can you RE?) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19353" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19353">Re: Resource Injection? (Dll, can you RE?)</a></p>
   <div class="post" id="post-149348">
    <div class="subject"><a href="#post-149348">Re: Resource Injection? (Dll, can you RE?)</a></div>
    <div class="body">Hi all,<br /><br />Branching off on the topic of Resource Injection where Blastersoft asked about inserting an OBJ file into an Executable. Well i have a similar question.<br /><br />Suppose you create a dll and place all of your sensitive code inside and then placing that in as a resource... would that not prove in any sence better? I mean the wrapper exe will load up the dll and your wrapper exe contains all the functional calls. So even if they dissamble your exe the code that is needed will recided inside the dll.<br /><br />But what i am really askin is when a dll is constructed is only the exported functions are listed? So making calls internally in the dll should cause some trouble for some ppl. I remember a post about some1 trying to dissemble a dll and needed to know about stack returns.<br /><br />A general plus about this might be the fact that project maintenace is devided nicely into the Visual aspect and the Implementation aspect if you are using an algorythmic approach to resolve a problem.<br /><br />Thus generally debugging might be a bi*ch but hell if it is difficult for you then it certanly gets difficult for others.<br /><br />On another note, in C++ there are private and public classes -- so hiding the code again by using these methods will prove even more trouble some, right? (Now where is the asm equavilent method? As i am as of yet not a ASM god @ all).<br /><br />So yay or nay.... good idea or bad, and if so please say why.<br /><br />Black iCE</div>
    <div class="meta">Posted on 2004-09-08 07:29:31 by Black iCE</div>
   </div>
   <div class="post" id="post-149355">
    <div class="subject"><a href="#post-149355">Did a search and found this sofar...</a></div>
    <div class="body">Ok, i did a search on RE + Dll and didn't find much. This is from a person running a personal project that makes me google with the prospect that my first post here could be a valid idea.<br /><br />from the FAQ section:<br /><div class="quote"><br />4. <strong>Another tool being planned.</strong> <br />It would be nice to take a lib or .dll and be able to watch it being accessed. One way to do this would be to provide a tool that would take a .dll and replace it with a new .dll. This new .dll would be a version of the revenge emulator that would act exactly the same as the original .dll, by running the original .dll in the emulator, but at the same time storing a complete record log of all activity in each .dll call from the calling application.</div><br />Link to the site: http://revenge.berlios.de/faq.php<br /><br />As of yet i havn't found any tutorial on how to RE into a dll. Suppose this is one of the many why windows system is mainly dll's.</div>
    <div class="meta">Posted on 2004-09-08 08:18:36 by Black iCE</div>
   </div>
   <div class="post" id="post-149358">
    <div class="subject"><a href="#post-149358">Re: Resource Injection? (Dll, can you RE?)</a></div>
    <div class="body"><div class="quote">As of yet i havn't found any tutorial on how to RE into a dll. Suppose this is one of the many why windows system is mainly dll's.</div><br /><br />That does not mean it is not possible. In fact it is possible and is quite easy.</div>
    <div class="meta">Posted on 2004-09-08 08:34:56 by roticv</div>
   </div>
   <div class="post" id="post-149360">
    <div class="subject"><a href="#post-149360">Re: Resource Injection? (Dll, can you RE?)</a></div>
    <div class="body">I don't deny that it is not possible, i was grasping so that more towards the fact that if done properly that it should be one of the easiest ways to prevent just above avarage joe from making hell out of your work. You can still compress the resulted exe. Even use some algorythmic (encrypting/checksuming) ways when the dll is accessed by other processes to verify wheter the ATOM class justify access to it or not (internally)... So this idea can be expanded easily with little re-coding effort. That is if you can fiqure out which process is not your app, and you if you can see whether an attempt had been made to access the dll.<br /><br />As i have stated before that i am not an asm fundi of note, but hopefully the specific methods availible today will makes things more compilcated for today's attackers.<br /><br />But then again, i don't really know the internal workings of a dll. I know it is used to load up reusable code. It is desighned so that process can access it. And i suppose that you will be able to trace stright from the exe into the dll... that will be a problem - cause it is your valid exe calling the dll.<br /><br />Aah hell, i supose i'll just use this method to make my life easier with updating and maintaining an app.<br /><br />I suppose the above menthod method might be able to help detect if your app has been modified, until the point where that is taken away.</div>
    <div class="meta">Posted on 2004-09-08 08:42:28 by Black iCE</div>
   </div>
   <div class="post" id="post-149364">
    <div class="subject"><a href="#post-149364">Re: Resource Injection? (Dll, can you RE?)</a></div>
    <div class="body">dlls are absolutely the same as exes, they're both PE, dlls are flagged, to let the peloader know, DLLs are usually mapped around 0x10000, whereas exes normally mapped at 0x400000. an extra field, DllCharacteristics, defines some extended settings for DLL, and all DLLs have relocs. it's all PE.</div>
    <div class="meta">Posted on 2004-09-08 10:15:10 by Drocon</div>
   </div>
   <div class="post" id="post-149366">
    <div class="subject"><a href="#post-149366">Re: Resource Injection? (Dll, can you RE?)</a></div>
    <div class="body">Then what makes dll patching so much more difficult to make than exe's?<br />I know it is possible, but why does usually take longer to do?</div>
    <div class="meta">Posted on 2004-09-08 10:35:58 by Black iCE</div>
   </div>
  </div>
 </body>
</html>