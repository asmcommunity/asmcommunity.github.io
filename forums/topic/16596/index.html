<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Convert SOCK to IP address - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16596" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=16596">Convert SOCK to IP address</a></p>
   <div class="post" id="post-129017">
    <div class="subject"><a href="#post-129017">Convert SOCK to IP address</a></div>
    <div class="body">How to do that with winsock1.1?</div>
    <div class="meta">Posted on 2003-12-26 23:38:39 by optimus</div>
   </div>
   <div class="post" id="post-129047">
    <div class="subject"><a href="#post-129047">Convert SOCK to IP address</a></div>
    <div class="body">socket means (IP+PORT) UDP or TCP <br /><br />4 example: 110.110.10.11:644 tcp and 110.110.10.11:644 udp are two different sockets</div>
    <div class="meta">Posted on 2003-12-27 05:14:34 by etn</div>
   </div>
   <div class="post" id="post-129066">
    <div class="subject"><a href="#post-129066">Convert SOCK to IP address</a></div>
    <div class="body">I mean the handle of a socket, or hSock.</div>
    <div class="meta">Posted on 2003-12-27 10:45:26 by optimus</div>
   </div>
   <div class="post" id="post-129102">
    <div class="subject"><a href="#post-129102">Convert SOCK to IP address</a></div>
    <div class="body">optimus,<br /><br />use getpeername()<br /><br />ancev</div>
    <div class="meta">Posted on 2003-12-27 15:58:57 by ancev</div>
   </div>
   <div class="post" id="post-129136">
    <div class="subject"><a href="#post-129136">Convert SOCK to IP address</a></div>
    <div class="body">i can't work successfully with this API (always get a incorrent result). any proved code can be given?</div>
    <div class="meta">Posted on 2003-12-28 04:06:52 by optimus</div>
   </div>
   <div class="post" id="post-129179">
    <div class="subject"><a href="#post-129179">Convert SOCK to IP address</a></div>
    <div class="body">You are looking at the wrong element - try looking closer at the sockaddr_in structure with which your socket handle is associated.</div>
    <div class="meta">Posted on 2003-12-28 16:45:19 by Homer</div>
   </div>
   <div class="post" id="post-129194">
    <div class="subject"><a href="#post-129194">Convert SOCK to IP address</a></div>
    <div class="body">i guess so.<br />any code?</div>
    <div class="meta">Posted on 2003-12-28 19:46:23 by optimus</div>
   </div>
   <div class="post" id="post-129235">
    <div class="subject"><a href="#post-129235">Convert SOCK to IP address</a></div>
    <div class="body">If you want source, you should search the board.<br />You don't need to use GetPeerName at all.<br />Firstly, if the socket is a client socket connected to a remote server, you ALREADY know the server ip since you connected to it.<br />Secondly, if the socket is a server socket with a remote client connecting, then Accept has already put their ip address in the sin_addr.S_un.S_addr field of the sockaddr_in structure.<br />The ONLY time you need to use GetPeerName is when you want to look at the remote address BEFORE calling Accept, for example if you wish to deny connection to a certain ip or block of ip addresses.<br />Have a nice day :)</div>
    <div class="meta">Posted on 2003-12-29 05:59:20 by Homer</div>
   </div>
   <div class="post" id="post-129334">
    <div class="subject"><a href="#post-129334">Convert SOCK to IP address</a></div>
    <div class="body">then after ACCEPT the sock<br />what should be done to retrieve the IP address?</div>
    <div class="meta">Posted on 2003-12-29 23:45:20 by optimus</div>
   </div>
   <div class="post" id="post-129337">
    <div class="subject"><a href="#post-129337">Convert SOCK to IP address</a></div>
    <div class="body">fetch the dword value from sockaddr_in.sin_addr.S_un.S_addr, thats the ip address stored as a dword. Each byte in the dword represents one of the four parts of the ip address.</div>
    <div class="meta">Posted on 2003-12-30 00:19:13 by Homer</div>
   </div>
   <div class="post" id="post-129338">
    <div class="subject"><a href="#post-129338">Convert SOCK to IP address</a></div>
    <div class="body">i tried, but there is some problem<br /><br />when i do like this:<br /><br /><pre><code><br />	invoke	accept,cfg.hSocket,0,0<br /></code></pre><br />it worked just fine<br /><br />when i do like this:<br /><pre><code><br />LOCAL inaddr&#58;sockaddr_in<br />invoke	accept,cfg.hSocket,addr inaddr,sizeof inaddr<br /></code></pre><br />no socket can be accepted. why?</div>
    <div class="meta">Posted on 2003-12-30 00:33:21 by optimus</div>
   </div>
  </div>
 </body>
</html>