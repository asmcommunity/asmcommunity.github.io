<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>GDI32 functions with &quot;W&quot; - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5561" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=5561">GDI32 functions with &quot;W&quot;</a></p>
   <div class="post" id="post-39584">
    <div class="subject"><a href="#post-39584">GDI32 functions with &quot;W&quot;</a></div>
    <div class="body">Hi, Hutch<br /><br />   I wrote a DLL in MASM32, I use it this file for to print in a Laser Printer, Matrix and BubleJet, When I use it in Windows95/98 this program print and works very good, but in Windows XP doesn't print, the documents only appears in Spooling list, but that's all. <br /><br />I saw the NotePad.exe prints without problems, and I opened this file &quot;NotePad.exe&quot; with W32Dasm893 and I saw it use olny functions with &quot;W&quot; like CreateDCW, CreateFontW and StartDocW.<br /><br />The file GDI32.Inc in \MASM32\INCLUDE directory has not these functions declared into it, also it has not the DEVMODEW declared.<br /><br /><br />   Please help me, because I need to export my programs to WINDOWS XP.<br /><br /><br />     Regards<br /><br />         YunKaX32Bits</div>
    <div class="meta">Posted on 2002-05-23 17:12:02 by YunKaX32Bits</div>
   </div>
   <div class="post" id="post-39615">
    <div class="subject"><a href="#post-39615">GDI32 functions with &quot;W&quot;</a></div>
    <div class="body">YunKa,<br /><br />The API functions that end with &quot;W&quot; are unicode versions. If you are running an OS version that supports unicode, you can create a full set of include files with the utility l2incW.exe that comes with MASM32.<br /><br />The examples and library that come with MASM32 are all ANSI so if you want to use full unicode, you will have to start from scratch.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-05-23 21:17:20 by hutch--</div>
   </div>
   <div class="post" id="post-39691">
    <div class="subject"><a href="#post-39691">To Hutch, About Printing in Windows XP</a></div>
    <div class="body">Hello, Hutch<br /><br /><br />   Thank you for your answer, but I need to know, how I can to print in Windows XP without problems like to Windows98, Because my print program in MASM32 has not problems in Windows98, only in Windows XP and I told you about &quot;W&quot; functions because I was thinking in this solutions, but If you know another solutions please let me know which is the correct struture for to print from MASM32 in Windows XP, Because I'm tryed with print examples from Ron's Cornucopia and Test, and these examples aren't work too.<br /><br />If you want and if you have time, I will send you my DLL and let me know why the program prints in Windows95/98, but not in Windows XP.<br /><br />I'm using this struture for to print:<br /><br />   lcHDC=CreateDC(lcPrinterName)<br />            =StartDoc(lcHDC)<br />            =StartPage(lcHDC)<br /><br />                   Printing Data<br /><br />            =EndPage(lcHDC)<br />            =EndDoc(lcHDC)<br />            =DeleteDC(lcHDC)<br /><br />Regards and Thank you,</div>
    <div class="meta">Posted on 2002-05-24 09:31:05 by YunKaX32Bits</div>
   </div>
  </div>
 </body>
</html>