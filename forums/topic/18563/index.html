<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Batch Files - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18563" />
    <link rel="next" href="../?id=18563&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=18563">Batch Files</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=18563&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=18563&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="18563" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=18563&amp;page=2">&gt;</a><a href="../?id=18563&amp;page=2">&raquo;</a></form>   <div class="post" id="post-143699">
    <div class="subject"><a href="#post-143699">Batch Files</a></div>
    <div class="body">Quick question:<br /><br />Can i somehow set a property for a batch file, such that any file i drag over it will act as its %1 property...?<br /><br /><br />For example:<br /><br />Build.Bat.  If i drag say MyAsm.Asm onto the Bat file in the directory, can i set some flag such that %1 in the Bat file is &quot;MyAsm.Asm&quot; ??<br /><br /><br />Regards,<br />:NaN:</div>
    <div class="meta">Posted on 2004-06-13 19:44:11 by NaN</div>
   </div>
   <div class="post" id="post-143700">
    <div class="subject"><a href="#post-143700">Batch Files</a></div>
    <div class="body">Yes, that is how it already works. For example I tried this...<br /><br />echo %1<br />pause<br /><br />and it displayed the name of the file dropped onto it's icon.</div>
    <div class="meta">Posted on 2004-06-13 20:13:01 by donkey</div>
   </div>
   <div class="post" id="post-143703">
    <div class="subject"><a href="#post-143703">Batch Files</a></div>
    <div class="body">Thats what i thought would happen, but i tried it with my XP machine and doesnt respond.<br /><br />To be honest, i have a number of *issues* with the CMD and Batch uses with this OS version.  For one, i can't find anyway of keeping the window open after runing a batch file (so i can read its output).  I have to run batches only from a CMD window if i need to know outputs.  Another problem is there appears to be no way of specifying the start up directory when your Run-&gt;CMD.EXE so you have to directory surf to where your working.<br /><br />This all use to be so much simpler on Win98.  <br /><br />Regards,<br />:NaN:</div>
    <div class="meta">Posted on 2004-06-13 20:18:07 by NaN</div>
   </div>
   <div class="post" id="post-143704">
    <div class="subject"><a href="#post-143704">Batch Files</a></div>
    <div class="body"><div class="quote"><br />Thats what i thought would happen, but i tried it with my XP machine and doesnt respond.<br /><br />To be honest, i have a number of *issues* with the CMD and Batch uses with this OS version.  For one, i can't find anyway of keeping the window open after runing a batch file (so i can read its output).  I have to run batches only from a CMD window if i need to know outputs.  Another problem is there appears to be no way of specifying the start up directory when your Run-&gt;CMD.EXE so you have to directory surf to where your working.<br /><br />This all use to be so much simpler on Win98.  <br /><br />Regards,<br />:NaN: </div><br /><br />Put &quot;pause&quot; at the end of the batch file. That will let you see the output.<br />Bye.</div>
    <div class="meta">Posted on 2004-06-13 20:22:17 by GogetaSSJ4</div>
   </div>
   <div class="post" id="post-143705">
    <div class="subject"><a href="#post-143705">Batch Files</a></div>
    <div class="body">Funny, I would have thought that XP would be the same as Win2K which is what I used. Just to make sure I tried it on NT4/95 and 98SE and it worked properly on all of them. Pretty stupid if they broke it for XP.</div>
    <div class="meta">Posted on 2004-06-13 20:24:26 by donkey</div>
   </div>
   <div class="post" id="post-143712">
    <div class="subject"><a href="#post-143712">&quot;</a></div>
    <div class="body"><div class="quote"><br />Another problem is there appears to be no way of specifying the start up directory when your Run-&gt;CMD.EXE so you have to directory surf to where your working.</div><br /><br />Maybe you would find the &quot;Open Command Window Here&quot; Powertoy from MS useful:<br /><br /><a target="_blank" href="http://www.microsoft.com/windowsxp/pro/downloads/powertoys.asp">http://www.microsoft.com/windowsxp/pro/downloads/powertoys.asp</a><br /><a target="_blank" href="http://download.microsoft.com/download/whistler/Install/2/WXP/EN-US/CmdHerePowertoySetup.exe">http://download.microsoft.com/download/whistler/Install/2/WXP/EN-US/CmdHerePowertoySetup.exe</a></div>
    <div class="meta">Posted on 2004-06-13 22:01:17 by stormix</div>
   </div>
   <div class="post" id="post-143714">
    <div class="subject"><a href="#post-143714">Batch Files</a></div>
    <div class="body">Thanks for your help.  While ultimately it was my error, your replies assured me that there must be something deeping going on.  And there was...  It *appeared* that the drag &amp; drop batch file was not working because the batch file i wrote was far more complicated than the simple &quot;echo %1&quot;.  Turned out it was how i format and evaulate the parameters that fooled me.  That and the fact the window doesnt stick around long enought to clearly get a read on it :rolleyes:<br /><br /><br />As for the power tools link, Thanks alot! It sounds just like what im looking for!<br /><br />:alright:<br />:NaN:</div>
    <div class="meta">Posted on 2004-06-13 23:10:08 by NaN</div>
   </div>
   <div class="post" id="post-143715">
    <div class="subject"><a href="#post-143715">Batch Files</a></div>
    <div class="body">Hi NaN,<br /><br />I use Delight's registry hack for the Command Prompt Here...<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=12855">http://www.asmcommunity.net/board/index.php?topic=12855</a></div>
    <div class="meta">Posted on 2004-06-13 23:28:29 by donkey</div>
   </div>
   <div class="post" id="post-143716">
    <div class="subject"><a href="#post-143716">Batch Files</a></div>
    <div class="body">Thanks Donkey, I forgot about that link... Its perfect.  Now if i can only somehow set the window to not close automatically after running a batch file.. i would be set ;)<br /><br />Regards,<br />:NaN:</div>
    <div class="meta">Posted on 2004-06-13 23:46:38 by NaN</div>
   </div>
   <div class="post" id="post-143726">
    <div class="subject"><a href="#post-143726">Batch Files</a></div>
    <div class="body">properties-&gt;advanced dos settings or something &quot;don't close on exit&quot;  (don't have a windows here to check but that's how it's done)</div>
    <div class="meta">Posted on 2004-06-14 02:59:36 by Hiroshimator</div>
   </div>
   <div class="post" id="post-143743">
    <div class="subject"><a href="#post-143743">Batch Files</a></div>
    <div class="body"><div class="quote"><br />Another problem is there appears to be no way of specifying the start up directory when your Run-&gt;CMD.EXE so you have to directory surf to where your working.<br /></div><br />You can set your &quot;home directory&quot; - I can't remember the registry path nor if you can change it with Tweak UI, but it exists, and does exactly what you want. Also, Command Prompt Here is nice :)<br /><br /><div class="quote"><br />Now if i can only somehow set the window to not close automatically after running a batch file.. i would be set <br /></div><br />Just run &quot;pause&quot; from the batch file<br /><br /><div class="quote"><br />properties-&gt;advanced dos settings or something &quot;don't close on exit&quot; (don't have a windows here to check but that's how it's done)<br /></div><br />Hiro, I'm afraid that doesn't work on NT - certainly can't find it for cmd.exe, and dos apps are something quite different :)</div>
    <div class="meta">Posted on 2004-06-14 08:59:12 by f0dder</div>
   </div>
   <div class="post" id="post-143757">
    <div class="subject"><a href="#post-143757">Batch Files</a></div>
    <div class="body">I would rather not have to modify all my batch files to suit the XP philosophy if i can.<br /><br />Regards,<br />:NaN:</div>
    <div class="meta">Posted on 2004-06-14 11:42:28 by NaN</div>
   </div>
   <div class="post" id="post-143760">
    <div class="subject"><a href="#post-143760">Batch Files</a></div>
    <div class="body">It's not XP philosophy, NT has been that way all along afaik. The idea is somewhat logical I guess - when an application terminates, you expect it to terminate, not stick around. Keeping the console window open would mean &quot;sticking around&quot;. Furthermore, the general idea is that you run GUI apps, and if you run console apps you run them from a cmd.exe shell, where you can see the output even after the app is gone.<br /><br />But sure, it would have been nifty if there was some &quot;stick around until I close the console window if not launched from a parent console app&quot; option. You could workaround by writing a console-mode application that executes cmd.exe with batch file as argument, but doesn't close it's main window, and then change the filetype handler for .bat from cmd.exe to your app...</div>
    <div class="meta">Posted on 2004-06-14 11:56:20 by f0dder</div>
   </div>
   <div class="post" id="post-143774">
    <div class="subject"><a href="#post-143774">Batch Files</a></div>
    <div class="body">I used it for mom, why wouldn't it work for anything else dos?  :notsure: (and I used 2K)</div>
    <div class="meta">Posted on 2004-06-14 13:12:19 by Hiroshimator</div>
   </div>
   <div class="post" id="post-143782">
    <div class="subject"><a href="#post-143782">Batch Files</a></div>
    <div class="body">Hiro, there was such an option in Win9x, but I haven't seen it in 2k or xp... unless you're talking about something obscure like making a schortcut to command.com and having special parms there (and *yuck* running command.com when you have cmd.exe ...)</div>
    <div class="meta">Posted on 2004-06-14 13:33:36 by f0dder</div>
   </div>
   <div class="post" id="post-143818">
    <div class="subject"><a href="#post-143818">Batch Files</a></div>
    <div class="body"><div class="quote"><br />It's not XP philosophy, NT has been that way all along afaik. The idea is somewhat logical I guess - when an application terminates, you expect it to terminate, not stick around. Keeping the console window open would mean &quot;sticking around&quot;. Furthermore, the general idea is that you run GUI apps, and if you run console apps you run them from a cmd.exe shell, where you can see the output even after the app is gone.<br /><br />But sure, it would have been nifty if there was some &quot;stick around until I close the console window if not launched from a parent console app&quot; option. You could workaround by writing a console-mode application that executes cmd.exe with batch file as argument, but doesn't close it's main window, and then change the filetype handler for .bat from cmd.exe to your app... </div><br /><br />Looks like i have somethimg to do the.... (seing my wish list thread is not working out as well as planned)<br /><br />:NaN:</div>
    <div class="meta">Posted on 2004-06-14 15:44:36 by NaN</div>
   </div>
   <div class="post" id="post-144270">
    <div class="subject"><a href="#post-144270">Batch Files</a></div>
    <div class="body">Another Q:<br /><br />I've been scouring the net, but cant seem to get a straight answer.  <br /><br />Is there a way to String Process the %1 variable in a batch file?<br /><br />If you drag &amp; Drop a file onto a batch file, %1 will == &quot;Drive:\Path\Filename.ext&quot;, and i need to process it to drop the extension.  Is this possible?  I did read NT/2000/XP will handle this, but i was hoping to make the batch file universal to NT/9X based systems...<br /><br />Regards,<br />:NaN:</div>
    <div class="meta">Posted on 2004-06-19 13:03:44 by NaN</div>
   </div>
   <div class="post" id="post-144274">
    <div class="subject"><a href="#post-144274">Batch Files</a></div>
    <div class="body">Hi NaN,<br /><br />At this point wouldn't you be better off using a console application to do that for you ? When you start to parse and compare and modify strings it is a little beyond the scope of a batch file. This is how I would tackle the problem...<br /><br />Write a custom batch processor, say NaNBat.exe<br />Make a new file extension for example .NaN<br />Register the extension and make it's default &quot;Open With&quot; application NaNBat.exe<br /><br />That way you can do whatever you like and add any feature you want. All you would have to do is distribute NaNBat.exe but there are many other custom batch processors out there so it would be nothing new.<br /><br />The process of setting the default &quot;Open With&quot; can be automated by putting NaNBat.exe in HKLM\Applications and then setting the &quot;Open With &quot; application in HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts</div>
    <div class="meta">Posted on 2004-06-19 13:19:06 by donkey</div>
   </div>
   <div class="post" id="post-144277">
    <div class="subject"><a href="#post-144277">Batch Files</a></div>
    <div class="body">Its a good idea.. and i will admit I am getting a bit of tunnel vision here.   Thanks for the reality check... :alright:<br /><br />:NaN:</div>
    <div class="meta">Posted on 2004-06-19 14:23:32 by NaN</div>
   </div>
   <div class="post" id="post-144387">
    <div class="subject"><a href="#post-144387">Batch Files</a></div>
    <div class="body">...or perhaps pick up one of those pesky scripting languages, like perl or pything? :)</div>
    <div class="meta">Posted on 2004-06-21 06:36:28 by f0dder</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=18563&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=18563&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="18563" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=18563&amp;page=2">&gt;</a><a href="../?id=18563&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>