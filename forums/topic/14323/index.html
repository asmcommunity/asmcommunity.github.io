<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Keyboard UI for listview header context menu - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14323" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14323">Keyboard UI for listview header context menu</a></p>
   <div class="post" id="post-110853">
    <div class="subject"><a href="#post-110853">Keyboard UI for listview header context menu</a></div>
    <div class="body">Hi,<br /><br />in windows explorer of newer windows versions you may right-click a listview header and a context menu will pop up (showing available columns for example). I wonder how I can cause this menu to popup by keyboard commands. AFAIK, it is in windows GUI guidelines that all functions should be made available for mouse AND keyboard.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-07-17 00:54:48 by japheth</div>
   </div>
   <div class="post" id="post-110863">
    <div class="subject"><a href="#post-110863">Keyboard UI for listview header context menu</a></div>
    <div class="body">Well I cheated. I used spy++ to get the window handle of that listview control and hard coded it... :grin:<pre><code>invoke  SendMessage, 6024Ch, WM_RBUTTONUP, NULL, 0</code></pre></div>
    <div class="meta">Posted on 2003-07-17 02:38:26 by arkane</div>
   </div>
   <div class="post" id="post-110865">
    <div class="subject"><a href="#post-110865">Keyboard UI for listview header context menu</a></div>
    <div class="body">The menu is not on a key but the action it performs is ALT-V + N</div>
    <div class="meta">Posted on 2003-07-17 03:13:14 by donkey</div>
   </div>
   <div class="post" id="post-110876">
    <div class="subject"><a href="#post-110876">Keyboard UI for listview header context menu</a></div>
    <div class="body">arkane,<br /><br />thanks, but I was interested to know the &quot;standard&quot; keyboard user interface. If there exist none, its ok and<br />I may implement anything (I dont want to &quot;automate&quot; windows explorer, its for one of my own apps). BTW, hard coding a window handle isnt a good idea, and AFAIL, the header HWND can be reached by ListView_GetHeader macro. <br /><br />donkey, Alt-V + N doesnt do anything on my system.</div>
    <div class="meta">Posted on 2003-07-17 06:40:59 by japheth</div>
   </div>
   <div class="post" id="post-110878">
    <div class="subject"><a href="#post-110878">Keyboard UI for listview header context menu</a></div>
    <div class="body">Oh, I thought you were just looking for a way to access it in an explorer window only (detail view). I guess for your own app you can pretty much do what you want. I think that a header control cannot have the Keyboard focus so it would not be able to process a keycode by itself, it would have to rely on the application and there is no direct key combination that will show that menu. I thought clicking on the header and pressing SHIFT-F10 might work but it just displays the context menu for the explorer window.</div>
    <div class="meta">Posted on 2003-07-17 07:22:39 by donkey</div>
   </div>
   <div class="post" id="post-110907">
    <div class="subject"><a href="#post-110907">Keyboard UI for listview header context menu</a></div>
    <div class="body">Isn't there a window message to get the header handle for the listview control? Something like LVM_GETHEADER? And if there is, does it work for all Windows versions?</div>
    <div class="meta">Posted on 2003-07-17 13:00:32 by QvasiModo</div>
   </div>
  </div>
 </body>
</html>