<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ring0 again - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10460" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10460">ring0 again</a></p>
   <div class="post" id="post-78540">
    <div class="subject"><a href="#post-78540">ring0 again</a></div>
    <div class="body">So are there any people on this board who know about protected<br />mode/ring zero programming? Or at least a link to forums about this<br />stuff?<br /><br />I basically want this question to be answered:<br /><br />Assuming I managed to get into ring0 (under windows), <strong>how</strong><br />would my interrupt-handler-replacement know the EIP-register value<br />of the process where it came from?<br />Since Windows is not using the Task State Segment to save the regs,<br />I'm really interested how to solve this.<br /><br />I'm not trying anything special. Just learning pmode/ring0 by <strong>doing</strong><br />:grin: ... <br /><br /><br />aweX &lt;-</div>
    <div class="meta">Posted on 2003-01-26 21:15:07 by aweX</div>
   </div>
   <div class="post" id="post-78568">
    <div class="subject"><a href="#post-78568">ring0 again</a></div>
    <div class="body">aweX,<br /><br />There is probably still no better way to get into low level coding than to get the DDK for the version of windows you are using as this will give you the techniques for device drivers.<br /><br />There were a few fudges with win95 oem but they were changed in later versions so there is not much chance of dsoing this stuff any other way than to write device driver code.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2003-01-27 01:05:02 by hutch--</div>
   </div>
   <div class="post" id="post-78569">
    <div class="subject"><a href="#post-78569">ring0 again</a></div>
    <div class="body">Thanks for your reply, hutch--<br /><br />But driver development won't cover interrupt handlers, would it ?<br />... especially the question I stated above.<br /><br />I've read through much pmode stuff, now I want to get into<br />practise. I think drivers are a bit too much for such a start, I will<br />read Iczelion's driver tuts though.<br /><br />aweX &lt;-</div>
    <div class="meta">Posted on 2003-01-27 01:13:24 by aweX</div>
   </div>
   <div class="post" id="post-78675">
    <div class="subject"><a href="#post-78675">ring0 again</a></div>
    <div class="body">EIP would be at SS:ESP<br /><br /><br />The stack frame of an 32-bit interrupt gate (and an interrupt handler would most likely be called thru such a gate) looks like:<br /><br />dword  EIP            <br />dword CS<br />dword EFLAGS<br />dword ESP              ;only if ring switch occured<br />dword SS                ;only if ring switch occured<br /><br />if a V86 mode routine was interrupted, all the other 4 segment registers are onto the stack too and initialized with zero (as far as I remember)</div>
    <div class="meta">Posted on 2003-01-27 16:56:27 by japheth</div>
   </div>
  </div>
 </body>
</html>