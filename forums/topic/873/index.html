<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>catstr - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=873" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=873">catstr</a></p>
   <div class="post" id="post-5578">
    <div class="subject"><a href="#post-5578">catstr</a></div>
    <div class="body">sorry, this may seem like a really dumb question, but how would I cat the contents of 2 or more buffers into one other larger buffer.<br /><br />I've tried using CatStr, but this doesn't seem to like the fact that I want to use buffers in it, it wants constant strings.  If I can't use catstr, how else could I do it?<br /><br />thanks,<br /><br /> - Fourfty</div>
    <div class="meta">Posted on 2001-08-31 13:17:43 by Fourfty</div>
   </div>
   <div class="post" id="post-5584">
    <div class="subject"><a href="#post-5584">MASM32::How to use catstr</a></div>
    <div class="body">First I'd just like to say that that movie is one of my most favoritest.<br /><br />OK please don't take this the wrong way but I suspect that a lot of the posts on the &quot;Clearing the Buffer&quot; thread blew by you... in a short while it won't... but rather than a direct answer how about an approach?<br /><br />Also please excuse the tone if I seem to be &quot;talking down&quot; that's not my intent... I'm only two steps ahead on the learning curve (&amp; a slow learner to boot) so I may be a bit better guide than some of the gurus.<br /><br />Now, instead of looking for a function that can do what you want... just for learning purposes why don't you write a little function that does the catBuffer.<br /><br />1) loop thru the 1st source buffer &amp; place the bytes/dwords putting theem into the destination buffer stopping either at the end of the buffer or when a sentinel (null?) has been reached.  <br /><br />2) then loop thru the 2nd buffer and start putting that data in the destination where where the last one left off.  <br /><br />3) If you can do it in a HLL then just try &amp; translate that logic to assembler.<br /><br />4) Yes of course, it will be a highly inefficient algorithm! But here is where you'll hit the turbo on the learning... go back to the other thread &quot;Clearing a Buffer&quot; &amp; try &amp; apply some of those ideas to what you just wrote... whatever suits your fancy just try it.  The basic concepts are really the same.  That is, you're just moving data around in memory... now how to do it efficiently that's the interesting part that was being gotten to in the other thread.</div>
    <div class="meta">Posted on 2001-08-31 14:16:54 by rafe</div>
   </div>
   <div class="post" id="post-5611">
    <div class="subject"><a href="#post-5611">MASM32::How to use catstr</a></div>
    <div class="body">oops, sorry all, didn't realise I had so many replies to my last post...  must check the boards more often in future!<br /><br />Yeah, I ended up just doing it manually more or less how you said anyway - I never could figure out CatStr :)<br /><br /><br />Thanks,<br /> - Fourfty</div>
    <div class="meta">Posted on 2001-08-31 18:48:29 by Fourfty</div>
   </div>
   <div class="post" id="post-5620">
    <div class="subject"><a href="#post-5620">MASM32::How to use catstr</a></div>
    <div class="body">CATSTR is a macro level script.  Its used for preprocessing stuff.<br /><br />An example:<br /><br />Say i had a data segment as follows:<br /><pre><code>.data<br /><br />Cow_data db &quot;moooooooo!&quot;,0<br />Pig_data db &quot;oink!&quot;,0</code></pre><br /><br />And i wanted to make a macro that would move into eax the address of the data simply by giving it the name 'pig' or 'cow', (this is obviously a stupid example, but its simple such you can follow the uses of CATSTR)<br /><br />A macro would be:<br /><pre><code>GET_DATA MACRO Animal&#58;REQ<br />  LOCAL  sz1 ; this will hold the CATSTR info..<br /><br />  ; Use CATSTR to build &#58;  &quot;lea eax, xxx_data&quot;<br />  sz1 CATSTR &lt;lea eax, &gt;,&lt;&amp;Animal&gt;,&lt;_data&gt;<br />  <br />  ; Now i've concatinated string infro to gether, but<br />  ; its still not 'code' to be compiled at this point its <br />  ; still LOCAL info for pre-processing, to actually<br />  ; implement the built string into code, do the following<br />  sz1<br />  <br />  ; Now the above line is inserted into you code<br />  ; inplace of where this macro was called.<br />ENDM</code></pre><br /><br />I hope the comments make it easy to understand, to use this in code i would go:<br /><pre><code><br />.code<br />  ...<br />  GET_DATA Pig<br />  invoke Something_with_animal_data, eax<br />  GET_DATA Cow<br />  invoke Something_else_with_animal_data, eax</code></pre><br /><br />After Pre-processing, the actual compiled code will be:<br /><pre><code><br />.code<br />  ...<br />  lea eax, Pig_data<br />  invoke Something_with_animal_data, eax<br />  lea eax, Cow_data<br />  invoke Something_else_with_animal_data, eax</code></pre><br /><br />Hope this helps... Actually, now that i think of it, i just made a relatively simple example that would be a bit more practical, this macro uses CATSTR to reverse the parameter list and call a function from a register value.  Its to behave much like invoke, except using a register instead of a function name:<br /><pre><code><br />INVOKE_REG MACRO registr&#58;REQ, args&#58;VARARGS<br />  LOCAL sz3, count, sz4<br /><br />  IFNB &lt;args&gt;       ; if there is args<br />    count = 0          ; set local count to 0<br />    for arg, &lt;args&gt; ; loop all arguments<br />      if count eq 0<br />        sz3 TEXTEQU &lt;arg&gt; ; if first, no comma<br />      else<br />        sz3 CATSTR &lt;arg&gt;, &lt;,&gt;, sz3<br />      endif<br />      count = count + 1<br />    ENDM<br />    ; now wrap &lt; and &gt; around it for MASM to work<br />    sz4 CATSTR &lt;!&lt;&gt;,sz3,&lt;!&gt;&gt;<br />    %for arg2, sz4   ; now loop thu this new reversed list<br />      push arg2                         ; push args in reverse order<br />    ENDM<br />  ENDIF<br />  call registr<br />ENDM</code></pre><br /><br />The I would use it in code like so:<br /><pre><code><br />  mov edi, offset MyFunction<br />  INVOKE_REG edi, Param1, Param2, Param3<br /></code></pre><br />The args in the macro will be &quot;Param1,Param2,Param3&quot;, and Registr == &quot;edi&quot;.  The loop works as such:<br />sz3 == &quot;Param1&quot;  (pass #1, no comma&quot;)<br />sz3 == &quot;Param2, &quot; + sz3<br />sz3 == &quot;Param3, &quot; + sz3<br /><br />After 3 passes, sz3 == &quot;Param3, Param2, Param1&quot;<br /><br />Then it uses CATSTR again to place &quot;&lt;&quot; and &quot;&gt;&quot; around sz3<br />( &quot;&lt;Param3, Param2, Param1&gt;&quot; ), this is needed for the next FOR loop (preprocessor for) to use this new string in another loop, this time actually placing compilable code to the file (push's)&quot;<br />the macro will then be replaced with:<br /><br />push Param3<br />push Param2<br />push Param1<br />call edi<br /><br />Anywho, im getting carried away here, so i will stop while i think im ahead... Hope i havent scared you away, BitRake will at least attest to the fact they are something to eventually understand in MASM....  so i think its good to atleast provide some introduction where oportunity exists...<br /><br />Happy coding..<br />NaN</div>
    <div class="meta">Posted on 2001-08-31 19:52:49 by NaN</div>
   </div>
  </div>
 </body>
</html>