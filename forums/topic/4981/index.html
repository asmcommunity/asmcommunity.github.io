<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Question in assembler - my piano problems, wheee :) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4981" />
    <link rel="next" href="../?id=4981&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4981">Question in assembler - my piano problems, wheee :)</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=4981&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=4981&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="4981" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=4981&amp;page=2">&gt;</a><a href="../?id=4981&amp;page=2">&raquo;</a></form>   <div class="post" id="post-35011">
    <div class="subject"><a href="#post-35011">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">I have a problem in my piano program - <br />i want to make a part in my program that is responsible for the color change in the piano keys in such a way that AS LONG AS A KEYBOARD KEY IS PRESSED the piano key that is related to the keyboard key will be BLUE (creating a delay that is reacting to the key press, or something) and the moment the finger is released from the key - it will turn white again. <br />i dont know how to create such a delay - now im using a fixed delay which is no good at all... sometimes when i press the same key twice fast it doesnt show the blue thing appropiately.<br />besides that, i need help in many more things... if someone will be willing to help me - i will appreciate it very much <br /><br />thank you in advance <br />amit</div>
    <div class="meta">Posted on 2002-04-25 08:30:05 by flipmode</div>
   </div>
   <div class="post" id="post-35015">
    <div class="subject"><a href="#post-35015">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">What about coloring the key on WM_KEYDOWN, and uncoloring it on WM_KEYUP?</div>
    <div class="meta">Posted on 2002-04-25 08:39:25 by f0dder</div>
   </div>
   <div class="post" id="post-35024">
    <div class="subject"><a href="#post-35024">Huh ?</a></div>
    <div class="body">I am sorry i have never heared of those... im only a beginner in assembler, there are probably a dozen more simple ways to do what i have tried to do here...<br />please explain - what is WM_KEYDOWN and such ?<br />how can i use them in my program ?<br />thank you very much</div>
    <div class="meta">Posted on 2002-04-25 09:24:03 by flipmode</div>
   </div>
   <div class="post" id="post-35026">
    <div class="subject"><a href="#post-35026">....</a></div>
    <div class="body">Is there anyone out there who can check my program ? I know it seems like a lot of work but i feel like im doing things the wrong way... it was supposed to be simple and this program already passes the 300 lines, i just feel it shouldnt be that way.<br />If anyone is kind enough to help me here - i would be glad to send him my program as text or asm, every line has a comment.</div>
    <div class="meta">Posted on 2002-04-25 09:32:58 by flipmode</div>
   </div>
   <div class="post" id="post-35030">
    <div class="subject"><a href="#post-35030">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">flipmode, first take a look at iczelions tutorials <a target="_blank" href="http://win32asm.cjb.net">http://win32asm.cjb.net</a><br /><br />They will clearly explain what windows messages are and how to use them :)</div>
    <div class="meta">Posted on 2002-04-25 09:54:40 by Hiroshimator</div>
   </div>
   <div class="post" id="post-35036">
    <div class="subject"><a href="#post-35036">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">zip up your .asm file and post it here, somebody might take a look at it.</div>
    <div class="meta">Posted on 2002-04-25 10:13:15 by f0dder</div>
   </div>
   <div class="post" id="post-35064">
    <div class="subject"><a href="#post-35064">THANK YOU !</a></div>
    <div class="body">Thank you guys !<br /><br />In response to your replies - i have taken a look at the tutorials, the thing is that my project is supposed to be kept simple. Without all that stuff that is posted there - that is too 'complicated' for me :)<br />If you would take a minute to look at my code you will notice there is nothing there more than the most basic things.<br />I dont even know what to say there isnt there because i dont know anything besides what i did hehe.<br />Anyway here is the zipped .asm file you can read as text.<br />I used borland turbo-assembler as my compiler...</div>
    <div class="meta">Posted on 2002-04-25 14:26:15 by flipmode</div>
   </div>
   <div class="post" id="post-35068">
    <div class="subject"><a href="#post-35068">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">I do not think Iczelions tutorials help you much; yours is a DOS program.</div>
    <div class="meta">Posted on 2002-04-25 14:55:21 by CodeLover</div>
   </div>
   <div class="post" id="post-35069">
    <div class="subject"><a href="#post-35069">lol see ?</a></div>
    <div class="body">i told you i dont have any idea what im doing anyway !<br />it seems that my program is a DOS program...<br />I just hope i will get help in time... <br />before my teacher kicks my but for not handing it over</div>
    <div class="meta">Posted on 2002-04-25 15:08:34 by flipmode</div>
   </div>
   <div class="post" id="post-35075">
    <div class="subject"><a href="#post-35075">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">I supposed that was a homework assignment. <br /><br />If you really coded it entirely, you should know you are making a DOS program, you are working in 16 bits. As you see you are using interrupts, if you checked out Iczelion tutorials you might have noticed that the code shown there invokes API functions. You may also have noticed he is working in 32 bits. <br /><br />In your case, I do not think Iczelion Tutorials can help you. Tell us exactly which part of your code does not work as you are expecting, I will not have problems helping you.</div>
    <div class="meta">Posted on 2002-04-25 15:42:16 by CodeLover</div>
   </div>
   <div class="post" id="post-35078">
    <div class="subject"><a href="#post-35078">cool !</a></div>
    <div class="body">Ok here is the piece of code i am currently having trouble with.<br />It is the part that relates to the graphical changes i am supposed to show when the user presses a chosen key. For example, if the user presses the 's' the program i supposed to redraw the first piano key in blue, instead of its original white.<br />So far so good, but - since after redrawing the key in blue i wish the key will turn white again, i dont know how to manage it in a way that AS LONG AS the s key is pressed, the program will perform some kind of a loop that will act as a delay, and the moment the s key is released, the program will quit the loop and continue to the next piece of code which will redraw the key in white again. <br />here is the specific s key example that i need help with, the same code i have for 12 other keys, which represnt the 12 other piano keys i have.<br /><br />next0:<br />        mov ah,01;<br />        int 16h;<br />        cmp al,'s';             compare key pressed to 's'<br />        jne next1;            next1 is another piece like this only for 'e'<br />        mov si,3d6h;        set appropiate position on screen<br />        mov dh,0bh;         set background as light blue<br />        call key1;              call appropriate drawing procedure<br />&gt;here is the hard part for me, what piece of code should i inset here in order to generate the wanted effect ? i know it has something to do with int16h and buffer, but i really have no idea how to perform it. <br />Please help... my days are numbered and my doom is near :)<br />or something</div>
    <div class="meta">Posted on 2002-04-25 15:57:17 by flipmode</div>
   </div>
   <div class="post" id="post-35089">
    <div class="subject"><a href="#post-35089">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">What I used to do was trap IRQ1 (Int 09h if my memory serves me right).  That way I could get the key-press and key-release codes, unlike from BIOS which only saves the key-press codes.  Key press = WM_KEYDOWN, key release =WM_KEYUP.<br /><br />Basically you're doing hardware level, BELOW BIOS.  That way you can also determine if two keys are pressed at the same time.  Better do some research on Int 09h and the keyboard.  Stuff about DOS Extenders and PM will help since most of that stuff tends to require their own IRQ handlers.</div>
    <div class="meta">Posted on 2002-04-25 17:45:42 by AmkG</div>
   </div>
   <div class="post" id="post-35098">
    <div class="subject"><a href="#post-35098">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">Do you have an interrupt list? If not you can download it from <a target="_blank" href="http://www.programmersheaven.com">this site</a></div>
    <div class="meta">Posted on 2002-04-25 19:35:39 by CodeLover</div>
   </div>
   <div class="post" id="post-35112">
    <div class="subject"><a href="#post-35112">well thats it</a></div>
    <div class="body">i do have an interruprt list, and i heared of int16h but not that int1. whevern i use int16h it stucks my program, and i have to clear the buffer somehow (maybe turn ah back to 00 and call int16h again) i dont know<br />if anyone here knows anything about this - again, this is DOS program not WINDOWS - help</div>
    <div class="meta">Posted on 2002-04-25 23:50:02 by flipmode</div>
   </div>
   <div class="post" id="post-35210">
    <div class="subject"><a href="#post-35210">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">Well, you need to have a table of keyboard scan codes (this is different from the ascii codes) and you need to know which I/O port the keyboard is (it's pretty standard, I just can't remember it).  Been a while since I did this sort of thing.  :grin:<br /><br />I've attached a file I though might be useful... haven't read this document for a while already... :-)</div>
    <div class="meta">Posted on 2002-04-26 18:33:40 by AmkG</div>
   </div>
   <div class="post" id="post-35233">
    <div class="subject"><a href="#post-35233">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">no such overhead needed... just use this as your<br />main loop...<br /><br /><pre><code><br />_play&#58; 	in al, 060h	;get current key<br /><br />	cmp al, 31 	;keycode for &quot;s&quot;<br />	jnz _nope1	;check next one<br />	...<br />	draw your piano-key or do <br />	whatever has to be done...<br />	...<br />_nope1&#58;	cmp al, ??<br />	jnz _nope2	;check next one<br />	...<br />	...<br />	...<br />	<br />	dec al		;escape = 1 so decrease...<br />	jnz _play    	;and check it<br /></code></pre><br /><br />if you have problems then you should<br />disable interupts BEFORE and enable <br />them after you accessed port 60h (cli<br />&amp; sti)...</div>
    <div class="meta">Posted on 2002-04-26 21:24:16 by mob</div>
   </div>
   <div class="post" id="post-35264">
    <div class="subject"><a href="#post-35264">wow</a></div>
    <div class="body">i have got to admit that txt files looks very helpful ! :)<br />Thank you very much !<br />But, just a small 'issue' i have got here...<br />I have absolutely no clue in pascal, and the example program is given in it... Anyone here knows the smae code only in assembler ?</div>
    <div class="meta">Posted on 2002-04-27 06:05:47 by flipmode</div>
   </div>
   <div class="post" id="post-35265">
    <div class="subject"><a href="#post-35265">man !</a></div>
    <div class="body">mob, i havent seen your post before i did mine <br />THANK YOU OH SO MUCH<br />I think this might be it :) :) :)</div>
    <div class="meta">Posted on 2002-04-27 06:07:00 by flipmode</div>
   </div>
   <div class="post" id="post-35266">
    <div class="subject"><a href="#post-35266">mob, help</a></div>
    <div class="body">i dont understand mob...<br />how can the program tell if the key was just pressed or released in your piece of code ?<br />thats the whole thing, to know when was it released so i can call the procedure to turn the key into white again</div>
    <div class="meta">Posted on 2002-04-27 06:13:32 by flipmode</div>
   </div>
   <div class="post" id="post-35270">
    <div class="subject"><a href="#post-35270">Question in assembler - my piano problems, wheee :)</a></div>
    <div class="body">I think it should be there in the text document, about key press and key release codes.  You're doing direct hardware access.<br /><br />mob,<br />In my mind-set that sort of thing is dangerous.  Only IRQ1 is 'supposed' to have access to the keyboard.  I wouldn't have done such a thing.  'Course presumably you know that it's correct... and likely it'll work anyway.<br /><br />Still, if my memory serves me right, the keyboard I/O port would still hold the last key pressed, so as soon as the program gets run, the user would (presumably) have pressed enter key already, whose scan code would be left on the keyboard I/O port.  At least by grabbing IRQ1, you can be sure that a key was pressed, and not a holdover from the last key-press.<br /><br />Hmm, I'm rusty...</div>
    <div class="meta">Posted on 2002-04-27 07:18:23 by AmkG</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=4981&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=4981&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="4981" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=4981&amp;page=2">&gt;</a><a href="../?id=4981&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>