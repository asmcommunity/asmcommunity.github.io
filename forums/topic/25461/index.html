<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Debug register value after boot on Windows OS - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25461" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=25461">Debug register value after boot on Windows OS</a></p>
   <div class="post" id="post-186118">
    <div class="subject"><a href="#post-186118">Debug register value after boot on Windows OS</a></div>
    <div class="body">Does the Windows loading routine alter the state of the debug registers (particularly DR0, DR1, and DR2) ?<br /><br />The debug registers default values just after reset/power-up are summarised in Intel&#39;s manual. Thus, if Windows doesn&#39;t alter them, the values wouldl be identical to the reset/power-up default values. I want to ensure about this ;)<br /><br />I would like to know the contents of these registers in Windows 98/98SE and Windows 2000 just after boot completes, prior to any application being activated. Currently, I don&#39;t have systems with both of these OS installed&nbsp; ;) . <br /><br />Google and MSDN doesn&#39;t help much&nbsp; :sad:<br /><br />Anyone have clues?<br /><br />TIA,<br />Pinczakko </div>
    <div class="meta">Posted on 2006-10-21 22:56:17 by Pinczakko</div>
   </div>
   <div class="post" id="post-186144">
    <div class="subject"><a href="#post-186144">Re: Debug register value after boot on Windows OS</a></div>
    <div class="body">if windows (ie microsoft code) doesn&#39;t alter them, some other driver might, that, and the drx registers (and all others) are non global and can be set to different settings by other software.. some protection program out there even uses the drx registers to store decrypt keys (which makes bpx fail) and so on... whats your idea? :)</div>
    <div class="meta">Posted on 2006-10-23 01:06:16 by evlncrn8</div>
   </div>
   <div class="post" id="post-186152">
    <div class="subject"><a href="#post-186152">Re: Debug register value after boot on Windows OS</a></div>
    <div class="body">Also (I&#39;m too lazy to look up intel and AMD manuals right now :)), are the reserved bits in some of the DRx registers? If so, you shouldn&#39;t depend on register values, at least not without masking them first. And <strong>depending</strong> on those values seems like a pretty bad idea anyway.<br /></div>
    <div class="meta">Posted on 2006-10-23 08:17:47 by f0dder</div>
   </div>
   <div class="post" id="post-186234">
    <div class="subject"><a href="#post-186234">Re: Debug register value after boot on Windows OS</a></div>
    <div class="body">well, I&#39;m not coding a protection code so far&nbsp; ;). I&#39;m analyzing a code that makes an assumption about the values of the debug register&nbsp; ;). Thanks anyway&nbsp; :D</div>
    <div class="meta">Posted on 2006-10-29 00:54:16 by Pinczakko</div>
   </div>
   <div class="post" id="post-186296">
    <div class="subject"><a href="#post-186296">Re: Debug register value after boot on Windows OS</a></div>
    <div class="body">code that makes an assumption eh?<br />well i know a certain prot that does drx checks, if dr7 == 0x400 then softice is present, is that the sort of thing you&#39;re looking at?</div>
    <div class="meta">Posted on 2006-11-01 10:38:15 by evlncrn8</div>
   </div>
   <div class="post" id="post-186308">
    <div class="subject"><a href="#post-186308">Re: Debug register value after boot on Windows OS</a></div>
    <div class="body">nope, I&#39;m reversing a malware&nbsp; ;)</div>
    <div class="meta">Posted on 2006-11-02 02:52:24 by Pinczakko</div>
   </div>
  </div>
 </body>
</html>