<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>TCP SYN scanning - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19691" />
  <link rel="prev" href="../?id=19691&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=19691">TCP SYN scanning</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=19691&amp;page=1" style="">&laquo;</a><a href="../?id=19691&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="19691" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-151789">
    <div class="subject"><a href="#post-151789">TCP SYN scanning</a></div>
    <div class="body">Veria,<br /><br />Under xp and winsock 2 I get an error unless bOpt is a dword. <br /><br />Anyways, without all your code I can't get your snippet to assemble under MASM. Add your source (and header defs) as an attachment and maybe I can help you further.</div>
    <div class="meta">Posted on 2004-10-24 18:38:19 by The Dude of Dudes</div>
   </div>
   <div class="post" id="post-151791">
    <div class="subject"><a href="#post-151791">TCP SYN scanning</a></div>
    <div class="body"><div class="quote"><br /><br />Under xp and winsock 2 I get an error unless bOpt is a dword. <br /><br /></div><br /><br />Dude, <br />Do you have a code with proper functionality about TCP SYN scanning?</div>
    <div class="meta">Posted on 2004-10-24 20:32:58 by veria</div>
   </div>
   <div class="post" id="post-151792">
    <div class="subject"><a href="#post-151792">TCP SYN scanning</a></div>
    <div class="body">I do, but it uses the WinPCap API instead of WinSock.</div>
    <div class="meta">Posted on 2004-10-24 20:43:03 by The Dude of Dudes</div>
   </div>
   <div class="post" id="post-151793">
    <div class="subject"><a href="#post-151793">TCP SYN scanning</a></div>
    <div class="body"><div class="quote">I do, but it uses the WinPCap API instead of WinSock.</div><br /><br />Your code is written by masm32 or C++?</div>
    <div class="meta">Posted on 2004-10-24 20:50:15 by veria</div>
   </div>
   <div class="post" id="post-151837">
    <div class="subject"><a href="#post-151837">TCP SYN scanning</a></div>
    <div class="body">The Dude of Dudes,<br />If you can to attache your code to this froum, please do it.</div>
    <div class="meta">Posted on 2004-10-25 17:47:38 by veria</div>
   </div>
   <div class="post" id="post-151840">
    <div class="subject"><a href="#post-151840">TCP SYN scanning</a></div>
    <div class="body">My portscanner is actually a Host scanner, it sends a SYN packet to a range of specified ip's and listens for replies. But like I said, it uses the WinPCap API, not Windows Sockets. I've attached an example of using Raw sockets that sends an ICMP request, it should help you get your own code up and running. Make sure you put in the correct IP address dotted strings in the source if you want it to work (actually send a valid ICMP echo request).</div>
    <div class="meta">Posted on 2004-10-25 19:10:14 by The Dude of Dudes</div>
   </div>
   <div class="post" id="post-151871">
    <div class="subject"><a href="#post-151871">TCP SYN scanning</a></div>
    <div class="body">Dude,<br />Thank you for your replies. I will try to write my scanner with ws2_32.lib, instead of wsock32.lib very soon. I hope, I see no problem in this way.</div>
    <div class="meta">Posted on 2004-10-26 13:43:42 by veria</div>
   </div>
   <div class="post" id="post-151882">
    <div class="subject"><a href="#post-151882">TCP SYN scanning</a></div>
    <div class="body">I think you need to use Winsock 2 if you want to use Raw sockets.</div>
    <div class="meta">Posted on 2004-10-26 20:01:40 by The Dude of Dudes</div>
   </div>
   <div class="post" id="post-151901">
    <div class="subject"><a href="#post-151901">TCP SYN scanning</a></div>
    <div class="body">I'm late on this thread - but please enlighten me - why are we using raw sockets at all? This is merely a SYN scan - simply sending CONNECT attempts achieves the same aim. What's the big deal?<br />Are we trying to write a &quot;half-open&quot; scanner? (One that does not reply to the SYN/ACK with an ACK)...<br />If that's the case you are coming perilously close to breaching the posting rules of this forum, and I expect you can justify the nature of this thread.<br />I'm sure all the board users would agree that the rules are there for a good reason - to keep the rabble out.</div>
    <div class="meta">Posted on 2004-10-27 06:46:38 by Homer</div>
   </div>
   <div class="post" id="post-151930">
    <div class="subject"><a href="#post-151930">TCP SYN scanning</a></div>
    <div class="body">Dude,<br />No, my ping utility is work without any problem, when I use ws2_32 lib instead of wsock32 lib.<br /><br />EvilHomer2k,<br />This froum is a good Raw socket programming training. I must be familiar with this area, If I realy want to produce a good and serious net utility, like my firewall.</div>
    <div class="meta">Posted on 2004-10-27 15:17:56 by veria</div>
   </div>
   <div class="post" id="post-151945">
    <div class="subject"><a href="#post-151945">TCP SYN scanning</a></div>
    <div class="body">Veria, <br /><br />Glad ws_2 is working for you.<br /><br />Homer, <br /><br />He said he was working on a tcp portscanner. Portscanning itself is not illegal, and being discussed in the context of writing his own portscanner I didnt think it breached forum policy (my apologies if it does, however). <br /><br />I agree connect would work, but you would have to create 65535 seperate socket descriptors to do a full portscan.  Raw sockets seem simpler, one socket sending, one listening for SYN/ACK's.</div>
    <div class="meta">Posted on 2004-10-27 20:01:59 by The Dude of Dudes</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=19691&amp;page=1" style="">&laquo;</a><a href="../?id=19691&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="19691" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>