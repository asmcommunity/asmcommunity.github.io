<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>RC6... Memory decryption problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21552" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21552">RC6... Memory decryption problem</a></p>
   <div class="post" id="post-162728">
    <div class="subject"><a href="#post-162728">RC6... Memory decryption problem</a></div>
    <div class="body"> .586? ? ? ? ? ? ? ? ? ? ? ?; create 32 bit code<br />.model flat, stdcall? ? ? ?; 32 bit memory model<br />OPTION CASEMAP:NONE? ? ? ? ? ? ? ? ? ? <br />? ?<br /><br />include rc6.asm<br />include \masm32\include\windows.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\masm32.inc<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\masm32.lib<br /><br /><br /><br />.data<br />strOllyClsName db &quot;OLLYDBG&quot;,0<br />szOlly			db &quot; ?&lt;???,???$ep?ON&quot;,0<br />caption? ?db &quot;DAEMON&quot;,0<br />normal? ? db &quot;not debugged!&quot;,0<br />deb? ? ? ?db &quot;u are debugging me :)&quot;,0<br />fwin dd ?<br />Key			? ? ?db &quot;jdy28lambcoplwerewaf23sdfcvxc&quot;,0<br />;Key? ? ? ? ? ? ?db 256 dup (0)<br />;Plaintext? ? ? ?db 16 dup (0)<br /><br /><br /><br /><br />? .data?<br />? SArray? ? ? ? ? db RC6_SIZEOFS dup? (?)<br />? PrE				PROCESSENTRY32&lt;&gt;<br />? temp			dd ?<br />? ExitCode		dd ?<br />? handle			dd ?<br />? <br />? <br />? <br />? .code<br />? <br /> <br />? ?<br /><br />? ? <br />? <br />? Bugger_Bad:<br /><br />? ? ? ? ? invoke? ? rc6_init,addr SArray,addr Key,16<br />? ? ? <br />? ? invoke? ? rc6_decrypt,addr SArray,addr szOlly<br />? ? <br /><br />? invoke lstrcmp,addr PrE.szExeFile,addr szOlly<br />? 	.if eax==0<br />? 		invoke OpenProcess,PROCESS_ALL_ACCESS,TRUE,PrE.th32ProcessID <br />? 		mov handle,eax<br />? 		<br />? ? ? ?<br />? ? invoke TerminateProcess,handle,0<br />? ? ?Invoke ExitProcess,0<br />? <br />? ? ? ? .else<br />? <br />? ? ? ? invoke Process32Next,temp,addr PrE<br />? <br />? <br />? ? ? ? ? .endif <br />? 	 jmp Bugger_Bad? ? ?<br />? 	 <br />? <br />? I used tol&#39;s rc6 implementation and the decryption rountine just keeps running and running .. How can I stop it from running and continue with the rest of the code... This was just a test to see if it would work? ?:twisted:<br /><br /><br /><br />This is not all of the code....</div>
    <div class="meta">Posted on 2005-08-02 19:48:51 by shism2</div>
   </div>
   <div class="post" id="post-162729">
    <div class="subject"><a href="#post-162729">Re: RC6... Memory decryption problem</a></div>
    <div class="body">maybe u forgot to pass it the size of the buffer?</div>
    <div class="meta">Posted on 2005-08-02 20:03:21 by comrade</div>
   </div>
  </div>
 </body>
</html>