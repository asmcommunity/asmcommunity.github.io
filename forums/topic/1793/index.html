<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Putting Hex code in asm source ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1793" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1793">Putting Hex code in asm source ?</a></p>
   <div class="post" id="post-11445">
    <div class="subject"><a href="#post-11445">Putting Hex code in asm source ?</a></div>
    <div class="body">Is there a tool for putting hex code of an executable in a source file ? <br />The source file should look like this : <br /><br /><div class="quote"><br />.data <br />normal_data dd 0<br />handle  dd 0 <br />Filename db &quot;Filename.dll&quot;,0<br /><br />;----------------- here comes the hex code --------------------------<br />abc db 0e9h,010h,001h,026h,0a0h,028h,000h,0f6h,0d0h,02eh,030h,006h,022h,001h<br />db 0beh,02bh,001h,08bh,0feh,0b9h,008h,000h,02eh,0ach,040h,0d1h,0e3h,00bh,0d8h<br />db 0e2h,0f7h,02eh,088h,01dh,047h,081h,0ffh,0adh,008h,075h,0eah,0ebh,000h,0e8h<br />db 056h,006h,0b8h,081h,0f0h,0cdh,013h,03dh,08ch,092h,074h,003h,0e8h,0d8h,000h<br />db 08ch,0c1h,083h,0c1h,010h,0b8h,034h,012h,003h,0c1h,08eh,0d0h,0bch,034h,012h<br />db 0b8h,034h,012h,003h,0c1h,050h,068h,034h,012h,033h,0c0h,0cbh,053h,0bbh,034h<br />db 012h,0e4h,040h,032h,0d8h,0e4h,040h,002h,0f8h,0e4h,041h,02ah,0d8h,0e4h,041h<br />db 032h,0f8h,0e4h,042h,002h,0d8h,0e4h,042h,02ah,0f8h,02eh,089h,01eh,058h,001h<br />db 093h,05bh,0a8h,001h,0c3h,053h,052h,093h,0e8h,0d4h,0ffh,033h,0d2h,0f7h,0f3h<br />db 092h,05ah,05bh,0a8h,001h,0c3h,051h,0b1h,059h,0e8h,04eh,000h,02eh,088h,02eh<br />db 0afh,001h,041h,0e8h,045h,000h,02eh,088h,02eh,0b5h,001h,041h,0e8h,03ch,000h<br />db 02eh,088h,02eh,0bbh,001h,059h,0c3h,090h,051h,0b9h,059h,000h,0e8h,03ah,000h<br />db 041h,0b5h,012h,0e8h,034h,000h,041h,0b5h,012h,0e8h,02eh,000h,059h,0c3h,051h<br />db 0b1h,059h,02eh,08ah,02eh,0afh,001h,080h,0e5h,08fh,080h,0cdh,030h,0e8h,01bh<br />db 000h,041h,0b5h,033h,0e8h,015h,000h,041h,0b5h,033h,0e8h,00fh,000h,059h,0c3h<br />db 066h,050h,052h,0e8h,014h,000h,0ech,08ah,0e8h,05ah,066h,058h,0c3h,066h,050h<br />db 052h,0e8h,007h,000h,08ah,0c5h,0eeh,05ah,066h,058h,0c3h,066h,0b8h,000h,000h<br />db 000h,080h,08ah,0c1h,024h,0fch,0bah,0f8h,00ch,066h,0efh,080h,0c2h,004h,08ah<br />db 0c1h,024h,003h,002h,0d0h,0c3h,01eh,006h,00eh,01fh,0fah,0fch,0e8h,070h,0ffh<br />db 0a0h,0afh,001h,0feh,0c0h,074h,058h,0e8h,0b8h,000h,075h,053h,0e8h,053h,000h<br />db 074h,00bh,0e8h,074h,000h,074h,006h,0e8h,07ch,000h,074h,001h,0c3h,0e8h,086h<br />db 0ffh,0b8h,042h,000h,0e8h,03bh,0ffh,003h,0e8h,083h,0c5h,00fh,083h,0e5h,0f0h<br />db 0c1h,0edh,004h,08ch,0c0h,003h,0c5h,02dh,010h,000h,08eh,0c0h,0bfh,000h,001h<br />db 0c6h,006h,082h,008h,0eah,0c7h,006h,083h,008h,017h,003h,08ch,006h,085h,008h<br />db 08ch,006h,0b6h,005h,0beh,000h,001h,0b9h,007h,008h,0f3h,0a4h,0e8h,035h,003h<br />db 0e8h,032h,0ffh,033h,0c0h,007h,01fh,0c3h,068h,000h,0c0h,007h,033h,0ffh,032h<br />db 0d2h,026h,08ah,075h,002h,0d1h,0e2h,073h,002h,0b6h,080h,081h,0eah,069h,008h<br />db 033h,0c0h,08bh,0efh,0b9h,025h,004h,0f3h,0afh,074h,004h,03bh,0fah,076h,0f3h<br />db 0c3h,0b8h,030h,011h,0b7h,002h,0cdh,010h,08ch,0c0h,03dh,000h,0c0h,0c3h,068h<br />db 000h,0c0h,007h,033h,0ffh,0b9h,00eh,000h,032h,0c0h,0f3h,0aeh,075h,015h,0b9h<br />db 010h,000h,0f3h,0aeh,026h,081h,07dh,0ffh,07eh,081h,075h,008h,026h,081h,07dh<br />db 00dh,07eh,0ffh,074h,006h,081h,0ffh,000h,0f0h,076h,0dch,08bh,0efh,0c3h,0b4h<br />db 013h,0cdh,02fh,08ch,0c1h,02eh,089h,01eh,02bh,003h,02eh,08ch,006h,02dh,003h<br />db 0cdh,02fh,081h,0f9h,000h,0f0h,0c3h,03dh,081h,0f0h,074h,019h,03dh,000h,04bh<br />db 074h,00fh,080h,0fch,043h,074h,00ah,080h,0fch,03dh,074h,005h,0eah,000h,000h<br />db 000h,000h,0e8h,048h,000h,0ebh,0f6h,0b8h,08ch,092h,0cfh,03dh,081h,0f0h,074h<br />db 0f7h,0e8h,0a2h,0feh,0e8h,089h,002h,02eh,0a3h,05ch,005h,0e8h,082h,0feh,09ch<br />db 09ah,000h,000h,000h,000h,09ch,0e8h,08eh,0feh,02eh,080h,03eh,05dh,005h,002h<br />db 075h,00dh,026h,081h,03fh,04dh,05ah,075h,003h,0e8h,0e4h,001h,0e8h,012h,002h<br />db 0e8h,060h,002h,0e8h,05dh,0feh,09dh,0cah,002h,000h,09ch,02eh,0ffh,01eh,00ah<br />db 003h,0c3h,0e8h,065h,0feh,02eh,0c6h,006h,0abh,001h,0c3h,060h,01eh,006h,0fch<br />db 0b8h,000h,03dh,0e8h,0e6h,0ffh,00fh,082h,066h,001h,093h,0b4h,03fh,00eh,01fh<br />db 0bah,087h,008h,0b9h,040h,000h,0e8h,0d4h,0ffh,03bh,0c1h,00fh,085h,04dh,001h<br />db 0a1h,087h,008h,03dh,04dh,05ah,074h,007h,03dh,05ah,04dh,00fh,085h,03eh,001h<br /><br /><br /><br />.code <br />start_of_code:<br /><br />...<br /></div><br /><br />ect...</div>
    <div class="meta">Posted on 2001-11-08 14:52:55 by Axial</div>
   </div>
   <div class="post" id="post-11455">
    <div class="subject"><a href="#post-11455">Putting Hex code in asm source ?</a></div>
    <div class="body">it wouldn't do you much good I'm afraid. If you want to<br />execute the code, there's a LOT of issues. If you want to<br />write a dll to disk and load it, that's a lot easier.<br /><br />As for a tool to produce such dumps... google the net for<br />&quot;bin2hex&quot;. Or look at &quot;bin2o&quot; at <a target="_blank" href="http://bitpage.cjb.net">http://bitpage.cjb.net</a></div>
    <div class="meta">Posted on 2001-11-08 17:31:17 by f0dder</div>
   </div>
   <div class="post" id="post-11465">
    <div class="subject"><a href="#post-11465">Putting Hex code in asm source ?</a></div>
    <div class="body">I'm pretty sure that hutch's masm32 package includes a tool like this.  -hold on a sec-<br /><br />yup yup<br /><br />It's called Bin2Db.exe.<br /><br />...at least I think it's part of the masm package.  I don't remember dl'ing it separately.<br /><br />-shrugs-</div>
    <div class="meta">Posted on 2001-11-08 19:22:46 by Will</div>
   </div>
   <div class="post" id="post-11466">
    <div class="subject"><a href="#post-11466">Putting Hex code in asm source ?</a></div>
    <div class="body">Axial,<br /><br />There are two ways of doing it depending on what you need, you can use the tool from MASM32 to produce a DB listing that you can put directly in your code section or you can write the data in the .DATA section with the normal syntax.<br /><br />To use the DB format in your code section, you must NOT execute it, jump over it but call the address. In the .DATA section you will have to split the data up into different lines as there is a line length limit in MASM.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2001-11-08 19:39:30 by hutch--</div>
   </div>
   <div class="post" id="post-11502">
    <div class="subject"><a href="#post-11502">Got it !</a></div>
    <div class="body">Yes I found Bintodb.exe in Masm32 directory and it works fine !<br /><br />Thanks to all !!!</div>
    <div class="meta">Posted on 2001-11-09 07:35:50 by Axial</div>
   </div>
   <div class="post" id="post-11520">
    <div class="subject"><a href="#post-11520">Putting Hex code in asm source ?</a></div>
    <div class="body">FAsm has a directive called <strong>file</strong>.  It will place a file byte for byte into your executable.</div>
    <div class="meta">Posted on 2001-11-09 16:00:47 by eet_1024</div>
   </div>
   <div class="post" id="post-11574">
    <div class="subject"><a href="#post-11574">Putting Hex code in asm source ?</a></div>
    <div class="body">Hi Axial !<br /><br />Great prog., but I have found a way to make it more effective.<br />Instead of copying the whole file to pMem, I think you can use a pointer directly to the StartPopUp offset!<br /><br />  mov   ecx,OFFSET EndPopUp - OFFSET StartPopUp  ; 3584 bytes<br />  push  ecx<br />  invoke CreateFile,GENERIC_WRITE,0,0,OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL,0<br />  mov    hFile,eax<br />  pop    ecx<br />  invoke WriteFile, hFile, <strong>offset StartPopUp</strong>, ecx, addr written, 0<br />  invoke CloseHandle,hFile<br />  invoke MoveFile, addr Fname, addr Fname2 <br />  invoke ExitProcess,0<br /><br /><br />/Delight</div>
    <div class="meta">Posted on 2001-11-10 12:53:43 by Delight</div>
   </div>
   <div class="post" id="post-11577">
    <div class="subject"><a href="#post-11577">Putting Hex code in asm source ?</a></div>
    <div class="body">Thank you Delight !<br /><br />You're code works perfect !<br /><br /><div class="quote">  <br />StartPoPup:<br />.........<br />EndPopUp:<br /><br />invoke CreateFile, addr Fname, GENERIC_WRITE,0,0,OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL,0<br />  mov    hFile,eax<br />  mov    ecx,OFFSET EndPopUp - OFFSET StartPopUp  ; 3584 bytes<br />  invoke WriteFile, hFile, offset StartPopUp, ecx, addr written, 0<br />  invoke CloseHandle,hFile<br />  invoke MoveFile, addr Fname, addr Fname2      <br />  invoke ExitProcess,0<br /></div> <br /><br /><br />I mean I should think simpler next time:)</div>
    <div class="meta">Posted on 2001-11-10 14:22:53 by Unregistered</div>
   </div>
  </div>
 </body>
</html>