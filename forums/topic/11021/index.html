<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Generalized Procs - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=11021" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=11021">Generalized Procs</a></p>
   <div class="post" id="post-83017">
    <div class="subject"><a href="#post-83017">Generalized Procs</a></div>
    <div class="body">I was wondering maybe if someone could either point me in the right direction or perhaps show me a little code.. I'm currently involved in writing the backend for a compiler. As things stand now the code is in an intermediate assembler form which I have access to.<br /><br />Before I actually try to write assembler code based on this pesudo-code, I thought I should take some time to make some generalized procedures, etc. I thought I'd start off with something really simple (a print string procedure) but for the life of me I can't get it to work.<br /><br />Is there something about proc and parameters that I just don't get conceptually? Perhaps I have spent too much time in HLL but it seems to me something like this should work:<br /><br /><br />proc __sd_echo, arg<br />      enter<br />      mov edx, arg<br />      mov ah, 9<br />      int  21h<br />      return<br /><br />But it doesn't... What is happening internally when I use the proc macro? I don't really understand the macrolanguage well yet so looking at the source for it is a bit confusing to me. Also, I saw in the archives someone said to remove 'enter', but if I do that FASM won't assemble..<br /><br /><br />Hopefully someone can help me learn this stuff...<br /><br />:stupid: <br /><br />Coogle</div>
    <div class="meta">Posted on 2003-02-21 18:25:22 by coogle</div>
   </div>
   <div class="post" id="post-83021">
    <div class="subject"><a href="#post-83021">Generalized Procs</a></div>
    <div class="body">Try this:<br /><br />proc __sd_echo, arg<br />enter<br />mov edx, <br />mov ah, 9<br />int 21h<br />return <br /><br />That should work. You have to include the [ and the ] for the arguments.</div>
    <div class="meta">Posted on 2003-02-21 18:44:21 by CyberGuy</div>
   </div>
   <div class="post" id="post-83027">
    <div class="subject"><a href="#post-83027">Generalized Procs</a></div>
    <div class="body">:confused: still having problems... here's the related code:<br /><br />segment __sterdick_script_dseg<br /><br />foo    db    &quot;asdf&quot;,24h<br /><br /><br />segment __sterdick_helpers<br /><br />proc __sd_echo, arg<br />	enter<br />	mov edx, <br />	mov ah, 9<br />	int 21h<br />	return <br /><br />segment __sterdick_script_main                        <br /><br />  __start_script:<br />  	mov ax,__sterdick_script_dseg<br />  	mov ds, ax<br />  	mov edx, foo<br />  	stdcall __sd_echo, edx<br />                retf<br /><br /><br />Coogle</div>
    <div class="meta">Posted on 2003-02-21 19:26:36 by coogle</div>
   </div>
   <div class="post" id="post-84044">
    <div class="subject"><a href="#post-84044">Generalized Procs</a></div>
    <div class="body">If you're having so many problems you could just simplify it to a macro:<br /><br />macro __sd_echo arg<br />{<br />mov edx, <br />mov ah, 9<br />int 21h<br />}</div>
    <div class="meta">Posted on 2003-02-27 17:53:58 by CyberGuy</div>
   </div>
  </div>
 </body>
</html>