<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Another Problem - XP Style - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22402" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22402">Another Problem - XP Style</a></p>
   <div class="post" id="post-168117">
    <div class="subject"><a href="#post-168117">Another Problem - XP Style</a></div>
    <div class="body">hi,<br /><br />I found another problem with my text editor. I usually use windows classic style, when i switched to xp style, my program crashed, but in classic style it ran perfectly, i tested it in olly, the prog breaks at DialogBoxParam, any idea y it won&#39;t work when i use xp style...??&nbsp; :?: :shock:<br /><pre><code><br />invoke InitCommonControls<br />invoke LoadLibrary,addr RichEditDLL<br />.if eax!=0<br />mov hRichEditDLL,eax<br />invoke DialogBoxParam, hInstance, ADDR DlgName, 0, ADDR DlgProc, 0<br />invoke FreeLibrary,hRichEditDLL<br />.ENDIF<br />invoke ExitProcess,0<br /></code></pre></div>
    <div class="meta">Posted on 2005-11-22 06:25:25 by lone_samurai5</div>
   </div>
   <div class="post" id="post-168118">
    <div class="subject"><a href="#post-168118">Re: Another Problem - XP Style</a></div>
    <div class="body">I&#39;ve uploaded the file, can someone test and see whether it works on other versions of xp, i have xp home edition sp1.. thanx (btw, none of the controls would work, just started it)&nbsp; :P</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1243" target="_blank">gpadm.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-11-22 07:17:15 by lone_samurai5</div>
   </div>
   <div class="post" id="post-168119">
    <div class="subject"><a href="#post-168119">Re: Another Problem - XP Style</a></div>
    <div class="body">Try calling InitCommonControlsEx with a properly filled out struct instead of InitCommonControls and then check the return value.</div>
    <div class="meta">Posted on 2005-11-22 07:35:14 by EÃ³in</div>
   </div>
   <div class="post" id="post-168125">
    <div class="subject"><a href="#post-168125">Re: Another Problem - XP Style</a></div>
    <div class="body">Well, total fail at my XP/SP2 ,a protect mode error produced when open your program.</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1248" target="_blank">PROTECT ERROR.JPG</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-11-22 12:07:09 by Luckrock</div>
   </div>
   <div class="post" id="post-168128">
    <div class="subject"><a href="#post-168128">Re: Another Problem - XP Style</a></div>
    <div class="body">It works perfectly on my classic style. I see that you&#39;re using some new &#39;cool&#39; visuals. IIRC they require a &#39;manifest&#39; file. Maybe that&#39;s the reason.<br /><br />Also remember to verify CommonControls DLL version. Some new visuals require 2000/XP libraries (I doubt that&#39;s the reason, but it&#39;s nice to have it confirmed ;) ).</div>
    <div class="meta">Posted on 2005-11-22 13:58:03 by ti_mo_n</div>
   </div>
   <div class="post" id="post-168161">
    <div class="subject"><a href="#post-168161">Re: Another Problem - XP Style</a></div>
    <div class="body">Well i tried using a manifest too, still crashed, i checked it out in olly, when i trace over dialogboxparam it said something like ERROR_CONTROL_ID_NOT_FOUND, then i remembered i had copied a newer version of user32.inc which, after sometime i found, didn&#39;t build properly, so&nbsp; copied the old one back but alas the error was still there, so i rewrote the whole thing and stopped using dialogs.. works now..&nbsp; :) very weird though,<br /><br />Thanx for the help anyways, (btw when i stopped using dialogs, the tab key problem in the richedit control went away too&nbsp; :D)<br /><br />Later<br /></div>
    <div class="meta">Posted on 2005-11-23 05:13:40 by lone_samurai5</div>
   </div>
   <div class="post" id="post-168169">
    <div class="subject"><a href="#post-168169">Re: Another Problem - XP Style</a></div>
    <div class="body">That&#39;s why I never use Dialogs xD :P</div>
    <div class="meta">Posted on 2005-11-23 15:18:19 by ti_mo_n</div>
   </div>
  </div>
 </body>
</html>