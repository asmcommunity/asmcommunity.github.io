<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How 2 write a LIB, guyz? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27539" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27539">How 2 write a LIB, guyz?</a></p>
   <div class="post" id="post-196826">
    <div class="subject"><a href="#post-196826">How 2 write a LIB, guyz?</a></div>
    <div class="body">I'm sure I've read about it somewhere before, but I never
got to write one myself, so of course I don't know how to.
I know it's simple, so could any of you just outline for me
the following:
-parameters i have to use with ML.EXE and LINK.EXE
-how to call the functions from my LIB.
-anything else that defers from writing a regular win32 app
which runs in ring3.

alternatively and preferably: just appoint me to a tut or
something. 

Thanks A LOT.

RingZer0</div>
    <div class="meta">Posted on 2001-04-04 20:32:00 by RingZer0</div>
   </div>
   <div class="post" id="post-196827">
    <div class="subject"><a href="#post-196827">How 2 write a LIB, guyz?</a></div>
    <div class="body">Building a lib is so simple once you see one, it really doesn't need much of a tutorial, an example will suffice. And you're probably very familiar with at least one example: the MASM32 library

It's shipped as part of the masm32 package, go check your M32LIB folder.

You build a lib with :

<pre><code>
\masm32\bin\ml /c /coff *.asm
\masm32\bin\lib *.obj /out:YourLibName.lib
</code></pre>


That's it,unless you also place resources into the lib. Declare exported procedures with PUBLIC, exported (or imported too BTW) variables with externdef, and make an .inc file to define the proc, constant, variable, etc exports.

It's usually best to divide a lib into many small .asm files, as each .asm makes a 'token' in the lib, code is imported as a whole 'token,' so the finer you split the asm files up, the smaller the linker will build the final program image.</div>
    <div class="meta">Posted on 2001-04-04 23:19:00 by Ernie</div>
   </div>
  </div>
 </body>
</html>