<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Versioninfos for ASM Dll's - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1882" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1882">Versioninfos for ASM Dll's</a></p>
   <div class="post" id="post-12025">
    <div class="subject"><a href="#post-12025">Versioninfos for ASM Dll's</a></div>
    <div class="body">Hello,<br /><br />how can I create versioninfos to my dll (made with MASM32). Is that possible???<br /><br />Greetz, Nordwind64</div>
    <div class="meta">Posted on 2001-11-14 15:00:09 by Nordwind64</div>
   </div>
   <div class="post" id="post-12034">
    <div class="subject"><a href="#post-12034">Versioninfos for ASM Dll's</a></div>
    <div class="body">You need to add a VERSIONINFO resource to your resource file... If you can find a good resouce editor somewhere you can probably create version info with that.. <br /><br />You can also write it by hand but I never tried that so I wouldn't know the full syntax of it.. Below is an example of what the VC resource editor created, but I think it uses some constants from afxres.h.. Maybe it helps though<br /><br />Thomas<br /><br /><pre><code><br />VS_VERSION_INFO VERSIONINFO<br /> FILEVERSION 1,0,0,1<br /> PRODUCTVERSION 1,0,0,1<br /> FILEFLAGSMASK 0x3fL<br /> FILEFLAGS 0x28L<br /> FILEOS 0x40004L<br /> FILETYPE 0x1L<br /> FILESUBTYPE 0x0L<br />BEGIN<br />    BLOCK &quot;StringFileInfo&quot;<br />    BEGIN<br />        BLOCK &quot;000004b0&quot;<br />        BEGIN<br />            VALUE &quot;Comments&quot;, &quot;AsmDB special edition. Not intended for use outside HTTPFT. Limited version.\0&quot;<br />            VALUE &quot;CompanyName&quot;, &quot;Exagone\0&quot;<br />            VALUE &quot;FileDescription&quot;, &quot;AsmDB SE database engine DLL\0&quot;<br />            VALUE &quot;FileVersion&quot;, &quot;1, 0, 0, 0\0&quot;<br />            VALUE &quot;InternalName&quot;, &quot;AsmDBSE\0&quot;<br />            VALUE &quot;LegalCopyright&quot;, &quot;Copyright ? 2001 by Exagone &#40;Thomas Bleeker&#41;\0&quot;<br />            VALUE &quot;LegalTrademarks&quot;, &quot;\0&quot;<br />            VALUE &quot;OriginalFilename&quot;, &quot;AsmDB.dll\0&quot;<br />            VALUE &quot;PrivateBuild&quot;, &quot;Special Edition\0&quot;<br />            VALUE &quot;ProductName&quot;, &quot;AsmDB SE database engine by Exagone\0&quot;<br />            VALUE &quot;ProductVersion&quot;, &quot;1, 0, 0, 1\0&quot;<br />            VALUE &quot;SpecialBuild&quot;, &quot;Special Edition\0&quot;<br />        END<br />    END<br />    BLOCK &quot;VarFileInfo&quot;<br />    BEGIN<br />        VALUE &quot;Translation&quot;, 0x0, 1200<br />    END<br />END<br /></code></pre></div>
    <div class="meta">Posted on 2001-11-14 15:59:39 by Thomas</div>
   </div>
   <div class="post" id="post-12051">
    <div class="subject"><a href="#post-12051">Versioninfos for ASM Dll's</a></div>
    <div class="body">This is from RC.HLP. Sorry about the length... :grin:<br /><br />The VERSIONINFO statement creates a version-information resource. The resource contains such information about the file as its version number, its intended operating system, and its original filename. The resource is intended to be used with the File Installation library functions.<br /><br />Syntax<br /><br />versionID VERSIONINFO fixed-info<br />BEGIN<br />    block-statement<br />    . . .<br />END<br /><br />Parameters<br /><br />versionID<br /><br />Specifies the version-information resource identifier. This value must be 1.<br /><br />fixed-info<br /><br />Specifies the version information, such as the file version and the intended operating system. This parameter consists of the following statements:<br /><br />FILEVERSION version<br /><br />Specifies the binary version number for the file. The version consists of two 32-bit integers, defined by four 16-bit integers. For example, &quot;FILEVERSION 3,10,0,61&quot; is translated into two doublewords: 0x0003000a and 0x0000003d, in that order. Therefore, if version is defined by the doublewords dw1 and dw2, they need to appear in the FILEVERSION statement as follows: HIWORD(dw1), LOWORD(dw1), HIWORD(dw2), LOWORD(dw2).<br /><br />PRODUCTVERSION version<br /><br />Specifies the binary version number for the product with which the file is distributed. The version parameter is two 32-bit integers, defined by four 16-bit integers. For more information about version, see the FILEVERSION description.<br /><br />FILEFLAGSMASK fileflagsmask<br /><br />Specifies which bits in the FILEFLAGS statement are valid. If a bit is set, the corresponding bit in FILEFLAGS is valid.<br /><br />FILEFLAGS fileflags<br /><br />Specifies the Boolean attributes of the file. The fileflags parameter must be the combination of all the file flags that are valid at compile time. For Windows 3.1, this value is 0x3f.<br /><br />FILEOS fileos<br /><br />Specifies the operating system for which this file was designed. The fileos parameter can be one of the operating system values given in the Comments section.<br /><br />FILETYPE filetype<br /><br />Specifies the general type of file. The filetype parameter can be one of the file type values listed in the Comments section.<br /><br />FILESUBTYPE subtype<br /><br />Specifies the function of the file. The subtype parameter is zero unless the type parameter in the FILETYPE statement is VFT_DRV, VFT_FONT, or VFT_VXD. For a list of file subtype values, see the Comments section.<br /><br />block-statement<br /><br />Specifies one or more version-information blocks. A block can contain string information or variable information.<br /><br /> <br /><br />Remarks<br /><br />To use the constants specified with the VERSIONINFO statement, the WINVER.H file (included in WINDOWS.H) must be included in the resource-definition file.<br />The following list describes the parameters used in the VERSIONINFO statement:<br /><br />fileflags<br /><br />Specifies a combination of the following values:<br /><br />VS_FF_DEBUG<br /><br />File contains debugging information or is compiled with debugging features enabled.<br /><br />VS_FF_INFOINFERRED<br /><br />File contains a dynamically created version-information resource. Some of the blocks for the resource may be empty or incorrect. This value is not intended to be used in version-information resources created by using the VERSIONINFO statement.<br /><br />VS_FF_PATCHED<br /><br />File has been modified and is not identical to the original shipping file of the same version number.<br /><br />VS_FF_PRERELEASE<br /><br />File is a development version, not a commercially released product.<br /><br />VS_FF_PRIVATEBUILD<br /><br />File was not built using standard release procedures. If this value is given, the StringFileInfo<br /> block must contain a PrivateBuild string.<br /><br />VS_FF_SPECIALBUILD<br /><br />File was built by the original company using standard release procedures but is a variation of the standard file of the same version number. If this value is given, the StringFileInfo block must contain a SpecialBuild string.<br /><br />fileos<br /><br />Specifies one of the following values:<br /><br />Value	Description<br />VOS_UNKNOWN	Operating system for which the file was designed is unknown to Windows.<br />VOS_DOS	File was designed for MS-DOS.<br />VOS_NT	File was designed for Windows NT.<br />VOS_WINDOWS16	File was designed for Windows version 3.0 or later.<br />VOS_WINDOWS32	File was designed for 32-bit Windows.<br />VOS_DOS_WINDOWS16	File was designed for Windows version 3.0 or later running with MS-DOS.<br />VOS_DOS_WINDOWS32	File was designed for 32-bit Windows running with MS-DOS.<br />VOS_NT_WINDOWS32	File was designed for 32-bit Windows running with Windows NT.<br /> <br /><br />The values 0x00002L, 0x00003L, 0x20000L and 0x30000L are reserved.<br /><br />filetype<br /><br />Specifies one of the following values:<br /><br />Value	Description<br />VFT_UNKNOWN	File type is unknown to Windows.<br />VFT_APP	File contains an application.<br />VFT_DLL	File contains a dynamic-link library (DLL).<br />VFT_DRV	File contains a device driver. If the dwFileType member is VFT_DRV, the dwFileSubtype member contains a more specific description of the driver.<br />VFT_FONT	File contains a font. If the dwFileType member is VFT_FONT, the dwFileSubtype member contains a more specific description of the font.<br />VFT_VXD	File contains a virtual device.<br />VFT_STATIC_LIB	File contains a static-link library.<br /> <br /><br />All other values are reserved for use by Microsoft.<br /><br />subtype<br /><br />Specifies additional information about the file type.<br />If the FILETYPE statement specifies VFT_DRV, this parameter can be one of the following values:<br /><br />Value	Description<br />VFT2_UNKNOWN	Driver type is unknown to Windows.<br />VFT2_DRV_COMM	File contains a communications driver.<br />VFT2_DRV_PRINTER	File contains a printer driver.<br />VFT2_DRV_KEYBOARD	File contains a keyboard driver.<br />VFT2_DRV_LANGUAGE	File contains a language driver.<br />VFT2_DRV_DISPLAY	File contains a display driver.<br />VFT2_DRV_MOUSE	File contains a mouse driver.<br />VFT2_DRV_NETWORK	File contains a network driver.<br />VFT2_DRV_SYSTEM	File contains a system driver.<br />VFT2_DRV_INSTALLABLE	File contains an installable driver.<br />VFT2_DRV_SOUND	File contains a sound driver.<br /> <br /><br />If the FILETYPE statement specifies VFT_FONT, this parameter can be one of the following values:<br /><br />Value	Description<br />VFT2_UNKNOWN	Font type is unknown to Windows.<br />VFT2_FONT_RASTER	File contains a raster font.<br />VFT2_FONT_VECTOR	File contains a vector font.<br />VFT2_FONT_TRUETYPE	File contains a TrueType font.<br /> <br /><br />If the FILETYPE statement specifies VFT_VXD, this parameter must be the virtual-device identifier included in the virtual-device control block.<br />All subtype values not listed here are reserved for use by Microsoft.<br /><br />langID<br /><br />Specifies one of the following language codes:<br /><br />Code	Language	Code	Language<br />0x0401	Arabic	0x0415	Polish<br />0x0402	Bulgarian	0x0416	Brazilian Portuguese<br />0x0403	Catalan	0x0417	Rhaeto-Romanic<br />0x0404	Traditional Chinese	0x0418	Romanian<br />0x0405	Czech	0x0419	Russian<br />0x0406	Danish	0x041A	Croato-Serbian (Latin)<br />0x0407	German	0x041B	Slovak<br />0x0408	Greek	0x041C	Albanian<br />0x0409	U.S. English	0x041D	Swedish<br />0x040A	Castilian Spanish	0x041E	Thai<br />0x040B	Finnish	0x041F	Turkish<br />0x040C	French	0x0420	Urdu<br />0x040D	Hebrew	0x0421	Bahasa<br />0x040E	Hungarian	0x0804	Simplified Chinese<br />0x040F	Icelandic	0x0807	Swiss German<br />0x0410	Italian	0x0809	U.K. English<br />0x0411	Japanese	0x080A	Mexican Spanish<br />0x0412	Korean	0x080C	Belgian French<br />0x0413	Dutch	0x0C0C	Canadian French<br />0x0414	Norwegian - Bokml	0x100C	Swiss French<br />0x0810	Swiss Italian	0x0816	Portuguese<br />0x0813	Belgian Dutch	0x081A	Serbo-Croatian (Cyrillic)<br />0x0814	Norwegian - Nynorsk		<br /> <br /><br />charsetID<br /><br />Specifies one of the following character-set identifiers:<br /><br />Identifier	Character Set<br />0	7-bit ASCII<br />932	Windows, Japan (Shift - JIS X-0208)<br />949	Windows, Korea (Shift - KSC 5601)<br />950	Windows, Taiwan (GB5)<br />1200	Unicode<br />1250	Windows, Latin-2 (Eastern European)<br />1251	Windows, Cyrillic<br />1252	Windows, Multilingual<br />1253	Windows, Greek<br />1254	Windows, Turkish<br />1255	Windows, Hebrew<br />1256	Windows, Arabic<br /> <br /><br />string-name<br /><br />Specifies one of the following redefined names:<br /><br />Comments<br /><br />Specifies additional information that should be displayed for diagnostic purposes.<br /><br />CompanyName<br /><br />Specifies the company that produced the file?for example, &quot;Microsoft Corporation&quot; or &quot;Standard Microsystems Corporation, Inc.&quot; This string is required.<br /><br />FileDescription<br /><br />Specifies a file description to be presented to users. This string may be displayed in a list box when the user is choosing files to install?for example, &quot;Keyboard Driver for AT-Style Keyboards&quot; or &quot;Microsoft Word for Windows&quot;. This string is required.<br /><br />FileVersion<br /><br />Specifies the version number of the file?for example, &quot;3.10&quot; or &quot;5.00.RC2&quot;. This string is required.<br /><br />InternalName<br /><br />Specifies the internal name of the file, if one exists?for example, a module name if the file is a dynamic-link library. If the file has no internal name, this string should be the original filename, without extension. This string is required.<br /><br />LegalCopyright<br /><br />Specifies all copyright notices that apply to the file. This should include the full text of all notices, legal symbols, copyright dates, and so on?for example, &quot;Copyright? Microsoft Corporation 1990-1992&quot;. This string is optional.<br /><br />LegalTrademarks<br /><br />Specifies all trademarks and registered trademarks that apply to the file. This should include the full text of all notices, legal symbols, trademark numbers, and so on?for example, &quot;Windows? is a trademark of Microsoft? Corporation&quot;. This string is optional.<br /><br />OriginalFilename<br /><br />Specifies the original name of the file, not including a path. This information enables an application to determine whether a file has been renamed by a user. The format of the name depends on the file system for which the file was created. This string is required.<br /><br />PrivateBuild<br /><br />Specifies information about a private version of the file?for example, &quot;Built by TESTER1 on \TESTBED&quot;. This string should be present only if the VS_FF_PRIVATEBUILD flag is set in the dwFileFlags member of the VS_FIXEDFILEINFO structure of the root block.<br /><br />ProductName<br /><br />Specifies the name of the product with which the file is distributed?for example, &quot;Microsoft Windows&quot;. This string is required.<br /><br />ProductVersion<br /><br />Specifies the version of the product with which the file is distributed?for example, &quot;3.10&quot; or &quot;5.00.RC2&quot;. This string is required.<br /><br />SpecialBuild<br /><br />Specifies how this version of the file differs from the standard version?for example, &quot;Private build for TESTER1 solving mouse problems on M250 and M250E computers&quot;. This string should be present only if the VS_FF_SPECIALBUILD flag is set in the dwFileFlags member of the VS_FIXEDFILEINFO structure in the root block.<br /><br /> <br /><br />A string information block has the following form:<br /><br />BLOCK &quot;StringFileInfo&quot;<br />BEGIN<br />    BLOCK &quot;lang-charset&quot;<br />    BEGIN<br />        VALUE &quot;string-name&quot;, &quot;value&quot;<br />            . . .<br />    END<br />END<br /><br />Following are the parameters in the StringFileInfo block:<br /><br />lang-charset<br /><br />Specifies a language and character-set identifier pair. It is a hexadecimal string consisting of the concatenation of the language and character-set identifiers listed earlier in this section.<br /><br />string-name<br /><br />Specifies the name of a value in the block and can be one of the redefined names listed earlier in this section.<br /><br />value<br /><br />Specifies, as a character string, the value of the corresponding string name. More than one VALUE statement can be given.<br /><br /> <br /><br />A variable information block has the following form:<br /><br />BLOCK &quot;VarFileInfo&quot;<br />BEGIN<br />    VALUE &quot;Translation&quot;,<br />        langID, charsetID<br />            . . .<br />END<br /><br />Following are the parameters in the variable information block:<br /><br />langID<br /><br />Specifies one of the language identifiers listed earlier in this section.<br /><br />charsetID<br /><br />Specifies one of the character-set identifiers listed earlier in this section. More than one identifier pair can be given, but each pair must be separated from the preceding pair with a comma.</div>
    <div class="meta">Posted on 2001-11-14 18:18:09 by S/390</div>
   </div>
   <div class="post" id="post-182189">
    <div class="subject"><a href="#post-182189">Re: Versioninfos for ASM Dll's</a></div>
    <div class="body">Thank you!<br /><br />(Sorry for supplying so late...)</div>
    <div class="meta">Posted on 2006-06-20 11:09:38 by Nordwind64</div>
   </div>
  </div>
 </body>
</html>