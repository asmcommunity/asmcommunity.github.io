<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Question about DLL loading - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15773" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15773">Question about DLL loading</a></p>
   <div class="post" id="post-122218">
    <div class="subject"><a href="#post-122218">Question about DLL loading</a></div>
    <div class="body">When using LoadLibrary on the same file twice, simply a DLL reference counter is increased. Is it possible to load a DLL twice and let it become 2 independent copies, just like loading two DLL files?</div>
    <div class="meta">Posted on 2003-10-23 08:29:13 by optimus</div>
   </div>
   <div class="post" id="post-122222">
    <div class="subject"><a href="#post-122222">Question about DLL loading</a></div>
    <div class="body">have you checked to see if it returns the same handle if so theres your answer... im not sure my self..</div>
    <div class="meta">Posted on 2003-10-23 08:59:04 by devilsclaw</div>
   </div>
   <div class="post" id="post-122535">
    <div class="subject"><a href="#post-122535">Question about DLL loading</a></div>
    <div class="body">I think its possible to do that by loading same dll on different base addresses in each .exe memory space, but why do you need all this for?</div>
    <div class="meta">Posted on 2003-10-26 15:35:27 by Mikky</div>
   </div>
   <div class="post" id="post-122559">
    <div class="subject"><a href="#post-122559">Question about DLL loading</a></div>
    <div class="body">but how?<br />I need 2 duplicated copy of a DLL threads in my 8051 Emulator so that 2 CPUs can be emulated easily.</div>
    <div class="meta">Posted on 2003-10-26 22:34:18 by optimus</div>
   </div>
   <div class="post" id="post-122606">
    <div class="subject"><a href="#post-122606">Question about DLL loading</a></div>
    <div class="body">If you launch the emulator program twice, you will get two virtual CPUs, each with its own &quot;copy&quot; of the DLL. However, they will not be synchronized with each other.<br /><br />To get two copies in the same process (executable), I would try putting a copy of the DLL in another directory and loading the DLLs from the different directories.  If it works, then I would create directories on-the-fly for each processor I wanted to create.</div>
    <div class="meta">Posted on 2003-10-27 16:27:23 by tenkey</div>
   </div>
   <div class="post" id="post-122628">
    <div class="subject"><a href="#post-122628">Question about DLL loading</a></div>
    <div class="body">that means keeping 2 copies of the same DLL file?</div>
    <div class="meta">Posted on 2003-10-27 19:49:59 by optimus</div>
   </div>
   <div class="post" id="post-122631">
    <div class="subject"><a href="#post-122631">Question about DLL loading</a></div>
    <div class="body"><div class="quote"><br />but how?<br />I need 2 duplicated copy of a DLL threads in my 8051 Emulator so that 2 CPUs can be emulated easily. </div><br /><br />Why not just create 2 threads and call the appropriate functions in the DLL?</div>
    <div class="meta">Posted on 2003-10-27 21:27:30 by Mecurius</div>
   </div>
   <div class="post" id="post-122642">
    <div class="subject"><a href="#post-122642">Question about DLL loading</a></div>
    <div class="body">yeah, that's something. let me try.</div>
    <div class="meta">Posted on 2003-10-27 23:37:46 by optimus</div>
   </div>
   <div class="post" id="post-151017">
    <div class="subject"><a href="#post-151017">Question about DLL loading</a></div>
    <div class="body">hi optimus<br />i feel that it is possible to load a dll twice by using an artful protection scheme by accessing the file by its alternate short name, leaving the system loader in delusion and loading them in 2 addresses.<br /><br />thank you<br />nickdigital</div>
    <div class="meta">Posted on 2004-10-06 15:14:20 by nickdigital</div>
   </div>
   <div class="post" id="post-151035">
    <div class="subject"><a href="#post-151035">Question about DLL loading</a></div>
    <div class="body">if the dll is thread-aware (it allocates a new portion of the memory for every new thread at DLL_THREAD_ATTACH, and deallocates it at DLL_THREAD_DETACH) you can just use LoadLibrary() twice on 2 different threads (or even 1 - i can't remember now).  if not - the only option is to cheat somehow - use two copies, or play with processes and filemapping for synchronization, etc.</div>
    <div class="meta">Posted on 2004-10-06 22:18:43 by ti_mo_n</div>
   </div>
  </div>
 </body>
</html>