<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Copying multiple files - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22614" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22614">Copying multiple files</a></p>
   <div class="post" id="post-169636">
    <div class="subject"><a href="#post-169636">Copying multiple files</a></div>
    <div class="body">Hi,<br />I am trying to copy multiple files to one location.I am using below code.<br />ie<br /><pre><code><br />.data<br />szFrom db &quot;aa.txt&quot;,0,&quot;bb.txt&quot;,&quot;aaaa&quot;,0,0 ;files and directories are supported<br />szTo db &quot;c:\test&quot;,0,0<br />.data?<br />CopyParms SHFILEOPSTRUCT &lt;&gt;<br />.code<br />CopyFiles proc szFrom:DWORD,szTo:DWORD<br />	mov eax,szFrom<br />	mov ecx,szTo<br />	mov CopyParms.hwnd,0<br />	mov CopyParms.wFunc,FO_COPY<br />	mov&nbsp; &nbsp;  CopyParms.pFrom,eax&nbsp; &nbsp;  ;Set from path<br />	mov&nbsp; &nbsp;  CopyParms.pTo,ecx<br />	mov&nbsp; &nbsp;  CopyParms.fFlags,FOF_NOCONFIRMATION or FOF_NOCONFIRMMKDIR or FOF_SILENT <br />	mov&nbsp; &nbsp;  CopyParms.fAnyOperationsAborted,0<br />	mov&nbsp; &nbsp;  CopyParms.hNameMappings,0<br />	mov&nbsp; &nbsp;  CopyParms.lpszProgressTitle,0<br />	invoke&nbsp; SHFileOperation,ADDR CopyParms<br />	ret<br />CopyFiles endp</code></pre><br /><br />However if any file in the pFrom does not exists function doesnt work.I want to go to next file if the file does not exist.I didnt found any flag for this.ShFileoperariton is recursive so it can copy directories too.So before writing this custom function, I want to ask you if you have anything similar.Thanks</div>
    <div class="meta">Posted on 2006-01-17 16:21:51 by LaptoniC</div>
   </div>
  </div>
 </body>
</html>