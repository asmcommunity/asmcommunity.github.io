<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>doing stuff with mspaint window - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19583" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19583">doing stuff with mspaint window</a></p>
   <div class="post" id="post-150836">
    <div class="subject"><a href="#post-150836">doing stuff with mspaint window</a></div>
    <div class="body">hi,<br /><br />i can get notepad to show the &quot;open&quot; dialog by getting its hwnd with FindWindow and then<br /><br /><pre><code>SendMessage hwnd,273,2,0</code></pre><br /><br />where 2 is the ID of the 'open' option on the popup menu..<br />im trying to do the same with mspaint, the relevant ID is E101h (57601) but it doesn't work, any ideas why? i was able to find the window correctly, so that isn't the problem..</div>
    <div class="meta">Posted on 2004-10-03 02:11:52 by zerog</div>
   </div>
   <div class="post" id="post-150839">
    <div class="subject"><a href="#post-150839">doing stuff with mspaint window</a></div>
    <div class="body">There is a great tool to examine other people's executeables, especially the resource parts of this....Resource Hacker<br />Just google and you will find....it can also show you the menu items<br /><br />I tried the same and it worked fine...<br />invoke SendMessage, pwnd, 273d, 57601d, 0h<br /><br />Make sure that you really find the window handle (pwnd in my line)...<br /><br />Dominik</div>
    <div class="meta">Posted on 2004-10-03 05:47:36 by Dom</div>
   </div>
   <div class="post" id="post-150846">
    <div class="subject"><a href="#post-150846">doing stuff with mspaint window</a></div>
    <div class="body">hi,<br /><br />thanks, but i already have that..<br /><br />and you're right it works fine, i just didnt give paint enough time to load before sending the message.</div>
    <div class="meta">Posted on 2004-10-03 08:50:33 by zerog</div>
   </div>
   <div class="post" id="post-150979">
    <div class="subject"><a href="#post-150979">doing stuff with mspaint window</a></div>
    <div class="body">i always use this, to wait for other application to start.<br /><br />platform SDK:<br /><br /><div class="quote">WaitForInputIdle<br /><br />The WaitForInputIdle function waits until the specified process is waiting for user input with no input pending, or until the time-out interval has elapsed.<br /><br /><br />DWORD WaitForInputIdle(<br />  HANDLE hProcess,<br />  DWORD dwMilliseconds<br />);</div></div>
    <div class="meta">Posted on 2004-10-05 21:58:24 by ti_mo_n</div>
   </div>
   <div class="post" id="post-151010">
    <div class="subject"><a href="#post-151010">Re: doing stuff with mspaint window</a></div>
    <div class="body"><div class="quote">hi,<br /><br />i can get notepad to show the &quot;open&quot; dialog by getting its hwnd with FindWindow and then<br /><br /><pre><code>SendMessage hwnd,273,2,0</code></pre><br /><br />where 2 is the ID of the 'open' option on the popup menu..<br />im trying to do the same with mspaint, the relevant ID is E101h (57601) but it doesn't work, any ideas why? i was able to find the window correctly, so that isn't the problem..</div><br />Is that the menu item ID? If so, your code should work... maybe the problem is somewhere else? I don't think ms paint cares to check where messages come from...  :?:</div>
    <div class="meta">Posted on 2004-10-06 13:43:27 by QvasiModo</div>
   </div>
  </div>
 </body>
</html>