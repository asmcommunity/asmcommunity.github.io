<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>More Toys for X-Mas - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9275" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=9275">More Toys for X-Mas</a></p>
   <div class="post" id="post-68386">
    <div class="subject"><a href="#post-68386">More Toys for X-Mas</a></div>
    <div class="body">Since im feeling generous, here is some COM stuff that might amuse you.<br /><br />I finally did a *full* hand translation of the SAPI.IDL, and SAPI.H files into one assembly version for COM use.  It is used for developing talking software, or text - to - speech.  This souce shows how simple it is to get going.<br /><br />The File SAPI.COM is an assembly include file.  Im using the .com extension since its COM definitions.  Dont think its binary, cause its not (this is the hand translated file).  This file also has all the COM definitions to get the VOICE RECOGNITION working for you.  But im tire and havent coded up an example yet.<br /><br />The program *should* work on Win2000 (since it default installs with SPEECH components), but last i checked XP and others dont.  You can download the installer / SDK from microsoft (its free).  (( I developed and tested it on Win98SE )).<br /><br />Or, if people are having a hard time, i can zip up the modules and post them at Geocities....  let me know.<br /><br />Anywho, back to the point.  Its soo simple to use, look at the source:<br /><pre><code>start&#58;<br />      ; Format all Variables<br />      xor eax, eax<br />      mov pIVoice, eax<br />      <br />            <br />      ; First Convert the Text to Wide Charater String, store it into buffer<br />      invoke MultiByteToWideChar, NULL, NULL, addr Data1, -1, addr Buffer, 200<br />      <br />      invoke CoInitialize, NULL<br />      invoke CoCreateInstance, ADDR CLSID_SpVoice, NULL, CLSCTX_SERVER,\<br />                               addr ISpVoice, addr pIVoice<br /><br />      .if&#40; pIVoice &#41;<br />         ; Speek Text converted Dynamically<br />         ole32 pIVoice, ISpVoice_Speak, offset Buffer, SPF_DEFAULT, offset OutStream<br />         ; Speek Static UNICODE compiled into the file<br />         ole32 pIVoice, ISpVoice_Speak, offset Data2, SPF_DEFAULT, offset OutStream<br />         ole32 pIVoice, ISpVoice_Release<br />      .endif<br />      invoke CoUninitialize         <br />      <br />      call ExitProcess<br />end start</code></pre><br />Buffer and Data2 are the text to be spoken by the CPU.  All intefaces etc are defined in SAPI.COM...<br /><br />Have fun with it, i am.. :grin:<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-12-01 03:26:34 by NaN</div>
   </div>
   <div class="post" id="post-68391">
    <div class="subject"><a href="#post-68391">More Toys for X-Mas</a></div>
    <div class="body">You can get the SAPI install from here: <a target="_blank" href="http://www.microsoft.com/msagent/downloads.htm#sapi">Microsoft SAPI Download (824 kb)</a> <br /><br />As well, you should select a Text-To-Speech Engine (1 Mb) from the same page, with your specific language requirements.<br /><br />The rest of the stuf on the page is optional... I dont have finished MS Agent COM files so dont bother with MS Agent stuff, unless you are going to download the full SDK to play with ;)<br /><br />Anywho, im outa here...<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-12-01 03:44:16 by NaN</div>
   </div>
   <div class="post" id="post-68400">
    <div class="subject"><a href="#post-68400">More Toys for X-Mas</a></div>
    <div class="body"><div class="quote"><strong>The program *should* work on Win2000</div>It does. :)</div>
    <div class="meta">Posted on 2002-12-01 04:40:28 by Maverick</div>
   </div>
  </div>
 </body>
</html>