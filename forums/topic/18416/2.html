<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>DX9 GameCoding with optional oop support - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18416" />
  <link rel="prev" href="../?id=18416&amp;page=1" />  <link rel="next" href="../?id=18416&amp;page=3" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=18416">DX9 GameCoding with optional oop support</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=18416&amp;page=1" style="">&laquo;</a><a href="../?id=18416&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="18416" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=18416&amp;page=3">&gt;</a><a href="../?id=18416&amp;page=3">&raquo;</a></form>   <div class="post" id="post-142990">
    <div class="subject"><a href="#post-142990">DX9 GameCoding with optional oop support</a></div>
    <div class="body">Afternoon, EvilHomer2k.<br /><br />Cannot reassemble.<br /><br />The linker says it can't find D3DXCreateFontA, even though none of the files seem to use it.<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2004-06-06 07:50:52 by Scronty</div>
   </div>
   <div class="post" id="post-142992">
    <div class="subject"><a href="#post-142992">DX9 GameCoding with optional oop support</a></div>
    <div class="body">Afternoon, EvilHomer2k.<br /><br />It's ok.<br />Seems you've declared D3DXCreateFontA as:<br /><pre><code>D3DXCreateFontA proto &#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD</code></pre><br /><br />You only need those declarations as:<br /><pre><code><br /><br />    D3DXCreateFont proto &#58;DWORD,&#58;DWORD,&#58;DWORD<br />    D3DXCreateFontIndirect proto &#58;DWORD,&#58;DWORD,&#58;DWORD</code></pre><br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2004-06-06 07:57:47 by Scronty</div>
   </div>
   <div class="post" id="post-143000">
    <div class="subject"><a href="#post-143000">DX9 GameCoding with optional oop support</a></div>
    <div class="body">Afternoon, EvilHomer2k.<br /><br />Attached is the proggy updated with corrected d3dx9core.inc file plus with zbuffer enabled.<br /><br />Note that the zbuffer requires switching off to render the 2d panel (shown in code).<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2004-06-06 08:29:23 by Scronty</div>
   </div>
   <div class="post" id="post-143001">
    <div class="subject"><a href="#post-143001">DX9 GameCoding with optional oop support</a></div>
    <div class="body">lol, whoa thanks :)<br />Build ok after that?<br /><br />I had no Render issues.. wonder if I updated all files in that zip? You may have noted there were a few other changes and additions made to the Headers etc...</div>
    <div class="meta">Posted on 2004-06-06 08:29:24 by Homer</div>
   </div>
   <div class="post" id="post-143002">
    <div class="subject"><a href="#post-143002">DX9 GameCoding with optional oop support</a></div>
    <div class="body">Afternoon, EvilHomer2k.<br /><br />heh. Must've bet ya to posting by &lt;1 sec ;p .<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2004-06-06 08:30:27 by Scronty</div>
   </div>
   <div class="post" id="post-143004">
    <div class="subject"><a href="#post-143004">DX9 GameCoding with optional oop support</a></div>
    <div class="body">yup :) I'll grab your updated dxcore and see if I still build ok this end ..</div>
    <div class="meta">Posted on 2004-06-06 08:34:19 by Homer</div>
   </div>
   <div class="post" id="post-143008">
    <div class="subject"><a href="#post-143008">DX9 GameCoding with optional oop support</a></div>
    <div class="body">Added the zbuffer code (and changes to D3DInit) and noticed that the mesh polygons and the 2dpanel polygons are built in opposite directions .. I'll have to change the 2dpanel vertex-filling code. I guess I'm ready to begin wrapping the Mesh code in another OOP class now, removing it from the main source file and enshrining it in its own as I did for the 2dpanel... meshes just happen to be a perfect candidate, and I'm hoping this set of examples highlights the potential benefits of OOP that can be had despite the extra access cost, if it applied to appropriate situations, especially where we intend to create multiple instances of something that we could define as a struct, and possibly has one or more closely-associated functions...</div>
    <div class="meta">Posted on 2004-06-06 08:45:57 by Homer</div>
   </div>
   <div class="post" id="post-143012">
    <div class="subject"><a href="#post-143012">DX9 GameCoding with optional oop support</a></div>
    <div class="body">Afternoon, EvilHomer2k.<br /><br /><div class="quote">built in opposite directions</div><br /><br />Pardon?<br /><br />The map of earth displays correctly (it's not backwards). The tiger rotates in a clockwise direction, as expected.<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2004-06-06 09:14:08 by Scronty</div>
   </div>
   <div class="post" id="post-143019">
    <div class="subject"><a href="#post-143019">DX9 GameCoding with optional oop support</a></div>
    <div class="body">You misunderstand me - changing the CULLMODE to CW or CCW, one way we get the 2DPanel, but see &quot;thru&quot; the tiger to its backfaces, the other way we get no 2DPanel (I assume its been culled) and the tiger looks good.. I have left culling disabled for now.</div>
    <div class="meta">Posted on 2004-06-06 11:10:02 by Homer</div>
   </div>
   <div class="post" id="post-143068">
    <div class="subject"><a href="#post-143068">DX9 GameCoding with optional oop support</a></div>
    <div class="body">Afternoon, EvilHomer2k.<br /><br />That's what I'd done in the update I posted.<br /><pre><code>pcall lpd3dDevice.SetRenderState, D3DRS_CULLMODE, D3DCULL_NONE</code></pre><br /><br />Of course.... it'd be better to change the 2dpanel code so that it's created as CCW vertices.<br /><br />Change the SetRenderState line to:<br /><pre><code>pcall lpd3dDevice.SetRenderState, D3DRS_CULLMODE, D3DCULL_CCW</code></pre><br />and modify the 2DPanel.inc file so that the vertice-generating code is:<br /><pre><code><br />    fild &#91;ecx&#93;.My2DPanel.rc.left<br />    fstp &#91;ebx&#93;.My2DPanelVertex.x<br />    fild &#91;ecx&#93;.My2DPanel.rc.bottom<br />    fstp &#91;ebx&#93;.My2DPanelVertex.y<br />    m2m &#91;ebx&#93;.My2DPanelVertex.z,fp1<br />    m2m &#91;ebx&#93;.My2DPanelVertex.rhw,fp1<br />    m2m &#91;ebx&#93;.My2DPanelVertex.tu,fp0<br />    m2m &#91;ebx&#93;.My2DPanelVertex.tv,fp1<br />    add ebx,sizeof My2DPanelVertex<br />    <br />    fild &#91;ecx&#93;.My2DPanel.rc.left<br />    fstp &#91;ebx&#93;.My2DPanelVertex.x<br />    fild &#91;ecx&#93;.My2DPanel.rc.top<br />    fstp &#91;ebx&#93;.My2DPanelVertex.y<br />    m2m &#91;ebx&#93;.My2DPanelVertex.z,fp1<br />    m2m &#91;ebx&#93;.My2DPanelVertex.rhw,fp1<br />    m2m &#91;ebx&#93;.My2DPanelVertex.tu,fp0<br />    m2m &#91;ebx&#93;.My2DPanelVertex.tv,fp0<br />    add ebx,sizeof My2DPanelVertex<br /><br /> <br />    fild &#91;ecx&#93;.My2DPanel.rc.right<br />    fstp &#91;ebx&#93;.My2DPanelVertex.x<br />    fild &#91;ecx&#93;.My2DPanel.rc.bottom<br />    fstp &#91;ebx&#93;.My2DPanelVertex.y<br />    m2m &#91;ebx&#93;.My2DPanelVertex.z,fp1<br />    m2m &#91;ebx&#93;.My2DPanelVertex.rhw,fp1<br />    m2m &#91;ebx&#93;.My2DPanelVertex.tu,fp1<br />    m2m &#91;ebx&#93;.My2DPanelVertex.tv,fp1<br />    add ebx,sizeof My2DPanelVertex<br />    <br />    fild &#91;ecx&#93;.My2DPanel.rc.right<br />    fstp &#91;ebx&#93;.My2DPanelVertex.x<br />    fild &#91;ecx&#93;.My2DPanel.rc.top<br />    fstp &#91;ebx&#93;.My2DPanelVertex.y<br />    m2m &#91;ebx&#93;.My2DPanelVertex.z,fp1<br />    m2m &#91;ebx&#93;.My2DPanelVertex.rhw,fp1<br />    m2m &#91;ebx&#93;.My2DPanelVertex.tu,fp1<br />    m2m &#91;ebx&#93;.My2DPanelVertex.tv,fp0<br />    add ebx,sizeof My2DPanelVertex<br /></code></pre><br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2004-06-06 19:47:19 by Scronty</div>
   </div>
   <div class="post" id="post-143083">
    <div class="subject"><a href="#post-143083">DX9 GameCoding with optional oop support</a></div>
    <div class="body">What he said :)<br /><br />Spent a while last nite wasting time on support classes including CD3DSettings and CD3DSettingsDialog, which are used to create a hardware-specific video options dialog box, based on the reported capabilities of the hardware...<br /><br />I won't be implementing it for some time, so it's not really relevant. I'm still tempted to wrap the Mesh code in a class next, but I think it might serve the casual observer to build some examples which more clearly show the usage of various transformation matrices before heading in that direction...<br /><br />Anyone have requests or suggestions as to what kind of examples they'd like to see? Maybe I should expand the 2DPanel to include mousecursor hit detection so that they can be used as buttons / menu selectors?</div>
    <div class="meta">Posted on 2004-06-07 01:13:52 by Homer</div>
   </div>
   <div class="post" id="post-143087">
    <div class="subject"><a href="#post-143087">DX9 GameCoding with optional oop support</a></div>
    <div class="body"><div class="quote">fild .My2DPanel.rc.right<br />fstp .My2DPanelVertex.x</div><br /><br />I don't know if you ever thought about this, or if you just used the FPU because they are floats... but there's no reason why you should use the FPU for just copying floats around. It's faster to use the ALU, something like:<br /><br /><pre><code>mov eax, &#91;ecx&#93;.My2DPanel.rc.right<br />mov &#91;ebx&#93;.My2DPanelVertex.x, eax</code></pre><br /><br />A simple, yet effective optimization ;)</div>
    <div class="meta">Posted on 2004-06-07 02:12:22 by Scali</div>
   </div>
   <div class="post" id="post-143110">
    <div class="subject"><a href="#post-143110">DX9 GameCoding with optional oop support</a></div>
    <div class="body">It's because I'm actually converting the values from integer to floating point - the load instruction is fild (load fpu from integer) , while the store instruction is fstp (store fpu as float) :)<br />I'll keep your observation in mind, all the same.</div>
    <div class="meta">Posted on 2004-06-07 08:00:07 by Homer</div>
   </div>
   <div class="post" id="post-143178">
    <div class="subject"><a href="#post-143178">DX9 GameCoding with optional oop support</a></div>
    <div class="body">The 2DPanel Class was expanded slightly - 2DPanels can now be created as either a static or a button, and switched between these states at will (buttons can be disabled).<br />We introduce a new method called SetCallBack which takes one parameter, a pointer to a function of our choosing. In the attached example, I first create a 2DPanel, then turn it into a button by calling its SetCallBack method, and then setting its bIsButton flag to TRUE.<br />Our CallBack in this example simply messageboxes then returns.<br />There is no current support for resizing the window, that should probably come next, but at any rate, it would be trivial at this point to put together a menu system..<br /><br />In the current example, MouseClick detection works as follows: we have a global boolean flag &quot;UserClicked&quot; which is normally FALSE. MouseClicks generate a WM_LBUTTONDOWN that is sent to the main application window. WndProc catches it, notes the mousecursor coordinates where the click event occured, and sets UserClicked to TRUE. 2DPanels which are Buttons will check if the mouseclick coordinate lays within the bounds of their own rectangle (rc field), and if so, will switch the UserClicked flag back to FALSE (telling other instances to quit handling the click event) and then call their own CallBack function.<br /><br />Since all this checking is done from within the 2DPanel class's Render method, we'll only ever perform it on 2DPanels that are on the screen at the time (for the example of a menu system versus in-game panels...)<br /><br />Any suggestions on improving this mechanism?</div>
    <div class="meta">Posted on 2004-06-08 01:24:03 by Homer</div>
   </div>
   <div class="post" id="post-143181">
    <div class="subject"><a href="#post-143181">DX9 GameCoding with optional oop support</a></div>
    <div class="body">&quot;heh&quot; nice idea making a 3d-menu.<br /><br />would be nice, chasing buttons in a 3d- environment.<br />plenty possibilities to make button effects.</div>
    <div class="meta">Posted on 2004-06-08 02:00:00 by Siekmanski</div>
   </div>
   <div class="post" id="post-143182">
    <div class="subject"><a href="#post-143182">DX9 GameCoding with optional oop support</a></div>
    <div class="body">You can do something like in the &quot;PICK&quot; example from the dx9-sdk and make real 3d buttons.</div>
    <div class="meta">Posted on 2004-06-08 02:06:02 by Siekmanski</div>
   </div>
   <div class="post" id="post-143183">
    <div class="subject"><a href="#post-143183">DX9 GameCoding with optional oop support</a></div>
    <div class="body">This wouldn't make a 3D menu exactly - the 2DPanel class provides rendering for textured static/button 2D rectangles - you could achieve all kinds of neat effects by messing with the uv values etc. maybe I should switch to using mousepick :) <br />As I was saying, the 2D limitation is imposed deliberately by the choice of vertex format (rhw), which tells DirectX not to further transform the vertices.<br />This causes the 2DPanels to be &quot;stamped&quot; on the screen, no matter what we do to the view (eg move the camera around), and allows us to define the rectangles in &quot;screen space&quot;, ie X,Y,1<br />This way we could have our menu as floating buttons that appear on top of the current gamescene etc, and we can use the 2DPanel class to draw anything that we want to always stay on the screen, like maybe the player's above-view map of the area around them, their healthbar, that kind of thing.. the stuff that gets drawn last over the top of the scene.</div>
    <div class="meta">Posted on 2004-06-08 02:13:31 by Homer</div>
   </div>
   <div class="post" id="post-143184">
    <div class="subject"><a href="#post-143184">DX9 GameCoding with optional oop support</a></div>
    <div class="body">You beat me to the PICK comment lol I was typing too slow :tongue:</div>
    <div class="meta">Posted on 2004-06-08 02:14:44 by Homer</div>
   </div>
   <div class="post" id="post-143189">
    <div class="subject"><a href="#post-143189">DX9 GameCoding with optional oop support</a></div>
    <div class="body">This example proves that the 2DPanel oop class is working correctly - I create three buttons using it, and associate each with a different callback.<br />The buttons can be made any size, the texture is automatically stretched due to the nature of uv mapping.</div>
    <div class="meta">Posted on 2004-06-08 02:57:52 by Homer</div>
   </div>
   <div class="post" id="post-143190">
    <div class="subject"><a href="#post-143190">DX9 GameCoding with optional oop support</a></div>
    <div class="body">Working OK<br /><br />Only when I click 2 times on a button the message-box gets behind the main screen and app. crashes.<br />(I know message box is only there for testing but, wanted to let you know)</div>
    <div class="meta">Posted on 2004-06-08 03:12:00 by Siekmanski</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=18416&amp;page=1" style="">&laquo;</a><a href="../?id=18416&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="18416" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=18416&amp;page=3">&gt;</a><a href="../?id=18416&amp;page=3">&raquo;</a></form>  </div>
 </body>
</html>