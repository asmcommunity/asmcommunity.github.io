<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Program test (04-27-2004) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18153" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18153">Program test (04-27-2004)</a></p>
   <div class="post" id="post-140287">
    <div class="subject"><a href="#post-140287">Program test (04-27-2004)</a></div>
    <div class="body">Hi All,<br /><br />This program is a replacement for those of us that still<br />like the old M$ Office desktop Toolbar and drop down <br />Menu to launch programs.<br /><br />You can use the application icon or choose a different icon<br />or bitmap for the Toolbar buttons.<br /><br />I had a hard time getting rid of the flicker in the maint<br />Listboxes when using the up/down arrows, but it's gone.<br /><br />Let me know if it works.<br /><br />Thanks,<br /><br />Ewayne<br /><br />Previous downloads (97)<br /><br />Update 05-02-2004</div>
    <div class="meta">Posted on 2004-04-27 14:04:03 by Ewayne</div>
   </div>
   <div class="post" id="post-140298">
    <div class="subject"><a href="#post-140298">Program test (04-27-2004)</a></div>
    <div class="body">Really neat :thumbsup: Works on XP. One thing though:<br /><br />Could you after adding something could you make the Close button also Update with the changes? I thought it was broken at first :) then I realized I had to Update.<br /><br />Cheers,<br />Jimmy</div>
    <div class="meta">Posted on 2004-04-27 16:54:53 by JimmyClif</div>
   </div>
   <div class="post" id="post-140360">
    <div class="subject"><a href="#post-140360">Program test (04-27-2004)</a></div>
    <div class="body">Hi Jimmy,<br /><br />I sort of programed it that way so that if you made some changes<br />and then decided you did not want to make the changes permanent<br />you can press close to exit.<br /><br />I have made a visual indicator showing that changes  were made and<br />I also added a message box for the close button if changes were<br />made and not updated, it will allow you to go back and do the updates<br />or exit without updating.<br /><br />You can go to the first post on this thread for the update.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2004-04-28 13:48:57 by Ewayne</div>
   </div>
   <div class="post" id="post-140471">
    <div class="subject"><a href="#post-140471">Program test (04-27-2004)</a></div>
    <div class="body">Hi Ewayne,<br /><br />Why not make an Ok and Cancel button? Anyays, the messagebox will be fine for me. I hope you're pleased to hear that I disabled my QuickLoad Bar and instead am running your Appload in my Startup Folder.<br /><br />Thanks,<br />Jimmy</div>
    <div class="meta">Posted on 2004-04-29 11:44:16 by JimmyClif</div>
   </div>
   <div class="post" id="post-140484">
    <div class="subject"><a href="#post-140484">Program test (04-27-2004)</a></div>
    <div class="body">Hi All,<br /><br />I added a &quot;y&quot; offset to the Toolbar.<br /><br />I also SetCurrentDirectory of the directory of the executing program<br />before I launch it.<br /><br />I had tested the AppLoad on a couple of my programs that had support<br />files and they worked ok, but  when I looked at the programs I saw<br />that I got the current directory from the command line, so that was not<br />a very good test.<br /><br />Does anyone know how if there is an open application and then launch<br />a program from AppLoad and then closing it, to set the focus back to <br />the open application?<br /><br />You can go to the first post of this thread for the update.<br /><br />Thanks,<br /><br />Ewayne<br /><br /><br />To Jimmy:<br /><br />Thanks for the support.<br /><br />I thought about a Update and Cancel button, but the update would<br />get a little messy if it was not done in it's own dialog, but I could change it.</div>
    <div class="meta">Posted on 2004-04-29 15:14:34 by Ewayne</div>
   </div>
   <div class="post" id="post-140509">
    <div class="subject"><a href="#post-140509">Program test (04-27-2004)</a></div>
    <div class="body">No don't worry.. :) No need for it. The Red &amp; Green Update helps me out a lot.<br /><br />For your question:<br /><br />Does anyone know how if there is an open application and then launch a program from AppLoad and then closing it, to set the focus back to the open application?<br /><br />The only way I know is to scan thru all the windows and find the one which is currently enabled. Save the handle and then call SetActiveWindow in combination with SetForegroundWindow. I honestly don't know atm how to figure out how to know when the process you started stopped. :( (maybe using debug mode?)<br /><br />Here's a little snippet I recently wrote - modified to suit your needs<br /><br /><pre><code><br />EnumAllWindows&#58;<br /><br /> invoke EnumWindows, offset EnumWindowCallBack, NULL<br /><br />ret<br /><br /><br />EnumWindowCallBack proc handle&#58;DWORD, nada&#58;DWORD<br />   <br /> invoke GetParent, handle<br /> .IF eax == NULL ;No parent<br />  invoke IsWindowEnabled, handle<br />  .IF eax != NULL ;If the WIndow has keyboard and mouseinput<br />    m2m LastVisibleWindow, handle<br />    mov eax, FALSE ;FALSE to stop<br />    ret<br />  .ENDIF<br /> .ENDIF<br /> mov eax, TRUE <br />ret<br />EnumWindowCallBack endp<br /></code></pre><br /><br />and then just <br /><br />call SetActiveWindow, LastVisibleWindow and call SetForeGroundWindow, LastVisibleWindow</div>
    <div class="meta">Posted on 2004-04-29 20:27:59 by JimmyClif</div>
   </div>
   <div class="post" id="post-140573">
    <div class="subject"><a href="#post-140573">Program test (04-27-2004)</a></div>
    <div class="body">Hi Ewayne,<br /><br />I just realized that when you just change the order of the Toolbar Icons the Update button will not give me green light, so my changes will get discarded unless I modify something else.</div>
    <div class="meta">Posted on 2004-04-30 16:30:46 by JimmyClif</div>
   </div>
   <div class="post" id="post-140583">
    <div class="subject"><a href="#post-140583">Program test (04-27-2004)</a></div>
    <div class="body">Also, even though it saves the Top Pos inside the ini file, it still sets itself at ypos 0 when I restart it.<br /><br />----------<br /><br />And while I was thinking about it... To see what window was last active, the enumwindow thing hardly would work (realized that a little late:)) But if I understand the WinHelp correctly the last active window handle should get sent to you in form of a WM_ACTIVATE message. If that works - the rest should be a piece of cake.</div>
    <div class="meta">Posted on 2004-04-30 18:00:34 by JimmyClif</div>
   </div>
   <div class="post" id="post-140588">
    <div class="subject"><a href="#post-140588">Program test (04-27-2004)</a></div>
    <div class="body">Hi Jimmy,<br /><br />I fixed the green light when moving a Toolbar or Menu item.<br /><br />Thanks for the enumerate code, but I was already there plus<br />I enumerated task and they would work fine if there was only<br />one user logged on and only one window open, else you don't<br />know what window you will end up with.<br /><br />I have also been down the WM_ACTIVATE and WM_ACTIVATEAPP<br />road and everthing else I can think of.<br /><br />The problem with WM_ACTIVATE and wParam = WA_ACTIVE is<br />lParam is always 0??<br /><br />I'm still playing with the WM_ACTIVATEAPP message.<br /><br />It's not a big thing, but if the M$ Office program can do it then there<br />is a way. When I get hung up on a problem like this I don't quit<br />untill I find a solution.<br /><br />You can go to the first post on this thread for the update.<br /><br />Thanks again for your help.<br /><br />Ewayne</div>
    <div class="meta">Posted on 2004-04-30 19:29:02 by Ewayne</div>
   </div>
   <div class="post" id="post-140600">
    <div class="subject"><a href="#post-140600">Program test (04-27-2004)</a></div>
    <div class="body">Hi Ewayne,<br /><br />Bad news, it still doesn't remember the Y-pos.<br /><br />But good news: (I just save a bunch of money on my car insurance by switch....) I got the API you're looking for :<br /><br />GetNextWindow using GW_HWNDPREV as search criteria. / You might want to grab the taskbar handle and discard that one in case it comes up as the last window. But I don't see no reason why this shouldn't work.<br /><br />Cheers,<br />Jimmy<br /><br />PS: Yes, afaik lParam is always 0.. It's always 0 if the previous handle wasn't created in the same process. schucks.</div>
    <div class="meta">Posted on 2004-04-30 23:18:22 by JimmyClif</div>
   </div>
   <div class="post" id="post-140605">
    <div class="subject"><a href="#post-140605">Program test (04-27-2004)</a></div>
    <div class="body">Hi Jimmy,<br /><br />The bad news is I have already tried GetNextWindow using GW_HWNDPREV<br />and my system did not like GetNextWindow, but the GetWindow using GW_HWNDPREV<br />does the same thing and I still end up with 0 for the handle. Probably a process thing.<br /><br />I added Tabs to the dialog boxes so you can use the keyboard.<br /><br />About the &quot;y&quot; position when you open the options dialog box does it show<br />the proper value in the edit window?<br /><br />What OS are you using? (It should not make any difference)<br /><br />If you still have trouble with the &quot;y&quot; thing I will post a test AppLoad so we can <br />see what's going on.<br /><br />You can go to the first post on this thread for the update.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2004-05-01 02:26:35 by Ewayne</div>
   </div>
   <div class="post" id="post-140636">
    <div class="subject"><a href="#post-140636">Program test (04-27-2004)</a></div>
    <div class="body">Sorry to hear the GetNextWindow didn't work. Alright - I'm done guessing. :(<br /><br />&gt;&gt; About the &quot;y&quot; position when you open the options dialog box does it show the proper value in the edit window?<br /><br />No, it doesn't - only shows 0 in the dialog. Shows 5 inside the ini file though.<br /><br />I use WinXP.</div>
    <div class="meta">Posted on 2004-05-01 22:43:31 by JimmyClif</div>
   </div>
   <div class="post" id="post-140641">
    <div class="subject"><a href="#post-140641">Program test (04-27-2004)</a></div>
    <div class="body">Hi Jimmy,<br /><br />Thanks for all of your help.<br /><br />I can return to the proper window most of the time by<br />sending Alt+Esc when I receive the WM_ACTIVATE message<br />and wParam = WA_ACTIVE and lParam = 0.<br /><br />But i'm still not happy with it.<br /><br />About the &quot;y&quot; thingy, maybe none of the options are being<br />extracted.<br /><br />Can you change the &quot;x&quot; position or the Toolbar style and have<br />the program load with the proper settings?<br /><br />Do you have the Home or Pro version?<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2004-05-01 23:49:49 by Ewayne</div>
   </div>
   <div class="post" id="post-140666">
    <div class="subject"><a href="#post-140666">Program test (04-27-2004)</a></div>
    <div class="body">I have the Home Edition. SP1 installed.<br /><br />For the options, everything works.. When I change the x position or enable flat toolbars then changes will load correctly on startup.</div>
    <div class="meta">Posted on 2004-05-02 07:28:06 by JimmyClif</div>
   </div>
   <div class="post" id="post-140670">
    <div class="subject"><a href="#post-140670">Program test (04-27-2004)</a></div>
    <div class="body">Ewayne nice program. The command line browse button shows .ico etc as the file type when searching for an executable. Shouldn't this be .exe? Also i think it would be better if u put the browse button for the command line where the command line text is. Its kinda confusing a bit having the browse button all the way at the bottom.</div>
    <div class="meta">Posted on 2004-05-02 07:38:10 by smurf</div>
   </div>
   <div class="post" id="post-140723">
    <div class="subject"><a href="#post-140723">Program test (04-27-2004)</a></div>
    <div class="body">Hi Jimmy,<br /><br />Try this test program.<br /><br />When you load the program you should see four message boxes.<br /><br />1. Length of the y position in the ini file.<br />2. Path to the ini file.<br />3. Ascii value of the y position in the ini file.<br />4. Value of the y position after converting from ascii.<br /><br />Let me know what you get.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2004-05-02 14:17:36 by Ewayne</div>
   </div>
   <div class="post" id="post-140724">
    <div class="subject"><a href="#post-140724">Program test (04-27-2004)</a></div>
    <div class="body">Hi smurf,<br /><br />I fixed the file open filter(It was right at one time).<br /><br />I agree with you about the browse button confusion, so<br />I changed that.<br /><br />You can go to the first post on this thread for the update.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2004-05-02 14:28:23 by Ewayne</div>
   </div>
   <div class="post" id="post-140735">
    <div class="subject"><a href="#post-140735">Program test (04-27-2004)</a></div>
    <div class="body">Ewayne here's what happens with your ApploadT:<br /><br />First start:<br /><br />---------------------------<br />Display Base Values<br />---------------------------<br />Dec.  1          <br /><br />Hex.  00000001                         <br /><br />Bin.   1<br />---------------------------<br />OK   <br />---------------------------<br /><br /><br />---------------------------<br />AppLoad<br />---------------------------<br />E:\Programs\apploadt\AppLoad.ini<br />---------------------------<br />OK   <br />---------------------------<br /><br /><br />---------------------------<br />AppLoad<br />---------------------------<br />0<br />---------------------------<br />OK   <br />---------------------------<br /><br /><br />---------------------------<br />Display Base Values<br />---------------------------<br />Dec.   0         <br /><br />Hex.  00000000                         <br /><br />Bin.   <br />---------------------------<br />OK   <br />---------------------------<br /><br /><br />After changing the ypos to 5 it correctly saves to the ini file<br /><br /><br /><br /><br /><br /><br />FlatButtons=0<br />AlwaysOnTop=1<br />ShowToolTip=1<br />TopPos=5<br />RightPos=54<br /><br /><br /><br />But on reloading I get all Messageboxes the same except:<br /><br />---------------------------<br />AppLoad<br />---------------------------<br />5<br />---------------------------<br />OK   <br />---------------------------<br /><br /><br />Hope this helps.<br /><br />PS: I CTRL-C'ed the MessageBoxes... The last Msgbox does in fact not show a number for Bin.</div>
    <div class="meta">Posted on 2004-05-02 19:41:56 by JimmyClif</div>
   </div>
   <div class="post" id="post-140744">
    <div class="subject"><a href="#post-140744">Program test (04-27-2004)</a></div>
    <div class="body">Hi Jimmy,<br /><br />Sorry about the bug.<br /><br />If you would have used a value &gt; 9 you you would not have seen the bug.<br /><br />For some reason (that I don't know) if the length was not 2 I ignored it.<br /><br />You can go to the first post on this thread for the update.<br /><br />Thanks,<br /><br />Ewayne</div>
    <div class="meta">Posted on 2004-05-02 21:33:47 by Ewayne</div>
   </div>
   <div class="post" id="post-140745">
    <div class="subject"><a href="#post-140745">Program test (04-27-2004)</a></div>
    <div class="body">No worries... I'm glad it's solved :)</div>
    <div class="meta">Posted on 2004-05-02 22:09:09 by JimmyClif</div>
   </div>
  </div>
 </body>
</html>