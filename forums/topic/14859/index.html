<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Trouble getting numbers from spreadsheet - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14859" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=14859">Trouble getting numbers from spreadsheet</a></p>
   <div class="post" id="post-115318">
    <div class="subject"><a href="#post-115318">Trouble getting numbers from spreadsheet</a></div>
    <div class="body">KetilO,<br /><br />I'm using your spreadsheet control, Version 0.0.0.5 dated 3 June 2003.  Everything was working great until, I wrote a routine to write a report based on the contents of a spreadsheet.  In the routine I use SPRM_GETCELLDATA.  Number cells with decimal places--or just a decimal point--show up fine, but when the contents of a cell are changed, if the number isn't entered with a decimal, the GETCELLDATA message returns a 0.0 no matter what the contents are!  This is for FLOAT type cells.<br /><br />The numbers on the screen and recalculations based on the numbers are all correct, just not the GETCELLDATA results.  I tried using GETCELLTYPE to see if the type changed, but GETCELLTYPE doesn't seem to work for me, even after immediately setting the cell contents and type.  The return value from GETCELLTYPE always returns zero.<br /><br />Is there something I might be doing wrong, or some error checking I might be able to do before getting the data.<br /><br />Thanks for any help, and thanks a Lot for the spreadsheet.<br /><br />farrier</div>
    <div class="meta">Posted on 2003-08-24 20:04:02 by farrier</div>
   </div>
   <div class="post" id="post-115367">
    <div class="subject"><a href="#post-115367">Trouble getting numbers from spreadsheet</a></div>
    <div class="body">Hi  farrier<br /><br />You must check the returned type. It can be an integer.<br />I will check whats wrong with SPRM_GETCELLTYPE.<br /><br />Included is a little test to show how.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-08-25 02:32:21 by KetilO</div>
   </div>
   <div class="post" id="post-115371">
    <div class="subject"><a href="#post-115371">Trouble getting numbers from spreadsheet</a></div>
    <div class="body">KetilO,<br /><br />Thanks!!<br /><br />farrier</div>
    <div class="meta">Posted on 2003-08-25 02:44:32 by farrier</div>
   </div>
   <div class="post" id="post-115475">
    <div class="subject"><a href="#post-115475">Trouble getting numbers from spreadsheet</a></div>
    <div class="body">Where does one obtain a copy of KetilO's Spreadsheet control?</div>
    <div class="meta">Posted on 2003-08-25 20:27:11 by msmith</div>
   </div>
   <div class="post" id="post-115499">
    <div class="subject"><a href="#post-115499">Trouble getting numbers from spreadsheet</a></div>
    <div class="body">Hi  msmith<br /><br />It can be found on my website.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-08-26 01:52:48 by KetilO</div>
   </div>
   <div class="post" id="post-116099">
    <div class="subject"><a href="#post-116099">Trouble getting numbers from spreadsheet</a></div>
    <div class="body">KetilO,<br /><br />From my experiments it appears that when getting the cell contents from a cell with a formula, the results are always 'float'  (Using SPRM_GETCELLDATA)<br /><br />Is that correct?  Even when just adding 2 integers?<br /><br />Thanks,<br /><br />farrier</div>
    <div class="meta">Posted on 2003-08-29 06:32:15 by farrier</div>
   </div>
   <div class="post" id="post-116123">
    <div class="subject"><a href="#post-116123">Trouble getting numbers from spreadsheet</a></div>
    <div class="body">Hi  farrier<br /><br />Correct.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-08-29 08:48:27 by KetilO</div>
   </div>
   <div class="post" id="post-116231">
    <div class="subject"><a href="#post-116231">Trouble getting numbers from spreadsheet</a></div>
    <div class="body">KetilO,<br /><br />Thanks again!<br /><br />This is helping me alot!<br /><br />farrier</div>
    <div class="meta">Posted on 2003-08-30 01:05:28 by farrier</div>
   </div>
  </div>
 </body>
</html>