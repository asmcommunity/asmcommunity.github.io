<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>MASM produced .lib with VC++ - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6407" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6407">MASM produced .lib with VC++</a></p>
   <div class="post" id="post-46098">
    <div class="subject"><a href="#post-46098">MASM produced .lib with VC++</a></div>
    <div class="body">I have produced a dll with MASM and used a def file to export 1 function.....<br /><br />I can use the .lib to statically link to this dll with another MASM program.....No problem<br /><br />But I tried to use this dll with VC++ and I cant get the static link.....It complains that the symbol is unresolved......<br />I tried to declare it &quot;extern &quot;C&quot;&quot; but still to no avail........<br /><br />Is there any easy way to fix this? Or am I stuck with dynamic linking?<br /><br />Thanks in advance</div>
    <div class="meta">Posted on 2002-07-02 15:34:29 by Fordy</div>
   </div>
   <div class="post" id="post-46099">
    <div class="subject"><a href="#post-46099">MASM produced .lib with VC++</a></div>
    <div class="body">What symbol is the compiler looking for (it's exact name)? <br />You should use extern &quot;C&quot; at least unless you want to figure out the ugly C++ name decorations.. However did you use the right calling convention? The default in masm is STDCALL while C uses cdecl. Try adding __stdcall to your C function header.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-07-02 15:38:35 by Thomas</div>
   </div>
   <div class="post" id="post-46100">
    <div class="subject"><a href="#post-46100">MASM produced .lib with VC++</a></div>
    <div class="body">Ha...excellent...the __stdcall worked.....<br /><br />I didnt consider that!<br /><br />Thank you very much</div>
    <div class="meta">Posted on 2002-07-02 15:41:36 by Fordy</div>
   </div>
   <div class="post" id="post-46142">
    <div class="subject"><a href="#post-46142">MASM produced .lib with VC++</a></div>
    <div class="body">Just to be anal: you don't link statically to a DLL. To link statically<br />means to include code from a .lib file in your executable. When you<br />include an <strong>import library</strong> for a DLL, you link implicitly - not statically :).<br />LoadLibrary + GetProcAddress is explicit linking/loading of a DLL.</div>
    <div class="meta">Posted on 2002-07-03 05:28:05 by f0dder</div>
   </div>
  </div>
 </body>
</html>