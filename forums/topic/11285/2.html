<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Passing typed string to procedure like in VB... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=11285" />
  <link rel="prev" href="../?id=11285&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=11285">Passing typed string to procedure like in VB...</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=11285&amp;page=1" style="">&laquo;</a><a href="../?id=11285&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="11285" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-85651">
    <div class="subject"><a href="#post-85651">Passing string to procedure like in VB...</a></div>
    <div class="body">I made the buffer global like you said, it's not working, I get compile errors.<br /><br />But the function works the same way as in DLL the otherway, you answered the question.</div>
    <div class="meta">Posted on 2003-03-07 16:20:08 by Knight Chat X</div>
   </div>
   <div class="post" id="post-85659">
    <div class="subject"><a href="#post-85659">Passing string to procedure like in VB...</a></div>
    <div class="body"><div class="quote"><em>sluggy qutoed</em><br /><strong>Sorry, but that is the funniest thing i have heard in a long time, who told it to you? :rolleyes: This is so wrong i'm surprised they didn't try to sell you the Statue of Liberty at the same time ;)</div><br /><br /><br />REALLY?!??!?!?!  WOW man, i never knew that.. that is soooooo awsome, I could use assembly in VB?!?!?!  Coool!<br /><br /><br />Well, it is kind of true.  NOT in the VB IDE ( no form, module, class or whatnot)  You can by a hack change what the vb link does....   Maybe that is what the OP was talking about?  Dunno.  Oh, the OP is KCX.  didn't see that<br /><br />Dude, I have been using VB for the past 5+ years and I NEVER heard that...  You are dreaming.  You can modify the way link acts in VB6 but that is it.. you cannot use assembly with VB unless it is a dll or such...<br /><br />So, you have compile errors... we all get em... post your code... we are not mind readers.. :grin: (I wish)<br /><br />I just read more of your post KCX, and you do not have to create a window in Sub Main!  And you cannot remove all remove all referances in your project!<br /><br />Like I said, post the code you are getting errors with and I will help ya out...</div>
    <div class="meta">Posted on 2003-03-07 17:33:14 by Gunner</div>
   </div>
   <div class="post" id="post-85723">
    <div class="subject"><a href="#post-85723">Passing string to procedure like in VB...</a></div>
    <div class="body">I don't use VB at all but I would think that since it is not a true compiled language it would have trouble with ASM code. Though there is a company that claims to have an addin for this <a target="_blank" href="http://www.banasoft.net/MakeEx.htm">here</a> , I don't have VB so I have never checked it.<br /><br />Donkey</div>
    <div class="meta">Posted on 2003-03-07 23:49:32 by donkey</div>
   </div>
   <div class="post" id="post-85729">
    <div class="subject"><a href="#post-85729">Passing string to procedure like in VB...</a></div>
    <div class="body">Never heard of that one, here's another Add-In:<br /><a target="_blank" href="http://www.TweakVB.com">http://www.TweakVB.com</a></div>
    <div class="meta">Posted on 2003-03-08 00:47:03 by Knight Chat X</div>
   </div>
   <div class="post" id="post-85740">
    <div class="subject"><a href="#post-85740">Passing string to procedure like in VB...</a></div>
    <div class="body">Gunner, here's the asm file:</div>
    <div class="meta">Posted on 2003-03-08 02:46:48 by Knight Chat X</div>
   </div>
   <div class="post" id="post-85821">
    <div class="subject"><a href="#post-85821">Passing string to procedure like in VB...</a></div>
    <div class="body">I could not run it properly to test it because it seems to be missing a few things (resource file and a few variables) but I changed a few things and commented em.<br /><br />You should spell out the data types i.e. don't use db, dw, dd instead use BYTE, WORD and DWORD etc since I think you gotten confused because you declared the buffer as a word when the api returns a dword...<br /><br />The changes should work.</div>
    <div class="meta">Posted on 2003-03-08 11:13:37 by Gunner</div>
   </div>
   <div class="post" id="post-85874">
    <div class="subject"><a href="#post-85874">Passing string to procedure like in VB...</a></div>
    <div class="body">Wasn't able to upload anything but the .asm file, I get upload problems from ISP alot it's annoying...<br /><br />Tried out that modified file, it compiles now, but MessageBox doesn't popup at all. =o(</div>
    <div class="meta">Posted on 2003-03-08 17:30:02 by Knight Chat X</div>
   </div>
   <div class="post" id="post-85876">
    <div class="subject"><a href="#post-85876">Passing string to procedure like in VB...</a></div>
    <div class="body">You can zip up the needed files and attach the zip file here. :)</div>
    <div class="meta">Posted on 2003-03-08 17:35:31 by Gunner</div>
   </div>
   <div class="post" id="post-85886">
    <div class="subject"><a href="#post-85886">Passing string to procedure like in VB...</a></div>
    <div class="body">ok, here's the code with the icon &amp; rc files, I changed the buffer to DWORD like you said, yep I was getting it a bit mixed up.<br /><br />The code compile's, but now the MessageBox won't display.</div>
    <div class="meta">Posted on 2003-03-08 18:32:26 by Knight Chat X</div>
   </div>
   <div class="post" id="post-85892">
    <div class="subject"><a href="#post-85892">Passing string to procedure like in VB...</a></div>
    <div class="body">WORD is rarely used.<br /><br /><pre><code><br />...<br />        mov Wwd, 340<br />        mov Wht, 250<br />...<br />        invoke CreateWindowEx,WS_EX_OVERLAPPEDWINDOW,<br />                              ADDR szClassName,<br />                              ADDR szDisplayName,<br />                              WS_OVERLAPPEDWINDOW,<br />                              Wtx,Wty,Wwd,Wht,<br />                              NULL,NULL,<br />                              hInst,NULL<br /></code></pre><br /><br />could be used as<br /><pre><code><br />        invoke CreateWindowEx,WS_EX_OVERLAPPEDWINDOW,<br />                              ADDR szClassName,<br />                              ADDR szDisplayName,<br />                              WS_OVERLAPPEDWINDOW,<br />                              Wtx,Wty,340,250,<br />                              NULL,NULL,<br />                              hInst,NULL<br /></code></pre></div>
    <div class="meta">Posted on 2003-03-08 20:19:14 by roticv</div>
   </div>
   <div class="post" id="post-85902">
    <div class="subject"><a href="#post-85902">Passing string to procedure like in VB...</a></div>
    <div class="body">Nice, since ya looked at the code, were you able to get MessageBox to display the information in the txtbuffer?<br /><br />See the window's create message is supposed to fire the test procedure when the main window is first loaded, when this happens the window text is stored in global variable then the data in the variable is displayed, this is just for testing, for some reason everything compiles without error, but the MessageBox will not pop up... =o(</div>
    <div class="meta">Posted on 2003-03-08 22:00:09 by Knight Chat X</div>
   </div>
   <div class="post" id="post-85905">
    <div class="subject"><a href="#post-85905">Passing string to procedure like in VB...</a></div>
    <div class="body">The attachment works.<br /><br />The message box is not showing because your have to return 0 if you process WM_CREATE, which you are not.  after invoke ShowTextBoxText,hWin add:<br />xor eax, eax<br />ret<br /><br />and your message box will show.. It will show garbled text but that is a differant story.<br /><br />I would suggest reading some more messages on this board about strings and some tutorials..</div>
    <div class="meta">Posted on 2003-03-08 22:14:42 by Gunner</div>
   </div>
   <div class="post" id="post-85910">
    <div class="subject"><a href="#post-85910">Passing string to procedure like in VB...</a></div>
    <div class="body">ok, I'll do that then, I don't understand why it'll show the MessageBox when using a local buffer in the procedure compared to when it's using a global buffer though, should work the same...<br /><br />The second the main window loads and the create message fires, it's kinda like the initialize/Form_Load event in VB to me.....</div>
    <div class="meta">Posted on 2003-03-08 22:37:21 by Knight Chat X</div>
   </div>
   <div class="post" id="post-85917">
    <div class="subject"><a href="#post-85917">Passing string to procedure like in VB...</a></div>
    <div class="body">I used a local to hold the pointer to the buffer because I do not see a need to make it global.  Once the procedure is done, the pointer to the buffer is useless.<br /><br />I missed that not returning 0 for WM_CREATE in your code originally.  Then I went over it again and that caught my eye.  So I added the correct code, and it works.<br /><br />If you have a quick connection (DSL+) download the Platform SDK, it will describe all the apis and messages and how you have to handle them...</div>
    <div class="meta">Posted on 2003-03-08 22:57:02 by Gunner</div>
   </div>
   <div class="post" id="post-85920">
    <div class="subject"><a href="#post-85920">Passing string to procedure like in VB...</a></div>
    <div class="body">You really worked out that code, yea, the idea was to use a global buffer to store text after the procedure had been run, then later re-use the buffer when needed if possible, but you've helped me enuff on this question so I'll move forward now and try and review all of this.<br /><br />Platform SDK, hmmm, got a copy of that somewhere on CD.  =o)<br /><br />Maybe someday I'll be able to help you in return as you've helped me, many thanks, see ya later...</div>
    <div class="meta">Posted on 2003-03-08 23:10:33 by Knight Chat X</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=11285&amp;page=1" style="">&laquo;</a><a href="../?id=11285&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="11285" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>