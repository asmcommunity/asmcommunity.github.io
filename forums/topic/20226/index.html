<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>is it possible to update my own import-dir - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20226" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20226">is it possible to update my own import-dir</a></p>
   <div class="post" id="post-154897">
    <div class="subject"><a href="#post-154897">is it possible to update my own import-dir</a></div>
    <div class="body">hi all,<br />i use statically linked dll's in my program ... or rather ... i have to.<br />is there a way to unload a dll completetly from my process, reload it<br />dynamicaly via LoadLibrary and update all the entries in my import-dir?<br /><br />in case you think it's suspicious - it's not ... im writing interfaces for cad<br />systems and i have to implement their frameworks into my projects - which<br />is a common task. not so common is that when i kill a session i can not<br />create a new one in a specific cad system. only when i restart my<br />application. i thought reseting everything myself could be ... fine?<br /><br />is it legal at all (my first guess was: yes) and has anyone ever tried it?<br />thanks,<br />paul  :shock:  :shock:  :shock:</div>
    <div class="meta">Posted on 2004-12-28 09:10:45 by mob</div>
   </div>
   <div class="post" id="post-154901">
    <div class="subject"><a href="#post-154901">is it possible to update my own import-dir</a></div>
    <div class="body">Are you writing the DLL for a closed-source application, or are you writing an application that loads closed-source DLLs? If you're in control of the application, why do you have to use implicit (not static) DLL linkage?</div>
    <div class="meta">Posted on 2004-12-28 10:32:53 by f0dder</div>
   </div>
   <div class="post" id="post-154959">
    <div class="subject"><a href="#post-154959">is it possible to update my own import-dir</a></div>
    <div class="body">i tried that but i have tons of header files, extern objects and whatnot.<br />fixing all that would cost me way more time than going into my import dir.<br />i still have to be able to work like before - well, i see ... i'll just try it out.</div>
    <div class="meta">Posted on 2004-12-29 05:54:58 by mob</div>
   </div>
   <div class="post" id="post-154981">
    <div class="subject"><a href="#post-154981">is it possible to update my own import-dir</a></div>
    <div class="body">hehe, interfaces, the language is a interface to the machine,the 0 and 1 are a interface for understand opcodes, the opcodes are the interface that is used for instruct the processor :). Dont know but is funny ;).<br /><br />My only sugestion and I dont know if f0dder is refering to that with &quot;why do you have to use implicit (not static) DLL linkage?&quot; you need a function for &quot;recognogize&quot; the interface and load it, and one for unload the interface.<br /><br />You can have global variables for hold the addresses of the functions of the DLL, or you can pass a structure with a model for the names of the functions :), you can get the space like if where a global var, or you can allocate the space for this one at runtim with alloc or some....<br /><br /><br />The point with a Interface is to know how/forwhat analize the stronges of your interface and weakness of it... if there is already the interface, you should know it... if there is no interface and there are already a lot of include files and suchs... that would be a problem :D.<br /><br />In principle you only need: a recognogizer and loader, a unloader for the main app (the one that will load the interface) and then for the interface you should use some for: Initialization, deinitialization specially and one for check compatibility of the interface (for example can return a number for check if the actual DLL module is to old for load it... or too new  and the main app have no suporfor this new Interface), from there, I guess depend on the porpuose of the interface.<br /><br /><br />Is that what you whant to know??? or??<br /><br />I have another interesting way in mind.. but I will see later :D  and dont know if work or already implemented somewhere hehe.</div>
    <div class="meta">Posted on 2004-12-29 10:20:06 by rea</div>
   </div>
   <div class="post" id="post-154982">
    <div class="subject"><a href="#post-154982">is it possible to update my own import-dir</a></div>
    <div class="body">By the way, rereading I guess you already know that ;)...<br /><br /><br />Dont know how the PE structure is, but if the process can overwrite the contents of addresses, I guess, yes you can use the static import library like if where the global variables that I say before... there should not be problem if you handle like that.... pheraphs the order, dont know, would be best if you can write the final application manually (the import libraries for hold a order) with nasm or fasm you can have more control over that, but I guess with masm is near to posible :D...</div>
    <div class="meta">Posted on 2004-12-29 10:25:29 by rea</div>
   </div>
   <div class="post" id="post-155009">
    <div class="subject"><a href="#post-155009">is it possible to update my own import-dir</a></div>
    <div class="body">thank you all<br />well structures here and there ... its not my interface i didn't wrote it but<br />i have to use it. i know the ~PE structure though but i never did or saw<br />something quite like that before so i though i could ask. im not sure what<br />happens to all the extern symbols though - it's c++ at least, so that could<br />be an issue.<br />paul</div>
    <div class="meta">Posted on 2004-12-30 06:10:10 by mob</div>
   </div>
  </div>
 </body>
</html>