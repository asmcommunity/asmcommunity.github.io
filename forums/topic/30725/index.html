<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Simple Write Char To Screen Code - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30725" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=30725">Simple Write Char To Screen Code</a></p>
   <div class="post" id="post-215297">
    <div class="subject"><a href="#post-215297">Simple Write Char To Screen Code</a></div>
    <div class="body">My syntax for labels is simple. Everything that has an underscore before the label name is independent and must be called.<br /><br />Everything That does not have a label is part of something independent and can not be called individually.<br /><br />The problem I am having with my code is the appearance of &quot;ABCD &quot; even though there is no &quot; &quot; char in my code.<br /><br />I feel like it is an imbalance in my PUSH&#039;s and POP&#039;s but alas I am blind to it.<br /><br />Any incite is greatly appreciated.<br /><br /><pre><code>_START:<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Clear Registers<br />&nbsp; &nbsp; XOR&nbsp; &nbsp;  AX, AX<br />&nbsp; &nbsp; XOR&nbsp; &nbsp;  BX, BX<br />&nbsp; &nbsp; XOR&nbsp; &nbsp;  CX, CX<br />&nbsp; &nbsp; XOR&nbsp; &nbsp;  DX, DX<br />&nbsp; &nbsp;  <br />_MAIN:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; CALL&nbsp; &nbsp; _CHECKFORKEY<br />&nbsp; &nbsp; JMP&nbsp; &nbsp;  _MAIN <br /><br />_CHECKFORKEY:<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Store Registers<br />&nbsp; &nbsp; PUSHA <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Set Up For Int<br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AH,1<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Check For Key Press<br />&nbsp; &nbsp; INT&nbsp; &nbsp;  16h&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; ;If Key Press Jump To SKIP<br />&nbsp; &nbsp; JNE&nbsp; &nbsp; &nbsp; SKIP<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Restore Registers<br />&nbsp; &nbsp; POPA&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Return Control<br />&nbsp; &nbsp; RET <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; SKIP:<br />&nbsp; &nbsp; PUSH&nbsp; &nbsp; AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AL, &#039;A&#039;<br />&nbsp; &nbsp; CALL&nbsp; &nbsp; _PRINTCHAR <br />&nbsp; &nbsp; POP&nbsp; &nbsp;  AX<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Check For Backspace<br />&nbsp; &nbsp; CMP&nbsp; &nbsp;  AL, 08h <br />&nbsp; &nbsp; &nbsp; &nbsp; ;If So Move To BACKSPACE<br />&nbsp; &nbsp; JE&nbsp; &nbsp; &nbsp; BACKSPACE<br />&nbsp; &nbsp; PUSH&nbsp; &nbsp; AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AL, &#039;B&#039;<br />&nbsp; &nbsp; CALL&nbsp; &nbsp; _PRINTCHAR <br />&nbsp; &nbsp; POP&nbsp; &nbsp;  AX<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Check For Return<br />&nbsp; &nbsp; CMP&nbsp; &nbsp;  AL, 0Dh&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; ;If So Jump To RETURN<br />&nbsp; &nbsp; JE&nbsp; &nbsp; &nbsp; RETURN <br />&nbsp; &nbsp; PUSH&nbsp; &nbsp; AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AL, &#039;C&#039;<br />&nbsp; &nbsp; CALL&nbsp; &nbsp; _PRINTCHAR <br />&nbsp; &nbsp; POP&nbsp; &nbsp;  AX<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Check For Non-Normal Character<br />&nbsp; &nbsp; CMP&nbsp; &nbsp;  AL, 7Eh&nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; ;If So Jump To FINISHED<br />&nbsp; &nbsp; JG&nbsp; &nbsp; &nbsp; FINISHED <br />&nbsp; &nbsp; PUSH&nbsp; &nbsp; AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AL, &#039;D&#039;<br />&nbsp; &nbsp; CALL&nbsp; &nbsp; _PRINTCHAR <br />&nbsp; &nbsp; POP&nbsp; &nbsp;  AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; CALL&nbsp; &nbsp; _PRINTCHAR<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Check For Non-Normal Character<br />&nbsp; &nbsp; CMP&nbsp; &nbsp;  AL, 20h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; ;If So Jump To FINISHED<br />&nbsp; &nbsp; JL&nbsp; &nbsp; &nbsp; FINISHED&nbsp;  <br />&nbsp; &nbsp; PUSH&nbsp; &nbsp; AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AL, &#039;E&#039;<br />&nbsp; &nbsp; CALL&nbsp; &nbsp; _PRINTCHAR <br />&nbsp; &nbsp; POP&nbsp; &nbsp;  AX<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Print Single Character<br />&nbsp; &nbsp; CALL&nbsp; &nbsp; _PRINTCHAR<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Jump To Finished<br />&nbsp; &nbsp; JMP&nbsp; &nbsp;  FINISHED<br /><br />&nbsp; &nbsp; BACKSPACE:<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Set Up For Int<br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AH, 03h<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Get Cursor Location<br />&nbsp; &nbsp; INT&nbsp; &nbsp;  10h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Set Up For Int<br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AH, 02h<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Check To See If The Current Column Location is &#039;0&#039;<br />&nbsp; &nbsp; CMP&nbsp; &nbsp;  DL, 0<br />&nbsp; &nbsp; &nbsp; &nbsp; ;If So, Jump To Back Line To Bandle Backspace Differently<br />&nbsp; &nbsp; JE&nbsp; &nbsp; &nbsp; BACKLINE <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Set Cursor Location Back By One Column<br />&nbsp; &nbsp; DEC&nbsp; &nbsp;  DL&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Put Cursor Location Back By One Column<br />&nbsp; &nbsp; INT&nbsp; &nbsp;  10h<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Jump To FINISHED<br />&nbsp; &nbsp; JMP&nbsp; &nbsp;  FINISHED<br /><br />&nbsp; &nbsp; BACKLINE:<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Check To See If Cursor Is On The Top Most Line<br />&nbsp; &nbsp; CMP&nbsp; &nbsp;  DH, 0<br />&nbsp; &nbsp; &nbsp; &nbsp; ;If So&nbsp; Jump To NOHIGHER<br />&nbsp; &nbsp; JE&nbsp; &nbsp; &nbsp; NOHIGHER<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Jump To FINISHED (FOR NOW)<br />&nbsp; &nbsp; JMP&nbsp; &nbsp;  FINISHED<br /><br />&nbsp; &nbsp; NOHIGHER:&nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Jump To FINISHED<br />&nbsp; &nbsp; JMP&nbsp; &nbsp;  FINISHED<br /><br />&nbsp; &nbsp; RETURN:<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Set Up Register To Receive Cursor Location<br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AH, 03h <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Call Int <br />&nbsp; &nbsp; INT&nbsp; &nbsp;  10h<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Set Up Registers To Set Cursor Position<br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AH, 02h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Increment The Row<br />&nbsp; &nbsp; INC&nbsp; &nbsp;  DH&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Set The Column To 0<br />&nbsp; &nbsp; XOR&nbsp; &nbsp;  DL, DL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Move The Cursor<br />&nbsp; &nbsp; INT&nbsp; &nbsp;  10h <br /><br />&nbsp; &nbsp; FINISHED:<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Remove Character From Keyboard Buffer And Return To Check<br />&nbsp; &nbsp; CALL&nbsp; &nbsp; _KEYBUFCHAR<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Restore Registers<br />&nbsp; &nbsp; POPA<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Return Control<br />&nbsp; &nbsp; RET<br />&nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Removes One Char From Keyboard Buffer<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Returns Everything Sent To It Exactly As It Was<br />_KEYBUFCHAR:<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Store Register In AX<br />&nbsp; &nbsp; PUSH&nbsp; &nbsp; AX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Set Up Registers For Int<br />&nbsp; &nbsp; XOR&nbsp; &nbsp;  AH, AH&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Call Interrupt To Clear Character<br />&nbsp; &nbsp; INT&nbsp; &nbsp;  16h <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Restore Original Register Value<br />&nbsp; &nbsp; POP&nbsp; &nbsp;  AX&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Return Control<br />&nbsp; &nbsp; RET<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; ;Prints The Char In AL<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Returns Everything Sent To It Exactly As It Was&nbsp; &nbsp; &nbsp; <br />_PRINTCHAR:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Store Register In BX<br />&nbsp; &nbsp; PUSH&nbsp; &nbsp; BX<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Move ASCII Char In AL To BL<br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  BL, AL<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Store AH In AX Register<br />&nbsp; &nbsp; PUSH&nbsp; &nbsp; AX<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Set Up Registers For Int<br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AH, 0Eh <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Set Up Registers For Int<br />&nbsp; &nbsp; MOV&nbsp; &nbsp;  AL, BL<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Call Interrupt To Write <br />&nbsp; &nbsp; INT&nbsp; &nbsp;  10h<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Restore Register In AX<br />&nbsp; &nbsp; POP&nbsp; &nbsp;  AX <br />&nbsp; &nbsp; &nbsp; &nbsp; ;Restore Register In BX<br />&nbsp; &nbsp; POP&nbsp; &nbsp;  BX<br />&nbsp; &nbsp; &nbsp; &nbsp; ;Return Control<br />&nbsp; &nbsp; RET</code></pre></div>
    <div class="meta">Posted on 2011-10-30 15:51:54 by watachiaieto</div>
   </div>
   <div class="post" id="post-215298">
    <div class="subject"><a href="#post-215298">Re: Simple Write Char To Screen Code</a></div>
    <div class="body">Sorry, I guess it works fine. I recompiled it... Either way i realize now this code is in the wrong section. If you want to use it as an algorithm you may...</div>
    <div class="meta">Posted on 2011-10-30 16:07:28 by watachiaieto</div>
   </div>
  </div>
 </body>
</html>