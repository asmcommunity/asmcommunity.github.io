<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ScrollWindowEx - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19531" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19531">ScrollWindowEx</a></p>
   <div class="post" id="post-150400">
    <div class="subject"><a href="#post-150400">ScrollWindowEx</a></div>
    <div class="body">I'm programming a print preview window. I create class for the window with CS_OWNDC, and without VREDRAW and HREDRAW to avoid flickering.<br />Then I create the window with WS_OVERLAPPEDWINDOW OR WS_VSCROLL OR WS_CLIPCHILDREN and I create a rebar in this window.<br />During WM_PAINT I paint the client area from a BackBuffer.<br />I have copied the example from microsoft &quot;Example of Scrolling Text&quot;. <br />The WM_HSCROLL handler is the same but WM_PAINT is different because I don't have to paint strings but a bitmap.<br /><br />The problem is that the ClipRect is strange.<br /><br />On start the clip rect is<br />left = 0<br />top = 26<br />right = 1135<br />bottom = 812<br />that is the client area without the rebar<br />(these values are taken from ps.rcPaint)<br /><br />If I click on the down arrow of the scroll bar<br />left = -50<br />top = 728<br />right = 1085<br />bottom = 738<br /><br />And if I click the up arrow<br />left = -50<br />top = -48<br />right = 1085<br />bottom = -38<br /><br />Why these negative values?<br /><br />Why I get the WM_PAINT message even if the clipping region is 0?</div>
    <div class="meta">Posted on 2004-09-25 05:20:06 by greenant</div>
   </div>
   <div class="post" id="post-150424">
    <div class="subject"><a href="#post-150424">ScrollWindowEx</a></div>
    <div class="body">I found the answer to the first question. I use SetViewportEx to change the origin. <br /><br />But I still can't find an answer to the second question.<br />How can I prevent my window from getting WM_PAINT when the clip rect is ZERO?</div>
    <div class="meta">Posted on 2004-09-25 08:48:53 by greenant</div>
   </div>
  </div>
 </body>
</html>