<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>windows with tasm - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1567" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1567">windows with tasm</a></p>
   <div class="post" id="post-10031">
    <div class="subject"><a href="#post-10031">windows with tasm</a></div>
    <div class="body">I have tasm, anyone know how to make a windows app in it? I tried using the master tutorials from icz's site, but i get an illegal operation error everytime i run the app.</div>
    <div class="meta">Posted on 2001-10-22 21:16:11 by ChimpFace9000</div>
   </div>
   <div class="post" id="post-10036">
    <div class="subject"><a href="#post-10036">windows with tasm</a></div>
    <div class="body">well this is not TASM is NASM <br /><br />and i have translated from an example made in TASM<br /><br />to NASM syntax it is an IP RESOLVER :<br /><br /><br /><br />;====================================<br />;= Functions that we are going to use from Window system<br />;====================================<br /><br />extern GetModuleHandleA<br />extern DialogBoxParamA<br />extern GetDlgItemTextA<br />extern SetDlgItemTextA<br />extern LoadIconA<br />extern SendDlgItemMessageA<br />extern ExitProcess <br />import WSAStartup wsock32.dll        <br />extern WSAStartup<br />import WSACleanup wsock32.dll   <br />extern WSACleanup<br />import gethostbyaddr wsock32.dll   <br />extern gethostbyaddr<br />import gethostbyname wsock32.dll  <br />extern gethostbyname<br />import inet_addr wsock32.dll  <br />extern inet_addr<br />import inet_ntoa wsock32.dll  <br />extern inet_ntoa<br />extern lstrlen<br />extern SendMessageA<br />extern PostQuitMessage<br />extern MessageBoxA<br />extern lstrcmp<br /><br />%include '\nagoa\vasm\inc\win32n.inc'<br /><br /><br /> %macro call 2-*<br /> %define _j %1<br /> %rep %0-1<br />     %rotate -1<br />     push dword %1<br /> %endrep<br />     call _j<br /> %endmacro<br /><br />ICON_SMALL         equ 0<br />ICON_BIG             equ 1<br /><br />IDD_DIALOG1       equ               101<br />IDC_HOSTNAME    equ               1000<br />IDC_IP                 equ               1001<br />IDC_STATIC         equ                -1<br />IDI_ICON1            equ               102<br /><br /><br /><br /><br />WS_Error     db 'Error initializing Winsock!',0<br />caption         db 'Host/IP Resolver v0.1',0<br />	           db '(c)1999 by Jeremy Collake',0<br />unknown      db '&lt;Unknown&gt;',0<br />cip	           dd 0<br />hInst            dd 0<br />hwnd           dd 0<br />WSAStruct    resb WSAdata_size<br />	<br />ipaddr          resb  256 <br />hostname     resb 256 <br /><br /><br /><br /><br /> ..start:<br /><br />       enter 0,0<br />       call	GetModuleHandleA, NULL<br />       mov	, eax<br />       call	DialogBoxParamA, ,101 , 0, @WndProc, 0 <br />       call	ExitProcess, <br /><br /><br />@WndProc: <br /> %define hwnd              ebp+8                 <br /> %define wmsg             ebp+12             <br /> %define wparam          ebp+16<br /> %define lparam            ebp+20<br />    <br /><br />        enter 0,0<br />	cmp	dword ,WM_INITDIALOG<br />	je	init<br />	cmp	dword ,WM_CLOSE<br />	je near	close<br />	cmp	dword ,WM_DESTROY<br />	je near	close<br />	cmp	dword ,WM_COMMAND<br />	je	wmcommand<br />        jmp unhandled<br /><br />unhandled:	<br />        <br />        mov  eax,0       <br />      	leave<br />      	ret 16<br /><br />init:	<br />	<br />        call	,101h, WSAStruct<br />	or	eax,eax<br />	jz	.WsockFine<br />	call	MessageBoxA,0, WS_Error, caption,MB_ICONHAND<br />	call	ExitProcess,0<br /><br /><br />.WsockFine<br />     <br />        <br />        mov eax,1 <br />        leave<br />        ret 16<br /><br />		<br /><br />wmcommand:<br />	cmp	dword ,IDCANCEL  ; close<br />	je near close<br />	cmp	dword ,IDOK          ;resolve ip<br />	je resolve<br /><br />        mov eax,1 <br />        leave<br />        ret 16<br /><br /><br /><br />resolve:<br />	pushad	<br />	call	GetDlgItemTextA,,IDC_IP, ipaddr,255<br />	or	eax,eax<br />	jz	ResolveHost		<br />	call	lstrcmp, unknown, ipaddr<br />	or	eax,eax<br />	jz	ResolveHost<br />	call	, ipaddr		<br />	mov	,eax			<br />	call	, ,4,2		<br />	mov	ebx,IDC_HOSTNAME	<br />	or	eax,eax<br />	jz	Unresolvable	<br />	mov	eax,<br />	or	eax,eax<br />	jz	Unresolvable	<br />	call	SetDlgItemTextA,,IDC_HOSTNAME,eax<br />	jmp	eResolve<br />Unresolvable:<br />	call	SetDlgItemTextA,,ebx, unknown<br />	jmp	eResolve<br />ResolveHost:	<br />	call	GetDlgItemTextA,,IDC_HOSTNAME, hostname,255<br />	or	eax,eax<br />	jz	eResolve<br />	call	lstrcmp, unknown, hostname<br />	or	eax,eax<br />	jz	eResolve<br />	call	, hostname<br />	mov	ebx,IDC_IP<br />	or	eax,eax<br />	jz	Unresolvable<br />	mov	eax,<br />	mov	eax,<br />	mov	eax,	<br />	call	,eax<br />	call	SetDlgItemTextA,,IDC_IP,eax	<br />eResolve:<br />	popad<br />	jmp	unhandled<br /><br /><br /><br />close:<br />	call	<br />	call ExitProcess,0   	<br />        ret16<br /><br /><br />;*********<br /><br /><br /><br />NASM is better then Tasm and then Masm <br /><br /><br /><br /><br /><br /><br /><br /><br /><br />know is the TASM version:<br /><br /><br /><br />include resolver.inc<br />include mywin.inc<br /><br />.486p<br />locals<br />jumps<br />.model flat,STDCALL<br /><br />extrn 	GetModuleHandleA:PROC<br />extrn 	DialogBoxParamA:PROC<br />extrn   GetDlgItemTextA:PROC<br />extrn   SetDlgItemTextA:PROC<br />extrn 	LoadIconA:PROC<br />extrn   SendDlgItemMessageA:PROC<br />extrn   ExitProcess:PROC         <br />extrn	WSAStartup:PROC<br />extrn	WSACleanup:PROC<br />extrn	gethostbyaddr:PROC<br />extrn   gethostbyname:PROC<br />extrn	inet_addr:PROC<br />extrn	inet_ntoa:PROC<br />extrn	lstrlen:PROC<br />extrn   SendMessageA:PROC<br />extrn	PostQuitMessage:PROC<br />extrn   MessageBoxA:PROC<br />extrn	lstrcmp:PROC<br /><br />.data<br />WS_Error db 'Error initializing Winsock!',0<br />caption  db 'Host/IP Resolver v0.1',0<br />	 db '(c)1999 by Jeremy Collake',0<br />unknown  db '&lt;Unknown&gt;',0<br />cip	 dd ?<br />hInst    dd ?<br />hMain	 dd ?<br />WSAStruct WSADATA &lt;?&gt;<br />	 dd ?	; for structure alignment<br />ipaddr   db 256 dup(?)<br />hostname db 256 dup(?)<br />.code<br />start:<br /> 	call 	GetModuleHandleA,0<br />	mov	hInst,eax<br /><br />	call	WSAStartup,101h,offset WSAStruct<br />	or	eax,eax<br />	jz	WsockFine<br />	call	MessageBoxA,0,offset WS_Error,offset caption,MB_ICONHAND<br />	call	ExitProcess,1<br />WsockFine:	<br />	call	DialogBoxParamA, eax, IDD_DIALOG1, 0, offset WndProc, 0  	<br />  	call	ExitProcess,0<br /><br />WndProc  PROC   hwnd:DWORD, wmsg:DWORD, wparam:DWORD, lparam:DWORD<br />	 USES ebx, edi, esi									<br />	cmp	wmsg,WM_INITDIALOG<br />	jz	init<br />	cmp	wmsg,WM_CLOSE<br />	jz	close<br />	cmp	wmsg,WM_DESTROY<br />	jz	close<br />	cmp	wmsg,WM_COMMAND<br />	jz	cmd_switch<br />WEndUnprocessed:<br />	xor	eax,eax<br />	ret			<br />cmd_switch:<br />	cmp	wparam,IDCANCEL<br />	jz	close<br />	cmp	wparam,IDOK<br />	jnz	WEndUnprocessed<br />resolve:<br />	pushad	<br />	call	GetDlgItemTextA,hMain,IDC_IP,offset ipaddr,255<br />	or	eax,eax<br />	jz	ResolveHost		<br />	call	lstrcmp,offset unknown,offset ipaddr<br />	or	eax,eax<br />	jz	ResolveHost<br />	call	inet_addr,offset ipaddr		<br />	mov	cip,eax			<br />	call	gethostbyaddr,offset cip,4,2		<br />	mov	ebx,IDC_HOSTNAME	<br />	or	eax,eax<br />	jz	Unresolvable	<br />	mov	eax,<br />	or	eax,eax<br />	jz	Unresolvable	<br />	call	SetDlgItemTextA,hMain,IDC_HOSTNAME,eax<br />	jmp	eResolve<br />Unresolvable:<br />	call	SetDlgItemTextA,hMain,ebx,offset unknown<br />	jmp	eResolve<br />ResolveHost:	<br />	call	GetDlgItemTextA,hMain,IDC_HOSTNAME,offset hostname,255<br />	or	eax,eax<br />	jz	eResolve<br />	call	lstrcmp,offset unknown,offset hostname<br />	or	eax,eax<br />	jz	eResolve<br />	call	gethostbyname,offset hostname<br />	mov	ebx,IDC_IP<br />	or	eax,eax<br />	jz	Unresolvable<br />	mov	eax,<br />	mov	eax,<br />	mov	eax,	<br />	call	inet_ntoa,eax<br />	call	SetDlgItemTextA,hMain,IDC_IP,eax	<br />eResolve:<br />	popad<br />	jmp	WEndProcessed<br />init:	<br />	mov	eax,hwnd<br />	mov	hMain,eax<br />        call    LoadIconA,hInst,IDI_ICON1                                                 <br />        push	eax<br />        call    SendMessageA,hMain,WM_SETICON,ICON_SMALL,eax      <br />        pop 	eax<br />        call    SendMessageA,hMain,WM_SETICON,ICON_BIG,eax	<br />        jmp	WEndUnprocessed<br />close:<br />	call	WSACleanup<br />	call	PostQuitMessage,0	<br />WEndProcessed:<br />	xor	eax,eax<br />	inc	eax<br />	ret	<br />	<br />WndProc endp	<br />end start<br />ends<br /><br /><br />made in NaGoA</div>
    <div class="meta">Posted on 2001-10-22 22:51:21 by Nguga</div>
   </div>
   <div class="post" id="post-10039">
    <div class="subject"><a href="#post-10039">windows with tasm</a></div>
    <div class="body">Thanks, but that doesnt help at all really.</div>
    <div class="meta">Posted on 2001-10-22 23:02:54 by ChimpFace9000</div>
   </div>
   <div class="post" id="post-10044">
    <div class="subject"><a href="#post-10044">windows with tasm</a></div>
    <div class="body">ChimpFace9000,<br /><br />There used to be a lot of TASM code around a few years ago but it has ben effectively bypassed by the power and convenience of MASM. Its been a long time since I had TASM installed but there was a win32 asm example in it that ran OK if a bit larger than the equivelant MASM EXE file.<br /><br />There used to be a tutorial by _masta_ on Iczelion's site but I don't know if its still there. Perhaps some of the guy who are members have some old TASM code around for you to play with.<br /><br />Good luck with it.<br /><br /><a href="mailto:hutch@pbq.com.au">hutch@pbq.com.au</a></div>
    <div class="meta">Posted on 2001-10-23 00:14:14 by hutch--</div>
   </div>
   <div class="post" id="post-10052">
    <div class="subject"><a href="#post-10052">windows with tasm</a></div>
    <div class="body">Dolphinz :)<br /><br /><a target="_blank" href="http://personal5.iddeo.es/ret007ow/index.html">http://personal5.iddeo.es/ret007ow/index.html</a></div>
    <div class="meta">Posted on 2001-10-23 01:56:41 by Hiroshimator</div>
   </div>
   <div class="post" id="post-10110">
    <div class="subject"><a href="#post-10110">Hehe</a></div>
    <div class="body">I still use TASM to make windows asm apps<br />(actually HE is done with TASM :) )<br /><br />so ask me by email and i will send you instructions on how to build win32 apps with Tasm (tips and tricks), also  there is a WAP32 example inside TASM ;)<br /><br />if you are a beginner and you do not need TASM (like i do need it because of compiling speed and/or writting apps for other OS's = not Windows) you should use MASM.<br /><br />Masm works better in windows, after all its designed for it :)</div>
    <div class="meta">Posted on 2001-10-23 12:38:27 by BogdanOntanu</div>
   </div>
  </div>
 </body>
</html>