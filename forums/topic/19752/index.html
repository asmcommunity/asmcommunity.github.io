<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>CopyProgressRoutine and CopyFileEx... I don't get it - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19752" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19752">CopyProgressRoutine and CopyFileEx... I don't get it</a></p>
   <div class="post" id="post-151912">
    <div class="subject"><a href="#post-151912">CopyProgressRoutine and CopyFileEx... I don't get it</a></div>
    <div class="body">I don't know what an &quot;application-defined callback function &quot; is and how to declare/use it. I'm using the Masm32 package and have my progress control in a seperate dialog box. I'm using res files and plan on calling it from DiagBoxParam.<br /><br />1: How do I declare my CopyProgressRoutine in the .data section. I assume it's not like a structure.<br /><br />2: Do I call my DiagBoxParam &quot;ProgressWindow&quot; and then CopyFileEx?<br /><br />3: I want to show progress on 2 files being copied.<br /><br />4: How do I get info from the CopyProgressRoutine to update the progress bar.<br /><br />Some items that are helpful:<br /><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/base/copyprogressroutine.asp">MSDN CopyProgressRoutine</a><br /><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/base/copyfileex.asp">MSDN CopyFileEx</a><br /><br />Code examples are always the most helpful.<br /><br />Thanks.</div>
    <div class="meta">Posted on 2004-10-27 10:22:16 by CsnWltr</div>
   </div>
   <div class="post" id="post-168658">
    <div class="subject"><a href="#post-168658">Re: CopyProgressRoutine and CopyFileEx... I don't get it</a></div>
    <div class="body">You just declare a function according to what MSDN says. If it says that the function accepts 2 parameters: X and Y, you write a function that accepts 2 params: X and Y and do whatever you wish with them. Your function should return what the MSDN requires it to return.<br /><br />When you finish writing this function, you give a pointer to it when you call CopyFileEx. The pointer is passed as the third parameter. The fourth parameter is optional thing passed to you callback routine. If you set this to 78, then the callback will receive 78 as one of its params, so it&#39;s up to you what it will hold.</div>
    <div class="meta">Posted on 2005-12-07 19:36:30 by ti_mo_n</div>
   </div>
  </div>
 </body>
</html>