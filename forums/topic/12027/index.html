<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Wher can i get LVM_SETBKIMAGE value. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12027" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12027">Wher can i get LVM_SETBKIMAGE value.</a></p>
   <div class="post" id="post-92325">
    <div class="subject"><a href="#post-92325">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body">include windows.inc<br />include gdi32.inc<br />include user32.inc<br />include kernel32.inc<br />include comdlg32.inc<br />include masm32.inc<br />include comctl32.inc<br />include ole32.inc<br />include debug.inc<br /><br />I'm using RadAsm i have added this includes but when assembly my prog.<br /><br />mp3Cleaner.asm(87) : error A2006: undefined symbol : LVM_SETBKIMAGE<br />mp3Cleaner.asm(82) : error A2006: undefined symbol : LVBKIF_SOURCE_URL</div>
    <div class="meta">Posted on 2003-04-01 07:06:48 by AceEmbler</div>
   </div>
   <div class="post" id="post-92327">
    <div class="subject"><a href="#post-92327">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body">I think all of these are missing<br /><pre><code>LVM_SETBKIMAGE				equ				4096 + 68<br />LVBKIF_SOURCE_NONE 			equ				000000000h <br />LVBKIF_SOURCE_HBITMAP		equ				000000001h <br />LVBKIF_SOURCE_URL			equ				000000002h <br />LVBKIF_SOURCE_MASK			equ				000000003h <br />LVBKIF_STYLE_NORMAL			equ				000000000h<br />LVBKIF_STYLE_TILE			equ				000000010h<br />LVBKIF_STYLE_MASK			equ				000000010h<br />LVM_SORTITEMSEX 			equ 			LVM_FIRST + 81<br />LVS_EX_BORDERSELECT			equ				16384</code></pre></div>
    <div class="meta">Posted on 2003-04-01 07:09:56 by donkey</div>
   </div>
   <div class="post" id="post-92329">
    <div class="subject"><a href="#post-92329">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body">Man you are allways here to support me  ;)<br /><br />This one too<br /><br />LVBKIMAGE	struct<br />ulFlags	 ULONG	?;Flags (no comment)<br />hbm	 dd	?;Not used currently<br />pszImage	 dd	?	;Address to 0 term string (URL bkg image)<br />cchImageMax dd	?	;Size of buffer URL (ignore while sending to cntrl)<br />    xOffsetPercent		dd		?	;Percentage X<br />    yOffsetPercent		dd		?	;Percentage Y<br />LVBKIMAGE 	ends<br /><br /><br />Im gona include some  missed.inc to my progs. :P<br /><br /><br /><br />BTW wtf is with this one ?<br /><br />LVM_SORTITEMSEX 			equ 			LVM_FIRST + 81<br />LVS_EX_BORDERSELECT			equ				16384<br /><br />dont get it ( i do not have LVM_FIRST )</div>
    <div class="meta">Posted on 2003-04-01 07:21:26 by AceEmbler</div>
   </div>
   <div class="post" id="post-92332">
    <div class="subject"><a href="#post-92332">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body">You will find that LVBKIMAGE is already in the Windows.inc file.<br /><br />LVM_SORTITEMSEX  use a callback to sort the listview ( i used it )<br />LVS_EX_BORDERSELECT selected items show only a hilited border ( i have never used it )</div>
    <div class="meta">Posted on 2003-04-01 07:28:06 by donkey</div>
   </div>
   <div class="post" id="post-92336">
    <div class="subject"><a href="#post-92336">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body"><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/listview/messages/lvm_sortitemsex.asp">LVM_SORTITEMSEX</a>  is a much more practical method of sorting a listview as it makes subitem sorts easier.</div>
    <div class="meta">Posted on 2003-04-01 07:37:40 by donkey</div>
   </div>
   <div class="post" id="post-92338">
    <div class="subject"><a href="#post-92338">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body">do i have LVBKIMAGE in the windows.inc ?<br />i dont. :grin: <br /><br />LVM_FIRST  &lt;--- what is this (wher is this defined) ?</div>
    <div class="meta">Posted on 2003-04-01 07:46:00 by AceEmbler</div>
   </div>
   <div class="post" id="post-92339">
    <div class="subject"><a href="#post-92339">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body">Version 1.25e of the Windows.inc is the current one you can get it from <a target="_blank" href="http://www.movsd.com/">Hutch's page</a> LVM_FIRST equ 1000h is in there as well. Actually on a quick check all of those constants with the exception of LVM_SORTITEMSEX was added a while back, I remember because I supplied them.</div>
    <div class="meta">Posted on 2003-04-01 07:48:57 by donkey</div>
   </div>
   <div class="post" id="post-92340">
    <div class="subject"><a href="#post-92340">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body">Do u have any example of bitmap background in a ListBox made in masm32 ??</div>
    <div class="meta">Posted on 2003-04-01 07:53:58 by AceEmbler</div>
   </div>
   <div class="post" id="post-92341">
    <div class="subject"><a href="#post-92341">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body">You mean a ListView :)<br /><br /><pre><code>LOCAL LVBKSTR	&#58;LVBKIMAGE<br /><br />mov LVBKSTR.ulFlags,LVBKIF_SOURCE_URL<br />mov LVBKSTR.pszImage,offset IMAGENAME<br />mov LVBKSTR.xOffsetPercent,0<br />mov LVBKSTR.yOffsetPercent,0<br />invoke SendMessage,LVHANDLE,LVM_SETBKIMAGE,0,ADDR LVBKSTR<br />invoke SendMessage,LVHANDLE,LVM_SETBKCOLOR,0,CLR_NONE<br />invoke SendMessage,LVHANDLE,LVM_SETTEXTBKCOLOR,0,CLR_NONE</code></pre>This is from a peice of code I used once. I don't think that LVBKIF_SOURCE_HBITMAP works yet, maybe the next release of common controls who knows.<br /><br />Use the following format for the bitmap file name as it must conform to URL naming conventions :<br /><br />&quot;file://C:/Documents%20and%20Settings/hello.bmp&quot;,0</div>
    <div class="meta">Posted on 2003-04-01 08:02:38 by donkey</div>
   </div>
   <div class="post" id="post-92513">
    <div class="subject"><a href="#post-92513">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body">DAMN im stupid i was thinking about ListBox not ListView all the time i do not know why i was posting about ListView.(probably to much time spent before the keyboard).<br /><br />So my question is can i set Bitmap ListBox background :confused:</div>
    <div class="meta">Posted on 2003-04-02 04:29:42 by AceEmbler</div>
   </div>
   <div class="post" id="post-92562">
    <div class="subject"><a href="#post-92562">Wher can i get LVM_SETBKIMAGE value.</a></div>
    <div class="body">i was making sth like this but it's not working.<br /><br />invoke LoadImage,hInst,addr backa,IMAGE_BITMAP,600,500,LR_LOADFROMFILE<br />	mov hbackgr,eax<br />	<br />	invoke CreatePatternBrush,eax<br />	mov hbrush,eax<br /><br />uMsg==WM_CREATE<br />invoke CreateWindowEx,WS_EX_CLIENTEDGE,ADDR ListClassName,0,WS_VSCROLL or WS_VISIBLE or WS_BORDER or WS_CHILD or \<br />      LBS_HASSTRINGS or LBS_NOINTEGRALHEIGHT,120,50,200,310,hWnd,ListID,hInstance,NULL<br />	  mov hListBox,eax<br /><br />;This 3 100%working <br /><br />;but this one probably not<br />.ELSEIF uMsg==WM_CTLCOLORLISTBOX <br />invoke SetBkMode,wParam,2 ; 1 = TRANSPARENT or 2 = OPAQUE <br />invoke SetTextColor,wParam,0000FF00h ; text color value <br />invoke SetBkColor,wParam,00000000h ; Backgrn color value <br />invoke GetStockObject,BLACK_BRUSH<br /><br /><br />FORGET IT i just forgot about  &quot;ret&quot; in the end of this piece.<br /><br />   .ELSEIF uMsg==WM_CTLCOLORLISTBOX <br />invoke SetBkMode,wParam,2 ; 1 = TRANSPARENT or 2 = OPAQUE <br />invoke SetTextColor,wParam,255 ; text color value <br />invoke SetBkColor,wParam,00000000h ; Backgrn color value <br />mov eax,hbrush  ;Prepared before this WM_CTLCOLORLISTBOX <br />	ret<br />.ELSEIF uMsg==WM_CHAR <br /><br /><br />WORKS GREAT (bugs are starting when im adding items to a list :alright: )</div>
    <div class="meta">Posted on 2003-04-02 08:41:58 by AceEmbler</div>
   </div>
  </div>
 </body>
</html>