<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Hexadecimal String to DWORD OR QWORD(MMX) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30259" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=30259">Hexadecimal String to DWORD OR QWORD(MMX)</a></p>
   <div class="post" id="post-213258">
    <div class="subject"><a href="#post-213258">Hexadecimal String to DWORD OR QWORD(MMX)</a></div>
    <div class="body"><pre><code>;***************************************************<br />;Hexadecimal String to DWORD OR QWORD(MMX)<br />;Author bitRAKE&nbsp; http://madwizard.org/programming/snippets?id=43<br />;Updated&nbsp; By&nbsp; G-Spider<br />;ml&nbsp; /c /coff hex.asm&nbsp; <br />;link /subsystem:windows hex.obj <br />;***************************************************<br /> .586<br /> .MMX<br /> .model flat,stdcall<br /> option casemap:none<br /> <br /> include windows.inc<br /> include user32.inc<br /> include kernel32.inc<br /><br /> includelib user32.lib<br /> includelib kernel32.lib<br /><br />;***************************************************<br />.data<br /><br />szTitleSave&nbsp; &nbsp;  db&nbsp; &#039;good luck&#039;,0<br />fmt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &#039;%X%X&#039;,0<br /> <br />ALIGN 16 <br />_0fill&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; 16&nbsp; dup(0)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;Need! When _StringLong&lt;16<br />_lpString&nbsp; &nbsp; &nbsp;  db &quot;89aBcDeF12aCdEfF&quot;,0&nbsp;  ;Test1 &lt;====note! Have Zero End<br />;_lpString&nbsp; &nbsp; &nbsp; db &quot;89aBcDeF12&quot;,0&nbsp; &nbsp; &nbsp; &nbsp;  ;Test2<br />;_lpString&nbsp; &nbsp; &nbsp; db &quot;89aBcDe&quot;,0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;Test3<br />;_lpString&nbsp; &nbsp; &nbsp; db &quot;89aBcDeF12345678aD&quot;,0 ;Test4<br />_StringLong&nbsp; &nbsp;  dd $-_lpString-1<br />&nbsp; <br />;_lpString&nbsp; &nbsp; &nbsp; db &quot;89aBcDeF12345678&quot;&nbsp; &nbsp;  ;&lt;====note!&nbsp; NO Zero End<br />;_StringLong&nbsp; &nbsp; dd $-_lpString&nbsp; <br /><br />ALIGN 16&nbsp; &nbsp; &nbsp; &nbsp; ;&lt;==Note!<br />_3Hex&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  qword&nbsp;  3030303030303030h<br />_9Hex&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  qword&nbsp;  0909090909090909h<br />_7Hex&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  qword&nbsp;  0707070707070707h <br />_f0Hex&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; qword&nbsp;  0f000f000f000f00h&nbsp; <br />_0fHex&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; qword&nbsp;  000f000f000f000fh <br /><br />.data?<br />buf	&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; 16&nbsp; dup(?)<br /><br />.code<br /><br />StrHex2bin PROC lpString:DWORD<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,lpString<br />&nbsp; &nbsp; &nbsp; &nbsp; movq&nbsp; &nbsp; &nbsp; &nbsp; mm0,QWORD PTR &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; psubusb&nbsp; &nbsp;  mm0,_3Hex&nbsp; ; &quot;0&quot; = 0&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; movq&nbsp; &nbsp; &nbsp; &nbsp; mm1,mm0 <br />&nbsp; &nbsp; &nbsp; &nbsp; pcmpgtb&nbsp; &nbsp;  mm1,_9Hex&nbsp;  ; letter?&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; pand&nbsp; &nbsp; &nbsp; &nbsp; mm1,_7Hex<br />&nbsp; &nbsp; &nbsp; &nbsp; psubusb&nbsp; &nbsp;  mm0,mm1&nbsp; &nbsp;  ; fix letters<br />&nbsp; &nbsp; &nbsp; &nbsp; movq&nbsp; &nbsp; &nbsp; &nbsp; mm1,mm0&nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; pand&nbsp; &nbsp; &nbsp; &nbsp; mm0,_f0Hex<br />&nbsp; &nbsp; &nbsp; &nbsp; pand&nbsp; &nbsp; &nbsp; &nbsp; mm1,_0fHex<br />&nbsp; &nbsp; &nbsp; &nbsp; psrlq&nbsp; &nbsp; &nbsp;  mm0,8&nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; packuswb&nbsp; &nbsp; mm1,mm1&nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; packuswb&nbsp; &nbsp; mm0,mm0&nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; psllq&nbsp; &nbsp; &nbsp;  mm1,4&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; por&nbsp; &nbsp; &nbsp; &nbsp;  mm0,mm1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; movd&nbsp; &nbsp; &nbsp; &nbsp; eax,mm0&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; bswap&nbsp; &nbsp; &nbsp;  eax&nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />StrHex2bin ENDP<br /><br />StrHex2Qword proc lpString,StringLong<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  ebx,lpString<br />&nbsp; &nbsp; &nbsp; &nbsp; add&nbsp; &nbsp;  ebx,StringLong<br />&nbsp; &nbsp; &nbsp; &nbsp; sub&nbsp; &nbsp;  ebx,16<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke	StrHex2bin,ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  edx,eax&nbsp; &nbsp; &nbsp; &nbsp; ;edx=QuadWord.HiDWord<br />&nbsp; &nbsp; &nbsp; &nbsp; pop&nbsp; &nbsp;  ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; add&nbsp; &nbsp;  ebx,8<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke	StrHex2bin,ebx ;eax=QuadWord.LoDWord<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />StrHex2Qword&nbsp; &nbsp; endp<br /><br />start:<br />	invoke&nbsp; StrHex2Qword,offset _lpString,_StringLong<br />	<br />	invoke	wsprintf,offset buf,offset fmt,edx,eax<br />	invoke&nbsp; MessageBox,NULL,offset buf,addr szTitleSave,0 <br /><br />	ret<br />	end start</code></pre></div>
    <div class="meta">Posted on 2010-10-02 21:20:20 by G-Spider</div>
   </div>
  </div>
 </body>
</html>