<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>windows file handle - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13133" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=13133">windows file handle</a></p>
   <div class="post" id="post-102023">
    <div class="subject"><a href="#post-102023">windows file handle</a></div>
    <div class="body">alright. my main reason for this is that im getting this danged worm in my email every week. my virus scanner catches it every time. i have 3running btw. ive read up on this worm and if it ever makes it on my system, with the my program it wont be able to write any files. now, what i want to do is pretty simple, i want to make my program open a handle to sevral file names the virus copys itself as, so it cant read and write. but also what I want to do is catch when windows tries to access that file to see if it can be read/writen and display on my program that an attempt was made. This has many applications other then this, but is it possible to catch windows trying to access the file? now i dont know how to make it unreadable but i think i cant make it lock write access, refresher would be nice.</div>
    <div class="meta">Posted on 2003-05-08 15:44:21 by Qages</div>
   </div>
   <div class="post" id="post-102050">
    <div class="subject"><a href="#post-102050">windows file handle</a></div>
    <div class="body">Yes, you could just create an empty file with the right name, and open an exclusive handle to it CreateFile. If you just want to monitor it, there are a couple of API functions to do this, can't rememebr what they are of the top of my head, something to do with Change Notification, it has been mentioned several times previously in the Main forum.</div>
    <div class="meta">Posted on 2003-05-08 19:18:29 by sluggy</div>
   </div>
   <div class="post" id="post-102051">
    <div class="subject"><a href="#post-102051">windows file handle</a></div>
    <div class="body">You could flag it for change notification, the folder it's in anyway and ask to be informed when there is a change in a file then check to see if it's the one your looking for. You could open the file as you said with out allowing access to other processes, or just set the readonly attribute.<br /><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/base/findfirstchangenotification.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fileio/base/findfirstchangenotification.asp</a></div>
    <div class="meta">Posted on 2003-05-08 19:19:57 by donkey</div>
   </div>
   <div class="post" id="post-102052">
    <div class="subject"><a href="#post-102052">windows file handle</a></div>
    <div class="body">Wow, sluggy and I came up with a reply at the same time but he's a faster typer :)</div>
    <div class="meta">Posted on 2003-05-08 19:20:37 by donkey</div>
   </div>
   <div class="post" id="post-102112">
    <div class="subject"><a href="#post-102112">windows file handle</a></div>
    <div class="body"><div class="quote"><em>Wow, sluggy and I came up with a reply at the same time but he's a faster typer </em></div>Heh, i was at work when i typed that :) I even did a couple of searches on MSDN (like yourself), but couldn't remember the API function, otherwise our answers would have been even more similar :)</div>
    <div class="meta">Posted on 2003-05-09 06:15:40 by sluggy</div>
   </div>
  </div>
 </body>
</html>