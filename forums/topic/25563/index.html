<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Treeview-Message TVM_MOVEITEM needed... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25563" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25563">Treeview-Message TVM_MOVEITEM needed...</a></p>
   <div class="post" id="post-186694">
    <div class="subject"><a href="#post-186694">Treeview-Message TVM_MOVEITEM needed...</a></div>
    <div class="body">Hey,<br /><br />I&#39;m writing drag&amp;drop for my treeview, to move an item to another. D&amp;D works fine, but I have problems moving the items correctly. Actualy I use:<br /><br /><pre><code>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ebx,zielitem<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; again:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,treeview,TVM_GETNEXTITEM,TVGN_PARENT,ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp eax,startitem<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; noman<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ebx,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp eax,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne again<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke memfill,addr TvItem,80,0<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax,startitem<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lea ebx,TvItem<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add ebx,8<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m2m ,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m2m ,0ffffffffh<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lea eax,tix3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m2m ,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m2m ,256<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,treeview,TVM_GETITEM,0,ebx<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,treeview,TVM_DELETEITEM,0,startitem<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lea ebx,TvItem<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m2m ,zielitem<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; m2m ,TVI_FIRST <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,treeview,TVM_INSERTITEM,0,ebx<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; noman:</code></pre><br /><br />That work sometimes, but othertimes it goes wrong. I need something like TVM_MOVEITEM. But could not find... Any ideas?<br /><br />Best regards,<br />Nordwind </div>
    <div class="meta">Posted on 2006-11-24 10:42:13 by Nordwind64</div>
   </div>
   <div class="post" id="post-186708">
    <div class="subject"><a href="#post-186708">Re: Treeview-Message TVM_MOVEITEM needed...</a></div>
    <div class="body">Hi Norwind,<br /><br />Unfortunately there is no TVM_MOVEITEM message :( You have to write the gist of it yourself and I&#39;m afraid it&#39;s quite some work. I did it once but am unable to find the source at this very moment. (This upsets me more than you think!)<br /><br />I know I posted it once, but I don&#39;t remember when or where. I only remember that I based it upon Iczelions drag drop example. Only that you have to manually loop with TVM_GETNEXTITEM for it&#39;s child&#39;s &amp; siblings and create them simultaneously in the dropzone. Also extensive testing needs to be done so that the dropzone can not be a child of the draggee itself, etc etc etc...<br /><br />Lots of work I can not find. :-/ Very upsetting.<br /><br />If there is someone who collects everything please do a search for the word &quot;dropzone&quot; in that folder. I believe that&#39;s what I called it. I assume I wrote it in 2003.</div>
    <div class="meta">Posted on 2006-11-24 20:25:08 by JimmyClif</div>
   </div>
   <div class="post" id="post-186717">
    <div class="subject"><a href="#post-186717">Re: Treeview-Message TVM_MOVEITEM needed...</a></div>
    <div class="body">Thank you, JimmyClif!<br /><br />Ok. Hope, someone had archieved your code...&nbsp; :)<br /><br />Best regards,<br />Nordwind </div>
    <div class="meta">Posted on 2006-11-25 04:25:51 by Nordwind64</div>
   </div>
  </div>
 </body>
</html>