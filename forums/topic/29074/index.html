<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>mp3 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29074" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=29074">mp3</a></p>
   <div class="post" id="post-205394">
    <div class="subject"><a href="#post-205394">mp3</a></div>
    <div class="body">Hi evry body........How can i play mp3 file in masm32</div>
    <div class="meta">Posted on 2008-05-30 12:08:20 by sudeer</div>
   </div>
   <div class="post" id="post-205396">
    <div class="subject"><a href="#post-205396">Re: mp3</a></div>
    <div class="body"><a target="_blank" href="http://msdn.microsoft.com/en-us/library/ms783323(VS.85).aspx">DirectShow</a>.</div>
    <div class="meta">Posted on 2008-05-30 14:39:42 by ti_mo_n</div>
   </div>
   <div class="post" id="post-205397">
    <div class="subject"><a href="#post-205397">Re: mp3</a></div>
    <div class="body">I thought Playsound was able to do it, but when researching I came along a snippet from someone giving <a target="_blank" href="http://msdn.microsoft.com/en-us/library/ms709485(VS.85).aspx">mciSendCommand</a> as the answer to that. Here&#039;s his quote:<br /><br /><br /><br /><pre><code><br />However, if you call mciSendCommand with the MCI_ALL_DEVICE_ID device type - it will play.<br /><br />Example:<br /><br /><br />MCI_OPEN_PARMS op;<br />op.dwCallback = NULL;<br />op.lpstrDeviceType = (char*)MCI_ALL_DEVICE_ID;<br />op.lpstrElementName = &quot;you_file_name.mp3&quot;;<br />op.lpstrAlias = NULL;<br /><br />// Open command<br />mciSendCommand( NULL, MCI_OPEN,<br />MCI_OPEN_ELEMENT | MCI_WAIT | MCI_OPEN_TYPE | MCI_OPEN_TYPE_ID, (DWORD)&amp;op);<br /><br />// Play command<br />MCI_PLAY_PARMS pp;<br />pp.dwCallback = NULL;<br />pp.dwFrom = 0;<br />mciSendCommand(pDevice, MCI_PLAY, MCI_NOTIFY | MCI_FROM, (DWORD)&amp;pp);<br /><br /></code></pre></div>
    <div class="meta">Posted on 2008-05-30 18:20:55 by JimmyClif</div>
   </div>
   <div class="post" id="post-205406">
    <div class="subject"><a href="#post-205406">Re: mp3</a></div>
    <div class="body">And there are ways to decode it via ACM, I had posted a snippet here to do that (but this is the hardest way to go, if you just want to play an mp3). <br />The MCI way is the easiest way, plus you can adjust volume and seek. <br />PlaySound can play any .wav, but not mp3. This is a tricky thing... you can actually embed mp3 audio inside .wav (WAV is just a wrapper-format, with options for many compression types). </div>
    <div class="meta">Posted on 2008-05-31 00:21:23 by Ultrano</div>
   </div>
   <div class="post" id="post-205413">
    <div class="subject"><a href="#post-205413">Re: mp3</a></div>
    <div class="body">He asked about mp3 <strong>file</strong>, so I assumed he means the file format, not the compression format. If the compression format is mp3 and the file format is wav (a wave file with mp3-compressed data), then -yeah- it&#039;s quite easy to play it ^^<br /><br />Oh, and I didn&#039;t know that the mci* functions can play mp3 files..? Have you tested it or is it a guess?</div>
    <div class="meta">Posted on 2008-05-31 10:31:41 by ti_mo_n</div>
   </div>
   <div class="post" id="post-205415">
    <div class="subject"><a href="#post-205415">Re: mp3</a></div>
    <div class="body">Yup, it&#039;s been the case ever since win98:<br />http://www.gamedev.net/reference/articles/article2053.asp</div>
    <div class="meta">Posted on 2008-05-31 10:59:06 by Ultrano</div>
   </div>
   <div class="post" id="post-205417">
    <div class="subject"><a href="#post-205417">Re: mp3</a></div>
    <div class="body">If I knew this sooner I wouldn&#039;t have to write ~300 lines of DirectShow code ^^&#039;</div>
    <div class="meta">Posted on 2008-05-31 22:34:11 by ti_mo_n</div>
   </div>
   <div class="post" id="post-205419">
    <div class="subject"><a href="#post-205419">Re: mp3</a></div>
    <div class="body">I still could not be able to figure it out, i have 10 different mp3 files in the resorce.<br />music.mp3,music1.mp3.....ect<br />how can i laod and play these files<br />an example would be appriciated................thanks<br /><br /></div>
    <div class="meta">Posted on 2008-06-01 03:24:49 by sudeer</div>
   </div>
   <div class="post" id="post-205421">
    <div class="subject"><a href="#post-205421">Re: mp3</a></div>
    <div class="body">hi<br /><br />use bass.dll for play mp3 from resource<br /><br />the dll and api doku can you download http://www.un4seen.com/bass.html<br /><br />.486<br />.model&nbsp; &nbsp; flat, stdcall<br />option casemap:none<br /><br />include \masm32\include\windows.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\user32.inc<br />include bass.inc<br /><br />include \masm32\macros\macros.asm<br /><br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\user32.lib<br /><br />dialogproc proto :DWORD,:DWORD,:DWORD,:DWORD<br /><br />.data<br /><br />bleh db &quot;mod&quot;,0; change this to whatever prefix you want<br />syntax db &quot;%d&quot;,0<br />rsrctype db &quot;DLL&quot;,0<br />err db &quot;can&#039;t read/write bass.dll&quot;,0<br />pathbuf db MAX_PATH dup(?)<br />buf db MAX_PATH dup(?)<br /><br />; BASSMOD function names, add any others you&#039;ll need here<br />func1 db &quot;BASS_Init&quot;,0<br />func2 db &quot;BASS_Start&quot;,0<br /><br />func3 db &quot;BASS_MusicLoad&quot;,0<br />func4 db &quot;BASS_StreamCreateFile&quot;,0<br /><br />func5 db &quot;BASS_ChannelPlay&quot;,0<br />func6 db &quot;BASS_ChannelPause&quot;,0<br />func7 db &quot;BASS_ChannelStop&quot;,0<br /><br />func8 db &quot;BASS_MusicFree&quot;,0<br />func9 db &quot;BASS_StreamFree&quot;,0<br />func10 db &quot;BASS_Free&quot;,0<br /><br /><br />.data?<br /><br />hInstance dd ?<br />h dd ?; module handle<br />fh dd ?; file handle<br />w dd ?; receives the number of written bytes<br />s dd ?; size of resource (bass.dll)<br />buffer dd ?<br />resh dd ?<br />module dd ?<br />PlayOn dd ?<br /><br />; BASS function addresses, add any others you&#039;ll need here<br />BASS_Init_addr dd ?<br />BASS_Start_addr dd ?<br /><br />BASS_MusicLoad_addr dd ?<br />BASS_StreamCreateFile_addr dd ?<br /><br />BASS_ChannelPlay_addr dd ?<br />BASS_ChannelPause_addr dd ?<br />BASS_ChannelStop_addr dd ?<br /><br />BASS_MusicFree_addr dd ?<br />BASS_StreamFree_addr dd ?<br />BASS_Free_addr dd ?<br /><br />.code<br /><br />start:<br /><br />&nbsp; &nbsp; invoke GetModuleHandle,0<br />&nbsp; &nbsp; mov hInstance, eax<br />&nbsp; &nbsp; invoke DialogBoxParam,hInstance,1000,0,addr dialogproc,0<br />&nbsp; &nbsp; invoke ExitProcess,0<br /><br /><br />InitBASSMOD proc<br />&nbsp; &nbsp; invoke FindResource,hInstance,1101,addr rsrctype<br />&nbsp; &nbsp; test eax,eax<br />&nbsp; &nbsp; jz bail_out<br />&nbsp; &nbsp; mov resh,eax<br />&nbsp; &nbsp; invoke LoadResource,hInstance,resh<br />&nbsp; &nbsp; invoke LockResource,eax<br />&nbsp; &nbsp; test eax,eax<br />&nbsp; &nbsp; jz bail_out<br />&nbsp; &nbsp; mov buffer,eax<br />&nbsp; &nbsp; invoke SizeofResource,hInstance,resh<br />&nbsp; &nbsp; mov s,eax<br />&nbsp; &nbsp; invoke GetTempPath,sizeof buf,addr buf<br />&nbsp; &nbsp; test eax,eax<br />&nbsp; &nbsp; jz bail_out<br />&nbsp; &nbsp; invoke GetTempFileName,addr buf,addr bleh,0,addr buf<br />&nbsp; &nbsp; test eax,eax<br />&nbsp; &nbsp; jz bail_out<br />&nbsp; &nbsp; invoke CreateFile,addr buf,GENERIC_WRITE,0,0,CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL,0<br />&nbsp; &nbsp; cmp eax,-1<br />&nbsp; &nbsp; je bail_out<br />&nbsp; &nbsp; mov fh,eax<br />&nbsp; &nbsp; invoke WriteFile,fh,buffer,s,addr w,0<br />&nbsp; &nbsp; invoke CloseHandle,fh<br />&nbsp; &nbsp; invoke LoadLibrary,addr buf<br />&nbsp; &nbsp; test eax,eax<br />&nbsp; &nbsp; jz bail_out<br />&nbsp; &nbsp; mov h,eax<br /><br />; start retrieving addresses, add any other calls for addresses you want to retrieve here<br />&nbsp; &nbsp; invoke GetProcAddress,h,addr func1<br />&nbsp; &nbsp; mov BASS_Init_addr,eax<br />&nbsp; &nbsp; invoke GetProcAddress,h,addr func2<br />&nbsp; &nbsp; mov BASS_Start_addr,eax<br />&nbsp; &nbsp; invoke GetProcAddress,h,addr func3<br />&nbsp; &nbsp; mov BASS_MusicLoad_addr,eax<br />&nbsp; &nbsp; invoke GetProcAddress,h,addr func4<br />&nbsp; &nbsp; mov BASS_StreamCreateFile_addr,eax<br />&nbsp; &nbsp; invoke GetProcAddress,h,addr func5<br />&nbsp; &nbsp; mov BASS_ChannelPlay_addr,eax<br />&nbsp; &nbsp; invoke GetProcAddress,h,addr func6<br />&nbsp; &nbsp; mov BASS_ChannelPause_addr,eax<br />&nbsp; &nbsp; invoke GetProcAddress,h,addr func7<br />&nbsp; &nbsp; mov BASS_ChannelStop_addr,eax<br />&nbsp; &nbsp; invoke GetProcAddress,h,addr func8<br />&nbsp; &nbsp; mov BASS_MusicFree_addr,eax<br />&nbsp; &nbsp; invoke GetProcAddress,h,addr func9<br />&nbsp; &nbsp; mov BASS_StreamFree_addr,eax<br />&nbsp; &nbsp; invoke GetProcAddress,h,addr func10<br />&nbsp; &nbsp; mov BASS_Free_addr,eax<br />&nbsp; &nbsp; mov eax,1<br />&nbsp; &nbsp; ret<br />bail_out:<br />&nbsp; &nbsp; xor eax,eax<br />&nbsp; &nbsp; ret<br />InitBASSMOD endp<br /><br />dialogproc proc hwnd:DWORD,m:DWORD,wp:DWORD,l:DWORD<br />&nbsp; &nbsp; LOCAL msg[5]:BYTE<br />&nbsp; &nbsp; LOCAL hResInfo:DWORD<br />&nbsp; &nbsp; LOCAL nMusicSize:DWORD<br />&nbsp; &nbsp; LOCAL pMusic:DWORD<br /><br />&nbsp; &nbsp; .if m==WM_INITDIALOG<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke InitBASSMOD<br />&nbsp; &nbsp; &nbsp; &nbsp; .if !eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke MessageBox,hwnd,addr err,addr err,MB_OK<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke ExitProcess,0<br />&nbsp; &nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; push hwnd<br />&nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; push 44100<br />&nbsp; &nbsp; &nbsp; &nbsp; push -1<br />&nbsp; &nbsp; &nbsp; &nbsp; call BASS_Init_addr<br />&nbsp; &nbsp; &nbsp; &nbsp; call BASS_Start_addr<br />&nbsp; &nbsp; &nbsp; &nbsp; .if eax!=NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke FindResource,hInstance,1100,addr rsrctype<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov hResInfo,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke LoadResource,hInstance,hResInfo<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke LockResource,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov pMusic,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke SizeofResource, hInstance, hResInfo<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov nMusicSize, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .if eax!=NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push BASS_SAMPLE_LOOP or BASS_MUSIC_POSRESET or BASS_MUSIC_RAMPS<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push nMusicSize<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push pMusic<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call BASS_MusicLoad_addr<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .if !eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push BASS_SAMPLE_LOOP or BASS_MUSIC_POSRESET or BASS_MUSIC_RAMPS<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push nMusicSize<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push pMusic<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call BASS_StreamCreateFile_addr<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov module, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; &nbsp; &nbsp; .else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke wsprintf,addr msg,addr syntax,FUNC(GetLastError)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke MessageBox,hwnd,addr msg,addr msg,MB_OK<br />&nbsp; &nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; &nbsp; &nbsp; mov PlayOn, FALSE<br />&nbsp; &nbsp; &nbsp; &nbsp; mov eax,1<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; .elseif m==WM_COMMAND<br />&nbsp; &nbsp; &nbsp; &nbsp; mov eax,wp<br />&nbsp; &nbsp; &nbsp; &nbsp; .if ax==30<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke DestroyWindow,hwnd<br />&nbsp; &nbsp; &nbsp; &nbsp; .elseif ax==10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .if PlayOn == FALSE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push module<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call BASS_ChannelPlay_addr<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov PlayOn, TRUE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push module<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call BASS_ChannelPause_addr<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov PlayOn, FALSE<br />&nbsp; &nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; .elseif m==WM_LBUTTONDOWN<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke ReleaseCapture<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,hwnd,WM_SYSCOMMAND,0F012h,0&nbsp; <br /><br />&nbsp; &nbsp; .elseif m==WM_DESTROY<br />&nbsp; &nbsp; &nbsp; &nbsp; call BASS_Free_addr<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke FreeLibrary,h<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke DeleteFile,addr buf<br />&nbsp; &nbsp; .endif<br />&nbsp; &nbsp; xor eax,eax<br />&nbsp; &nbsp; ret<br />dialogproc endp<br /><br />end start</div>
    <div class="meta">Posted on 2008-06-01 04:41:56 by ragdog</div>
   </div>
  </div>
 </body>
</html>