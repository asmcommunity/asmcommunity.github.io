<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Dropping file - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29516" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=29516">Dropping file</a></p>
   <div class="post" id="post-208476">
    <div class="subject"><a href="#post-208476">Dropping file</a></div>
    <div class="body">I&#039;m trying to drop a file in the users private folder so it can trigger an alarm (daily at a particular time) and open a webpage to notify the users on their daily tasks.<br /><br />I&#039;m facing challenges in dropping the file to private folder, this is how I want it to work.... Whenever the user executes the file it should copy itself to the users private folder.... How will I achieve this? I tried to get the path the executable and try to copy it to the private folder, but it doesn&#039;t seem to work (as the file is locked by another process)....<br /><br />Is there another way to achieve this? Or can I have the exe file (say EXE1) completely dumped into another exe (say EXE2) so that when EXE2 is executed it drops the file EXE1? any pointers...<br /><br />Thanks,<br /><br />C K.</div>
    <div class="meta">Posted on 2009-08-20 03:06:27 by karthikeyanck</div>
   </div>
   <div class="post" id="post-208482">
    <div class="subject"><a href="#post-208482">Re: Dropping file</a></div>
    <div class="body">Why on earth would you need to &quot;drop an executable&quot; in order to achieve this goal? Either you&#039;re going around this problem in a pretty wrong way, or you&#039;re trying to cover up that you really want to do something naughty.</div>
    <div class="meta">Posted on 2009-08-20 04:54:43 by f0dder</div>
   </div>
   <div class="post" id="post-208483">
    <div class="subject"><a href="#post-208483">Re: Dropping file</a></div>
    <div class="body">lol, nothing naughty f0dder.... There was actually one such code that was written in VB by one of my friend that does this stuff, it actually drops a piece of code to the system32 folder and marks an entry in registry so it can start itself during the windows startup... and when the clock strikes 2 it opens up a window that reminds the user of the days work....<br /><br />Why would you not trust me, this is the second time... earlier with injecting code which I learnt myself.... don&#039;t let me quit MASM pls... I have been striving to learn things since long<br /><br />Thanks sincerely,<br /><br />C K</div>
    <div class="meta">Posted on 2009-08-20 06:28:07 by karthikeyanck</div>
   </div>
   <div class="post" id="post-208484">
    <div class="subject"><a href="#post-208484">Re: Dropping file</a></div>
    <div class="body">If you want to &quot;trigger an alarm&quot;, do it the proper way: using the windows task scheduler, running as a service, or simply have your program wait for the right time. There&#039;s no reason to go around dropping executables, and <strong>especially</strong> not in the system32 folder (you, fortunately, don&#039;t have write access there on a sensibly configured system, anyway).<br /><br />Asking about dropping executables will only make people suspicious of your intents.</div>
    <div class="meta">Posted on 2009-08-20 06:42:20 by f0dder</div>
   </div>
   <div class="post" id="post-208487">
    <div class="subject"><a href="#post-208487">Re: Dropping file</a></div>
    <div class="body"><div class="quote"><br />I&#039;m trying to drop a file in the users private folder so it can trigger an alarm (daily at a particular time) and open a webpage to notify the users on their daily tasks.<br /><br />I&#039;m facing challenges in dropping the file to private folder, this is how I want it to work.... Whenever the user executes the file it should copy itself to the users private folder.... How will I achieve this? I tried to get the path the executable and try to copy it to the private folder, but it doesn&#039;t seem to work (as the file is locked by another process)....<br /><br />Is there another way to achieve this? Or can I have the exe file (say EXE1) completely dumped into another exe (say EXE2) so that when EXE2 is executed it drops the file EXE1? any pointers...<br /><br />Thanks,<br /><br />C K.<br /></div><br /><br />Asking questions like that insults people&#039;s intelligence and is not a good way to make friends. <br /><br />If you continue with those kind of questions, you may find out what the meaning of &quot;tar and feathered and run out of town&quot; means?<br /><br /><br /><br /></div>
    <div class="meta">Posted on 2009-08-20 06:54:44 by skywalker</div>
   </div>
   <div class="post" id="post-208488">
    <div class="subject"><a href="#post-208488">Re: Dropping file</a></div>
    <div class="body"><div class="quote"><br /><div class="quote"><br />I&#039;m trying to drop a file in the users private folder so it can trigger an alarm (daily at a particular time) and open a webpage to notify the users on their daily tasks.<br /><br />I&#039;m facing challenges in dropping the file to private folder, this is how I want it to work.... Whenever the user executes the file it should copy itself to the users private folder.... How will I achieve this? I tried to get the path the executable and try to copy it to the private folder, but it doesn&#039;t seem to work (as the file is locked by another process)....<br /><br />Is there another way to achieve this? Or can I have the exe file (say EXE1) completely dumped into another exe (say EXE2) so that when EXE2 is executed it drops the file EXE1? any pointers...<br /><br />Thanks,<br /><br />C K.<br /></div><br /><br />Asking questions like that insults people&#039;s intelligence and is not a good way to make friends. <br /><br />If you continue with those kind of questions, you may find out what the meaning of &quot;tar and feathered and run out of town&quot; means?<br /><br /><br /><br /><br /></div><br /><br />Skywalker, <br /><br />I wasn&#039;t insulting anyone... I was just trying to convey what I wanted to achieve... The way I would have conveyed may be a bit goofy... but that&#039;s what I was after (droping a file).. not insulting people&nbsp; :sad:</div>
    <div class="meta">Posted on 2009-08-20 07:05:41 by karthikeyanck</div>
   </div>
   <div class="post" id="post-208489">
    <div class="subject"><a href="#post-208489">Re: Dropping file</a></div>
    <div class="body"><div class="quote"><br />If you want to &quot;trigger an alarm&quot;, do it the proper way: using the windows task scheduler, running as a service, or simply have your program wait for the right time. There&#039;s no reason to go around dropping executables, and <strong>especially</strong> not in the system32 folder (you, fortunately, don&#039;t have write access there on a sensibly configured system, anyway).<br /><br />Asking about dropping executables will only make people suspicious of your intents.<br /></div><br /><br />The reason behind dropping them in the system32 folder is because the source arrives to the user from emails... they either execute them directly or save them to alternative directory and execute it at a later stage. So scheduling a task with exe&#039;s lying in different areas would not be a best practice.. Hence to make it common on all the machines I wish to drop them in a common place, system32 is one of them.... </div>
    <div class="meta">Posted on 2009-08-20 07:09:05 by karthikeyanck</div>
   </div>
   <div class="post" id="post-208490">
    <div class="subject"><a href="#post-208490">Re: Dropping file</a></div>
    <div class="body">Executables attached to emails dropping themselves to system32... that, combined with your previous post about injecting code into IE really screams &quot;up to no good&quot;.<br /><br />Use an installer and let the users pick an install location.</div>
    <div class="meta">Posted on 2009-08-20 07:28:13 by f0dder</div>
   </div>
   <div class="post" id="post-208491">
    <div class="subject"><a href="#post-208491">Re: Dropping file</a></div>
    <div class="body">f0dder,<br /><br />The executable arrive in emails because the users of this app is quite a few of them.. They don&#039;t drop themselves from the email, but I meant executed (just running the executable from the email client).. Alright, I wouldn&#039;t keep bugging for this piece anymore... let me try an find an alternative to this..<br /><br />Thanks for your help guys...</div>
    <div class="meta">Posted on 2009-08-20 07:46:45 by karthikeyanck</div>
   </div>
   <div class="post" id="post-208493">
    <div class="subject"><a href="#post-208493">Re: Dropping file</a></div>
    <div class="body">Well, use one of the standard installers, I&#039;m sure they offer a silent mode - that&#039;ll also mean less risk of your application getting picked up as a virus. And, again, install to a standard location - don&#039;t even think about %SystemRoot% or %SystemRoot%\system32.</div>
    <div class="meta">Posted on 2009-08-20 10:15:40 by f0dder</div>
   </div>
   <div class="post" id="post-208494">
    <div class="subject"><a href="#post-208494">Re: Dropping file</a></div>
    <div class="body">If you truly want to do what you said you want then the legitimate way to do it is (1) use an installer to install your software in the Program Files folder (or any other user-specified location) and then (2) use the <a target="_blank" href="http://msdn.microsoft.com/en-us/library/aa383614(VS.85).aspx">Task Scheduler</a>.<br /><br />That&#039;s basically all you need.<br /><br />Documents and Setting, as the name suggests, is not where you are supposed to keep any EXEs.</div>
    <div class="meta">Posted on 2009-08-20 10:17:43 by ti_mo_n</div>
   </div>
   <div class="post" id="post-208502">
    <div class="subject"><a href="#post-208502">Re: Dropping file</a></div>
    <div class="body">I won&#039;t mention the security issues associated with the task scheduler if you don&#039;t?<br /></div>
    <div class="meta">Posted on 2009-08-21 05:08:02 by Homer</div>
   </div>
   <div class="post" id="post-208503">
    <div class="subject"><a href="#post-208503">Re: Dropping file</a></div>
    <div class="body"><div class="quote">I won&#039;t mention the security issues associated with the task scheduler if you don&#039;t?</div>The task scheduler doesn&#039;t <em>have</em> to run tasks under the SYSTEM account, if that&#039;s what you&#039;re implying :)</div>
    <div class="meta">Posted on 2009-08-21 05:17:46 by f0dder</div>
   </div>
   <div class="post" id="post-208505">
    <div class="subject"><a href="#post-208505">Re: Dropping file</a></div>
    <div class="body">:)</div>
    <div class="meta">Posted on 2009-08-21 07:54:52 by Homer</div>
   </div>
   <div class="post" id="post-208506">
    <div class="subject"><a href="#post-208506">Re: Dropping file</a></div>
    <div class="body">Task Scheduler? What&#039;s that? Ah, yes i remember, a useless service that gets disabled together with useless &quot;indexing service&quot; and useless &quot;system restore&quot; (and a lot of other) even before installation takes place.<br /><br /> :P</div>
    <div class="meta">Posted on 2009-08-21 10:22:31 by drizz</div>
   </div>
  </div>
 </body>
</html>