<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>about son dialog box of the windows - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19892" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19892">about son dialog box of the windows</a></p>
   <div class="post" id="post-152746">
    <div class="subject"><a href="#post-152746">about son dialog box of the windows</a></div>
    <div class="body">the code below is tutorial of iczelion,it create a son modeless dialog box of a window.my question is who process the message while the dialog box procude not processed.is DefWindowProc in parent window?if that how the message send to the parent window's procude?<br /><br />thank you first .<br /><pre><code><br /><br />.386<br />.model flat,stdcall<br />option casemap&#58;none<br />include \masm32\include\windows.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\kernel32.inc<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br /><br />WinMain proto &#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD<br />DlgProc PROTO &#58;HWND, &#58;DWORD, &#58;DWORD, &#58;DWORD<br /><br />.data<br />ClassName db &quot;SimpleWinClass&quot;,0<br />AppName  db &quot;Our Main Window&quot;,0<br />MenuName db &quot;FirstMenu&quot;,0<br />DlgName db &quot;MyDialog&quot;,0<br />TestString db &quot;Hello, everybody&quot;,0<br />hwndDlg dd 0            ; Handle to the dialog box<br /><br />.data?<br />hInstance HINSTANCE ?<br />CommandLine LPSTR ?<br /><br />.const<br />IDM_EXIT equ 1<br />IDM_ABOUT equ 2<br />IDC_EDIT  equ 3000<br />IDC_BUTTON equ 3001<br />IDC_EXIT equ 3002<br /><br />.code<br />start&#58;<br />	invoke GetModuleHandle, NULL<br />	mov    hInstance,eax<br />	invoke GetCommandLine<br />	mov CommandLine,eax<br />	invoke WinMain, hInstance,NULL,CommandLine, SW_SHOWDEFAULT<br />	invoke ExitProcess,eax<br />WinMain proc hInst&#58;HINSTANCE,hPrevInst&#58;HINSTANCE,CmdLine&#58;LPSTR,CmdShow&#58;DWORD<br />	LOCAL wc&#58;WNDCLASSEX<br />	LOCAL msg&#58;MSG<br />	LOCAL hwnd&#58;HWND<br />	mov   wc.cbSize,SIZEOF WNDCLASSEX<br />	mov   wc.style, CS_HREDRAW or CS_VREDRAW<br />	mov   wc.lpfnWndProc, OFFSET WndProc<br />	mov   wc.cbClsExtra,NULL<br />	mov   wc.cbWndExtra,NULL<br />	push  hInst<br />	pop   wc.hInstance<br />	mov   wc.hbrBackground,COLOR_WINDOW+1<br />	mov   wc.lpszMenuName,OFFSET MenuName<br />	mov   wc.lpszClassName,OFFSET ClassName<br />	invoke LoadIcon,NULL,IDI_APPLICATION<br />	mov   wc.hIcon,eax<br />	mov   wc.hIconSm,eax<br />	invoke LoadCursor,NULL,IDC_ARROW<br />	mov   wc.hCursor,eax<br />	invoke RegisterClassEx, addr wc<br />	INVOKE CreateWindowEx,WS_EX_CLIENTEDGE,ADDR ClassName,ADDR AppName,\<br />           WS_OVERLAPPEDWINDOW,CW_USEDEFAULT,\<br />           CW_USEDEFAULT,300,200,NULL,NULL,\<br />           hInst,NULL<br />	mov   hwnd,eax<br />	INVOKE ShowWindow, hwnd,SW_SHOWNORMAL<br />	INVOKE UpdateWindow, hwnd<br />	.WHILE TRUE<br />                INVOKE GetMessage, ADDR msg,NULL,0,0<br />                .BREAK .IF &#40;!eax&#41;<br />                .if hwndDlg!=0<br />                        invoke IsDialogMessage,hwndDlg,ADDR msg<br />                        .if eax==TRUE<br />                                .continue<br />                        .endif<br />                .endif<br />                INVOKE TranslateMessage, ADDR msg<br />                INVOKE DispatchMessage, ADDR msg<br />	.ENDW<br />	mov     eax,msg.wParam<br />	ret<br />WinMain endp<br />WndProc proc hWnd&#58;HWND, uMsg&#58;UINT, wParam&#58;WPARAM, lParam&#58;LPARAM<br />	.IF uMsg==WM_DESTROY<br />		invoke PostQuitMessage,NULL<br />	.ELSEIF uMsg==WM_COMMAND<br />		mov eax,wParam<br />		.if ax==IDM_ABOUT<br />			invoke CreateDialogParam,hInstance, addr DlgName,hWnd,OFFSET DlgProc,NULL<br />			mov hwndDlg,eax<br />		.else<br />			invoke DestroyWindow, hWnd<br />		.endif<br />	.ELSE<br />		invoke DefWindowProc,hWnd,uMsg,wParam,lParam<br />		ret<br />	.ENDIF<br />	xor    eax,eax<br />	ret<br />WndProc endp<br /><br />DlgProc PROC hWnd&#58;HWND,iMsg&#58;DWORD,wParam&#58;WPARAM, lParam&#58;LPARAM<br />        .if iMsg==WM_INITDIALOG<br />		invoke GetDlgItem,hWnd,IDC_EDIT<br />		invoke SetFocus,eax<br />        .elseif iMsg==WM_CLOSE<br />		invoke EndDialog,hWnd,NULL<br />		mov hwndDlg,0<br />        .elseif iMsg==WM_COMMAND<br />		mov eax,wParam<br />		mov edx,eax<br />		shr edx,16<br />		.if dx==BN_CLICKED<br />			.if eax==IDC_EXIT<br />				invoke SendMessage,hWnd,WM_CLOSE,NULL,NULL<br />			.elseif eax==IDC_BUTTON<br />				invoke SetDlgItemText,hWnd,IDC_EDIT,ADDR TestString<br />			.endif<br />		.endif		   <br />        .else<br />		mov eax,FALSE<br />		ret<br />        .endif<br />        mov  eax,TRUE<br />        ret<br />DlgProc endp<br />end start<br /></code></pre></div>
    <div class="meta">Posted on 2004-11-11 20:07:37 by geegle</div>
   </div>
   <div class="post" id="post-152761">
    <div class="subject"><a href="#post-152761">about son dialog box of the windows</a></div>
    <div class="body">it seems the code was wrong.because it use CreateDialogParam create a<br />modeless dialog box,but it use the procude which to handle the model dialog box message to process.</div>
    <div class="meta">Posted on 2004-11-11 23:43:46 by geegle</div>
   </div>
  </div>
 </body>
</html>