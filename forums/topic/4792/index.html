<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Making a stub dll - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4792" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4792">Making a stub dll</a></p>
   <div class="post" id="post-33564">
    <div class="subject"><a href="#post-33564">Making a stub dll</a></div>
    <div class="body">Hi,<br /><br />The thing I try to do is following:<br /><br />I have original DLL which I dont have sources and I want to write a log about how many times specifig functions are used. I was thinking to rename the original dll to something org_dll.dll and write my own dll.dll which then calls functions from org_dll.dll. And when the specific function is called then write to the log file and pass it to org_dll.dll. I hope you understand what I'm trying to do!<br /><br />Now the tricky part (atleast for me) how do I know how many parameters those original functions take and what sizes are they?<br /><br />regards, Sami</div>
    <div class="meta">Posted on 2002-04-15 08:58:00 by SamiP</div>
   </div>
   <div class="post" id="post-33593">
    <div class="subject"><a href="#post-33593">Making a stub dll</a></div>
    <div class="body">have a look at the return command of a specific function. If it returns f.e. &quot;ret 8&quot; then the function likely has 2 parameters.<br />If all functions return only with &quot;ret&quot;, take a look at code calling the function,  it should correct the stack after calling, <br />example &quot;add esp, 8&quot; - meaning also 2 parameters.<br /><br />If neither first or second case, then the function has 0 paremeters.<br /><br />(please remember: re-engeneering foreign code is sometimes a voilation of copyrights)</div>
    <div class="meta">Posted on 2002-04-15 12:26:03 by beaster</div>
   </div>
   <div class="post" id="post-33594">
    <div class="subject"><a href="#post-33594">Making a stub dll</a></div>
    <div class="body"><div class="quote"><br />(please remember: re-engeneering foreign code is sometimes a voilation of copyrights) </div><br /><br />And it's forbidden to talk about on this board, too.<br />You're moving on thin ice, SamiP, be carefull what you ask...<br /><span style="font-size:9px>(just a friendly reminder)</span></div>
    <div class="meta">Posted on 2002-04-15 12:30:17 by bazik</div>
   </div>
   <div class="post" id="post-33602">
    <div class="subject"><a href="#post-33602">Making a stub dll</a></div>
    <div class="body">Thanks for the help Beaster!<br /><br />I must say that the code of the program is owned by company wich I work for. The program is made few years ago by some summer holiday help worker as a sort time help... and it's still used today. Now we are moving to Windows XP and the program doesn't anymore work as expedted. Now I need to fix it or code a new program for that task... and as I'm so lazy I thought that simply logging what the program does gives me some glues about whats wrong with it.<br /><br />Maybe its best to code a new program... atleast that way I know what it is doing :)<br /><br />And lets leave skating on thin ice...<br /><br />SamiP</div>
    <div class="meta">Posted on 2002-04-15 13:30:32 by SamiP</div>
   </div>
  </div>
 </body>
</html>