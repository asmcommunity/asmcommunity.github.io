<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Direct3D9 enumeration scheme - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20766" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=20766">Direct3D9 enumeration scheme</a></p>
   <div class="post" id="post-158083">
    <div class="subject"><a href="#post-158083">Direct3D9 enumeration scheme</a></div>
    <div class="body">This topic is not a problem or question - it&#39;s an explaination, so if you know everything, then get out :P<br /><br /><br />So, to the point:<br />As I got frustrated trying to properly and fully enumerate all possible rendering modes on all possible devices of all possible adapters in the system, i decided to visualize it.<br /><br /><a target="_blank" href="http://www.imagehosting.us/imagehosting/showimg.gif/?id=576571"><img src="http://www.imagehosting.us/himages/ihnp-576571thumb.gif" /></a><br /><br />The image shows D3D9&#39;s internal object dependency.<br />We can see, that for every &quot;Adapter&quot; there are possible &quot;Devices&quot;.<br />For every &quot;Device&quot; there are &quot;Display Formats&quot;.<br />For every &quot;Display Format&quot; there are &quot;Display Resolutions&quot; a &quot;Fullscreen Mode&quot; and &quot;Windowed Mode&quot;.<br />For every Mode there is a &quot;BackBuffer Format&quot;.<br />For every &quot;BackBuffer Format&quot; there is a &quot;Multisampling Type&quot; and &quot;Depth/Stencil Format&quot;<br />For every &quot;Depth/Stencil Format&quot; there is also &quot;Multisampling Type&quot;<br /><br />So:<br /><pre><code>I)? We get number of adapters (IDirect3D9::GetAdapterCount)<br />II) For Every Adapter do:<br />? ?1) Get valid Devices. A devices is considered &#39;valid&#39; if there are valid Capabilities for it, <br />? ? ? returned by IDirect3D9::GetDeviceCaps. Also the &quot;IDirect3D9::GetDeviceCaps&quot; call must return<br />? ? ? S_OK. if you really wish - you can skip this test, since almost all GFX adapters do support HAL<br />? ?2) For every valid device (or just for HAL, since 99% of all apps use HAL) do:<br />? ? ? a) Get Valid Display Formats. Display format is considered valid if there is at least 1 Display<br />? ? ? ? ?Resolution for it. So we do &quot;IDirect3D9::GetAdapterModeCount&quot; for every format.<br />? ? ? b) For every valid format (with at least 1 display resolution) do:<br />? ? ? ? ?- ) loop through 0 to (valid_display_resolutions-1) with a call to<br />? ? ? ? ? ? ?IDirect3D9::EnumAdapterModes.<br />? ? ? ? ?--) for Windowed mode do:? <br />? ? ? ? ? ? ?x? ?) Get valid backbuffer formats (IDirect3D9::CheckDeviceType must return S_OK)<br />? ? ? ? ? ? ?xx? ) For every valid backbuffer format check for valid Depth/stencil formats<br />? ? ? ? ? ? ? ? ? ?(IDirect3D9::CheckDeviceFormat) and also confirm, that a valid depth/stencil<br />? ? ? ? ? ? ? ? ? ?can be used on actual device, in actual display format, and actual backbuffer<br />? ? ? ? ? ? ? ? ? ?format (IDirect3D9::CheckDepthStencilMatch)<br />? ? ? ? ? ? ?xxx ) Check for valid multisample types. Repeat IDirect3D9::CheckDeviceMultiSampleType<br />? ? ? ? ? ? ? ? ? ?for actual backbuffer format.<br />? ? ? ? ? ? ?xxxx) for every valid babkcuffer-multisampling type, check this type again, only this<br />? ? ? ? ? ? ? ? ? ?time for depth/stencil format. multisampling can be used only if it&#39;s supported<br />? ? ? ? ? ? ? ? ? ?by backbuffer&#39;s format, and corresponding depth/stencil&#39;s format (quite logical :P)<br />? ? ? ? ? ? ? ? ? ?*** note: if you plan to support Z-LESS HSR, you don&#39;t have to create depth/stencil<br />? ? ? ? ? ? ? ? ? ?surface, and thus you can skip point &quot;xx&quot; and &quot;xxxx&quot;, since you won&#39;t be using<br />? ? ? ? ? ? ? ? ? ?any &#39;z&#39; or &#39;w&#39; buffers :) ***<br />? ? ? ? ?---) repeat &quot;--&quot; for fullscreen mode.</code></pre><br /><br />this is the &#39;proper way&#39; which is used by all microsoft&#39;s tutorials and demos.<br />it works fine with D3D9 and it SHOULD work with D3D8 (but i haven&#39;t tested it)<br /><br />I hope it&#39;ll help anyone :P </div>
    <div class="meta">Posted on 2005-03-17 17:55:52 by ti_mo_n</div>
   </div>
  </div>
 </body>
</html>