<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Some optimization needed :) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5771" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5771">Some optimization needed :)</a></p>
   <div class="post" id="post-41274">
    <div class="subject"><a href="#post-41274">Some optimization needed :)</a></div>
    <div class="body">If someone could help me optimizing the following code, I would be very greatful :<br /><br /><pre><code><br />    xor eax,eax<br /><br />    mov al, byte ptr&#91;oldcolor+0&#93;;<br />    add eax,intens<br />     cmp eax,0<br />     jnl @rOK1<br />     xor eax,eax<br />     @rOK1&#58;<br />     cmp eax,255<br />     jna @rOK2<br />     mov eax,255<br />     @rOK2&#58;<br />    mov BYTE PTR&#91;newcolor&#93;,al<br /><br />    mov al, byte ptr&#91;oldcolor+1&#93;;<br />    add eax,intens<br />     cmp eax,0<br />     jnl @gOK1<br />     xor eax,eax<br />     @gOK1&#58;<br />     cmp eax,255<br />     jna @gOK2<br />     mov eax,255<br />     @gOK2&#58;<br />    mov BYTE PTR&#91;newcolor+1&#93;,al<br /><br />    mov al, byte ptr&#91;oldcolor+2&#93;;<br />    add eax,intens<br />     cmp eax,0<br />     jnl @bOK1<br />     xor eax,eax<br />     @bOK1&#58;<br />     cmp eax,255<br />     jna @bOK2<br />     mov eax,255<br />     @bOK2&#58;<br />    mov BYTE PTR&#91;newcolor+2&#93;,al<br /></code></pre><br /><br />The above code adds the value of &quot;intens&quot; to the r,g and b values of &quot;oldcolor&quot; and saves the new value to &quot;newcolor&quot; (newcolor==a ligther/darker version of oldcolor). r,g &amp; b must be between 0h and FFh. <br /><br />I read somewhere that some MMX-intructions handles the range check automaticly when adding numbers, but I don't know anything about MMX so I thought someone could help me with this (if it's possible).<br /><br />/Delight</div>
    <div class="meta">Posted on 2002-06-03 14:18:19 by Delight</div>
   </div>
   <div class="post" id="post-41279">
    <div class="subject"><a href="#post-41279">Some optimization needed :)</a></div>
    <div class="body">Search the board for 'saturated':<br /><a target="_blank" href="http://www.asmcommunity.net/board/search.php?s=&amp;action=showresults&amp;searchid=51671&amp;sortby=lastpost&amp;sortorder=descending">http://www.asmcommunity.net/board/search.php?s=&amp;action=showresults&amp;searchid=51671&amp;sortby=lastpost&amp;sortorder=descending</a></div>
    <div class="meta">Posted on 2002-06-03 14:40:57 by bitRAKE</div>
   </div>
  </div>
 </body>
</html>