<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Utility for undecorating in masm32 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26686" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26686">Utility for undecorating in masm32</a></p>
   <div class="post" id="post-192611">
    <div class="subject"><a href="#post-192611">Utility for undecorating in masm32</a></div>
    <div class="body">You may have encountered problems with ml.exe decorating symbols inappropriately in mixed library situations (C and C++).  I wasn't able to figure out how to use extern C in masm, and only one .model directive is allowed, typically: .model flat, stdcall.  A common situation where decoration is a problem is when you disassemble and then use masm to rebuild exes that make calls to msvcrt.dll; the functions there need to be called extern C and should not be decorated.  

These problems prompted me to write a utility (11 KB, ANSI C) that will directly undecorate a list of names in the object file that ml.exe generates, so that the linker can find the names. It goes through the string table, changing the strings that match the names in your list, and patches the RVA's in the symbol table to get a new obj file with correctly decorated names. 

If there is interest, I can make the source code available.</div>
    <div class="meta">Posted on 2001-01-27 14:21:00 by Alan Mason</div>
   </div>
  </div>
 </body>
</html>