<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Mouseover Effect on Buttons ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27086" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27086">Mouseover Effect on Buttons ?</a></p>
   <div class="post" id="post-194533">
    <div class="subject"><a href="#post-194533">Mouseover Effect on Buttons ?</a></div>
    <div class="body">Hi

after i take a look inside w32.inc ,im very happy to have now nice flat buttons *bg*
(sorry,im new to asm and think first i can only make textbuttons)

now i like to make some kind of mouse over effect with the buttons ,like: if the mouse is over a button,the textcolor should move from black to white or so.

after searching some time,i found sources showing me how to set background color for all editfields or static text,but not for buttontext.

where can i find a small example or a desription about what kinds of buttons i can make ?

thanks ;)</div>
    <div class="meta">Posted on 2001-03-03 04:49:00 by WHÂ¥</div>
   </div>
   <div class="post" id="post-194534">
    <div class="subject"><a href="#post-194534">Mouseover Effect on Buttons ?</a></div>
    <div class="body">If you get any answer on your mail I would be glad if you could inform me about it too, because i am searching for something like this, too.

thx. 

sign CyBerian</div>
    <div class="meta">Posted on 2001-03-03 14:55:00 by CyBerian</div>
   </div>
   <div class="post" id="post-194535">
    <div class="subject"><a href="#post-194535">Mouseover Effect on Buttons ?</a></div>
    <div class="body">Hey, theres a little trick to this...

Everytime a button goes to repaint itself, its sends a WM_CTLCOLORBTN message to its parent window. Look it up, but there are certain tricks to using this message which i dont know, (ie its easy to screw up the painting of your button), cause ive never used this message before.

Also, ive always wondered, whats the easyist way to tell when the mouse is over a window, cause i know you can wait for a WM_MOUSEMOVE message and then capture the mouse, but as far as i know, windows doesn't have a WM_MOUSEOVER message to tell you when your window has the mouse over it, and then a pair to tell you when you lose that. If you can get what i mean there?

thnx

This message was edited by George, on 3/3/2001 5:35:57 PM</div>
    <div class="meta">Posted on 2001-03-03 17:29:00 by George</div>
   </div>
   <div class="post" id="post-194536">
    <div class="subject"><a href="#post-194536">Mouseover Effect on Buttons ?</a></div>
    <div class="body">Under W98+ or NT4, there is a _TrackMouseEvent function that gives you WM_MOUSEHOVER and WM_MOUSELEAVE messages.

Actually, same messages work on W95 if *something* has been installed. I forget which dll, something from MSIE I believe, but it's something you cannot legally re-distrubute.

Personally, I wouldn;t use it for this compatability reason, but your mileage may vary.</div>
    <div class="meta">Posted on 2001-03-04 02:42:00 by Ernie</div>
   </div>
   <div class="post" id="post-194537">
    <div class="subject"><a href="#post-194537">Mouseover Effect on Buttons ?</a></div>
    <div class="body">I'm not sure if it's going to work but you can try the WM_MOUSEMOVE message. (quoted text from API)

"The WM_MOUSEMOVE message is posted to a window when the cursor moves. If the mouse is not captured, the message is posted to the window that contains the cursor. Otherwise, the message is posted to the window that has captured the mouse.

WM_MOUSEMOVE 
fwKeys = wParam;        // key flags 
xPos = LOWORD(lParam);  // horizontal position of cursor 
yPos = HIWORD(lParam);  // vertical position of cursor"

If the coordinates of the mouse are within the area of the window/button/whatever... then do the changes to the window.

Not sure whether/how this function will work but nevertheless here it is:

"The SetWindowLong function changes an attribute of the specified window. The function also sets a 32-bit (long) value at the specified offset into the extra window memory of a window. 

LONG SetWindowLong(

    HWND  hwnd,	// handle of window
    int  nIndex,	// offset of value to set
    LONG  lNewLong 	// new value
   );

There must be a simple way of doing what you have in mind. If I come up with/across something I'll let you know.

Regards</div>
    <div class="meta">Posted on 2001-03-05 06:16:00 by matz</div>
   </div>
   <div class="post" id="post-194538">
    <div class="subject"><a href="#post-194538">Mouseover Effect on Buttons ?</a></div>
    <div class="body">Well i have an idea, it may take a little bit of coding though, but i dont have the time to write the example right now, mabe tomorrow, but you could trap the WM_MOUSEMOVE message and call GetWindowRect for your window coordinates, and then if you knew exactley where the button was you could write code to fill in a new RECT structure for the button, now then after that you could test each WM_MOUSEMOVE message with a ClipCursor call, and test weather the value ClipCursor returns TRUE(its in the rect) or FALSE(its not in the rect) and then call the button code.  its just a thought.

-brad</div>
    <div class="meta">Posted on 2001-03-05 23:51:00 by Rage9</div>
   </div>
   <div class="post" id="post-194539">
    <div class="subject"><a href="#post-194539">Mouseover Effect on Buttons ?</a></div>
    <div class="body">After retrieveing the rect, you could also use the api function "PtInRect", that's what i would use anyways :)</div>
    <div class="meta">Posted on 2001-03-06 00:17:00 by Jon Richardson</div>
   </div>
   <div class="post" id="post-194540">
    <div class="subject"><a href="#post-194540">Mouseover Effect on Buttons ?</a></div>
    <div class="body">I have just the code example you
need, the code is small, there is 
no other stuff in the code, so you
don't have to wade thru alot of
source code to see how it is working.
the examble demo I wrote is called
Pop Out Buttons you can get it from
my webpage at: <pre><code>http://www.masm32.com</code></pre>
I hope this what your looking for.</div>
    <div class="meta">Posted on 2001-03-08 02:26:00 by Zcoder</div>
   </div>
  </div>
 </body>
</html>