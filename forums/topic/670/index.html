<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Strategies for makes Controlbar - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=670" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=670">Strategies for makes Controlbar</a></p>
   <div class="post" id="post-4029">
    <div class="subject"><a href="#post-4029">Strategies for makes Controlbar</a></div>
    <div class="body">I'm a newbie to win32asm programming, and would like to know how much is involved in constructing a Controlbar as is seen in applications like Visual C++ and BC++ Builder.<br /><br />What are the strategies for making such a construction in win32asm or C.<br /><br />Thanks,<br />--<br />RolfT</div>
    <div class="meta">Posted on 2001-08-18 07:03:36 by rolft</div>
   </div>
   <div class="post" id="post-4087">
    <div class="subject"><a href="#post-4087">Strategies for makes Controlbar</a></div>
    <div class="body">Do you mean a 'docking' toolbar? One you can stick into the main window on some edge, or pull it and let it free float as a topmost window?</div>
    <div class="meta">Posted on 2001-08-18 23:48:23 by Ernie</div>
   </div>
   <div class="post" id="post-4100">
    <div class="subject"><a href="#post-4100">Strategies for makes Controlbar</a></div>
    <div class="body">Yes, I mean a full blown docking toolbar, which when docked into the main window, has an appearance like the toolbars in the mentioned applications - each toolbar-area is raised instead of the standard rebar style.<br /><br />--<br />RolfT</div>
    <div class="meta">Posted on 2001-08-19 03:42:02 by rolft</div>
   </div>
   <div class="post" id="post-4115">
    <div class="subject"><a href="#post-4115">Strategies for makes Controlbar</a></div>
    <div class="body">The basic idea to make a docking toolbar is simple. The devil is in the details.<br /><br />To dock a window, just change it's WS_CHILD and S_EX_TOOLWINDOW styles to TRUE and FALSE, respectively. And of course, set them the other way to undock.<br /><br />Of course, it would be nice to be able to plant these on Rebar controls to borrow that functionality. 4 rebars, in fact, so each side of the screen is covered.<br /><br />I spent about 3 solid full time months on this and only got close. The biggest hurdle left was handling simple toolbars, as these make asumptions about their parent which simply are not ture when docking.<br /><br />A sample program using this control <a target="_blank" href="http://ourworld.compuserve.com/homepages/ernies_world/ToolTab.zip">is available</a>. I have no plans to release the source code (about 150K total spread over 12 .asm and .inc files), but am quite willing to discuss how I did certain details.</div>
    <div class="meta">Posted on 2001-08-19 09:06:28 by Ernie</div>
   </div>
   <div class="post" id="post-4143">
    <div class="subject"><a href="#post-4143">Strategies for makes Controlbar</a></div>
    <div class="body">Ernie,<br />     You are scaring me. I would be making those in about  a month from now.:grin:</div>
    <div class="meta">Posted on 2001-08-19 13:28:24 by MovingFulcrum</div>
   </div>
   <div class="post" id="post-4177">
    <div class="subject"><a href="#post-4177">Strategies for makes Controlbar</a></div>
    <div class="body">Hey, I wish you good luck. And yes, I am trying to scare you.<br /><br />It's not a simple problem. If I hadn't been coding near full time for the previous year in MASM32 for windows I wouldn't have got as far as I did.<br /><br />And I did get pretty far, my control class works quite nicely for well behaved controls like edit boxes or list views, ie, those windows that just sit where they are told to on their parent window.<br /><br />The last trick left over (OK, the largest on the TODO list) was toolbars. Toolbars just jump around too much, and I don't see all the implications of the jumping to make a &quot;well behaved&quot; container window class for them so the rest of my code can work them.<br /><br />To a lesser degree, another leftover TODO was the 'docking logic,' or how to tell over which edge of the main app window you are over, and what windows are already there so you can drop a floating window where you wish, not 'just somewhere' in an existing rebar.<br /><br />And I do mean 'existing.' I found rebars so quirky (even after subclassing them) that I found it best to simply destroy any rebar that holds zero children. That means before you drop on a rebar, you need check it really exists, and create it there if it doesn't.<br /><br />Should I mention things like painting the control buttons on a docked tab? <br /><br />Hey, even making a decent window shadow box to show drag movement took a couple weeks of fine tweaking (and also a very nice mag article on something similar).</div>
    <div class="meta">Posted on 2001-08-19 22:47:57 by Ernie</div>
   </div>
  </div>
 </body>
</html>