<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>FreeLibrary - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18883" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18883">FreeLibrary</a></p>
   <div class="post" id="post-146135">
    <div class="subject"><a href="#post-146135">FreeLibrary</a></div>
    <div class="body">Hi.<br /><br />Is it nessesary to use FreeLibrary, if my program loaded a dll via LoadLibrary ?<br />I think, when my program ends, Windows will automaticaly use FreeLibrary and kick the dll out. I think, XP do so. Or not ?<br /><br />Greetings,<br />Nordwind64</div>
    <div class="meta">Posted on 2004-07-15 14:42:09 by Nordwind64</div>
   </div>
   <div class="post" id="post-146136">
    <div class="subject"><a href="#post-146136">FreeLibrary</a></div>
    <div class="body">ofcourse it's not nessesary<br />Windows release all of memory when your program calls &quot;ExitProcess&quot;.</div>
    <div class="meta">Posted on 2004-07-15 14:53:44 by Criminal2</div>
   </div>
   <div class="post" id="post-146137">
    <div class="subject"><a href="#post-146137">FreeLibrary</a></div>
    <div class="body">ExitProcess will signal the DLL and unload it.<br /><br /><div class="quote"><strong>ExitProcess</strong> is the preferred method of ending a process. This function provides a clean process shutdown. This includes calling the entry-point function of all attached dynamic-link libraries (DLLs) with a value indicating that the process is detaching from the DLL.</div></div>
    <div class="meta">Posted on 2004-07-15 14:55:15 by donkey</div>
   </div>
   <div class="post" id="post-146139">
    <div class="subject"><a href="#post-146139">FreeLibrary</a></div>
    <div class="body">It's not necessary, but it is &quot;good practice&quot; - if that means anything to you :)</div>
    <div class="meta">Posted on 2004-07-15 16:46:45 by f0dder</div>
   </div>
   <div class="post" id="post-146142">
    <div class="subject"><a href="#post-146142">FreeLibrary</a></div>
    <div class="body"><div class="quote"><br />It's not necessary, but it is &quot;good practice&quot; - if that means anything to you :) </div><br />In this case I am not sure whether it is good practice or bad, I don't think it makes any difference at all. Obviously the PELoader does not insert the FreeLibrary code for every DLL it loads, it lets the OS take care of the clean up, in the same way you can rely on DLL's loaded through LoadLibrary to do the same thing. It is simply redundant to call FreeLibrary, the ExitProcess API is very specific about the execution order:<br /><div class="quote">After all attached DLLs have executed any process termination value, this function terminates the current process.</div></div>
    <div class="meta">Posted on 2004-07-15 17:10:35 by donkey</div>
   </div>
   <div class="post" id="post-146144">
    <div class="subject"><a href="#post-146144">FreeLibrary</a></div>
    <div class="body">The only case I can think of (right now anyway, quite knackered, been reading all day) where it might matter, is if the process is terminated abruptly (terminateprocess, or perhaps a crash) - I guess NT will do cleanup fine, but 9x might not. Of course this only matters if the DLL is used for a short period of time, if it's used for the lifetime of the app it wouldn't be cleaned anyway.<br /><br />Yes, the above probably doesn't make much sense, I'm too trashed to express it any better atm :)</div>
    <div class="meta">Posted on 2004-07-15 17:25:14 by f0dder</div>
   </div>
   <div class="post" id="post-146178">
    <div class="subject"><a href="#post-146178">FreeLibrary</a></div>
    <div class="body">Thank you !</div>
    <div class="meta">Posted on 2004-07-16 02:37:38 by Nordwind64</div>
   </div>
  </div>
 </body>
</html>