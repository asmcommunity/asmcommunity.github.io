<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>I Have Done ! is already Printing !! :))  convert bmp to DIB - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=308" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=308">I Have Done ! is already Printing !! :))  convert bmp to DIB</a></p>
   <div class="post" id="post-1803">
    <div class="subject"><a href="#post-1803">I Have Done ! is already Printing !! :))  convert bmp to DIB</a></div>
    <div class="body">;resolved!!   DIB is the solution<br />;=========<br /><br />PrintFileBitmap:<br /><br />;simple is this one but i dont want that...<br />;call ShellExecuteA,,print,FileName, 0, 0, SW_HIDE<br /><br />mov dword ,DOCINFO_size<br />mov dword ,thyssen<br />mov dword ,0<br />mov dword ,0<br />mov dword ,0<br /><br />call  CreateDCA, NULL,printername, NULL, NULL		<br />mov	,eax<br />call StartDocA,,dinf<br />call StartPage,<br />call CreateCompatibleDC,<br />mov ,eax<br />call LoadImageA, , FileName,IMAGE_BITMAP, 0, 0,LR_LOADFROMFILE | LR_CREATEDIBSECTION<br />mov ,eax  &lt;- ok :)  bmp is in format DIB<br />call CreateCompatibleBitmap,,201,189    <br />mov ,eax <br />call SelectObject, ,  <br />call BitBlt,,50,50,201,189,,0,0,SRCCOPY <br />;call Ellipse,,0,0,201,189<br /><br /><br />call DeleteDC,<br />call TextOutA,,100,100,YourTextHeHe,18<br /><br />call EndPage,<br />call EndDoc,<br />call DeleteDC,<br /><br />ret<br />;--------------</div>
    <div class="meta">Posted on 2001-07-23 14:43:02 by Nguga</div>
   </div>
  </div>
 </body>
</html>