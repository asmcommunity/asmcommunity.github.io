<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Newbies Confusion about .lib files btween VC and MASM... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4673" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4673">Newbies Confusion about .lib files btween VC and MASM...</a></p>
   <div class="post" id="post-32789">
    <div class="subject"><a href="#post-32789">Newbies Confusion about .lib files btween VC and MASM...</a></div>
    <div class="body">I created a New project with Masm32 ,but need a dll generated from VC6.0,So I write as below(the lib was generated from VC6.0)<br />...<br />includelib mylib<br />Myproc proto :dword<br />...<br /><br />invoke Myproc,Arg1<br /><br />but the linker can't recognize Myproc,After deep thinking,I found the lib not compatible with mam32?<br />How can I use the lib gennerated by VC?<br />How were all the libs in masm32 generated?<br />Any comments orideas would be appreciated...</div>
    <div class="meta">Posted on 2002-04-08 09:44:35 by Hume</div>
   </div>
   <div class="post" id="post-32790">
    <div class="subject"><a href="#post-32790">Newbies Confusion about .lib files btween VC and MASM...</a></div>
    <div class="body">Did you define your C function as STDCALL before to make the lib ?</div>
    <div class="meta">Posted on 2002-04-08 09:45:55 by JCP</div>
   </div>
   <div class="post" id="post-32791">
    <div class="subject"><a href="#post-32791">yes...</a></div>
    <div class="body">Yes,I did so in my VC dll project:<br /><br />int WINAPI Myproc(int a,int b)<br />{<br /><br />....<br />}<br />but still not work...I think there must be something different between VC .libs and MASm32 .libs,is it true?</div>
    <div class="meta">Posted on 2002-04-08 09:57:29 by Hume</div>
   </div>
   <div class="post" id="post-32792">
    <div class="subject"><a href="#post-32792">Newbies Confusion about .lib files btween VC and MASM...</a></div>
    <div class="body">No, I already converted some C code to a (static) lib to use in my asm programs.<br />Is it C or C++ ?</div>
    <div class="meta">Posted on 2002-04-08 10:07:50 by JCP</div>
   </div>
   <div class="post" id="post-32794">
    <div class="subject"><a href="#post-32794">Newbies Confusion about .lib files btween VC and MASM...</a></div>
    <div class="body">If your dll is a C++ file, put extern &quot;C&quot; { } around the export declarations, so your functions won't get C++ suffixes (testFunc@AENBEYHB) but stdcall (testFunc@8).<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-04-08 10:25:57 by Thomas</div>
   </div>
   <div class="post" id="post-32854">
    <div class="subject"><a href="#post-32854">Many thx!</a></div>
    <div class="body">I use C++,many thx to Thomas for your suggestion,It really worked!<br />Now I know the diffirence convention(name or call) diffirence betwwen Masm , C++,C.<br />Thx for your amswer!I would ask more stupid questions...hmmm....</div>
    <div class="meta">Posted on 2002-04-08 22:47:35 by Hume</div>
   </div>
  </div>
 </body>
</html>