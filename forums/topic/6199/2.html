<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>LOCAL or segments? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6199" />
  <link rel="prev" href="../?id=6199&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6199">LOCAL or segments?</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=6199&amp;page=1" style="">&laquo;</a><a href="../?id=6199&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="6199" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-45288">
    <div class="subject"><a href="#post-45288">LOCAL or segments?</a></div>
    <div class="body">ok, I think I got it now :)      <strong>finally</strong><br /><br />Here is a little test program I was messing with<br /><br />.386<br />.model flat, stdcall<br />option casemap:none<br /><br />include C:\masm32\include\windows.inc<br />include C:\masm32\include\user32.inc<br />include C:\masm32\include\masm32.inc<br />includelib C:\masm32\lib\user32.lib<br />includelib C:\masm32\lib\kernel32.lib<br /><br />includelib C:\masm32\lib\masm32.lib<br /><br />main PROTO<br /><br />.data<br /><br />.code<br />start:<br />invoke main<br />ret<br /><br />anotherProc proc<br />.data<br />externdef szText:byte<br />.code<br />invoke MessageBox, NULL, offset szText, offset szText, MB_OK<br />ret<br />anotherProc endp<br /><br /><br />main proc<br />.data<br />szText db &quot;This is a test&quot;, 0<br />.code<br />invoke MessageBox, NULL, offset szText, offset szText, MB_OK<br />invoke anotherProc<br />ret<br />main endp<br /><br /><br />end start<br /><br /><br />I couldn't access szText in 'anotherProc'  .... my bad... once I used externdef, I could. &lt;-Lesson learned, I don't want szText to be global :)<br /><br />But what do u mean that proc's don't have sections?  How can I .data and .code above?<br /><br />Thanks again for any help,<br />a slow lumbering stupid troll - gorshing</div>
    <div class="meta">Posted on 2002-06-26 13:29:20 by gorshing</div>
   </div>
   <div class="post" id="post-45290">
    <div class="subject"><a href="#post-45290">LOCAL or segments?</a></div>
    <div class="body">This is an assembler limitation, i believe. If you have coded in HLL remember the word <strong>scope</strong>? When the assembler tokenizes your code, it will tokenize from top to bottom meaning it will tokenize first &quot;anotherproc&quot; before it arrives to mainproc. So when it tokenizes szText in &quot;anotherproc&quot; it will then hash that token and checks if such hash value exists on the hash table(on the assembler), since the declaration of szText is after &quot;anotherproc&quot; it will then produce an error/undefined variable or something like this. If you put &quot;anotherproc&quot; after mainproc you have to create a prototype for &quot;anotherproc&quot; since mainproc calls anotherproc before it leaves(ret) and doesn't have scoped with &quot;anotherproc&quot;. Try this one<pre><code>.386 <br />.model flat, stdcall <br />option casemap&#58;none <br /><br />include C&#58;\masm32\include\windows.inc <br />include C&#58;\masm32\include\user32.inc <br />include C&#58;\masm32\include\masm32.inc <br />includelib C&#58;\masm32\lib\user32.lib <br />includelib C&#58;\masm32\lib\kernel32.lib <br /><br />includelib C&#58;\masm32\lib\masm32.lib <br /><br />main PROTO<br />anotherProc PROTO<br /><br />.code <br />start&#58; <br />invoke main <br />ret<br /><br />main proc <br />    .data <br />        szText db &quot;This is a test&quot;, 0 <br />    .code <br />    invoke MessageBox, NULL, offset szText, offset szText, MB_OK <br />    invoke anotherProc <br />    ret <br />main endp <br /><br />anotherProc proc <br />    invoke MessageBox, NULL, offset szText, offset szText, MB_OK <br />    ret <br />anotherProc endp end start</code></pre>When you declare something like this<pre><code><br />    .data <br />        szText db &quot;This is a test&quot;, 0 <br />    .code<br /></code></pre>szText during the assembling stage will go to the .data section. And no this is not a local variable just because you declared it inside a procedure.<br /><br />Forget about tokenizing, I was just explaining some parts on how the assembler was doing to your code and why it didn't recognize szText as global(until you declared externdef).</div>
    <div class="meta">Posted on 2002-06-26 13:55:30 by stryker</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=6199&amp;page=1" style="">&laquo;</a><a href="../?id=6199&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="6199" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>