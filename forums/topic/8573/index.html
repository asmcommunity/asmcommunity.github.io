<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Help Using MASM32 For The First Time - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8573" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=8573">Help Using MASM32 For The First Time</a></p>
   <div class="post" id="post-62970">
    <div class="subject"><a href="#post-62970">Help Using MASM32 For The First Time</a></div>
    <div class="body">Hi all,<br /><br />I am new to this forum and also to using MASM32.<br /><br />I have this program (see below) that I am trying to assemble to begin learning to use the editor, MASM32, editor, etc.<br /><br />What is happening is this:<br /><br />I OPEN the file containing the code below, click on the Qeditor Project/built All and nothing happens!!! No messages no nothing.<br /><br />Please tell me what I am doing that is wrong or better yet, tell me how to do it.<br /><br />I am running a Windows XP, the source code is at D:\ASM\masm32\XXXXXXXX.asm<br /><br />I should be getting error messages gigen that I am missing a couple of libs.<br /><br />Please help&gt;<br /><br />Best,  Firmo<br /><br />; UIPChello.asm	Displays UIPC link data in a message box<br />; Made by Andrea &quot;Kefren&quot; Brunori.     <a href="mailto:kefren@digitalrice.com">kefren@digitalrice.com</a>     <a target="_blank" href="http://oaqm.cjb.net">http://oaqm.cjb.net</a><br />; This source file is a loose translation of the equivalent C contained in the C_SDK.<br />; Use this at yuor own risk.<br />; This source is meant for MASM32. If you need the package visit these sites:<br />; <a target="_blank" href="http://win32asm.cjb.net">http://win32asm.cjb.net</a><br />; <a target="_blank" href="http://www.asmcommunity.net/board/">http://www.asmcommunity.net/board/</a><br />; <a target="_blank" href="http://www.pbq.com.au/home/hutch/masm.htm">http://www.pbq.com.au/home/hutch/masm.htm</a><br />; In order to compile, you'll need the some .lib that are supplied with MSVC and other<br />; compilers. They are required by the FSUIPC_User.lib. You will also need to adjust the<br />; paths in HelloWorld.inc to point your MASM32 Include and Lib directories.<br /><br /><br /><br />;--------- Initializing the assembler flags ----------<br />.686<br />.387<br />.k3d<br />.MODEL flat,stdcall<br />option casemap:none<br />;--------- Done ---------------------------------------<br /><br /><br />;--------- All includes are in a separate file --------<br />include HelloWorld.inc<br />;--------- Done ---------------------------------------<br /><br /><br /><br />; The FSUIPC_User.lib retrieves some data for us when we open the link with FSUIPC.dll,<br />; storing these data in three variables. In order to access these variables we need to <br />; declare them as external in our source code.<br />;--------- Declaring external functions ---------------<br />externdef  FSUIPC_Version:DWORD<br />externdef  FSUIPC_FS_Version:DWORD<br />externdef  FSUIPC_Lib_Version:DWORD<br />;--------- Done ---------------------------------------<br /><br />.Data<br />AppName db &quot;FSUIPC.dll Hello World!&quot;,0<br />SimVer db &quot;Sim is: &quot;,0<br />SimTime db &quot;Sim time is: &quot;,0<br />NextLine db 13,10,0<br />SC db &quot;:&quot;,0<br />IPCVer db &quot;   FSUIPC Version = &quot;,0<br /><br /><br />;-------- Building Error Pointers Array ----------------<br />Error0 db &quot;Okay&quot;,0<br />Error1 db &quot;Attempt to Open when already Open&quot;,0<br />Error2 db &quot;Cannot link to FSUIPC or WideClient&quot;,0<br />Error3 db &quot;Failed to Register common message with Windows&quot;,0<br />Error4 db &quot;Failed to create Atom for mapping filename&quot;,0<br />Error5 db &quot;Failed to create a file mapping object&quot;,0<br />Error6 db &quot;Failed to open a view to the file map&quot;,0<br />Error7 db &quot;Incorrect version of FSUIPC, or not FSUIPC&quot;,0<br />Error8 db &quot;Sim is not version requested&quot;,0<br />Error9 db &quot;Call cannot execute, link not Open&quot;,0<br />Error10 db &quot;Call cannot execute: no requests accumulated&quot;,0<br />Error11 db &quot;IPC timed out all retries&quot;,0<br />Error12 db &quot;IPC sendmessage failed all retries&quot;,0<br />Error13 db &quot;IPC request contains bad data&quot;,0<br />Error14 db &quot;Maybe running on WideClient, but FS not running on Server, or wrong FSUIPC&quot;,0<br />Error15 db &quot;Read or Write request cannot be added, memory for Process is full&quot;,0<br /><br />ErrorArr dd OFFSET Error0,OFFSET Error1,OFFSET Error2,OFFSET Error3,OFFSET Error4,OFFSET Error5,OFFSET Error6,OFFSET Error7,OFFSET Error8,OFFSET Error9,OFFSET Error10,OFFSET Error11,OFFSET Error12,OFFSET Error13,OFFSET Error14,OFFSET Error15<br />;-------- Done ------------------------------------------<br /><br /><br /><br /><br />;-------- Building FS Versions Strings array ------------<br />Fs98	db &quot;FS98&quot;,0<br />Fs2k	db &quot;FS2000&quot;,0<br />Cfs2	db &quot;CFS2&quot;,0<br />Cfs1	db &quot;CFS1&quot;,0<br />Fly		db &quot;Fly!&quot;,0<br />FS2k2	db &quot;FS2002&quot;,0<br />UnkFS	db &quot;Unknown FS&quot;,0<br />FsVerArr dd 0,OFFSET Fs98, OFFSET Fs2k, OFFSET Cfs2, OFFSET Cfs1, OFFSET Fly, OFFSET FS2k2, OFFSET UnkFS<br />;-------- Done -------------------------------------------<br /><br /><br /><br /><br /><br />.Data?<br />hInstance HINSTANCE ?<br />Result dd ?<br />Time db 3 dup(?)<br />Hour db 3 dup(?)<br />Minute db 3 dup(?)<br />Second db 3 dup(?)<br />FSUIPCVer db 7 dup(?)<br />chMsg db 128 dup(?)<br /><br /><br /><br />.Code<br /><br />start:<br />;---------- Normal startup stuff --------------------<br />invoke GetModuleHandle,NULL<br />mov hInstance,eax<br />;---------- Done ------------------------------------<br /><br /><br />;---------- Opening the link with FSUIPC.dll --------<br />invoke FSUIPC_Open,SIM_ANY,ADDR Result<br />cmp eax, FALSE<br />je Error<br />;---------- Done ------------------------------------<br />; OK. We are linked, and we already have retrived some data. We'll process <br />; them later. Now, as an example of retrieving data, let's get the FS clock<br />; time.<br /><br />;---------- Setting the read block ------------------<br />invoke FSUIPC_Read,0238h,3,ADDR Time,ADDR Result<br />cmp eax,FALSE<br />je Error<br />;---------- Done ------------------------------------<br />; If we wanted to read/write more data at once, we could put our additional<br />; request here.<br /><br />;---------- Processing the requests -----------------<br />invoke FSUIPC_Process,ADDR Result<br />cmp eax,FALSE<br />je Error<br />;---------- Done ------------------------------------<br />;The data needs some work before we can output it in the MessageBox.<br />;Let's go. Luckily, MASM32 has some routines that help us.<br />;---------- Converting the Time data to ASCII -------<br />xor eax,eax<br />mov al,Time[0]<br />invoke dwtoa,eax,ADDR Hour<br />xor eax,eax<br />mov al,Time[1]<br />invoke dwtoa,eax,ADDR Minute<br />xor eax,eax<br />mov al,Time[2]<br />invoke dwtoa,eax,ADDR Second<br />;---------- Done ------------------------------------<br /><br /><br />; We said we retrieved some data when we opened the link. Now, we need<br />; to process them, in order to show them in the MessageBox. This time,<br />; we're on our own, but it's not so hard.<br />;---------- Converting the FSUIPC_Version to ASCII --<br />mov eax,FSUIPC_Version<br />mov dx,ax<br />shr eax,16<br />mov ecx,eax<br />and cl,0fh<br />add cl,48<br />mov FSUIPCVer[4],cl<br />shr eax,4<br />mov ecx,eax<br />and cl,0fh<br />add cl,48<br />mov FSUIPCVer[3],cl<br />shr eax,4<br />mov ecx,eax<br />and cl,0fh<br />add cl,48<br />mov FSUIPCVer[2],cl<br />shr eax,4<br />mov ecx,eax<br />and cl,0fh<br />add cl,48<br />mov FSUIPCVer[0],cl<br /><br />mov cl,46<br />mov FSUIPCVer[1],cl<br />test dl,0<br />je Itszero<br />add dl,96<br />Itszero:<br />mov FSUIPCVer[5],dl<br /><br />mov dl,0<br />mov FSUIPCVer[7],dl<br />;----------- Done ---------------------------------<br /><br /><br />; MASM32 helps us once again.<br />;--------- All strings become one -----------------<br />mov eax,FSUIPC_FS_Version<br />cmp eax,7<br />jb @F<br />mov eax,7<br />@@:<br />invoke szMultiCat,11,ADDR chMsg,ADDR SimVer, FsVerArr, ADDR IPCVer, ADDR FSUIPCVer, ADDR NextLine, ADDR SimTime, ADDR Hour,ADDR SC, ADDR Minute, ADDR SC, ADDR Second<br />;--------- Done -----------------------------------<br /><br /><br />;--------- Let's show results and quit ------------<br />invoke MessageBox,NULL,ADDR chMsg,ADDR AppName,MB_OK<br />invoke FSUIPC_Close ; Let's close the link, OK?<br />invoke ExitProcess,NULL<br />;--------- Done -----------------------------------<br /><br /><br /><br />;--------- Error processing routine ---------------<br />Error:<br />mov edx,Result<br />invoke MessageBox,NULL,ErrorArr,ADDR AppName, MB_OK<br />invoke FSUIPC_Close ; Closing a link if already closed is OK, so no problem.<br />invoke ExitProcess,NULL<br />;--------- Done -----------------------------------<br /><br />end start</div>
    <div class="meta">Posted on 2002-10-22 13:49:25 by firmo</div>
   </div>
   <div class="post" id="post-62971">
    <div class="subject"><a href="#post-62971">Help Using MASM32 For The First Time</a></div>
    <div class="body">quote:<br /><br />D:\ASM\masm32\XXXXXXXX.asm<br /><br />I think Masm32 main directory has to be on the root directory in order for your Qeditor to work properly.<br /><br />So it would be:<br /><br />D:\masm32\XXXXXXXX.asm<br /><br />But you should have got an error saying Program not found</div>
    <div class="meta">Posted on 2002-10-22 13:55:43 by IwasTitan</div>
   </div>
   <div class="post" id="post-62981">
    <div class="subject"><a href="#post-62981">Thanks</a></div>
    <div class="body">Hi Titan,<br /><br />Thanks for the repply.<br /><br />That did it. Now all I have to do is run after the error messages.<br /><br />Best,  Firmo</div>
    <div class="meta">Posted on 2002-10-22 14:54:00 by firmo</div>
   </div>
  </div>
 </body>
</html>