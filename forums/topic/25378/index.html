<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Software emulation of floating point arithmetic - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25378" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25378">Software emulation of floating point arithmetic</a></p>
   <div class="post" id="post-185567">
    <div class="subject"><a href="#post-185567">Software emulation of floating point arithmetic</a></div>
    <div class="body">Does anybody here have a background in implementing software emulated floating point arithmetic just like what the Pascal programming language does? Unfortunately, debugging the Pascal generated code for the floating point related arithmetic is rather difficult so i thought maybe one of you could give me a head start.</div>
    <div class="meta">Posted on 2006-09-27 09:27:13 by XCHG</div>
   </div>
   <div class="post" id="post-185579">
    <div class="subject"><a href="#post-185579">Re: Software emulation of floating point arithmetic</a></div>
    <div class="body">I would guess that your reason for doing this is like climbing a mountain - because it&#39;s there!!<br /><br />There are numerous ways you could implement such an emulator.&nbsp; The easiest would probably be to use the same IEEE format as the usual 32-bit floats. If you have a sound understanding of that format and a good math background, you can then extract the sign, exponent and mantissa, perform whatever operation(s) is necessary with integer instructions and convert the result back to the proper format. You would then be limited to the range and precision of single precision floats.<br /><br />If you need more range and/or precision, you will need to develop some good algos for 64-bit math on a 32-bit processor.<br /><br />If lower range and precision is sufficient, you could go with fixed point math.<br /><br />If necessary, you can get a good description of the IEEE floating point format in the FPU tutorial from:<br />http://www.ray.masmcode.com/fpu.html<br /><br />and some ideas for fixed point math from:<br />http://www.ray.masmcode.com/fixmath.html<br /><br />Have fun.<br /><br />Raymond<br /></div>
    <div class="meta">Posted on 2006-09-27 21:02:58 by Raymond</div>
   </div>
   <div class="post" id="post-185598">
    <div class="subject"><a href="#post-185598">Re: Software emulation of floating point arithmetic</a></div>
    <div class="body">Hi raymond. First off, thanks for the tutorials, they really helped. Second, the reason i was looking to implement the emulated version of floating point arithmetic was just curiosity to see how Pascal was handling it. Another motivation for doing so is to implement a library for an 8-bit microprocessor a friend of mine is working on. He asked me if there was a way we could perform such calculation without having an FPU attached and i thought if Borland has done it, maybe there was a way i could too.<br /><br />Once again, thank you for the resources. Appreciations.</div>
    <div class="meta">Posted on 2006-09-29 04:21:35 by XCHG</div>
   </div>
   <div class="post" id="post-185605">
    <div class="subject"><a href="#post-185605">Re: Software emulation of floating point arithmetic</a></div>
    <div class="body"><div class="quote">maybe there was a way i could too</div><br />Remember the old saying: &quot;When there&#39;s a will, there&#39;s a way&quot;<br /><br />Raymond<br /></div>
    <div class="meta">Posted on 2006-09-29 10:58:46 by Raymond</div>
   </div>
   <div class="post" id="post-185632">
    <div class="subject"><a href="#post-185632">Re: Software emulation of floating point arithmetic</a></div>
    <div class="body"><br />My favourite on this line is: &quot;no job is impossible when you make someone else do it&quot;&nbsp; :D<br /></div>
    <div class="meta">Posted on 2006-10-01 04:03:43 by Maverick</div>
   </div>
   <div class="post" id="post-185641">
    <div class="subject"><a href="#post-185641">Re: Software emulation of floating point arithmetic</a></div>
    <div class="body">NTDLL.DLL contains the complete FPU instruction set emulator and can be called from an assembly language program, note that you must initialize the FPU emulator by calling eEmulatorInit first then prefixing the FPU instuctions with __e for example _eFADD would replace FADD. Never had occasion to use the functions but they are there to replace the FPU if it is one of the defective versions.<br /><br />Donkey</div>
    <div class="meta">Posted on 2006-10-01 13:06:05 by donkey</div>
   </div>
   <div class="post" id="post-185643">
    <div class="subject"><a href="#post-185643">Re: Software emulation of floating point arithmetic</a></div>
    <div class="body">Hm, not present here - XP SP2.<br /></div>
    <div class="meta">Posted on 2006-10-01 14:58:53 by f0dder</div>
   </div>
   <div class="post" id="post-185644">
    <div class="subject"><a href="#post-185644">Re: Software emulation of floating point arithmetic</a></div>
    <div class="body">Never use XP, just 2K for my dev box, the list of exported stubs is detailed here<br /><br />http://www.koders.com/c/fid34FB386E49098BFF826BBE5F4F0F868ADC20A04F.aspx<br /><br />Might take a shot at REing the functions in order to try them if I get the time and the patience to do it.</div>
    <div class="meta">Posted on 2006-10-01 17:06:39 by donkey</div>
   </div>
   <div class="post" id="post-185646">
    <div class="subject"><a href="#post-185646">Re: Software emulation of floating point arithmetic</a></div>
    <div class="body">I think NASM has floating-point emulation code, by the way - so you might want to take a look at that.<br /></div>
    <div class="meta">Posted on 2006-10-01 18:03:54 by f0dder</div>
   </div>
   <div class="post" id="post-185699">
    <div class="subject"><a href="#post-185699">Re: Software emulation of floating point arithmetic</a></div>
    <div class="body">Starting right off on an 8-bit microprocessor as the first experience on implementing such library would be a pain in the neck i guess so I&#39;m better off coding one at least for 8086. Thanks guys for all the links and information. I appreciate it.</div>
    <div class="meta">Posted on 2006-10-04 00:21:12 by XCHG</div>
   </div>
  </div>
 </body>
</html>