<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>GUI and CON - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2247" />
  <link rel="prev" href="../?id=2247&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2247">GUI and CON</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=2247&amp;page=1" style="">&laquo;</a><a href="../?id=2247&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="2247" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-160962">
    <div class="subject"><a href="#post-160962">Re: GUI and CON</a></div>
    <div class="body">Stormix,<br /><br />Could you, please, comment more your code. As I want to understand it completely and not just use it.<br /><br />For me it is a good enough solution to have one common .com file per application which I want to use from CON and GUI both.<br /><br />Kind regards,<br />Sami</div>
    <div class="meta">Posted on 2005-06-09 13:58:38 by SamiP</div>
   </div>
   <div class="post" id="post-160986">
    <div class="subject"><a href="#post-160986">Re: GUI and CON</a></div>
    <div class="body">Hi SamiP,<br /><br />While commenting and further testing the method I posted earlier, I found it has a number of problems:<br /><br /><ul><br /><li>The loader has to be at an unusual base address so as not to clash with the GUI app</li><br /><li>If they do clash, LoadLibrary doesn&#39;t seem to care and relocates them, even if the GUI app has no relocs. Even if there are relocs I don&#39;t think it applies them (not sure). When I applied the relocs myself there were still problems anyway...</li><br /><li>It seems strange to have to build the IAT.. I can&#39;t find documentation saying it would be necessary, so why is it?</li><br /><li>The GUI app would not be the one that started the process, so it will not get values it expects from, say GetModuleHandle(NULL). This can be solved by placing pointers to our own functions when building the IAT but still it doesn&#39;t seem very neat...</li><br /></ul><br /><br />So I tried another idea- to copy the GUI app, patch it so that its subsystem is WINDOWS and the run it. This works much more nicely, with no need to build IATs or worry about relocations or hooking functions. It is probably also easier to understand.<br /><br />Attached is the (commented :)) source of this new method and example executables.<br /><br />EDIT: added assembler version of the above. conloader2.zip is the C++ version, conloader2_asm.zip the asm version. Example executables are only in the C++ one, though, which is also better commented.<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=679" target="_blank">conloader2.zip</a></li>
      <li><a href="../../attachments/?id=682" target="_blank">conloader2_asm.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-06-10 09:31:32 by stormix</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=2247&amp;page=1" style="">&laquo;</a><a href="../?id=2247&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="2247" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>