<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>versioninfo trouble in Win2K - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2889" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2889">versioninfo trouble in Win2K</a></p>
   <div class="post" id="post-18674">
    <div class="subject"><a href="#post-18674">versioninfo trouble in Win2K</a></div>
    <div class="body">I have been using for ages this construct in my versioninfo:<br /><br />FILEVERSION     0, 2, 1, 121201<br /><br />which means Version 2.1.121201<br />(version 2, subversion 1, build 12.12.01)<br /><br />Look fine under Win9x, but since Win2K windows calculates some other, wired numbers out of my versioninfo.<br />It seems to be something like a hex-to-dec or Lowword+Highword calculation ...<br /><br />Whats wrong with my notation?</div>
    <div class="meta">Posted on 2002-01-11 09:14:11 by beaster</div>
   </div>
   <div class="post" id="post-18692">
    <div class="subject"><a href="#post-18692">versioninfo trouble in Win2K</a></div>
    <div class="body">i have seen in the past that alot of people have had probelms getting the version info from win2k. i noticed an api call GetVersionEx along with the OSVERSIONINFO struct it uses. maybe this call was designed more for win2k that what you are using. just a thought.</div>
    <div class="meta">Posted on 2002-01-11 11:10:49 by smurf</div>
   </div>
   <div class="post" id="post-18699">
    <div class="subject"><a href="#post-18699">versioninfo trouble in Win2K</a></div>
    <div class="body">thanks, but I forgot to mention, that I dont want to read the version, I just look at it on the desktop showing &quot;properties&quot;.<br /><br />Attached the win95 (top) and win2k (bottom) display (german windows) where you can see the two different version outputs.</div>
    <div class="meta">Posted on 2002-01-11 12:13:58 by beaster</div>
   </div>
   <div class="post" id="post-18712">
    <div class="subject"><a href="#post-18712">versioninfo trouble in Win2K</a></div>
    <div class="body">When defining versioninfo, ALWAYS define all four parts - you do<br />this, which is good. Otherwise very very weird errors pop up. Next<br />thing, the versioninfo is four 16bit words, not 32bit dwords.<br />121201 definitely can't fit in a 16bit variable :).</div>
    <div class="meta">Posted on 2002-01-11 13:40:47 by f0dder</div>
   </div>
   <div class="post" id="post-18713">
    <div class="subject"><a href="#post-18713">versioninfo trouble in Win2K</a></div>
    <div class="body">Here's what PlatformSDK has to say:<br /><br /><div class="quote"><br />FILEVERSION version<br /><br />Specifies the binary version number for the file. The version consists of two 32-bit integers, defined by four 16-bit integers. For example, &quot;FILEVERSION 3,10,0,61&quot; is translated into two doublewords: 0x0003000a and 0x0000003d, in that order. Therefore, if version is defined by the DWORD values dw1 and dw2, they need to appear in the FILEVERSION statement as follows: HIWORD(dw1), LOWORD(dw1), HIWORD(dw2), LOWORD(dw2).<br /></div></div>
    <div class="meta">Posted on 2002-01-11 13:42:17 by f0dder</div>
   </div>
   <div class="post" id="post-19036">
    <div class="subject"><a href="#post-19036">versioninfo trouble in Win2K</a></div>
    <div class="body">thanx, thats it!<br /><br />now I can squeeze my brain, how to get the date into a 16 bit value ...</div>
    <div class="meta">Posted on 2002-01-14 03:57:15 by beaster</div>
   </div>
   <div class="post" id="post-19038">
    <div class="subject"><a href="#post-19038">versioninfo trouble in Win2K</a></div>
    <div class="body">Better to use the fileversion as, well, fileversion, and not some hybrid<br />fileversion/date :). You can have current time/date inserted into<br />your executables at assemble-time, I think masm has a CurDate<br />macro or something similar.</div>
    <div class="meta">Posted on 2002-01-14 04:06:38 by f0dder</div>
   </div>
  </div>
 </body>
</html>