<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>EM_GETRECT &amp; RichEdit - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6325" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6325">EM_GETRECT &amp; RichEdit</a></p>
   <div class="post" id="post-45423">
    <div class="subject"><a href="#post-45423">EM_GETRECT &amp; RichEdit</a></div>
    <div class="body">Bah!  I always run across the hard stuff when I think what I am trying to do is going to be easy.  Go figure.<br /><br />I have been playing with the notion of function markers (think along the lines of Visual Basic).  A horizontal line in between the lines of text to denote a new function.<br /><br />When a starting function is detected, I read upwards to find a blank line all by itself, the end of the previous function, or the beginning of the file whichever comes first.<br /><br />If a blank line all by itself is detected, I use some code to lock it from update, and draw a line right in the center horizontally across the screen and this is where the problem is...<br /><br />According to M$:<br /><div class="quote"><br />The formatting rectangle does not include the selection bar, which is an unmarked area to the left of each paragraph. When clicked, the selection bar selects the line.<br /></div><br /><br />And I was using EM_GETRECT to determine the valid rectangle into which I could draw the line... so if I toggle on the selection bar, my line code will &quot;spill over&quot; into the selection area.<br /><br />I have looked around my RichEdit references, but I do not see any way (yet) to find the extent of the selection bar... any ideas?<br /><br />:rolleyes:</div>
    <div class="meta">Posted on 2002-06-27 10:57:22 by Graebel</div>
   </div>
   <div class="post" id="post-45602">
    <div class="subject"><a href="#post-45602">EM_GETRECT &amp; RichEdit</a></div>
    <div class="body">* crickets * <br /><br />ROFL :grin:<br /><br />Oh well heheh, maybe my question was harder than it looked and there is not an answer.<br /><br />On a related note, if anyone out there has a copy of RichEdit20.dll with Version2 I would appriciate it if you could email it to me.  Seems I need it for testing purposes as both of my machines seem to be running Version3.<br /><br />If you have trouble determining the RichEdit version, put a debug statement in Iczelions tutorial on RichEdit highlighting in the main window proc just after it is created.<br /><br />If you can send it to me, please also post here about it so I dont get spammed with them :alright:<br /><br />Graebel<br />@<br />hotmail :cool: com</div>
    <div class="meta">Posted on 2002-06-28 11:31:18 by Graebel</div>
   </div>
  </div>
 </body>
</html>