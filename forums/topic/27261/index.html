<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>TerminateProcess - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27261" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27261">TerminateProcess</a></p>
   <div class="post" id="post-195341">
    <div class="subject"><a href="#post-195341">TerminateProcess</a></div>
    <div class="body">Where I am mistaken?

.data
procname   db 'C:\WINDOWS\process.exe', 0

.code
start:
        invoke	GetModuleHandle, ADDR procname
	invoke	OpenProcess, PROCESS_TERMINATE, 0, eax
	invoke	TerminateProcess, eax, 0
	invoke	ExitProcess, 0
end start</div>
    <div class="meta">Posted on 2001-03-16 13:38:00 by koba</div>
   </div>
   <div class="post" id="post-195342">
    <div class="subject"><a href="#post-195342">TerminateProcess</a></div>
    <div class="body">The GetModuleHandle API returns the module handle for the specified module <strong>if the file has been mapped into the address space of the calling process</strong>. So you can do GetModuleHandle on let's say kernel32.dll if your program uses kernel32 (it probably does) because it's a part of your program's memory space. But you can't get a module handle of each process running. Also, OpenProcess wants a process identifier, not a module handle. If your intention was to terminate a process running in windows, try to search for the ToolHelp api, this api can enumerate all processes and give the process id's for them (sorry, I don't have a link for you). 

Thomas</div>
    <div class="meta">Posted on 2001-03-16 17:29:00 by Thomas</div>
   </div>
   <div class="post" id="post-195343">
    <div class="subject"><a href="#post-195343">TerminateProcess</a></div>
    <div class="body">Thank for your answer</div>
    <div class="meta">Posted on 2001-03-18 09:01:00 by Koba</div>
   </div>
  </div>
 </body>
</html>