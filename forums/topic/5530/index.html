<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>macro or... code? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5530" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=5530">macro or... code?</a></p>
   <div class="post" id="post-39334">
    <div class="subject"><a href="#post-39334">macro or... code?</a></div>
    <div class="body">Is a macro assembled into exe only ONCE or as many times as I call it???</div>
    <div class="meta">Posted on 2002-05-22 06:15:43 by Jayrome</div>
   </div>
   <div class="post" id="post-39338">
    <div class="subject"><a href="#post-39338">macro or... code?</a></div>
    <div class="body">Each time a macro is called the assembler executes<br />the code in the macro - it is advanced cut-n-paste.</div>
    <div class="meta">Posted on 2002-05-22 06:54:05 by bitRAKE</div>
   </div>
   <div class="post" id="post-39445">
    <div class="subject"><a href="#post-39445">macro or... code?</a></div>
    <div class="body">The way I think of macros is that they are in effect programs that run at compile time. That's really what they are, and you can make them very complicated and convoluted, with loops, decision blocks, and just about anything you can imagine.<br /><br />A macro might just be a simple text substitution, or it may do some calculation based on some custom parameter you want to check, like if this is a debug version or release version, and do something different in each case.<br /><br />The compiler scans your source code numerous times, top to bottom. I can make a good argument it does this at least THREE times. <br /><br />The first pass is to &quot;expand&quot; the macros. If a macro contains coded or data, each time the macro is referenced it expands into the code or data. Note the phrase &quot;when referenced.&quot; It means just having a macro in your code adds zero to the program.  You have to use the macro somewhere to have it take effect.<br /><br />Once the macros are expanded, the compilers next pass does the translation from assembly steps into op codes. The final pass is used to compute offsets, or the address of data items, jumps, and whatever else is used.</div>
    <div class="meta">Posted on 2002-05-22 23:24:43 by Ernie</div>
   </div>
   <div class="post" id="post-39461">
    <div class="subject"><a href="#post-39461">macro or... code?</a></div>
    <div class="body">So it's really economy only at design time?</div>
    <div class="meta">Posted on 2002-05-23 02:59:38 by Jayrome</div>
   </div>
   <div class="post" id="post-39464">
    <div class="subject"><a href="#post-39464">macro or... code?</a></div>
    <div class="body">Personally I think that MACRO's are redundant - and I am a lover of MASM - so shoot me !!<br /><br />My argument is as follows:<br /><br />If you need to call a particular chunk of code many times, then it should be defined as a procedure - that's what the ret instruction was created for !!<br />If your don't need to call it more than once, then it can be clearcoded - and if the only reason one can give for using a macro at all is that it makes for neat and readable sourcecode, then I reply that we can clearcode the function, then whack a copy into an includefile, and replace the original with an include statement.<br /><br />Tell me what I am missing, the only macro I ever use is szText, and that I only use during development, through sheer laziness.<br /><br />Don't think that I am a totally diehard lowlevel coder (though that may be true enough) because I do appreciate other highlevel constructs such as STRUCTS and the HLL directives (looping and such) which actually compile very nicely.<br /><br />I am against dirty binary through laziness - I am not against laziness in general ok? :tongue:</div>
    <div class="meta">Posted on 2002-05-23 03:17:32 by Homer</div>
   </div>
   <div class="post" id="post-39473">
    <div class="subject"><a href="#post-39473">macro or... code?</a></div>
    <div class="body">Manage our OOP system by hand, and see how redundant macro's are ;)  (If your not familiar, its entirely, 876 lines of MACRO code).<br /><br />But i totaly agree, it *can* be done by hand, but will be extremely error-proned, and time consuming.  As well your code will look quite convolutied with 'typedef' etc. for masm to realize your intentions.  Alot of the macro's rely on state information from other macros somewhere else in the file.  This mean you'd have to continously update and monitor these states while coding.  <br /><br />However, All this is hidden and properly taken care for, by well placed macro's...  <br /><br />Hmm.. But then again you *can* counter with a &quot;why not use a function to do all the setups, if its soo complicated&quot;.  You can do this, and it works, but then you would have a needless amount of bloat in your final exe, to do at RUN-TIME, what some well designed macro's can do at COMPILE-TIME (and save the overhead).<br /><br />IMO, they are far from redundant. ;)<br /><br />NaN</div>
    <div class="meta">Posted on 2002-05-23 04:03:43 by NaN</div>
   </div>
   <div class="post" id="post-39496">
    <div class="subject"><a href="#post-39496">macro or... code?</a></div>
    <div class="body">The capacity to &quot;pre-process&quot; text before assembly is a very powerful capacity to have that many compilers do not have. It allows you to change the structure of you code in many convenient ways.<br /><br />NaN has a good point here, why waste executable code when you can pre-process it in macros and only have the code with the result.<br /><br />The choice between a macro and a proc depends what you want to acheive, a macro can inline a set of instructions so that you avoid the stack overhead iof it is speed critical where a procedure only has to be written once but can be called many times.<br /><br />Of course you can combine procs and macros to do even more interesting things. As long as you understand what they are doing, they are a useful part of the assembler language programmers arsenal of tools.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-05-23 07:41:20 by hutch--</div>
   </div>
  </div>
 </body>
</html>