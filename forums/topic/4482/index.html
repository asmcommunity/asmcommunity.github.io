<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Insertion Sort(Sort-Of) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4482" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=4482">Insertion Sort(Sort-Of)</a></p>
   <div class="post" id="post-31270">
    <div class="subject"><a href="#post-31270">Insertion Sort(Sort-Of)</a></div>
    <div class="body">Here's a snippet to help anyone who wants to do a sorted linked list:<pre><code>&#91;size=9&#93;<br />InsertionSort PROC USES ebx esi edi headPtr&#58;DWORD<br /><br />    mov     esi, headPtr<br />    mov     edi, &#40;CarInfo PTR &#91;esi&#93;&#41;.ptNext<br />    mov     &#40;CarInfo PTR &#91;esi&#93;&#41;.ptNext, NULL<br /><br />    @@SearchAndInsert&#58;<br /><br />        mov     edx, esi<br />        mov     eax, &#40;CarInfo PTR &#91;edi&#93;&#41;.cID<br />        mov     ebx, &#40;CarInfo PTR &#91;edi&#93;&#41;.ptNext<br /><br />    @@SearchInner&#58;<br /><br />        cmp     &#40;CarInfo PTR &#91;edx&#93;&#41;.cID, eax<br />        jbe      @@SkipInsert<br />        cmp     edx, esi<br />        jne     @@MiddleInsertion<br />        mov     &#40;CarInfo PTR &#91;edx&#93;&#41;.ptPrev, edi<br />        mov     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptPrev, NULL<br />        mov     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptNext, edx<br />        mov     esi, edi<br />        jmp     @@ScanForward<br /><br />    @@MiddleInsertion&#58;<br /><br />        push    edi<br />        push    edi<br />        mov     ecx, &#40;CarInfo PTR &#91;edx&#93;&#41;.ptPrev<br />        push    ecx<br />        push    ecx<br />        push    edx<br />        pop     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptNext<br />        pop     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptPrev<br />        pop     ecx<br />        pop     &#40;CarInfo PTR &#91;ecx&#93;&#41;.ptNext<br />        pop     &#40;CarInfo PTR &#91;edx&#93;&#41;.ptPrev<br />        jmp     @@ScanForward<br /><br />    @@SkipInsert&#58;<br /><br />        mov     ecx, edx<br />        mov     edx, &#40;CarInfo PTR &#91;edx&#93;&#41;.ptNext<br />        or      edx, edx<br />        jnz     @@SearchInner<br />        mov     &#40;CarInfo PTR &#91;ecx&#93;&#41;.ptNext, edi<br />        mov     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptNext, NULL<br />        mov     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptPrev, ecx<br /><br />    @@ScanForward&#58;<br /><br />        mov     edi, ebx<br />        or      edi, edi<br />        jnz     @@SearchAndInsert<br />        mov     eax, esi<br /><br />    ret<br /><br />InsertionSort ENDP&#91;/size&#93;</code></pre>I don't know if this is an insertion sort but it sort-of work like insertion sort. The only difference is that it will not just insert itself automatically like the other insertion sort methods shown mostly out there on the net but it will find a suitable spot where it will insert and swap memory pointers.<br /><br /><strong>Requirements:</strong> A doubly linked list<br /><strong>Parameter:</strong> The head pointer of the current linked list<br /><strong>Return Value:</strong> In EAX, the new head pointer<br /><strong>Notes:</strong> Replace the following with your own:<br />CarInfo == with the name of your structure<br />cID == replace this with the structure field you want to compare.<br />ptNext == the name of your next pointer in the structure field<br />ptPrev == the name of your previous pointer in the structure field<br /><br />It's the programmer's responsibility to ensure a perfect doubly linked list. I mean the doubly linked list should have no problems with its prev and next pointers. To test a perfect doubly linked list try printing it starting at the head node going to the tail and vice versa.<br /><br />This sorts in ascending order.<br /><br /><strong>Optimizations: A LOT!!!</strong> but I'll leave this up to you guys, since I have more projects to finish. :grin: My spring break sucks!!! :grin:<br /><br />Its best running time is O(n) - Ha! Beat That. Especially if the data is sorted in descending order(9 8 7 6...). Its worst is I don't know but this one will perform poorly if the data is already sorted in ascending order(1 2 3 4 5 ....).</div>
    <div class="meta">Posted on 2002-03-28 00:57:55 by stryker</div>
   </div>
   <div class="post" id="post-32233">
    <div class="subject"><a href="#post-32233">Sort for doubly circular linked list</a></div>
    <div class="body">I updated it quite a bit to support <strong>doubly circular linked list</strong>.<pre><code>&#91;size=9&#93;<br />InsertionSort PROC USES ebx esi edi headPtr&#58;DWORD<br /><br />    LOCAL   tailPtr     &#58;DWORD<br /><br />    mov     esi, headPtr<br />    mov     tailPtr, esi<br /><br />    mov     edi, &#40;CarInfo PTR &#91;esi&#93;&#41;.ptNext<br />    mov     &#40;CarInfo PTR &#91;esi&#93;&#41;.ptNext, NULL<br /><br />    @@SearchAndInsert&#58;<br /><br />        mov     edx, esi<br />        mov     eax, &#40;CarInfo PTR &#91;edi&#93;&#41;.cID<br />        mov     ebx, &#40;CarInfo PTR &#91;edi&#93;&#41;.ptNext<br /><br />    @@SearchInner&#58;<br /><br />        cmp     &#40;CarInfo PTR &#91;edx&#93;&#41;.cID, eax<br />        jbe      @@SkipInsert<br /><br />        cmp     edx, esi<br />        jne     @@MiddleInsertion<br /><br />        mov     &#40;CarInfo PTR &#91;edx&#93;&#41;.ptPrev, edi<br />        mov     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptPrev, NULL<br />        mov     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptNext, edx<br />        mov     esi, edi<br />        jmp     @@ScanForward<br /><br />    @@MiddleInsertion&#58;<br /><br />        push    edi<br />        push    edi<br />        mov     ecx, &#40;CarInfo PTR &#91;edx&#93;&#41;.ptPrev<br />        push    ecx<br />        push    ecx<br />        push    edx<br />        pop     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptNext<br />        pop     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptPrev<br />        pop     ecx<br />        pop     &#40;CarInfo PTR &#91;ecx&#93;&#41;.ptNext<br />        pop     &#40;CarInfo PTR &#91;edx&#93;&#41;.ptPrev<br /><br />        jmp     @@ScanForward<br /><br />    @@SkipInsert&#58;<br /><br />        mov     ecx, edx<br />        mov     edx, &#40;CarInfo PTR &#91;edx&#93;&#41;.ptNext<br />        or      edx, edx<br />        jnz     @@SearchInner<br /><br />        mov     &#40;CarInfo PTR &#91;ecx&#93;&#41;.ptNext, edi<br />        mov     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptNext, NULL<br />        mov     &#40;CarInfo PTR &#91;edi&#93;&#41;.ptPrev, ecx<br />        mov     tailPtr, edi<br /><br />    @@ScanForward&#58;<br /><br />        mov     edi, ebx<br />        cmp     edi, headPtr<br />        jne     @@SearchAndInsert<br />        <br />        mov     eax, tailPtr<br />        mov     &#40;CarInfo PTR &#91;eax&#93;&#41;.ptNext, esi<br />        mov     &#40;CarInfo PTR &#91;esi&#93;&#41;.ptPrev, eax<br />        <br />        mov     eax, esi<br /><br />    ret<br /><br />InsertionSort ENDP&#91;size=9&#93;&#91;/size&#93;</code></pre>This sorts the DCLL in ascending order. And don't forget that you must ensure <strong>it must be a perfect doubly circular linked list</strong> before you use this.<br /><br />To test your DCLL, try printing from head to tail twice in continous flow and do the same thing from tail to head. The output should be the reverse of the other.<br /><br />This snippet was tested on 3 cases of a doubly circular linked list: <br /><br />1. Already sorted in ascending<br />2. Already sorted in descending<br />3. Unsorted<br /><br />Everything came out perfectly as it should be. It's best and worst cases are the same as the one above.<br /><br />An app will be released soon, together with the complete binary trees examples.<br /><br />Have Fun!!! :grin:</div>
    <div class="meta">Posted on 2002-04-02 23:40:49 by stryker</div>
   </div>
  </div>
 </body>
</html>