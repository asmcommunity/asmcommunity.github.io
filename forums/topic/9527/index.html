<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>resources in dll - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9527" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9527">resources in dll</a></p>
   <div class="post" id="post-70532">
    <div class="subject"><a href="#post-70532">resources in dll</a></div>
    <div class="body">Hi everybody,<br /><br />I have a program which I'm for faster debugging building as an exe. But I wanna have him in dll, whats not such a problem but when I'm starting it from dll no resources are there. It is MDI application with toolbar when I start it from dll, images on toolbar are not shown and also menu is not working. I'm not even talking about MDI widows ;) . Probably hInstance is not properly pointing to dll module or what, funny is that menu and icons are also in resources but the are shown, just bitmaps in toolbar arent, + no functionality with mdi. Can anybody instruct me what could be wrong?<br /><br />Thanks for everything<br /><br />frankie</div>
    <div class="meta">Posted on 2002-12-12 02:09:59 by frankie</div>
   </div>
   <div class="post" id="post-70533">
    <div class="subject"><a href="#post-70533">resources in dll</a></div>
    <div class="body">If the resource is in the dll, you must use a proc in the dll to load the resource.</div>
    <div class="meta">Posted on 2002-12-12 02:19:34 by roticv</div>
   </div>
   <div class="post" id="post-70542">
    <div class="subject"><a href="#post-70542">which proc?</a></div>
    <div class="body">I'm loading it in WinMain which is called from exported function in dll. Like this:<br /><br />      invoke LoadIcon,hInst,500    ; icon ID<br />      mov hIcon, eax<br /><br />And rest is in WndProc which seems to not have any more proper hInstance <br /><br />    invoke LoadBitmap,hInstance,903<br />    mov hTbBmp,eax<br /><br />well I will try to send hInstance to WndProc as a parameter what will happen then.<br /><br />thanks anyway</div>
    <div class="meta">Posted on 2002-12-12 03:50:23 by frankie</div>
   </div>
   <div class="post" id="post-70557">
    <div class="subject"><a href="#post-70557">resources in dll</a></div>
    <div class="body">Use a debugger and test the value of hinstance. If it is 40000h, you are getting the wrong hinstance.</div>
    <div class="meta">Posted on 2002-12-12 04:51:33 by roticv</div>
   </div>
   <div class="post" id="post-70559">
    <div class="subject"><a href="#post-70559">well I solved the problem</a></div>
    <div class="body">sorry guys it was just my own stupidity, resource file which I'm using for creating of dll have another name like that for exe so of course the dll was compiled with old rc file thats why resources werent there :stupid:  Thanks for trying to help me.</div>
    <div class="meta">Posted on 2002-12-12 04:58:25 by frankie</div>
   </div>
  </div>
 </body>
</html>