<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Loading menu from DLL problems - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25703" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25703">Loading menu from DLL problems</a></p>
   <div class="post" id="post-187532">
    <div class="subject"><a href="#post-187532">Loading menu from DLL problems</a></div>
    <div class="body">I have a program that loads a DLL using LoadLibrary, then uses GetProcAddress to retrieve a ptr to a function that is supposed to add the DLL menu to the programs menu bar. The program window handle is passed to the DLL function so it can retrieve the menu handle. The DLL menu is defined in a RC file, compiled with the DLL, and loaded using LoadMenu. The menu is being loaded correctly because I can use SetMenu to replace the program menu with the DLL menu, but I want the DLL menu to be added to the program menu bar so I can access the DLL functions from the program.<br /><br /><pre><code><br />#include &lt;resource.h&gt;<br /><br />#define MESH_ID 1024<br />#define MESH_ADD 1025<br />#define MESH_REMOVE 1026<br /><br />MESH_ID MENU DISCARDABLE<br />BEGIN<br />&nbsp; POPUP &quot;Mesh&quot;<br />&nbsp; BEGIN<br />&nbsp; &nbsp; MENUITEM &quot;Add&quot;, MESH_ADD<br />&nbsp; &nbsp; MENUITEM &quot;Remove&quot;, MESH_REMOVE<br />&nbsp; END<br />END<br /></code></pre><br /><br />How do I add the DLL menu to the program menu? AppendMenu or InsertMenuItem?<br />Do I need to create a popup menu first? or will it automatically be created since it&#39;s a resource?<br />My attempts so far only lead to a seperator bar being drawn :mad:</div>
    <div class="meta">Posted on 2007-01-15 00:48:16 by Maelstrom</div>
   </div>
   <div class="post" id="post-187539">
    <div class="subject"><a href="#post-187539">Re: Loading menu from DLL problems</a></div>
    <div class="body">AppendMenu - Appends a menu item to THE END OF a given menu.<br />InsertMenu - Inserts a menu item at GIVEN POSITION in given menu.<br /></div>
    <div class="meta">Posted on 2007-01-15 04:03:20 by Homer</div>
   </div>
   <div class="post" id="post-187546">
    <div class="subject"><a href="#post-187546">Re: Loading menu from DLL problems</a></div>
    <div class="body">hSubMeshMenu=GetSubMenu(hDllMeshMenu)<br />invoke InsertMenu,hMainWindowMenu,0,MF_STRING or MF_BYPOSITION or MF_POPUP,hSubMeshMenu,T(&#39;SubMesh&#39;)<br /><br />with GetSubMenu you get the dropdown mnu.</div>
    <div class="meta">Posted on 2007-01-15 16:32:24 by drizz</div>
   </div>
   <div class="post" id="post-187547">
    <div class="subject"><a href="#post-187547">Re: Loading menu from DLL problems</a></div>
    <div class="body">Thanks drizz :thumbsup:<br />I haven&#39;t played with menus for quite some time and forgot what I was doing :oops:<br /></div>
    <div class="meta">Posted on 2007-01-15 16:51:32 by Maelstrom</div>
   </div>
  </div>
 </body>
</html>