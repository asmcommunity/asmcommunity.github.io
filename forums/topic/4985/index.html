<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Unmatched Macro Nesting - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4985" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4985">Unmatched Macro Nesting</a></p>
   <div class="post" id="post-35057">
    <div class="subject"><a href="#post-35057">Unmatched Macro Nesting</a></div>
    <div class="body">I've done everything I know, and even asked a crap load of people, but I can't seem to get rid of this error.  can any one tell me why it's appearing?<br /><br /><pre><code><br />.model small<br />.stack 100h<br /><br />.data<br />   numberPrompt db &quot;Enter a number between 0 and 999&#58; &quot;, 0<br />   sumRow1Msg db &quot;The sum of row 1 is&#58; &quot;, 0<br />   sumCol2Msg db &quot;The sum of column 2 is&#58; &quot;, 0<br />   numGtr100Msg db &quot;The number of values &gt; 100 is&#58; &quot;, 0<br />   notInRangePrompt db &quot;The value in not in the range&#58; &quot;, 0<br />   matrix dw 16 dup &#40;?&#41;<br />   count = 16<br /><br />.code<br />extrn Writestring&#58;proc, Readint&#58;proc, Writeint&#58;proc, Crlf&#58;proc<br /><br />main proc<br />   mov ax, @data<br />   mov ds, ax<br /><br />   call GetNums<br />   call DisplayMatrix<br />   call sumRow1<br />   call sumCol2<br />   call Greater100<br />   call Swap1W2<br /><br />   mov ax,4c00h<br />   int 21h<br /><br />main endp<br /><br />GetNums proc<br />   push cx<br />   mov ax,@data<br />   mov es,ax<br />   mov di, offset matrix<br />   mov cx, count<br /><br />   GetData&#58;<br />      mov dx, offset numberPrompt<br />      call Writestring<br />      call Readint<br /><br />;if &#40;ax &gt; 999&#41; or &#40;ax &lt; 0&#41; then jump to NOTINRANGE else jump to INRANGE<br /><br />      cmp ax, 999<br />      jg NOTINRANGE<br />      cmp ax, 0<br />      jl NOTINRANGE<br />      jmp INRANGE<br /><br />      NOTINRANGE&#58;<br />         mov dx, offset notInRangePrompt<br />         dec cx<br />         loop GetData<br /><br />      INRANGE&#58;<br />         call Crlf<br />         stosw          ; stosw = es&#58;&#91;di&#93;=ax; di+=2<br />         loop GetData<br /><br />   pop cx<br />   ret<br />GetNums endp<br /><br /><br />DisplayMatrix proc<br />   mov si, offset matrix<br />   mov cx, count<br />   Display&#58;<br />      lodsw        ;&#40;equivalent to mov ax,ds&#58;&#91;si&#93;; add si,2&#41;<br />      mov bx,10<br />      push cx     ; &#40;make sure WriteInt does not modify it&#41;<br />      call WriteInt<br />      pop cx<br />      dec cx       ;&#40;decrease cx by one, and check if lowest 2 bits are zero,<br />                  ;which means 4*k items have been printed, where k is integer&#41;<br />       test cx,3<br />       jnz short NotEndOfLine<br />       push cx<br />       call Crlf<br />       pop cx<br />   NotEndOfLine&#58;<br />       or cx,cx   ;&#40;if cx is not zero jump back to Display&#41;<br />       jnz Display<br />   ret<br />DisplayMatrix endp<br /><br />;get sum row 1<br />sumRow1 proc<br />   mov si, offset matrix<br />   mov bx, &#91;si&#93;<br />   mov cx, 3<br />   Sum1&#58;<br />      add si, 2<br />      add bx, &#91;si&#93;<br />      loop Sum1<br /><br />   mov  dx,offset sumRow1Msg<br />   push bx<br />   call Writestring<br />   pop bx<br /><br />   mov  ax,bx       ; get the sum&#40;in BX&#41;<br />   mov  bx,10<br />   call Writeint   ; display it<br />   call Crlf<br />   ret<br />sumRow1 endp<br /><br />;get sum col 2<br />sumCol2 proc<br />   mov si, offset matrix+2<br />   mov bx, &#91;si&#93;<br />   mov cx, 3<br />   Sum2&#58;<br />      add si, 8<br />      add bx, &#91;si&#93;<br />      loop Sum2<br /><br />   mov  dx, offset sumCol2Msg<br />   push bx<br />   call Writestring<br />   pop bx<br />   mov  ax,bx       ; get the sum&#40;in BX&#41;<br />   mov  bx,10<br />   call Writeint   ; display it<br />   call Crlf<br />   ret<br />sumCol2 endp<br /><br />; count display number vals &gt; 100<br />;while &#40;cx &lt; count&#41;<br />;&#123;<br />; if &#40;&#91;si&#93; &lt; 100&#41;<br />;      count = count + 1<br />; cx++<br />; si = si +2<br />;&#125;<br />Greater100 proc<br />   mov si, offset matrix<br />   xor bx, bx               ; set bx to zero<br /><br />   mov cx, 1<br />   While&#58;<br />      cmp cx, count<br />       jg Enddo<br />      cmp &#91;si&#93;, 100<br />       jl L2<br />      inc bx<br />   L2&#58;<br />      inc cx<br />      add si, 2<br />      jmp While<br />   Enddo&#58;<br />      mov  dx, offset numGtr100Msg<br />      push bx<br />      call Writestring<br />      pop bx<br />      mov  ax,bx       ; get the sum&#40;in BX&#41;<br />      mov  bx,10<br />      call Writeint   ; display it<br />      call Crlf<br />   ret<br />Greater100 endp<br /><br />;swap rows 1 and 2<br />Swap1W2 proc<br />   mov si, offset matrix<br />   mov di, offset matrix+8<br />   mov cx, 4<br />   rowSwap&#58;<br />      mov bx, &#91;si&#93;<br />      xchg bx, &#91;di&#93;<br />      mov &#91;si&#93;, bx<br />      add si, 2<br />      add di, 2<br />      loop rowSwap<br />   call DisplayMatrix<br />   ret<br />Swap1W2 endp<br /><br />end main<br /></code></pre></div>
    <div class="meta">Posted on 2002-04-25 12:43:35 by Zombiefreak</div>
   </div>
   <div class="post" id="post-35059">
    <div class="subject"><a href="#post-35059">Unmatched Macro Nesting</a></div>
    <div class="body"><strong>main</strong> shouldn't be a PROC.  Just do:<pre><code>main&#58;</code></pre>You don't need any of those PROC/ENDP stuff - just create labels.<br /><br />This line doesn't look correct?<pre><code>extrn Writestring&#58;proc, Readint&#58;proc, Writeint&#58;proc, Crlf&#58;proc</code></pre>Try:<pre><code>extrn Writestring&#58;near, Readint&#58;near, Writeint&#58;near, Crlf&#58;near</code></pre>Haven't tried the code attached, but it might work?</div>
    <div class="meta">Posted on 2002-04-25 13:10:28 by bitRAKE</div>
   </div>
   <div class="post" id="post-35060">
    <div class="subject"><a href="#post-35060">Unmatched Macro Nesting</a></div>
    <div class="body">Shouldn't really matter if main is a proc - but I'd just use a raw label.</div>
    <div class="meta">Posted on 2002-04-25 13:16:09 by f0dder</div>
   </div>
  </div>
 </body>
</html>