<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Get a window's icon by hWnd - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24481" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24481">Get a window's icon by hWnd</a></p>
   <div class="post" id="post-178746">
    <div class="subject"><a href="#post-178746">Get a window's icon by hWnd</a></div>
    <div class="body">Is there any way i can get a window&#39;s icon just by it&#39;s hWnd.<br />i used to execute GetWindowModuleFileName() in windows 98 for doing such thing, but it doesnt seem to be working in XP. can anybody help me ?</div>
    <div class="meta">Posted on 2006-03-30 03:26:20 by XCHG</div>
   </div>
   <div class="post" id="post-178747">
    <div class="subject"><a href="#post-178747">Re: Get a window's icon by hWnd</a></div>
    <div class="body">invoke GetClassLong, hWnd, GCL_HICON<br />and<br />invoke GetClassLong, hWnd, GCL_HICONSM<br /><br />Regards,<br />Bryant Keller</div>
    <div class="meta">Posted on 2006-03-30 05:20:19 by Synfire</div>
   </div>
   <div class="post" id="post-178752">
    <div class="subject"><a href="#post-178752">Re: Get a window's icon by hWnd</a></div>
    <div class="body">WM_GETICON will also work, as opposed to getting the class icon in cases where you want whatever icon has been assigned to a particular window using WM_SETICON. The other option is to use ExtractIcon and extract it directly from the application image.</div>
    <div class="meta">Posted on 2006-03-30 07:34:36 by donkey</div>
   </div>
   <div class="post" id="post-178774">
    <div class="subject"><a href="#post-178774">Re: Get a window's icon by hWnd</a></div>
    <div class="body">Synfire : i knew about the GetClassLong but in some cases the function can&#39;t either retrieve the icon or the window hasn&#39;t got an icon. but if i try finding the hWnd&#39;s executable file then i can extract it&#39;s icon.<br /><br />Donkey : WM_GETICON doesn&#39;t work even on my own window which has been set an icon by WM_SETICON :roll:</div>
    <div class="meta">Posted on 2006-03-30 13:41:36 by XCHG</div>
   </div>
  </div>
 </body>
</html>