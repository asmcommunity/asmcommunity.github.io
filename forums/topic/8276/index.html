<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How to add a icon in a program? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8276" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=8276">How to add a icon in a program?</a></p>
   <div class="post" id="post-60529">
    <div class="subject"><a href="#post-60529">How to add a icon in a program?</a></div>
    <div class="body">I do it like this????all files are in the same folder??<br />resouce file ??<br />#define IDI_ICON   102<br />?_?_ ?_?_<br />IDI_ICON        ICON      &quot;test.ico&quot;<br />?_?_ ?_?_<br />asm file??<br />?_?_ ?_?_<br />.const<br />IDI_ICON equ 102<br />?_?_ ?_?_<br />      invoke LoadIcon,NULL,IDI_ICON<br />      mov    wc.hIcon,eax<br />      mov    wc.hIconSm,eax<br />?_?_ ?_?_<br />but it doesn't work, where is wrong.?</div>
    <div class="meta">Posted on 2002-10-04 07:21:10 by devspace</div>
   </div>
   <div class="post" id="post-60530">
    <div class="subject"><a href="#post-60530">How to add a icon in a program?</a></div>
    <div class="body">You need to give the handle for the instance containing the icon resource (hInstance) obtained with GetModuleHandle function.<br /><br />asm file??<br />?_?_ ?_?_<br />.const<br />IDI_ICON equ 102<br />?_?_ ?_?_<br /><strong>invoke GetModuleHandle,0<br />mov wc.hInstance,eax</strong><br />invoke LoadIcon,<strong>eax</strong>,IDI_ICON<br />mov wc.hIcon,eax<br />mov wc.hIconSm,eax<br />?_?_ ?_?_</div>
    <div class="meta">Posted on 2002-10-04 07:31:02 by pelaillo</div>
   </div>
   <div class="post" id="post-60606">
    <div class="subject"><a href="#post-60606">How to add a icon in a program?</a></div>
    <div class="body">But it isn't work still:<br />The resource file is:<br />#include &quot;\masm32\include\resource.h&quot;<br />#define IDI_ICON   102      ;???<br />#define IDM_CREATE 1<br />#define IDM_OPEN   2<br />#define IDM_SAVE   3<br />#define IDM_SAVEAS 4<br />#define IDM_EXIT   5<br />#define IDM_BACKCOLOR 6<br />#define IDM_FONTSIZE  7<br />#define IDM_FONTCOLOR 8<br />#define IDM_HELP      9<br />#define IDM_ABOUT     10<br />FirstMenu menu<br />{ popup &quot;???&quot;,help<br />  {menuitem &quot;?½?&quot;,IDM_CREATE,GRAYED<br />   menuitem &quot;????&quot;,IDM_OPEN<br />   menuitem &quot;????&quot;,IDM_SAVE<br />   menuitem &quot;??????_?_&quot;,IDM_SAVEAS<br />   menuitem separator<br />   menuitem &quot;???&quot;,IDM_EXIT}<br />  popup &quot;???_&quot;<br />  {menuitem &quot;????&quot;,IDM_BACKCOLOR<br />   menuitem &quot;???&quot;,IDM_FONTCOLOR<br />   menuitem &quot;????&quot;,IDM_FONTSIZE}<br />  popup &quot;????&quot;<br />  {menuitem &quot;????&quot;,IDM_HELP<br />   menuitem separator<br />   menuitem &quot;????&quot;,IDM_ABOUT}}<br />IDI_ICON        ICON      &quot;myicon.ico&quot;<br /><br /><br /><br />The asm file like this:<br />.386<br />.model flat,stdcall<br />option casemap:none<br />WinMain proto :DWORD,:DWORD,:DWORD,:DWORD<br /><br />include \masm32\include\windows.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\comdlg32.inc<br />include \masm32\include\gdi32.inc<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\comdlg32.lib<br />includelib \masm32\lib\gdi32.lib<br /><br />.const<br />IDI_ICON equ 102<br />.data<br />MenuName   db  &quot;FirstMenu&quot;,0               ;<br />ClassName  db  &quot;MyClass&quot;,0                 ;<br />AppName    db  &quot;NotePad&quot;,0              ;<br />.data?<br />hInstance HINSTANCE  ?<br />CommandLine LPSTR    ?<br />.code<br />start:<br />      invoke GetModuleHandle,NULL<br />      mov    hInstance,eax<br />      invoke GetCommandLine<br />      mov    CommandLine,eax<br />      invoke WinMain,hInstance,NULL,CommandLine,SW_SHOWDEFAULT<br />      invoke ExitProcess,eax<br />WinMain proc hInst:HINSTANCE,hPrevInst:HINSTANCE,CmdLine:LPSTR,CmdShow:DWORD<br />      local  wc:WNDCLASSEX<br />      local  msg:MSG<br />      local  hwnd:HWND<br />      mov    wc.cbSize,sizeof WNDCLASSEX<br />      mov    wc.style,CS_HREDRAW OR CS_VREDRAW<br />      mov    wc.lpfnWndProc,offset WndProc<br />      mov    wc.cbClsExtra,NULL<br />      mov    wc.cbWndExtra,NULL<br />      push   hInst<br />      pop    wc.hInstance<br />      invoke LoadIcon,hInst,IDI_ICON<br />      mov    wc.hIcon,eax<br />      mov    wc.hIconSm,eax<br />      invoke LoadCursor,NULL,IDC_ARROW<br />      mov    wc.hCursor,eax<br />      mov    wc.hbrBackground,COLOR_WINDOW+1<br />      mov    wc.lpszMenuName,offset MenuName<br />      mov    wc.lpszClassName,offset ClassName<br />      invoke RegisterClassEx,addr wc<br />      invoke CreateWindowEx,WS_EX_CLIENTEDGE,addr ClassName,addr AppName,WS_OVERLAPPEDWINDOW,200,200,\<br />             400,200,NULL,NULL,hInst,NULL<br />      mov    hwnd,eax<br />      invoke ShowWindow,hwnd,SW_SHOWDEFAULT<br />      invoke UpdateWindow,hwnd<br />      .while TRUE<br />             invoke GetMessage,addr msg,NULL,0,0<br />	     .break .if(!eax)<br />	     invoke TranslateMessage,addr msg<br />	     invoke DispatchMessage,addr msg<br />      .endw<br />      mov    eax,msg.wParam<br />      ret<br />WinMain endp<br />WndProc proc hWnd:HWND,uMsg:UINT,wParam:WPARAM,lParam:LPARAM<br />      .if uMsg==WM_CREATE<br /><br />      .elseif uMsg==WM_COMMAND<br /><br />      .elseif uMsg==WM_DESTROY<br />              invoke PostQuitMessage,NULL<br />      .else<br />              invoke DefWindowProc,hWnd,uMsg,wParam,lParam<br />	      ret<br />      .endif<br />      xor eax,eax<br />      ret<br />WndProc endp<br />end start<br />(I come from china ,and english is poor ,will make you a friend,<br />my email is:devspace@etang.com)</div>
    <div class="meta">Posted on 2002-10-05 05:20:22 by devspace</div>
   </div>
   <div class="post" id="post-60612">
    <div class="subject"><a href="#post-60612">How to add a icon in a program?</a></div>
    <div class="body"><div class="quote"><br />But it isn't work still:<br />The resource file is:<br />#include &quot;\masm32\include\resource.h&quot;<br />#define IDI_ICON   102      ;???<br />#define IDM_CREATE 1<br />#define IDM_OPEN   2<br />#define IDM_SAVE   3<br />#define IDM_SAVEAS 4<br />#define IDM_EXIT   5<br />#define IDM_BACKCOLOR 6<br />#define IDM_FONTSIZE  7<br />#define IDM_FONTCOLOR 8<br />#define IDM_HELP      9<br />#define IDM_ABOUT     10<br />FirstMenu menu<br />{ popup &quot;???&quot;,help<br />  {menuitem &quot;?½?&quot;,IDM_CREATE,GRAYED<br />   menuitem &quot;????&quot;,IDM_OPEN<br />   menuitem &quot;????&quot;,IDM_SAVE<br />   menuitem &quot;??????_?_&quot;,IDM_SAVEAS<br />   menuitem separator<br />   menuitem &quot;???&quot;,IDM_EXIT}<br />  popup &quot;???_&quot;<br />  {menuitem &quot;????&quot;,IDM_BACKCOLOR<br />   menuitem &quot;???&quot;,IDM_FONTCOLOR<br />   menuitem &quot;????&quot;,IDM_FONTSIZE}<br />  popup &quot;????&quot;<br />  {menuitem &quot;????&quot;,IDM_HELP<br />   menuitem separator<br />   menuitem &quot;????&quot;,IDM_ABOUT}}<br />IDI_ICON        ICON      &quot;myicon.ico&quot;<br /><br /><br /><br />The asm file like this:<br />.386<br />.model flat,stdcall<br />option casemap:none<br />WinMain proto :DWORD,:DWORD,:DWORD,:DWORD<br /><br />include \masm32\include\windows.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\comdlg32.inc<br />include \masm32\include\gdi32.inc<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\comdlg32.lib<br />includelib \masm32\lib\gdi32.lib<br /><br />.const<br />IDI_ICON equ 102<br />.data<br />MenuName   db  &quot;FirstMenu&quot;,0               ;<br />ClassName  db  &quot;MyClass&quot;,0                 ;<br />AppName    db  &quot;NotePad&quot;,0              ;<br />.data?<br />hInstance HINSTANCE  ?<br />CommandLine LPSTR    ?<br />.code<br />start:<br />      invoke GetModuleHandle,NULL<br />      mov    hInstance,eax<br />      invoke GetCommandLine<br />      mov    CommandLine,eax<br />      invoke WinMain,hInstance,NULL,CommandLine,SW_SHOWDEFAULT<br />      invoke ExitProcess,eax<br />WinMain proc hInst:HINSTANCE,hPrevInst:HINSTANCE,CmdLine:LPSTR,CmdShow:DWORD<br />      local  wc:WNDCLASSEX<br />      local  msg:MSG<br />      local  hwnd:HWND<br />      mov    wc.cbSize,sizeof WNDCLASSEX<br />      mov    wc.style,CS_HREDRAW OR CS_VREDRAW<br />      mov    wc.lpfnWndProc,offset WndProc<br />      mov    wc.cbClsExtra,NULL<br />      mov    wc.cbWndExtra,NULL<br />      push   hInst<br />      pop    wc.hInstance<br />      invoke LoadIcon,hInst,IDI_ICON<br />      mov    wc.hIcon,eax<br />      mov    wc.hIconSm,eax<br />      invoke LoadCursor,NULL,IDC_ARROW<br />      mov    wc.hCursor,eax<br />      mov    wc.hbrBackground,COLOR_WINDOW+1<br />      mov    wc.lpszMenuName,offset MenuName<br />      mov    wc.lpszClassName,offset ClassName<br />      invoke RegisterClassEx,addr wc<br />      invoke CreateWindowEx,WS_EX_CLIENTEDGE,addr ClassName,addr AppName,WS_OVERLAPPEDWINDOW,200,200,\<br />             400,200,NULL,NULL,hInst,NULL<br />      mov    hwnd,eax<br />      invoke ShowWindow,hwnd,SW_SHOWDEFAULT<br />      invoke UpdateWindow,hwnd<br />      .while TRUE<br />             invoke GetMessage,addr msg,NULL,0,0<br />	     .break .if(!eax)<br />	     invoke TranslateMessage,addr msg<br />	     invoke DispatchMessage,addr msg<br />      .endw<br />      mov    eax,msg.wParam<br />      ret<br />WinMain endp<br />WndProc proc hWnd:HWND,uMsg:UINT,wParam:WPARAM,lParam:LPARAM<br />      .if uMsg==WM_CREATE<br /><br />      .elseif uMsg==WM_COMMAND<br /><br />      .elseif uMsg==WM_DESTROY<br />              invoke PostQuitMessage,NULL<br />      .else<br />              invoke DefWindowProc,hWnd,uMsg,wParam,lParam<br />	      ret<br />      .endif<br />      xor eax,eax<br />      ret<br />WndProc endp<br />end start<br />(I come from china ,and english is poor ,will make you a friend,<br />my email is:devspace@etang.com) </div><br /><br /><br />Nice to meet you, devspace. I'm from China, too. I've seen your post in CSDN. My id there is &quot;itaolu&quot;.<br /><br />Your problem is caused by this line:<br /><br />#define IDI_ICON   102      ;???<br /><br />remember that &quot;;&quot; is only available in ASM Code, NOT in .rc file.<br /><br />if you delete &quot;;???&quot;, the problem will be solved.<br /><br /><br />???????????????????????????<br />????????????????????CSDN??????????????????????????<br />???_??????????????<a target="_blank" href="http://laoluoc.yeah.net">http://laoluoc.yeah.net</a></div>
    <div class="meta">Posted on 2002-10-05 06:34:29 by pazuluo</div>
   </div>
  </div>
 </body>
</html>