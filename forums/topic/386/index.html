<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>code example how to handle LVN_BEGINDRAG - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=386" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=386">code example how to handle LVN_BEGINDRAG</a></p>
   <div class="post" id="post-2123">
    <div class="subject"><a href="#post-2123">code example how to handle LVN_BEGINDRAG</a></div>
    <div class="body">Has anybody a working Drag 'n Drop code example handling notification LVN_BEGINDRAG and using functions<br /><br /><pre><code><br />ListView_CreateDragImage <br />ImageList_BeginDrag<br />ImageList_DragEnter<br />ImageList_EndDrag<br /></code></pre><br /><br />written in C or ASM? (Only DnD inside an application, without OLE stuff)<br /><br />japheth</div>
    <div class="meta">Posted on 2001-07-27 05:00:07 by japheth</div>
   </div>
   <div class="post" id="post-2139">
    <div class="subject"><a href="#post-2139">code example how to handle LVN_BEGINDRAG</a></div>
    <div class="body">Hello<br /><br />look here : <a target="_blank" href="http://betrayed.virtualave.net/cgi-bin/load.cgi?asm/cspy.zip">http://betrayed.virtualave.net/cgi-bin/load.cgi?asm/cspy.zip</a><br />by: <a href="mailto:betrayed@betrayed.virtualave.net">betrayed@betrayed.virtualave.net</a><br /><br /><br />inside you find the drag and drop function.<br /><br />cu</div>
    <div class="meta">Posted on 2001-07-27 07:15:35 by CodeMonkey</div>
   </div>
   <div class="post" id="post-2143">
    <div class="subject"><a href="#post-2143">drag and drop</a></div>
    <div class="body">I have been looking for drag and drop code myself.<br />In Hutch's Windows.inc I could not find the APIs for<br />ImageList_BeginDrag, ImageList _DragEnter,<br />ImageList_EndDrag, let alone the description on<br />how to use them.<br /><br />J. P. Shankle<br /><a href="mailto:jpsdjsfl@worldnet.att.net">jpsdjsfl@worldnet.att.net</a></div>
    <div class="meta">Posted on 2001-07-27 08:10:48 by shankle</div>
   </div>
   <div class="post" id="post-2253">
    <div class="subject"><a href="#post-2253">code example how to handle LVN_BEGINDRAG</a></div>
    <div class="body">I have got my app to work now. But I am afraid my work is far from a good solution. It looks very complicated. The only example I found was DragD95.exe from Microsoft (MFC app). And the Imagelist functions are lousy documented. My goal was:<br /><br />- implement D&amp;D in a listview to allow the user rearrange the items in that listview (only report view, without images)<br />- if the dragged item is over another item, this item should be hilighted (like in explorer)<br />- if the dragged item is out of the allowed area, show a &quot;slashed circle&quot;<br />- do not use any OLE overhead (IDropTarget IDataSource ...)<br /><br />I have written a small test app (source code attached). Maybe anyone has a good idea to optimize this code.<br />The relevant parts are:<br />- handling of LBN_BEGINDRAG<br />- handling WM_MOUSEMOVE<br />- handling WM_LBUTTONUP<br /><br />japheth</div>
    <div class="meta">Posted on 2001-07-28 11:23:53 by japheth</div>
   </div>
  </div>
 </body>
</html>