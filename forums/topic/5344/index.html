<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>string formatting? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5344" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5344">string formatting?</a></p>
   <div class="post" id="post-37925">
    <div class="subject"><a href="#post-37925">string formatting?</a></div>
    <div class="body">yo. i want to format a string so is has a comma &quot;,&quot; every three spaces going from RIGHT TO LEFT<br />ex. ss,sss,sss,sss,sss <br />how am i to do this?</div>
    <div class="meta">Posted on 2002-05-12 16:04:55 by Qages</div>
   </div>
   <div class="post" id="post-37927">
    <div class="subject"><a href="#post-37927">string formatting?</a></div>
    <div class="body"><a target="_blank" href="http://www.madwizard.org/snippets/viewSnippet.php?s_ID=28">http://www.madwizard.org/snippets/viewSnippet.php?s_ID=28</a><br /><br />Thomas</div>
    <div class="meta">Posted on 2002-05-12 16:10:37 by Thomas</div>
   </div>
   <div class="post" id="post-37929">
    <div class="subject"><a href="#post-37929">string formatting?</a></div>
    <div class="body">doesnt work too well, comes up as xx,,xxx,xxxxxx</div>
    <div class="meta">Posted on 2002-05-12 16:25:18 by Qages</div>
   </div>
   <div class="post" id="post-37931">
    <div class="subject"><a href="#post-37931">string formatting?</a></div>
    <div class="body">Hmm you'll have to ask <strong>The Svin</strong> about that, it's his algo. It shouldn't be too hard to think of an algo yourself though.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-05-12 17:13:13 by Thomas</div>
   </div>
   <div class="post" id="post-37932">
    <div class="subject"><a href="#post-37932">string formatting?</a></div>
    <div class="body">line lea edi,[1] needs to be lea edi,[0] , and a comma isput at the end, but i can fix that</div>
    <div class="meta">Posted on 2002-05-12 17:18:31 by Qages</div>
   </div>
   <div class="post" id="post-37934">
    <div class="subject"><a href="#post-37934">string formatting?</a></div>
    <div class="body">it also very slow, any way to speed it up? it makes my program run 2x slower</div>
    <div class="meta">Posted on 2002-05-12 17:35:32 by Qages</div>
   </div>
   <div class="post" id="post-37938">
    <div class="subject"><a href="#post-37938">string formatting?</a></div>
    <div class="body">Qages... I get more and more annoyed by your posts. They are just getting more like &quot;do this, do that, I don't want to try it&quot;. <img src="http://plaudersmilies.de/nono.gif" /><br /><br />IF you have a problem (and it seems like you have a lot of them), please first post YOUR approach how to solve it. The learn-effect is much higher if we fix a bug in code YOU wrote. Not if you use code WE wrote and complain about speed/size/functionality/whatever.<br /><br />JFYI...<br /><br />bAZiK</div>
    <div class="meta">Posted on 2002-05-12 18:07:17 by bazik</div>
   </div>
   <div class="post" id="post-37939">
    <div class="subject"><a href="#post-37939">string formatting?</a></div>
    <div class="body">ok dude if you dont want me here i wont come.</div>
    <div class="meta">Posted on 2002-05-12 18:09:55 by Qages</div>
   </div>
   <div class="post" id="post-37941">
    <div class="subject"><a href="#post-37941">string formatting?</a></div>
    <div class="body">oh and i learn best by what other people do, i wont come to a fourm where prejustice against my ways are so clear.</div>
    <div class="meta">Posted on 2002-05-12 18:13:07 by Qages</div>
   </div>
   <div class="post" id="post-37943">
    <div class="subject"><a href="#post-37943">string formatting?</a></div>
    <div class="body"><div class="quote"><br />ok dude if you dont want me here i wont come. </div><br /><br />I did not say, that I &quot;don't want you&quot;. <br />My simple advice is:<br />First try to solve a problem by yourself. Then, if you can't do it post your work here... and perhaps we can complete it to let it work as wanted. Writing a simple string formater wich adds a comma every three chars is just a 10min work if you read at least Thomas' and Iczelions tutorials (and perhaps NOP-erators string tutorial). Or to be clear: With a basic knowledge of ASM programming... you wont have a problem to write such simple routines. And remember always what hutch wrote on his homepage:<br /><br /><div class="quote"><br />MASM32 is not intended as a programming beginners package, it is squarely aimed at <u>experienced programmers</u> who are familiar with windows API programming with compilers and have done some work in assembler. The package assumes that the programmer already knows enough to start working in assembler and is designed with this level in mind. Any programmer is welcome to use MASM32 but unless they have the experience level that is assumed in the design of MASM32, concepts like register sizes to data types, register usage, assembler mnemonics, API calls, calling conventions and other similar technical data will be very difficult to grasp. Programming beginners are better served by learning a higher level language first and when they are familiar enough with the technical concepts involved, they can come back to assembler later. <br /></div></div>
    <div class="meta">Posted on 2002-05-12 18:19:11 by bazik</div>
   </div>
   <div class="post" id="post-37950">
    <div class="subject"><a href="#post-37950">string formatting?</a></div>
    <div class="body">in response to the quote:  im not a newbie programmer, i can do vb, and im a low expert in it. i also did work in asm too befor masm, but i cant talk about it because its illegal.<br /><br />also and to be clear, puting a comma every 3 spaces is not a 10 min job to me. I did try to solve it on my own, but i had no luck on it. and ok ill post fragments of my code that i tryed.</div>
    <div class="meta">Posted on 2002-05-12 18:36:43 by Qages</div>
   </div>
   <div class="post" id="post-37954">
    <div class="subject"><a href="#post-37954">string formatting?</a></div>
    <div class="body">Qages,<br /><br />There is no plot against you here, just a comment that if you want to write assembler effectively, you will have to learn how to do some of these things. String functions and parsing string data can be complicated depending on the task and what you really need is a good grasp of how general purpose string manipulation works, then you can write your own to do what you need.<br /><br />Most of the older guys here did this the hard way when the internet was not available, write it, test it and see what the function you write does.<br /><br />If you want to do this type of work in assembler, start looking for information about string manipulation and start writing some test pieces to become practiced at it. This way you will get a lot better at it and you will not need much help at all.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-05-12 19:11:38 by hutch--</div>
   </div>
   <div class="post" id="post-37971">
    <div class="subject"><a href="#post-37971">string formatting?</a></div>
    <div class="body">Here is fixed version. (changes made by Qages don't solve the problem it just created another one)<br /><br />Qages, the only reason it might seemed slow to you it is if<br />you used it for long string.<br />An explonation:<br />the function was aimed to be used for number periods separation,<br />were length is short (from one to 11 bytes) that's why division was replaced with substruction. With short string it is much faster<br />for example div 10 by 3 using substruction would take ~ 6-8 clocks. div 2 by 3 ~ 1 clock. While using div it would be upto 40 clocks. But with long numbers sub division might be as slow as value of devident*2,5. Of course in this case (the case that would not occur in situation where the proc was intended to be used) it's better replace it with mul division since constant is known.<br />If you are not able to code it for long strings, I can do it for you.<br /><br />As for speed using with numbers this function showed results 10 times faster than closest to it in former contest in algo section.<br /><br />OK here is fixed proc inside test program:<br /><pre><code><br />.data<br />string1 db '1234567890',0<br />string2 db 16 dup &#40;0&#41;<br />.code<br />InsertComma PROTO &#58;DWORD,&#58;DWORD,&#58;DWORD<br /><br />InsertComma proc uses esi edi len,lpszStringIn,lpszStringOut<br />	mov esi,lpszStringIn<br />	mov edi,lpszStringOut<br />	mov ecx,-1<br />	mov eax,len<br />@@&#58;	inc ecx		;number of commas<br />	sub eax,3<br />	jnbe @B<br />	test ecx,ecx ;if length less than 4<br />	je @0<br />	mov edx,&#91;esi&#93;<br />	add eax,3	;reminder<br />	mov &#91;edi&#93;,edx<br />	lea esi,&#91;esi&#93;&#91;eax&#93;&#91;-1&#93;<br />	dec ecx<br />	lea edi,&#91;edi&#93;&#91;eax&#93;<br />	je @l4<br />@@&#58;	mov eax,&#91;esi&#93;<br />	add esi,3<br />	mov al,2Ch<br />	dec ecx<br />	mov &#91;edi&#93;,eax<br />	lea edi,&#91;edi&#93;&#91;4&#93;<br />	jns @B<br />	jmp @r<br />@l4&#58;<br />	mov byte ptr &#91;edi&#93;,2Ch<br />	mov eax,&#91;esi+1&#93;<br />	mov &#91;edi+1&#93;,eax<br />@r&#58;	ret<br />@0&#58; mov eax,&#91;esi&#93;<br />	mov &#91;edi&#93;,eax<br />	jmp @r<br />InsertComma endp<br /><br />start&#58;<br />	invoke	InsertComma,sizeof string1-1,offset string1,offset string2<br />	invoke MessageBox,0,offset string2,0,0<br />	call ExitProcess<br />	end start<br /></code></pre></div>
    <div class="meta">Posted on 2002-05-12 20:03:58 by The Svin</div>
   </div>
   <div class="post" id="post-37981">
    <div class="subject"><a href="#post-37981">string formatting?</a></div>
    <div class="body">Does this condensed version hamper the speed any?<pre><code>InsertComma PROC uses esi edi len,lpszStringIn,lpszStringOut<br />	or ecx,-1<br />	mov eax,len<br />	mov esi,lpszStringIn<br />	mov edi,lpszStringOut<br />@@&#58;	inc ecx		;number of commas<br />	sub eax,3<br />	jnbe @B<br />	mov edx,&#91;esi&#93;<br />	; remainder &amp; back one for 2Ch in low byte of EAX loop below<br />	lea esi,&#91;esi&#93;&#91;eax&#93;&#91;3&#93;&#91;-1&#93;<br />	mov &#91;edi&#93;,edx<br />	dec ecx<br />	; remainder &amp; back four for ADD before MOV in loop below<br />	lea edi,&#91;edi&#93;&#91;eax&#93;&#91;3&#93;&#91;-4&#93;<br />	js @r ; if length less than four we are done<br />	jne @F<br />	mov byte ptr &#91;edi&#93;&#91;4&#93;,2Ch<br />	mov eax,&#91;esi+1&#93;<br />	mov &#91;edi+1&#93;&#91;4&#93;,eax<br />	jmp @r<br />@@&#58;	mov eax,&#91;esi&#93;<br />	add esi,3<br />	mov al,2Ch<br />	add edi,4<br />	dec ecx<br />	mov &#91;edi&#93;,eax<br />	jns @B<br />@r&#58;	ret<br />InsertComma ENDP</code></pre>Also, how do you ensure zero termination for string after the multi-comma loop?</div>
    <div class="meta">Posted on 2002-05-12 21:27:07 by bitRAKE</div>
   </div>
   <div class="post" id="post-37982">
    <div class="subject"><a href="#post-37982">string formatting?</a></div>
    <div class="body">Why ask me :)<br />Teeest!<br />Rickey, you are always progressing very fast when writing test.<br />So do it.<br />There is help from our mind (when we think) and additional help from our eyes to our mind (when we test).</div>
    <div class="meta">Posted on 2002-05-12 21:33:08 by The Svin</div>
   </div>
   <div class="post" id="post-37984">
    <div class="subject"><a href="#post-37984">string formatting?</a></div>
    <div class="body"><div class="quote"><br />Why ask me :)</div>Tests for you are not the same as for me.  How do you ensure zero termination for string after the multi-comma loop?</div>
    <div class="meta">Posted on 2002-05-12 21:39:15 by bitRAKE</div>
   </div>
   <div class="post" id="post-37985">
    <div class="subject"><a href="#post-37985">string formatting?</a></div>
    <div class="body">If sourse string is zeroterminated the zero is aoutomaticaly passed with last dword (it sends last 3 bytes + 1 and this one is zero by terms)<br />oops I'm wrong :) it's only for &lt;= 3  and  &lt;=  6 case.<br />lets write it before ret.<br />	mov byte ptr ,0</div>
    <div class="meta">Posted on 2002-05-12 21:42:17 by The Svin</div>
   </div>
   <div class="post" id="post-38123">
    <div class="subject"><a href="#post-38123">string formatting?</a></div>
    <div class="body">Svin &amp; BitRAKE,<br />Sometimes I feel like a 5 year old listening to my parents talk :)<br /><br />Don't often understand the conversation, but I figure if I listen long enough I'm sure to learn something :)  Well, it never happened from my parents, but I still listen every now and again :)<br /><br />One day I hope to be able to post something someone finds interesting in the Algo. and Source sections -- until then keep up the good work, both of you...<br /><br />Anyway, Got to get back to work :)  Hope this conversation continues (hence why I replied)<br /><br />If not I'll wait for the next one...<br /><br />Sliver</div>
    <div class="meta">Posted on 2002-05-13 23:09:00 by Sliver</div>
   </div>
   <div class="post" id="post-38128">
    <div class="subject"><a href="#post-38128">string formatting?</a></div>
    <div class="body"><strong>No Sh*t Sliver, </strong> <br /><br />This is the board i know.<br /><br />The Warriors are <strong>Back</strong> ... Again ...<br /><br />I love the way they light the Fire :)  :)  :)  <br /><br /><span style="font-size:9px>When it happen We All Win...Runn for your lifes</span> They BACK</div>
    <div class="meta">Posted on 2002-05-14 00:25:19 by cmax</div>
   </div>
   <div class="post" id="post-38167">
    <div class="subject"><a href="#post-38167">string formatting?</a></div>
    <div class="body">Am I the only one wich is always suprised about what cmax get's in mind the last days? :eek: <br /><br /><br /><br /><br />:stupid:</div>
    <div class="meta">Posted on 2002-05-14 08:38:12 by bazik</div>
   </div>
  </div>
 </body>
</html>