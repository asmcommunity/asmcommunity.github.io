<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Instruction latencies - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14160" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14160">Instruction latencies</a></p>
   <div class="post" id="post-109450">
    <div class="subject"><a href="#post-109450">Instruction latencies</a></div>
    <div class="body">I'm working on an automatic instruction scheduler. I need the latencies of Pentium III, Pentium 4 and Althon XP instructions. What would be really cool is if I had some functions which could accurately approximate these numbers, so I don't need to hand-write tables with thousands of elements...<br /><br />Does anyone know if such functions exist? For example with a good understanding of the mirco-instructions and the pipeline architecture I believe it must be possible to make good predictions.<br /><br />Another option, which I think would be even better, is to actually measure them. This would immediately make it processor independent and future-proof. Any idea's what would be the best method to do this? What's worrying me most is that many instructions would just crash the program. Also, can I 'measure' what issue ports and execution units are used?</div>
    <div class="meta">Posted on 2003-07-06 14:13:28 by C0D1F1ED</div>
   </div>
   <div class="post" id="post-109673">
    <div class="subject"><a href="#post-109673">Instruction latencies</a></div>
    <div class="body">I solved part of the problem. What was giving me most trouble was the call instruction. Finally I found out I could measure its latency like this:<br /><pre><code><br />    DD temp<br />    ...<br />    pushad<br />    mov temp, esp<br /><br />    call label1<br />label1&#58;<br />    call label2<br />label2&#58;<br />    ...<br /><br />    mov esp, temp<br />    popad<br /></code></pre><br />But I can't figure out a way to test what issue ports and execution units are used which is processor independent...<br /><br />Anyone done anything like this before?</div>
    <div class="meta">Posted on 2003-07-08 11:32:17 by C0D1F1ED</div>
   </div>
   <div class="post" id="post-109705">
    <div class="subject"><a href="#post-109705">Instruction latencies</a></div>
    <div class="body">I'm wonder if the MSRs could be used?<br /><br /><a target="_blank" href="http://www.sandpile.org/ia32/msr.htm">http://www.sandpile.org/ia32/msr.htm</a><br /><a target="_blank" href="http://www.cs.inf.ethz.ch/stricker/lab/doc/intel-doc.html">http://www.cs.inf.ethz.ch/stricker/lab/doc/intel-doc.html</a></div>
    <div class="meta">Posted on 2003-07-08 18:25:15 by bitRAKE</div>
   </div>
   <div class="post" id="post-109712">
    <div class="subject"><a href="#post-109712">Instruction latencies</a></div>
    <div class="body">YOU COULD Use rdtsc. that mesures in clock accuracy. now on older cpu 4 INC after another might take just 4 clocks other its 2 and others its 1, depends on the cpu, pipes. and there are so many combos. and stalls,mops, and bounderies. etc you would have to find a book the person who designed the cpu wrote in order to know every thing. however i think that rdtsc will work fine for you if you know what cpu yer on.</div>
    <div class="meta">Posted on 2003-07-08 19:46:48 by Qages</div>
   </div>
   <div class="post" id="post-110091">
    <div class="subject"><a href="#post-110091">Instruction latencies</a></div>
    <div class="body">I'm already using RDTSC, but what exactly am I measuring with that? Clock cycles, ok, but it's probably influenced by things like Hyper-Threading? So is there a better way of measuring latency and/or troughput? Can the MSR's tell me what execution unit is used? Thanks.</div>
    <div class="meta">Posted on 2003-07-11 06:37:57 by C0D1F1ED</div>
   </div>
   <div class="post" id="post-110103">
    <div class="subject"><a href="#post-110103">Instruction latencies</a></div>
    <div class="body">C0D1F1ED,<br /><br />Are you using RDTSC correctly according to this link?  Ratch <br /><br /><a target="_blank" href="http://cedar.intel.com/software/idap/media/pdf/rdtscpm1.pdf">http://cedar.intel.com/software/idap/media/pdf/rdtscpm1.pdf</a></div>
    <div class="meta">Posted on 2003-07-11 10:15:12 by Ratch</div>
   </div>
  </div>
 </body>
</html>