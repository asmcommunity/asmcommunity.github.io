<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>M32lib's dwtoa bug - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2782" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=2782">M32lib's dwtoa bug</a></p>
   <div class="post" id="post-17858">
    <div class="subject"><a href="#post-17858">M32lib's dwtoa bug</a></div>
    <div class="body">There is a bug in the dwtoa function from the masm32 lib. It occurs when dwValue is 0:<br /><pre><code><br />....<br />    push ebx<br />    push esi<br />    push edi<br /><br />    mov eax, dwValue<br />    mov edi, &#91;lpBuffer&#93;<br /><br />    or eax,eax<br />    jnz sign<br />    <br />  zero&#58;<br />    mov word ptr &#91;edi&#93;,30h<br />&#91;b&#93;    pop	edi<br />    pop	esi<br />    pop	ebx&#91;/b&#93;<br />    ret<br /></code></pre><br /><br />The bold lines are missing.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-01-06 11:05:39 by Thomas</div>
   </div>
   <div class="post" id="post-17986">
    <div class="subject"><a href="#post-17986">M32lib's dwtoa bug</a></div>
    <div class="body">Thomas,<br /><br />Thanks for finding this bug, its not one that I wrote and I missed it but it will be fixed in the next release.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-01-07 05:23:27 by hutch--</div>
   </div>
   <div class="post" id="post-18100">
    <div class="subject"><a href="#post-18100">M32lib's dwtoa bug</a></div>
    <div class="body">I get a kick out of &quot;stupid&quot; bugs like this.<br /><br />A good example of why to use a common exit. Or at least USES...<br /><br />:) :)</div>
    <div class="meta">Posted on 2002-01-07 21:19:33 by S/390</div>
   </div>
   <div class="post" id="post-21007">
    <div class="subject"><a href="#post-21007">M32lib's dwtoa bug</a></div>
    <div class="body">That's right!!!<br /><br />Not only &quot;dwtoa&quot; but also &quot;USES&quot; has a bug, i felt.<br /><br />so i don't trust &quot;USES&quot;, just use &quot;push&quot;, and &quot;pop&quot; manually.</div>
    <div class="meta">Posted on 2002-01-24 19:52:10 by muzidowa</div>
   </div>
   <div class="post" id="post-21035">
    <div class="subject"><a href="#post-21035">M32lib's dwtoa bug</a></div>
    <div class="body"><div class="quote">Not only &quot;dwtoa&quot; but also &quot;USES&quot; has a bug, i felt</div><br /><br />I never had problems with uses, can you give an example? It's safer than using push &amp; pop as it pops all registers back on every ret automatically, something you tend to forget when not using 'uses' as you can see in the dwtoa function.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-01-25 01:16:48 by Thomas</div>
   </div>
   <div class="post" id="post-21036">
    <div class="subject"><a href="#post-21036">M32lib's dwtoa bug</a></div>
    <div class="body">Thomas,<br /><br />Unfortunately, I forgot that case.<br /><br />last year, when I was debugging my app, found that.<br /><br />sorry... but in some case &quot;uses&quot; untrustable...</div>
    <div class="meta">Posted on 2002-01-25 01:30:25 by muzidowa</div>
   </div>
  </div>
 </body>
</html>