<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>2 questions - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20480" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20480">2 questions</a></p>
   <div class="post" id="post-156590">
    <div class="subject"><a href="#post-156590">2 questions</a></div>
    <div class="body">How can i get mac address? through asm code offcourse..<br /><br />And this long time problem which i still dont know how to solve in masm32 having references or data ahead in the program will give you an error..<br />In tasm its solved with the assembler passes over code more then once..<br />Whats the workaround with masm32?</div>
    <div class="meta">Posted on 2005-02-02 01:08:02 by pwn</div>
   </div>
   <div class="post" id="post-156593">
    <div class="subject"><a href="#post-156593">2 questions</a></div>
    <div class="body">I can only answer the second one.  You have to have all data declared before it is used.  I guess MASM only uses a one pass assembler.  This is just like C so you shouldn't have much problem with it.  You can use the PROTO directive for functions if you think you have to (I use this mostly for the WinMain function).  As for data, you have to declare it before you use it.<br /><br />Spara</div>
    <div class="meta">Posted on 2005-02-02 02:33:03 by Sparafusile</div>
   </div>
   <div class="post" id="post-156600">
    <div class="subject"><a href="#post-156600">2 questions</a></div>
    <div class="body">so I can answer question one :)<br /><br />have a look at the &quot;GetIfTable&quot; API function, it delivers description structures from all network adapters, including physical address.</div>
    <div class="meta">Posted on 2005-02-02 07:42:31 by beaster</div>
   </div>
   <div class="post" id="post-156607">
    <div class="subject"><a href="#post-156607">2 questions</a></div>
    <div class="body">hope this can help you some.<br />regards.<br /><br />mac_1.bat<br /><pre><code><br />;@echo off<br />;goto make<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />; the code for &lt; Win32MASM Programming &gt; written  by LYB<br />; it can get net Adapters Infomation.<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />.386<br />.model flat, stdcall<br />option casemap &#58;none<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />include	\masm32\include\windows.inc<br />include	\masm32\include\user32.inc<br />include	\masm32\include\kernel32.inc<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />MAX_ADAPTER_DESCRIPTION_LENGTH  equ 128<br />MAX_ADAPTER_NAME_LENGTH         equ 256<br />MAX_ADAPTER_ADDRESS_LENGTH      equ 8  <br />;-----------------------------------------<br />IP_ADDR_STRING	struct<br /><br /> Next		dword	?<br /> IpAddress	byte	16 dup &#40;?&#41;<br /> IpMask		byte	16 dup &#40;?&#41;<br /> Context	dword	?<br /><br />IP_ADDR_STRING	ends<br />;------------------------------------------<br />IP_ADAPTER_INFO	struct<br /><br /> Next		dword	?<br /> ComboIndex	dword	?<br /> AdapterName	byte	MAX_ADAPTER_NAME_LENGTH + 4 dup &#40;?&#41;<br /> Description	byte	MAX_ADAPTER_DESCRIPTION_LENGTH + 4 dup &#40;?&#41;<br /> AddressLength	dword	?<br /> Address	byte	MAX_ADAPTER_ADDRESS_LENGTH dup &#40;?&#41;<br /> Index		dword	?<br /> _Type		dword	?<br /> DhcpEnabled	dword	?<br /> CurrentIpAddress dword ?<br /> IpAddressList	IP_ADDR_STRING	&lt;&gt;<br /> GatewayList	IP_ADDR_STRING	&lt;&gt;<br /> DhcpServer	IP_ADDR_STRING	&lt;&gt;<br /> HaveWins	dword	?<br /> PrimaryWinsServer IP_ADDR_STRING	&lt;&gt;<br /> SecondaryWinsServer IP_ADDR_STRING	&lt;&gt;<br /> LeaseObtained	dword	?<br /> LeaseExpires	dword	?<br /><br />IP_ADAPTER_INFO	ends<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />ICO_MAIN	equ	1000<br />DLG_MAIN	equ	1000<br />IDC_ADPT	equ	1001<br />IDC_TYPE	equ	1002<br />IDC_MAC		equ	1003<br />IDC_IP		equ	1004<br />IDC_GATEWAY	equ	1005<br />IDC_WINS	equ	1006<br />IDC_DHCP	equ	1007<br />IDC_REFRESH	equ	1008<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />.data?<br />hInstance	dd	?<br />hWinMain	dd	?<br />hDll		dd	?<br />lpGetInfo	dd	?<br />dwStructSize	dd	?<br />lpInfo		dd	?<br />lpMemory	dd	?<br />szBuffer	db	1024 dup &#40;?&#41;<br />szBuffer1	db	1024 dup &#40;?&#41;<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />.const<br />szDll		db	'Iphlpapi.dll',0<br />szGetInfo	db	'GetAdaptersInfo',0<br />szErrNoAdapter	db	'not installed net Adapters',0<br />szNA		db	'N/A',0<br />szMac		db	'%02X&#58;%02X&#58;%02X&#58;%02X&#58;%02X&#58;%02X',0<br />szSpar		db	'/',0<br />szCrLf		db	0dh,0ah,0<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />.code<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />_GetIPString	proc	_lpIP,_lpOut,_dwSize,_dwIfMask<br /><br />		pushad<br />		invoke	RtlZeroMemory,_lpOut,_dwSize<br />		mov	esi,_lpIP<br />		assume	esi&#58;ptr IP_ADDR_STRING<br />		@@&#58;<br />		.if	byte ptr &#91;esi&#93;.IpAddress<br />			invoke	lstrcat,_lpOut,addr &#91;esi&#93;.IpAddress<br />			.if	&#40;byte ptr &#91;esi&#93;.IpMask&#41; &amp;&amp; _dwIfMask<br />				invoke	lstrcat,_lpOut,addr szSpar<br />				invoke	lstrcat,_lpOut,addr &#91;esi&#93;.IpMask<br />			.endif<br />		.endif<br />		mov	esi,&#91;esi&#93;.Next<br />		.if	esi<br />			invoke	lstrcat,_lpOut,addr szCrLf<br />			jmp	@B<br />		.endif<br />		assume	esi&#58;nothing<br />		popad<br />		ret<br /><br />_GetIPString	endp<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />_ShowInfo	proc<br /><br />		pushad<br />		mov	esi,lpInfo<br />		assume	esi&#58;ptr IP_ADAPTER_INFO<br />		.if	&#91;esi&#93;.Next<br />			invoke	GetDlgItem,hWinMain,IDOK<br />			invoke	EnableWindow,eax,TRUE<br />		.else<br />			invoke	GetDlgItem,hWinMain,IDOK<br />			invoke	EnableWindow,eax,FALSE<br />		.endif<br />		invoke	SetDlgItemText,hWinMain,IDC_ADPT,addr &#91;esi&#93;.Description<br />		invoke	SetDlgItemInt,hWinMain,IDC_TYPE,&#91;esi&#93;._Type,FALSE<br /><br />		lea	edi,&#91;esi&#93;.Address<br />		mov	ebx,6<br />		.while	ebx<br />			movzx	eax,byte ptr &#91;edi+ebx-1&#93;<br />			push	eax<br />			dec	ebx<br />		.endw<br />		invoke	wsprintf,addr szBuffer,addr szMac<br />		add	esp,6 * 4<br />		invoke	SetDlgItemText,hWinMain,IDC_MAC,addr szBuffer<br /><br />		invoke	_GetIPString,addr &#91;esi&#93;.IpAddressList,addr szBuffer,sizeof szBuffer,TRUE<br />		invoke	SetDlgItemText,hWinMain,IDC_IP,addr szBuffer<br />		invoke	_GetIPString,addr &#91;esi&#93;.GatewayList,addr szBuffer,sizeof szBuffer,FALSE<br />		.if	szBuffer<br />			invoke	SetDlgItemText,hWinMain,IDC_GATEWAY,addr szBuffer<br />		.endif<br />		.if	&#91;esi&#93;.DhcpEnabled<br />			invoke	_GetIPString,addr &#91;esi&#93;.DhcpServer,addr szBuffer,sizeof szBuffer,FALSE<br />			invoke	SetDlgItemText,hWinMain,IDC_DHCP,addr szBuffer<br />		.endif<br />		.if	&#91;esi&#93;.HaveWins<br />			invoke	_GetIPString,addr &#91;esi&#93;.PrimaryWinsServer,addr szBuffer,sizeof szBuffer,FALSE<br />			invoke	_GetIPString,addr &#91;esi&#93;.SecondaryWinsServer,addr szBuffer1,sizeof szBuffer,FALSE<br />			.if	szBuffer1<br />				invoke	lstrcat,addr szBuffer,addr szCrLf<br />				invoke	lstrcat,addr szBuffer,addr szBuffer1<br />			.endif<br />			invoke	SetDlgItemText,hWinMain,IDC_WINS,addr szBuffer<br />		.endif<br />		assume	esi&#58;nothing<br />		popad<br />		ret<br /><br />_ShowInfo	endp<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />_GetInfo	proc<br /><br />		.if	lpMemory<br />			invoke	GlobalFree,lpMemory<br />			mov	lpMemory,0<br />		.endif<br />		mov	ebx,IDC_ADPT<br />		.while	ebx &lt;=	IDC_DHCP<br />			invoke	SetDlgItemText,hWinMain,ebx,addr szNA<br />			inc	ebx<br />		.endw<br />		invoke	GetDlgItem,hWinMain,IDOK<br />		invoke	EnableWindow,eax,FALSE<br />		invoke	GlobalAlloc,GPTR,sizeof IP_ADAPTER_INFO<br />		.if	eax<br />			mov	lpMemory,eax<br />			mov	dwStructSize,sizeof IP_ADAPTER_INFO<br />			@@&#58;<br />			push	offset dwStructSize<br />			push	lpMemory<br />			call	lpGetInfo<br /><br />			.if	eax ==	ERROR_BUFFER_OVERFLOW<br />				invoke	GlobalReAlloc,lpMemory,dwStructSize,GMEM_MOVEABLE<br />				.if	! eax<br />					jmp	@F<br />				.endif<br />				mov	lpMemory,eax<br />				jmp	@B<br />			.elseif	eax ==	ERROR_SUCCESS<br />				push	lpMemory<br />				pop	lpInfo<br />				invoke	_ShowInfo<br />			.elseif	eax ==	ERROR_NO_DATA<br />				invoke	MessageBox,NULL,addr szErrNoAdapter,NULL,MB_OK or MB_ICONWARNING<br />			.endif<br />		.endif<br />		@@&#58;<br />		ret<br /><br />_GetInfo	endp<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />_ProcDlgMain	proc	uses ebx edi esi hWnd,wMsg,wParam,lParam<br /><br />		mov	eax,wMsg<br />		.if	eax ==	WM_COMMAND<br />			mov	eax,wParam<br />			.if	ax ==	IDOK<br />				mov	eax,lpInfo<br />				mov	eax,&#91;eax&#93;<br />				mov	lpInfo,eax<br />				invoke	_ShowInfo<br />			.elseif	ax ==	IDC_REFRESH<br />				invoke	_GetInfo<br />			.endif<br />		.elseif	eax ==	WM_CLOSE<br />			invoke	EndDialog,hWnd,NULL<br />		.elseif	eax ==	WM_INITDIALOG<br />			push	hWnd<br />			pop	hWinMain<br />			invoke	LoadIcon,hInstance,ICO_MAIN<br />			invoke	SendMessage,hWnd,WM_SETICON,ICON_BIG,eax<br />			invoke	_GetInfo<br />		.else<br />			mov	eax,FALSE<br />			ret<br />		.endif<br />		mov	eax,TRUE<br />		ret<br /><br />_ProcDlgMain	endp<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />start&#58;<br />		invoke	LoadLibrary,addr szDll<br />		.if	eax<br />			mov	hDll,eax<br />			invoke	GetProcAddress,eax,offset szGetInfo<br />			.if	eax<br />				mov	lpGetInfo,eax<br />			.endif<br />		.endif<br />		invoke	GetModuleHandle,NULL<br />		mov	hInstance,eax<br />		invoke	DialogBoxParam,hInstance,DLG_MAIN,NULL,offset _ProcDlgMain,NULL<br />		invoke	ExitProcess,NULL<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br /><br />end	start<br /><br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />&#58;make<br />set name=MAC_1<br /><br />    \masm32\bin\ml /c /coff %name%.bat<br />    \masm32\bin\rc %name%.rc<br />    \masm32\bin\Link /subsystem&#58;windows %name%.obj %name%.res<br />   <br />    if exist *.bak del *.bak<br />    if exist *.res del *.res<br />    if exist *.obj del *.obj<br />    echo.<br /><br /></code></pre><br />Mac_1.rc<br /><div class="quote"><br />//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />#include &lt;\masm32\include\resource.h&gt;<br />//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />#define	ICO_MAIN	1000<br />#define	DLG_MAIN	1000<br />#define IDC_ADPT	1001<br />#define IDC_TYPE	1002<br />#define IDC_MAC		1003<br />#define IDC_IP		1004<br />#define IDC_GATEWAY	1005<br />#define IDC_WINS	1006<br />#define IDC_DHCP	1007<br />#define IDC_REFRESH	1008<br />//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />ICO_MAIN	ICON		&quot;MAC_1.ico&quot;<br />//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />DLG_MAIN DIALOG 111, 104, 217, 136<br />STYLE DS_MODALFRAME | WS_POPUP | WS_VISIBLE | WS_CAPTION | WS_SYSMENU<br />CAPTION &quot;Net Adapters Information &quot;<br />FONT 9, &quot;MS Sans Serif&quot;<br />{<br /> LTEXT &quot;Adapter Name&quot;, -1, 7, 8, 60, 8<br /> EDITTEXT IDC_ADPT, 71, 5, 139, 12, ES_AUTOHSCROLL | WS_BORDER | WS_TABSTOP<br /> LTEXT &quot;Adapter Type&quot;, -1, 7, 24, 60, 8<br /> EDITTEXT IDC_TYPE, 71, 21, 139, 12, ES_AUTOHSCROLL | WS_BORDER | WS_TABSTOP<br /> LTEXT &quot;Adapter MAC Address&quot;, -1, 7, 40, 60, 8<br /> EDITTEXT IDC_MAC, 71, 37, 139, 12, ES_AUTOHSCROLL | WS_BORDER | WS_TABSTOP<br /> LTEXT &quot;IP Address&quot;, -1, 7, 56, 60, 8<br /> EDITTEXT IDC_IP, 71, 53, 139, 12, ES_MULTILINE | ES_AUTOHSCROLL | WS_BORDER | WS_VSCROLL | WS_TABSTOP<br /> LTEXT &quot;Gateway&quot;, -1, 7, 72, 60, 8<br /> EDITTEXT IDC_GATEWAY, 71, 69, 139, 12, ES_MULTILINE | ES_AUTOHSCROLL | WS_BORDER | WS_VSCROLL | WS_TABSTOP<br /> LTEXT &quot;WINS Server&quot;, -1, 7, 88, 60, 8<br /> EDITTEXT IDC_WINS, 71, 85, 139, 12, ES_MULTILINE | ES_AUTOHSCROLL | WS_BORDER | WS_VSCROLL | WS_TABSTOP<br /> LTEXT &quot;DHCP Server&quot;, -1, 7, 104, 60, 8<br /> EDITTEXT IDC_DHCP, 71, 101, 139, 12, ES_MULTILINE | ES_AUTOHSCROLL | WS_BORDER | WS_VSCROLL | WS_TABSTOP<br /> PUSHBUTTON &quot;Refurbish(&amp;R)&quot;, IDC_REFRESH, 35, 117, 70, 14<br /> PUSHBUTTON &quot;Next(&amp;N)&quot;, IDOK, 109, 117, 70, 14<br />}<br />//&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br /><br /></div></div>
    <div class="meta">Posted on 2005-02-02 09:51:32 by dcskm4200</div>
   </div>
   <div class="post" id="post-156608">
    <div class="subject"><a href="#post-156608">2 questions</a></div>
    <div class="body">thx it was pretty obvious that i could just declare my data at start of program. thats why i was asking whats the workaround.<br /><br />And i checked out that api from iphlpapi dll... <br />Do you have more specific info or perhaps a sample code..<br /><br />Although microsoft documented it pretty well here:<br />http://msdn.microsoft.com/library/en-us/iphlp/iphlp/ip_helper_function_reference.asp<br /><br />Edit: just saw your msg dcskm4200, thx.</div>
    <div class="meta">Posted on 2005-02-02 09:52:26 by pwn</div>
   </div>
   <div class="post" id="post-156609">
    <div class="subject"><a href="#post-156609">2 questions</a></div>
    <div class="body">awsome dude. worked like a charm. just had to a get some icon mac_1.ico and it was runing. thx again.</div>
    <div class="meta">Posted on 2005-02-02 09:59:37 by pwn</div>
   </div>
   <div class="post" id="post-156632">
    <div class="subject"><a href="#post-156632">2 questions</a></div>
    <div class="body"><div class="quote">I guess MASM only uses a one pass assembler... </div><br /><br />If this were true, you wouldn't be able to do forward jumps!  Right?  What's the differance between a forward jump and a call to a procedure declared later in the source code?  If there is no differance, then why doesn't MASM allow the later?<br /><br />Spara</div>
    <div class="meta">Posted on 2005-02-03 01:51:33 by Sparafusile</div>
   </div>
   <div class="post" id="post-156652">
    <div class="subject"><a href="#post-156652">2 questions</a></div>
    <div class="body">You can reference data later in the file using OFFSET. Using addr will only work for previously declared data.</div>
    <div class="meta">Posted on 2005-02-03 13:33:24 by QuantumMatrix1024</div>
   </div>
  </div>
 </body>
</html>