<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Update Edit Box Flickering - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=923" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=923">Update Edit Box Flickering</a></p>
   <div class="post" id="post-5950">
    <div class="subject"><a href="#post-5950">Update Edit Box Flickering</a></div>
    <div class="body">When I update an edit box constantly it appears to flicker if the content is the same as the new string. I wanted to get rid of this; so i wrote this code. It works fine, but after 10 or 11 seconds it just gives me the illegal opp box. I am just trying to have a few edit boxes showing the correct time... with no flicker.<br /><br />update:<br /><br />invoke GetSystemTime, addr systime<br /><br />invoke wsprintf, addr currhour, addr template, systime.wHour<br />invoke wsprintf, addr currmin, addr template, systime.wMinute<br />invoke wsprintf, addr currsec, addr template, systime.wSecond<br />invoke wsprintf, addr currdow, addr template, systime.wDayOfWeek<br />invoke wsprintf, addr currday, addr template, systime.wDay<br />invoke wsprintf, addr currmonth, addr template, systime.wMonth<br />invoke wsprintf, addr curryear, addr template, systime.wYear<br /><br />invoke GetDlgItemText, dialoguehand, EDIT_CURRSEC, addr buff, 8<br />invoke lstrcmp, addr buff, addr currsec<br /><br />.if eax != 0<br /><br />invoke SetDlgItemText,dialoguehand,EDIT_CURRSEC,addr currsec<br /><br />invoke GetDlgItemText, dialoguehand, EDIT_CURRMIN, addr buff, 8<br />invoke lstrcmp, addr buff, addr currmin<br /><br />.if eax != 0<br /><br />invoke SetDlgItemText,dialoguehand,EDIT_CURRMIN,addr currmin<br /><br />invoke GetDlgItemText, dialoguehand, EDIT_CURRHOUR, addr buff, 8<br />invoke lstrcmp, addr buff, addr currhour<br /><br />.if eax != 0<br /><br />invoke SetDlgItemText,dialoguehand,EDIT_CURRHOUR,addr currhour<br /><br />invoke GetDlgItemText, dialoguehand, EDIT_CURRDAY, addr buff, 8<br />invoke lstrcmp, addr buff, addr currday<br /><br />.if eax != 0<br /><br />invoke SetDlgItemText,dialoguehand,EDIT_CURRDOW,addr currdow<br />invoke SetDlgItemText,dialoguehand,EDIT_CURRDAY,addr currday<br /><br />invoke GetDlgItemText, dialoguehand, EDIT_CURRMONTH, addr buff, 8<br />invoke lstrcmp, addr buff, addr currmonth<br /><br />.if eax != 0<br /><br />invoke SetDlgItemText,dialoguehand,EDIT_CURRMONTH,addr currmonth<br /><br />invoke GetDlgItemText, dialoguehand, EDIT_CURRYEAR, addr buff, 8<br />invoke lstrcmp, addr buff, addr curryear<br /><br />.if eax != 0<br /><br />invoke SetDlgItemText,dialoguehand,EDIT_CURRYEAR,addr curryear<br /><br />.endif<br />.endif<br />.endif<br />.endif<br />.endif<br />.endif<br /><br />jmp update<br /><br />the idea is to only update the minutes if the seconds have changed, the hours if the minutes have changed, the days if the hours have changed etc. i think this is the best way to do it but if you know a better way then please let me know. I have no idea why it isnt working.<br /><br />thanks in advance.<br /><br />skud.</div>
    <div class="meta">Posted on 2001-09-03 10:30:29 by skud</div>
   </div>
   <div class="post" id="post-5962">
    <div class="subject"><a href="#post-5962">Update Edit Box Flickering</a></div>
    <div class="body">In your loop you never let Windows do its stuff.<br /><br />You should create a timer that fire an event every second<br />or so. I guess you run out of memory.<br /><br />KetilO</div>
    <div class="meta">Posted on 2001-09-03 13:43:23 by KetilO</div>
   </div>
   <div class="post" id="post-5963">
    <div class="subject"><a href="#post-5963">Update Edit Box Flickering</a></div>
    <div class="body">i create a new thread to do this.<br />all the other stuff is handled in the main thread.<br /><br />thanks anyway.<br />skud.</div>
    <div class="meta">Posted on 2001-09-03 14:07:06 by skud</div>
   </div>
  </div>
 </body>
</html>