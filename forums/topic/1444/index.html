<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Hook Problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1444" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1444">Hook Problem</a></p>
   <div class="post" id="post-9318">
    <div class="subject"><a href="#post-9318">Hook Problem</a></div>
    <div class="body">I have a keyboard hook system-wide installed.  Every key that is pressed gets intercepted so I can anylise during type-time.<br /><br />The problem, is that even when call keybd_event(...); the hook then doesn't capture the key that was pressed and released.  In other words, the I can know that a key was pressed, but if it's a simulated keystroke, it won't capture what keypress was simulated.<br /><br />Anyone have any ideas?  In utmost reality, it doesn't really matter if I intercept the simulated keys, I would hate for them to incedentally be intercepted again and trigger an endless loop, but for all intents and purposes, I would like to know why.<br /><br /><br />Also, I found a piece of software, <a target="_blank" href="www.fanix.com">www.fanix.com</a> it's a free download called hilitext.  Basically, you search for a word and it scans all text in all windows and highlights the word.<br /><br />Anyone know who to externally view text in a window so it can be manipulated?  What API's would I concentrate on?<br /><br /><br />Thanks,<br />_Shawn</div>
    <div class="meta">Posted on 2001-10-13 00:08:09 by _Shawn</div>
   </div>
   <div class="post" id="post-9319">
    <div class="subject"><a href="#post-9319">_Shawn__</a></div>
    <div class="body">Try using the low-level keyboard procedure.<br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/hooks_6fc3.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/hooks_6fc3.asp</a><br />This may help. It speaks of &quot;key injections&quot;.  <br />Also check out:<br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/win32/catfunc_26m1.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/win32/catfunc_26m1.asp</a><br /><br />Hope this helps</div>
    <div class="meta">Posted on 2001-10-13 00:22:25 by lackluster</div>
   </div>
  </div>
 </body>
</html>