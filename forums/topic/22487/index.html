<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Image Library DLL - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22487" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22487">Image Library DLL</a></p>
   <div class="post" id="post-168724">
    <div class="subject"><a href="#post-168724">Image Library DLL</a></div>
    <div class="body">Is there an image library such as Ernest Murphy&#39;s in dll form?</div>
    <div class="meta">Posted on 2005-12-09 22:09:26 by mikes</div>
   </div>
   <div class="post" id="post-168725">
    <div class="subject"><a href="#post-168725">Re: Image Library DLL</a></div>
    <div class="body">Yes if you want to write one using his functions.</div>
    <div class="meta">Posted on 2005-12-09 23:32:10 by hutch--</div>
   </div>
   <div class="post" id="post-168726">
    <div class="subject"><a href="#post-168726">Re: Image Library DLL</a></div>
    <div class="body"><div class="quote"><br />Yes if you want to write one using his functions.<br /></div><br /><br />I think he could have figured that out for himself. He wants to know if anyone already has one.</div>
    <div class="meta">Posted on 2005-12-10 00:17:47 by SpooK</div>
   </div>
   <div class="post" id="post-168727">
    <div class="subject"><a href="#post-168727">Re: Image Library DLL</a></div>
    <div class="body"><div class="quote"><br />Is there an image library such as Ernest Murphy&#39;s in dll form?<br /></div><br /><br />Mikes,<br /><br />It should not be difficult for you to code the DLL containing the routines of Ernest Murphy.</div>
    <div class="meta">Posted on 2005-12-10 02:36:16 by Vortex</div>
   </div>
   <div class="post" id="post-168728">
    <div class="subject"><a href="#post-168728">Re: Image Library DLL</a></div>
    <div class="body"><div class="quote"><br />I think he could have figured that out for himself. He wants to know if anyone already has one.<br /></div><br /><br />The next question would have been &quot;How do you write the DLL&quot;. The link below shows how its done.<br /><br />http://www.masmforum.com/simple/index.php?topic=3405.msg25696#msg25696<br /><br />Regards,<br /><br />hutch at movsd dot com</div>
    <div class="meta">Posted on 2005-12-10 03:00:29 by hutch--</div>
   </div>
   <div class="post" id="post-168735">
    <div class="subject"><a href="#post-168735">Re: Image Library DLL</a></div>
    <div class="body"><strong>mikes</strong>, just be sure to use one of the fixed versions of Ernie&#39;s image library; see http://www.asmcommunity.net/board/index.php?topic=22185.0<br /></div>
    <div class="meta">Posted on 2005-12-10 09:10:47 by f0dder</div>
   </div>
   <div class="post" id="post-168747">
    <div class="subject"><a href="#post-168747">Re: Image Library DLL</a></div>
    <div class="body">Many thanks for all of the help and suggestions.<br /><br />I downloaded from the link Hutch provided, and made the dll work.<br /><br />It appears that this download has the older buggy files.<br /><br />Not knowing how to use MASM (i&#39;m a FASM user), I don&#39;t know how the batch file works.<br /><br />I downloaded various newer versions of BitmapFromFile.asm etc. but don&#39;t know where to put them so that the new dll will have the latest stuff.<br /><br />In desperation, I renamed all copies of BitmapFromFile.asm so that masm couldn&#39;t find any and give an error. It never made an error.<br /><br />I just need a dll of Ernest Murphy&#39;s Image Library (with all of the bug fixes). Could someone please help.</div>
    <div class="meta">Posted on 2005-12-10 18:06:25 by mikes</div>
   </div>
   <div class="post" id="post-168753">
    <div class="subject"><a href="#post-168753">Re: Image Library DLL</a></div>
    <div class="body">If you don&#39;t have MASM set up then just use the DLL that is at the link I posted above, it already has the fixed versions of Ernie Murphy&#39;s procedures in it.</div>
    <div class="meta">Posted on 2005-12-10 22:40:01 by hutch--</div>
   </div>
   <div class="post" id="post-168754">
    <div class="subject"><a href="#post-168754">Re: Image Library DLL</a></div>
    <div class="body">Thanks again Hutch.<br /><br />The way it &quot;blows up&quot; is similar to the descriptions I have read on this forum describing known bugs.<br /><br />It works on 3-5 BitmapFromMemorys and then gives system errors.<br /><br />I have not seen any problem with BitmapFromFile as yet.<br /><br />It is really a neat dll, but is not usable with the problems. I had the impression that several people had eliminated the bugs.</div>
    <div class="meta">Posted on 2005-12-10 23:18:07 by mikes</div>
   </div>
   <div class="post" id="post-168755">
    <div class="subject"><a href="#post-168755">Re: Image Library DLL</a></div>
    <div class="body">I ran DepandencyWalker on the file and found 3 errors.<br /><br />The first was a missing dll (efsadu.dll)<br /><br />I downloaded this dll and 2 errors went away.<br /><br />No it says &quot;Warning: At least one module has an unresolved import due to a missing export function in a delay-load dependent module.&quot;<br /><br />This appears to be mpr.dll<br /><br />I have no idea what theses dlls do.<br /><br />I will try again with efsadu.dll installed.<br /><br />(edit)<br /><br />Installing efsadu.dll did not help things.</div>
    <div class="meta">Posted on 2005-12-10 23:42:32 by mikes</div>
   </div>
   <div class="post" id="post-168765">
    <div class="subject"><a href="#post-168765">Re: Image Library DLL</a></div>
    <div class="body">mikes,<br /><br />There is something wrong with what you have reported, below is the complete exports and imports in the DLL. I don&#39;t know where the extra DLLs you have mentioned have come from or hoe they are related to the known DLL in the import section of the DLL.<br /><span class="mono"><br /> Exp Addr Hint&nbsp;  Ord Export Name by murphy.dll - Sat Dec 10 19:53:17 2005<br /> -------- ---- ----- ---------------------------------------------------------<br /> 00001010&nbsp; &nbsp; 0&nbsp; &nbsp;  1 BitmapFromFile<br /> 000010E2&nbsp; &nbsp; 1&nbsp; &nbsp;  2 BitmapFromMemory<br /> 00001190&nbsp; &nbsp; 2&nbsp; &nbsp;  3 BitmapFromPicture<br /> 00001320&nbsp; &nbsp; 3&nbsp; &nbsp;  4 BitmapFromResource<br /><br /> Imp Addr Hint Import Name from gdi32.dll - Not Bound<br /> -------- ---- ---------------------------------------------------------------<br /> 00002000&nbsp;  22 CreateCompatibleDC<br /> 00002004&nbsp;  48 DeleteDC<br /> 00002008&nbsp;  4B DeleteObject<br /> 0000200C&nbsp;  AA GetDeviceCaps<br /> 00002010&nbsp; 12E SelectObject<br /> 00002014&nbsp;  21 CreateCompatibleBitmap<br /><br /> Imp Addr Hint Import Name from user32.dll - Not Bound<br /> -------- ---- ---------------------------------------------------------------<br /> 0000205C&nbsp;  ED GetDC<br /> 00002060&nbsp; 1D3 ReleaseDC<br /><br /> Imp Addr Hint Import Name from kernel32.dll - Not Bound<br /> -------- ---- ---------------------------------------------------------------<br /> 0000201C&nbsp; 1C6 MulDiv<br /> 00002020&nbsp; 25F SizeofResource<br /> 00002024&nbsp; 1B7 LockResource<br /> 00002028&nbsp; 1C7 MultiByteToWideChar<br /> 0000202C&nbsp; 23C SetLastError<br /> 00002030&nbsp; 2BF lstrlenA<br /> 00002034&nbsp;  A2 FindResourceA<br /> 00002038&nbsp; 1A9 LoadResource<br /><br /> Imp Addr Hint Import Name from ole32.dll - Not Bound<br /> -------- ---- ---------------------------------------------------------------<br /> 00002040&nbsp;  6B CreateStreamOnHGlobal<br /> 00002044&nbsp;  55 CoTaskMemFree<br /> 00002048&nbsp;  54 CoTaskMemAlloc<br /><br /> Imp Addr Hint Import Name from oleaut32.dll - Not Bound<br /> -------- ---- ---------------------------------------------------------------<br /> 00002050&nbsp;  2B OleLoadPicturePath<br /> 00002054&nbsp;  27 OleLoadPicture<br /></span></div>
    <div class="meta">Posted on 2005-12-11 06:03:04 by hutch--</div>
   </div>
   <div class="post" id="post-168769">
    <div class="subject"><a href="#post-168769">Re: Image Library DLL</a></div>
    <div class="body"><strong>hutch--</strong>, the dependency walker probably walks through the imported DLLs too, and has trouble with delay-load images... that would explain the behaviour.<br /><br /><strong>mikes</strong>, you shouldn&#39;t go off downloading DLLs like that. The two DLLs you mention are system DLLs, and you&#39;re pretty lucky if downloaded copies haven&#39;t been trojanized.<br /></div>
    <div class="meta">Posted on 2005-12-11 10:15:46 by f0dder</div>
   </div>
   <div class="post" id="post-168785">
    <div class="subject"><a href="#post-168785">Re: Image Library DLL</a></div>
    <div class="body">Thanks again for all of the help (esp Hutch).<br /><br />It is now working perfectly on both XP and 98.<br /><br />I re-downloaded the file that Hutch provided yesterday and used the dll that came with it without running the batch file.<br /><br />Running DependencyWalker on this file renders:<br /><br />1010, 10e2, 1190, and 1320 for the entry points. (It still gives the warning I mentioned earlier)<br /><br />If I execute the batch file, it produces a dll with 100c,10c0,158, and 12b8.<br /><br />My question is where are the files that the batch process uses? Obviously my system has some old &quot;Murphy&quot; files.<br /><br />I would really like to know this because I have the MASM source to an XYPlot that I would like very much to make into a dll.<br /><br />Mikes</div>
    <div class="meta">Posted on 2005-12-11 15:32:21 by mikes</div>
   </div>
   <div class="post" id="post-168789">
    <div class="subject"><a href="#post-168789">Re: Image Library DLL</a></div>
    <div class="body">mikes,<br /><br />You may have the older versions on your machine. I made sure I built the DLL using the fixed versions of Ernie Murphy&#39;s procedures. What I would suggest is to actually convert the 4 procedures directly to FASM so that you can build either the DLL or an EXE using the procedures directly with FASM. Some of the guys who worked on fixing the 4 procedures are FASM users so they may be able to help you doing the conversion.</div>
    <div class="meta">Posted on 2005-12-11 17:36:29 by hutch--</div>
   </div>
   <div class="post" id="post-168791">
    <div class="subject"><a href="#post-168791">Re: Image Library DLL</a></div>
    <div class="body">Where does the make process you provided assume the files are?<br /><br />I renamed every file on the machine to try and force an error, and no error occured.<br /><br />Thanks again for you help. The Image library using your dll is excellent, not to speak of compact.</div>
    <div class="meta">Posted on 2005-12-11 18:05:13 by mikes</div>
   </div>
   <div class="post" id="post-168794">
    <div class="subject"><a href="#post-168794">Re: Image Library DLL</a></div>
    <div class="body">The way MASM32 is set up, it works like this. Both the include files and libraries are written at the beginning of the asm file and the 4 procedures that Ernie Murphy wrote that were fixed are contained within the MASM32 library. The actual assembler code is no more than the barest shell of a DLL and the way the masm32 library procedures are included in the DLL is by adding their names into the DEF file which forces the linker to include the library module code as well.<br /><br />I have included the new versions of the procedures in the masm32 beta version 9.00 which you can get at URL http://www.masmforum.com/simple/index.php?topic=3374.0<br /><br />The DLL example that was posted earlier assumes it is on the same partition as the masm32 installation and it should build correctly from there.<br /><br />Now with the X Y Plotter code you have in MASM, be aware that masm code can be built in a number of ways and it may be done differently to how the default projects work in masm32 so you may need to write a batch file or similar to ensure it builds correctly. If you have any problems doing this, there are a lot of people around who know how to build most things in MASM. Depending on how the project is written, it may not be a big deal to port it to FASM either.<br /><br />Regards,<br /><br />hutch at movsd dot com</div>
    <div class="meta">Posted on 2005-12-11 19:19:55 by hutch--</div>
   </div>
   <div class="post" id="post-168796">
    <div class="subject"><a href="#post-168796">Re: Image Library DLL</a></div>
    <div class="body">Hutch,<br /><br />You have been very helpful, and I appreciate it.<br /><br />It looks like my MASM download is m32v82r.zip. Do I install version 9.00 on top of it or do I delete the old version first?<br /><br /><div class="quote"><br />and the 4 procedures that Ernie Murphy wrote that were fixed are contained within the MASM32 library<br /></div><br /><br />Aren&#39;t .lib files collections of .obj files like in C? If so, do you assemble the 4 Murphy files and build the .lib file?<br /><br />The XYPlot pgm I was talking about was written by a fellow from the Isle Of Man who did not know how to make a dll.<br /><br />It appears to be written in MASM.<br /><br />If someone can convert this to a .dll I would appreciate it, otherwise I will try it myself.<br /><br />I would think that the XYPlot in the form of a dll would be useful to many people, just as the ImageLib should be.<br /><br />The reason I am using FASM instead of MASM is that I am using it as a backend for my BASIC compiler and it is much smaller.</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1310" target="_blank">xyplotv1.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-12-11 20:23:46 by mikes</div>
   </div>
   <div class="post" id="post-168804">
    <div class="subject"><a href="#post-168804">Re: Image Library DLL</a></div>
    <div class="body">mikes,<br /><br />Remove the old installation or rename it if you have anything useful in it and install the new one. Put the &quot;murphy&quot; file in a directory on the same partition as the installation and it should build directly from the batch file.<br /><br />FASM is a good choice for a basic back end as it is fast enough and small enough.<br /><br />If you are going to convert the MASM exe to a DLL, you will have to make sure all of the prototypes as well as the procedures are done properly then make sure you export the procedures that need to be available to the DLL caller. This is done in the DEF file. There is a DLL skeleton script in the default editor in masm32 that you can use as a framework to move the stuff in the EXE into.</div>
    <div class="meta">Posted on 2005-12-12 02:50:28 by hutch--</div>
   </div>
  </div>
 </body>
</html>