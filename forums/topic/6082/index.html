<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Silly question.. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6082" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6082">Silly question..</a></p>
   <div class="post" id="post-43569">
    <div class="subject"><a href="#post-43569">Silly question..</a></div>
    <div class="body">Been trying to figure out how to get my applications name and path all in one string. I have searched for a while now (more than an hour), but could not find anything on this.<br /><br />In Delphi (please, refrain from tossing various fruits/vegetables at me), I can simply use Application.ExeName to get this. Of course, this is not so easy in ASM, which is understandable and one of the reasons I have taken on the task of learning ASM in the first place.<br /><br />I am using MASM and this program will be run on Win9x/ME machines only. So no need to take NT/2k/XP into account for this.<br /><br />I know GetModuleHandle() plays a role here somewhere, but using it has actually proved to be more confusing than I thought.<br /><br />Thanks in advance.</div>
    <div class="meta">Posted on 2002-06-16 10:04:03 by The Beginner</div>
   </div>
   <div class="post" id="post-43572">
    <div class="subject"><a href="#post-43572">Silly question..</a></div>
    <div class="body">Use GetCommandLine. If you'd read Iczelion's tutorials you would know that ;)</div>
    <div class="meta">Posted on 2002-06-16 10:20:40 by Dr. Manhattan</div>
   </div>
   <div class="post" id="post-43575">
    <div class="subject"><a href="#post-43575">Silly question..</a></div>
    <div class="body"><div class="quote"><br />Use GetCommandLine. If you'd read Iczelion's tutorials you would know that ;) </div><br /><br />Below are all of the tutorials listed on Iczelion's pages. Where in this list do you see something that hints at an example of getting your own executable's file name and path? I can only go so far alone, so I seek help when I cannot solve a problem on my own. Other than that, I have done most of what I have accomplished with the help of these tutorials and from playing around with ideas. Just asking for a little help is all, or maybe a hint. And still not sure how GetCommandLine() will help me here...  and I -do- have the latest Win32 help files.<br /><br />Tutorial 1: The Basics<br />Tutorial 2: MessageBox<br />Tutorial 3: A Simple Window<br />Tutorial 4: Painting with Text<br />Tutorial 5: More about Text<br />Tutorial 6: Keyboard Input<br />Tutorial 7: Mouse Input<br />Tutorial 8: Menu<br />Tutorial 9: Child Window Controls<br />Tutorial 10: Dialog Box as Main Window<br />Tutorial 11: More about Dialog Box<br />Tutorial 12: Memory Management and File I/O<br />Tutorial 13: Memory Mapped File<br />Tutorial 14: Process<br />Tutorial 15: Multithreading Programming<br />Tutorial 16: Event Object<br />Tutorial 17: Dynamic Link Libraries<br />Tutorial 18: Common Controls<br />Tutorial 19: Tree View Control<br />Tutorial 20: Window Subclassing<br />Tutorial 21: Pipe<br />Tutorial 22: Window Superclassing<br />Tutorial 23: Tray Icon<br />Tutorial 24: Windows Hooks<br />Tutorial 25: Simple Bitmap<br />Tutorial 26: Splash Screen<br />Tutorial 27: Tooltip Control<br />Tutorial 28: Win32 Debug API part 1<br />Tutorial 29: Win32 Debug API part 2<br />Tutorial 30: Win32 Debug API part 3<br />Tutorial 31: Listview Control<br />Tutorial 32: Multiple Document Interface (MDI)<br />Tutorial 33: RichEdit Control: Basics <br />Tutorial 34: RichEdit Control: More Text Operations <br />Tutorial 35: RichEdit Control: Syntax Hilighting</div>
    <div class="meta">Posted on 2002-06-16 10:31:05 by The Beginner</div>
   </div>
   <div class="post" id="post-43578">
    <div class="subject"><a href="#post-43578">Silly question..</a></div>
    <div class="body">Tutorial 35.<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=106&amp;highlight=getmodulehandle+getmodulefilename">http://www.asmcommunity.net/board/index.php?topic=106&amp;highlight=getmodulehandle+getmodulefilename</a><br /><br />Look up GetModuleHandle and GetModuleFilename in your API reference.</div>
    <div class="meta">Posted on 2002-06-16 10:49:35 by bazik</div>
   </div>
   <div class="post" id="post-43579">
    <div class="subject"><a href="#post-43579">Silly question..</a></div>
    <div class="body">Sorry if I offended you, I didn't mean to. It's in Tutorial 3 &quot;A simple Window&quot;<br /><br />&quot;I'll outline the steps required to create a window on the desktop below<br /><br />1. Get the instance handle of your program (required)<br />--&gt; 2. Get the command line (not required unless your program wants to process a command line)&quot;<br /><br />The name of  the executable (path and executable name) is the first argument of the command line. There is also a function in the MASM32 library, GetCL. Look in the \MASM32\M32Lib directory. Good luck ! :alright:</div>
    <div class="meta">Posted on 2002-06-16 10:49:53 by Dr. Manhattan</div>
   </div>
   <div class="post" id="post-43580">
    <div class="subject"><a href="#post-43580">Silly question..</a></div>
    <div class="body">You can always use GetModuleFileName to retrieve the &quot;fullpath\app.exe&quot; form of your running instance.<br /><br />If you want the path and the executable's name seperately, just code a parsing procedure which seeks the last &quot;\&quot; in the string.</div>
    <div class="meta">Posted on 2002-06-16 10:51:02 by C.Z.</div>
   </div>
   <div class="post" id="post-43581">
    <div class="subject"><a href="#post-43581">Silly question..</a></div>
    <div class="body"><div class="quote"><br />You can always use GetModuleFileName to retrieve the &quot;fullpath\app.exe&quot; form of your running instance.<br /><br />If you want the path and the executable's name seperately, just code a parsing procedure which seeks the last &quot;\&quot; in the string. </div><br /><br />bomb01:<br /><br />Thanks for the hint. Here is what I was trying to use before posting my message..  I thought I had pasted it into the text box, but I guess I missed it.<br /><br /><pre><code><br />GetMyPathName proc  ;*** Get application path/name<br />  invoke GetModuleFileName, NULL, MyRealName, SizeOf MyRealName<br />  invoke MessageBox, hWnd, addr MyRealName, addr myCaption, MB_ICONINFORMATION or MB_APPLMODAL<br />  ret<br />GetMyPathName endp</code></pre><br /><br />Now, being new to this, I know the above code is most likely wrong in a lot of ways. I guess I am just trying to figure out HOW to get the name in to a message box so that I can learn to work with the GetModuleFileName() procedure. It is a slow method of self-teaching, but it works for me.<br /><br />Thanks again.</div>
    <div class="meta">Posted on 2002-06-16 10:59:53 by The Beginner</div>
   </div>
   <div class="post" id="post-43587">
    <div class="subject"><a href="#post-43587">Silly question..</a></div>
    <div class="body">your just missing an addr in your GetModuleFileName call<br /><br />invoke GetModuleFileName,NULL,addr MyRealName,sizeof MyRealName<br /><br />its not a silly question. ive been here for over a year and i still ask stupid questions.</div>
    <div class="meta">Posted on 2002-06-16 11:34:07 by smurf</div>
   </div>
   <div class="post" id="post-43604">
    <div class="subject"><a href="#post-43604">Silly question..</a></div>
    <div class="body">The only stopid question is the one you never ask.<br /><br />Now THATS just being silly!</div>
    <div class="meta">Posted on 2002-06-16 14:58:43 by Ernie</div>
   </div>
   <div class="post" id="post-43618">
    <div class="subject"><a href="#post-43618">Silly question..</a></div>
    <div class="body"><div class="quote"><br />your just missing an addr in your GetModuleFileName call<br /><br />invoke GetModuleFileName,NULL,addr MyRealName,sizeof MyRealName<br /><br />its not a silly question. ive been here for over a year and i still ask stupid questions. </div><br /><br />Thank you very much, this was exactly the problem and the solution. I tend to forget to use addr now and then, but I am getting used to it now through trial and error.<br /><br />Thanks again!</div>
    <div class="meta">Posted on 2002-06-16 16:15:58 by The Beginner</div>
   </div>
   <div class="post" id="post-43640">
    <div class="subject"><a href="#post-43640">Silly Question</a></div>
    <div class="body">Hello all.<br />It is the sarcastic remarks some of the &quot;expert&quot; coders give to the newbies that turn them off using this board to ask questions.<br />I have searched the Help files many times and not found, or missed the answer. I always thought this Board was to help Coders, experienced or not.<br />Bob. :confused:</div>
    <div class="meta">Posted on 2002-06-16 18:46:45 by BobMcK</div>
   </div>
   <div class="post" id="post-43669">
    <div class="subject"><a href="#post-43669">Silly question..</a></div>
    <div class="body"><div class="quote"><br />your just missing an addr in your GetModuleFileName call<br /><br />invoke GetModuleFileName,NULL,addr MyRealName,sizeof MyRealName<br /><br />its not a silly question. ive been here for over a year and i still ask stupid questions. </div><br /><br />Isn't the first parameter of GetModuleFileName the module handle? I think it has to be 400000h anyway...</div>
    <div class="meta">Posted on 2002-06-16 23:41:08 by C.Z.</div>
   </div>
   <div class="post" id="post-43670">
    <div class="subject"><a href="#post-43670">Silly question..</a></div>
    <div class="body"><div class="quote">Handle to the module whose executable filename is being requested. If this parameter is NULL, GetModuleFileName returns the path for the file used to create the calling process</div> <br />So if you are using NULL it may work but when another program is used to start your program it will give the address of that program.<br />Just use the value returned by GetModuleHandle, NULL<br /><br /><strong>EDIT</strong> <br />wait maybe &quot;file used to create the calling process&quot; Dose mean the program's executable and not some other program that ran the program.</div>
    <div class="meta">Posted on 2002-06-16 23:48:03 by Kudos</div>
   </div>
   <div class="post" id="post-43678">
    <div class="subject"><a href="#post-43678">Silly question..</a></div>
    <div class="body">Kudos, thank you for this info.:grin:</div>
    <div class="meta">Posted on 2002-06-17 00:17:28 by C.Z.</div>
   </div>
   <div class="post" id="post-43783">
    <div class="subject"><a href="#post-43783">Silly question..</a></div>
    <div class="body"><div class="quote"><br /> <br />So if you are using NULL it may work but when another program is used to start your program it will give the address of that program.<br />Just use the value returned by GetModuleHandle, NULL<br /><br /><strong>EDIT</strong> <br />wait maybe &quot;file used to create the calling process&quot; Dose mean the program's executable and not some other program that ran the program. </div><br /><br /><div class="quote"><br />Parameters<br /><br />hModule<br /><br />Identifies the module whose executable filename is being requested. If this parameter is NULL, GetModuleFileName returns the path for the file used to create the calling process.</div><br /><br />You are absolutely right. If it is left null, and you create the process with another application, it will return the initiator's path and file name.<br /><br />I tested this by making a small app to spawn the app I am working on in (M)ASM, and I invoked a MessageBox to see what it would return. It returned the calling application's path and filename.<br /><br />Now, I am not sure if this holds true across different platforms, but it -did- behave this way on my WinME machine and my Win98SE machine.<br /><br />Anyone else have a similar result?</div>
    <div class="meta">Posted on 2002-06-17 10:04:00 by The Beginner</div>
   </div>
  </div>
 </body>
</html>