<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Don't understand error in this program - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26011" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26011">Don't understand error in this program</a></p>
   <div class="post" id="post-189548">
    <div class="subject"><a href="#post-189548">Don't understand error in this program</a></div>
    <div class="body">Well I have looked the program up and down, and although something is being read from memory wrong I can&#39;t figure out why it happens.<br /><br />This code works perfectly fine:<br /><br /><pre><code><br />title Problem1.asm (Problem1.asm)<br /><br />.model small<br /><br />.stack 100h<br /><br />.data<br /><br />	string	&nbsp;  db &#39;Reversal Power!&#39;, &#39;$&#39; ;if no single quotes, then operator is missing<br />	stringSize dw ?<br /><br />.code<br />	<br />	;mov ds, @data Why can&#39;t this be done?--Can&#39;t move address into segment register apparently<br />	;Setting up data segment<br />	mov ax, @data		;what is this @ syntax<br />	mov ds, ax<br /><br />	;Outputting original string<br /> 	mov ax,0900h<br /> 	mov dx,offset string<br /> 	int 21h<br /><br /><br />	;Positioning address of bx at the null character<br /><br />	mov bx, offset string&nbsp; ;setting bx equal to offset of string<br /><br />	NULLsearch:<br />		<br />		mov ax, 		;NOTICE;can&#39;t compare indirect address and immediate operand,  moved to register<br />		cmp ax, &#39;$&#39;			;comparing contents of bx to the null character<br />		je end_NULLsearch<br /><br />		inc bx<br /><br />		jmp NULLsearch<br /><br />	end_NULLsearch:<br /><br />		mov dl, 0Ah<br />		mov ah, 2<br />		int 21h<br /><br />		mov dl, 0Dh<br />		mov ah, 2<br />		int 21h<br /><br />	print:<br /><br />		cmp bx, offset string<br />		je end_print<br /><br />		dec bx<br /><br />		mov dl, <br />		mov ah, 2<br />		int 21h<br /><br />		jmp print<br /><br />	end_print:<br /><br /><br /><br /><br />	;exiting the program<br />	mov ax, 4C00h<br />	int 21h					;not putting an h here, messes the program up...why<br /><br />end<br /></code></pre><br /><br />But as soon as I try to remove stringSize dw ?, since it&#39;s no longer needed with my new algorithm, the program goes to hell:<br /><br /><pre><code><br />title Problem1.asm (Problem1.asm)<br /><br />.model small<br /><br />.stack 100h<br /><br />.data<br /><br />	string	&nbsp;  db &#39;Reversal Power!&#39;, &#39;$&#39; ;if no single quotes, then operator is missing<br />	;stringSize dw ? ;*************************This guy********************<br /><br />.code<br />	<br />	;mov ds, @data Why can&#39;t this be done?--Can&#39;t move address into segment register apparently<br />	;Setting up data segment<br />	mov ax, @data		;what is this @ syntax<br />	mov ds, ax<br /><br />	;Outputting original string<br /> 	mov ax,0900h<br /> 	mov dx,offset string<br /> 	int 21h<br /><br /><br />	;Positioning address of bx at the null character<br /><br />	mov bx, offset string&nbsp; ;setting bx equal to offset of string<br /><br />	NULLsearch:<br />		<br />		mov ax, 		;NOTICE;can&#39;t compare indirect address and immediate operand,  moved to register<br />		cmp ax, &#39;$&#39;			;comparing contents of bx to the null character<br />		je end_NULLsearch<br /><br />		inc bx<br /><br />		jmp NULLsearch<br /><br />	end_NULLsearch:<br /><br />		mov dl, 0Ah<br />		mov ah, 2<br />		int 21h<br /><br />		mov dl, 0Dh<br />		mov ah, 2<br />		int 21h<br /><br />	print:<br /><br />		cmp bx, offset string<br />		je end_print<br /><br />		dec bx<br /><br />		mov dl, <br />		mov ah, 2<br />		int 21h<br /><br />		jmp print<br /><br />	end_print:<br /><br /><br /><br /><br />	;exiting the program<br />	mov ax, 4C00h<br />	int 21h					;not putting an h here, messes the program up...why<br /><br />end<br /><br /><br /></code></pre><br /><br />I have no idea why. Hopefully someone can lead me in the right direction here.<br /><br />Thanks guys.<br /></div>
    <div class="meta">Posted on 2007-06-08 00:46:29 by WinterMute</div>
   </div>
   <div class="post" id="post-189549">
    <div class="subject"><a href="#post-189549">Re: Don't understand error in this program</a></div>
    <div class="body">This is happening because you&#39;re loading a word at a time with &quot;mov ax,&quot;, then comparing that word with &#39;$&#39;, instead of loading a byte at a time with &quot;mov al,&quot;, then comparing that byte with &#39;$&#39;.&nbsp; Since you&#39;re not using stringSize and the default value is usually 0, when it&#39;s there, the value of the word at the $ is a byte of &#39;$&#39; followed by a byte of 0, making the value of the word &#39;$&#39;.&nbsp; Without stringSize there, it may there may not be a 0 after the string, and in that case your code won&#39;t find the end there.&nbsp; I didn&#39;t notice any other problems.<br /><br />Just change:<br /><pre><code><br />mov&nbsp; &nbsp;  ax,<br />cmp&nbsp; &nbsp;  ax,&#39;$&#39;<br /></code></pre><br />to:<br /><pre><code><br />mov&nbsp; &nbsp;  al,<br />cmp&nbsp; &nbsp;  al,&#39;$&#39;<br /></code></pre><br /><br />Cheers&nbsp; ;)</div>
    <div class="meta">Posted on 2007-06-08 01:36:10 by hackulous</div>
   </div>
   <div class="post" id="post-189552">
    <div class="subject"><a href="#post-189552">Re: Don't understand error in this program</a></div>
    <div class="body">mov ax, &nbsp; ;you&#39;re loading 2 bytes<br />cmp ax, &#39;$&#39;&nbsp; &nbsp; &nbsp;;you&#39;re comparing 2bytes with one byte, so I presume the <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;second is filled in as a zero at assembly time, (as WM says)<br /><br /><br />The bytecode for $ is 24<br />try<br /><br />mov al,<br />cmp al,&#39;$&#39;<br /><br />EDIT:<br />A dubble post really...I get all excited if there&#39;s something I might know <br />the answer to.<br /></div>
    <div class="meta">Posted on 2007-06-08 04:27:09 by eek</div>
   </div>
  </div>
 </body>
</html>