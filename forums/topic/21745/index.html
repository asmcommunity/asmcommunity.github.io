<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>tabled case insensitive string comparing - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21745" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=21745">tabled case insensitive string comparing</a></p>
   <div class="post" id="post-164069">
    <div class="subject"><a href="#post-164069">tabled case insensitive string comparing</a></div>
    <div class="body">hi!<br />here is the case insesitive string comparing using characters table. i&#39;m not sure it works like lstrcmpi, but it gives ability to compare strings contained national characters, which can be spreaded in upper ascii part in non alphabetical order. although i do not familiar with languages other english you can easy rebuild table to your using fasm compiler. currently it compares english and ukrainian/russian/belorussian/bulgarian via &quot;mixed&quot; alphabet. when proper chars are compared result can be used for alphabetical sorting. any non-alphabetical character will be always greater or smaller then any alphabetical depending on factor, passed to function.<br /><br />made between work, may contain errors :) regards!</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=913" target="_blank">strcmpi.3.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-09-02 06:53:12 by Shoo</div>
   </div>
   <div class="post" id="post-164076">
    <div class="subject"><a href="#post-164076">Re: tabled case insensitive string comparing</a></div>
    <div class="body">Good afternoon, Shoo<br /><br />How did i translate it into masm?<br /><br />regards</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=915" target="_blank">cmp.rar</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-09-02 09:47:11 by dcskm4200</div>
   </div>
   <div class="post" id="post-164078">
    <div class="subject"><a href="#post-164078">Re: tabled case insensitive string comparing</a></div>
    <div class="body">Hi Shoo and dcskm4200.<br /><br />Here is my updated version of table lookup algo I&#39;ve posted in &quot;Faster Strncmpi&quot;.<br />Deals with English\Russian\Ukrainian characters but its very easy to adapt it for other codepages. <br />Delphi code that generates table automatically included (as comment).<br /><br />Results (P4-2400 i845G):<br /><pre><code><br />All cases match...<br />Average execution time: 451 cycles.<br /><br />All cases dont match...<br />Average execution time: 720 cycles. <br /></code></pre><br /><br />Best Regards...</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=916" target="_blank">StrCmpi.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-09-02 10:46:20 by Bohdan</div>
   </div>
   <div class="post" id="post-164080">
    <div class="subject"><a href="#post-164080">Re: tabled case insensitive string comparing</a></div>
    <div class="body">Hello,Bohdan<br /><br />the tested result<br /><div class="quote"><br />Hit any key to start ...<br />All cases match...<br />Average execution time: 383 cycles.<br /><br />All cases dont match...<br />Average execution time: 548 cycles.<br /></div><br /><br />regards</div>
    <div class="meta">Posted on 2005-09-02 11:02:33 by dcskm4200</div>
   </div>
   <div class="post" id="post-164085">
    <div class="subject"><a href="#post-164085">Re: tabled case insensitive string comparing</a></div>
    <div class="body">Here is a little improvement to my algo.<br /><br /> 1) Lookup table is automatically generated according to current codepage ( StrCmpiBuitdTable )<br /> 2) Better instructions pairability<br /><br />Can by buggy, need&#39;s testing.<br />Regards...</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=918" target="_blank">StrCmpi.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-09-02 14:34:22 by Bohdan</div>
   </div>
   <div class="post" id="post-164115">
    <div class="subject"><a href="#post-164115">Re: tabled case insensitive string comparing</a></div>
    <div class="body">hi dcskm4200<br />i&#39;ll do masm equiv for you, but while you should fed fasm into you armory ;)<br />regards!</div>
    <div class="meta">Posted on 2005-09-03 06:08:49 by Shoo</div>
   </div>
   <div class="post" id="post-164118">
    <div class="subject"><a href="#post-164118">Re: tabled case insensitive string comparing</a></div>
    <div class="body">Hello,Shoo<br /><br />Thanks for you&#39;ll do.<br /><br />as a newbie, I think I just started up the long hard process. i&#39;m tiring now. if i&#39;ll take fasm into my armory, my brain can&#39;t provide any energy for me.&nbsp; <br /><br />best regards.<br /></div>
    <div class="meta">Posted on 2005-09-03 06:45:05 by dcskm4200</div>
   </div>
   <div class="post" id="post-164217">
    <div class="subject"><a href="#post-164217">Re: tabled case insensitive string comparing</a></div>
    <div class="body">hi dcskm4200<br /><br />1.here is a working converted source - only as example, because i&#39;ll refuse of it and will use xlat (i&#39;ll start to code it when i will imagine it clear in the head)<br />2.imho converting sources from one compiler to another is more harder then just have many compilers and use appropriate one for the source<br />3.i&#39;m surprising you are interesting with uppercasing cyrillic letters :) or you are just interesting with algo? also programming is just my hobby, so i can not say my code is always correct ;)<br /><br />regards!</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=929" target="_blank">cmp.1.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-09-05 00:40:49 by Shoo</div>
   </div>
   <div class="post" id="post-164218">
    <div class="subject"><a href="#post-164218">Re: tabled case insensitive string comparing</a></div>
    <div class="body">I guess we can all agree that code not supporting international characters isn&#39;t all so very useful.<br /><br />A table-based approach should be pretty universal, at least as long as we are dealing with single-byte-per-character strings. This probably works with everything except japanese and chinese?<br /><br />How about speed, though - for a straight-forward table we&#39;d need 256 bytes for an uppercase table, and 256 bytes for a lowercase one (if we decide to use the tables for more than just case-insensitive compare). This must affect speed some because of cache, and of course because of memory dependency...<br /><br />Another approach could be generating the routines on-the-fly... this would require detecting which range(s) that change between upper and lower case (or are all alphabets contiguous? I think not).<br /><br />Unicode would be more universal, but it probably isn&#39;t very suitable to implement with tables...<br /></div>
    <div class="meta">Posted on 2005-09-05 02:02:39 by f0dder</div>
   </div>
   <div class="post" id="post-164219">
    <div class="subject"><a href="#post-164219">Re: tabled case insensitive string comparing</a></div>
    <div class="body">Hey, Shoo<br /><br />Thanks you very much.<br /><br />it works fine.<br />by the way, I also appreciate your travesty. not only you are a coder, but also are an artist. <br /><br />best regards<br /></div>
    <div class="meta">Posted on 2005-09-05 02:06:29 by dcskm4200</div>
   </div>
   <div class="post" id="post-164220">
    <div class="subject"><a href="#post-164220">Re: tabled case insensitive string comparing</a></div>
    <div class="body">f0dder, there is no such thing as uppercase and lowercase in Chinese. I think the same thing applies to Japanese.&nbsp; ;)</div>
    <div class="meta">Posted on 2005-09-05 02:09:53 by roticv</div>
   </div>
   <div class="post" id="post-164224">
    <div class="subject"><a href="#post-164224">Re: tabled case insensitive string comparing</a></div>
    <div class="body">Hello,roticv<br /> <br />although there isn&#39;t such thing as uppercase and lowercase in Chinese. but there is that thing as tradition and simplify in chinese. here is a software that do this.<br /><br />regards <br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=930" target="_blank">N_S-chinese.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-09-05 03:30:00 by dcskm4200</div>
   </div>
   <div class="post" id="post-164226">
    <div class="subject"><a href="#post-164226">Re: tabled case insensitive string comparing</a></div>
    <div class="body"><div class="quote"><br />f0dder, there is no such thing as uppercase and lowercase in Chinese. I think the same thing applies to Japanese.&nbsp; ;)<br /></div><br /><br />Ah, thinking of it, that makes sense - ideographs and such. Shows how much of a b**** it can be to support foreign languages correctly :)<br /></div>
    <div class="meta">Posted on 2005-09-05 04:20:10 by f0dder</div>
   </div>
   <div class="post" id="post-164228">
    <div class="subject"><a href="#post-164228">Re: tabled case insensitive string comparing</a></div>
    <div class="body">i think for multybyte chars calculation is needed, or mixed method. btw in japanese there are katakana and hiragana which grafically differ but sound same.<br />what about tables, which are fitting into 256, some tables are needed, at least 3-4:<br />1.uppercasing<br />2.lowercasing<br />3.comparing with returning sort value<br />1&amp;2 are clear, 3 - char code should be converted not into appropriate case, but into order value according to alphabet position of this char. why i said 3-4 - it is possible to have 2 tables where one will contain non-alphabetic characters before alphabetic, and another - vice versa (it is not good when alphabetic characters will be separated or embraced with non-alph). commonly, it is possible to have many such tables, just pass to function the pointer to needed table.<br /><br />also, for speed, it is good to have a separate function for partial uppercasing: for example, you have template name in data and sure it is lowercase - why function have to calculate case for it each cycle? it will do it only for second (unknown) string.<br /><br />here is a code not runned yet:<br /><pre><code>proc tstrcmp a_str, b_str, x_tab ; asciiz<br />;-----------------------------------------------------------------------<br />&nbsp; &nbsp; push ebx<br />&nbsp; &nbsp; push esi<br />&nbsp; &nbsp; push edi<br />;-----------------------------------------------------------------------<br />&nbsp; &nbsp; mov ebx,<br />&nbsp; &nbsp; mov esi,<br />&nbsp; &nbsp; mov edi,<strong><br />;-----------------------------------------------------------------------<br />.next:&nbsp; &nbsp; <br />&nbsp; &nbsp; lodsb<br />&nbsp; &nbsp; test al,al<br />&nbsp; &nbsp; jne @F<br />&nbsp; &nbsp; sub al,<br />&nbsp; &nbsp; jmp .finish<br />@@:<br />&nbsp; &nbsp; movzx edx,<br />&nbsp; &nbsp; xlatb<br />&nbsp; &nbsp; inc edi<br />&nbsp; &nbsp; sub al,<br />&nbsp; &nbsp; jz&nbsp; .next<br />.finish:<br />&nbsp; &nbsp; movsx eax,al<br />;-----------------------------------------------------------------------<br />&nbsp; &nbsp; pop edi<br />&nbsp; &nbsp; pop esi<br />&nbsp; &nbsp; pop ebx&nbsp; &nbsp; <br />;-----------------------------------------------------------------------<br />&nbsp; &nbsp; ret<br />;-----------------------------------------------------------------------<br />endp<br /></code></pre></div>
    <div class="meta">Posted on 2005-09-05 05:07:27 by Shoo</div>
   </div>
   <div class="post" id="post-164229">
    <div class="subject"><a href="#post-164229">Re: tabled case insensitive string comparing</a></div>
    <div class="body">Hi Shoo!<br /><br /><div class="quote"><br />what about tables, which are fitting into 256, some tables are needed, at least 3-4:<br />1.uppercasing<br />2.lowercasing<br />3.comparing with returning sort value<br /></div><br /><br />Can anybody tell me, why we need separated tables 1 &amp; 2 ???</div>
    <div class="meta">Posted on 2005-09-05 05:43:54 by Bohdan</div>
   </div>
   <div class="post" id="post-164230">
    <div class="subject"><a href="#post-164230">Re: tabled case insensitive string comparing</a></div>
    <div class="body">try to guess ;)<br />--------<br />in real, although topic is about comparing, i&#39;m thinking about uppercasing/lowercasing also - to do it fast separate tables needed. also, if you have already uppercased word - you can call function which will uppercase only second word, same for lowercased word, and this can be done with one function by passing to it pointer to appropriate table.<br />(also i&#39;m thinking about different string formats also: do you know a story about young and old buffalos and some cows beyound the little river ;) )</div>
    <div class="meta">Posted on 2005-09-05 05:57:02 by Shoo</div>
   </div>
  </div>
 </body>
</html>