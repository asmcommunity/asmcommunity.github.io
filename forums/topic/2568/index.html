<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Namesorting Hutch's Quicksort, Sorts Lastnames now!, does an - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2568" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2568">Namesorting Hutch's Quicksort, Sorts Lastnames now!, does an</a></p>
   <div class="post" id="post-16265">
    <div class="subject"><a href="#post-16265">Namesorting Hutch's Quicksort, Sorts Lastnames now!, does an</a></div>
    <div class="body">Well if you've looked on the board earlier you saw me struggling to make it sort Lastnames, Well I got it to sort lastnames, I wonder if anyone like to help me make it sort Last and First Names.<br />Namesort.asm is an assembly procedure for a Visual C++ program<br />the structure it's using is this<br /><br />struct names {<br />        <br />        char lastname[16];<br />        char firstname[12];<br />        int  age;<br />};<br /><br /><br />I have included my files, too if anybody wants to play with it,<br />but maybe someone has an better idea with macros<br />The C++ file has it's file named to  NameSortCGI.txt<br />And you also need the two ASM file Namesort.asm and PointerStructs.asm below too<br />There also more instructions on how to set these files up in the<br />Sorting samples I've posted in Algorithms.<br /><br />Thanks Andy<br /><br />:)</div>
    <div class="meta">Posted on 2001-12-26 18:57:45 by andy981</div>
   </div>
   <div class="post" id="post-16266">
    <div class="subject"><a href="#post-16266">Here is attachment Namesort.asm and it sorts now</a></div>
    <div class="body">Here is attachment Namesort.asm and it sorts now</div>
    <div class="meta">Posted on 2001-12-26 19:00:17 by andy981</div>
   </div>
   <div class="post" id="post-16267">
    <div class="subject"><a href="#post-16267">Here is attachment PointersStruct.asm</a></div>
    <div class="body">Here is attachment PointersStruct.asm</div>
    <div class="meta">Posted on 2001-12-26 19:02:32 by andy981</div>
   </div>
   <div class="post" id="post-16291">
    <div class="subject"><a href="#post-16291">I solved it, It sorts now!</a></div>
    <div class="body">.386<br />.MODEL flat, C<br /><br />;C function<br />EXTERN  malloc:NEAR<br />EXTERN  free:NEAR<br />EXTERN strcmp:NEAR<br />EXTERN printf:NEAR<br /><br />.DATA<br />formatd db &quot;%d&quot;,0<br />format1 db &quot;%s&quot;,0<br />format2 db &quot;%s&quot;,0<br />.CODE<br />NameSort PROC  proc C Arr:DWORD,count:DWORD<br />    <br />    LOCAL First :DWORD<br />    LOCAL Last  :DWORD<br />    LOCAL cntr  :DWORD<br />    LOCAL bLen  :DWORD<br />    LOCAL hMem  :DWORD<br />    LOCAL temp  :DWORD<br />	<br />    push ebx<br />    push esi<br />    push edi<br /><br />    mov cntr, 0<br /><br />    mov esi,Arr              ; source address in ESI<br />   <br />  ; --------------------------<br />  ; allocate temporary buffer<br />  ; --------------------------<br />    mov eax, count<br /><br />	mov eax, 10<br />    add eax, 40<br />    mov bLen, eax<br />    ;invoke SysAllocStringByteLen,0,bLen<br /><br />	push bLen<br />	call malloc<br />    mov hMem, eax<br /><br />    mov edi, hMem             ; buffer address in EDI<br /><br />  ; ------------------------------------<br />  ; set First and Last reference values<br />  ; ------------------------------------<br />    mov First, 0<br />    mov eax, count<br />    dec eax<br />    mov Last, eax             ; Last = count - 1<br /><br />  outer_loop:<br />  ; -------------------<br />  ; calculate midpoint<br />  ; -------------------<br />    mov eax, Last<br />    add eax, First<br />    shr eax, 1<br />  ; =========================<br />    mov ebx,       ; midpoint in EBX<br />    mov temp, ebx<br /><br /> <br /><br />  ; =========================<br />    mov ecx, First<br />    mov edx, Last<br />  ; ---------------------------------------------------------<br />  inner_loop:<br />  	push ebx<br />	push ecx<br />	push edx<br />	mov eax,ebx<br />	push eax<br />	mov eax,<br />	push eax<br />	call strcmp<br />    pop ebx<br />    pop ebx<br />	pop  edx<br />	pop  ecx<br />	pop  ebx<br /><br />    <br />	<br /><br />    ;cmp , ebx<br />	<br />    ;jge wl2<br />	cmp eax,0<br />	jge wl2<br />	<br />    inc ecx<br />    jmp inner_loop<br />  wl2:<br />   <br />	push ebx<br />	push ecx<br />	push edx<br />	mov eax,<br />	push eax<br />	mov eax,ebx<br />	push eax<br />	call strcmp<br />    pop ebx<br />    pop ebx<br />	pop  edx<br />	pop  ecx<br />	pop  ebx<br /><br />    ;cmp , ebx<br />	;cmp eax,0<br />    ;jle wl2Out<br />    cmp eax,0<br />    jge wl2Out<br />    dec edx<br />    jmp wl2<br />  wl2Out:<br />   <br />	;mov edx,eedx<br />	;mov ecx,eecx<br />    cmp ecx, edx              ; If ecx &gt; edx, exit inner loop<br />    jg exit_innerx<br />  ; =========================<br />    mov eax, <br />    mov ebx,       ; swap elements<br />    mov , ebx<br />    mov , eax<br />  ; =========================<br />    mov ebx, temp             ; restore EBX<br />    inc ecx<br />    dec edx<br />    cmp ecx, edx<br />    jle inner_loop<br />  exit_innerx:<br />  ; ---------------------------------------------------------<br />    cmp ecx, Last             ; If ecx &lt; Last jump over<br />    jg iNxt<br />	<br />  ; =========================<br />    mov eax, cntr<br />    mov , ecx      <br />    mov ebx, Last<br />    mov , ebx<br />  ; =========================<br />    add cntr, 2<br />  iNxt:<br />    mov ebx, temp             ; restore EBX<br />    mov Last, edx             ; Last  = EDX<br />    cmp edx, First            ; compare Last &amp; First<br />    jg outer_loop<br /><br />    cmp cntr, 0<br />    jz qsOut<br />    sub cntr, 2<br />  ; =========================<br />  <br />    mov eax, cntr<br />    mov ebx, <br />    mov First, ebx<br />    mov ebx, <br />    mov Last, ebx<br />  ; =========================<br />    mov ebx, temp             ; restore EBX<br />    jmp outer_loop<br /><br />    qsOut:<br /><br />    ;invoke SysFreeString,hMem<br />	push hMem<br />	call free<br />    pop edi<br />    pop esi<br />    pop ebx<br />    ret<br />NameSort ENDP<br />END<br /><br /><br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br /><br />Output is<br /><br />Zimmer Frank  56   1244084<br />Anderson George  45   1244116<br />Bonker George  23   1244148<br />Kowaski Jimmy  47   1244180<br />Zoogle Tommy  31   1244212<br />Dutch Andy  33   1244244<br />Clark Vince  63   1244276<br />Gagnon Frank  ?   1244308<br />Dobbs Denise  ?   1244340<br />Madison George  ?   1244372<br />Kenedy Jimmy  ?   1244404<br />Tucker Tommy  ?   1244436<br />Foster Andy  ?   1244468<br />Madison Oscar  ?   1244500<br />Gozalez Arnold  ?   1244532<br /><br /><br /><br />Anderson George  45   1244116<br />Bonker George  23   1244148<br />Clark Vince  63   1244276<br />Dobbs Denise  ?   1244340<br />Dutch Andy  33   1244244<br />Foster Andy  ?   1244468<br />Gagnon Frank  ?   1244308<br />Gozalez Arnold  ?   1244532<br />Kenedy Jimmy  ?   1244404<br />Kowaski Jimmy  47   1244180<br />Madison Oscar  ?   1244500<br />Madison George  ?   1244372<br />Tucker Tommy  ?   1244436<br />Zimmer Frank  56   1244084<br />Zoogle Tommy  31   1244212<br />Press any key to continue</div>
    <div class="meta">Posted on 2001-12-26 21:37:03 by andy981</div>
   </div>
  </div>
 </body>
</html>