<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Getting started with JPG Image Editing... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5818" />
    <link rel="next" href="../?id=5818&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5818">Getting started with JPG Image Editing...</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=5818&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=5818&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="5818" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=5818&amp;page=2">&gt;</a><a href="../?id=5818&amp;page=2">&raquo;</a></form>   <div class="post" id="post-41621">
    <div class="subject"><a href="#post-41621">Getting started with JPG Image Editing...</a></div>
    <div class="body">Hey folks,<br /><br />I need a program that can do a few things I need for work. I could not find one so I decided to write one in assembly.<br />It has to be able to:<br />-Resize jpg's<br />-put a text string on each picture like &quot;my images&quot;<br />-output the pictures in several folders and sort them by date.<br />I guess i could do this by a Corel Photopaint Macro but it is more interesting to do it in assembly. I just need to know where to get started. I looked around on the board here and found a whole bunch of stuff about loading them, but not editing them.<br /><br />Thanx in advance,<br />Olli</div>
    <div class="meta">Posted on 2002-06-05 15:02:13 by Olli</div>
   </div>
   <div class="post" id="post-41624">
    <div class="subject"><a href="#post-41624">Getting started with JPG Image Editing...</a></div>
    <div class="body">I think your best bet is to load the Jpeg and convert to a DIB (use one of the free libraries)  then read in you overlay DIB,  then using a set colour as a mask place you overlay onto your main picture<br /><br />Next resave as a jpeg<br /><br />to scale your DIB there are a couple of methods, i would recommend placing your overlay on first then rescaling</div>
    <div class="meta">Posted on 2002-06-05 15:21:57 by Terab</div>
   </div>
   <div class="post" id="post-41686">
    <div class="subject"><a href="#post-41686">Well,</a></div>
    <div class="body">I downloaded the latest version of Intel's jpg library. <br />I quiet sure i have to load the library now. But how do i get the jpg file on the disc converted to dib in a memory block and overlay my text string ? How do i know the functions of the library ? <br />Please don't forget I'm new to working with libraries and image files. May be we could have this thread as kind of a tutorial for other people interested in working with image files like me ?</div>
    <div class="meta">Posted on 2002-06-06 02:35:31 by Olli</div>
   </div>
   <div class="post" id="post-41687">
    <div class="subject"><a href="#post-41687">Re: Well,</a></div>
    <div class="body"><div class="quote"><br />I downloaded the latest version of Intel's jpg library. <br />Please don't forget I'm new to working with libraries and image files. May be we could have this thread as kind of a tutorial for other people interested in working with image files like me ? </div><br /><br />I prefer the freeimage dll, just find it easier to use and has a lot more functions,  it is a bit bigger but well worth it.<br /><br />I posted a message in another thread on how to load the library, I dont know if the moderators like cross posting? Check the other thread related to jpegs.<br /><br />The freeimage library has the ability to load and convert the image for you - so read jpg tell it you want a DIB and its all done for you<br /><br /><br />check the masm examples for how to load a dll</div>
    <div class="meta">Posted on 2002-06-06 02:47:17 by Terab</div>
   </div>
   <div class="post" id="post-41688">
    <div class="subject"><a href="#post-41688">Getting started with JPG Image Editing...</a></div>
    <div class="body">Olli,<br />take a look at the source code section of Iczelions site. There is an example for using the Intel JPEG Library.<br /><br /><a target="_blank" href="http://win32asm.cjb.net">http://win32asm.cjb.net</a></div>
    <div class="meta">Posted on 2002-06-06 02:47:19 by bazik</div>
   </div>
   <div class="post" id="post-41737">
    <div class="subject"><a href="#post-41737">Good stuff...</a></div>
    <div class="body">Great,<br /><br />thanks a lot...<br />I got a working application that opens and saves jpg images, ur posts helped me alot here. What i dont get to work is to show the jpg in a dialogbox. I read Ernie's tutorial to show jpgs but i don't understand. Isn't there a much simpler way to show the image before i save it? I mean after i loaded it with FreeImage.dll i shouldn't be much of a problem to show it because it is in memory already. Am I right? I just don't know how to show it in a dialog box.<br /><br />Thanks in advance,<br />Olli</div>
    <div class="meta">Posted on 2002-06-06 07:44:55 by Olli</div>
   </div>
   <div class="post" id="post-41742">
    <div class="subject"><a href="#post-41742">Re: Good stuff...</a></div>
    <div class="body"><div class="quote"><br />I mean after i loaded it with FreeImage.dll i shouldn't be much of a problem to show it because it is in memory already. Am I right? I just don't know how to show it in a dialog box.<br /><br />Thanks in advance,<br />Olli </div><br /><br />Well you should have a handle to a DIB, now you could place the bitmap on the dialog box.<br /><br />Easier maybe to place it onto a static control - then you can use something like:<br /><br />invoke SendMessage,hStatic1,BM_SETIMAGE,0,hDIB<br /><br />you might need to convert the DIB to a compatible form for the DC first<br /><br />hope this helps</div>
    <div class="meta">Posted on 2002-06-06 07:59:11 by Terab</div>
   </div>
   <div class="post" id="post-41744">
    <div class="subject"><a href="#post-41744">Getting started with JPG Image Editing...</a></div>
    <div class="body">Never tried one of these librarys myself :)<br /><br />So my question: Can you also crop/resize the pictures with it?<br />I want to convert a screenshot of the entire screen to a jpeg.</div>
    <div class="meta">Posted on 2002-06-06 08:02:06 by bazik</div>
   </div>
   <div class="post" id="post-41748">
    <div class="subject"><a href="#post-41748">Getting started with JPG Image Editing...</a></div>
    <div class="body"><div class="quote"><br />Never tried one of these librarys myself :)<br /><br />So my question: Can you also crop/resize the pictures with it?<br />I want to convert a screenshot of the entire screen to a jpeg. </div><br /><br /><br />Should be able to - I think I have some source code at home for it.  there is a section in the MSDN which gives example API code to capture the screen into a bitmap - its in VB but easy to convert to asm<br /><br /><br />from there it is easy enough to strechblt into another place and the convert to jpeg and save</div>
    <div class="meta">Posted on 2002-06-06 08:09:55 by Terab</div>
   </div>
   <div class="post" id="post-42446">
    <div class="subject"><a href="#post-42446">hmmmmmmmm</a></div>
    <div class="body">So this is what i got so far to show my jpg in a static control. But i can't figure out what all the pointers in GetProcAddress have to look like. The source code of the FreeImage.dll, could it be written in C? I need some help with the pointers or even other mistakes in this source. Thanks in advance<br />Olli<br /><br /><pre><code><br /><br />.data<br />missDll         db &quot;Dll not found!&quot;,0<br />ImageFormat db ? <br />TEST_FILE db &quot;test.jpg&quot;,0 <br />DIB dd ? <br /><br />.code<br />.ELSEIF uMsg==WM_INITDIALOG<br />        invoke LoadLibrary,ADDR FreeImageDLL <br />        .IF eax==NULL <br />            invoke MessageBox,NULL,addr missDll,addr DlgName,MB_OK <br />            return 0 <br />        .ELSE <br />            mov hDLL, eax <br />            invoke LoadProcs,hDLL <br />            .IF eax==NULL <br />                return 0 <br />                invoke GetProcAddress,hLibrary,ADDR f1name <br />                mov lpFreeInitialise , eax <br />                invoke GetProcAddress,hLibrary,ADDR f2name <br />                mov lpFreeGetFileType , eax <br />                invoke GetProcAddress,hLibrary,ADDR f3name <br />                mov lpFreeLoad, eax <br />                invoke GetProcAddress,hLibrary,ADDR f5name <br />                mov lpFreeUnload , eax <br />                invoke GetProcAddress,hLibrary,ADDR f6name <br />                mov lpFreeDeInitialise, eax <br />                <br />                push NULL <br />                call &#91;lpFreeInitialise&#93; <br />                <br />                push 0 <br />                mov eax,offset TEST_FILE <br />                push eax <br />                push 0 <br />                call &#91;lpFreeLoad&#93; <br />                <br />                mov DIB,eax <br />                invoke SendMessage,hStatic,STM_BITMAP,IMAGE_BITMAP,eax<br />                <br />                push DIB <br />                call &#91;lpFreeUnload&#93; <br />                call &#91;lpFreeDeInitialise&#93; <br /><br />            .ELSE <br />            .ENDIF <br />        .ENDIF <br /></code></pre></div>
    <div class="meta">Posted on 2002-06-10 15:26:09 by Olli</div>
   </div>
   <div class="post" id="post-42447">
    <div class="subject"><a href="#post-42447">Re: hmmmmmmmm</a></div>
    <div class="body"><div class="quote"><br />So this is what i got so far to show my jpg in a static control. But i can't figure out what all the pointers in GetProcAddress have to look like. The source code of the FreeImage.dll, could it be written in C? I need some help with the pointers or even other mistakes in this source. Thanks in advance<br /><br />                invoke GetProcAddress,hLibrary,ADDR f1name <br />                mov lpFreeInitialise , eax <br />                invoke GetProcAddress,hLibrary,ADDR f2name <br />                mov lpFreeGetFileType , eax <br />                invoke GetProcAddress,hLibrary,ADDR f3name <br />                mov lpFreeLoad, eax <br />                invoke GetProcAddress,hLibrary,ADDR f5name <br />                mov lpFreeUnload , eax <br />                invoke GetProcAddress,hLibrary,ADDR f6name <br />                mov lpFreeDeInitialise, eax <br />                <br />       </code></pre> </div><br /><br /><br /><br />aaaah yes - i forgot to include the f1name etc definitions in my original post (sorry)<br /><br />i suppose this will help....  :) <br /><br />                f1name   db &quot;_FreeImage_Initialise@4&quot;,0<br />	f2name   db &quot;_FreeImage_GetFileType@8&quot;,0<br />	f3name   db &quot;_FreeImage_Load@12&quot;,0<br />	f4name   db &quot;_FreeImage_Save@16&quot;,0<br />	f5name   db &quot;_FreeImage_Unload@4&quot;,0<br />	f6name   db &quot;_FreeImage_DeInitialise@0&quot;,0</div>
    <div class="meta">Posted on 2002-06-10 15:31:40 by Terab</div>
   </div>
   <div class="post" id="post-42449">
    <div class="subject"><a href="#post-42449">Getting started with JPG Image Editing...</a></div>
    <div class="body">also one thing , the below code will work,  but dont you want to load the library when your code first runs?<br /><br />else everytime the dialog opens you will be loading the lib again.<br /><br /><br />.ELSEIF uMsg==WM_INITDIALOG<br />        invoke LoadLibrary,ADDR FreeImageDLL</div>
    <div class="meta">Posted on 2002-06-10 15:33:51 by Terab</div>
   </div>
   <div class="post" id="post-42570">
    <div class="subject"><a href="#post-42570">Getting started with JPG Image Editing...</a></div>
    <div class="body">Thanks that really solved the pmy problem and I'm starting to understand this whole thing. I found another problem though. You can only show BMP Resources through the STM_SETIMAGE and the BM_SETIMAGE (posted in this thread)don't work either. So i actually need a simpler way to do this. Any ideas ?</div>
    <div class="meta">Posted on 2002-06-11 07:08:03 by Olli</div>
   </div>
   <div class="post" id="post-42572">
    <div class="subject"><a href="#post-42572">Getting started with JPG Image Editing...</a></div>
    <div class="body">That's how I show picture's on a static control in my program:<br /><pre><code><br />        invoke CreateWindowEx, 0, addr szStaticClass, addr szInbox, ; create static<br />                               WS_CHILD or WS_VISIBLE or SS_CENTERIMAGE or SS_NOTIFY or SS_BITMAP, 0, 25, 96, 75, hCtl, OB_INBOX, 400000h, 0<br />        mov hInbox, eax<br /><br />        invoke LoadBitmap, 400000h, 102 ; load image from rc file<br />        invoke SendMessage, hInbox, STM_SETIMAGE, IMAGE_BITMAP, eax ; set the image<br /><br /></code></pre><br /><br />Perhaps your forgot the SS_BITMAP style on the static control?</div>
    <div class="meta">Posted on 2002-06-11 07:24:46 by bazik</div>
   </div>
   <div class="post" id="post-42605">
    <div class="subject"><a href="#post-42605">Getting started with JPG Image Editing...</a></div>
    <div class="body">Can AnyOne Post A inc file for use of Freeimage dll?<br />I'm a newbie,and have some problem while change FreeImage.h to FreeImage.inc</div>
    <div class="meta">Posted on 2002-06-11 09:08:48 by purefiring</div>
   </div>
   <div class="post" id="post-42607">
    <div class="subject"><a href="#post-42607">...</a></div>
    <div class="body">No that ain't the problem. Here is my code. Remember I'm just playing around with the code this is nothing final yet. May be u see a mistake in it. I'll try to figure it out. If u are quicker please post it here.<br />Thanks in advance<br />Olli<br /><br /><pre><code><br />.386<br />.model flat,stdcall<br />option casemap&#58;none<br /><br />include \masm32\include\windows.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\gdi32.inc<br />include \masm32\include\masm32.inc<br />include \masm32\include\shell32.inc<br />include \masm32\include\comctl32.inc<br />include \masm32\include\comdlg32.inc<br />include \masm32\include\advapi32.inc<br />include \masm32\include\crypt32.inc<br /><br />includelib \masm32\lib\shell32.lib<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\gdi32.lib<br />includelib \masm32\lib\masm32.lib<br />includelib \masm32\lib\comctl32.lib<br />includelib \masm32\lib\comdlg32.lib<br />includelib \masm32\lib\advapi32.lib<br />includelib \masm32\lib\crypt32.lib<br /><br />DlgProc PROTO &#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD<br /><br />.data<br />DlgName      db &quot;Jpgs&quot;,0<br />MissDll      db &quot;Dll not found!&quot;,0<br />TestFile     db &quot;test.jpg&quot;,0 <br />f1name       db &quot;_FreeImage_Initialise@4&quot;,0 <br />f2name       db &quot;_FreeImage_GetFileType@8&quot;,0 <br />f3name       db &quot;_FreeImage_Load@12&quot;,0 <br />f5name       db &quot;_FreeImage_Unload@4&quot;,0 <br />f6name       db &quot;_FreeImage_DeInitialise@0&quot;,0<br />FreeImageDLL db &quot;FreeImage.dll&quot;,0<br /><br />.data?<br />hInstance                HINSTANCE ?<br />hDLL                     dd ?<br />DIB                      dd ?<br />lpFreeInitialise         dd ?<br />lpFreeGetFileType        dd ?<br />lpFreeLoad               dd ?<br />lpFreeUnload             dd ?<br />lpFreeDeInitialise       dd ?<br /><br />.const<br />IDC_JPG                  equ      1001 <br /><br />.code<br />start&#58;<br /><br />invoke GetModuleHandle, NULL<br />mov hInstance, eax<br />invoke DialogBoxParam, hInstance, ADDR DlgName,NULL, addr DlgProc, NULL <br />invoke ExitProcess,eax <br /><br />DlgProc proc hWin &#58;DWORD, uMsg &#58;DWORD, wParam &#58;DWORD, lParam &#58;DWORD<br /> <br />.IF uMsg==WM_COMMAND <br />      mov eax,wParam <br />      mov edx,wParam <br />      shr edx,16 <br />      <br />.ELSEIF uMsg==WM_INITDIALOG<br />        invoke LoadLibrary,ADDR FreeImageDLL <br />        .IF eax==NULL <br />            invoke MessageBox,NULL,addr MissDll,addr DlgName,MB_OK <br />        .ELSE <br />            mov hDLL, eax <br />            invoke GetProcAddress,hDLL,ADDR f1name <br />            mov lpFreeInitialise , eax <br />            invoke GetProcAddress,hDLL,ADDR f2name <br />            mov lpFreeGetFileType , eax <br />            invoke GetProcAddress,hDLL,ADDR f3name <br />            mov lpFreeLoad, eax <br />            invoke GetProcAddress,hDLL,ADDR f5name <br />            mov lpFreeUnload , eax <br />            invoke GetProcAddress,hDLL,ADDR f6name <br />            mov lpFreeDeInitialise, eax <br />              <br />            push NULL <br />            call &#91;lpFreeInitialise&#93; <br />               <br />            push 0 <br />            mov eax,offset TestFile <br />            push eax <br />             push 0 <br />             call &#91;lpFreeLoad&#93; <br />                <br />             mov DIB,eax <br />             invoke GetDlgItem,hWin,IDC_JPG<br />             .IF eax==NULL <br />                 invoke MessageBox,NULL,addr MissDll,addr DlgName,MB_OK<br />             .ELSE <br />             invoke SendMessage,eax,STM_SETIMAGE,IMAGE_BITMAP,DIB<br />               <br />              push DIB <br />              call &#91;lpFreeUnload&#93; <br />              call &#91;lpFreeDeInitialise&#93;<br />              .ENDIF <br /><br />            <br />          .ENDIF <br />.ELSEIF uMsg==WM_CLOSE<br />      invoke EndDialog,hWin,NULL<br />.ENDIF<br />ret<br />DlgProc endp<br />end start<br /></code></pre><br />--------------------------------------------------------<br />Resource<br />--------------------------------------------------------<br /><pre><code><br />#include &quot;\masm32\include\resource.h&quot; <br /><br />#define IDC_JPG           1001 <br /><br />Jpgs DIALOG LOADONCALL PURE 10, 10, 500, 400 <br />STYLE 0x0004 | DS_CENTER | WS_CAPTION | WS_MINIMIZEBOX | <br />WS_SYSMENU | WS_VISIBLE | WS_OVERLAPPED | DS_MODALFRAME | DS_3DLOOK <br />CAPTION &quot;Easy Jpgs&quot; <br />FONT 8, &quot;Arial&quot;<br />BEGIN<br />     CONTROL &quot;Static&quot;,IDC_JPG,&quot;Static&quot;,SS_BITMAP,10,10,480,380<br />END<br /></code></pre></div>
    <div class="meta">Posted on 2002-06-11 09:14:46 by Olli</div>
   </div>
   <div class="post" id="post-42609">
    <div class="subject"><a href="#post-42609">Getting started with JPG Image Editing...</a></div>
    <div class="body">i posted one last week in another thread - try the search button,  if you still dont find it - ask again,   its somewhere on my hd</div>
    <div class="meta">Posted on 2002-06-11 09:23:30 by Terab</div>
   </div>
   <div class="post" id="post-42643">
    <div class="subject"><a href="#post-42643">Nope sorry...</a></div>
    <div class="body">I couldn't find it. I checked all the posts posted by &quot;Terab&quot; on this board but nothing on this topic. <br />Once again:<br />-I need to show the Image (test.jpg) in a static control<br />-Now i would like to resize it and put a text string onto it<br /><br />Thanks in advance,<br />Olli</div>
    <div class="meta">Posted on 2002-06-11 11:42:20 by Olli</div>
   </div>
   <div class="post" id="post-42646">
    <div class="subject"><a href="#post-42646">Re: Nope sorry...</a></div>
    <div class="body"><div class="quote"><br />I couldn't find it. I checked all the posts posted by &quot;Terab&quot; on this board but nothing on this topic. <br />Once again:<br />-I need to show the Image (test.jpg) in a static control<br />-Now i would like to resize it and put a text string onto it<br /><br />Thanks in advance,<br />Olli </div><br /><br />Perhaps you can find something usefull here:<br /><a target="_blank" href="http://www.programmersheaven.com/zone10/cat453/">http://www.programmersheaven.com/zone10/cat453/</a></div>
    <div class="meta">Posted on 2002-06-11 12:00:12 by bazik</div>
   </div>
   <div class="post" id="post-42650">
    <div class="subject"><a href="#post-42650">Thanks for ur help...</a></div>
    <div class="body">but i checked this out already. The library works fine it just doesn't show the jpg image on a static control. I tried a button control with BS_BITMAP style already but it still don't work.</div>
    <div class="meta">Posted on 2002-06-11 12:13:43 by Olli</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=5818&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=5818&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="5818" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=5818&amp;page=2">&gt;</a><a href="../?id=5818&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>