<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>CMPS - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22650" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22650">CMPS</a></p>
   <div class="post" id="post-169870">
    <div class="subject"><a href="#post-169870">CMPS</a></div>
    <div class="body">I am coding this program in 16 bit TASM and i seem to be having problems with CMPSB, the program first waits for the user to enter two strings and then compare them and see if they are equal or not, but it always recognize them as equal<br /><br />Can anybody tell me what i am doing wrong ?<br /><br /><pre><span style="font-size:2>STACKSG SEGMENT STACK<br />&nbsp; DB 32 DUP(&quot;S&quot;)<br />STACKSG ENDS<br /><br />DATASG SEGMENT &#39;DATA&#39;<br />&nbsp; String1 LABEL BYTE<br />&nbsp; &nbsp; MAX1 DB 255<br />&nbsp; &nbsp; LEN1 DB ?<br />&nbsp; &nbsp; Str1Buffer DB 255 DUP(&quot;$&quot;)<br />&nbsp; String2 LABEL BYTE<br />&nbsp; &nbsp; MAX2 DB 255<br />&nbsp; &nbsp; LEN2 DB ?<br />&nbsp; &nbsp; Str2Buffer DB 255 DUP(&quot;$&quot;)<br />&nbsp; Prompt1 DB &quot;Please enter the first string (up to 255 chars) : $&quot;<br />&nbsp; Prompt2 DB &quot;Please enter the second string (up to 255 chars) : $&quot;<br />&nbsp; AreEqual DB &quot;Both strings are equally the same$&quot;<br />&nbsp; AreNotEqual DB &quot;Strings are not equal&quot;<br />&nbsp; <br />&nbsp; EnterChar DB , 13,10,&quot;$&quot;<br />DATASG ENDS<br /><br />CODESG SEGMENT PARA &#39;CODE&#39;<br /><br />&nbsp; <br />&nbsp; NextLine PROC NEAR<br />&nbsp; &nbsp; MOV AH , 09h<br />&nbsp; &nbsp; LEA DX , EnterChar<br />&nbsp; &nbsp; INT 21h<br />&nbsp; &nbsp; RET<br />&nbsp; NextLine ENDP<br />&nbsp; <br />&nbsp; MAIN PROC FAR<br />&nbsp; &nbsp; ASSUME SS:STACKSG, DS:DATASG, CS:CODESG<br /><br />&nbsp; &nbsp; MOV AX , DATASG<br />&nbsp; &nbsp; MOV DS , AX<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; ;Print out the first prompt<br />&nbsp; &nbsp; MOV AH , 09h<br />&nbsp; &nbsp; LEA DX , Prompt1<br />&nbsp; &nbsp; INT 21h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;Read the first string<br />&nbsp; &nbsp; LEA DX , String1<br />&nbsp; &nbsp; MOV AH , 0Ah<br />&nbsp; &nbsp; INT 21h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;Next Line<br />&nbsp; &nbsp; CALL NextLine<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;Print out the second prompt<br />&nbsp; &nbsp; LEA DX , Prompt2<br />&nbsp; &nbsp; MOV AH , 09h<br />&nbsp; &nbsp; INT 21h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;Read the second string<br />&nbsp; &nbsp; MOV AH , 0Ah<br />&nbsp; &nbsp; LEA DX , String2<br />&nbsp; &nbsp; INT 21h<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;Go to the next line<br />&nbsp; &nbsp; CALL NextLine<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; ;Find the bigger length<br />&nbsp; &nbsp; MOV CL , LEN1<br />&nbsp; &nbsp; CMP CL , LEN2<br />&nbsp; &nbsp; JG @@Compare<br />&nbsp; &nbsp; MOV CL , LEN2<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; @@Compare:<br />&nbsp; &nbsp; ;Now compare the strings<br />&nbsp; &nbsp; XOR CH , CH<br />&nbsp; &nbsp; CLD<br />&nbsp; &nbsp; LEA DI , Str1Buffer<br />&nbsp; &nbsp; LEA SI , Str2Buffer<br />&nbsp; &nbsp; REP CMPSB<br />&nbsp; &nbsp; JNE @@NotEqual<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; LEA DX , AreEqual<br />&nbsp; &nbsp; MOV AH , 09h<br />&nbsp; &nbsp; INT 21h<br />&nbsp; &nbsp; JMP @@EP<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; @@NotEqual:<br />&nbsp; &nbsp; &nbsp; LEA DX , AreNotEqual<br />&nbsp; &nbsp; &nbsp; MOV AH , 09h<br />&nbsp; &nbsp; &nbsp; INT 21h<br />&nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; @@EP:<br />&nbsp; &nbsp; MOV AX , 4C00H<br />&nbsp; &nbsp; INT 21H<br />&nbsp; MAIN ENDP<br />CODESG ENDS<br />&nbsp; END MAIN</span></pre></div>
    <div class="meta">Posted on 2006-02-11 02:23:51 by XCHG</div>
   </div>
   <div class="post" id="post-169888">
    <div class="subject"><a href="#post-169888">Re: CMPS</a></div>
    <div class="body"><div class="quote"><br />?&nbsp; ?&nbsp; ;Find the bigger length<br />?&nbsp; ?&nbsp; MOV CL , LEN1<br />?&nbsp; ?&nbsp; CMP CL , LEN2<br />?&nbsp; ?&nbsp; JG @@Compare<br />?&nbsp; ?&nbsp; MOV CL , LEN2<br /></div><br /><br />Well, first off, if the strings aren&#39;t the same length, then they aren&#39;t the same... try something like...<br /><br /><pre><code><br />&nbsp; &nbsp; ;Find the bigger length<br />&nbsp; &nbsp; MOV CL , LEN1<br />&nbsp; &nbsp; CMP CL , LEN2<br />&nbsp; &nbsp; JNE @@NotEqual<br />&nbsp; &nbsp; MOV CL , LEN2<br /></code></pre><br /><br /><div class="quote">?&nbsp; ?&nbsp; <br />?&nbsp; ?&nbsp; @@Compare:<br />?&nbsp; ?&nbsp; ;Now compare the strings<br />?&nbsp; ?&nbsp; XOR CH , CH<br />?&nbsp; ?&nbsp; CLD<br />?&nbsp; ?&nbsp; LEA DI , Str1Buffer<br />?&nbsp; ?&nbsp; LEA SI , Str2Buffer<br />?&nbsp; ?&nbsp; REP CMPSB<br />?&nbsp; ?&nbsp; JNE @@NotEqual<br /></div><br /><br />Personally,&nbsp; I detest REP CMPSx instructions all together, try something like...<br /><br /><pre><code><br />&nbsp; &nbsp; @@Compare:<br />&nbsp; &nbsp; ;Now compare the strings<br />&nbsp; &nbsp; XOR CH , CH<br />&nbsp; &nbsp; LEA DI , Str1Buffer<br />&nbsp; &nbsp; LEA SI , Str2Buffer<br />&nbsp; &nbsp; @@Loop:<br />&nbsp; &nbsp; MOV AL,  ; store byte from Str2Buffer into AL<br />&nbsp; &nbsp; INC SI ; move your index to the next byte in the Str2Buffer<br />&nbsp; &nbsp; MOV AH,  ; store byte from Str1Buffer into AH<br />&nbsp; &nbsp; INC DI ; move your index to the next byte in Str1Buffer<br />&nbsp; &nbsp; CMP AH, AL ; compare the two bytes<br />&nbsp; &nbsp; JNE @@NotEqual ; if they are not equal, then jump to our not equal message<br />&nbsp; &nbsp; DEC CL ; otherwise decrement our length<br />&nbsp; &nbsp; CMP CL, 0 ; if the length is not zero, the we haven&#39;t reached the end yet.<br />&nbsp; &nbsp; JNE @@Loop ; otherwise just fall through into our equal message<br /></code></pre><br /><br />Note the syntax I use here might not be right for TASM, I&#39;ve not used TASM in many years and I&#39;m not familiar with the coding style anymore. None the less I hope this helps you out.<br /><br />Regards,<br />Bryant Keller</div>
    <div class="meta">Posted on 2006-02-12 21:12:56 by Synfire</div>
   </div>
   <div class="post" id="post-169926">
    <div class="subject"><a href="#post-169926">Re: CMPS</a></div>
    <div class="body">lol i cant believe i made such mistake in comparing strings with different lengths. and btw thanks for the help. appreciate it.</div>
    <div class="meta">Posted on 2006-02-14 19:46:37 by XCHG</div>
   </div>
   <div class="post" id="post-169958">
    <div class="subject"><a href="#post-169958">Re: CMPS</a></div>
    <div class="body">no worries, that&#39;s what I come here for ... okay so I really come here to take a break from EvilHomer2k&#39;s narcissistic deamanding of project completions, but at least it&#39;s productive. ;)</div>
    <div class="meta">Posted on 2006-02-15 14:57:41 by Synfire</div>
   </div>
  </div>
 </body>
</html>