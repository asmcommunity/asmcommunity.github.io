<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Program invisible after calling a dll proc - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2964" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2964">Program invisible after calling a dll proc</a></p>
   <div class="post" id="post-19301">
    <div class="subject"><a href="#post-19301">Program invisible after calling a dll proc</a></div>
    <div class="body">Hossa<br /><br />my first try with Dll`s and direct some questions ;-)<br /><br />I want to start my server.dll when client.exe starts with this command: <br /><br />wminit:<br />         call     LoadLibraryA,offset DllName                               ;DllName db  &quot;server.dll&quot;,0<br />          test    eax,eax<br />          je        ErrorOpenDll                                                                 <br />          mov   Libhnd,eax                                                             <br />          call    GetProcAddress,Libhnd,offset StartServer      ;- StartServer db &quot;StartUp&quot;,0   (in server.dll is  &quot;StartUp Proc&quot; )<br />          call    eax                                                                           ; eax=StartUp so i &quot;call StartUp&quot; in the server.dll           <br />          call    FreeLibrary,Libhnd                                               ;...                                    <br /><br />and now the Server.exe works fine but Client.exe is invisible :-(<br />How can i start my server.dll from the client.exe and let client.exe visible ?<br />;*************************<br />i use in the dll:<br /><br />.386<br />.MODEL FLAT,STDCALL<br />locals<br />jumps<br /><br />.DATA<br /><br /><br />.CODE<br /><br />EntryPoint proc DLLinst:DWORD, Reason:DWORD, Reserved1:DWORD  &lt;-- dont know exactly for what this is ,found in dll code snipped<br />        mov  eax,1<br />        ret<br />EntryPoint endp<br /><br />PUBLICDLL StartUp       &lt;---- the proc i want to call from client.exe<br /><br />Main:<br /><br /><br />	call GetModuleHandleA,0<br />	mov Han2dle, eax<br /><br />	push 0                                        &lt;-- dont know exactly for what this is ,found in dll code snipped<br />	push 0<br />	push eax<br />	pop eax<br />	pop eax<br />	pop eax<br />	mov eax, 01<br />	ret  0ch<br /><br /><br /><br />StartUp   proc           &lt;---- the proc i want to call from client.exe<br /><br />Create_the_Window:<br />	call RegisterClassA,offset wc                   ;wc        WNDCLASS &lt;0,MainWndProc,0,0,0,0,0,2,0,szClassName&gt;<br />	push 0<br />	push <br />	push 0<br />	push 0<br />	push 0<br />	push 0<br />	push 0<br />	push 0<br />	push 0<br />	push offset szDisplayName<br />	push offset szClassName<br />	push 00040000h<br />	call    CreateWindowExA<br />	mov  Main2Hwnd, eax<br />msg_loop:<br />	call GetMessageA,offset msgbuffer,0,0,0<br />	or eax,eax<br />	je end_loop                <br />	call DispatchMessageA,offset msgbuffer<br />	jmp msg_loop<br /><br />end_loop:<br />	call ExitProcess,0<br />                ret<br /><br />StartUp   proc           &lt;---- the proc i want to call from client.exe<br /><br /><br /><br />MainWndProc Proc              &lt;-- ------- the program stuff<br />ARG	Hw2nd:dword, Msg:dword, Wparam:dword, Lparam:dword<br /><br /><br /><br /><br />EndP<br /><br /><br /><br />End Main   <br />End Start<br />End Entrypoint<br />;*************************<br /><br />if i start the dll not with the client.exe all works fine and i can work with booth files.<br />also im wondering why the start of my server.dll has a effect to my client.exe.<br /><br />can someone please explain me this ?<br /><br />Thanks</div>
    <div class="meta">Posted on 2002-01-15 08:25:29 by Max</div>
   </div>
   <div class="post" id="post-19317">
    <div class="subject"><a href="#post-19317">Program invisible after calling a dll proc</a></div>
    <div class="body">hm it seems that you forgot to use <br /><pre><code><br />    invoke ShowWindow, hwnd,SW_SHOWNORMAL<br />    invoke UpdateWindow, hwnd<br /></code></pre><br />after you create your window... correct me if i'm wrong...<br />btw... why do you use dll's ? wouldn't it be better if you<br />only have one single file? hm... i don't like dll's :)</div>
    <div class="meta">Posted on 2002-01-15 09:41:47 by mob</div>
   </div>
   <div class="post" id="post-19321">
    <div class="subject"><a href="#post-19321">Program invisible after calling a dll proc</a></div>
    <div class="body">Thanks for the help !<br /><br />why i use dll ?<br />im not familiar with network and i use the send file function from another client/server source i found.<br />if i open my voice client i also need to execute the server.exe ,when i close client.exe i need also to close server.exe ,so i try to insert the server.exe in server.dll<br />maybe when i have more time ,i learn more about network and code booth files to one.<br />for now id like to see it finish quick to talk some lines :-)<br /><br />so i try your tip out and hope thats it ;-)<br />but i dont understand why the &quot;visible&quot; client window<br />become invisible after i load the dll.<br />for what is it ?</div>
    <div class="meta">Posted on 2002-01-15 09:56:40 by Max</div>
   </div>
   <div class="post" id="post-19326">
    <div class="subject"><a href="#post-19326">Program invisible after calling a dll proc</a></div>
    <div class="body">max, go to icz's site and read his winsock tutorial... it's<br />very good i think... i don't think that your method is fast<br />enough for real-time talking... coding with sockets is very<br />easy... you can code a programm that is able to be server<br />and client in one... that way would be very comfortable<br />coz one part of your prog would listen for incomming data<br />sequenzes and the other part would send data if you're<br />connected to some other &quot;server&quot;... the advantage is that<br />you're not bound to protocolls that would be good for <br />Other purposes but bad for your voice-transfer, like tcp/ip<br />with port 80 (html file transfer)... you can define your own <br />or use a raw-plain-data one... when using sockets you also<br />have more control... for example you get a window-<br />message if the connection is broken or if the other user<br />disconnects you...</div>
    <div class="meta">Posted on 2002-01-15 10:14:18 by mob</div>
   </div>
   <div class="post" id="post-19329">
    <div class="subject"><a href="#post-19329">Program invisible after calling a dll proc</a></div>
    <div class="body">Thanks again for the helpfull tips !<br /><br />when i use the client/server source i found ,i think its impossible to make the file transfer and the functions over one socket.<br />i think so because the author of the source i use ,open another socket for the file transfer.<br />the communication for server and client goes over another socket.<br />so i have 1 socket in client and 2 in server ,thats finaly 3 in the ready tool.<br />too much for me to handle at this time :-)<br />please remember that i had the idea for the voice messenger when i read 4oh4 code snippet for recording wav.<br />i start searching tips and coding before i think what i need to code by meaning a its a easy thing..........now i had learned thats its important to make a plan first and start then coding :-)<br /><br />sounds lame.....yep</div>
    <div class="meta">Posted on 2002-01-15 10:30:34 by Max</div>
   </div>
   <div class="post" id="post-19331">
    <div class="subject"><a href="#post-19331">Program invisible after calling a dll proc</a></div>
    <div class="body">you can use as much sockets as you desire... if you want<br />open one for listening and anotherone for data-transfer...<br />...so much time passed... i used sockets a year ago...<br />let's assume we've got two chat clients that want to <br />exchange data (text...)<br /><br /><pre><code><br />+--------------+<br />I PC_1         I<br />I              I<br />I 1066 LISTEN  I&lt;--+    <br />I      TRANSFERI---I--+<br />+--------------+   I  I<br />                   I  I <br />+--------------+   I  I<br />I PC_2         I   I  I<br />I              I   I  I<br />I 1066 LISTEN  I&lt;--I--+<br />I      TRANSFERI---+<br />+--------------+     <br /><br />    PC_2 is Connected with PC_1 &#40;on PORT 1066&#41;<br />    PC_1 is Connected with PC_2 &#40;on PORT 1066&#41;<br />1.&#41; PC_2 sends data to PC_1&#91;port&#58;1066&#93;<br />2.&#41; PC_1 GETS a FD_READ MSG AND IS NOW ABLE TO<br />    HANDLE THIS DATA<br />3.&#41; PC_1 CAN ALSO SEND DATA TO PC_2&#91;port&#58;1066&#93;<br />    COZ PC_2 IS ALSO LISTENING FOR INCOMMING<br />    DATA ON PORT 1066 &#40;HE'LL GET A FD_READ, TOO&#41;<br /></code></pre><br /><br />everything's done with one port...</div>
    <div class="meta">Posted on 2002-01-15 10:58:08 by mob</div>
   </div>
   <div class="post" id="post-19466">
    <div class="subject"><a href="#post-19466">Thank you</a></div>
    <div class="body">This looks very clear now to me :-)<br />first i think totaly stupid........if i take one second to open my mind i had to know that if i use a browser......he do all the stuff on one socket.<br />*lol* thats the newbies way i go........<br /><br />but again i would very happy if someone can explain me why my tool become invisible.<br />its hard to understand for me that if i use a tool ,lets say client.exe and when i load from this file a command in a dll this file client.exe become invisible ,not the dll.<br /><br />so as all say ,a dll is good to make plugins im wondering how they use it when its normal that the used file become invisible.<br />it looks normal to me because noone say anything to this ,or is it so easy and noone like to point me on my misstake ?<br /><br />when i use updatewin.. i see the window of the server only.<br />also if i use a taskmonitor i dont find the client.exe handlename after i call the dll.<br />so where is my client.exe gone ?<br /><br />last.....all this looks for me that i can not use a dll as full program.<br />so a dll is only for small procs i can call from another tool ?<br /><br />when browsing google on dlls i found enough keyloggers and so on......but not a reason to my problem.<br /><br />whats wrong ?</div>
    <div class="meta">Posted on 2002-01-16 06:18:53 by Max</div>
   </div>
  </div>
 </body>
</html>