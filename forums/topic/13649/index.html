<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Delphi Obj use MASM32 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13649" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=13649">Delphi Obj use MASM32</a></p>
   <div class="post" id="post-105749">
    <div class="subject"><a href="#post-105749">Delphi Obj use MASM32</a></div>
    <div class="body">Hello,<br /><br />I am a delphi coder so i have a question.<br />Can I make with Delphi Obj and can i shell it with MASM32.<br /><br />If I make procedure and functions with Delphi OBJ.<br />Can I include this obj in masm32 and shellexecute this procedure in<br />the Delphi OBJ. I have written in Delphi???</div>
    <div class="meta">Posted on 2003-06-02 08:06:58 by Fred</div>
   </div>
   <div class="post" id="post-105759">
    <div class="subject"><a href="#post-105759">Delphi Obj use MASM32</a></div>
    <div class="body">I guess you wanted to ask if you can link the .obj file generated with delphi,<br />answer to this is NO. (I tried)<br /><br />You can make a DLL and use the exported functions in both<br />ways... for this you might want to check out:<br /><br />LoadLibrary<br />GetProcAddress<br />FreeLibrary<br /><br /><br /><br />have fun</div>
    <div class="meta">Posted on 2003-06-02 09:33:52 by Azrim</div>
   </div>
   <div class="post" id="post-105763">
    <div class="subject"><a href="#post-105763">Delphi Obj use MASM32</a></div>
    <div class="body">Hello,<br /><br />Thanks for your thread.<br /><br />If i have a ready Code and compile for EXE Files.<br />And I want to make a DLL.<br /><br />That are the option (parameter) for the link32?<br /><br />There are change the code too for DLL???</div>
    <div class="meta">Posted on 2003-06-02 09:50:48 by Fred</div>
   </div>
   <div class="post" id="post-105764">
    <div class="subject"><a href="#post-105764">Delphi Obj use MASM32</a></div>
    <div class="body">Please download and install the masm package,<br /><br />you will find an example in C:\masm32\EXAMPLE1\DLL<br /><br />here is the delphi code needed to test this DLL (TSTDLL.DLL)<br />(I tested it on Delphi 7)<br /><br /><pre><code><br />program testmasmdll;<br /><br />&#123;$APPTYPE CONSOLE&#125;<br /><br />uses<br />  SysUtils,Windows;<br /><br />const<br />  DLL_FULL_PATH = 'C&#58;\masm32\EXAMPLE1\DLL\TSTDLL.DLL';<br />  DLL_EXPORTED_FUNCTION = 'TestProc';<br />Var<br />  DLL_HANDLE &#58; Cardinal;<br />  PROC_HANDLE &#58; Procedure;<br />begin<br />  Writeln&#40;'Loading ',DLL_EXPORTED_FUNCTION,' from ',DLL_FULL_PATH&#41;;<br />  DLL_HANDLE &#58;= LoadLibrary&#40;DLL_FULL_PATH&#41;; &#123;Load DLL if not loaded, get addr&#125;<br />  PROC_HANDLE &#58;= GetProcAddress&#40;DLL_HANDLE,DLL_EXPORTED_FUNCTION&#41;; &#123;Load pointer to procedure&#125;<br />  Writeln&#40;'Executing..'&#41;;<br />  PROC_HANDLE; &#123;Invoke/Call it here&#125;<br />  Writeln&#40;'Done!'&#41;;  <br />  FreeLibrary&#40;DLL_HANDLE&#41;; &#123;oops, I forgot to free it &#58;&#41;&#125;<br />end.<br /><br /></code></pre><br /><br />You will see it is quite easy.</div>
    <div class="meta">Posted on 2003-06-02 09:54:27 by Azrim</div>
   </div>
   <div class="post" id="post-105765">
    <div class="subject"><a href="#post-105765">Delphi Obj use MASM32</a></div>
    <div class="body">One question for you:<br /><br />Which one of these are you after..<br /><br />1) Write a DLL in MASM and use it from Delphi<br />2) Write a DLL in Delphi and use it from MASM<br /><br />?</div>
    <div class="meta">Posted on 2003-06-02 10:03:44 by Azrim</div>
   </div>
  </div>
 </body>
</html>