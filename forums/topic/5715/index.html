<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>hotkey trouble - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5715" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5715">hotkey trouble</a></p>
   <div class="post" id="post-40870">
    <div class="subject"><a href="#post-40870">hotkey trouble</a></div>
    <div class="body">I'm trying to create a hotkey, but apparently I'm doing something wrong. I'm using (masm32) and using a dialog box with the following code:<br /><div class="quote"><br /><span style="font-size:9px><br /><strong><br />      .ELSEIF uMsg==WM_CREATE<br />            invoke RegisterHotKey,hWnd,zID,MOD_SHIFT, 05Ah<br />      .ELSEIF uMsg==WM_DESTROY<br />             invoke UnregisterHotKey, hWnd, zID<br />             ret 0<br />      .ELSEIF uMsg==WM_HOTKEY<br />             invoke MessageBoxA, NULL, addr AppName, addr Capt,  MB_OK<br /></strong><br /></span><br /></div><br /><br />Shouldn't this enable 'SHIFT+Z' to popup a messagebox? Please tell me what I'm doing wrong...<br /><br />Also, will this allow me to use the hotkey even if my program doesn't have focus (globally i guess) or how do I make that kind of hotkey?<br /><br />-<br />frihz</div>
    <div class="meta">Posted on 2002-05-31 19:28:36 by frihz</div>
   </div>
   <div class="post" id="post-40893">
    <div class="subject"><a href="#post-40893">hotkey trouble</a></div>
    <div class="body">everything looks good. although make sure the handle your using in RegisterHotKey is the right one. to make a global hotkey, make your hotkey with the WM_SETHOTKEY message. for thread specific you just use the RegisterHotKey function.</div>
    <div class="meta">Posted on 2002-06-01 00:02:44 by smurf</div>
   </div>
   <div class="post" id="post-40997">
    <div class="subject"><a href="#post-40997">hmm...</a></div>
    <div class="body">Well, I have the exact code in a small 'test' file, and can't get it to work. What do you mean by the right handle?<br /><br />Is there any sample source I can download somewhere on the 'net (perhaps masm-specific) that uses hotkeys? I'm basically trying to make my app able to process some command (a messagebox or just anything really) once the user presses a corresponding key sequence (shift+z or something like that). I'd like to make it be available globally -- though right now I can't even set a hotkey for just my app :( <br /><br />-<br />frihz</div>
    <div class="meta">Posted on 2002-06-01 21:17:36 by frihz</div>
   </div>
   <div class="post" id="post-41004">
    <div class="subject"><a href="#post-41004">hotkey trouble</a></div>
    <div class="body">is just made a little example. i used iczelions tutorial #10 source code and just added the hotkey so you have some extra crap in there. i dont ever use dialogs so i didnt write it up from scratch.</div>
    <div class="meta">Posted on 2002-06-01 22:00:56 by smurf</div>
   </div>
   <div class="post" id="post-41115">
    <div class="subject"><a href="#post-41115">heh</a></div>
    <div class="body">Okay, thanks for the example -- but, the hotkey still isn't working. I'm using WinME (though I don't know if it matters or not) and when I try SHIFT+Z after I have opened your app, the messagebox isn't popping up.<br /><br />What other ways are there of making something similar to a hotkey (perhaps a global) -- and preferably w/o the use of an external file (like having to add a dll or something) ?<br /><br />-<br />frihz</div>
    <div class="meta">Posted on 2002-06-02 12:44:56 by frihz</div>
   </div>
   <div class="post" id="post-41119">
    <div class="subject"><a href="#post-41119">hotkey trouble</a></div>
    <div class="body">at this point i cant help you further. the only testing machine i have available has windows xp. im in the process of setting my alt computer up with multiple os'es mainly to use as a testing machine. gonna set it up with all the os'es: 95,98se,me,2k,xp but im looking around for windows 95 because i had thrown away my cd some time ago.</div>
    <div class="meta">Posted on 2002-06-02 12:57:51 by smurf</div>
   </div>
   <div class="post" id="post-41123">
    <div class="subject"><a href="#post-41123">ok</a></div>
    <div class="body">Well, I guess I'll put aside my 'project' for a while. Thanks for your help anyway smurf :)<br /><br />-<br />frihz</div>
    <div class="meta">Posted on 2002-06-02 13:41:47 by frihz</div>
   </div>
  </div>
 </body>
</html>