<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Misc questions on imports and exports - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10982" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10982">Misc questions on imports and exports</a></p>
   <div class="post" id="post-82748">
    <div class="subject"><a href="#post-82748">Misc questions on imports and exports</a></div>
    <div class="body">Hello,<br /><br />a few misc question about imports and exports ....<br /><br />Using a debugger sometimes I have seen the same function listed twice in import tables at different addresses. This is something that I have always wondered about. How can it be and why???<br /><br />Also, I have seen dlls export variables. How can you do it? I mean how do you compile/link a dll or exe to have it export variables?<br /><br />One final question: how can you export functions (how do you compile/link?) in a exe and why? I mean why have an exe and not a dll export functions?<br />Thx to all.<br /><br />H.</div>
    <div class="meta">Posted on 2003-02-20 05:16:15 by yaa</div>
   </div>
   <div class="post" id="post-82753">
    <div class="subject"><a href="#post-82753">Re: Misc questions on imports and exports</a></div>
    <div class="body"><div class="quote"><br />One final question: how can you export functions (how do you compile/link?) in a exe and why? I mean why have an exe and not a dll export functions?</div><br /><br />yaa,<br /><br />You can check the thread:<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=8726&amp;highlight=export+function">http://www.asmcommunity.net/board/index.php?topic=8726&amp;highlight=export+function</a></div>
    <div class="meta">Posted on 2003-02-20 05:28:31 by Vortex</div>
   </div>
   <div class="post" id="post-82762">
    <div class="subject"><a href="#post-82762">Misc questions on imports and exports</a></div>
    <div class="body">Vortex, my questions where stimulated by that thread ... yet they are not unaswered in said thread, reason why I decided to post them.<br /><br />H.</div>
    <div class="meta">Posted on 2003-02-20 06:28:09 by yaa</div>
   </div>
   <div class="post" id="post-83136">
    <div class="subject"><a href="#post-83136">Misc questions on imports and exports</a></div>
    <div class="body">Are my questions really that complex that no one is answering?<br /><br />yaa</div>
    <div class="meta">Posted on 2003-02-22 12:20:34 by yaa</div>
   </div>
   <div class="post" id="post-83147">
    <div class="subject"><a href="#post-83147">Re: Misc questions on imports and exports</a></div>
    <div class="body"><div class="quote">Using a debugger sometimes I have seen the same function listed twice in import tables at different addresses. This is something that I have always wondered about. How can it be and why???</div><br />Why wouldn't it be possible :) ?<br />You probably won't find it in 'normal' programs. Sometimes packers import one function out of each dll to eliminate the need for a loadlibrary call, and in addition add some import information for the loader, so some functions might appear twice.<br /><br /><div class="quote">Also, I have seen dlls export variables. How can you do it? I mean how do you compile/link a dll or exe to have it export variables?</div><br />Just make the variable public (PUBLIC var in masm) and add it to the exports section in the .def file.<br /><br /><div class="quote">One final question: how can you export functions (how do you compile/link?) in a exe and why? I mean why have an exe and not a dll export functions? Thx to all.</div><br />Use a .def file when linking the exe. I don't know why you'd need it but on the other hand there's no reason not to allow it since dlls and exes share the same format (PE).<br /><br />Thomas</div>
    <div class="meta">Posted on 2003-02-22 13:15:43 by Thomas</div>
   </div>
   <div class="post" id="post-83356">
    <div class="subject"><a href="#post-83356">Misc questions on imports and exports</a></div>
    <div class="body">Hello Thomas,<br /><br />first of all thank you for your answers.<br /><br />I saw the same function imported twice in a non packed application although I just can't find it anymore, anyhow it did surprise me. Can I think about it as a &quot;missed&quot; optimization by the compiler???<br />From your answer I take that linkers will most of the time create a IAT with a single entry for each function.<br /><br />A public variable in MASM seems to me to correspond to a global non static variable in C.<br /><br />The only exported function in exe I have always known about is the ___CPPdebugHook function which is left by Borland's compilers (Delphi and C++) in executables for debugging purposes.<br /><br />Regards,<br />yaa</div>
    <div class="meta">Posted on 2003-02-23 17:51:46 by yaa</div>
   </div>
  </div>
 </body>
</html>