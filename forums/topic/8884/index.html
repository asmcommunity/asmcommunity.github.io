<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Forcing Desktop To Foreground - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8884" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=8884">Forcing Desktop To Foreground</a></p>
   <div class="post" id="post-65315">
    <div class="subject"><a href="#post-65315">Forcing Desktop To Foreground</a></div>
    <div class="body">Hi, <br /><br />I was trying to code a little application that will bring my desktop window to the foreground via a hotkey but I've encountered a problem. If I'm running a command prompt full screen, it remains in the foreground. When I hit my Start Menu button on the keyboard it switches me out of the command prompt and displays the start menu... how would I get my application to switch me out of the command prompt? I've tried GetForegroundWindow/SetForegroundWindow/ShowWindow combinations but nothing worked. Any help would be appreciated. :)<br /><br />Thanks,<br />bl00dbath</div>
    <div class="meta">Posted on 2002-11-10 22:53:36 by bl00dbath</div>
   </div>
   <div class="post" id="post-65327">
    <div class="subject"><a href="#post-65327">Forcing Desktop To Foreground</a></div>
    <div class="body">What? I had some trouble with that 3 days ago. I almost smashed<br />my computer because of it :grin:. But hey you don't wanna know my<br />lifestory or something 'funny' like that :alright:.<br /><br />After alot of testing with just about every api function I could get my<br />hands on. This is the only solution I found that should work 99.9%.<br />The code will give focus to the next window in the Z-order(cycling through<br />the whole z-order.)<br /><br /><strong>Z-Order:</strong> <br />Toplevel, child, and pop-up windows recieve a position in the <br />Z-order according to their appearance on your screen. <br />Ex.<em> When you set a window to be topmost, that window is the first<br />window in the Z-order.</em><br /><br /><pre><code>    invoke keybd_event, 18, 0, 0, 0   ;\\ Press 'ALT' Key<br />    invoke keybd_event, 27, 0, 0, 0   ;\\ Press 'ESC' Key<br />    invoke keybd_event, 27, 0, 2, 0   ;\\ Release 'ESC' Key<br />    invoke keybd_event, 18, 0, 2, 0   ;\\ Release 'ALT' Key</code></pre></div>
    <div class="meta">Posted on 2002-11-11 00:54:50 by natas</div>
   </div>
   <div class="post" id="post-65329">
    <div class="subject"><a href="#post-65329">Forcing Desktop To Foreground</a></div>
    <div class="body">Haha thanks for the reply Natas, I'll give it a try :)<br /><br />Regards,<br />bl00dbath</div>
    <div class="meta">Posted on 2002-11-11 01:09:14 by bl00dbath</div>
   </div>
   <div class="post" id="post-65391">
    <div class="subject"><a href="#post-65391">Forcing Desktop To Foreground</a></div>
    <div class="body">You can try using the windows system wide hotkey 'windows key + m' to minimize all open windows.  I'm not sure if that's exactly what you're trying to do but it will minimize all windows and bring up your desktop.  It also minimizes full-screen dos windows.  Another side note, 'alt+tab' will maximize/restore dos windows.<br /><br />edit: Just look in windows.inc for the equates for the windows key and the m key.  When you setup the hotkey in your app, sendmessage a wm_keydown or wm_char or whatever with that equate combo.  I don't have the win api help file open but that should give you a start.<br /><br /><br />cheers,<br />will</div>
    <div class="meta">Posted on 2002-11-11 11:13:44 by Will</div>
   </div>
   <div class="post" id="post-65419">
    <div class="subject"><a href="#post-65419">Forcing Desktop To Foreground</a></div>
    <div class="body">Thanks Will, that seems to work pretty well. :)<br /><br />Regards,<br />bl00dbath</div>
    <div class="meta">Posted on 2002-11-11 16:05:44 by bl00dbath</div>
   </div>
   <div class="post" id="post-65494">
    <div class="subject"><a href="#post-65494">Forcing Desktop To Foreground</a></div>
    <div class="body">Window + D works too... You can try it too.</div>
    <div class="meta">Posted on 2002-11-12 06:04:28 by roticv</div>
   </div>
   <div class="post" id="post-65498">
    <div class="subject"><a href="#post-65498">Forcing Desktop To Foreground</a></div>
    <div class="body">ShellExecute() + Desktop.scf ?<br /><br />It maybe won't work on all windows versions...</div>
    <div class="meta">Posted on 2002-11-12 06:59:13 by JCP</div>
   </div>
   <div class="post" id="post-65644">
    <div class="subject"><a href="#post-65644">Forcing Desktop To Foreground</a></div>
    <div class="body">Thanks for all of the replys guys. :)<br /><br />I have a problem though. When in a command prompt, if I hit Windows Key + M or D, I'm switched back to desktop no problems. But when my app is activated (I'm using a keyboard hook) and I try my hotkey from the command prompt, it doesn't work. It does work in all of the other normal windows though. Would it work better if I just setup a hotkey with say RegisterHotkey instead of using the keyboard hook?<br /><br />Thanks,<br />bl00dbath</div>
    <div class="meta">Posted on 2002-11-13 07:44:53 by bl00dbath</div>
   </div>
  </div>
 </body>
</html>