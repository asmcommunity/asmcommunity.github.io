<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Add a large number of items into a ListView - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24898" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24898">Add a large number of items into a ListView</a></p>
   <div class="post" id="post-181977">
    <div class="subject"><a href="#post-181977">Add a large number of items into a ListView</a></div>
    <div class="body">In borland Delphi or C++ Builder, You can speed up the insertion process of items into a list view by making the listview stop responding to the WM_PAINT or a message of that sort, temporarily. i was wondering if any of you guys know how i could do that.<br /><br />btw, the method is called BeginUpdate. E.g : ListView1.Items.BeginUpdate and then ListView1.Items.EndUpdate</div>
    <div class="meta">Posted on 2006-06-17 02:55:51 by XCHG</div>
   </div>
   <div class="post" id="post-182012">
    <div class="subject"><a href="#post-182012">Re: Add a large number of items into a ListView</a></div>
    <div class="body">If you know how many items you&#39;ll be adding, you can start by sending a LVM_SETITEMCOUNT - this will keep the listview from constantly reallocating, and will speed things up a bit. Even if you don&#39;t know the exact number, you could send an approximation.<br /><br />Then, send a WM_SETREDRAW messages to disable updating, add all your items, and send a WM_SETREDRAW again, to enable updating.<br /><br />If you need a *lot* of items in a listview, consider using a virtual listview instead. It&#39;s not difficult to code, and can be a LOT faster.<br /></div>
    <div class="meta">Posted on 2006-06-17 06:22:16 by f0dder</div>
   </div>
   <div class="post" id="post-182026">
    <div class="subject"><a href="#post-182026">Re: Add a large number of items into a ListView</a></div>
    <div class="body">To answer the question, you need to SUBCLASS the control, and point its WndProc at a &#39;dummy wndproc&#39; which &#39;suppresses unwanted WMs&#39; - then add your items, then restore the original wndproc.<br /><br />I&#39;ve never heard of this being used to speed up the adding of elements to a listview, but I&#39;m no great win gui coder.<br /></div>
    <div class="meta">Posted on 2006-06-17 13:56:02 by Homer</div>
   </div>
   <div class="post" id="post-182029">
    <div class="subject"><a href="#post-182029">Re: Add a large number of items into a ListView</a></div>
    <div class="body">Homer, that sounds like quite the roundabout way of doing it when WM_SETREDRAW ought to work :)</div>
    <div class="meta">Posted on 2006-06-17 15:24:59 by f0dder</div>
   </div>
   <div class="post" id="post-182352">
    <div class="subject"><a href="#post-182352">Re: Add a large number of items into a ListView</a></div>
    <div class="body">Both of them worked, thanks a million guys</div>
    <div class="meta">Posted on 2006-06-22 09:12:51 by XCHG</div>
   </div>
   <div class="post" id="post-182435">
    <div class="subject"><a href="#post-182435">Re: Add a large number of items into a ListView</a></div>
    <div class="body">If you have a very large number of items to use in your listview you should be using a virtual listview. The virtual listview allows you to only be concerned with what is actually being displayed and to generate the data only when needed. It is always fast and does not have the memory load of a normal listview with thousands of items. The hex viewer of WinExplorer uses a virtual listview to display files in hex.<br /><br />Donkey</div>
    <div class="meta">Posted on 2006-06-24 06:51:39 by donkey</div>
   </div>
   <div class="post" id="post-182706">
    <div class="subject"><a href="#post-182706">Re: Add a large number of items into a ListView</a></div>
    <div class="body">Alright i think i finally got a hold of this. thanks to you guys. appreciations</div>
    <div class="meta">Posted on 2006-07-01 03:39:43 by XCHG</div>
   </div>
  </div>
 </body>
</html>