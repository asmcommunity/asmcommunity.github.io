<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Safe subclassing library (unrestricted open source) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17958" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=17958">Safe subclassing library (unrestricted open source)</a></p>
   <div class="post" id="post-138629">
    <div class="subject"><a href="#post-138629">Safe subclassing library (unrestricted open source)</a></div>
    <div class="body">This library allows programmers to safely subclass and unsubclass any windows, of any class, in any order, any time. The only restriction is that all subclassed windows MUST belong to the same thread.<br /><br />It's particularly useful to do this in applications that support addins (also called plugins) that can be loaded or unloaded at arbitrary times. Using this library, the addins can subclass any windows belonging to the main application or other addins.<br /><br />A linked list is mantained to keep the data belonging to each subclassed window. In turn, for each window there is a linked list of window procedures. In all lists items will be inserted in the beginning, so recently added window procedures will be executed first. This mimics the behavior of a &quot;normal&quot; subclassing chain.<br /><br />The code was tested under Win98SE, but should work OK in any other Windows version.<br /><br />As usual any feedback is welcome. :)</div>
    <div class="meta">Posted on 2004-04-11 15:45:39 by QvasiModo</div>
   </div>
   <div class="post" id="post-138720">
    <div class="subject"><a href="#post-138720">Safe subclassing library (unrestricted open source)</a></div>
    <div class="body">Hi,<br /><br />I will definately use it for the WinAsm Studio Add-Ins. Thanks for the good work. If I face any problems with it I will let you know.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-04-12 14:41:16 by akyprian</div>
   </div>
   <div class="post" id="post-138722">
    <div class="subject"><a href="#post-138722">Safe subclassing library (unrestricted open source)</a></div>
    <div class="body">Great! :alright:<br />Here's a new version (1.01) that will fit your purposes better... I've added a new function (GetNextWndProc) that takes only 2 parameters. That way it can be supported as a window message too. :)</div>
    <div class="meta">Posted on 2004-04-12 14:47:45 by QvasiModo</div>
   </div>
   <div class="post" id="post-138831">
    <div class="subject"><a href="#post-138831">Safe subclassing library (unrestricted open source)</a></div>
    <div class="body">BTW, has anyone tried the C++ header? It's the only thing I didn't test.</div>
    <div class="meta">Posted on 2004-04-13 10:08:20 by QvasiModo</div>
   </div>
   <div class="post" id="post-139165">
    <div class="subject"><a href="#post-139165">Safe subclassing library (unrestricted open source)</a></div>
    <div class="body">Updated (version 1.02).<br />Now it's thread-safe. :)<br /><br />I would strongly recommend to keep all versions under different names, then link to the one you need. That would minimize the code overhead by using the implementation that has only the features the app really needs.</div>
    <div class="meta">Posted on 2004-04-16 15:18:40 by QvasiModo</div>
   </div>
  </div>
 </body>
</html>