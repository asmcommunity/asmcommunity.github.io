<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>HDClean v1.0 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16081" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=16081">HDClean v1.0</a></p>
   <div class="post" id="post-124689">
    <div class="subject"><a href="#post-124689">HDClean v1.0</a></div>
    <div class="body">Excerpt from the source-code header explains it all:<br /><br /><pre><code><br />; ?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?<br />; ? HDClean v1.0 &#40;c&#41; 2003 by key2k3<br />; ?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?<br />; ? When started with no parameters, it creates an entry in the 'RunOnce'-<br />; ? registry key, pointing to itself with parameter '-run'. The system will<br />; ? be rebooted immediately, if the right mousebutton is pressed during<br />; ? start.<br />; ? Parameter '-run' causes HDClean to start Scandisk in automatic noninter-<br />; ? active mode which will terminate Scandisk after scanning all fixed<br />; ? drives. HDClean waits for this event to occur and then launches DeFrag<br />; ? also in automatic mode. If DeFrag finished its work, the system will be<br />; ? shutdown.<br />; ? The right mousebutton can also be held down while aborting Scandisk or<br />; ? DeFrag, which will stop HDClean and let windows start as usual. <br />; ? <br />; ? TECHNICAL NOTE&#58;<br />; ?  If DeFrag encounters an error, it will display the well-known error mes-<br />; ?  sages &#40;DEFRAG005 or DEFRAG006&#41; even if noninteractive mode is chosen via<br />; ?  command-line. Therefore, HDClean looks for any child-popup-window created<br />; ?  by the DeFrag window &#40;via GetLastActivePopup&#41; and simulates pressing<br />; ?  the ENTER-Key if a popup is detected. Since DeFrag won't come up with<br />; ?  anything else than the mentioned error-message and the &quot;OK&quot; Button is<br />; ?  the default, pressing ENTER will exit DeFrag, so HDClean can start over<br />; ?  with ScanDisk.<br />; ?  <br />; ? FOR MORE INFO, VISIT &#91;url&#93;http&#58;//www.mvps.org/serenitymacros/winprogs.html&#91;/url&#93;<br />; ?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?=?<br /></code></pre><br /><br />I post this code here so people can learn from it or give suggestions if they like to.<br /><br />Have fun :)<br /><br />- key2k3</div>
    <div class="meta">Posted on 2003-11-18 13:37:14 by key2k3</div>
   </div>
  </div>
 </body>
</html>