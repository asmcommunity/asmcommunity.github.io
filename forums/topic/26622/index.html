<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Modifying the System Menu - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26622" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26622">Modifying the System Menu</a></p>
   <div class="post" id="post-192370">
    <div class="subject"><a href="#post-192370">Modifying the System Menu</a></div>
    <div class="body">hi, I would like to Gray-out some commands in the system menu: Maximize and Size. My App is a dialog box, so this shouldn't involve anything like window class structure..
Any Ideas?
this should be easy.

Cheers. 
And thanks to all the other ppl that helped me before.</div>
    <div class="meta">Posted on 2001-01-18 13:26:00 by your mama</div>
   </div>
   <div class="post" id="post-192371">
    <div class="subject"><a href="#post-192371">Modifying the System Menu</a></div>
    <div class="body">I belive you just set the dialog's flags in your editor (OR in the *.rc file) and make sure it has the Non sizable border and does not have the maximize button style.

- Ben</div>
    <div class="meta">Posted on 2001-01-18 21:01:00 by cyberben </div>
   </div>
   <div class="post" id="post-192372">
    <div class="subject"><a href="#post-192372">Modifying the System Menu</a></div>
    <div class="body">Hi your mama,
You must call the GetSystemMenu API function :look
data?
hSysMenu dd ?
...

.code
...
            INVOKE GetSystemMenu,hWnd,0
            mov hSysMenu,eax
            INVOKE DeleteMenu,hSysMenu,2,MF_BYPOSITION
            INVOKE DeleteMenu,hSysMenu,3,MF_BYPOSITION
            INVOKE DeleteMenu,hSysMenu,3,MF_BYPOSITION

it deletes 3 menuitems, but you can also modify them to grey them. (I use it on my new prog : www.vombonjour.fr.st/asm/asm32/anglais/Get&Set_en.zip

Vom-bonjour:-()</div>
    <div class="meta">Posted on 2001-01-18 21:02:00 by Vom-bonjour:-()</div>
   </div>
   <div class="post" id="post-192373">
    <div class="subject"><a href="#post-192373">Modifying the System Menu</a></div>
    <div class="body">You can disable and gray out menu items with EnableMenuItem.</div>
    <div class="meta">Posted on 2001-01-18 23:37:00 by tank </div>
   </div>
  </div>
 </body>
</html>