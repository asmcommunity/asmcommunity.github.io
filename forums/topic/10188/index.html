<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ZLIB for MASM32! - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10188" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10188">ZLIB for MASM32!</a></p>
   <div class="post" id="post-76389">
    <div class="subject"><a href="#post-76389">ZLIB for MASM32!</a></div>
    <div class="body">Well this was a very fast hack once i got the infor off the web.<br /><br />I made up a ZLIB.INC and ZLIB.LIB for compression of files.<br /><br />I needed it cause Adobe PDF's use this compression as its default.  (and im playing with PDF's today ;) )<br /><br />Anywho.  It seems to work, but i only did a very basic test.  The structure is unverified ~ it was translated by hand, however im giving you all the needed info to use the lib and read the C++ function definitions.<br /><br />Enjoy ;)<br />NaN<br /><br />(( O ya, i have a test file in there too ))</div>
    <div class="meta">Posted on 2003-01-15 00:41:15 by NaN</div>
   </div>
   <div class="post" id="post-76390">
    <div class="subject"><a href="#post-76390">ZLIB for MASM32!</a></div>
    <div class="body"><strong>NaN:</strong> on my NT4SP6 test.exe starts <strong>12</strong> :grin:  empty debug windows.<br /><br />beside this, it works perfectly. but it was fun to see 12 eyes in taskbar ... hehe<br />thanks :alright:</div>
    <div class="meta">Posted on 2003-01-15 01:06:30 by TBD</div>
   </div>
   <div class="post" id="post-76401">
    <div class="subject"><a href="#post-76401">ZLIB for MASM32!</a></div>
    <div class="body">Nice job:alright: <br />NaN,you can use Hutch's inc2l tool to get the import library.<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=8494">http://www.asmcommunity.net/board/index.php?topic=8494</a><br /><br />Regards,<br /><br />Vortex</div>
    <div class="meta">Posted on 2003-01-15 02:25:36 by Vortex</div>
   </div>
   <div class="post" id="post-76432">
    <div class="subject"><a href="#post-76432">ZLIB for MASM32!</a></div>
    <div class="body">The stack does'nt seem to be restored correctly.<br />This does'nt show up in you're simple test because <br />you ExitProcess, but if you call it from another proc it crashes!<br /><br />before compress ESP=12FFB4<br />upon return ESP=12FFA4<br /><br />before uncompress ESP=12FFA4<br />upon return ESP=12FF94</div>
    <div class="meta">Posted on 2003-01-15 07:08:27 by gfalen</div>
   </div>
   <div class="post" id="post-76442">
    <div class="subject"><a href="#post-76442">ZLIB for MASM32!</a></div>
    <div class="body">Hi, All !<br /><br />The stack does'nt seem to be restored correctly<br />becouse all function from ZLIB.DLL have C calling conversion...<br /><br />look this</div>
    <div class="meta">Posted on 2003-01-15 08:10:24 by Eviloid</div>
   </div>
   <div class="post" id="post-76504">
    <div class="subject"><a href="#post-76504">ZLIB for MASM32!</a></div>
    <div class="body">Here is my attempt.Included zip file has zlibstat.lib and zlibstat.inc and one example.You can link zlib *statically* and use every function from it.Plus it has also basic zipping and unzipping support.In the example I used zipping capabilities of library.I didnt examined unzipping functions.I will appreciate if you guys make wrappers for zipping and unzipping.</div>
    <div class="meta">Posted on 2003-01-15 16:05:26 by LaptoniC</div>
   </div>
   <div class="post" id="post-76505">
    <div class="subject"><a href="#post-76505">ZLIB for MASM32!</a></div>
    <div class="body">opps forgot to attach file.</div>
    <div class="meta">Posted on 2003-01-15 16:07:45 by LaptoniC</div>
   </div>
   <div class="post" id="post-76517">
    <div class="subject"><a href="#post-76517">ZLIB for MASM32!</a></div>
    <div class="body">Thanx everyone.<br /><br />I didnt realize the stack issue last night... Hmm thats what you get when you rush i guess ;)<br /><br />As well i was not aware there was a static version kicking around.  (Even better).<br /><br />As for the debug on NT, well that VKIM's boat ;) .  Must be something in how he does the exception handling or something..... ??<br /><br />NaN</div>
    <div class="meta">Posted on 2003-01-15 17:31:48 by NaN</div>
   </div>
   <div class="post" id="post-76545">
    <div class="subject"><a href="#post-76545">ZLIB for MASM32!</a></div>
    <div class="body">Hello, NaN! Nice to meet you!;)<br />I cannot explain yet why debugging macros don't work on NT. I run your program on Win2k and it did the job very well.</div>
    <div class="meta">Posted on 2003-01-15 21:15:31 by vkim</div>
   </div>
   <div class="post" id="post-78692">
    <div class="subject"><a href="#post-78692">ZLIB for MASM32!</a></div>
    <div class="body">Laptonic,<br /><br />I finally got around to using (and verifying) your static lib.  As far as i can tell, its linking to MSVCRT.LIB with in turn simply links to the run time .dll in your system directory.  So unless im wrong here, your lib is the same thing with more linking between libraries.  I discovered this, cause i dont have libc.lib, msvcrt.lib, &amp; uuid.lib in my masm directory (but they are in the PSDK).<br /><br />NaN</div>
    <div class="meta">Posted on 2003-01-27 19:52:22 by NaN</div>
   </div>
   <div class="post" id="post-78848">
    <div class="subject"><a href="#post-78848">ZLIB for MASM32!</a></div>
    <div class="body">I have removed all msvc libraries from source I guess.only gz functions have msvc libraries.In the example I provided I was using zipping functionality and it dont have any msvcrt import ??:confused:</div>
    <div class="meta">Posted on 2003-01-28 18:00:19 by LaptoniC</div>
   </div>
   <div class="post" id="post-78862">
    <div class="subject"><a href="#post-78862">ZLIB for MASM32!</a></div>
    <div class="body">Ok you are right I am not familiar with this visual c therefore I fucked up I guess.Anyway after some working I guess I have found and fixed problem.Please check it and letme know.</div>
    <div class="meta">Posted on 2003-01-28 20:27:05 by LaptoniC</div>
   </div>
   <div class="post" id="post-78863">
    <div class="subject"><a href="#post-78863">ZLIB for MASM32!</a></div>
    <div class="body">Why I allways forgot to attach :)</div>
    <div class="meta">Posted on 2003-01-28 20:28:58 by LaptoniC</div>
   </div>
   <div class="post" id="post-79086">
    <div class="subject"><a href="#post-79086">ZLIB for MASM32!</a></div>
    <div class="body">Pretty cool!<br /><br />I failed to mention your example crashes on windows98se..  dont know why. <br /><br />But i did copy your lib and include out and used it with my sample program and it worked perfectly (and better than my sloppy attemp, cause it preserves the stack as well ;)  )<br /><br />Thanks alot.  But i have to ask, what was the mistake?<br />:NaN:</div>
    <div class="meta">Posted on 2003-01-29 22:13:55 by NaN</div>
   </div>
   <div class="post" id="post-79241">
    <div class="subject"><a href="#post-79241">ZLIB for MASM32!</a></div>
    <div class="body">In order to create local variables Visual C seems to use one function chkstk.I made lsting file and found that.After that I have assembled all asm files created by visual c and linked with chkstk.obj.You can find hisfile even in the masm distribution.That is the story :) <br />I dont know why it fails but in my win98se my example works dunno why</div>
    <div class="meta">Posted on 2003-01-30 16:14:50 by LaptoniC</div>
   </div>
   <div class="post" id="post-79286">
    <div class="subject"><a href="#post-79286">ZLIB for MASM32!</a></div>
    <div class="body">iirc, chkstk is used when you have more than 4k (or what you specified in the compile settings) of local variables. It's used to pre-touch the stack space, so you can have random (as opposed to linear) access to stack variables. Read up on stack and guard pages to see why :)</div>
    <div class="meta">Posted on 2003-01-31 02:17:33 by f0dder</div>
   </div>
  </div>
 </body>
</html>