<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Loading and displaying JPEG in a window - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10834" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=10834">Loading and displaying JPEG in a window</a></p>
   <div class="post" id="post-81616">
    <div class="subject"><a href="#post-81616">Loading and displaying JPEG in a window</a></div>
    <div class="body">Hi to avery body, I have a question about loading a JPEG image from a file and displaying it on a window; I being searching the web for accouple hours but have not found too much, all i know is the windows has a build-in librery called Ole32.dll and Ole32pro.dll that have a few functions for this, the must important functions are: CreateStreamOnHGlobal and OleLoadPicture with does two and some more you should be able to do it, but I don't know how to use them and I don't have the value for IID_IPicture variable, I found a sample in <a target="_blank" href="http://ourworld.compuserve.com/homepages/ernies_world/a.htm">http://ourworld.compuserve.com/homepages/ernies_world/a.htm</a> but is made for MASM not FASM and FASM doesn't have coinvoke macro and the .if macro doesn't work (but that's not a big problem).<br /><br />What I'm trying to do is include the JPEG file in the resource section and then use the LoadBitmap to get the image handle and then pass it to CreatePatternBrush to create a brush with the image to use it as a Window default background; here is the code for that (it works but only with BMP files).<br /><br /><br />        invoke  LoadBitmap,,IDB_ASSIGN<br />        invoke  CreatePatternBrush,eax<br />        mov     ,eax<br /><br /><br />COULD SOME BODY HELP ME PLEASE!!!</div>
    <div class="meta">Posted on 2003-02-13 16:33:35 by alonso</div>
   </div>
   <div class="post" id="post-81623">
    <div class="subject"><a href="#post-81623">Loading and displaying JPEG in a window</a></div>
    <div class="body"><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=4239&amp;perpage=15&amp;highlight=image&amp;pagenumber=1">http://www.asmcommunity.net/board/index.php?topic=4239&amp;perpage=15&amp;highlight=image&amp;pagenumber=1</a><br /><br />ernie's image library might be of assistance to you. :)</div>
    <div class="meta">Posted on 2003-02-13 16:57:25 by Hiroshimator</div>
   </div>
   <div class="post" id="post-81639">
    <div class="subject"><a href="#post-81639">What's Ernie's web site address</a></div>
    <div class="body"><div class="quote"><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=4239&amp;perpage=15&amp;highlight=image&amp;pagenumber=1">http://www.asmcommunity.net/board/index.php?topic=4239&amp;perpage=15&amp;highlight=image&amp;pagenumber=1</a><br /><br />ernie's image library might be of assistance to you. :) </div><br /><br />Thank's for your reply, but can you please tell me what's What's Ernie's web site address!!!</div>
    <div class="meta">Posted on 2003-02-13 17:58:59 by alonso</div>
   </div>
   <div class="post" id="post-81741">
    <div class="subject"><a href="#post-81741">Loading and displaying JPEG in a window</a></div>
    <div class="body"><a target="_blank" href="http://ourworld.compuserve.com/homepages/ernies_world/a.htm">http://ourworld.compuserve.com/homepages/ernies_world/a.htm</a><br /><br />you might wish to check our FAQ forum, much info there :)</div>
    <div class="meta">Posted on 2003-02-14 05:24:55 by Hiroshimator</div>
   </div>
  </div>
 </body>
</html>