<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Compiling through process - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1559" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1559">Compiling through process</a></p>
   <div class="post" id="post-9975">
    <div class="subject"><a href="#post-9975">Compiling through process</a></div>
    <div class="body">Hey folks,<br /><br />i got one little problem, may be you guys can help<br />have a look at this code:<br /><pre><code><br />.386<br />.model flat,stdcall<br />option casemap&#58;none<br /><br />include \masm32\include\windows.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\gdi32.inc<br />include \masm32\include\masm32.inc<br />include \masm32\include\shell32.inc<br />include \masm32\include\comctl32.inc<br />include \masm32\include\comdlg32.inc<br />include \masm32\include\advapi32.inc<br />include \masm32\include\crypt32.inc<br /><br />includelib \masm32\lib\shell32.lib<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\gdi32.lib<br />includelib \masm32\lib\masm32.lib<br />includelib \masm32\lib\comctl32.lib<br />includelib \masm32\lib\comdlg32.lib<br />includelib \masm32\lib\advapi32.lib<br />includelib \masm32\lib\crypt32.lib<br /><br />DlgProc PROTO &#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD<br /><br />.data<br /><br />DlgName         db &quot;Modifier&quot;,0<br />MenuName        db &quot;ModiMenu&quot;,0<br />StatusText      db &quot;by |TyPhOoN|&quot;,0<br />Text            db &quot;The text&quot;,0<br />Openfiles       OFSTRUCT&lt;&gt;<br />FileName        db &quot;\masm32\bin\ml.exe&quot;,0 <br />CommandLine     db &quot; /c /coff /Cp \masm32\bin\button.asm&quot;,0<br />FileName2       db &quot;\masm32\bin\link.exe&quot;,0<br />CommandLine2    db &quot; /SUBSYSTEM&#58;WINDOWS /LIBPATH&#58;c&#58;\masm32\lib \masm32\bin\button.obj&quot;,0<br />processInfo PROCESS_INFORMATION &lt;&gt; <br /><br />.data?<br />hInstance     HINSTANCE ?<br />hWritten      dd ?<br />hInput        dd ?<br />hOutput       dd ?<br /><br />.const<br />IDC_APPLY     equ      3001 <br /><br />IDM_EXIT      equ      4001<br />IDM_ABOUT     equ      4002<br /><br />IDS_STATUS    equ      5001<br /><br /><br />.code<br />start&#58;<br /><br />invoke GetModuleHandle, NULL<br />mov hInstance, eax<br />invoke DialogBoxParam, hInstance, ADDR DlgName,NULL, addr DlgProc, NULL <br />invoke ExitProcess,eax <br /><br />DlgProc proc hWin &#58;DWORD, uMsg &#58;DWORD, wParam &#58;DWORD, lParam &#58;DWORD<br /> LOCAL startInfo&#58;STARTUPINFO<br />.IF uMsg==WM_COMMAND <br />      mov eax,wParam <br />      mov edx,wParam <br />      shr edx,16 <br />       .IF dx==BN_CLICKED <br />         <br />         .IF ax==IDM_EXIT<br />             invoke SendMessage,hWin,WM_CLOSE,0,0<br />         .ELSEIF ax==IDC_APPLY<br />             invoke AllocConsole<br />             invoke GetStdHandle, STD_INPUT_HANDLE<br />             mov hInput, eax<br />             invoke GetStdHandle, STD_OUTPUT_HANDLE<br />             mov hOutput, eax<br />             invoke WriteConsole,hOutput,addr Text,8,addr hWritten,NULL         <br />             invoke GetStartupInfo,ADDR startInfo <br />             invoke CreateProcess,addr FileName,addr CommandLine,NULL,NULL,FALSE,\ <br />                                  NORMAL_PRIORITY_CLASS,\ <br />                                  NULL,NULL,ADDR startInfo,ADDR processInfo<br />             invoke CloseHandle,processInfo.hThread <br />             invoke CreateProcess,addr FileName2,addr CommandLine2,NULL,NULL,FALSE,\ <br />                                  NORMAL_PRIORITY_CLASS,\ <br />                                  NULL,NULL,ADDR startInfo,ADDR processInfo                      <br />             invoke CloseHandle,processInfo.hThread <br />  <br /><br />             <br />         .ENDIF<br />         <br />        .ENDIF      <br />.ELSEIF uMsg==WM_INITDIALOG<br />     <br />.ELSEIF uMsg==WM_CLOSE<br />        invoke EndDialog,hWin,NULL<br /><br />.ENDIF<br />ret<br />DlgProc endp<br />end start<br /></code></pre><br />Well, everything actually works fine, except if i have the obj file in the bin folder of masm32.<br />How come and how can i fix that ?</div>
    <div class="meta">Posted on 2001-10-22 13:01:51 by Olli</div>
   </div>
   <div class="post" id="post-9983">
    <div class="subject"><a href="#post-9983">Batch file</a></div>
    <div class="body">If this is what I think it is, please use this batch file process instead...<br /><br />1. Make a file call &quot;build.bat&quot; (or whatever you want as long as it is .bat)<br />2. Place this file in the directory with your assembly code file.<br />3. Edit this file and put this in it...<br /><br />@ECHO OFF<br />CLS<br />C:\masm32\bin\ml /c /coff /Cp filename.asm |more<br />C:\masm32\bin\rc filename.rc<br />C:\masm32\bin\link /SUBSYSTEM:WINDOWS /LIBPATH:c:\masm32\lib filename.obj &quot;.\filename.res&quot;<br /><br />4. Replace the &quot;filename&quot; name in the batch file with the name of the assembly file you are going to use.<br />5. If you are not going to use the resource script compiler, then put &quot;REM &quot; on line 4 so it looks like this...<br />REM C:\masm32\bin\rc filename.rc<br />then erase the &quot;&quot;.\filename.res&quot;&quot; from line 5/6.<br />6. The &quot;|more&quot; command will allow you to see all of your code errors instead of the command prompt spewing out all of it for you to miss.</div>
    <div class="meta">Posted on 2001-10-22 13:40:06 by SpooK</div>
   </div>
  </div>
 </body>
</html>