<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Crude Wordpad automation - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1316" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=1316">Crude Wordpad automation</a></p>
   <div class="post" id="post-8475">
    <div class="subject"><a href="#post-8475">Crude Wordpad automation</a></div>
    <div class="body">I wrote the attached Win32asm program to replace a<br />Windows Scripting Host (WHS) script.  The script was<br />designed to:<br /><br />Automatically open WordPad<br />Open a previously constructed Rich Text Format file <br />Change orientation to Landscape<br />Change all borders to 0.25&quot;<br /><br />At this point the user can view the report, insert<br />page breaks, enter comments, and then print the <br />report.<br /><br />When I first tried to do this using asm, I thought I<br />could just open WordPad with the filename in the<br />command line, find the window name, and send messages<br />using PostMessage or SendMessage.  This didn't work<br />at all.  I later found on the MSDN pages a reference<br />that stated that applications built using MFC don't <br />handle the PostMessage and SendMessage messages at <br />all.<br /><br />So instead, the program does not create any window and<br />therefore never gets focus for keyboard input.  After<br />WordPad is opened, it gets focus, and the keybd_event<br />actions are sent to WordPad.  Actually they are sent to<br />whichever window has focus.  I ran an experiment where<br />I inserted a pause after opening WordPad, then changed <br />to an already opened Notepad window and after my program<br />finishes it's pause, the keybd_event is sent to the<br />Notepad window.<br /><br />I tried AttachThreadInput to send my key stokes directly<br />to the WordPad thread I created, but the same thing <br />happened if the focus was changed to a different window.<br /><br />I thought this might be helpful.  My reasoning was that<br />WSH and VBS can be dangerous if installed and set to<br />automatically execute scripts from downloaded e-mail.<br />If anyone has anothe way of accomplishing something <br />similar, or has a better way, or suggestions for <br />improvement I would be grateful to this knowledge!<br /><br />Farrier</div>
    <div class="meta">Posted on 2001-10-02 05:26:24 by farrier</div>
   </div>
   <div class="post" id="post-212815">
    <div class="subject"><a href="#post-212815">Re: Crude Wordpad automation</a></div>
    <div class="body">Hi, looking for a way to automate wordpad to load with orientation set to Landscape. Please can you advise if you managed to develop a script to do this, as i&#039;m trying to find a way. Thanks<br /></div>
    <div class="meta">Posted on 2010-08-19 03:42:32 by uklogistics</div>
   </div>
   <div class="post" id="post-212824">
    <div class="subject"><a href="#post-212824">Re: Crude Wordpad automation</a></div>
    <div class="body">uklogistics,<br /><br />The attachment is lost for some reason, and I don&#039;t have that file on my current computer.&nbsp; I&#039;ll see if I can find it on my old machines later today.<br /><br />farrier<br /></div>
    <div class="meta">Posted on 2010-08-19 10:19:34 by farrier</div>
   </div>
  </div>
 </body>
</html>