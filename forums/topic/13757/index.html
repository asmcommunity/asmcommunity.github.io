<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Dll-Problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13757" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=13757">Dll-Problem</a></p>
   <div class="post" id="post-106515">
    <div class="subject"><a href="#post-106515">Dll-Problem</a></div>
    <div class="body">Hi, I have Programmed a dll but it isn't runable on other copmputers.<br /><br />the message &quot;error at inizialisation...&quot; appears.<br /><br />that's the source:<br /><pre><code><br />dll_begin       PROC    hInstDLL&#58;HINSTANCE, reason&#58;DWORD, reserved1&#58;DWORD<br />                <br />                MOV EAX, hInstDLL<br />                MOV h_dll, EAX<br />                <br />                MOV EAX, TRUE                     <br />                <br />                RET<br />dll_begin       ENDP<br /></code></pre></div>
    <div class="meta">Posted on 2003-06-09 10:30:52 by Forginforcer</div>
   </div>
   <div class="post" id="post-106599">
    <div class="subject"><a href="#post-106599">Dll-Problem</a></div>
    <div class="body">this is a skeleton i got<br /><br /><br /><pre><code><br />;-------------------------------------------------------------------------------------- <br />;                           DLLSkeleton.asm <br />;-------------------------------------------------------------------------------------- <br />.386 <br />.model flat,stdcall <br />option casemap&#58;none <br /><br />extrn           xxxx            &#58;proc<br /><br /><br />.data <br />.code <br /><br />DllEntry        PROC hInstDLL&#58;DWORD, reason&#58;DWORD, reserved&#58;DWORD<br />                &#91;put initialization code here&#93;<br />                ret<br />DllEntry        ENDP<br /><br />SomeProc        PROC<br />                ret<br />SomeProc        ENDP<br /><br />PUBLICDLL       SomeProc<br /><br />End             DllEntry<br /><br /><br />SAMPLE.DEF<br /><br />LIBRARY Sample<br />EXPORTS<br />SomeProc<br /><br /></code></pre><br />Seems the same, except for   &quot;End             DllEntry&quot;. <br />Hope it could help :)<br /><br />B7</div>
    <div class="meta">Posted on 2003-06-10 01:42:26 by Bit7</div>
   </div>
   <div class="post" id="post-106603">
    <div class="subject"><a href="#post-106603">Dll-Problem</a></div>
    <div class="body">is it oblicated to neme the entryfunction DDLEntry???</div>
    <div class="meta">Posted on 2003-06-10 02:33:37 by Forginforcer</div>
   </div>
   <div class="post" id="post-106628">
    <div class="subject"><a href="#post-106628">Dll-Problem</a></div>
    <div class="body">No it isn't. I always call mine DllMain. All that matters is the name is exported properly. <br /><br />Unfortunately, I forget how that detail is accomplished, but Icz describes it in his classic tut.</div>
    <div class="meta">Posted on 2003-06-10 06:58:16 by Ernie</div>
   </div>
   <div class="post" id="post-107060">
    <div class="subject"><a href="#post-107060">Dll-Problem</a></div>
    <div class="body">You can name your dll's entry point any name as you want. The rules, (as what I know) to make it the dll's entry point, are <br /><br />1. Add its name in the END stament. To make Test_Entry as the Dll's Entry, here's my code<pre><code>.CODE<br /><br />Func1 Proc <br />    ret<br />Func1 EndP<br /><br />Test_Entry Proc hInstance&#58;Dword, reason&#58;Dword, lpres&#58;Dword<br />    mov eax, 1<br />    ret<br />Test_Entry EndP<br /><br />&#91;B&#93;END Test_Start&#91;/B&#93;</code></pre>2. Specify &quot;/ENTRY:Test_Start&quot; in the linker.<br /><br />Hope it will help you</div>
    <div class="meta">Posted on 2003-06-14 01:58:25 by rxbagain</div>
   </div>
   <div class="post" id="post-107063">
    <div class="subject"><a href="#post-107063">Dll-Problem</a></div>
    <div class="body"><pre><code><br />&quot;/ENTRY&#58;Test_Start&quot;<br /></code></pre><br />That it was!<br /><br />thanks a lot !</div>
    <div class="meta">Posted on 2003-06-14 02:50:15 by Forginforcer</div>
   </div>
  </div>
 </body>
</html>