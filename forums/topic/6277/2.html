<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Message Loop (for games) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6277" />
  <link rel="prev" href="../?id=6277&amp;page=1" />  <link rel="next" href="../?id=6277&amp;page=3" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=6277">Message Loop (for games)</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=6277&amp;page=1" style="">&laquo;</a><a href="../?id=6277&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="6277" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=6277&amp;page=3">&gt;</a><a href="../?id=6277&amp;page=3">&raquo;</a></form>   <div class="post" id="post-45544">
    <div class="subject"><a href="#post-45544">Message Loop (for games)</a></div>
    <div class="body">Yes, precision is few thousands Hz.. but, you know, I'm maniacal when it comes to precision and don't consider that precise. :grin:<br />I'm immersed into urgent work, but after I finish that I'll post a &quot;definitive&quot; CPU speed routine (cumulative precision, i.e. after some seconds it goes down to the Hz.. so RDTSC is all one needs for any critical timings application). :)<br /><br />Still, I'd like to see if QPx really doesn't work on Bog's HP PC.<br /><br />Thank you to all those that tested it.<br /><br /><strong>bitRAKE</strong>: just curious.. did you copy it by hand, or do you have a clipboard capable of copying from simple MessageBox:es? :)</div>
    <div class="meta">Posted on 2002-06-28 03:32:47 by Maverick</div>
   </div>
   <div class="post" id="post-45557">
    <div class="subject"><a href="#post-45557">Message Loop (for games)</a></div>
    <div class="body"><strong>Maverick,</strong><br /><br />Just press CTRL+C when the MessageBox has the focus and insert it with CTRL+V:<br /><br /><pre><code><br />---------------------------<br />Message HEX U64<br />---------------------------<br />000000003B9B6CF0<br />---------------------------<br />OK   <br />---------------------------<br /></code></pre><br /><br />(made on my machine here at work)</div>
    <div class="meta">Posted on 2002-06-28 04:05:26 by bazik</div>
   </div>
   <div class="post" id="post-45560">
    <div class="subject"><a href="#post-45560">Message Loop (for games)</a></div>
    <div class="body">Uh.. thanks <strong>bAZiK</strong> it's always nice to learn something new :)<br /><br />This is something I don't like of Windows: lack of &quot;orthogonality&quot; (linearity?). For example, you can't highlight with the mouse the text on the MessageBox, thus I thought there was no clipboard support. Also, no menu was available for that. But CTRL-C works.. argh.<br /><br />It happens for many other things.. like in the Connect To Internet box, where sometimes things f**k up, and if you click on Connect it doesn't work, but if you press Enter it does. :grin:<br /><br />I think that both actions should trigger the same code, not two different routines that do the same thing.<br /><br />I'd have many other examples, but I tend to forget such traumatic experiences. :grin:<br /><br />&lt;EDIT&gt;It just happened again, for example, that if I press the ATX poweroff button it doesn't want to shut down anymore, but commanding it from the menu it does.. bah&lt;/EDIT&gt;<br /><br />Anyway, thanks for the tip.. I'm a bit less ignorant now in my life. :alright:</div>
    <div class="meta">Posted on 2002-06-28 04:12:03 by Maverick</div>
   </div>
   <div class="post" id="post-45562">
    <div class="subject"><a href="#post-45562">Message Loop (for games)</a></div>
    <div class="body"><div class="quote"><br /><br />&lt;EDIT&gt;It just happened again, for example, that if I press the ATX poweroff button it doesn't want to shut down anymore, but commanding it from the menu it does.. bah&lt;/EDIT&gt;<br /><br /> </div><br /><br />You can set in the &quot;Energy Options&quot; what should happen when you press the poweroff button: Standby, Shutdown, Sleep, Nothing :)<br /><br />I set it to &quot;Nothing&quot; on my box, because I often hit the Butten when I put a CD from the Burner to the DVD drive :)</div>
    <div class="meta">Posted on 2002-06-28 04:14:51 by bazik</div>
   </div>
   <div class="post" id="post-45570">
    <div class="subject"><a href="#post-45570">Message Loop (for games)</a></div>
    <div class="body"><div class="quote"><br /><br /><br />You can set in the &quot;Energy Options&quot; what should happen when you press the poweroff button: Standby, Shutdown, Sleep, Nothing :)<br /><br />I set it to &quot;Nothing&quot; on my box, because I often hit the Butten when I put a CD from the Burner to the DVD drive :) </div>Yes, I know, and I set it to Shutdown.. but sometimes Windows just forgets it. ;)</div>
    <div class="meta">Posted on 2002-06-28 04:50:21 by Maverick</div>
   </div>
   <div class="post" id="post-46295">
    <div class="subject"><a href="#post-46295">Message Loop (for games)</a></div>
    <div class="body">I did forgot about this test,<br /><br />Just did it now and it works Ok on Win98 and on Win2k<br /><br />it uses QPF API?</div>
    <div class="meta">Posted on 2002-07-04 15:37:26 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-46320">
    <div class="subject"><a href="#post-46320">Message Loop (for games)</a></div>
    <div class="body"><div class="quote"><em>Originally posted by BogdanOntanu </em><br /><pre><code><br /><br />;=========================================<br />; so...there are no win messages....<br />; HERE we do our GAME MAIN LOOP<br />;=========================================<br /><br />nu_sunt_msg&#58;<br />	pushad<br /></code></pre></div><br /><br />Is the pushad and popad really needed?<br /><br /><div class="quote"><pre><code><br /><br />;=======================================<br />; test&#58; is game loop on? <br />; so that in future we dont make useless/dummy/dangerouse<br />; paint to screen/direct draw even on pause....<br />;=======================================<br />	Call	Game_Main<br /><br />;==================================<br />; just return to WIN message loop<br />;=================================<br />	popad			<br /><br /><br />;====================================<br />; return to main Message Loop<br />;====================================<br />	cmp	&#91;flag_no_messages&#93;,1<br />	jz	nu_sunt_msg<br /></code></pre></div><br /><br />Does Game_Main set flag_no_messages when it detects a message?  Or does some other thing set this flag_no_message flag?<br /><br /><br />Just wondering.</div>
    <div class="meta">Posted on 2002-07-04 19:41:20 by AmkG</div>
   </div>
   <div class="post" id="post-46350">
    <div class="subject"><a href="#post-46350">Message Loop (for games)</a></div>
    <div class="body"><div class="quote"><br />I did forgot about this test,<br /><br />Just did it now and it works Ok on Win98 and on Win2k<br /><br />it uses QPF API? </div>Yes, it does.<br /><br />I imagined QPx must have worked also on your HP, that's why I wanted to test it anyway.<br /><br />And these are good news. ;)<br /><br />Your previous attempts probably failed because you forgot to align (to at least a 32bit boundary) the 64bit variable that is gonna be passed to QPx via a pointer. In 9x this works, in NT it doesn't. Weird, because there's no good reason (besides Microsoft weirdness) to a behaviour like this.<br /><br />Anyway, to my best knowledge QPx works on every x86 Windows PC.</div>
    <div class="meta">Posted on 2002-07-05 02:45:33 by Maverick</div>
   </div>
   <div class="post" id="post-46374">
    <div class="subject"><a href="#post-46374">Message Loop (for games)</a></div>
    <div class="body">AMKG<br /><br />Nope the pushad/popad are not really needed (well it depends on what you do insides main game loop) but basically its just my paranoia ;)<br /><br />flag_no_messages is setup inside game main but you can ignore it for now, as its more advanced stuff ;)</div>
    <div class="meta">Posted on 2002-07-05 08:41:09 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-46431">
    <div class="subject"><a href="#post-46431">Message Loop (for games)</a></div>
    <div class="body">Ignore flag_no_messages?  So how would I exit the main game loop?</div>
    <div class="meta">Posted on 2002-07-06 03:49:17 by AmkG</div>
   </div>
   <div class="post" id="post-46438">
    <div class="subject"><a href="#post-46438">Message Loop (for games)</a></div>
    <div class="body">Please notice that in the original code i posted there are two comment lines just adviceing you to do that, code will fall thru to the <strong>jmp msg_loop</strong> instruction and and everything will go on once again...<br /><br />Game main is just a call so it will return with a <strong>ret</strong> instruction ... of course after doing one frame of GFX / game AI ;)</div>
    <div class="meta">Posted on 2002-07-06 05:26:49 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-46568">
    <div class="subject"><a href="#post-46568">Message Loop (for games)</a></div>
    <div class="body">Ooops my bad... my brain didn't process the loop properly, sorry.  So why is using a flag_no_messages more advanced, what technique would require this?</div>
    <div class="meta">Posted on 2002-07-07 09:35:57 by AmkG</div>
   </div>
   <div class="post" id="post-46732">
    <div class="subject"><a href="#post-46732">Message Loop (for games)</a></div>
    <div class="body">Well it will require that u use Directinput exclusive mode to deal with mouse and keyboard events, wait for Alt+tab and Ctrl+Alt+del in your own handler and only then reenable window  message loop after disabling your own stuff etc, just to get a little independent and a little faster, also windows messages can slow down your game sometimes... <br /><br />but you do not need such stuff for a normal beginner game ;)<br /><br />whem you will fell the need you will do so... dont try to learn too much without experience :P</div>
    <div class="meta">Posted on 2002-07-08 15:53:42 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-47388">
    <div class="subject"><a href="#post-47388">ehhm</a></div>
    <div class="body">on pentium, pentium mmx, and pII it is better to have something like this as a loopL:<br /><br /><br />check if we have message<br />if yes -&gt; jump DOWn    &lt;-- it's very important: message processing must be AFTER our loop<br /><br /><br />process some loop<br /><br />jmp 'check for message'<br /><br />process message<br />jmp 'check for message'<br /><br />it'll be faster than:   jump if there are no messages<br /><br />on my celeron it works the same:  'jumping on message' is faster than 'jumping on no-message'.<br /><br />ehhhm, anyone understands?<br /><br />it's because if CPU detects conditional jump to lower address (jump-back) it jumps in default, and it DOESN&quot;T jump in default if we have jump-forward.<br /><br />it's because CPU cannot guess, whether conditional jump will succeed.<br /><br />so:<br /><br />conditional jumps to higher addresses are guessed as failed<br />conditional jumps to lower addresses are guessed as succedded<br /><br />and then pipeline is filled with new instructions, after conditional-jump instruction.<br /><br /><br />if anyone understands thatm then e-mail me because i don't understand :)   :P.<br /><br />i know that this text is not very clean to understand, but please! i haven't slept for something about 20 hrs, so i'm going to bed right now.</div>
    <div class="meta">Posted on 2002-07-13 10:53:14 by ti_mo_n</div>
   </div>
   <div class="post" id="post-47452">
    <div class="subject"><a href="#post-47452">Message Loop (for games)</a></div>
    <div class="body">Ah... interesting....<br /><br />Say, what would WndProc handle?  I presume there's one because your doing a message loop?  Presumably it will never receive WM_PAINT anymore, so maybe it just processes WM_KEY and WM_MOUSE?</div>
    <div class="meta">Posted on 2002-07-13 22:48:30 by AmkG</div>
   </div>
   <div class="post" id="post-47948">
    <div class="subject"><a href="#post-47948">Message Loop (for games)</a></div>
    <div class="body">29D1CE84=701615748 on my Celeron700 MHz, ok.</div>
    <div class="meta">Posted on 2002-07-16 11:54:46 by scientica</div>
   </div>
   <div class="post" id="post-48309">
    <div class="subject"><a href="#post-48309">Message Loop (for games)</a></div>
    <div class="body">Maverick<br />On my home computer is not showing the expected freq.<br />In BIOS I have PIII at 933 Mhz.<br />Your progy show only 766 Mhz.<br />???</div>
    <div class="meta">Posted on 2002-07-18 02:32:21 by scarpelius</div>
   </div>
   <div class="post" id="post-48320">
    <div class="subject"><a href="#post-48320">Message Loop (for games)</a></div>
    <div class="body"><div class="quote"><br />Maverick<br />On my home computer is not showing the expected freq.<br />In BIOS I have PIII at 933 Mhz.<br />Your progy show only 766 Mhz.<br />??? </div>Please, could you test using also other utilities and report?</div>
    <div class="meta">Posted on 2002-07-18 03:35:29 by Maverick</div>
   </div>
   <div class="post" id="post-48337">
    <div class="subject"><a href="#post-48337">Message Loop (for games)</a></div>
    <div class="body">Yes, this is my intention. <br />But I have spoken whith few friends and it seems to me that I have a funny CPU. Or problem with motherboard (440BX). Any way I will test it with wcpu30g. Also I dwld a tool to test from Intel.<br />I let you know the result.</div>
    <div class="meta">Posted on 2002-07-18 05:37:34 by scarpelius</div>
   </div>
   <div class="post" id="post-48530">
    <div class="subject"><a href="#post-48530">Message Loop (for games)</a></div>
    <div class="body">Thank you.</div>
    <div class="meta">Posted on 2002-07-18 15:16:11 by Maverick</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=6277&amp;page=1" style="">&laquo;</a><a href="../?id=6277&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="6277" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=6277&amp;page=3">&gt;</a><a href="../?id=6277&amp;page=3">&raquo;</a></form>  </div>
 </body>
</html>