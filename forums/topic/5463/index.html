<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Checking Executable file Integrity - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5463" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5463">Checking Executable file Integrity</a></p>
   <div class="post" id="post-38796">
    <div class="subject"><a href="#post-38796">Checking Executable file Integrity</a></div>
    <div class="body">I need a real nice easy way of making sure someone hasn't modified my executable file.<br /><br />The simplest of course would be to load the file completely in memory and sum up each byte, then subtract the bytes composing the expected checksum, then comparing the result to the expected checksum.<br /><br />Unfortunately I wouldn't really know what the checksum would be until after the program is written WITH the integrity check.  And if I print the checksum at any time, if someone modifies the file he will see the checksum and with a wee bit more work change it along with his modifications.<br /><br />Or maybe I'm just too paranoid?  Just forget about integrity checks?</div>
    <div class="meta">Posted on 2002-05-18 08:17:53 by AmkG</div>
   </div>
   <div class="post" id="post-38801">
    <div class="subject"><a href="#post-38801">Checking Executable file Integrity</a></div>
    <div class="body">well you said an easy way so how about this one. when you create your executeable keep note of the creation date. then compare it to the date modified.:grin:</div>
    <div class="meta">Posted on 2002-05-18 09:36:56 by smurf</div>
   </div>
   <div class="post" id="post-38867">
    <div class="subject"><a href="#post-38867">Checking Executable file Integrity</a></div>
    <div class="body">smurf:<br />where are you going to store the creation date?<br />If you put it in the registry or a file that makes an easy target to just change the creation date to the current one.  If it's written inside the exe, the same can be done with a debugger.</div>
    <div class="meta">Posted on 2002-05-19 00:43:40 by grv575</div>
   </div>
   <div class="post" id="post-38872">
    <div class="subject"><a href="#post-38872">We all going a little NUTS</a></div>
    <div class="body">But come to think about it, my only goal is to stop the Debugger and The Dummpies programs, and i know that some of this is possibles... So that might not be a bad idea after all.  At lease the Debugger can be stopped in it tracks.  The rest don't really matter to me anymore.</div>
    <div class="meta">Posted on 2002-05-19 01:47:05 by cmax</div>
   </div>
   <div class="post" id="post-38882">
    <div class="subject"><a href="#post-38882">Checking Executable file Integrity</a></div>
    <div class="body">well integrity checks is not really useless, but it sure ain't the ultimate weapon against cracker, because such thing does not exist=/<br />the best way of doing integrity &quot;check&quot; is decrypting code with the checksum of the file..to avoid obvious jumps etc.<br />really good integrity check u can find in a protection like vbox (which uses several .dlls also which checks the integrity the main process)</div>
    <div class="meta">Posted on 2002-05-19 04:11:40 by DZA</div>
   </div>
   <div class="post" id="post-39413">
    <div class="subject"><a href="#post-39413">Checking Executable file Integrity</a></div>
    <div class="body">the MZ header has a bunch of unused bytes. Store your CRC or<br />hash or whatever there. CreateFileMapping on your executable,<br />and sum up everything but the MZ header. Compare value to the<br />one stored in MZ header. Easy-peasy.</div>
    <div class="meta">Posted on 2002-05-22 16:52:05 by f0dder</div>
   </div>
   <div class="post" id="post-39433">
    <div class="subject"><a href="#post-39433">Checking Executable file Integrity</a></div>
    <div class="body">You mean the OLD DOS MZ HEADER???<br /><br />Of course... even the newest exe files have a DOSSTUB...<br /><br />Durn... didn't think of that... nice idea Fodder...</div>
    <div class="meta">Posted on 2002-05-22 20:18:56 by AmkG</div>
   </div>
  </div>
 </body>
</html>