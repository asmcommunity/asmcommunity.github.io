<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Can a GINA STUB fulfil my requirement? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29867" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=113">Low Level Concepts</a> &raquo; <a href="../?id=29867">Can a GINA STUB fulfil my requirement?</a></p>
   <div class="post" id="post-211019">
    <div class="subject"><a href="#post-211019">Can a GINA STUB fulfil my requirement?</a></div>
    <div class="body">Hi, i&#039;m newbie here, not sure if this is the right place to post my question.&nbsp; :)<br /><br />I need to implement 2 factor authentication for my Windows logon and would like to know if a GINA STUB can fulfill my requirement or do I need to write the entire GINA DLL? I read there are risks in implementing the whole GINA so I will like to avoid that.<br /><br />The flow:<br /><br /><strong>1. Initial Authentication:</strong><br />The user enters the username and password on the logon screen, the logon credentials are then used to authenticate against a remote authentication server.<br /><br />--------------------------------------------------------------------------<br />&quot;Please enter your Username and domain password&quot;<br /><br />USERNAME: [ ]<br />PASSWORD: [ ]<br />--------------------------------------------------------------------------<br /><br />Alternatively, the credentials can also be used to logon to Windows or AD (as in the usual process), but I should be able to intercept and prevent the user from actually logging in whether or not the credentials have been successfully authenticated - this is because another set of logon credentials (2nd factor) must be submitted before finally allowing access.<br /><br /><strong>2. 2nd Factor:</strong><br />If the first authentication fails, the user is presented with the failure message returned by the remote authentication server, and the first logon screen is presented again.<br /><br />On success, an OTP or one-time-pass-word will be sent to the user, and the user is then presented with another logon screen which looks like the following. The user enters the username and OTP.<br /><br />--------------------------------------------------------------------------<br />&quot;Please enter the OTP which you have received&quot;<br /><br />USERNAME: [ ]<br />OTP: [ ]<br />--------------------------------------------------------------------------<br /><br />The logon credentials will then be submitted to the authentication server again. If the OTP is correct, the user will be allowed to logon to the machine for real and i should be able to log this event.<br /><br />If OTP authentication fails, the user is presented with the failure message returned by the remote authentication server, and the following logon screen is presented:<br /><br />--------------------------------------------------------------------------<br />&quot;Sorry, you have enter the wrong OTP, please enter the OTP again or enter your domain password to generate another OTP&quot;<br /><br />USERNAME: [ ]<br />OTP/PASSWORD: [ ]<br />--------------------------------------------------------------------------<br /><br /><br />Note: Yes, I know that Windows 2008 and Vista uses a the new CP method, but I&#039;ll need to implement GINA for Windows 2003 Servers. I thought I&#039;ll implement CP after that, hopefully I can reuse as much of the code as possible.<br /><br /><br />Any suggestions you be much appreciated. </div>
    <div class="meta">Posted on 2010-03-16 03:47:21 by joshua__lim</div>
   </div>
  </div>
 </body>
</html>