<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>what is a thunk - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16771" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16771">what is a thunk</a></p>
   <div class="post" id="post-130209">
    <div class="subject"><a href="#post-130209">what is a thunk</a></div>
    <div class="body">I often hear talking of thunks .... expecially releated to pe files. What are thunks???<br /><br />yaa</div>
    <div class="meta">Posted on 2004-01-09 18:34:04 by yaa</div>
   </div>
   <div class="post" id="post-130212">
    <div class="subject"><a href="#post-130212">what is a thunk</a></div>
    <div class="body">hmm before I started studying PE files I had never heard of this word before. <br />a thunk isn't an address it is something that can be used to calculate an address such as a pointer to the IMAGE_IMPORT_BY_NAME. Literally any value that is intended to be used to calculate an address can be considered a thunk.</div>
    <div class="meta">Posted on 2004-01-09 18:42:12 by ENF</div>
   </div>
   <div class="post" id="post-130217">
    <div class="subject"><a href="#post-130217">what is a thunk</a></div>
    <div class="body">I knew the word thunk related to the operation of converting between a segmented memory address space and a flat address space ... but when talking about pe files I don't see how this could get in ...<br /><br /><br />yaa</div>
    <div class="meta">Posted on 2004-01-09 19:10:37 by yaa</div>
   </div>
   <div class="post" id="post-130227">
    <div class="subject"><a href="#post-130227">Re: what is a thunk</a></div>
    <div class="body"><div class="quote"><br />I often hear talking of thunks .... expecially releated to pe files. What are thunks???<br /><br />yaa </div><br /><br />Technically, a &quot;thunk&quot; is a piece of code to execute and its execution environment, all encasulated into one object. The term existed *long* before Microsoft and PE files. Thunks were used, for example, to pass objects by name in Algol-68 and other languages (HLA, for example, supports these types of thunks).<br /><br />From the Microsoft point of view, the &quot;execution environment&quot; includes 16-bit vs. 32-bit segmentation models.<br /><br />Think of a thunk as a pointer to a procedure along with some extra information to set up memory management when that procedure gets called. (e.g., in HLA, thunks contain a pointer  to some code to execute and a pointer to an activation record containing that procedure's variables).<br /><br />You can read more about HLA's thunks (which use the generic definition) here:<br /><a target="_blank" href="http://webster.cs.ucr.edu/Page_AoAWin/PDFs/Thunks.pdf">http://webster.cs.ucr.edu/Page_AoAWin/PDFs/Thunks.pdf</a><br /><br />Check out MSDN for those things that Microsoft calls thunks.<br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2004-01-09 21:07:02 by rhyde</div>
   </div>
   <div class="post" id="post-130247">
    <div class="subject"><a href="#post-130247">what is a thunk</a></div>
    <div class="body">It is also the sound my head makes when you pop it with your thumb and mid-finger.</div>
    <div class="meta">Posted on 2004-01-10 01:52:27 by drarem</div>
   </div>
   <div class="post" id="post-130251">
    <div class="subject"><a href="#post-130251">what is a thunk</a></div>
    <div class="body">Randall Hyde,<br /><br />he wanted to know what are Thunk in the PE Header: OriginalFirstThunk / FirstThunk ;)</div>
    <div class="meta">Posted on 2004-01-10 02:37:48 by wizzra</div>
   </div>
   <div class="post" id="post-130258">
    <div class="subject"><a href="#post-130258">what is a thunk</a></div>
    <div class="body">I've seen articles talk of thunk even to indicate the jump table that some compilers generate to call API functions. <br /><br /><div class="quote">In 32-bit environments, the linker generates a thunk of which it does know the address. The thunk looks like:<br /><br />   0x40000000:    jmp DWORD PTR __imp_func1<br /><br />Here __imp_func1 is the address for func1's slot in the import address table of the .EXE file. All the addresses are thus known to the linker. The loader only has to update the .EXE file's import address table at load time for everything to work correctly.<br /><br />Therefore, using __declspec(dllimport) is better because if the linker does not generate a thunk if it is not required</div> <br /><br />Still, I can't understand what the word thunk means also in relation to its use in the description of the pe format.<br /><br />yaa</div>
    <div class="meta">Posted on 2004-01-10 05:21:29 by yaa</div>
   </div>
   <div class="post" id="post-130261">
    <div class="subject"><a href="#post-130261">what is a thunk</a></div>
    <div class="body">Do take a look at iczelion's tutorials on PE. hmm or more specifically this <a target="_blank" href="http://spiff.tripnet.se/~iczelion/pe-tut6.html">http://spiff.tripnet.se/~iczelion/pe-tut6.html</a></div>
    <div class="meta">Posted on 2004-01-10 05:39:47 by roticv</div>
   </div>
   <div class="post" id="post-130304">
    <div class="subject"><a href="#post-130304">what is a thunk</a></div>
    <div class="body"><div class="quote"><br />Randall Hyde,<br /><br />he wanted to know what are Thunk in the PE Header: OriginalFirstThunk / FirstThunk ;) </div><br /><br />Hence the last line in my post.<br />However, I *really* hate to see people thinking that Microsoft's definition is *the* definition of a thunk, hence my post.<br /><br />Just a bit of enlightenment.<br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2004-01-10 17:10:42 by rhyde</div>
   </div>
  </div>
 </body>
</html>