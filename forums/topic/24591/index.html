<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>confused by a masm default example - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24591" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24591">confused by a masm default example</a></p>
   <div class="post" id="post-179521">
    <div class="subject"><a href="#post-179521">confused by a masm default example</a></div>
    <div class="body">\masm32\examples\exampl09\tables<br /><br /><br />Any Explaination would be appreciate.<br />I get the main point but puzzled by some sentences and usage.<br /><br /><br />1.<br />&nbsp; &nbsp; &nbsp; checkarray MACRO cnt1,cnt2,spc,lft,top:REQ<br />&nbsp; &nbsp; &nbsp; &nbsp; LOCAL idnum,hstep,vstep,lspc,stcnt,var<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; idnum = 500<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stcnt = 400<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hstep = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vstep = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; REPEAT cnt1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DlgStatic 0,SS_RIGHT,3,top+vstep,15,8,stcnt<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stcnt = stcnt + 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REPEAT cnt2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DlgCheck 0,0,lft + hstep,top + vstep,8,8,idnum<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; idnum = idnum + 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hstep = hstep + spc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDM<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vstep = vstep + spc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hstep = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; ENDM<br />&nbsp; &nbsp; &nbsp; ENDM<br /><br />2.<br />mov hInstance, FUNC(GetModuleHandle,NULL) ---- FUNC() ?<br /><br />3.<br />main proc ---- What&#39;s the habit/usage to create window? Why not use .rc file?<br /><br />&nbsp; &nbsp; Dialog &quot;Create Character Table&quot;, \&nbsp; &nbsp; &nbsp; ; caption<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &quot;MS Sans Serif&quot;,10, \&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; font,pointsize<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_OVERLAPPED or \&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; styles for<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_SYSMENU or DS_CENTER, \&nbsp; &nbsp; &nbsp; ; dialog window<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 256 + 16 + 8, \&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; number of controls<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 50,50,203,240, \&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; x y co-ordinates<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 32768&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; memory buffer size<br /><br />&nbsp; &nbsp; DlgButton &quot;Numbers&quot;,&nbsp;  WS_TABSTOP, 21,185,50,13,100<br /><br />4.<br />CallModalDialog hInstance,0,DlgProc,NULL ---- CallModalDialog? Where is the defination?<br />free pMem<br /><br />5.<br />mov str1, ustr$(ccntr) ---- ustr$(ccntr) ?<br />fn SetWindowText,FUNC(GetDlgItem,hWin,nrange),str1 ---- fn?<br />mov str1,cat$(str1,&quot;Ascii &quot;,str$(ctrl),&quot; Hex &quot;,right$(hex$(ctrl),2),&quot; Character &quot;,str2)</div>
    <div class="meta">Posted on 2006-04-13 00:22:39 by Eric4ever</div>
   </div>
   <div class="post" id="post-179524">
    <div class="subject"><a href="#post-179524">Re: confused by a masm default example</a></div>
    <div class="body"><div class="quote">1.<br />&nbsp; &nbsp; &nbsp; checkarray MACRO cnt1,cnt2,spc,lft,top:REQ<br />&nbsp; &nbsp; &nbsp; &nbsp; LOCAL idnum,hstep,vstep,lspc,stcnt,var<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; idnum = 500<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stcnt = 400<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hstep = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vstep = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; REPEAT cnt1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DlgStatic 0,SS_RIGHT,3,top+vstep,15,8,stcnt<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stcnt = stcnt + 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REPEAT cnt2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DlgCheck 0,0,lft + hstep,top + vstep,8,8,idnum<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; idnum = idnum + 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hstep = hstep + spc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDM<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vstep = vstep + spc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hstep = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; ENDM<br />&nbsp; &nbsp; &nbsp; ENDM</div><br /><br />This macro simplifies the creation of a large ammount of controls (just to save typing). It creates a collection of controls, a single static followed by <em>cnt2</em> Check Boxes. This is done <em>cnt1</em> times each time shifting down in order to create a table.<br /><br /><div class="quote">2.<br />mov hInstance, FUNC(GetModuleHandle,NULL) ---- FUNC() ?</div><br /><br />FUNC is a macro defined in MACROS.ASM, it returns the value in EAX after a call to INVOKE:<br /><br /><pre><code>FUNC MACRO parameters:VARARG<br />invoke parameters<br />EXITM &lt;eax&gt;<br />ENDM</code></pre><br /><br /><div class="quote">3.<br />main proc ---- What&#39;s the habit/usage to create window? Why not use .rc file?<br /><br />&nbsp; &nbsp; Dialog &quot;Create Character Table&quot;, \&nbsp; &nbsp; &nbsp; ; caption<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &quot;MS Sans Serif&quot;,10, \&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; font,pointsize<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_OVERLAPPED or \&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; styles for<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_SYSMENU or DS_CENTER, \&nbsp; &nbsp; &nbsp; ; dialog window<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 256 + 16 + 8, \&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; number of controls<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 50,50,203,240, \&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; x y co-ordinates<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 32768&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; memory buffer size<br /><br />&nbsp; &nbsp; DlgButton &quot;Numbers&quot;,&nbsp;  WS_TABSTOP, 21,185,50,13,100</div><br /><br />This simplifes the creation of in memory dialogs. You could have created your dialogs in a RC file, but this is how the author decided to create his dialogs. I&#39;ve not sat down and tested any of that code out but looking DIALOGS.INC I would say that it probably loads up a lot faster than having to find, load, then call a dialog resource. NTM if you didn&#39;t have any other resources it could allow you to cut out the resource section all together.<br /><br /><div class="quote">4.<br />CallModalDialog hInstance,0,DlgProc,NULL ---- CallModalDialog? Where is the defination?<br />free pMem</div><br /><br />CallModalDialog is another one of the routines found in Dialogs.inc for in memory dialogs.<br /><br /><pre><code><br />&nbsp; &nbsp; ; ------------------------------------<br />&nbsp; &nbsp; ; create a modal dialog from the data<br />&nbsp; &nbsp; ; written to the memory template.<br />&nbsp; &nbsp; ; ------------------------------------<br />&nbsp; &nbsp; &nbsp; CallModalDialog MACRO Instance,Parent,DlgProc,lpExtra<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke DialogBoxIndirectParam,Instance,esi,Parent,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ADDR DlgProc,lpExtra<br />&nbsp; &nbsp; &nbsp; &nbsp; push eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;; preserve return value<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke GlobalFree,esi&nbsp;  ;; free memory<br />&nbsp; &nbsp; &nbsp; &nbsp; pop eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;; restore return value<br />&nbsp; &nbsp; &nbsp; &nbsp; pop edi<br />&nbsp; &nbsp; &nbsp; &nbsp; pop esi<br />&nbsp; &nbsp; &nbsp; ENDM<br /></code></pre><br /><br /><br /><div class="quote">5.<br />mov str1, ustr$(ccntr) ---- ustr$(ccntr) ?<br />fn SetWindowText,FUNC(GetDlgItem,hWin,nrange),str1 ---- fn?<br />mov str1,cat$(str1,&quot;Ascii &quot;,str$(ctrl),&quot; Hex &quot;,right$(hex$(ctrl),2),&quot; Character &quot;,str2)</div><br /><br />ustr$ - converts a string to an unsigned integer<br />fn - like INVOKE except it lets you use quoted strings<br />cat$ - catconates strings together<br />str$ - converts a dword value to a string<br />hex$ - converts a dword to a hex string<br /><br />Regards,<br />Bryant Keller</div>
    <div class="meta">Posted on 2006-04-13 02:44:24 by Synfire</div>
   </div>
   <div class="post" id="post-179525">
    <div class="subject"><a href="#post-179525">Re: confused by a masm default example</a></div>
    <div class="body">THX Synfire, I got it! :D<br /><br />almost everything in the dialogs.inc and macros.asm, and also the hlhelp.hlp :D<br /><br />Eric</div>
    <div class="meta">Posted on 2006-04-13 03:06:55 by Eric4ever</div>
   </div>
   <div class="post" id="post-179865">
    <div class="subject"><a href="#post-179865">Re: confused by a masm default example</a></div>
    <div class="body">There is a question about the AutoCheckBox:<br /><br />the macro define 256 autocheckbox<br /><br /><br /><pre><code>&nbsp; &nbsp; &nbsp; checkarray MACRO cnt1,cnt2,spc,lft,top:REQ	; checkarray 16,16,10,22,20<br />&nbsp; &nbsp; &nbsp; &nbsp; LOCAL idnum,hstep,vstep,lspc,stcnt,var<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; idnum = 500<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stcnt = 400<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hstep = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vstep = 15<br />&nbsp; &nbsp; &nbsp; &nbsp; REPEAT cnt1		; cnt1=16<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DlgStatic 0,SS_RIGHT,3,top+vstep,15,8,stcnt	; static control, ty=top+vstep=20<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stcnt = stcnt + 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REPEAT cnt2				; cnt2=16<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DlgCheck 0,0,lft + hstep,top + vstep,8,8,idnum		; check box, tx=lft+hstep=22<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; idnum = idnum + 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hstep = hstep + spc			; spc=10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ENDM<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vstep = vstep + spc<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hstep = 0<br />&nbsp; &nbsp; &nbsp; &nbsp; ENDM<br />&nbsp; &nbsp; &nbsp; ENDM</code></pre><br /><br />I just want to SetTimer when the 1st(any of the 256) autocheckbox checked, but I don&#39;t know how to use the BN_CLICKED notification. I use it below but failed:<br /><br /><pre><code>&nbsp; &nbsp; &nbsp; Case WM_COMMAND<br />&nbsp; &nbsp; &nbsp; &nbsp; Switch wParam<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case IDOK&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; clear<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov nrange, 500<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .while nrange &lt;= 755<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,FUNC(GetDlgItem,hWin,nrange),BM_SETCHECK,BST_UNCHECKED,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add nrange, 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .endw<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case IDCANCEL<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp quit_dialog<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Case BN_CLICKED<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov eax,wParam<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  mov nrange, 500<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .while nrange &lt;= 755<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; IsDlgButtonChecked,FUNC(GetDlgItem,hWin,nrange),nrange<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .if	eax == BST_CHECKED<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 	invoke&nbsp; SetTimer,hWin,ID_TIMER,5000,NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jz	@F<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; add nrange, 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .endw						<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; @@:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Default<br />&nbsp; &nbsp; &nbsp;  	<br />&nbsp; &nbsp; &nbsp; &nbsp; EndSw</code></pre></div>
    <div class="meta">Posted on 2006-04-19 21:14:30 by Eric4ever</div>
   </div>
   <div class="post" id="post-179899">
    <div class="subject"><a href="#post-179899">Re: confused by a masm default example</a></div>
    <div class="body">For BN_CLICKED notification wParam consists of notification message id(hiword of wParam) and a control id(loword of wParam).<br />So your code check wParam against BN_CLICKED meanwhile wParam is something like that : (BN_CLICKED shl 16) or CTRLID.</div>
    <div class="meta">Posted on 2006-04-20 02:40:48 by k3Eahn</div>
   </div>
   <div class="post" id="post-180126">
    <div class="subject"><a href="#post-180126">Re: confused by a masm default example</a></div>
    <div class="body">I tried it several times but failed! :sad:<br />I get the BN_CLICKED but how can I receive the message and SetTimer when the 1st(any of the 256) autocheckbox checked for that there is no actual handle of them.<br /><br />any snipplet would be appreciate. I&#39;m really puzzled. :shock:<br />Thanks in advanced.</div>
    <div class="meta">Posted on 2006-04-24 06:27:55 by Eric4ever</div>
   </div>
   <div class="post" id="post-180158">
    <div class="subject"><a href="#post-180158">Re: confused by a masm default example</a></div>
    <div class="body">Eric4ever,<br />Now comes the testing since you have the basic code.&nbsp; I would use a MessageBox to trace results to make sure the flow is according to Hoyle.&nbsp; Move the MessageBox around and with it, you will quickly get to the bottom of it.&nbsp; I am not a fan of this high level approach as it is hard to see what is going on with func, switch and case, etc.&nbsp; Perhaps I am to old fashioned.<br /><br />Anyway, please keep us posted as I, for one, am interested.&nbsp; Do not forget to shift wParam or you will never get there.<br /><br />Paul<br /></div>
    <div class="meta">Posted on 2006-04-26 09:05:20 by PBrennick</div>
   </div>
  </div>
 </body>
</html>