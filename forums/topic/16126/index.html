<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>acessing Methods (functions) of ITaskbarlist  NASM - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16126" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16126">acessing Methods (functions) of ITaskbarlist  NASM</a></p>
   <div class="post" id="post-125070">
    <div class="subject"><a href="#post-125070">acessing Methods (functions) of ITaskbarlist  NASM</a></div>
    <div class="body">well some time ago i asked for some litle example on how to use dll or ocx that have<br />functions that are not exported .  well i know there was some about that , but only<br />masm or tasm .  here how we do in NASM using NAGOA<br /><br /><br />%include '\lab\vasm\inc\nagoa.inc'<br /><br />STRUC GUID<br />.Data1 resd 1   <br />.Data2 resw 1  <br />.Data3 resw 1  <br />.Data4 resb 8  <br />ENDSTRUC<br /><br />CLSCTX_INPROC_SERVER		equ 1<br /><br /><br /><br /><br /><br />DIALOG_ID equ  100<br /> <br /> ;====================================================<br /> ; we can see methods as functions inside a dll or ocx that are not exported<br /> ; ====================================================<br /> ;  VTable that includes the pointers to the methods.<br /> ;  first 3 methods are always in every COM and are of IUnknown<br /> ;  In fact, all the COM interfaces are built like this.<br /> ; ====================================================<br />  STRUC ITaskBarList<br />    ;==This are pointers to IUnknown interface <br />   .QueryInterface    resd 1<br />   .AddRef                resd 1<br />   .Release                resd 1<br />   ;==This are pointers to Methods (functions) of ITaskbarlist    <br />  <br />   .HrInit                 resd 1<br />   .AddTab                 resd 1<br />   .DeleteTab              resd 1<br />   .ActivateTab            resd 1<br />   .SetActiveAlt           resd 1<br /> ENDSTRUC<br />;============================================<br />  <br /><br /><br /><br /><br />;=== CLSID_TaskbarList '56FDF344-FD6D-11D0-958A-006097C9A090'<br /><br />CLSID_TaskbarList:<br />ISTRUC GUID<br />AT GUID.Data1 , dd 56FDF344h<br />AT GUID.Data2 , dw 0FD6Dh<br />AT GUID.Data3 ,	dw 11D0h<br />AT GUID.Data4 , db 95h,8Ah,0,60h,97h,0C9h,0A0h,90h<br />IEND<br /><br />; IID_ITaskbarList  '56FDF342-FD6D-11D0-958A-006097C9A090'<br /><br />IID_ITaskbarList:<br />ISTRUC GUID<br />AT GUID.Data1 , dd 56fdf342h<br />AT GUID.Data2 , dw 0FD6Dh<br />AT GUID.Data3 ,	dw 11D0h<br />AT GUID.Data4 , db 95h,8Ah,0,60h,97h,0C9h,0A0h,90h<br />IEND<br /><br /><br /><br /><br /><br /><br /><br />..start:<br />call	GetModuleHandleA, NULL<br />CONST hInst , dd 0<br />mov	, eax<br />call	DialogBoxParamA, ,DIALOG_ID, 0,DialogProc, 0 <br />call	ExitProcess, <br /><br /><br />           ; ============ [ MAIN DIALOLOG PROC ] =====================:<br /><br />proc DialogProc,hdlg,msg,wParam,lParam<br /><br />cmp dword ,WM_INITDIALOG<br />je wm_inidialog<br />cmp dword ,WM_COMMAND<br />je near wm_command<br />;cmp dword ,WM_PAINT<br />;je near wm_paint<br />cmp dword ,WM_CLOSE<br />je near wm_close<br />return FALSE<br /><br />;; =============<br />wm_inidialog:<br /><br />return TRUE<br /><br />;; =============<br />wm_command:<br /><br />cmp	dword , 1002  ; show on taskbar ?<br /><br />je show<br /><br />	<br />return TRUE<br />	<br />;; =============<br />show:<br />invoke ShowOnTaskbar,<br />return FALSE<br />;; =============<br /><br />wm_close:<br />call ExitProcess,0        <br />return FALSE<br />;------------<br />endproc    ; ============== [ MAIN DIALOGPROC  END ] =============== :<br /><br /><br /><br /><br /><br />            ; ---------[ ShowOnTaskbar ] ------------------------<br />proc ShowOnTaskbar,hWin<br />sectiondata<br />ShellTaskBar resb ITaskBarList_size<br />sectioncode<br />call CoInitialize,NULL<br />call CoCreateInstance,CLSID_TaskbarList,NULL,CLSCTX_INPROC_SERVER,IID_ITaskbarList,ShellTaskBar<br />callcom ShellTaskBar,ITaskBarList.HrInit<br />callcom ShellTaskBar,ITaskBarList.AddTab,<br />callcom ShellTaskBar,ITaskBarList.ActivateTab,<br />endproc<br />          ; ---------[ ShowOnTaskbar END ] ---------------------<br /><br /><br /><br />now i?m happy :))  i can use OCX lololol us well<br /><br />;-)</div>
    <div class="meta">Posted on 2003-11-21 21:02:11 by Nguga</div>
   </div>
   <div class="post" id="post-125071">
    <div class="subject"><a href="#post-125071">acessing Methods (functions) of ITaskbarlist  NASM</a></div>
    <div class="body">Hi Nguga,<br /><br />For MASM users I posted an example of this interface a little earlier in the week when answering a question:<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=16099">http://www.asmcommunity.net/board/index.php?topic=16099</a></div>
    <div class="meta">Posted on 2003-11-21 21:22:58 by donkey</div>
   </div>
   <div class="post" id="post-125074">
    <div class="subject"><a href="#post-125074">MASM is very strange for me :(</a></div>
    <div class="body">my problem was to understand what was is fu*ing GUID ??? lololol<br /><br />in MASM you do this:<br />sIID_ITaskbarListtextequ&lt;{056FDF342H, 0FD6DH, 011D0H,\<br />{095H, 08AH, 000H, 060H, 097H, 0C9H, 0A0H, 090H}}&gt;<br /><br />and for me it was chinese....<br /><br />i asked here in this post what it was that in real assembly no one respond ...<br /><br /><br /><br />know it is very clear .<br /><br /><br />;;=== CLSID_TaskbarList '56FDF344-FD6D-11D0-958A-006097C9A090'<br /><br />CLSID_TaskbarList:<br />ISTRUC GUID<br />AT GUID.Data1 , dd 56FDF344h<br />AT GUID.Data2 , dw 0FD6Dh<br />AT GUID.Data3 , dw 11D0h<br />AT GUID.Data4 , db 95h,8Ah,0,60h,97h,0C9h,0A0h,90h<br />IEND<br /><br />;;=== IID_ITaskbarList '56FDF342-FD6D-11D0-958A-006097C9A090'<br /><br />IID_ITaskbarList:<br />ISTRUC GUID<br />AT GUID.Data1 , dd 56fdf342h<br />AT GUID.Data2 , dw 0FD6Dh<br />AT GUID.Data3 , dw 11D0h<br />AT GUID.Data4 , db 95h,8Ah,0,60h,97h,0C9h,0A0h,90h<br />IEND</div>
    <div class="meta">Posted on 2003-11-21 21:35:03 by Nguga</div>
   </div>
   <div class="post" id="post-125076">
    <div class="subject"><a href="#post-125076">acessing Methods (functions) of ITaskbarlist  NASM</a></div>
    <div class="body">Ah, I see. It is only that way because I use my own INC file for getting the GUIDs. Rather than have to include the whole file (43K) in the post I just copied the two lines from it that were necessary. The file is structured as a long list of hundreds of textequ's for CLSIDs and IIDs because that is how I learned to work with them and the way I am most comfortable with. I just thought it was widely known that a GUID is simply a structure, it is listed at MSDN as such. By the way textequ is just a way to represent a constant, it is *real* assembly ;)</div>
    <div class="meta">Posted on 2003-11-21 21:44:19 by donkey</div>
   </div>
  </div>
 </body>
</html>