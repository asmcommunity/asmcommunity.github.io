<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>MMORPG programming - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20522" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=20522">MMORPG programming</a></p>
   <div class="post" id="post-156779">
    <div class="subject"><a href="#post-156779">MMORPG programming</a></div>
    <div class="body">i didnt see any topic on this subject so i started one :) i have a few questions (just theoretical) about how to write a good MMORPG.<br /><br />Example: say i want a game that supports up to 500 players simultaniously, i want the characterdatabase in the server (prevent item cheating etc).<br />So characterdatabase is serversided because of security risks, but now im wondering which things would be good to make server and which are good to make clientsided without having to use a supercomputer with 10 fiberglass internet connections as server offcourse :)<br /><br />Scorpie<br /><br />or maybe someone can provide me with a link about this subject?<br /><br />edit: if my post isnt clear enough please tell me so i can try to improve it</div>
    <div class="meta">Posted on 2005-02-07 14:28:13 by Scorpie</div>
   </div>
   <div class="post" id="post-156794">
    <div class="subject"><a href="#post-156794">MMORPG programming</a></div>
    <div class="body">If there is to be one single server for all players, then IOCP should be used for the server. It can easily handle a couple of thousand concurrent connections.<br />If you want to handle more players than that, then you think about a layer of &quot;intermediate servers&quot; which are connected to the master server.<br />Each of these could handle some of the players, with the main server keeping track of all players and routing replies to them. The cost of handling more players this way is the lag introduced by adding the extra hop plus processing time. You have effectively created a &quot;multihomed network&quot; which distributes the load across the server network.</div>
    <div class="meta">Posted on 2005-02-08 04:04:29 by Homer</div>
   </div>
   <div class="post" id="post-156804">
    <div class="subject"><a href="#post-156804">MMORPG programming</a></div>
    <div class="body">thanks for the reply and yea i forgot to mention i want to use one single server for this 500 players. and IOCP sounds like it can easily handle the number of connections but i want to know more about how to keep the amount of data send over this 500 connections as low as possible.<br /><br />What about player actions (certain movement like jumping for example), client calculates animations offcourse but who checks the action itself, make the client calculate it and send info to the server that player #a is making animation #b positioned at x,y,z with viewing towards vx,vy,vz which will be sended to clients, would this be a good way? since making the clients only send command to server (like jump) and make the server calculate 500 players wouldnt seem that logical but is this a good way or are there better ways to handle this kind of thing?<br /><br />And what about the world itself, do you need to give all players the whole map and the server sends extra info like NPC's etc to them? and if it does, does it send all data to all players or do you make the server send area specific information (so only npc's in a certain radius around the player).<br /><br />Hope this post makes more sence about what i want to know, Scorpie</div>
    <div class="meta">Posted on 2005-02-08 10:02:38 by Scorpie</div>
   </div>
   <div class="post" id="post-156964">
    <div class="subject"><a href="#post-156964">MMORPG programming</a></div>
    <div class="body">imho a single server can handle alot. look at runuo, www.runuo.com. handles all the world every thing on one pc. you only want to process messagges to other players that can see the player preforming the action. like if your jumping you dont need to tell all clients your jumping, just the ones that can see you.</div>
    <div class="meta">Posted on 2005-02-11 21:31:00 by Qages</div>
   </div>
   <div class="post" id="post-157316">
    <div class="subject"><a href="#post-157316">MMORPG programming</a></div>
    <div class="body">All players should have the world map.<br />Collision detection should be performed by the server to prevent various kinds of cheating. Your notion of sending minimal information to clients about the actions of other players is valid and is the defacto standard, and its worth mentioning that GAMETIME should be controlled by the Server too, and therefore the &quot;minimalist&quot; packets should contain at least a TimeStamp from the Server to indicate the  time the event occured (or should have occurred but didnt due to transmission lag).</div>
    <div class="meta">Posted on 2005-02-23 07:18:13 by Homer</div>
   </div>
   <div class="post" id="post-157327">
    <div class="subject"><a href="#post-157327">MMORPG programming</a></div>
    <div class="body">By colision detection you mean all colision detections? i mean even with objects and so on?<br />I understand if you make clients do the collision detection they can make cheats like wallhack but i think making the server calculate it will give a bad gameplay since all your movements are preformed with latency since you should send the server you want to walk forward the server checks where you are and sends back if you can move forward or stay at your current position.<br /><br />And i like the TimeStamp idea, so you dont waste cpu power on (very) delayed packets which contain things that may not even be in your sight anymore.<br /><br />Scorpie</div>
    <div class="meta">Posted on 2005-02-23 09:32:32 by Scorpie</div>
   </div>
   <div class="post" id="post-157331">
    <div class="subject"><a href="#post-157331">MMORPG programming</a></div>
    <div class="body">is there no a posible way to protect against this ways of hack???<br /><br /><br />For example I think in some like by each user connected to the server  you send a &quot;key&quot; or some for calculation in X place of the map and if this key pass in other place of the map (for check in the server), you kick them out :P.<br /><br /><br />Also if is posible like have in a ordered way this keys, for example, you can keep in the server the anterior key of the user, say it was 5, then the only other keys that are accesible are for example: 4 and 6 if the user send a packet that is &quot;cypted&quot; or accessed with a number of 8 (trying to kick others people ass :P) you know that is not posible with key 4 get key 8 ...... and you reduce the calculation of objects collision to take care if is posible to get such sequence or not....<br /><br /><br /><br /><br />Something like a validation scheme, you let the users do the collision detection....<br /><br /><br />Or also a similar way.... why dont you let this work to the two others PCs?????<br /><br /><br />With the same anterior scheme, you assign a key to a object that is moving (a player or a shoot) When a guy is interacting with other people out there, then the two PC handle the collision detection and the checking for hacks....<br /><br /><br /><br /><br />In the next draw, what is near to object @ is not near to object &amp; in that way only the objects that are related (can watch themselves or have a direct draw) in such cases the interaction with the world would be work of the server ie, watch that is not like a ghost and walk tru the walls or shot tru the walls (and because is something static.. ie only interacting with the world, pheraphs can be done in a secure but easy and fast way), but when to objects or more are interacting and each one have a PC (that is not the server), the work of check for the hacks of walk trought the walls and shoot in the walls is handled by the others PCs in that way when two objects are finally interacting a more in depth calculation of collisions can take place instead of the one handled in the server that is mainly for checking of no hacks.....<br /><br /><br /><pre><code><br />? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?<br />? ? ? ? ? ? ? ? ? ? ? ? | ? ? ?## ? ? ? &amp;? ? ? ? ? ? ?<br />? ? ? ? ? ? ? | ? ? ? ? | ? ? ? ? ##? ? ? ? ? ? ? ? ? ?<br />? ? ? @ ? ? ? ? | ? ? ? ? ? ? ? ? ?### ? ? ? ? ? ? ? ? ?<br />? ? ? ? ? ? ? | ------- ? ? ? ? ###? ? ? ? ? ? ? ? ? ? ? ? ? ?<br />? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?#### ? ? ? ? ? ? ? ? ?<br />? ? ? ? ? ? %%%? ? ? ? ? ? ? ?##### ? ? ? ? ? ? ? ? ? ? ?<br />? ? ?%%% ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?<br /></code></pre><br /><br />Here the objects @ and &amp; are not &quot;connected&quot; and is work of the server to take care of chats...<br /><br /><br /><pre><code><br />? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?<br />? ? ? ? ? ? ? ? ? @? ? ? | ? ? ?## ? ? ? ? ? ? ? ? ? ?<br />? ? ? ? ? ? ? | ? ? ? ? | ? ? ? ? ##? ? ? ? ? ? ? ? ? ?<br />? ? ? ? ? ? ? ? | ? ? ? ? ? ? &amp; ? ?### ? ? ? ? ? ? ? ? ?<br />? ? ? ? ? ? ? | ------- ? ? ? ? ###? ? ? ? ? ? ? ? ? ? ? ? ? ?<br />? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?#### ? ? ? ? ? ? ? ? ?<br />? ? ? ? ? ? %%%? ? ? ? ? ? ? ?##### ? ? ? ? ? ? ? ? ? ? ?<br />? ? ?%%% ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ?<br /></code></pre><br /><br />Here the @ and &amp; can be connected to take care each of them of the other....<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />By the way, such concept can be extended in other way, divide the map (at runtime or static) in diferents parts and assign the more near players to take care of this part of the map :), you can connect 2,3,4 or a nice number of PC for watch a low but suficient traffic of the others guys for check for hacks......<br /><br /><br /><br /><br />And the work of the server will be at less have one computer watching the other, mainating low traffic for 56K modem, connect more people each with other 2 or more if posible...</div>
    <div class="meta">Posted on 2005-02-23 10:57:49 by rea</div>
   </div>
   <div class="post" id="post-157579">
    <div class="subject"><a href="#post-157579">MMORPG programming</a></div>
    <div class="body">ALL COLLISION DETECTION SHOULD OCCUR SERVERSIDE.<br />The only exception is for &quot;collisions that don't matter&quot; - like rubble deflecting from walls after an explosion. These are special effects and not really a game element.<br /><br />Bear the following in mind:<br />#1) The server does not need to render ANYTHING, it could for example be CONSOLE based.<br />#2) For a distributed (multihomed) network, the collision calculations are performed by the first-order (&quot;gateway&quot;) servers, and not by the &quot;master server&quot; - thus the workload is distributed over N machines, same advantage as you get doing it clientside but without the possibility of cheating.<br /><br />The success (or lack thereof) of your game hinges GREATLY on public perception - if people stop having fun due to your lack of control over your own creation, who should you blame?</div>
    <div class="meta">Posted on 2005-03-01 03:47:45 by Homer</div>
   </div>
   <div class="post" id="post-157590">
    <div class="subject"><a href="#post-157590">MMORPG programming</a></div>
    <div class="body"><div class="quote">....<br />The success (or lack thereof) of your game hinges GREATLY on public perception - if people stop having fun due to your lack of control over your own creation, who should you blame?</div><br /><br />True, i agree but from a gamers point of view i wouldnt have much fun when i can only play with a ping of 50 max. i mean having a latency of about 100ms everything you do will be preformed 100ms after you wanted it to happen (especialy with walking and jumping this can be very very anoying).<br />I'd seem more logical to have both the client and first-order server calculate it, the client calculates and it has a smoothg gameplay then and the server checks the colisions so players wont be able to cheat. (im mainly talking about collision with the world now to prevent wallhack and such)<br /><br />Scorpie</div>
    <div class="meta">Posted on 2005-03-01 11:07:59 by Scorpie</div>
   </div>
   <div class="post" id="post-157604">
    <div class="subject"><a href="#post-157604">MMORPG programming</a></div>
    <div class="body">There is a solution (at least a partial one) to the latency issue.<br />Assuming that the first-order server is responsible for collision calculations and assuming that the Master server is Authoritative for GameTime over the entire game... what happens if the F.O.S. sends a collision message to the MasterServer with a timestamp, and then the MasterServer integrates this information forwards in Time?<br />What I'm trying to point out is that the TimeBase can be skewed across servers to take up around 50% of the hop-induced latency, such that on client machines, the game is running &quot;ahead of Time&quot; by the total latency between that client, the F.O.S and the Master.<br />There was a really neat tutorial describing this over at GameDev, I'll see if I can rustle up a link.</div>
    <div class="meta">Posted on 2005-03-01 22:42:36 by Homer</div>
   </div>
  </div>
 </body>
</html>