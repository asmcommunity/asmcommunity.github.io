<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Adding Two Floating Point Numbers - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12586" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12586">Adding Two Floating Point Numbers</a></p>
   <div class="post" id="post-97395">
    <div class="subject"><a href="#post-97395">Adding Two Floating Point Numbers</a></div>
    <div class="body">I'm making a program to add two floating point numbers using ASCII operations AAA and AAS. I've run into the problem of aligning the decimal point for the two numbers. So I decided to split the floating point number into two halfs. The Whole number part and the Decimal part.<br />For example, the two numbers: 123.456 and 22.35 would be saved in the variables....<br /><br />123 -&gt; FPNum_W1<br />456 -&gt;FPNum_D1<br /><br />22 -&gt;FPNum_W2<br />35 -&gt;FPNum_D2<br /><br />Then I would  add the two parts seperately and put it back together to print the sum. Any how... I'm having some trouble w/ my code. I can't get the floating point number split in two and saved in seperate varaibles. I need some assistance. This is what I got so far.<br /><br />;===============================================<br /><br />INCLUDE Irvine32.inc<br /><br />.data<br /><br />	str1 BYTE &quot;Assignment4: Addition of two Floating Point Numbers &quot;,0Ah, 0Dh, 0 	<br />	str2 BYTE &quot;Enter your name: &quot;, 0<br />	str3 BYTE &quot;Please enter two Floating Point Numbers, &quot;,0<br />	str4 BYTE &quot;Enter first Floating Point Number: &quot;, 0<br />	str5 BYTE &quot;Enter second Floating Point Number: &quot;, 0<br />	str6 BYTE &quot;Continue? (y/n): &quot;, 0<br />		<br />	char BYTE ?<br />	buffer BYTE 50 dup (0)<br /><br />	FPVal1 BYTE 50 dup ('0')<br />	FPVal2 BYTE 50 dup ('0')<br /><br />	FPSum1 BYTE 50 dup ('0')<br />	<br />	FPVal_W1 BYTE 50 dup ('0')<br />	FPVal_D1 BYTE 50 dup ('0')<br />	<br />	FPVal_W2 BYTE 50 dup ('0')<br />	FPVal_D2 BYTE 50 dup ('0')<br />	<br />	FPSum_W1 BYTE 60 dup ('0')<br />	FPSum_D1 BYTE 60 dup ('0')<br />	<br />		<br />	setPointer MACRO reg, var		; Macro to set pointer<br />		lea reg, var			; Load Effective Address of register 	<br />		add reg, lengthof var		; Move pointer to end of string<br />		dec reg				; Move back one	<br />	ENDM					; End of Macro definition<br />	<br />	EnterString MACRO FP_Buffer		; Readstring Macro<br />		lea edx, FP_Buffer		; Load Effective Address of FP_Buffer<br />		mov ecx, (SIZEOF FP_Buffer) - 1	; Maximum number of characters <br />		call Readstring			; Call Readstring function<br />	ENDM<br />	<br />.code<br /><br />main PROC<br /><br />	mov eax, lightGreen + (black * 16)	;light green text on black background<br />	call SetTextColor<br />	call Clrscr<br />	<br />	lea edx, str1			; load effective address str1<br />	call WriteString		; &quot;Assignment4: Addition of two Floating Point Numbers&quot;<br />	call Crlf			; end line<br /><br />	call WaitMsg			; &quot;Press...&quot;<br />		<br />	lea edx, str2			; load effective offset str2<br />	call WriteString		; &quot;Enter your name: &quot;<br />	<br />	lea edx, buffer			; load effective address buffer<br />	mov ecx, (SIZEOF buffer) - 1	; maximum # of characters<br /><br />	call ReadString			; read string input from user<br />	lea edx, str3			; load effective address str3<br />	call WriteString		; &quot;Please enter two Floating Point Numbers, &quot;<br />	lea edx, buffer			; load effective offset buffer<br />	call WriteString		; display user name<br />	call Crlf			; end line<br />	<br />	Again:<br />		call Crlf<br />				<br />		lea edx, str4			; load effective address str4<br />		call WriteString		; &quot;Enter first Floating Point Number: &quot;<br />		Enterstring FPVal1		; read floating point value from user<br />		call Crlf			; end line<br />	<br />		lea edx, str5			; load effective offset str5<br />		call WriteString		; &quot;Enter second Floating Point Number: &quot;<br />		Enterstring FPVal2		; read floating point value from user	<br />		call Crlf			; end line<br />					<br />			<br />	Check_Length:<br />	<br />		lea esi, FPVal1<br />		lea edi, FPVal1<br />		<br />		mov al, lengthof FPVal1<br />		mov ah, lengthof FPVal2<br />		<br />		cmp al, ah<br />		jge Mov_Val1<br />				<br />		Mov_Val1:<br />			cmp byte ptr , '.'<br />			je Mov_Right_Side1<br />			inc esi<br />			jmp Mov_Val1<br />									<br />			Mov_Right_Side1:<br />							<br />				L1:<br />					cmpsb <br />					je Done<br />					dec esi<br />					mov bl, <br />					mov FPVal_W1, bl<br />					jmp L1<br />					<br />				<br />		comment %			;comment out from here 	<br />				<br />				.IF (  (byte ptr  == 0Ah) ||(byte ptr  == 0Dh) )<br />					jmp Done<br />				.ENDIF<br />				<br />				inc esi<br />				xor eax, eax<br />				mov eax, <br />				mov FPVal_D1, eax<br />				jmp Mov_Right_Side1<br />				<br />		Mov_Val2:<br />			cmp byte ptr , '.'<br />			je Mov_Right_Side2<br />			<br />			xor eax, eax<br />			mov eax, <br />			mov FPVal_W1, edx<br />			inc edi<br />			jmp Mov_Val2<br />			<br />			Mov_Right_Side2:<br />				.IF (  (byte ptr  == 0Ah) ||(byte ptr  == 0Dh) )<br />					jmp Done<br />				.ENDIF<br />				<br />				inc esi<br />				xor eax, eax<br />				mov eax, <br />				mov FPVal_D1, eax<br />				jmp Mov_Right_Side2<br />                                to here<br />		% <br />		<br />	Done:<br />		lea edx, FPVal1<br />		call Writestring<br />		call Crlf<br />		lea edx, FPVal2<br />		call Writestring<br />		call Crlf<br />		lea edx, FPVal_W1<br />		call Writestring<br />		call Crlf<br />		<br />	<br />	<br />		<br />			<br />	lea edx, str4		  		; load effective offset str4<br />	call WriteString			; &quot;Continue? (y/n): &quot;<br />	<br />	call ReadChar				; read character input from user<br />	xor al, al				; clear al register<br />	mov char, al				; copy answer to variable<br /> 	<br /> 	.IF (char == 'y') || (char == 'Y')	; if answer is yes<br />		jmp Again	 	 	; jump back to Again<br />	.ENDIF	<br /><br />	exit<br /><br />main ENDP<br />END main</div>
    <div class="meta">Posted on 2003-04-16 22:17:08 by locke</div>
   </div>
   <div class="post" id="post-98026">
    <div class="subject"><a href="#post-98026">maybe this is more readable</a></div>
    <div class="body"><br /><br />;===============================================<br /><br />INCLUDE Irvine32.inc<br /><br />.data<br /><br />str1 BYTE &quot;Assignment4: Addition of two Floating Point Numbers &quot;,0Ah, 0Dh, 0 <br />str2 BYTE &quot;Enter your name: &quot;, 0<br />str3 BYTE &quot;Please enter two Floating Point Numbers, &quot;,0<br />str4 BYTE &quot;Enter first Floating Point Number: &quot;, 0<br />str5 BYTE &quot;Enter second Floating Point Number: &quot;, 0<br />str6 BYTE &quot;Continue? (y/n): &quot;, 0<br /><br />char BYTE ?<br />buffer BYTE 50 dup (0)<br /><br />FPVal1 BYTE 50 dup ('0')<br />FPVal2 BYTE 50 dup ('0')<br /><br />FPSum1 BYTE 50 dup ('0')<br /><br />FPVal_W1 BYTE 50 dup ('0')<br />FPVal_D1 BYTE 50 dup ('0')<br /><br />FPVal_W2 BYTE 50 dup ('0')<br />FPVal_D2 BYTE 50 dup ('0')<br /><br />FPSum_W1 BYTE 60 dup ('0')<br />FPSum_D1 BYTE 60 dup ('0')<br /><br /><br />setPointer MACRO reg, var ; Macro to set pointer<br />lea reg, var ; Load Effective Address of register <br />add reg, lengthof var ; Move pointer to end of string<br />dec reg ; Move back one <br />ENDM ; End of Macro definition<br /><br />EnterString MACRO FP_Buffer ; Readstring Macro<br />lea edx, FP_Buffer ; Load Effective Address of FP_Buffer<br />mov ecx, (SIZEOF FP_Buffer) - 1 ; Maximum number of characters <br />call Readstring ; Call Readstring function<br />ENDM<br /><br />.code<br /><br />main PROC<br /><br />mov eax, lightGreen + (black * 16) ;light green text on black background<br />call SetTextColor<br />call Clrscr<br /><br />lea edx, str1 ; load effective address str1<br />call WriteString ; &quot;Assignment4: Addition of two Floating Point Numbers&quot;<br />call Crlf ; end line<br /><br />call WaitMsg ; &quot;Press...&quot;<br /><br />lea edx, str2 ; load effective offset str2<br />call WriteString ; &quot;Enter your name: &quot;<br /><br />lea edx, buffer ; load effective address buffer<br />mov ecx, (SIZEOF buffer) - 1 ; maximum # of characters<br /><br />call ReadString ; read string input from user<br />lea edx, str3 ; load effective address str3<br />call WriteString ; &quot;Please enter two Floating Point Numbers, &quot;<br />lea edx, buffer ; load effective offset buffer<br />call WriteString ; display user name<br />call Crlf ; end line<br /><br />Again:<br />call Crlf<br /><br />lea edx, str4 ; load effective address str4<br />call WriteString ; &quot;Enter first Floating Point Number: &quot;<br />Enterstring FPVal1 ; read floating point value from user<br />call Crlf ; end line<br /><br />lea edx, str5 ; load effective offset str5<br />call WriteString ; &quot;Enter second Floating Point Number: &quot;<br />Enterstring FPVal2 ; read floating point value from user <br />call Crlf ; end line<br /><br /><br />Check_Length:<br /><br />lea esi, FPVal1<br />lea edi, FPVal1<br /><br />mov al, lengthof FPVal1<br />mov ah, lengthof FPVal2<br /><br />cmp al, ah<br />jge Mov_Val1<br /><br />Mov_Val1:<br />cmp byte ptr , '.'<br />je Mov_Right_Side1<br />inc esi<br />jmp Mov_Val1<br /><br />Mov_Right_Side1:<br /><br />L1:<br />cmpsb <br />je Done<br />dec esi<br />mov bl, <br />mov FPVal_W1, bl<br />jmp L1<br /><br /><br />comment % ;comment out from here <br /><br />.IF ( (byte ptr  == 0Ah) ||(byte ptr  == 0Dh) )<br />jmp Done<br />.ENDIF<br /><br />inc esi<br />xor eax, eax<br />mov eax, <br />mov FPVal_D1, eax<br />jmp Mov_Right_Side1<br /><br />Mov_Val2:<br />cmp byte ptr , '.'<br />je Mov_Right_Side2<br /><br />xor eax, eax<br />mov eax, <br />mov FPVal_W1, edx<br />inc edi<br />jmp Mov_Val2<br /><br />Mov_Right_Side2:<br />.IF ( (byte ptr  == 0Ah) ||(byte ptr  == 0Dh) )<br />jmp Done<br />.ENDIF<br /><br />inc esi<br />xor eax, eax<br />mov eax, <br />mov FPVal_D1, eax<br />jmp Mov_Right_Side2<br />to here<br />% <br /><br />Done:<br />lea edx, FPVal1<br />call Writestring<br />call Crlf<br />lea edx, FPVal2<br />call Writestring<br />call Crlf<br />lea edx, FPVal_W1<br />call Writestring<br />call Crlf<br /><br />lea edx, str4 ; load effective offset str4<br />call WriteString ; &quot;Continue? (y/n): &quot;<br /><br />call ReadChar ; read character input from user<br />xor al, al ; clear al register<br />mov char, al ; copy answer to variable<br /><br />.IF (char == 'y') || (char == 'Y') ; if answer is yes<br />jmp Again ; jump back to Again<br />.ENDIF <br /><br />exit<br /><br />main ENDP<br />END main<br /><br /></div>
    <div class="meta">Posted on 2003-04-19 13:42:47 by locke</div>
   </div>
   <div class="post" id="post-98027">
    <div class="subject"><a href="#post-98027">lemme try that again</a></div>
    <div class="body">:stupid:  sorry about that<br /><br /><div class="quote"><br /><br />;===============================================<br /><br />INCLUDE Irvine32.inc<br /><br />.data<br /><br />str1 BYTE &quot;Assignment4: Addition of two Floating Point Numbers &quot;,0Ah, 0Dh, 0 <br />str2 BYTE &quot;Enter your name: &quot;, 0<br />str3 BYTE &quot;Please enter two Floating Point Numbers, &quot;,0<br />str4 BYTE &quot;Enter first Floating Point Number: &quot;, 0<br />str5 BYTE &quot;Enter second Floating Point Number: &quot;, 0<br />str6 BYTE &quot;Continue? (y/n): &quot;, 0<br /><br />char BYTE ?<br />buffer BYTE 50 dup (0)<br /><br />FPVal1 BYTE 50 dup ('0')<br />FPVal2 BYTE 50 dup ('0')<br /><br />FPSum1 BYTE 50 dup ('0')<br /><br />FPVal_W1 BYTE 50 dup ('0')<br />FPVal_D1 BYTE 50 dup ('0')<br /><br />FPVal_W2 BYTE 50 dup ('0')<br />FPVal_D2 BYTE 50 dup ('0')<br /><br />FPSum_W1 BYTE 60 dup ('0')<br />FPSum_D1 BYTE 60 dup ('0')<br /><br /><br />setPointer MACRO reg, var ; Macro to set pointer<br />lea reg, var ; Load Effective Address of register <br />add reg, lengthof var ; Move pointer to end of string<br />dec reg ; Move back one <br />ENDM ; End of Macro definition<br /><br />EnterString MACRO FP_Buffer ; Readstring Macro<br />lea edx, FP_Buffer ; Load Effective Address of FP_Buffer<br />mov ecx, (SIZEOF FP_Buffer) - 1 ; Maximum number of characters <br />call Readstring ; Call Readstring function<br />ENDM<br /><br />.code<br /><br />main PROC<br /><br />mov eax, lightGreen + (black * 16) ;light green text on black background<br />call SetTextColor<br />call Clrscr<br /><br />lea edx, str1 ; load effective address str1<br />call WriteString ; &quot;Assignment4: Addition of two Floating Point Numbers&quot;<br />call Crlf ; end line<br /><br />call WaitMsg ; &quot;Press...&quot;<br /><br />lea edx, str2 ; load effective offset str2<br />call WriteString ; &quot;Enter your name: &quot;<br /><br />lea edx, buffer ; load effective address buffer<br />mov ecx, (SIZEOF buffer) - 1 ; maximum # of characters<br /><br />call ReadString ; read string input from user<br />lea edx, str3 ; load effective address str3<br />call WriteString ; &quot;Please enter two Floating Point Numbers, &quot;<br />lea edx, buffer ; load effective offset buffer<br />call WriteString ; display user name<br />call Crlf ; end line<br /><br />Again:<br />call Crlf<br /><br />lea edx, str4 ; load effective address str4<br />call WriteString ; &quot;Enter first Floating Point Number: &quot;<br />Enterstring FPVal1 ; read floating point value from user<br />call Crlf ; end line<br /><br />lea edx, str5 ; load effective offset str5<br />call WriteString ; &quot;Enter second Floating Point Number: &quot;<br />Enterstring FPVal2 ; read floating point value from user <br />call Crlf ; end line<br /><br /><br />Check_Length:<br /><br />lea esi, FPVal1<br />lea edi, FPVal1<br /><br />mov al, lengthof FPVal1<br />mov ah, lengthof FPVal2<br /><br />cmp al, ah<br />jge Mov_Val1<br /><br />Mov_Val1:<br />cmp byte ptr , '.'<br />je Mov_Right_Side1<br />inc esi<br />jmp Mov_Val1<br /><br />Mov_Right_Side1:<br /><br />L1:<br />cmpsb <br />je Done<br />dec esi<br />mov bl, <br />mov FPVal_W1, bl<br />jmp L1<br /><br /><br />comment % ;comment out from here <br /><br />.IF ( (byte ptr  == 0Ah) ||(byte ptr  == 0Dh) )<br />jmp Done<br />.ENDIF<br /><br />inc esi<br />xor eax, eax<br />mov eax, <br />mov FPVal_D1, eax<br />jmp Mov_Right_Side1<br /><br />Mov_Val2:<br />cmp byte ptr , '.'<br />je Mov_Right_Side2<br /><br />xor eax, eax<br />mov eax, <br />mov FPVal_W1, edx<br />inc edi<br />jmp Mov_Val2<br /><br />Mov_Right_Side2:<br />.IF ( (byte ptr  == 0Ah) ||(byte ptr  == 0Dh) )<br />jmp Done<br />.ENDIF<br /><br />inc esi<br />xor eax, eax<br />mov eax, <br />mov FPVal_D1, eax<br />jmp Mov_Right_Side2<br />to here<br />% <br /><br />Done:<br />lea edx, FPVal1<br />call Writestring<br />call Crlf<br />lea edx, FPVal2<br />call Writestring<br />call Crlf<br />lea edx, FPVal_W1<br />call Writestring<br />call Crlf<br /><br />lea edx, str4 ; load effective offset str4<br />call WriteString ; &quot;Continue? (y/n): &quot;<br /><br />call ReadChar ; read character input from user<br />xor al, al ; clear al register<br />mov char, al ; copy answer to variable<br /><br />.IF (char == 'y') || (char == 'Y') ; if answer is yes<br />jmp Again ; jump back to Again<br />.ENDIF <br /><br />exit<br /><br />main ENDP<br />END main<br /><br /></div></div>
    <div class="meta">Posted on 2003-04-19 13:44:33 by locke</div>
   </div>
   <div class="post" id="post-98038">
    <div class="subject"><a href="#post-98038">Adding Two Floating Point Numbers</a></div>
    <div class="body">:confused:<br /><br />If you want to add two floating point numbers use the FPU.<br /><br />But your usage here looks more like fixed-point numbers.</div>
    <div class="meta">Posted on 2003-04-19 15:38:22 by iblis</div>
   </div>
   <div class="post" id="post-98048">
    <div class="subject"><a href="#post-98048">Adding Two Floating Point Numbers</a></div>
    <div class="body">You can also EDIT your post, no need to post 3 times.</div>
    <div class="meta">Posted on 2003-04-19 17:26:21 by bazik</div>
   </div>
   <div class="post" id="post-98227">
    <div class="subject"><a href="#post-98227">Adding Two Floating Point Numbers</a></div>
    <div class="body">well this an assignment to teach us to use ascii operations... so I have to use this method. I'm just having some problem splitting up the number into 2 parts. I have the actual use of the aaa and aas command down. I'm not sure what the problem is, but for example if someone enters: 123.456<br /><br />Instead of saving it like this: 1230000000000000000 -&gt; FPVal_W1 and 000000000000456 -&gt;FPVal_D1<br /><br />I get: 12300000000000000000456 -&gt; FPVal_W1 and 0000000000000000000456 -&gt; FPVal_D1<br /><br />Don't know where the 456 is coming from in FPVal_W1</div>
    <div class="meta">Posted on 2003-04-20 16:24:20 by locke</div>
   </div>
  </div>
 </body>
</html>