<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Opcode #7 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10554" />
  <link rel="prev" href="../?id=10554&amp;page=4" />  <link rel="next" href="../?id=10554&amp;page=6" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=10554">Opcode #7</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=10554&amp;page=1" style="">&laquo;</a><a href="../?id=10554&amp;page=4" style="">&lt;</a><input type="hidden" name="id" value="10554" /><input type="number" name="page" min="1" max="8" step="1" value="5" onchange="this.form.submit();" /><a href="../?id=10554&amp;page=6">&gt;</a><a href="../?id=10554&amp;page=8">&raquo;</a></form>   <div class="post" id="post-95884">
    <div class="subject"><a href="#post-95884">Opcode #7</a></div>
    <div class="body">heres my list :<br /><pre><code><br /><br />0x06 &#40;push es&#41;<br />0x07 &#40;pop  es&#41;<br />0x0E &#40;push cs&#41;<br />0x16 &#40;push ss&#41;<br />0x17 &#40;pop  ss&#41;<br />0x1E &#40;push ds&#41;<br />0x1F &#40;pop  ds&#41;<br />0x27 &#40;daa&#41;<br />0x2F &#40;das&#41;<br />0x37 &#40;aaa&#41;<br />0x3F &#40;aas&#41;<br />0x40 - 0x4F &#40; 0-7 inc  &lt;register&gt; | 8-F dec &lt;register&gt; &#41;<br />0x50 - 0x5F &#40; 0-7 push &lt;register&gt; | 8-F pop &lt;register&gt; &#41;<br />0x60 &#40;pushad&#41;<br />0x61 &#40;popad&#41;<br />0x6C &#40;insb&#41;<br />0x6D &#40;insd&#41;<br />0x6E &#40;outsb&#41;<br />0x6F &#40;outsd&#41;<br />0x90 &#40;nop&#41;<br />0x91-0x97 &#40; xchg &lt;register&gt;&lt;register&gt; &#41;<br />0x98 &#40;cdwe&#41;<br />0x99 &#40;cdq&#41;<br />0x9B &#40;wait&#41;<br />0x9C &#40;pushfd&#41;<br />0x9D &#40;popfd&#41;<br />0x9E &#40;sahf&#41;<br />0x9F &#40;lahf&#41;<br />0xA4 &#40;movsb&#41;<br />0xA5 &#40;movsd&#41;<br />0xA6 &#40;cmpsb&#41;<br />0xA7 &#40;cmpsd&#41;<br />0xAA &#40;stosb&#41;<br />0xAB &#40;stosd&#41;<br />0xAC &#40;lodsb&#41;<br />0xAD &#40;lodsd&#41;<br />0xAE &#40;scasb&#41;<br />0xAF &#40;scasd&#41;<br />0xC3 &#40;ret&#41;<br />0xC9 &#40;leave&#41;<br />0xCB &#40;retf&#41;<br />0xCC &#40;int 3&#41;<br />0xCE &#40;into&#41;<br />0xCF &#40;iretd&#41;<br />0xD6 &#40;salc&#41;<br />0xD7 &#40;xlat&#41;<br />0xF1 &#40;icebp&#41;<br />0xF4 &#40;hlt&#41;<br />0xF5 &#40;cmc&#41;<br />0xF8 &#40;clc&#41;<br />0xF9 &#40;stc&#41;<br />0xFA &#40;cli&#41;<br />0xFB &#40;sti&#41;<br />0xFC &#40;cld&#41;<br />0xFD &#40;std&#41;<br />&lt;prefixes&gt; takes 1 byte too ;&#41;<br /><br /></code></pre></div>
    <div class="meta">Posted on 2003-04-12 10:45:35 by wizzra</div>
   </div>
   <div class="post" id="post-95889">
    <div class="subject"><a href="#post-95889">Good Job Guys.</a></div>
    <div class="body">:alright:  Let me see, how many left Instruction I have not added.<br />Also TheSvin can you explain jmp instruction? Its more complex than mov.:stupid:</div>
    <div class="meta">Posted on 2003-04-12 10:55:47 by realvampire</div>
   </div>
   <div class="post" id="post-95922">
    <div class="subject"><a href="#post-95922">Opcode #7</a></div>
    <div class="body">I don't like both lists.<br />It's wrong format. (The same about Intel reference format<br />and couple other &quot;opcode references&quot; I saw on the board).<br />I think that's why some people think that encoding opcodes<br />is difficult - they got used to see it in a wrong format in hex.<br />Opcodes created from bit fields and they are not clearly seen<br />in hex, 'cause not all fields are multiple by 4.<br />It takes attention away from essential things.<br />This leads to missunderstandings like in the list above:<br />0x90 (nop)<br />0x91-0x97 ( xchg &lt;register&gt;&lt;register&gt; )<br />1. It's xchg eax,reg not xchg reg,reg<br />2. 90h is also xchg eax,reg.<br /><br />And format is:<br /><br />10010 reg. <br />and all the 90-97 is the same opcode<br /><br />but there are <br />other opcodes for xchg reg,reg:<br />1000011w:11 reg reg<br /><br />The same about lods - both lodsb and lodsd is the same opcode<br />using different operand size and format is:<br /><br />1010110w.<br /><br />Unfortunatly I haven't got money for inet right now.<br />We'll meet in a couple weeks, hopefully.<br />Please, look in the tuts - how formats represented,<br />along with understanding of bitfields you'd understand<br />why it's better to write code block format always in bits .</div>
    <div class="meta">Posted on 2003-04-12 13:32:33 by The Svin</div>
   </div>
   <div class="post" id="post-95931">
    <div class="subject"><a href="#post-95931">Opcode #7</a></div>
    <div class="body">cya in couple of weeks The Svin,<br />and, that list above isn't suppos to be official or something, it was just something i wrote for my self that of what opcodes i have implemented into my engine.<br />0x90 -&gt; nop == xchg eax, eax (i know that)<br />of course the best is with reg field, but hey, not everyone can see binary in his eyes ;)</div>
    <div class="meta">Posted on 2003-04-12 13:47:30 by wizzra</div>
   </div>
   <div class="post" id="post-96372">
    <div class="subject"><a href="#post-96372">Hey</a></div>
    <div class="body">Wizzra &amp; roticv. Have you see my engine?<br />click www button bellow. I have no mannual, study it all alone ;). <br /><br />I Think mov eax,eax is like a nop instruction, why? because it do nothing, unless you write it like this mov eax,. <br /><br />See ya TheSvin. My System infected by Fake2 Virus. I have to repair it. See ya 2 days later. Is Fake2 virus dangerous? I have deleted it mannualy, but Im still affraid it still resident on my HardDisk.<br /><br /><br />Good Luck guys.:alright:</div>
    <div class="meta">Posted on 2003-04-13 19:54:10 by realvampire</div>
   </div>
   <div class="post" id="post-96487">
    <div class="subject"><a href="#post-96487">Opcode #7</a></div>
    <div class="body">why no AV on ur system ?</div>
    <div class="meta">Posted on 2003-04-14 05:50:01 by wizzra</div>
   </div>
   <div class="post" id="post-96496">
    <div class="subject"><a href="#post-96496">Heheheeheh....,</a></div>
    <div class="body">I dont know, I have installed it, but it was encrypted. Besides is there any device able to copy it to my harddisk? it installed on my Brain.....:grin: <br /><br /><br />I Dont have Money. It is too expensives.</div>
    <div class="meta">Posted on 2003-04-14 06:18:40 by realvampire</div>
   </div>
   <div class="post" id="post-96965">
    <div class="subject"><a href="#post-96965">Opcode #7</a></div>
    <div class="body">Nice links<br /><br /><a target="_blank" href="http://www.sandpile.org/ia32/opc_1.htm">http://www.sandpile.org/ia32/opc_1.htm</a><br /><a target="_blank" href="http://www.sandpile.org/ia32/opc_2.htm">http://www.sandpile.org/ia32/opc_2.htm</a><br /><a target="_blank" href="http://www.sandpile.org/ia32/opc_grp.htm">http://www.sandpile.org/ia32/opc_grp.htm</a><br /><a target="_blank" href="http://www.sandpile.org/ia32/opc_rm16.htm">http://www.sandpile.org/ia32/opc_rm16.htm</a><br /><a target="_blank" href="http://www.sandpile.org/ia32/opc_rm32.htm">http://www.sandpile.org/ia32/opc_rm32.htm</a><br /><a target="_blank" href="http://www.sandpile.org/ia32/opc_sib.htm">http://www.sandpile.org/ia32/opc_sib.htm</a></div>
    <div class="meta">Posted on 2003-04-15 11:01:05 by roticv</div>
   </div>
   <div class="post" id="post-97958">
    <div class="subject"><a href="#post-97958">Opcode #7</a></div>
    <div class="body">Ah.. a question for The Svin or those that knows,<br /><br />Can prefixes be stacked? If so how are they stacked? As in rep cmpsw<br /><br />Will it be <br /><br />66h F3h A7h<br /><br />or <br /><br />F3h 66h A7h</div>
    <div class="meta">Posted on 2003-04-19 05:05:49 by roticv</div>
   </div>
   <div class="post" id="post-97968">
    <div class="subject"><a href="#post-97968">Opcode #7</a></div>
    <div class="body">I think both works, when entering the two ways both apears to work (Olly dissasembles them correctly, didn't try them in any code).<br />You can put 66h 67h after each ther to override both mem and operand size, so prefixes can be stacked.</div>
    <div class="meta">Posted on 2003-04-19 06:33:06 by scientica</div>
   </div>
   <div class="post" id="post-98192">
    <div class="subject"><a href="#post-98192">What Happened...,</a></div>
    <div class="body">When we use Call instruction?<br />1. The return address is at the top of the stack?<br />2. ESP must be substracted to get the Pointer number?<br /><br />Can I Code like this?<br /><br /><pre><code><br />Push p1<br />Push p2<br />Push p3<br />Call Func<br /><br />Func&#58;<br />Pop addrret<br />Pop p3<br />pop p2<br />pop p1<br />&#91;instruction&#93;<br />...<br />...<br />...<br /></code></pre></div>
    <div class="meta">Posted on 2003-04-20 10:47:03 by realvampire</div>
   </div>
   <div class="post" id="post-98221">
    <div class="subject"><a href="#post-98221">Opcode #7</a></div>
    <div class="body">ur stack is no balanced.<br />you pop too much.<br /><br />1. yeah, ESP Points to the 'return address' when you call a PROC<br />2. depends on the proc style you use pascal/c (if i understood you correctly)<br />styles:<br />pascal - compiler fix esp's position<br />c - programmer's responsibility</div>
    <div class="meta">Posted on 2003-04-20 15:20:22 by wizzra</div>
   </div>
   <div class="post" id="post-98253">
    <div class="subject"><a href="#post-98253">Re: What Happened...,</a></div>
    <div class="body"><div class="quote"><br />Can I Code like this?</div><br />Yes, you can also do this:<br />(sorry if I mess your mind up now :grin: )<br /><pre><code><br />; &#40;fasm syntax&#41;<br />push @F ;|<br />jmp Lx  ;| &quot;call Lx&quot;<br />@@&#58;     ;|<br />call Lx<br />call Lx2<br />push dword 0 ; arg0<br />push dword ExitProcess ; address to ExitProcess jmp &#40;&quot;PE idata magic&quot; aka API call&#41;<br />jmp Lx ; &quot;return&quot; to exit process...<br />nop ; - we'll never be here... ;&#41;<br /><br />Lx&#58;<br />ret<br /><br />Lx2&#58;<br />pop eax ;|<br />jmp eax ;| &quot;ret&quot;</code></pre><br />call = push eip, and jmp to &quot;target&quot;<br />ret = pop &quot;ret_address&quot; of stand and jump to &quot;ret_adress&quot;</div>
    <div class="meta">Posted on 2003-04-20 18:21:17 by scientica</div>
   </div>
   <div class="post" id="post-98270">
    <div class="subject"><a href="#post-98270">Aha...</a></div>
    <div class="body">Im &quot;RealMen&quot; not C :grin:, Coded it Bare handed. <br /><br /><pre><code><br />GetEIP proc  lpBupp&#58;dword<br />  <br />  pop Ecx    ;Get EIP<br />  push Ecx   ;Push it again it at ECX<br />  invoke  dw2a,Ecx,lpBupp   <br /><br />  ret<br />GetEIP endp<br /><br />Restart proc<br /><br /> pop Ecx<br /> mov eax,0FFF0h         ;Restart address<br /> push eax                    ;Replace return address<br />             <br />ret<br />Restart Endp<br /></code></pre></div>
    <div class="meta">Posted on 2003-04-20 20:30:10 by realvampire</div>
   </div>
   <div class="post" id="post-108579">
    <div class="subject"><a href="#post-108579">Opcode #7</a></div>
    <div class="body"><div class="quote"><br />the RTA assembler is nice too <br /><br />-&gt; <a target="_blank" href="http://www.anticrack.de/modules.php?op=modload&amp;name=Downloads&amp;file=index&amp;req=getit&amp;lid=3834">http://www.anticrack.de/modules.php?op=modload&amp;name=Downloads&amp;file=index&amp;req=getit&amp;lid=3834</a><br /><br />using Hiew is cool, but for those who have 2k/xp it isn't =) since the fullscreen dos is pretty small </div><br /><br />It's adjustable:<br />from SEN<br />Q02. I was over to Win2k/WinXP and was very surprised that I can't run the HIEW.<br /><br />A02. (Ruslan Kantorovych)<br /><br />     So what is a problem,  the HIEW works up 120x50 mode, but the setting for<br />     every DOS mode window on Win2k/WinXP is 80x300.<br />     I solved this problem by setting the default mode to 80x25 for every<br />     window.<br />     How you can do it:<br />       Open the DOS mode window;<br />       Click on the picture of the DOS mode window in the left up angle of<br />        the window;<br />       Choose &quot;Default&quot; (it's important);<br />       After that choose &quot;Properties&quot;;<br />       Open &quot;Layout&quot; dialog;<br />       In the &quot;Screen Buffer Size&quot; area put the number 25 into &quot;Height&quot;<br />        control (by default it's 300);<br />       Press OK button it's all :)</div>
    <div class="meta">Posted on 2003-06-28 18:53:37 by The Svin</div>
   </div>
   <div class="post" id="post-108594">
    <div class="subject"><a href="#post-108594">hi</a></div>
    <div class="body">Welcome Back The Svin. Long time I dont see you</div>
    <div class="meta">Posted on 2003-06-28 21:36:05 by realvampire</div>
   </div>
   <div class="post" id="post-108659">
    <div class="subject"><a href="#post-108659">Opcode #7</a></div>
    <div class="body"><div class="quote"><br />Q02. I was over to Win2k/WinXP and was very surprised that I can't run the HIEW.</div><br />I've been able to run HIEW on a 2k box using this start file, IIRC it wouldn't start on that box when just running hiew.exe. :rolleyes:<br /><div class="quote"><em>start.cmd</em><br />@forcedos /D . HIEW.EXE %*</div><br /><br />note. the %* allows you to give arguments to HIEW, all agruments passed to start.cmd are passed onto HIEW, it's far better than using %1 %2 %3 ..., and when using that method it's not sure you got enought %n</div>
    <div class="meta">Posted on 2003-06-29 06:01:31 by scientica</div>
   </div>
   <div class="post" id="post-108671">
    <div class="subject"><a href="#post-108671">Opcode #7</a></div>
    <div class="body">Welcome Back The-Svin!<br />we missed ya :) &amp; thnx for the fixUp!<br /><br />The Svin, iv got a question,<br />what bit tells whenever we use 1 reg, or 2 reg in the SIB mode ?<br />exmaple:<br /><br /><pre><code><br />?81 AC 1E 00?	?00 00?	?00 00 00 00 00?	?= sub dword ptr &#91;ebx+esi+00000000&#93;, 00000000?<br />?81 AC 1F 00?	?00 00?	?00 00 00 00 00?	?= sub dword ptr &#91;ebx+edi+00000000&#93;, 00000000?<br />?81 AC 20 00 00 00 00 00 00 00 00?	?= sub dword ptr &#91;eax+00000000&#93;, 00000000? &lt;-- this instruction<br />?81 AC 21 00?	?00 00?	?00 00 00 00 00?	?= sub dword ptr &#91;ecx+00000000&#93;, 00000000? &lt;-- or this<br />...<br />...<br />...<br />?81 AC 28 00?	?00 00?	?00 00 00 00 00?	?= sub dword ptr &#91;ebp+eax+00000000&#93;, 00000000? &lt;-- back to 2 regs...<br /></code></pre></div>
    <div class="meta">Posted on 2003-06-29 10:37:18 by wizzra</div>
   </div>
   <div class="post" id="post-108712">
    <div class="subject"><a href="#post-108712">Opcode #7</a></div>
    <div class="body">format of sib is:<br />ss iii bbb.<br />where ss is 2 upper bits for scale<br />and they represent power (exponent) of 2 for<br />scale index multipyer.<br />iii is 3 middle bits for index.<br />bbb is 3 low bits for base.<br />ESP (code 100) can not be index register.<br />and when its code is placed on index field it means<br />that sib has no index register.<br />in your case sib is 20h<br />in bits 00 100 000<br />00 in 2^0 = 1 scale = 1<br />100 - ESP -&gt; that means &quot;no index&quot;<br />000 EAX.<br />modrm = ACh  <br />mod = 10b = displacement in 32 size. so that four bytes after<br />sib is taken as displacement.<br />so we have [1*no index]++[00000000]<br /><br />It's not a bit that shows whether here is 1 or 2 regs.<br />It's coded through specifying absence of either index or<br />base regs.<br />Absence of index reg is specifyed by placing code for ESP in index<br />bit field and absence of base reg is specifyed placing 00 in mod field<br />and code for ebp in base field.<br />For example in your case you could code in with absence of base reg:<br /> 81 2C 05 00 00 00 00 00 00 00 00<br /><br />modrm = 2C mod = 00 sib = 05 <br />scale 00<br />index 000 (eax)<br />base  101 (ebp) 101 in base place with 00 in mod place means - no base only 32 bit <br />displacement.</div>
    <div class="meta">Posted on 2003-06-29 20:14:56 by The Svin</div>
   </div>
   <div class="post" id="post-108733">
    <div class="subject"><a href="#post-108733">Opcode #7</a></div>
    <div class="body">thank you very much The Svin!<br />i had a hunch about the ESP -&gt; no Index, but u gave me more valuable info!!<br />damn i am glab ur back :) :alright: :alright: :alright:</div>
    <div class="meta">Posted on 2003-06-30 00:41:59 by wizzra</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=10554&amp;page=1" style="">&laquo;</a><a href="../?id=10554&amp;page=4" style="">&lt;</a><input type="hidden" name="id" value="10554" /><input type="number" name="page" min="1" max="8" step="1" value="5" onchange="this.form.submit();" /><a href="../?id=10554&amp;page=6">&gt;</a><a href="../?id=10554&amp;page=8">&raquo;</a></form>  </div>
 </body>
</html>