<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Opcode #7 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10554" />
  <link rel="prev" href="../?id=10554&amp;page=3" />  <link rel="next" href="../?id=10554&amp;page=5" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=10554">Opcode #7</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=10554&amp;page=1" style="">&laquo;</a><a href="../?id=10554&amp;page=3" style="">&lt;</a><input type="hidden" name="id" value="10554" /><input type="number" name="page" min="1" max="8" step="1" value="4" onchange="this.form.submit();" /><a href="../?id=10554&amp;page=5">&gt;</a><a href="../?id=10554&amp;page=8">&raquo;</a></form>   <div class="post" id="post-92557">
    <div class="subject"><a href="#post-92557">I dont understand...</a></div>
    <div class="body">On my Prog. Xor ebx,esi is 33 F3 not 31 DE. Can you explain it ? :confused:</div>
    <div class="meta">Posted on 2003-04-02 08:05:01 by realvampire</div>
   </div>
   <div class="post" id="post-92563">
    <div class="subject"><a href="#post-92563">Opcode #7</a></div>
    <div class="body">D flag<br /><br />XOR ebx,esi<br /><br />can be<br />--------------------------------<br />001100 11 11 011 110<br /><br />which is 33 DE<br /><br />or<br /><br />001110 01 11 110 011<br /><br />which is 39 F3<br /><br />Correct me if i am wrong</div>
    <div class="meta">Posted on 2003-04-02 08:44:39 by roticv</div>
   </div>
   <div class="post" id="post-92606">
    <div class="subject"><a href="#post-92606">Opcode #7</a></div>
    <div class="body">roticv is absolultly right.<br />cod/r and mem/r field are containers wich hold operands<br />and d flag(direction) points wich one of them source and<br />wich one is destination. So if you swap them and change direction flag - you get the same result.<br />And latest app focuses on understanding it, as one of educational methods to understand meaning of D flag.<br />In referece page it even has arrow that show direction.<br />Changing bit D you change the direction accordinly.<br /><br />!!!!!<br />I ask moderators again: delete previous version of the app - I can not do it.</div>
    <div class="meta">Posted on 2003-04-02 11:17:54 by The Svin</div>
   </div>
   <div class="post" id="post-92644">
    <div class="subject"><a href="#post-92644">Opcode #7</a></div>
    <div class="body"><div class="quote"><br />!!!!!<br />I ask moderators again: delete previous version of the app - I can not do it. </div><br />I've got a better idea for the moderators: make the Svin a moderator (in this forum or an special forum for opcodes). :)<br /><br />the Svin for president! :alright:</div>
    <div class="meta">Posted on 2003-04-02 13:34:27 by scientica</div>
   </div>
   <div class="post" id="post-92650">
    <div class="subject"><a href="#post-92650">Opcode #7</a></div>
    <div class="body">I hope, we soon finish with opcodes and proceed with<br />number theory, formats and integer math.</div>
    <div class="meta">Posted on 2003-04-02 14:10:25 by The Svin</div>
   </div>
   <div class="post" id="post-92679">
    <div class="subject"><a href="#post-92679">Opcode #7</a></div>
    <div class="body">which attachment is it that you need deleted?<br />You seem to have multiple different ones.</div>
    <div class="meta">Posted on 2003-04-02 17:24:34 by Hiroshimator</div>
   </div>
   <div class="post" id="post-92684">
    <div class="subject"><a href="#post-92684">Opcode #7</a></div>
    <div class="body">In post where I first asked to delete attachment, attached file mod11b~1.zip, the same mod11b~1.zip was attached<br />couple posts before.<br />That previous file needs to be deleted, 'cause has a bug wich was removed it latest attachment.</div>
    <div class="meta">Posted on 2003-04-02 17:38:41 by The Svin</div>
   </div>
   <div class="post" id="post-92687">
    <div class="subject"><a href="#post-92687">Opcode #7</a></div>
    <div class="body">ok I think I have it.<br />I'll need to find some sort of better way to deal with attachments :(</div>
    <div class="meta">Posted on 2003-04-02 17:42:31 by Hiroshimator</div>
   </div>
   <div class="post" id="post-92955">
    <div class="subject"><a href="#post-92955">Heheheeheh....,</a></div>
    <div class="body"><div class="quote"><br />In post where I first asked to delete attachment, attached file mod11b~1.zip, the same mod11b~1.zip was attached<br />couple posts before.<br />That previous file needs to be deleted, 'cause has a bug wich was removed it latest attachment. </div><br /><br />Thats why MS decided to take back all of their product :grin: (Just a Joke). sVin caould you please tell me about Org ?:alright:</div>
    <div class="meta">Posted on 2003-04-03 17:51:03 by realvampire</div>
   </div>
   <div class="post" id="post-93258">
    <div class="subject"><a href="#post-93258">Opcode #7</a></div>
    <div class="body">It's strange place ask about ORG in the thread<br />where bit fields of opcode are being discussed.<br />But I'll try to make related to opcode.<br />Lemonade from lemon.<br />ORG is about setting offset counter:<br /><br />ORG expression<br />Sets the location counter to expression.<br /><br />Now how can it be used creating needed opcode<br />format without totaly writing in hex.<br />Last artical discussed S bit of code block.<br />From it is clear (who don't understand about<br />S bit - please, read the artical before asking questions)<br />that if value of immediate operand may be<br />represented in sign byte (-128&gt;=x&lt;=127) opcode<br />that used the imm. operand may be coded in two<br />different ways - with S bit = 1 and imm operand block = 1byte<br />or with S bit = 0 and imm. operand block = full size (in Win32 dword<br />if prefix 66h is not used)<br />For example:<br /><br /><pre><code><br />83E9 02          SUB ECX,2 ; Code block 83 - s bit = 1<br />81E9 02 00 00 00  SUB ECX,2 ; Code block 81 - s bit = 0<br /></code></pre><br /><br /><br />Assembler always generates optimal version. (In the case - 3 bytes 83E9 02)<br />So what if we want to force assembler generate 6 byte version,<br />for example for alignment perpose. But we don't want write everything in hex.<br />Here is how we can do it :<br /><pre><code><br />sub ecx,8888h ; any value that can't be in size of sign byte<br />org $-4	      ;set address counter to start of imm. operand block<br />dd 2	       ;overwrite 00008888h with 00000002h<br /></code></pre><br />sub ecx,8888h<br />will force assemble generate code block with S bit = 0 'cause 8888h <br />operand exceed limits of signed byte.<br />Then we set counter on place of 88 88 00 00 generated imm. operand <br />and replace them with <br />dd 2 = 02 00 00 00 in bytes.<br />81E9 02 00 00 00 will be generated.</div>
    <div class="meta">Posted on 2003-04-04 13:51:31 by The Svin</div>
   </div>
   <div class="post" id="post-94845">
    <div class="subject"><a href="#post-94845">Opcode #7</a></div>
    <div class="body">quick question The Svin,<br />what bit(s) would tell the reg16/32 in for example those:<br /><br />00401000      000400              ADD     BYTE PTR DS:, AL<br />00401003      000C00              ADD     BYTE PTR DS:, CL<br />00401006      001400              ADD     BYTE PTR DS:, DL<br />00401009      001C00              ADD     BYTE PTR DS:, BL<br />0040100C      002400              ADD     BYTE PTR DS:, AH<br />0040100F      002C00              ADD     BYTE PTR DS:, CH<br />00401012      003400              ADD     BYTE PTR DS:, DH<br />00401015      003C00              ADD     BYTE PTR DS:, BH<br />--------------------------------------------------------------------<br />00401000      004000              ADD     BYTE PTR DS:, AL<br />00401003      000C00              ADD     BYTE PTR DS:, CL<br />00401006      001400              ADD     BYTE PTR DS:, DL<br />00401009      001C00              ADD     BYTE PTR DS:, BL<br />0040100C      002400              ADD     BYTE PTR DS:, AH<br />0040100F      002C00              ADD     BYTE PTR DS:, CH<br />00401012      003400              ADD     BYTE PTR DS:, DH<br />00401015      003C00              ADD     BYTE PTR DS:, BH<br />----------------------------------------------------------------------<br />00401000      008000              ADD     BYTE PTR DS:, AL<br />00401003      000C00              ADD     BYTE PTR DS:, CL<br />00401006      001400              ADD     BYTE PTR DS:, DL<br />00401009      001C00              ADD     BYTE PTR DS:, BL<br />0040100C      002400              ADD     BYTE PTR DS:, AH<br />0040100F      002C00              ADD     BYTE PTR DS:, CH<br />00401012      003400              ADD     BYTE PTR DS:, DH<br />00401015      003C00              ADD     BYTE PTR DS:, BH<br />----------------------------------------------------------------------------<br /><br />i don't mean the reg+reg, only the [],reg part<br />i sketched a bits looks: 0000 0000 01 00 00 000 000 (hope fully this is a right one), anyway to determind the reg?</div>
    <div class="meta">Posted on 2003-04-09 13:54:17 by wizzra</div>
   </div>
   <div class="post" id="post-94904">
    <div class="subject"><a href="#post-94904">Wheeew...</a></div>
    <div class="body">00401000 000400 ADD BYTE PTR DS:, AL<br />00401003 000C00 ADD BYTE PTR DS:, CL<br />00401006 001400 ADD BYTE PTR DS:, DL<br />00401009 001C00 ADD BYTE PTR DS:, BL<br />0040100C 002400 ADD BYTE PTR DS:, AH<br />0040100F 002C00 ADD BYTE PTR DS:, CH<br />00401012 003400 ADD BYTE PTR DS:, DH<br />00401015 003C00 ADD BYTE PTR DS:, BH<br />--------------------------------------------------------------------<br />00401000 004000 ADD BYTE PTR DS:, AL<br />00401003 000C00 ADD BYTE PTR DS:, CL<br /><div class="quote"><br />00401006 001400 ADD BYTE PTR DS:, DL<br />00401009 001C00 ADD BYTE PTR DS:, BL<br />0040100C 002400 ADD BYTE PTR DS:, AH<br />0040100F 002C00 ADD BYTE PTR DS:, CH<br />00401012 003400 ADD BYTE PTR DS:, DH<br />00401015 003C00 ADD BYTE PTR DS:, BH<br />----------------------------------------------------------------------<br />00401000 008000 ADD BYTE PTR DS:, AL<br />00401003 000C00 ADD BYTE PTR DS:, CL<br />00401006 001400 ADD BYTE PTR DS:, DL<br />00401009 001C00 ADD BYTE PTR DS:, BL<br />0040100C 002400 ADD BYTE PTR DS:, AH<br />0040100F 002C00 ADD BYTE PTR DS:, CH<br />00401012 003400 ADD BYTE PTR DS:, DH<br />00401015 003C00 ADD BYTE PTR DS:, BH<br />----------------------------------------------------------------------------<br /><br />i don't mean the reg+reg, only the [],reg part<br />i sketched a bits looks: 0000 0000 01 00 00 000 000 (hope fully this is a right one), anyway to determind the reg?<br /></div><br /><br />:confused:  I now understand why mommy did not let me subscribe this thread....</div>
    <div class="meta">Posted on 2003-04-09 17:58:30 by realvampire</div>
   </div>
   <div class="post" id="post-95028">
    <div class="subject"><a href="#post-95028">Opcode #7</a></div>
    <div class="body">heheheheh<br />well, /me feels sorry over the pentium :)<br />those basted bits can make ya completely mad :)<br />hope fully The Svin knows much better to answer my question :D</div>
    <div class="meta">Posted on 2003-04-10 01:38:34 by wizzra</div>
   </div>
   <div class="post" id="post-95832">
    <div class="subject"><a href="#post-95832">Opcode #7</a></div>
    <div class="body">I'v played abit to find how to get the XX,AL / AL,XX reg bits,<br />and found it <br /><br /><pre><code><br />AL&#58; &#91;0-7&#93;<br />00 &#91;b&#93;000&#91;/b&#93; 000<br />00 000 001<br />00 000 111<br /><br />CL&#58; &#91;8-F&#93;<br />00 001 000<br />00 001 001<br />00 001 111<br /><br />DL&#58; &#91;10-17&#93;<br />00 010 000<br />00 010 001<br />00 010 111<br /><br />BL&#58; &#91;18-1F&#93;<br />00 011 000<br />00 011 001<br />00 011 111<br /><br />AH&#58; &#91;20-27&#93;<br />00 100 000<br />00 100 001<br />00 100 111<br />   <br />CH&#58; &#91;28-2F&#93;<br />00 101 000<br />00 101 001<br />00 101 111<br /><br />DH&#58; &#91;30-37&#93;<br />00 110 000<br />00 110 001<br />00 110 111<br /><br />BH&#58; &#91;38-3F&#93;<br />00 111 000<br />00 111 001<br />00 111 111<br /></code></pre><br /><br />it repeats it self over the 0x40-0x80<br /><br />So basically you come out with this formula:<br />&lt;D/W&gt; &lt;REG&gt; &lt;ADDRESSING&gt;<br /><br />(32/16) XX,AL/AL,XX <br /><br />Those damn bits can give ya allot of headach :P</div>
    <div class="meta">Posted on 2003-04-12 04:27:25 by wizzra</div>
   </div>
   <div class="post" id="post-95835">
    <div class="subject"><a href="#post-95835">errrr......,</a></div>
    <div class="body">I already Know it.<br />Check my tools at The Heap Forum. The thread name is &quot;FARABI is Open Source!Get Here&quot;.<br />What is inside the OBJ file?<br /><br /><pre><code><br /><br />Example&#58;<br />mov eax,ecx ; 8BC0<br />nop ; 90<br />nop ;90.<br /><br /></code></pre><br /><br />Will it be 8B C0 90 90 in obj file ? :confused:</div>
    <div class="meta">Posted on 2003-04-12 04:34:23 by realvampire</div>
   </div>
   <div class="post" id="post-95837">
    <div class="subject"><a href="#post-95837">Opcode #7</a></div>
    <div class="body">If I am not wrong, obj have their own file header and stuffs like that including sections.<br /><br />By the way The Svin, could you explain to me how the processor knows how long is the opcode? ie, how it tells the opcode it is reading is 1 byte or it is 2 byte?</div>
    <div class="meta">Posted on 2003-04-12 04:43:28 by roticv</div>
   </div>
   <div class="post" id="post-95851">
    <div class="subject"><a href="#post-95851">Opcode #7</a></div>
    <div class="body">wizzra,<br />First byte - code block.<br />In second byte (modr/m) - two upper bits - mod, it says if address<br />address part of opcode has displacment bits and how many of them.<br />last three bits - mem/r field, it says if there is SIB byte following the<br />byte(100) then all pointers are in the SIB;<br />if there is no register pointers just displacement (mod=00 and mem/r =101);<br />otherwise it has code for register - pointer.<br />I belive it all is explained it details in this very thread, just read it.<br />Or you want me decode opcodes in bits reference as an example?<br />If so - please, choose 2 or 3 of them, I'm lazy to type bit reference<br />decoding for all in your list, it's too big.<br /><br />000C00 ADD BYTE PTR DS:, CL<br /><br />00 0C 00<br />First byte 00 - code block.<br />in bits 00000 0 0<br />code = 00000 - code for add<br />d  =  0 - from code/r to mem/r<br />w =   0 - size of operand = byte.<br /><br />Next byte - modr/m<br />in bit fields 00 001 100<br />mod = 00 = mem/r has memory operands without<br />                   displacement<br />reg   = 001 = CL<br />mem/r = 100 = SIB is next byte and all memory pointers<br />in SIB<br /><br />Last byte - SIB<br />in bit fields 00 000 000<br />scale = 00 = x1<br />index = 000 = eax<br />base  = 000 = eax<br /><br />Decode second and third byte of each opcode in your<br />list the same way as I've done above.<br />If you don't know how to understand values of each bitfield - reread the thread, here is absolutly detailed explonation of meaning of each field and reference of<br />all values that can be in the fields.<br /><br />My good friend scientica can easily decode it for you if<br />there still a problem.<br />Seems that he is the only one who's read all the text :)</div>
    <div class="meta">Posted on 2003-04-12 07:20:43 by The Svin</div>
   </div>
   <div class="post" id="post-95854">
    <div class="subject"><a href="#post-95854">Opcode #7</a></div>
    <div class="body"><div class="quote"><br />By the way The Svin, could you explain to me<br /> how the processor knows how long is the opcode?<br /> ie, how it tells the opcode it is reading is 1 byte or it is 2 byte?<br /></div><br /><br />Do you mean the whole opcode of instruction or just code block?<br />If code block has 2 bytes first byte if special &quot;set&quot; byte.<br />There is a few such bytes, and if first byte is not one of them - then<br />code block is 1 byte size.<br />Give me some raw opcode, I'll write down how I would determine<br />its size using human logic, it could help to understand how processor understand it.<br />General logic is:<br />1. While byte is prefix - go to next byte.<br />2. First not prefix byte - start of code block,<br />    check if it is from &quot;new instruction set&quot; (for example if first code block byte 0F etc.)<br />3. Code block itself assumes operands, if instruction has no operands - finished,<br />some instruction assumes imm. operand then from s bit processor determines size of it.<br />(if prefix 66 used it's also counted 'cause it changes size of imm. if s = 0)<br />4. If code supposed to use modr/m then decoding it processor no if there is displacement,<br />and how many bytes it has and if there is sib byte. <br />Talking of all machine instruction size, it is not a right question &quot;how long instruction is&quot;<br />Processor actually needs to know not size but <br />-where is end of instruction.<br />-where to take operands from and how interpret them.<br /><br />If you are reading a book you don't need to know what is size of the book,<br />you need to see punctuations to<br />understand logical blocks of sentences.<br />And know that it finished at last.</div>
    <div class="meta">Posted on 2003-04-12 07:49:39 by The Svin</div>
   </div>
   <div class="post" id="post-95865">
    <div class="subject"><a href="#post-95865">Opcode #7</a></div>
    <div class="body">hehe The Svin!<br />well, i did read it all, thats why i came to conclusion by doing some binary..<br />at beginning i havet noticed few stuff, but its ok now!<br />thnx for ur explanation.<br />but its better to ask than just aasuming :)</div>
    <div class="meta">Posted on 2003-04-12 09:11:30 by wizzra</div>
   </div>
   <div class="post" id="post-95881">
    <div class="subject"><a href="#post-95881">Opcode #7</a></div>
    <div class="body">I see. Thanks.<br /><br />So the 1 byte opcodes are<br /><br /><pre><code><br />DAA	27h<br />DAS	2Fh<br />AAA	37h<br />AAS	3Fh<br />INC	40h-47h<br />DEC	48h-4Fh<br />PUSH	50h-57h<br />POP	58h-5Fh<br />PUSHAD	60h<br />POPAD	61h<br />CWDE	98h<br />CDQ	99h<br />PUSHFD	9Ch<br />POPFD	9Dh<br />SAHF	9Eh<br />LAHF	9Fh<br />HLT	F4h<br />CLC	F8h<br />STC	F9h<br />CLI	FAh<br />STI	FBh<br />CLD	FCh<br />STD	FDh<br /><br /></code></pre><br />If there is more 1 byte opcodes please tell me</div>
    <div class="meta">Posted on 2003-04-12 10:34:28 by roticv</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=10554&amp;page=1" style="">&laquo;</a><a href="../?id=10554&amp;page=3" style="">&lt;</a><input type="hidden" name="id" value="10554" /><input type="number" name="page" min="1" max="8" step="1" value="4" onchange="this.form.submit();" /><a href="../?id=10554&amp;page=5">&gt;</a><a href="../?id=10554&amp;page=8">&raquo;</a></form>  </div>
 </body>
</html>