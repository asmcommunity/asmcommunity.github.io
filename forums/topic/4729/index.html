<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>WriteFile don't work on XP..... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4729" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4729">WriteFile don't work on XP.....</a></p>
   <div class="post" id="post-33188">
    <div class="subject"><a href="#post-33188">WriteFile don't work on XP.....</a></div>
    <div class="body">I get PC blocked calling WriteFile un serial port in XP.<br /><br />Someone know why?<br /><br /><br />THX B7</div>
    <div class="meta">Posted on 2002-04-12 01:01:20 by Bit7</div>
   </div>
   <div class="post" id="post-33309">
    <div class="subject"><a href="#post-33309">WriteFile don't work on XP.....</a></div>
    <div class="body">Bit7,<br /><br />Not sure what you mean by 'PC blocked', but I'm using XP and<br />CreateFile, WriteFile, and ReadFile are working fine on the serial<br />ports.  Not only do I see the results on the machines I'm connected to, but also w/ 'Portmon.exe' from sysinternals.com<br /><br />Dave</div>
    <div class="meta">Posted on 2002-04-13 06:32:28 by DaveTX47</div>
   </div>
   <div class="post" id="post-33525">
    <div class="subject"><a href="#post-33525">WriteFile don't work on XP.....</a></div>
    <div class="body">DaveTX47,<br /><br />many thanks. This is a good start to say &quot;problem is on my code&quot;.<br /><br />I've write a little communication program....  Works great on 95-98.<br /><br />On XP, pc seems to eneter into infinite loop (mouse arro change in wait.. icon) after a PurgeComm function....  I've try to skipped PurgeComm(rem) and now is the same at the following WriteFile function....<br /><br />Probably there's something else not compatible on my code..... <br />Maybe i open the file in a wrong way.... but in 95 works good...<br /><br />If you like to see, attached is the code.<br /><br />Many thx   B7</div>
    <div class="meta">Posted on 2002-04-15 00:57:37 by Bit7</div>
   </div>
   <div class="post" id="post-33595">
    <div class="subject"><a href="#post-33595">WriteFile don't work on XP.....</a></div>
    <div class="body">I never tried this under XP, but maybe ...<br /><br />You use GetCommState to get an initial DCB structure for setting up new state.<br />Maybe, the initial state is wired under XP, try to setup an DCB with &quot;BuildCommDCB&quot;.<br /><br />Another problem may be writing a full buffer to the com port. I remember &quot;darkly&quot; some problems I had (during<br />programming an open command for a cash-drawer) with writing more than one byte at once.<br />My solution was to make a write loop, that wrote only one byte per WriteFile.</div>
    <div class="meta">Posted on 2002-04-15 12:37:57 by beaster</div>
   </div>
   <div class="post" id="post-33667">
    <div class="subject"><a href="#post-33667">WriteFile don't work on XP.....</a></div>
    <div class="body">beaster,<br /><br />many thanks, i will try.</div>
    <div class="meta">Posted on 2002-04-16 01:16:43 by Bit7</div>
   </div>
  </div>
 </body>
</html>