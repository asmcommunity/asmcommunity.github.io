<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>need help opening win386.swp - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3802" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3802">need help opening win386.swp</a></p>
   <div class="post" id="post-25662">
    <div class="subject"><a href="#post-25662">need help opening win386.swp</a></div>
    <div class="body">I tried using CreateFile to open the win386.swp but it fails every time.  GetLastError show a sharing violation.  I know the file is in use when windows is running but does this message mean the file is impossible to open?  <br />Thanks for any suggestions.<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-02-23 23:35:52 by czDrillard</div>
   </div>
   <div class="post" id="post-25664">
    <div class="subject"><a href="#post-25664">need help opening win386.swp</a></div>
    <div class="body">Test it Please:<br /><br />;********************************************<br /> .data<br />FileName db &quot;c:\win386.swp&quot;<br /><br />.code<br />         invoke CreateFile,addr FileName,GENERIC_READ,FILE_SHARE_READ or  FILE_SHARE_WRITE	,NULL,OPEN_EXISTING,NULL,NULL<br />;********************************************<br /><br />Why you can't open it may be that you set the second parameter of &quot;CreateFile&quot; other than &quot;GENERIC_READ&quot;.<br /><br />Have a good day!<br /><br />                                                      Smallwaves.</div>
    <div class="meta">Posted on 2002-02-23 23:53:43 by smallwaves</div>
   </div>
   <div class="post" id="post-25666">
    <div class="subject"><a href="#post-25666">need help opening win386.swp</a></div>
    <div class="body">Can you really open this file.  My first thought is that kernel32 holds it open with no sharing flags.  Maybe I'm wrong but it seems very un-microsoft to allow r/w to the swap file from any prog.</div>
    <div class="meta">Posted on 2002-02-24 00:10:09 by rdaneel</div>
   </div>
   <div class="post" id="post-25671">
    <div class="subject"><a href="#post-25671">need help opening win386.swp</a></div>
    <div class="body">And If you have some simply way to open it.<br /><br /><br />:confused: <br /><br /><br />Have a good day!</div>
    <div class="meta">Posted on 2002-02-24 02:38:34 by smallwaves</div>
   </div>
   <div class="post" id="post-25674">
    <div class="subject"><a href="#post-25674">need help opening win386.swp</a></div>
    <div class="body">;******************************<br /><br />Under Windows 98, the swap file can reside on a compressed drive if a protected-mode driver (that is, Drvspace.vxd) controls the compressed drive. DriveSpace marks the swap file as uncompressible and<a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=3802">places the swap file as the last file in the sector heap </a>  places the swap file as the last file in the sector heap (to reduce the risk of fragmentation), allowing room for the swap file to grow. <br /><br />;******************************<br /><br />------------------From MSDN----------------------<br /><br />if win386.swp is in driver c:\ ,Could you read it like What diskedit  does? <br /><br />hope it helps.</div>
    <div class="meta">Posted on 2002-02-24 03:27:29 by smallwaves</div>
   </div>
   <div class="post" id="post-25711">
    <div class="subject"><a href="#post-25711">need help opening win386.swp</a></div>
    <div class="body">Thanks for your suggestion smallwaves, I tested and still get the sharing violation error.  I think maybe  rdaneel is right :(<br /><br />If anybody finds out different please let me know.<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-02-24 13:30:11 by czDrillard</div>
   </div>
   <div class="post" id="post-25720">
    <div class="subject"><a href="#post-25720">need help opening win386.swp</a></div>
    <div class="body">I also think you cannot access it because the only way defraggers can defrag it is to do it during the load phase on Windows, obviously before any locks are placed on it. But don't stop trying, not everything in the MS world is documented, and there may be a way to do it (but not well known).</div>
    <div class="meta">Posted on 2002-02-24 14:20:33 by sluggy</div>
   </div>
  </div>
 </body>
</html>