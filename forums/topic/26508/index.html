<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Var(Index)? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26508" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26508">Var(Index)?</a></p>
   <div class="post" id="post-191874">
    <div class="subject"><a href="#post-191874">Var(Index)?</a></div>
    <div class="body">cmp eax,1
je @@1
...
@@1:
Funtion,OFFSET var1
jmp endselect
@@2:
Funtion,OFFSET var2
jmp endselect
...
How can I replace # part with the current index
ex. Function,OFFSET var(index)?</div>
    <div class="meta">Posted on 2001-01-05 01:37:00 by Sooze</div>
   </div>
   <div class="post" id="post-191875">
    <div class="subject"><a href="#post-191875">Var(Index)?</a></div>
    <div class="body">Huh?</div>
    <div class="meta">Posted on 2001-01-05 02:42:00 by Ernie</div>
   </div>
   <div class="post" id="post-191876">
    <div class="subject"><a href="#post-191876">Var(Index)?</a></div>
    <div class="body">Is there a way to replace the var1,var2,var3.. with var(#)
(If the #=1 then the variable would be var1)? How would it be written for masm?</div>
    <div class="meta">Posted on 2001-01-05 03:03:00 by Sooze </div>
   </div>
   <div class="post" id="post-191877">
    <div class="subject"><a href="#post-191877">Var(Index)?</a></div>
    <div class="body">It would probably be easier and faster to use a lookup table.  Ie:

.data
  VariableTable  dd  offset var1, offset var2, ...

...
dec eax  ; Make it 0 based
mov eax,
mov Function,eax

That way, there's no need for all those checks.  Don't forget, if you do it this way, any gaps (like if you don't have a value 3 or 4 set), you have to omit them in your lookup table as well.</div>
    <div class="meta">Posted on 2001-01-05 03:24:00 by Racso </div>
   </div>
  </div>
 </body>
</html>