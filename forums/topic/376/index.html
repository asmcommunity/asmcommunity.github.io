<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Toolbars, how do you do... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=376" />
    <link rel="next" href="../?id=376&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=376">Toolbars, how do you do...</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=376&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=376&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="376" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=376&amp;page=2">&gt;</a><a href="../?id=376&amp;page=2">&raquo;</a></form>   <div class="post" id="post-2051">
    <div class="subject"><a href="#post-2051">Toolbars, how do you do...</a></div>
    <div class="body">Yes, I have a question. You see I have a Flat Style Toolbar inside a Rebar Control. I would like to &quot;imitate&quot; the Windows explorer style Menu (The top band of your Explorer Rebar), but I can only have ONE button width and ONE text string on the Toolbar. I have a TBBUTTON structure loaded without the string, and when the Toolbar is created (Using CreateToolbarEx) I point it to that Structure and i use TB_ADDSTRING message to add the string to the button. It all works fine, up and until i have more then ONE string that i would like in the Toolbar control. For example I would like a button with the &amp;File string and a set width for that button, and then another button in the control with the F&amp;avorites string on it and it should have its own width(diffrent from the &amp;File button). I have tried TBBUTTONONFO but looks like my Windows.inc does not have the Structure set out with its appropiate commands. I have Iczelion's latest edition of the include file. So is there ***ANYBODY*** that can help me!!!!!!<br /><br />reply here or E-M@il me <a href="mailto:Prozen@yahoo.com">Prozen@yahoo.com</a><br /><br />THANX</div>
    <div class="meta">Posted on 2001-07-26 05:51:00 by Black iCE</div>
   </div>
   <div class="post" id="post-2061">
    <div class="subject"><a href="#post-2061">Toolbars, how do you do...</a></div>
    <div class="body">Afternoon, Black Ice.<br /><br />Have you set 'TBSTYLE_AUTOSIZE' as a style for the TBButtons?<br /><br />Source: Current Platform SDK:<br /><div class="quote">Specifies that the toolbar control should not assign the standard width to the button. Instead, the button's width will be calculated based on the width of the text plus the image of the button. </div>:) <br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2001-07-26 08:39:29 by Scronty</div>
   </div>
   <div class="post" id="post-2120">
    <div class="subject"><a href="#post-2120">Toolbars, how do you do...</a></div>
    <div class="body">Thanx, i will try that!!</div>
    <div class="meta">Posted on 2001-07-27 04:15:46 by Black iCE</div>
   </div>
   <div class="post" id="post-2126">
    <div class="subject"><a href="#post-2126">Toolbars, how do you do...</a></div>
    <div class="body">How do you make a flat toolbar ?<br /><br />(s)</div>
    <div class="meta">Posted on 2001-07-27 05:08:45 by (scalp)</div>
   </div>
   <div class="post" id="post-2132">
    <div class="subject"><a href="#post-2132">Toolbars, how do you do...</a></div>
    <div class="body">Afternoon, (Scalp).<br /><br />Try the 'TBSTYLE_FLAT' style. <br />I haven't tried this myself, however the info was easy to find in the Help file under 'Toolbar Control and Button Styles'.:) <br /><br />Source: Current Platform SDK:<br /><div class="quote">Creates a flat toolbar. In a flat toolbar, both the toolbar and the buttons are transparent and hot-tracking is enabled. Button text appears under button bitmaps. To prevent repainting problems, this style should be set before the toolbar control becomes visible.</div><br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2001-07-27 05:58:37 by Scronty</div>
   </div>
   <div class="post" id="post-2438">
    <div class="subject"><a href="#post-2438">Toolbars, how do you do...</a></div>
    <div class="body">Hi, last time i posted i asked to how could i set a varied width for a toolbar. But now i would like to Know: Where would i find the &quot;back&quot;,&quot;forward&quot; &amp; &quot;up&quot; icons. Are there STD_XXXX constants. i would like to make my program compatable with windows9x,NT,ME,XP(Whistler). So my program will have the same icons from the system on any WOS(windows operating system) that has IE4 on it. :alright: <br /><br />Black iCE</div>
    <div class="meta">Posted on 2001-07-30 03:03:39 by Black iCE</div>
   </div>
   <div class="post" id="post-2444">
    <div class="subject"><a href="#post-2444">Toolbars, how do you do...</a></div>
    <div class="body">Afternoon, Black Ice.<br /><br />Use this to obtain explorer system-defined piccys:<br /><pre><code><br />.DATA<br /><br />HIST_BACK               EQU   0<br />HIST_FORWARD            EQU   1<br />HIST_FAVORITES          EQU   2<br />HIST_ADDTOFAVORITES     EQU   3<br />HIST_VIEWTREE           EQU   4<br /><br />IDB_HIST_SMALL_COLOR    EQU   8<br />IDB_HIST_LARGE_COLOR    EQU   9<br /><br />.CODE<br />    LOCAL Tba       &#58;TBADDBITMAP<br />        mov Tba.hInst, HINST_COMMCTRL<br />        mov Tba.nID, IDB_HIST_SMALL_COLOR<br />        invoke SendMessage,hToolBar,TB_ADDBITMAP,1,ADDR Tba<br /><br /></code></pre><br /><br />Then you can use these for choosing the bitmaps:<br /><br />HIST_ADDTOFAVORITES 	Add to favorites.	<br />HIST_BACK 	Move back.	<br />HIST_FAVORITES 	Open favorites folder.	<br />HIST_FORWARD 	Move forward.	<br />HIST_VIEWTREE 	View tree<br /><br />e.g.:<br /><pre><code><br />        mov tbb.iBitmap,   HIST_BACK<br />        mov tbb.idCommand, 51<br />        mov tbb.fsStyle,   TBSTYLE_BUTTON<br />        invoke SendMessage,hToolBar,TB_ADDBUTTONS,1,ADDR tbb<br /></code></pre><br /><br />These piccys are not very nice.<br />You may have to extract the nice ones from their '*.exe' or '*.dll' file. However, if this is done 'on the fly', your proggy won't work correctly on a PC which doesn't have the appropriate '*.exe' or '*.dll'.:mad: <br /><br />Or, you could take a screen shot with IE4 open, paste the piccy into a paint proggy, and cut out your own bitmaps.:alright: <br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2001-07-30 05:20:23 by Scronty</div>
   </div>
   <div class="post" id="post-2448">
    <div class="subject"><a href="#post-2448">Toolbars, how do you do...</a></div>
    <div class="body">A must have tool to acquire dialogs, icons, bmps and the like<br />from other programs on your machine is a freeware program<br />called Resource Hacker.<br /><br />Heres the link I used: <a target="_blank" href="http://rpi.net.au/~ajohnson/resourcehacker/">Resource Hacker download site.</a></div>
    <div class="meta">Posted on 2001-07-30 06:08:06 by bcraven</div>
   </div>
   <div class="post" id="post-2465">
    <div class="subject"><a href="#post-2465">Toolbars, how do you do...</a></div>
    <div class="body">BTW, I saw that Windows insert a separator in the first place of toolbar I've created. Does this happend to everybody ?<br />It's not a problem since there is a BUTTONDELETE fonction, but.... it's wierd !<br /><br />(s)</div>
    <div class="meta">Posted on 2001-07-30 09:15:46 by (scalp)</div>
   </div>
   <div class="post" id="post-2533">
    <div class="subject"><a href="#post-2533">Toolbars, how do you do...</a></div>
    <div class="body">:grin: <br />Scronty, Thanx.<br /><br />:confused: <br />I always have a question, u see i have made that menu toolbar but know i would like to know how does one go about to use the command identifyer of the button and display a menu(not dropdown) with a handle of HMENU. <br /><br />:rolleyes: <br />PS. Have anyone seen Windows XP's IU!!! Now that is a UI that i <br />like.</div>
    <div class="meta">Posted on 2001-07-31 02:31:07 by Black iCE</div>
   </div>
   <div class="post" id="post-3651">
    <div class="subject"><a href="#post-3651">Toolbars, how do you do...</a></div>
    <div class="body">Hi there everyone.<br /><br />I have used Resource Hacker (Thanx bcraven) to find the dll that seems to have all of those resources that i would like to include into my progg.(DLL: BROWSEUI.dll in your windows system directory, NT &amp; 9x). Now there are multipal toolbar buttons but i would like to use one in say one toolbar bitmap and another in a other toolbar bitmap. I have loaded the dll sucessfully into my progg by using the API LoadLibaryEx. <br /><br />So how would one go about and extract certain button bitmaps from the dll in runtime?<br /><br />PS. To  Scronty: Thanx for the help and right those icons do suc but those same icons are also stored inside the DLL i am speaking about, so why would Microsoft allow Developers get the stupid icons and store the cool ones inside the same dll? (Stupid according to me if we, the Developers, are premoting their os by desighning software for their Windows.):stupid:<br /><br />Black iCE :confused: <br /><br />Oh, i am still working on that HMENU question of mine....</div>
    <div class="meta">Posted on 2001-08-13 09:52:47 by Black iCE</div>
   </div>
   <div class="post" id="post-3671">
    <div class="subject"><a href="#post-3671">Toolbars, how do you do...</a></div>
    <div class="body"><div class="quote">PS. Have anyone seen Windows XP's IU!!! Now that is a UI that i <br />like.</div><br /><br />What do u find so good abt OfficeXP's interface? I dont find too much difference rather than the menus have become white instead of gray and it runs much slower:grin:</div>
    <div class="meta">Posted on 2001-08-13 14:52:05 by MovingFulcrum</div>
   </div>
   <div class="post" id="post-3682">
    <div class="subject"><a href="#post-3682">Toolbars, how do you do...</a></div>
    <div class="body">Afternoon, Black Ice.<br /><br />I'm unsure of your question.:grin: <br /><div class="quote">how does one go about to use the command identifyer of the button and display a menu(not dropdown) with a handle of HMENU.</div><br />Are you asking 'How to create a Pop-up Menu when a Tool-bar Button is pressed?' ?<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2001-08-13 17:56:46 by Scronty</div>
   </div>
   <div class="post" id="post-3713">
    <div class="subject"><a href="#post-3713">Toolbars, how do you do...</a></div>
    <div class="body">Scronty : Sorry for unclear question, and yes i would like to create a pop-up menu when a toolbar button is pressed.<br /><br />MovingFulcrum: no NOT OfficeXP but WindowsXP here is the link so check it out...<br /><br /><a target="_blank" href="http://www.microsoft.com/windowsxp/home/guide/smarter.asp">http://www.microsoft.com/windowsxp/home/guide/smarter.asp</a><br /><br />Anyway, does anyone know how to put text on the rebar!! like the text &quot;A&amp;ddress&quot;.</div>
    <div class="meta">Posted on 2001-08-14 02:44:53 by Black iCE</div>
   </div>
   <div class="post" id="post-3949">
    <div class="subject"><a href="#post-3949">Toolbars, how do you do...</a></div>
    <div class="body">These are the things i have quried about:<br /><br />1. Autosizing Toolbar       (Check: Thanx 2  Scronty)<br />2. Icons from Dll on System (Check: Just figured it out last night)<br />3. Menus from Toolbar button<br />4. Placing text onto a rebar band.<br /><br />If you can, just be kind and help me with 3 and 4. Check out my previous posts for more details...<br /><br />Black iCE:alright</div>
    <div class="meta">Posted on 2001-08-17 03:25:00 by Black iCE</div>
   </div>
   <div class="post" id="post-4198">
    <div class="subject"><a href="#post-4198">Toolbars, how do you do...</a></div>
    <div class="body">STILL, no one out there that can help me?! Ok, mabe if you could see my source code up to now then you guys can help me. (Pleez do not mind the commenting in source code, not ment to be posted here and no harm intended...only you know when that stupid Invoke returns ZERO in eax and GetLastError tells you there is no error while MSDN Library says if Invoke returns ZERO in eax an error occured.):confused: <br /><br />Now, if you look at my source code i would appreciate some help with the following. <br /><br />The Toolbar's buttons don't cover the whole width of Rebar Band as in Windows Interner Explorer or Windows Explorer.<br /><br />The LoadLibrary call and the creation of an image list...and the association of that list with the Toolbar(hShortcutToolbar) has gone funny. I can only create one imagelist but i need 3, one for default display -,one for HotItem display- and one for Disabled display of toolbar buttons. So any help is appreciated here... do with the code as you like as long as it will work in the end.<br /><br />The last band of the rebar should show &quot;A&amp;ddress&quot; but natrully is does not.<br /><br />Construction of Menus when &quot;&amp;File&quot; etc button is pressed. It should look like Windows Internet Explorer or Windows Explorer. If Microsoft could do it then it should be possible in ASSEMBLY!!!<br /><br />Thanx.<br />:alright:</div>
    <div class="meta">Posted on 2001-08-20 03:30:24 by Black iCE</div>
   </div>
   <div class="post" id="post-4679">
    <div class="subject"><a href="#post-4679">Update</a></div>
    <div class="body">Hi there... thanx to those of you who have downloded the previous source code. The source code here is updated, it now uses a popup-menu (does anyone know who to make a dropdown-menu here instead of a popup-menu).<br /><br />Refer to my previous post for details on coding problembs.<br /><br />Thanx:alright:</div>
    <div class="meta">Posted on 2001-08-24 03:26:27 by Black iCE</div>
   </div>
   <div class="post" id="post-4699">
    <div class="subject"><a href="#post-4699">Toolbars, how do you do...</a></div>
    <div class="body">Afternoon, Black Ice.<br /><br />Here's what I've got so far. It doesn't create a dropdown menu yet. I've zipped it with the &quot;rsrc.rc&quot; and &quot;Toolbar.bmp&quot;.<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2001-08-24 05:32:44 by Scronty</div>
   </div>
   <div class="post" id="post-5146">
    <div class="subject"><a href="#post-5146">Toolbars, how do you do...</a></div>
    <div class="body">Hi there  Scronty.<br /><br />I took a look at your code and i like the way it was structured and now  i am reformatting my source. Anyway what .lib do you have that has BTN_BUTTON and so on, mine does not have those constants. I am also writing Matric MOCKS so my programming may take a while but it will be done. Still working on that drop-down menu</div>
    <div class="meta">Posted on 2001-08-28 04:49:51 by Black iCE</div>
   </div>
   <div class="post" id="post-5217">
    <div class="subject"><a href="#post-5217">Toolbars, how do you do...</a></div>
    <div class="body">Afternoon, Black Ice.<br /><br />The constants in the 'windows.inc' file do not contain all of the constants available. They're a general set of the most commonly used constants/structures created by Icz and Hutch.<br /><br />The constants you're looking for are in the 'CommCtrl.h' file, in Micro$ofts' current Platform SDK. Just do a search for them, convert them, and then place them in your 'windows.inc' file. Make sure you're using the '*.lib's from the P/SDK. Remember; some of these constants can only be used if your version of 'Internet Explorer' is above v3, v4, v5, etc.<br /><br />Most of those constants had the old 'TBSYLE_' in front of them.<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2001-08-28 17:59:04 by Scronty</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=376&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=376&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="376" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=376&amp;page=2">&gt;</a><a href="../?id=376&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>