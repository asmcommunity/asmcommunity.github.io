<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Question About ListView.. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27320" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27320">Question About ListView..</a></p>
   <div class="post" id="post-195646">
    <div class="subject"><a href="#post-195646">Question About ListView..</a></div>
    <div class="body">Consider Two Window Exploers that same folder viewing Now..
If a file was delete by One Window Exploers,
Then Other Window Exploers Display The Result in a same time.

How Can ListView Control can display the result,
that one file was deleted by The Other Window Exploer..

It's What I want Understand..</div>
    <div class="meta">Posted on 2001-03-21 09:12:00 by takion1</div>
   </div>
   <div class="post" id="post-195647">
    <div class="subject"><a href="#post-195647">Question About ListView..</a></div>
    <div class="body">takion,

Actually, it's a bit easier than you thought.  Each time a file is deleted, renamed, moved, copied, or created, the Shell will post a message.  In the case of moving, you'll see two message, a delete and a create.  In the case of renaming, the same thing (I think)... these are basic messages.  There's a second way, where you can insert a VxD and watch what files are accessed and whatever, but that's not what you're asking.

To solve the problem you're asking about, the particular API is SHChangeNotify... then there are several messages which will notify you of what just happened.

Look for, SHChangeNotifyRegister, SHChangeNotifyDeregister, SHChangeNotify... then just look for the appropriate message.  As for using it with the listview, you'll have to program you're own code.

Doing it this way, is much easier than writing a VxD.  There is one called FileMon with source from SysInternals, but that is a much much more complicated route that goes well beyond what you're looking for.

If you just use the ShellNotify API's, you'll be okay.  I've done this before (in VB) and it works remarkably well.  You can even watch your network shares and stuff like that.

Thanks,
_Shawn


Update: Oh, I forgot, if you view the exports of Shell32.dll, you'll notice an extreme amount of unidentified exports... some documented, others not, SHChangeNotifyRegister (Ordinal 2 -- undocumented) and SHChangeNotifyDeregister (Ordinal 4 -- udocumented) won't be found anywhere in the MSDN archives... you'll find them on the Windows95 undocumented website...

Windows95 Undocumented

Have fun



This message was edited by Shawn Bullock, on 3/21/2001 11:08:29 AM</div>
    <div class="meta">Posted on 2001-03-21 09:48:00 by _Shawn</div>
   </div>
   <div class="post" id="post-195648">
    <div class="subject"><a href="#post-195648">Question About ListView..</a></div>
    <div class="body">thank you,_Shawn..
It is Great help to me..</div>
    <div class="meta">Posted on 2001-03-26 00:23:00 by takion1</div>
   </div>
  </div>
 </body>
</html>