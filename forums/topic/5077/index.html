<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Why would a call to CreateFile fail for a static vxd - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5077" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5077">Why would a call to CreateFile fail for a static vxd</a></p>
   <div class="post" id="post-35670">
    <div class="subject"><a href="#post-35670">Why would a call to CreateFile fail for a static vxd</a></div>
    <div class="body">All:<br /><br />I have a static VxD (which works create) that has been designed to listen for DeviceIoControls (among other things) and when I go to make a call to CreateFile, so that an applicaiton can get a handle to this device, the call always failes with ERROR_FILE_NOT_FOUND.<br /><br />This VxD runs great during windows boot but I just can not seem to get my act together today and create an application that can communicat with this static VxD.<br /><br />Here is the little code snippet that I am using from within the application:<br /><br /><pre><code><br />.DATA<br />VxDName     db &quot;\\.\myvxd.vxd&quot;,0 <br />...<br />.DATA?<br /><br />hVxD        dd ?<br /><br />.CODE<br />start&#58;<br />    <br />    call CreateFile, offset VxDName,0,FILE_SHARE_READ,0,OPEN_EXISTING,0,0<br />...<br /></code></pre> <br /><br />Any insite on why WindowME tells me that it can not find the file, when it is both in the Windows\System directory and the current directory of the App would be greatly appreciated as it's the end of the day and I am not thinking clearly.<br /><br />Thanks;</div>
    <div class="meta">Posted on 2002-04-29 19:48:01 by madprgmr</div>
   </div>
  </div>
 </body>
</html>