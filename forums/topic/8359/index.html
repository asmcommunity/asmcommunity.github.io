<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>[RichEdit] select word and formatting some text - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8359" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=8359">[RichEdit] select word and formatting some text</a></p>
   <div class="post" id="post-61047">
    <div class="subject"><a href="#post-61047">[RichEdit] select word and formatting some text</a></div>
    <div class="body">hello there,<br /><br />i am trying to convert a program in assembler <br /><a target="_blank" href="http://www.rohanpall.com/pub/mindweb/1.0/mindweb.zip">MindWeb</a> 900k<br /><br />it is something like hypertext help interfaces (eg. spASM AsmTut, old Norton Guide).<br /><br />so i use RichEdit control for text (simple edit text doesnt support custom text only for whole<br />textarea). after playing i managed to recognize URLs (EM_AUTOURLDETECT &amp; EN_LINK<br />nightmare) and now i am trying to get the text when the user press mouse button.<br /><br />the ideea is something like this:<br />1. user type text<br />2. user click on text<br />3. if text is enclosed in [] then open filename with the name from the brackets<br />eg:  opens &quot;this is a file.txt&quot;<br />4. right click - opens previous file<br /><br />i'm stuck on part 3 - getting the text and parsing for []. i cannot get the text with<br />EM_CHARFROMPOS. <br /><br />any help on this ?<br /><br />thanks ...</div>
    <div class="meta">Posted on 2002-10-09 08:08:13 by TBD</div>
   </div>
   <div class="post" id="post-61048">
    <div class="subject"><a href="#post-61048">[RichEdit] select word and formatting some text</a></div>
    <div class="body">Hi TBD<br /><br />1. Do a backwards search for '[' and save the position. (EM_FINDTEXTEX)<br />2. Do a forwards search for ']' and save position. (EM_FINDTEXTEX)<br />3. Set selection. (EM_EXSETSEL)<br />4. Get the text in beetween. (EM_GETSELTEXT)<br /><br />KetilO</div>
    <div class="meta">Posted on 2002-10-09 08:25:46 by KetilO</div>
   </div>
   <div class="post" id="post-61049">
    <div class="subject"><a href="#post-61049">[RichEdit] select word and formatting some text</a></div>
    <div class="body">thanks KetilO,<br /><br />but how can i get the position in the text from mouse (WM_LBUTTONDOWN) ?<br />on EM_CHARFROMPOS, 0, lParam it GPFs</div>
    <div class="meta">Posted on 2002-10-09 08:33:56 by TBD</div>
   </div>
   <div class="post" id="post-61053">
    <div class="subject"><a href="#post-61053">[RichEdit] select word and formatting some text</a></div>
    <div class="body">hi...<br /><br />please look <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=3723&amp;highlight=link+editbox">here</a> <br /><br />okay this isn't richedit but it should point you in the right direction. the example in the last<br />post shows how to parse text in a normal edit box and extend it's functionality (make it<br />able to recognize full working links)</div>
    <div class="meta">Posted on 2002-10-09 09:30:10 by mob</div>
   </div>
   <div class="post" id="post-61054">
    <div class="subject"><a href="#post-61054">[RichEdit] select word and formatting some text</a></div>
    <div class="body">Hi TBD<br /><br />EM_CHARFROMPOS in a richedit wants a pointer to a POINT struct.<br /><br />When user left click the caret should be on the word.<br />Try using EM_EXGETSEL.<br /><br />KetilO</div>
    <div class="meta">Posted on 2002-10-09 09:33:05 by KetilO</div>
   </div>
  </div>
 </body>
</html>