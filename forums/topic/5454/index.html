<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Scroll bars - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5454" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5454">Scroll bars</a></p>
   <div class="post" id="post-38748">
    <div class="subject"><a href="#post-38748">Scroll bars</a></div>
    <div class="body">Sorry folks, I would answer this myself but I am away from my development machine.<br /><br />Scrollbars are strange creatures.  Acoording to M$, they are both a 16 and 32 bit control.  Well I was driving home and a thought struck me.  The WM_HSCROLL and WM_VSCROLL are 16 bit messages.  So if I set the control to a large 32 bit range and then started scrolling via the thumb tack, what happens?  Does the value simply wrap around or will it just stop 1/2 way through the scrolling process?</div>
    <div class="meta">Posted on 2002-05-17 18:31:03 by Graebel</div>
   </div>
   <div class="post" id="post-38749">
    <div class="subject"><a href="#post-38749">Scroll bars</a></div>
    <div class="body"><div class="quote">Note that the WM_HSCROLL message carries only 16 bits of scroll box position data. Thus, applications that rely solely on WM_HSCROLL (and WM_VSCROLL) for <u>scroll position data have a practical maximum position value of 65,535</u>.<br /><br />However, because the SetScrollInfo, SetScrollPos, SetScrollRange, GetScrollInfo, GetScrollPos, and GetScrollRange functions support 32-bit scroll bar position data, there is a way to circumvent the 16-bit barrier of the WM_HSCROLL and WM_VSCROLL messages. See GetScrollInfo for a description of the technique.</div><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/winui/scrolbar_52b3.asp">GetScrollInfo</a><br /><br />This is one of the places we see signs of Windows' old age. :)</div>
    <div class="meta">Posted on 2002-05-17 19:02:59 by bitRAKE</div>
   </div>
   <div class="post" id="post-38754">
    <div class="subject"><a href="#post-38754">Scroll bars</a></div>
    <div class="body">Yes bitRAKE, thats exacly the quote I was think of when this idea crossed my mind.  However if I remember correctly, GetScrollInfo cannot be used during mouse tracking of the thumb tack.  Only before the tracking starts or after.  Nice idea however.  I am still trying to find a way to curcumvent this without going to all the trouble of writing my own freaking scroll bar control :rolleyes:</div>
    <div class="meta">Posted on 2002-05-17 20:04:48 by Graebel</div>
   </div>
   <div class="post" id="post-38766">
    <div class="subject"><a href="#post-38766">From MSDN</a></div>
    <div class="body">Saw this on MSDN about a week ago.. might help you out. It's near the bottom of the following link<br /><br />Link is: <a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/scrolbar_52b3.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/scrolbar_52b3.asp</a><br /><br />Quote is:<br /><br /><div class="quote"><br />To get the 32-bit position of the scroll box (thumb) during a SB_THUMBTRACK request code in a WM_HSCROLL or WM_VSCROLL message, call GetScrollInfo with the SIF_TRACKPOS value in the fMask member of the SCROLLINFO structure. The function returns the tracking position of the scroll box in the nTrackPos member of the SCROLLINFO structure. This allows you to get the position of the scroll box as the user moves it. The following sample code illustrates the technique.<br />--deleted--<br /></div></div>
    <div class="meta">Posted on 2002-05-18 00:15:12 by chorus</div>
   </div>
  </div>
 </body>
</html>