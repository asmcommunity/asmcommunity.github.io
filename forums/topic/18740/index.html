<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Remove directory ? How ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18740" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18740">Remove directory ? How ?</a></p>
   <div class="post" id="post-145141">
    <div class="subject"><a href="#post-145141">Remove directory ? How ?</a></div>
    <div class="body">Hi all,<br />My question is: can i remove directory and all files and subdirectories in it by one step. Are there any api function or other way to make it.<br /><br />P.S.<br />For me this is the best forum in all over th world</div>
    <div class="meta">Posted on 2004-06-30 08:00:32 by martidim</div>
   </div>
   <div class="post" id="post-145144">
    <div class="subject"><a href="#post-145144">Remove directory ? How ?</a></div>
    <div class="body">You can do it in 2 steps, first remove all the files using SHFileOperation then remove the directory..<br /><br /><pre><code>mov eax,hDlg<br />mov sfo.hwnd,eax<br />mov sfo.wFunc,FO_DELETE<br />mov sfo.pFrom,OFFSET Files<br />mov sfo.pTo,NULL<br />mov sfo.fFlags,FOF_NOERRORUI or FOF_SILENT or FOF_ALLOWUNDO<br />lea eax,sfoabort<br />mov sfo.fAnyOperationsAborted,eax<br />lea eax,szRemProject<br />mov sfo.lpszProgressTitle,eax<br />mov sfo.hNameMappings,NULL<br />invoke SHFileOperation,ADDR sfo<br /><br />invoke RemoveDirectory,OFFSET RootPath</code></pre><br /><br />Files would be a wild card path such as C:TargetDir*.*<br /><br />RootPath is the folder to remove ie: C:TargetDir</div>
    <div class="meta">Posted on 2004-06-30 09:52:03 by donkey</div>
   </div>
   <div class="post" id="post-145251">
    <div class="subject"><a href="#post-145251">Remove directory ? How ?</a></div>
    <div class="body">I see you are from bulgaria too. Nice to see other people from BG here ...<br /><br />What include is needed to  invoke SHFileOperation ? <br /><br />in win32.hlp is writen shellapi.h</div>
    <div class="meta">Posted on 2004-07-01 23:04:59 by Gangleri</div>
   </div>
   <div class="post" id="post-145260">
    <div class="subject"><a href="#post-145260">Remove directory ? How ?</a></div>
    <div class="body">I use GoAsm, we don't use import libraries but I think it is in Shell32.lib &amp; Shell32.inc</div>
    <div class="meta">Posted on 2004-07-02 00:58:19 by donkey</div>
   </div>
  </div>
 </body>
</html>