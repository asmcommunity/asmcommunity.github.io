<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>a strange problem about GetProcAddress in Win98 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13005" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=13005">a strange problem about GetProcAddress in Win98</a></p>
   <div class="post" id="post-101052">
    <div class="subject"><a href="#post-101052">a strange problem about GetProcAddress in Win98</a></div>
    <div class="body">in 98,I use GetProcAddress to get the address of CloseHandle, but always get the address of FindCloseChangeNotification.<br />in XP,it's Ok.<br />why???anybody can help me?</div>
    <div class="meta">Posted on 2003-05-04 04:55:48 by dyna</div>
   </div>
   <div class="post" id="post-101057">
    <div class="subject"><a href="#post-101057">a strange problem about GetProcAddress in Win98</a></div>
    <div class="body">How do you know you get the address of FindCloseChangeNotification? API functions can change address between different versions of Windoze, MS will *try* not to do it, but if they do then they are not necessarily going to tell everyone about it. Due to the wonders of load time relocating and fixing-up, if MS do change the position of a function then the change will be totally transparent to your app.<br /><br />If you are using LoadLibrary or GetModuleHandle and GetProcAddress correctly, then the address being returned will be correct. Make sure you are supplying the correct module handle, and you are passing the correct string for the function name.</div>
    <div class="meta">Posted on 2003-05-04 06:12:31 by sluggy</div>
   </div>
   <div class="post" id="post-101074">
    <div class="subject"><a href="#post-101074">a strange problem about GetProcAddress in Win98</a></div>
    <div class="body">Thank you. but i think i did the right way, because when i used GetProcAddress to get <br />other API address in 98, the result is right.<br />Also, i used PEditor to open the kernel32.dll to confirm, it's right.<br /><br />strange,isn't it?</div>
    <div class="meta">Posted on 2003-05-04 09:11:36 by dyna</div>
   </div>
   <div class="post" id="post-101077">
    <div class="subject"><a href="#post-101077">a strange problem about GetProcAddress in Win98</a></div>
    <div class="body">I suppose it would be better that you post some codes to show us how you use GetProcAddress.</div>
    <div class="meta">Posted on 2003-05-04 09:24:44 by roticv</div>
   </div>
   <div class="post" id="post-101082">
    <div class="subject"><a href="#post-101082">a strange problem about GetProcAddress in Win98</a></div>
    <div class="body">CloseHandle and FindCloseChangeNotification are actually the same on 98, so nothing to worry about here ;)</div>
    <div class="meta">Posted on 2003-05-04 10:12:48 by Tola</div>
   </div>
   <div class="post" id="post-101324">
    <div class="subject"><a href="#post-101324">a strange problem about GetProcAddress in Win98</a></div>
    <div class="body">yes, i get it.<br />thank u very much.</div>
    <div class="meta">Posted on 2003-05-05 13:53:09 by dyna</div>
   </div>
  </div>
 </body>
</html>