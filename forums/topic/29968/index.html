<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>No convert from C++ code :-) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29968" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=29968">No convert from C++ code :-)</a></p>
   <div class="post" id="post-211573">
    <div class="subject"><a href="#post-211573">No convert from C++ code :-)</a></div>
    <div class="body">Ragdog gave me this code.<br />He says it works on his system, but it doesn&#039;t on mine.<br /><br />I get ERROR_RESOURCE_DATA_NOT_FOUND.<br /><br />Can someone PLEASE help with this?<br /><br /><pre><code><br />; With USB stick in F: drive...<br />; ERROR_RESOURCE_DATA_NOT_FOUND<br />; 1812 (0x714)<br />;<br />; from ragdog<br />;<br />.386<br />.model flat, stdcall &nbsp;;32 bit memory model<br />option casemap :none &nbsp;;case sensitive<br /><br />include DlgMain.inc<br /><br />.code<br /><br />start:<br /><br /> &nbsp; &nbsp;invoke GetModuleHandle,NULL<br /> &nbsp; &nbsp;mov hInstance,eax<br /> &nbsp; &nbsp;invoke InitCommonControls<br /><br /><br />invoke DialogBoxParam,hInstance,IDD_DIALOG,NULL,addr DlgProc,NULL<br />invoke ExitProcess,0<br /><br />DlgProc proc hWnd:HWND,uMsg:UINT,wParam:WPARAM,lParam:LPARAM<br /><br />.if uMsg==WM_INITDIALOG<br /><br /> &nbsp; &nbsp; &nbsp; &nbsp;.elseif &nbsp; &nbsp;uMsg == &nbsp; WM_DEVICECHANGE <br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov &nbsp; &nbsp;eax,wParam<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.if &nbsp; &nbsp;eax == DBT_DEVICEARRIVAL<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov &nbsp;eax,lParam<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; assume eax:ptr _DEV_BROADCAST_HDR<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov &nbsp;eax,.dbch_devicetype<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; assume eax:nothing<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .if &nbsp;eax == DBT_DEVTYP_VOLUME<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov eax,lParam<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;assume eax:ptr _DEV_BROADCAST_VOLUME<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov edx,.dbcv_unitmask<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;mov ecx,.dbcv_flags<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;xor ebx,ebx<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.while ebx&lt;26<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov ecx,edx<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;and edx,01h<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.if edx==1<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov cx,word ptr .dbcv_flags<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.if cx == 00h ;(subst net use)<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;add ebx,65d<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;invoke CheckUsbDisk,ebx<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.endif<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.break<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.else<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov edx,ecx<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;shr edx,1<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.endif<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;inc ebx<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.endw<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;assume eax:nothing &nbsp; &nbsp; &nbsp; <br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .endif<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.endif &nbsp; &nbsp; &nbsp; <br /> <br />.elseif uMsg==WM_COMMAND<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.if wParam==9000<br /> &nbsp; &nbsp; &nbsp; <br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.endif<br /> &nbsp; &nbsp; <br />.elseif uMsg==WM_CLOSE<br /><br />invoke EndDialog,hWnd,0<br />.else<br />mov eax,FALSE<br />ret<br />.endif<br />mov eax,TRUE<br />ret<br /><br />DlgProc endp<br /><br />CheckUsbDisk &nbsp; &nbsp; &nbsp; &nbsp;proc uses ebx esi edi disk:dword<br /> &nbsp; &nbsp;LOCAL &nbsp; buffer[128]:byte<br /> &nbsp; &nbsp;LOCAL &nbsp; hDisk:dword<br /> &nbsp; &nbsp;LOCAL &nbsp; notuse:dword<br /> &nbsp; &nbsp;LOCAL &nbsp; Query:STORAGE_PROPERTY_QUERY<br /> &nbsp; &nbsp;LOCAL &nbsp; DevDesc:STORAGE_DEVICE_DESCRIPTOR<br /><br />; from .data<br />;disk3 &nbsp; db &#039;\\.\&#039;,0<br />;mao &nbsp; &nbsp; db &#039;:&#039;,0<br /><br /><br /> &nbsp; invoke &nbsp; lstrcpy,addr buffer,offset disk3 &nbsp; ;buffer=\\.\<br /> &nbsp; invoke &nbsp; lstrcat,addr buffer,addr &nbsp; disk &nbsp; &nbsp;;buffer=\\.\X<br /> &nbsp; invoke &nbsp; lstrcat,addr buffer,offset mao &nbsp; &nbsp; ;buffer=\\.\X:<br /> &nbsp; invoke &nbsp; CreateFile,addr buffer, NULL, NULL,NULL, OPEN_EXISTING, NULL,NULL<br /> &nbsp; mov &nbsp; &nbsp; &nbsp;hDisk,eax<br /> &nbsp; .if eax !=INVALID_HANDLE_VALUE<br /> &nbsp; &nbsp; &nbsp; &nbsp;mov Query.PropertyId,StorageDeviceProperty &nbsp; <br /> &nbsp; &nbsp; &nbsp; &nbsp;mov Query.QueryType,PropertyStandardQuery<br /> &nbsp; &nbsp; &nbsp; &nbsp;invoke &nbsp; DeviceIoControl,hDisk,IOCTL_STORAGE_QUERY_PROPERTY,addr Query, sizeof STORAGE_PROPERTY_QUERY,addr DevDesc,sizeof STORAGE_DEVICE_DESCRIPTOR,addr notuse, NULL<br /> &nbsp; &nbsp; &nbsp; &nbsp;.if eax != NULL<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mov eax,[ DevDesc.BusType]<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.if eax == BusTypeUsb<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;invoke &nbsp;lstrcpy,addr buffer,addr disk &nbsp;;buffer=X<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;invoke &nbsp;lstrcat,addr buffer,offset mao ;buffer=X:<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;invoke &nbsp; &nbsp; &nbsp; &nbsp;GetDriveType,addr buffer<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.if eax != DRIVE_REMOVABLE<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;invoke &nbsp;MessageBox,0,addr buffer,addr buffer,MB_OK<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.endif<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.endif &nbsp; &nbsp; &nbsp; <br /> &nbsp; &nbsp; &nbsp; &nbsp;.endif &nbsp; &nbsp; <br /> &nbsp; .endif &nbsp; &nbsp; <br /> &nbsp; invoke &nbsp; CloseHandle,hDisk<br /> &nbsp; &nbsp;ret<br />CheckUsbDisk &nbsp; &nbsp; &nbsp; &nbsp;endp<br />end start<br /><br /><br />And the .inc file.<br /><br />Code:<br />; dlgmain.inc From ragdog<br />;<br />include \masm32\include\windows.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\Comctl32.inc<br />include \masm32\include\shell32.inc<br />INCLUDE \masm32\include\gdi32.inc<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\Comctl32.lib<br />includelib \masm32\lib\shell32.lib<br />includelib \masm32\lib\gdi32.lib<br />include \masm32\macros\macros.asm<br /><br />CTEXT MACRO text:VARARG<br /> &nbsp; &nbsp; &nbsp; local TxtName<br /> &nbsp; &nbsp; &nbsp; &nbsp; .data<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TxtName BYTE text,0<br /> &nbsp; &nbsp; &nbsp; &nbsp; .code<br /> &nbsp; &nbsp; &nbsp; EXITM &lt;offset TxtName&gt;<br />ENDM<br /><br />CTL_CODE MACRO DeviceType:=&lt;0&gt;, Function:=&lt;0&gt;, Method:=&lt;0&gt;, Access:=&lt;0&gt;<br /> &nbsp; &nbsp; &nbsp; &nbsp;EXITM %(((DeviceType) SHL 16) OR ((Access) SHL 14) OR ((Function) SHL 2) OR (Method))<br />ENDM<br /><br />DlgProc PROTO :HWND,:UINT,:WPARAM,:LPARAM<br />CheckUsbDisk &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; proto :dword<br /><br />.const<br /><br />IDD_DIALOG &nbsp; &nbsp;equ 1000<br /><br />DBT_DEVICEARRIVAL &nbsp;equ 8000h<br />DBT_DEVTYP_VOLUME &nbsp;equ 02h<br /><br />_DEV_BROADCAST_HDR struct<br />dbch_size &nbsp; &nbsp; &nbsp; dd ?<br />dbch_devicetype dd ?<br />dbch_reserved &nbsp; dd ?<br />_DEV_BROADCAST_HDR ends &nbsp; <br /><br />_DEV_BROADCAST_VOLUME struct<br />dbcv_size &nbsp; &nbsp; &nbsp; dd ?<br />dbcv_devicetype dd ?<br />dbcv_reserved &nbsp; dd ?<br />dbcv_unitmask &nbsp; dd ?<br />dbcv_flags &nbsp; &nbsp; &nbsp;dw ?<br />_DEV_BROADCAST_VOLUME ends<br /><br />DBTF_MEDIA &nbsp; &nbsp; &nbsp;equ 01h<br />DBTF_NET &nbsp; &nbsp; &nbsp; &nbsp;equ 02h ;subst<br /><br />FILE_ANY_ACCESS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;equ 0<br />METHOD_BUFFERED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;equ 0<br />FILE_DEVICE_MASS_STORAGE &nbsp; &nbsp; equ 2dh ;from ntddk.inc<br />IOCTL_STORAGE_BASE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equ FILE_DEVICE_MASS_STORAGE ;from ntddstor.inc<br />IOCTL_STORAGE_QUERY_PROPERTY equ CTL_CODE(IOCTL_STORAGE_BASE, 500h, METHOD_BUFFERED, FILE_ANY_ACCESS)<br /><br />BusTypeUsb equ 7<br /><br />StorageDeviceProperty equ 0<br />PropertyStandardQuery equ 0<br /><br />STORAGE_PROPERTY_QUERY struct<br />PropertyId &nbsp; &nbsp; dd ? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;<br />QueryType &nbsp; &nbsp; &nbsp;dd ? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;<br />AdditionalParameters dd ? &nbsp; &nbsp; &nbsp; ;<br />STORAGE_PROPERTY_QUERY ends<br /><br />STORAGE_DEVICE_DESCRIPTOR struct<br />Version &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd ? &nbsp; &nbsp; &nbsp; <br />theSize &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd ? &nbsp; &nbsp; &nbsp; <br />DeviceType &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db ? &nbsp; &nbsp; &nbsp; <br />DeviceTypeModifier &nbsp; &nbsp; &nbsp;db ? &nbsp; &nbsp; &nbsp; &nbsp;; SCSI-2<br />RemovableMedia &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db ? &nbsp; &nbsp; &nbsp; <br />CommandQueueing &nbsp; &nbsp; &nbsp; &nbsp; db ? &nbsp; &nbsp; &nbsp; <br />VendorIdOffset &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dd ? &nbsp; &nbsp; &nbsp; <br />ProductIdOffset &nbsp; &nbsp; &nbsp; &nbsp; dd ? &nbsp; &nbsp; &nbsp; <br />ProductRevisionOffset &nbsp; dd ? &nbsp; <br />SerialNumberOffset &nbsp; &nbsp; &nbsp;dd ? &nbsp; <br />BusType &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd ? &nbsp; <br />RawPropertiesLength &nbsp; &nbsp; dd ? &nbsp; <br />RawDeviceProperties &nbsp; &nbsp; dd ? &nbsp; <br />STORAGE_DEVICE_DESCRIPTOR ends<br /><br />.data<br />disk3 &nbsp; db &#039;\\.\&#039;,0<br />mao &nbsp; &nbsp; db &#039;:&#039;,0<br />.data?<br />hInstance dd ?<br /><br />; dlgmain.inc From ragdog<br />;<br />include \masm32\include\windows.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\Comctl32.inc<br />include \masm32\include\shell32.inc<br />INCLUDE \masm32\include\gdi32.inc<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\Comctl32.lib<br />includelib \masm32\lib\shell32.lib<br />includelib \masm32\lib\gdi32.lib<br />include \masm32\macros\macros.asm<br /><br />CTEXT MACRO text:VARARG<br /> &nbsp; &nbsp; &nbsp; local TxtName<br /> &nbsp; &nbsp; &nbsp; &nbsp; .data<br /> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;TxtName BYTE text,0<br /> &nbsp; &nbsp; &nbsp; &nbsp; .code<br /> &nbsp; &nbsp; &nbsp; EXITM &lt;offset TxtName&gt;<br />ENDM<br /><br />CTL_CODE MACRO DeviceType:=&lt;0&gt;, Function:=&lt;0&gt;, Method:=&lt;0&gt;, Access:=&lt;0&gt;<br /> &nbsp; &nbsp; &nbsp; &nbsp;EXITM %(((DeviceType) SHL 16) OR ((Access) SHL 14) OR ((Function) SHL 2) OR (Method))<br />ENDM<br />CTL_CODE MACRO DeviceType:=&lt;0&gt;, Function:=&lt;0&gt;, Method:=&lt;0&gt;, Access:=&lt;0&gt;<br /> &nbsp; &nbsp; &nbsp; &nbsp;EXITM %(((DeviceType) SHL 16) OR ((Access) SHL 14) OR ((Function) SHL 2) OR (Method))<br />ENDM<br /><br />DlgProc PROTO :HWND,:UINT,:WPARAM,:LPARAM<br />CheckUsbDisk &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; proto :dword<br /><br />.const<br /><br />IDD_DIALOG &nbsp; &nbsp;equ 1000<br /><br />DBT_DEVICEARRIVAL &nbsp;equ 8000h<br />DBT_DEVTYP_VOLUME &nbsp;equ 02h<br /><br />_DEV_BROADCAST_HDR struct<br />dbch_size &nbsp; &nbsp; &nbsp; dd ?<br />dbch_devicetype dd ?<br />dbch_reserved &nbsp; dd ?<br />_DEV_BROADCAST_HDR ends &nbsp; <br /><br />_DEV_BROADCAST_VOLUME struct<br />dbcv_size &nbsp; &nbsp; &nbsp; dd ?<br />dbcv_devicetype dd ?<br />dbcv_reserved &nbsp; dd ?<br />dbcv_unitmask &nbsp; dd ?<br />dbcv_flags &nbsp; &nbsp; &nbsp;dw ?<br />_DEV_BROADCAST_VOLUME ends<br /><br />DBTF_MEDIA &nbsp; &nbsp; &nbsp;equ 01h<br />DBTF_NET &nbsp; &nbsp; &nbsp; &nbsp;equ 02h ;subst<br /><br />FILE_ANY_ACCESS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;equ 0<br />METHOD_BUFFERED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;equ 0<br />FILE_DEVICE_MASS_STORAGE &nbsp; &nbsp; equ 2dh ;from ntddk.inc<br />IOCTL_STORAGE_BASE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equ FILE_DEVICE_MASS_STORAGE ;from ntddstor.inc<br />IOCTL_STORAGE_QUERY_PROPERTY equ CTL_CODE(IOCTL_STORAGE_BASE, 500h, METHOD_BUFFERED, FILE_ANY_ACCESS)<br /><br />BusTypeUsb equ 7<br /><br />StorageDeviceProperty equ 0<br />PropertyStandardQuery equ 0<br /><br />STORAGE_PROPERTY_QUERY struct<br />PropertyId &nbsp; &nbsp; dd ? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;<br />QueryType &nbsp; &nbsp; &nbsp;dd ? &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;<br />AdditionalParameters dd ? &nbsp; &nbsp; &nbsp; ;<br />STORAGE_PROPERTY_QUERY ends<br /><br />STORAGE_DEVICE_DESCRIPTOR struct<br />Version &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd ? &nbsp; &nbsp; &nbsp; <br />theSize &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd ? &nbsp; &nbsp; &nbsp; <br />DeviceType &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db ? &nbsp; &nbsp; &nbsp; <br />DeviceTypeModifier &nbsp; &nbsp; &nbsp;db ? &nbsp; &nbsp; &nbsp; &nbsp;; SCSI-2<br />RemovableMedia &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db ? &nbsp; &nbsp; &nbsp; <br />CommandQueueing &nbsp; &nbsp; &nbsp; &nbsp; db ? &nbsp; &nbsp; &nbsp; <br />VendorIdOffset &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dd ? &nbsp; &nbsp; &nbsp; <br />ProductIdOffset &nbsp; &nbsp; &nbsp; &nbsp; dd ? &nbsp; &nbsp; &nbsp; <br />ProductRevisionOffset &nbsp; dd ? &nbsp; <br />SerialNumberOffset &nbsp; &nbsp; &nbsp;dd ? &nbsp; <br />BusType &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd ? &nbsp; <br />RawPropertiesLength &nbsp; &nbsp; dd ? &nbsp; <br />RawDeviceProperties &nbsp; &nbsp; dd ? &nbsp; <br />STORAGE_DEVICE_DESCRIPTOR ends<br /><br />.data<br />disk3 &nbsp; db &#039;\\.\&#039;,0<br />mao &nbsp; &nbsp; db &#039;:&#039;,0<br />.data?<br />hInstance dd ?<br /></code></pre><br /><br /><span style="font-size:8pt><em>Edit by SpooK: Added code block.</em></span></div>
    <div class="meta">Posted on 2010-05-04 18:55:11 by skywalker</div>
   </div>
   <div class="post" id="post-211574">
    <div class="subject"><a href="#post-211574">Re: No convert from C++ code :-)</a></div>
    <div class="body"><pre><code>Error name:<br />&nbsp; &nbsp; ERROR_RESOURCE_DATA_NOT_FOUND<br /><br />Error value:<br />&nbsp; &nbsp; 0x00000714 (1812)<br /><br />Description:<br />&nbsp; &nbsp; The specified image file did not contain a resource section.</code></pre><br /><br />Did you create a dialog box, compile the .rc and link the .res file to your app?&nbsp; Sounds like you didn&#039;t, try doing that and it should work.</div>
    <div class="meta">Posted on 2010-05-04 19:29:00 by Gunner</div>
   </div>
   <div class="post" id="post-211575">
    <div class="subject"><a href="#post-211575">Re: No convert from C++ code :-)</a></div>
    <div class="body"><div class="quote"><br /><pre><code>Error name:<br />&nbsp; &nbsp; ERROR_RESOURCE_DATA_NOT_FOUND<br /><br />Error value:<br />&nbsp; &nbsp; 0x00000714 (1812)<br /><br />Description:<br />&nbsp; &nbsp; The specified image file did not contain a resource section.</code></pre><br /><br />Did you create a dialog box, compile the .rc and link the .res file to your app?&nbsp; Sounds like you didn&#039;t, try doing that and it should work.<br /></div><br /><br />I don&#039;t know what a dialog box is.<br /><br />I used the code I was given.<br /><br />I did not get any error message during assembly, so I honestly don&#039;t know what to do next.<br /><br />Thanks,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Andy</div>
    <div class="meta">Posted on 2010-05-04 20:35:51 by skywalker</div>
   </div>
   <div class="post" id="post-211577">
    <div class="subject"><a href="#post-211577">Re: No convert from C++ code :-)</a></div>
    <div class="body">There should be a .RC file containing a list of &#039;resources&#039; to be embedded in the exe.<br />Resources are just some kind of data (from a file or otherwise) embedded in your app.<br />Resources can be absolutely anything that your exe needs.<br />You don&#039;t NEED to use resources - theres always another way - but this source is using resources.<br /></div>
    <div class="meta">Posted on 2010-05-04 23:18:16 by Homer</div>
   </div>
  </div>
 </body>
</html>