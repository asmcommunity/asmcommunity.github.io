<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>problems with directSound - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7872" />
  <link rel="prev" href="../?id=7872&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=7872">problems with directSound</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=7872&amp;page=1" style="">&laquo;</a><a href="../?id=7872&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="7872" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-61002">
    <div class="subject"><a href="#post-61002">problems with directSound</a></div>
    <div class="body">OK. Here's a little source from my CB101:<br /><br />;-----------------<br />	mov ecx,0<br />	mov ebx,offset Wave7<br />	.while ecx&lt;2048<br />	mov shit2,ecx<br />	fild shit2<br />	mov shit2,2048<br />	fidiv shit2<br />	mov shit2,20000<br />	fimul shit2<br />	mov eax,ecx<br />	fst real4 ptr<br />	mov eax,4096<br />	sub eax,ecx<br />	fst real4 ptr<br />	fchs<br />	mov eax,4096<br />	add eax,ecx<br />	fst real4 ptr<br />	mov eax,8192<br />	sub eax,ecx<br />	fstp real4 ptr<br />	inc ecx<br />	.endw<br />	mov shit2,20000<br />	fild shit2<br />	mov ecx,2048<br />	fstp real4 ptr<br />	mov shit2,-20000<br />	fild shit2<br />	mov ecx,6144<br />	fstp real4 ptr<br /><br /><br /><br />;-------[ Sine wave ]---------<br />	mov ecx,0<br />	mov ebx,offset Wave5<br />	fldpi<br />	mov shit2,4096<br />	fidiv shit2<br />	.while ecx&lt;8192<br />	;out<em>=20000 * sin(2*3.14/8192 * i)<br />	mov shit2,ecx<br />	fld ST(0)<br />	fimul shit2<br />	fsin<br />	mov shit2,20000<br />	fimul shit2<br />	fstp real4 ptr<br />	inc ecx<br />	.endw<br />	fstp shit2<br />	<br />;-------[ Saw wave ]-----------<br />	mov ecx,0<br />	mov ebx,offset Wave6<br />	.while ecx&lt;8192<br />	mov eax,ecx<br />	sub eax,4096<br />	neg eax<br />	shl eax,2<br />	mov shit2,eax<br />	fild shit2<br />	fstp real4 ptr<br />	inc ecx<br />	.endw<br />	<br /><br /><br />These are very simple forumas to do the waves, and they lean on the lowpassfilter. I've included 3 types of saw in the CB101 (the third type is only at my comp), and noticed that they produce different harmonic stuff, so it's good to supply them all. The &quot;Saw wave&quot; above is the same shape of the saw in Reason's SubTractor.</div>
    <div class="meta">Posted on 2002-10-08 21:18:05 by Ultrano</div>
   </div>
   <div class="post" id="post-68573">
    <div class="subject"><a href="#post-68573">problems with directSound</a></div>
    <div class="body">hi ultrano.<br /><br />thx for the code. but i have allready a solution. i looked at the mini-fmod library and played with the params. looked at your code and i have a different - thing better solution because i dont need to unnecesarry memcpy...<br /><br />what i do is i do the waveOutWrite only once, define the wav as endless-looping.<br />the main-thread checks the current position and i only need to calculate the time from the last position to the current-position-1. them the thread sleeps for about 20msecs.<br /><br />btw. i tested dreamer and i really like it. but plse add more example-songs. maybe you could convert some reason songs to your format??<br /><br />your asm code looks good except the shit variables...<br />that is what i do:<br /><br />db 0x68                    ;push dword 0.03<br />dd  0.03<br />pop eax                    ;to correct the stackpointer, note eax is destroyed.<br />fld     dword      ;read 0.03 into fpu stack</div>
    <div class="meta">Posted on 2002-12-02 05:16:42 by peci</div>
   </div>
   <div class="post" id="post-68724">
    <div class="subject"><a href="#post-68724">problems with directSound</a></div>
    <div class="body">hi, Peci,<br /><br />MME does not work well on _all_ computers. And it does not allow latency below 45ms, which is hell for music artists (that's why I jmp to DSound and 've forsaken MME). Your approach to using the wave loop is the ideal thing for your purpose- it can take total of below 100 bytes for creation, maintenance and deletion of sound. <br />  I won't make more demo songs for DR 0.130. I am currently developing a better version, which has little in common with the one, published at my site. And Reason's songs cannot be imported, as the format is closed, and the instruments cannot output MIDI, which I can record. But there's a way around- DR 1.0 (the one I'm developing) can now (and in future) hear 'n' record MIDI from all channels at once, and as Reason (full version, not demo) can export MIDI from its sequencer, it will be possible to convert .rps to .dream in realtime. I know several Reason artists, who might help me with ripping the MIDIs. Of course, I will have a month to create original music myself, but it's not very soon for that, and plans are now to focus on programming. <br />  I used &quot;sh*t&quot; variables coz that's how I felt while making that part of the DR, now I use mostly &quot;baka&quot;, in Japanese &quot;idiot&quot; lol, it's time consumin' to create names for variables, I suppose it's also my style to have<br />stg proc<br /> local baka,baka2,baka3,baka4<br /> ;...<br /> ret<br />stg endp<br /><br />I see your style is to shrink code as much as possible :). <br /><br />cya</div>
    <div class="meta">Posted on 2002-12-02 20:13:02 by Ultrano</div>
   </div>
   <div class="post" id="post-68732">
    <div class="subject"><a href="#post-68732">problems with directSound</a></div>
    <div class="body"><div class="quote"><br />hi, Peci,<br /><br />MME does not work well on _all_ computers. And it does not allow latency below 45ms, which is hell for music artists (that's why I jmp to DSound and 've forsaken MME). Your approach to using the wave loop is the ideal thing for your purpose- it can take total of below 100 bytes for creation, maintenance and deletion of sound. <br />  I won't make more demo songs for DR 0.130. I am currently developing a better version, which has little in common with the one, published at my site. And Reason's songs cannot be imported, as the format is closed, and the instruments cannot output MIDI, which I can record. But there's a way around- DR 1.0 (the one I'm developing) can now (and in future) hear 'n' record MIDI from all channels at once, and as Reason (full version, not demo) can export MIDI from its sequencer, it will be possible to convert .rps to .dream in realtime. I know several Reason artists, who might help me with ripping the MIDIs. Of course, I will have a month to create original music myself, but it's not very soon for that, and plans are now to focus on programming. <br />  I used &quot;sh*t&quot; variables coz that's how I felt while making that part of the DR, now I use mostly &quot;baka&quot;, in Japanese &quot;idiot&quot; lol, it's time consumin' to create names for variables, I suppose it's also my style to have<br />stg proc<br /> local baka,baka2,baka3,baka4<br /> ;...<br /> ret<br />stg endp<br /><br />I see your style is to shrink code as much as possible :). <br /><br />cya </div><br /><br />I'm looking forward to your DR 1.0, BTW my mixer is fully functional, can mix like 16~32 channels with 0% CPU on My Athlon 900Mhz, thanks Ultrano :D</div>
    <div class="meta">Posted on 2002-12-02 20:43:42 by x86asm</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=7872&amp;page=1" style="">&laquo;</a><a href="../?id=7872&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="7872" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>