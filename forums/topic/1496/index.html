<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Get Handle of Main Window - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1496" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1496">Get Handle of Main Window</a></p>
   <div class="post" id="post-9651">
    <div class="subject"><a href="#post-9651">Get Handle of Main Window</a></div>
    <div class="body">Can anybody tell me -exactly- how can I get the handle of the Main Window ?<br />I mean:<br /><br />I have a process that creates a Window (Yeah, a classic Win Proggy). Now, that window creates a Dialog Box and that DIalog creates another one.<br />Ok, how can I get the Handle of the Main Window from the last dialog ?<br />Maybe you'll tell me ... OK, use the GetParent API... Hmmm didn't work and I dunno why, I pass the handle of the DialogBox as the argument and it always returns zero.<br />I also used the GetAncestor but again, didn't work for me...<br />Anyone have any idea ?<br /><br />                     Thanx a lot for you guys. :alright: <br /><br /><br />                                            -MagicMac.</div>
    <div class="meta">Posted on 2001-10-17 23:37:12 by magicmac</div>
   </div>
   <div class="post" id="post-9655">
    <div class="subject"><a href="#post-9655">Get Handle of Main Window</a></div>
    <div class="body">My friend!!<br />Still haven't gone to bed?<br />Ok..<br />You can store the handle to the main window in a global variable, when processing the WM_CREATE message in the WndProc of the same main window.<br />ie:<br /><br /><pre><code><br />DlgProc	PROC USES ESI EDI EBX hWnd&#58;HWND, uMsg&#58;UINT, wParam&#58;WPARAM, lParam&#58;LPARAM<br /><br />CMP uMsg,WM_CREATE<br />JZ _create<br /><br />&#40;..sarazas..&#41;<br /><br />_create&#58;<br />MOV EAX,hWnd<br />MOV MyGlobalVariable,EAX<br />RET<br /><br /></code></pre><br /><br />from then on, you can access that global variable which holds the main window's handle from any point in your code.<br />Hope that helps :)<br /><br />See you next wednesday and let's hope the waitress gives me her bloody number..hehe<br />Or at least una tirada de goma :)<br /><br /><br />LatexX</div>
    <div class="meta">Posted on 2001-10-18 00:22:55 by latigo</div>
   </div>
   <div class="post" id="post-9686">
    <div class="subject"><a href="#post-9686">Get Handle of Main Window</a></div>
    <div class="body">Thanks my Friend, but that wasn't what I was looking for, I wanna know how to get it. Actually I'm using what you said ovah there, but I have to know the other way with WinApi.</div>
    <div class="meta">Posted on 2001-10-18 09:51:39 by magicmac</div>
   </div>
   <div class="post" id="post-9687">
    <div class="subject"><a href="#post-9687">API's not working huh?</a></div>
    <div class="body">Obviously GetParent is the ideal way, but I suppose you could try FindWindow(Ex).</div>
    <div class="meta">Posted on 2001-10-18 10:02:49 by lackluster</div>
   </div>
   <div class="post" id="post-9731">
    <div class="subject"><a href="#post-9731">Get Handle of Main Window</a></div>
    <div class="body">Are you setting the hwndParent/hwndOwner argument to the parent/owner window, when you create the dialog boxes?</div>
    <div class="meta">Posted on 2001-10-18 22:21:47 by tank</div>
   </div>
   <div class="post" id="post-9757">
    <div class="subject"><a href="#post-9757">Yeah</a></div>
    <div class="body">Yeah, I'm passing that parameters ... I don't know what madafa s**t is happening ... Grrr...</div>
    <div class="meta">Posted on 2001-10-19 08:47:29 by magicmac</div>
   </div>
  </div>
 </body>
</html>