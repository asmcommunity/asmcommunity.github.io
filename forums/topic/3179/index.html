<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Linked List In Assembly - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3179" />
    <link rel="next" href="../?id=3179&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=3179">Linked List In Assembly</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=3179&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=3179&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="3179" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=3179&amp;page=2">&gt;</a><a href="../?id=3179&amp;page=2">&raquo;</a></form>   <div class="post" id="post-20956">
    <div class="subject"><a href="#post-20956">Linked List In Assembly</a></div>
    <div class="body">I was wondering, how would you classify/differentiate a linked list. I need help on this one. The attached program is an attempt to recreate that aspect of the HLL. Please check if my program meets that criteria of a linked list.<br /><br />If not? Tell me what's the criteria...(I have already done linked lists in HLL but never in ASM.)<br /><br />I searched all search engines, newgroups and found none that pinpoints of creating linked lists in assembly.<br /><br />In addition, Thomas, who was looking for something that he can mimic the forward and back button of browsers. I think this might be the answer.<br /><br />I'm nearly finished with my doubly linked list. Im still unsure if i did the right thing(met the criteria).<br /><br />Thanks!!!<br /><br />By the way this is my 100th posts !!! yay !!! :grin:</div>
    <div class="meta">Posted on 2002-01-24 16:05:49 by stryker</div>
   </div>
   <div class="post" id="post-20968">
    <div class="subject"><a href="#post-20968">Linked List In Assembly</a></div>
    <div class="body">I think what thomas needed was to make IE go forward/backward<br />(as if you pressed the buttons), not create forward/back functionality<br />in his app. But I might be wrong.</div>
    <div class="meta">Posted on 2002-01-24 16:27:43 by f0dder</div>
   </div>
   <div class="post" id="post-20973">
    <div class="subject"><a href="#post-20973">Linked List In Assembly</a></div>
    <div class="body">I understood like you, f0dder... btw... umberg, it is a very nice example... I was considering implementing something like that in one of my programs so I will definitely have a look at it. ;)<br /><br />Thanks !</div>
    <div class="meta">Posted on 2002-01-24 16:44:14 by JCP</div>
   </div>
   <div class="post" id="post-21020">
    <div class="subject"><a href="#post-21020">Linked List In Assembly</a></div>
    <div class="body">Actually, I think this is a dynamic structure array. Linked list is suppose to point the next/previous structure...I'll release a fix soon, in a few days.<br /><br />Fodder/Readiosys you are right, I didn't actually read the whole post by Thomas. My apologies :grin:<br /><br />I'm in the middle of a class...logging off<br />:)</div>
    <div class="meta">Posted on 2002-01-24 22:13:23 by stryker</div>
   </div>
   <div class="post" id="post-21043">
    <div class="subject"><a href="#post-21043">Linked List In Assembly</a></div>
    <div class="body">Offtopic: umberg, where in O.C. you live?  I live in Tustin Ranch...<br /><br /><br /><br /><br />Thanks,<br />_Shawn</div>
    <div class="meta">Posted on 2002-01-25 03:03:06 by _Shawn</div>
   </div>
   <div class="post" id="post-21051">
    <div class="subject"><a href="#post-21051">Linked List In Assembly</a></div>
    <div class="body">Its old, very old, I wrote it back when I was even worse at assembly than I am now!<br /><br />Mirno</div>
    <div class="meta">Posted on 2002-01-25 05:07:28 by Mirno</div>
   </div>
   <div class="post" id="post-21109">
    <div class="subject"><a href="#post-21109">Linked List In Assembly</a></div>
    <div class="body">Me, I live in Laguna Hills...<br /><br />Mirno, this is so cool.... I've been looking for months but never found one...I searched newsgroups, searched all search engines with all the possible search terms and found none...Anyway I'll check the source code and see what I can improve...Maybe I can make it into doubly circular linked list...<br /><br />As for me saying that it's a dynamic structure array, im pretty sure it is. Because the next/prev pointers are not actually pointers to memory addresses but an index of the dynamic structure...<br /><br />Oops gotta do some homework...I'll post some code in a few days... :grin:<br /><br />Thanks for the help!</div>
    <div class="meta">Posted on 2002-01-25 12:04:50 by stryker</div>
   </div>
   <div class="post" id="post-21205">
    <div class="subject"><a href="#post-21205">Linked List In Assembly</a></div>
    <div class="body">The attachment here is now a full fledge working example of a doubly linked list. No more dynamic array of structures.<br /><br />Next: Singly Circular and Doubly Circular Linked Lists.<br /><br />Tell me if you have questions!!!<br /><br />Have Fun!!! :grin:</div>
    <div class="meta">Posted on 2002-01-25 20:44:43 by stryker</div>
   </div>
   <div class="post" id="post-21210">
    <div class="subject"><a href="#post-21210">Linked List In Assembly</a></div>
    <div class="body">Ok! I screwed up on this one...but it's just a minor glitch... When you don't enter anything and then you close the application, it's going to give you an error...Why, because it's going to deallocate memory without having to create that part of memory first. Meaning, it's deallocating a NULL value.<br /><br />Here's the code to make that up for:<br /><br /><pre><code><br />   @@MSGClose&#58;<br />        <br />            mov     edx, RootNode<br />            <br />            @@&#58;<br />                cmp     edx, NULL<br />                je      @f<br />                push    &#40;URLList ptr &#91;edx&#93;&#41;.ptNext<br />                invoke  HeapFree, ptProcessHeap, NULL, edx<br />                pop     edx<br />                jmp     @b<br />            <br />            @@&#58;<br />            <br />            invoke  EndDialog, hWnd,NULL<br />            jmp     @@DlgProcRetTrue<br /></code></pre><br /><br />If you want to see, how many nodes it has deallocated...<br /><br /><pre><code><br />   @@MSGClose&#58;<br />        <br />            mov     edx, RootNode<br />            xor     ecx, ecx<br />        <br />            @@&#58;<br />                cmp     edx, NULL<br />                je      @f<br />                push    &#40;URLList ptr &#91;edx&#93;&#41;.ptNext<br />                inc     ecx<br />                push    ecx<br />                invoke  HeapFree, ptProcessHeap, NULL, edx<br />                pop     ecx<br />                pop     edx<br />                jmp     @b<br />            <br />            @@&#58;<br />            <br />            invoke  SetDlgItemInt, hWnd, IDE_INPUTSTATUS, ecx, FALSE<br />            invoke  MessageBox, 0, 0, 0, 0<br />            <br />            invoke  EndDialog, hWnd,NULL<br />            jmp     @@DlgProcRetTrue<br /></code></pre><br /><br />The output will be on the first input status box. The messagebox there prevents the window from closing, so that you can see the  number of nodes deallocated...<br /><br />Again, my apologies for the bug :grin:</div>
    <div class="meta">Posted on 2002-01-25 21:31:32 by stryker</div>
   </div>
   <div class="post" id="post-22996">
    <div class="subject"><a href="#post-22996">Linked List In Assembly</a></div>
    <div class="body">Ok it took me a long time to update this one(very busy with school :grin: ). This is a doubly circular linked list. Not much of a difference from the doubly linked list but in here there is no end to the list, it just keeps running in circles.<br />If you already know how doubly linked list works there is not much of a problem if you want a singly or singly circular linked list.<br /><br />Happy Coding :grin:<br /><br />Next: Deleting and Inserting from a list.</div>
    <div class="meta">Posted on 2002-02-05 23:56:59 by stryker</div>
   </div>
   <div class="post" id="post-23026">
    <div class="subject"><a href="#post-23026">Linked List In Assembly</a></div>
    <div class="body">nice example! And here a bunch of questions:<br /><br />I took a short look at your code, so if I looked right, you alloc a new entry with HeapAlloc. Why dont you free it with HeapFree on Clear?<br /><br />And is this way proper for a large and often changing list? I'm using large memory lists (not linked) with about 10-10000 entries, one entry about 10 DWORDs. The list has many changes during &quot;lifetime&quot;. I afraid a linked and allocated list will lead to memory fragmentation.<br /><br />(and by the way : what do the double @ signs in front of your labels? Is it some kind of MASM functionality?)</div>
    <div class="meta">Posted on 2002-02-06 03:52:06 by beaster</div>
   </div>
   <div class="post" id="post-23057">
    <div class="subject"><a href="#post-23057">Linked List In Assembly</a></div>
    <div class="body"><div class="quote"><br />(and by the way : what do the double @ signs in front of your labels? Is it some kind of MASM functionality?) </div>The double @ signs allow you to jump without creating an explicit label name:<pre><code>@@&#58;mov al,&#91;esi&#93;<br />   inc esi<br />   dec al<br />   jne @B ; this means jump &#91;b&#93;B&#91;/b&#93;ack to previous @@<br />   js @F ; this means jump &#91;b&#93;F&#91;/b&#93;orward to next @@<br />   mov &#91;edi&#93;,al<br />   inc edi<br />   jmp @B<br />@@&#58;ret</code></pre></div>
    <div class="meta">Posted on 2002-02-06 10:00:33 by bitRAKE</div>
   </div>
   <div class="post" id="post-23058">
    <div class="subject"><a href="#post-23058">Linked List In Assembly</a></div>
    <div class="body"><div class="quote">I took a short look at your code, so if I looked right, you alloc a new entry with HeapAlloc. Why dont you free it with HeapFree on Clear?<br /></div><br />You don't need to free it everytime because if you do you'll lose the data. The concept of linked list is that it has to &quot;linked&quot; those data even if the memory is allocated elsewhere.<br /><br />E.G. (Doubly Linked List)<br /><br />First Allocation: (RootNode)<br />-&gt; Allocate Memory. Memory Allocated at E<br />-&gt; E.ptNext = NULL ,,, E.ptPrev = NULL<br /><br />Second Allocation:<br />-&gt; Allocate Memory. Memory Allocated at X<br />-&gt; X.ptNext = NULL ,,, X.ptPrev = E<br />-&gt; E.ptNext = X<br /><br />Third Allocation:<br />-&gt; Allocate Memory. Memory Allocated at A<br />-&gt; A.ptNext = NULL ,,, A.ptPrev = X<br />-&gt; X.ptNext = A<br /><br />Fourth Allocation:<br />-&gt; Allocate Memory. Memory Allocated at M<br />-&gt; M.ptNext = NULL ,,, M.ptPrev = A<br />-&gt; A.ptNext = M<br /><br />If I free the memory of the previous one, then there is no link created and the data is lost. The only time you'll ever going to free it is when you don't need it anymore(close the application). You can see the HeapFree code at the @@MSGClose label.<br /><br /><div class="quote">And is this way proper for a large and often changing list? I'm using large memory lists (not linked) with about 10-10000 entries, one entry about 10 DWORDs. The list has many changes during &quot;lifetime&quot;. I afraid a linked and allocated list will lead to memory fragmentation. </div><br /><br />I'm not sure, I haven't tested this one on a very large list :grin: I read the platform sdk and it says:<br /><br /><div class="quote">Memory allocated by HeapAlloc is not movable. Since the memory is not movable, it is possible for the heap to become fragmented. </div><br />I'm a little bit worried but maybe you can change it to GlobalAlloc since platform sdk didn't said anything about fragmentation of this API.<br /><br />As for the fact that it allocates just anywhere in memory, that's how linked list works...If you have a very large linked list, it'll look like a spaghetti in memory(that one points to that one...check the sample pseudo code above - if we have a memory from a - z, just looks how it goes backwards and forwards...)<br /><br />I hope I answered your question.<br /><br />As for the @@LabelName, I was coding in TASM before, @@LabelName is local labels in TASM, maybe I was thinking I'm still coding in TASM he! he! he! :grin: You can see the @@, @f, @b at the @@MSGClose label, I also did it for a bit of clarity.</div>
    <div class="meta">Posted on 2002-02-06 10:29:29 by stryker</div>
   </div>
   <div class="post" id="post-23081">
    <div class="subject"><a href="#post-23081">Linked List In Assembly</a></div>
    <div class="body">Our Object Model has a defined linked list class and a link class.   They are used in the 3pic example on my web-page (if you want to check them out).<br /><br />We have a double linked list class as well, but its not publically released.  (We are using it in the &quot;object creator&quot; that were building... if your interested, i could clean up the class and release it too )<br /><br />NaN</div>
    <div class="meta">Posted on 2002-02-06 11:38:06 by NaN</div>
   </div>
   <div class="post" id="post-23082">
    <div class="subject"><a href="#post-23082">Linked List In Assembly</a></div>
    <div class="body">under win32, LocalAlloc and GlobalAlloc both use HeapAlloc internally.<br />They do some checks and parameter conversion, and then hop off<br />to HeapAlloc. So no difference there.<br /><br />To avoid memory fragmentation, you can allocate &quot;pools&quot; of nodes,<br />but this requires a good deal of extra management code if you still<br />want the flexibility of linked lists.<br /><br />Other allocation strategies involve dynamic arrays aka delta arrays,<br />where you use HeapAlloc/HeapRealloc, and resize the array in chunks<br />instead of single entries. Because of the realloc, this can leave<br />*large* holes in the heap...<br /><br />It all comes down to your specific needs. I haven't found a method<br />yet that works well everywhere. Linked lists are nice beacuse they<br />are simple to implement and work with, but they have disadvantages<br />of nonlinear access, fragmentation, etc.</div>
    <div class="meta">Posted on 2002-02-06 11:39:25 by f0dder</div>
   </div>
   <div class="post" id="post-23090">
    <div class="subject"><a href="#post-23090">Linked List In Assembly</a></div>
    <div class="body">Nice, NaN :alright: sounds like fun in the OOP scene<br /><br />I didn't knew that LocalAlloc and GlobalAlloc uses HeapAlloc internally, thanks for the info.</div>
    <div class="meta">Posted on 2002-02-06 11:55:07 by stryker</div>
   </div>
   <div class="post" id="post-23092">
    <div class="subject"><a href="#post-23092">Linked List In Assembly</a></div>
    <div class="body">f0dder,<br /><br />One of our 'work in progress' areas on the OOP model is better management of the heap.  We are thinking of making &quot;pools&quot; of heap area and managing them for instance creation.  But this *is* alooooot of work.  And almost certainly not solely within the bounds of macro code :)<br /><br />If you have any ideas from your experiences how one might speed up the object creation/destruction process in the heap, i would definetly like to hear what you got to say.<br /><br />Real problem is objects are &quot;random&quot; in instance sizes from class to class.   As well there is no fixed assumptions of how many instances an application may generate....<br /><br />Oh well, i have a strong feeling this will be a long to solve...<br /><br />NaN</div>
    <div class="meta">Posted on 2002-02-06 12:02:20 by NaN</div>
   </div>
   <div class="post" id="post-23093">
    <div class="subject"><a href="#post-23093">Linked List In Assembly</a></div>
    <div class="body">HeapAlloc / HeapFree not good enough for the object creation/destruction?<br />Do you need to keep lists of the objects? Do you need to automatically<br />call destructors? If you don't have any &quot;special&quot; needs, HeapAlloc/Free<br />shoudl be just fine. You might want to consider creating a new heap<br />instead of using the default process heap though. Haven't yet<br />looked at how multiple heaps are positioned in the address space,<br />but I think it should work fairly well.</div>
    <div class="meta">Posted on 2002-02-06 12:09:41 by f0dder</div>
   </div>
   <div class="post" id="post-23094">
    <div class="subject"><a href="#post-23094">Linked List In Assembly</a></div>
    <div class="body">Oh it does... Im quite happy with its dynamic response... but i have seen it &quot;chug&quot; a bit with massive linked lists being built.  I attributed this to individually allocating each link via API (as Betov point out to me a while ago :)  )<br /><br />The thought that if i were to somehow manage one *big* allocation, this would speed things up.... but im sure its far from the best solution...<br /><br />NaN</div>
    <div class="meta">Posted on 2002-02-06 12:14:35 by NaN</div>
   </div>
   <div class="post" id="post-23100">
    <div class="subject"><a href="#post-23100">Linked List In Assembly</a></div>
    <div class="body">Question is, is this because Heap* are slow, or because your linked<br />list routines are slow? Try allocating one *large* chunk of memory<br />(enough to hold all the alloc requests you'll need). Use VirtualAlloc<br />for this. Then write a simple &quot;dummy&quot; allocation routine that just<br />returns an offset within this chunk, and increases &quot;next available&quot;<br />block. Don't bother writing a free. Time this against Heap* functions.<br />Would be interesting to see the results... I don't much like the thought<br />of managing your own heap inside the process heap, but if the<br />Heap* functions *are* slow... oh well, have to do testing I guess ;)</div>
    <div class="meta">Posted on 2002-02-06 12:31:27 by f0dder</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=3179&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=3179&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="3179" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=3179&amp;page=2">&gt;</a><a href="../?id=3179&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>