<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Porting simple Powerbasic DLL over to MASM - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6417" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6417">Porting simple Powerbasic DLL over to MASM</a></p>
   <div class="post" id="post-46179">
    <div class="subject"><a href="#post-46179">Porting simple Powerbasic DLL over to MASM</a></div>
    <div class="body">I'm fairly new to MASM32 and ive never built a DLL in it before, but thats my current focus. Are there any Powerbasic+MASM32 gurus out there that can kindly port this over from Powerbasic to MASM32 for me?<br /><pre><code>#COMPILE DLL<br />#INCLUDE &quot;win32api.inc&quot;<br /> <br />FUNCTION LIBMAIN&#40;BYVAL hInstance   AS LONG, _<br />                 BYVAL fwdReason   AS LONG, _<br />                 BYVAL lpvReserved AS LONG&#41; EXPORT AS LONG<br />      LIBMAIN = 1   'success!<br />      EXIT FUNCTION<br />END FUNCTION<br /> <br />SUB ShowObjects &#40;szObject AS ASCIIZ, szResult AS ASCIIZ&#41; EXPORT<br />ON ERROR RESUME NEXT<br />MSGBOX &quot;Object = &quot; &amp; szObject &amp; $CRLF &amp; _<br />	&quot;Result = &quot; &amp; szResult, %MB_OK + %MB_ICONINFORMATION, &quot;DLL Test&quot;<br />END SUB<br /> <br />SUB InitDLL &#40;&#41; EXPORT<br />ON ERROR RESUME NEXT<br />MSGBOX &quot;DLL Initialised!&quot;, %MB_OK + %MB_ICONINFORMATION, &quot;DLL Test&quot;<br />END SUB</code></pre><br />Thanks for any help in advance!  Im looking forward to seeing how they compare :)</div>
    <div class="meta">Posted on 2002-07-03 11:48:13 by 1bitshort</div>
   </div>
   <div class="post" id="post-46181">
    <div class="subject"><a href="#post-46181">Porting simple Powerbasic DLL over to MASM</a></div>
    <div class="body">Attached.</div>
    <div class="meta">Posted on 2002-07-03 12:01:50 by comrade</div>
   </div>
   <div class="post" id="post-46182">
    <div class="subject"><a href="#post-46182">Porting simple Powerbasic DLL over to MASM</a></div>
    <div class="body">lol, I didn't need the job done within 10 minutes, but thanks very much for the superfast response :) :) :)<br />I'll check it out now!  I just had a quick look at the source and it looks right :)</div>
    <div class="meta">Posted on 2002-07-03 12:06:01 by 1bitshort</div>
   </div>
   <div class="post" id="post-46192">
    <div class="subject"><a href="#post-46192">Porting simple Powerbasic DLL over to MASM</a></div>
    <div class="body">thats working perfectly, thanks! :)<br />My last question -- the MASM32-compiled DLL was 2560 bytes, whereas the Visual C++ DLL was 1152 bytes. Are there any optimisations that can be made to build.bat? :)<br />Thanks again!</div>
    <div class="meta">Posted on 2002-07-03 13:26:29 by 1bitshort</div>
   </div>
   <div class="post" id="post-46196">
    <div class="subject"><a href="#post-46196">Porting simple Powerbasic DLL over to MASM</a></div>
    <div class="body">You can /merge sections.</div>
    <div class="meta">Posted on 2002-07-03 14:20:59 by comrade</div>
   </div>
  </div>
 </body>
</html>