<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Multimedia Timer Issues - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20692" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=20692">Multimedia Timer Issues</a></p>
   <div class="post" id="post-157675">
    <div class="subject"><a href="#post-157675">Multimedia Timer Issues</a></div>
    <div class="body">Hi guys, my emulator is even better than it was before! It has come a long way but I still have a problem, when I have the frame limiter enabled, the graphics are a bit jittery and are not smooth even though I am getting a constant 60 fps (heck when I disable the frame limiter and VSync, I can easily get well over 350 fps). I am using the Multimedia timer for timing, is it a good idea to try and use the Performance Counter to do the timing? I hear it can be a lot more accurate?</div>
    <div class="meta">Posted on 2005-03-03 18:00:19 by x86asm</div>
   </div>
   <div class="post" id="post-157689">
    <div class="subject"><a href="#post-157689">Re: Multimedia Timer Issues</a></div>
    <div class="body"><div class="quote">is it a good idea to try and use the Performance Counter to do the timing?</div><br /><br />Not necessarily, look <a target="_blank" href="http://support.microsoft.com/default.aspx?scid=kb;en-us;Q274323">here</a>.</div>
    <div class="meta">Posted on 2005-03-04 06:30:34 by Frank</div>
   </div>
   <div class="post" id="post-157707">
    <div class="subject"><a href="#post-157707">Multimedia Timer Issues</a></div>
    <div class="body">Yikes, I will see what I can do, I think I will include a way to fall back onto the Multimedia Timer.</div>
    <div class="meta">Posted on 2005-03-04 20:09:28 by x86asm</div>
   </div>
   <div class="post" id="post-157785">
    <div class="subject"><a href="#post-157785">Multimedia Timer Issues</a></div>
    <div class="body">It is a lot more accurate than GetTickCount or timeGetTime tho which is a huge advantage IMO.<br /><br />I'm having similar problems as you have, I need a timer with a higher resolution than the 2 mentioned above.. It must run *exactly* the same on all systems (a bit more or less accurate is no problem, as long as I can get it down to the msec) and it should not need long calibration for that precision. <br /><br />The problem for me is with shorter calibration of say 0.1 secs it'll soon give different results on different systems. If the calibration is not perfect (and there's a good chance of that) it'll start running away or falling behind. A 1 sec would give more reliable results but I think it's too long :/<br /><br />Also I can't really rely on one-time calibration because the thing I'm working on is a benchmarking tool for overclockers so the clock speed will most likely change between every run.<br />Several users gave me bug reports of the performance counters freaking out (only at clocks of over 4 GHz tho, but still) so I had to fall back to the less precise GetTickCount now :(<br /><br />I was thinking of using RDTSC for timing but it'll need the calibration and I just don't trust that method as of yet :)<br /><br />So anyway, I'm gonna follow this thread and see if anyone here knows of a good solution :-D</div>
    <div class="meta">Posted on 2005-03-07 05:20:48 by snq</div>
   </div>
   <div class="post" id="post-157895">
    <div class="subject"><a href="#post-157895">Re: Multimedia Timer Issues</a></div>
    <div class="body">Let me know how you performance benchmark tool goes, I wouldnt mind trying it. I implemented Performance Counters and let me say I was blown away by the accuracy, the difference was MUCH better and noticable! But I dont understand how it can freak out on 4Ghz+ machines :S</div>
    <div class="meta">Posted on 2005-03-12 22:44:42 by x86asm</div>
   </div>
   <div class="post" id="post-157897">
    <div class="subject"><a href="#post-157897">Re: Multimedia Timer Issues</a></div>
    <div class="body">You can download it at <a target="_blank" href="http://superpi.radeonx.com/">http://superpi.radeonx.com/</a>. I took an existing tool that is kind of a standard for benching and added some features. The original precision was in seconds, so not very precise.. Also I added some anti cheat protection to keep the comparisons fair. Quite a fun job patching code bytes, there&#39;s no source available.<br />The timer problem still remains unsolved. Some people get a time of over an hour for a 1M run while it actually took them around 30 secs. I&#39;m not sure what to do about it but I think I&#39;ll just fall back to GetTickCount instead :/</div>
    <div class="meta">Posted on 2005-03-13 02:08:24 by snq</div>
   </div>
  </div>
 </body>
</html>