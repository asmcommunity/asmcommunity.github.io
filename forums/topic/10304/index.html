<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How to get length of text of a listview item - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10304" />
    <link rel="next" href="../?id=10304&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10304">How to get length of text of a listview item</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=10304&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=10304&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="10304" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=10304&amp;page=2">&gt;</a><a href="../?id=10304&amp;page=2">&raquo;</a></form>   <div class="post" id="post-77345">
    <div class="subject"><a href="#post-77345">How to get length of text of a listview item</a></div>
    <div class="body">Hi,<br /><br />should be a simple question at first glance, but apparently there is no documented way to get the text length of a (sub)item of a listview in report mode without getting the text as well. Or am I wrong?<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-01-20 05:58:22 by japheth</div>
   </div>
   <div class="post" id="post-124256">
    <div class="subject"><a href="#post-124256">How to get length of text of a listview item</a></div>
    <div class="body">Same problem here. :(</div>
    <div class="meta">Posted on 2003-11-13 07:06:41 by AceEmbler</div>
   </div>
   <div class="post" id="post-124279">
    <div class="subject"><a href="#post-124279">How to get length of text of a listview item</a></div>
    <div class="body">This is crazy since you have to speciffy buffer to contain subitem text to count it's length. Realy i would like to meet guy who designed ListView Report.<br />I will consider Custom ListView in near future since default one so lack.<br /><br />Is there a way to get acces to the place in memory with ListView informations ??</div>
    <div class="meta">Posted on 2003-11-13 12:38:19 by AceEmbler</div>
   </div>
   <div class="post" id="post-124298">
    <div class="subject"><a href="#post-124298">How to get length of text of a listview item</a></div>
    <div class="body">regards</div>
    <div class="meta">Posted on 2003-11-13 20:24:57 by jefeng</div>
   </div>
   <div class="post" id="post-124313">
    <div class="subject"><a href="#post-124313">How to get length of text of a listview item</a></div>
    <div class="body">There's a way to get the length of the <strong>item</strong> text without retrieving the text :) This cannot be done for subitem...<br /><pre><code>  &#91;COLOR=teal&#93;&#91;b&#93;;&#40;C&#41; 2003 Morris &#58;&#41;&#91;/b&#93;&#91;/COLOR&#93;<br />  &#91;COLOR=blue&#93;&#91;b&#93;invoke&#91;/b&#93; SetFocus&#91;/COLOR&#93;,hListView<br />  &#91;COLOR=blue&#93;&#91;b&#93;invoke&#91;/b&#93; SendMessage&#91;/COLOR&#93;,hListView,&#91;COLOR=blue&#93;LVM_EDITLABEL&#91;/COLOR&#93;,iItemNumber,0<br />  &#91;COLOR=blue&#93;&#91;b&#93;.if&#91;/b&#93;&#91;/color&#93; &#91;COLOR=orange&#93;eax&#91;/COLOR&#93;<br />    &#91;COLOR=teal&#93;&#91;b&#93;;we have the hWnd of the edit box which is used to edit the item, so why not get the text lenght? &#58;&#41;&#91;/b&#93;&#91;/COLOR&#93;<br />    &#91;COLOR=blue&#93;&#91;b&#93;invoke&#91;/b&#93; SendMessage&#91;/COLOR&#93;,&#91;COLOR=orange&#93;eax&#91;/COLOR&#93;,&#91;COLOR=blue&#93;WM_GETTEXTLENGTH&#91;/COLOR&#93;,0,0<br />    mov iTextLength,&#91;COLOR=orange&#93;eax&#91;/COLOR&#93;<br />  &#91;COLOR=blue&#93;&#91;b&#93;.endif&#91;/b&#93;&#91;/color&#93;<br /><br />  &#91;COLOR=teal&#93;&#91;b&#93;;cancel edit&#91;/b&#93;&#91;/color&#93;<br />  &#91;COLOR=blue&#93;&#91;b&#93;invoke&#91;/b&#93; SendMessage&#91;/COLOR&#93;,hListView,&#91;COLOR=blue&#93;LVM_EDITLABEL&#91;/color&#93;,-1,0</code></pre>This method however produces some unwanted effect (selected listview item flashes).</div>
    <div class="meta">Posted on 2003-11-14 01:20:54 by Morris</div>
   </div>
   <div class="post" id="post-124384">
    <div class="subject"><a href="#post-124384">How to get length of text of a listview item</a></div>
    <div class="body"><div class="quote"><br />regards </div><br /><br /><br />Dont tell me....... <br />No i will not belive it :tongue: <br /><br /><br />That's a good one Moris i will remember it.<br /><br /><br /><br />Somebody knows max length of ListView Item text ???</div>
    <div class="meta">Posted on 2003-11-14 16:56:49 by AceEmbler</div>
   </div>
   <div class="post" id="post-124387">
    <div class="subject"><a href="#post-124387">How to get length of text of a listview item</a></div>
    <div class="body">you can save the Text's Lenght as the item's data (LPARAM lParam;  // 32-bit value to associate with item ) (if you don't use it).</div>
    <div class="meta">Posted on 2003-11-14 17:12:30 by wizzra</div>
   </div>
   <div class="post" id="post-124393">
    <div class="subject"><a href="#post-124393">How to get length of text of a listview item</a></div>
    <div class="body"><div class="quote"><br />you can save the Text's Lenght as the item's data (LPARAM lParam;  // 32-bit value to associate with item ) (if you don't use it). </div><br /><br />Nice thanks.<br />I'm using lParam but i think that i can spare 16 bit for length.<br /><br />Maby it was to early to flame that control so much :tongue:</div>
    <div class="meta">Posted on 2003-11-14 17:50:40 by AceEmbler</div>
   </div>
   <div class="post" id="post-124410">
    <div class="subject"><a href="#post-124410">How to get length of text of a listview item</a></div>
    <div class="body">Hi, guys. You might find this interesting...<br />There is another way to do it, based on a trial and error approach.<br /><a target="_blank" href="">http://www.asmcommunity.net/board/showthread.php?threadid=14524&amp;highlight=get+text+length</a></div>
    <div class="meta">Posted on 2003-11-14 20:07:05 by QvasiModo</div>
   </div>
   <div class="post" id="post-124426">
    <div class="subject"><a href="#post-124426">Re: How to get length of text of a listview item</a></div>
    <div class="body">Qvasimodo,<br /><br />The original question was:<br /><div class="quote"><em>Originally posted by japheth </em><br />apparently there is no documented way to get the text length of a (sub)item of a listview in report mode <strong>without getting the text as well</strong>. Or am I wrong?<br /></div><br /><br />The trial-and-error method requires to <strong>retrieve</strong> the text to check its length.</div>
    <div class="meta">Posted on 2003-11-15 03:48:00 by Morris</div>
   </div>
   <div class="post" id="post-124465">
    <div class="subject"><a href="#post-124465">How to get length of text of a listview item</a></div>
    <div class="body">Duh... :o <br />:stupid:</div>
    <div class="meta">Posted on 2003-11-15 16:32:29 by QvasiModo</div>
   </div>
   <div class="post" id="post-124471">
    <div class="subject"><a href="#post-124471">How to get length of text of a listview item</a></div>
    <div class="body"><div class="quote"><em>Originally posted by wizzra </em><br />you can save the Text's Lenght as the item's data (LPARAM lParam;  // 32-bit value to associate with item ) (if you don't use it).</div>This will work only for <strong>item's</strong> text, but not for subitems' texts (subitems do not support the LVITEM.lParam member).<br /><br />Anyway, I have some idea about getting the length of (sub)item's text without getting the text. I'll publish it when I do some tests :)</div>
    <div class="meta">Posted on 2003-11-15 17:55:36 by Morris</div>
   </div>
   <div class="post" id="post-124523">
    <div class="subject"><a href="#post-124523">How to get length of text of a listview item</a></div>
    <div class="body">Hi Morris,<br /><br />yes indeed, but you can do a little trick.<br />if your text is not over 256bytes and u have x&lt;=4 columns, u can use the LPARAM lparam to save upto 4 diff column's text lengths (1main column + 3 subitems) for each row.<br /><br />15385FFFh ;)<br /><br />item text    =  15h<br />sub item 1  =  38h<br />sub item 2  =  5Fh<br />sub item 3  =  FFh</div>
    <div class="meta">Posted on 2003-11-16 12:24:37 by wizzra</div>
   </div>
   <div class="post" id="post-124525">
    <div class="subject"><a href="#post-124525">How to get length of text of a listview item</a></div>
    <div class="body">but if u have only 256 max length you can provide such a short buffer without hessitation plus speed will be satysfying also.</div>
    <div class="meta">Posted on 2003-11-16 13:08:32 by AceEmbler</div>
   </div>
   <div class="post" id="post-124599">
    <div class="subject"><a href="#post-124599">How to get length of text of a listview item</a></div>
    <div class="body">If you really need more text and/or subitems, you can allocate enough memory to store the lenghts of each string and place the pointer in lParam. (I hope this makes up for my useless post before :grin: ).</div>
    <div class="meta">Posted on 2003-11-17 11:29:26 by QvasiModo</div>
   </div>
   <div class="post" id="post-124611">
    <div class="subject"><a href="#post-124611">How to get length of text of a listview item</a></div>
    <div class="body"><div class="quote"><br />If you really need more text and/or subitems, you can allocate enough memory to store the lenghts of each string and place the pointer in lParam. (I hope this makes up for my useless post before :grin: ). </div><br /><br />Idea is good but it will make it more complex, we are serching the easiest way to do this.<br /><br />1. You will not know how many items there will be so who knows how big the buffer will be (BTW it's realy bugging me when i cant specify exact buffer size).<br />2. There will be a problem with SubItems maby we will add new columns later.<br />3. A lot of new ListViews==A lot of new buffers.</div>
    <div class="meta">Posted on 2003-11-17 12:31:21 by AceEmbler</div>
   </div>
   <div class="post" id="post-124613">
    <div class="subject"><a href="#post-124613">How to get length of text of a listview item</a></div>
    <div class="body">You have a point, it would be more complex. However all the other problems can be solved... if you add a new column, you have to reallocate all of your &quot;buffers&quot;. This may be a problem, though, depending on how you're allocating this data...<br /><br />As for not knowing the size of the array of pointers, it's enough to store the size in the first DWORD. :)<br />Still the idea is only good for a fixed number of columns, though. Otherwise it's more trouble than it's worth. :(<br /><br />Hey, but at least I said <em>something</em> useful this time, it's an improvement. :grin:</div>
    <div class="meta">Posted on 2003-11-17 12:54:27 by QvasiModo</div>
   </div>
   <div class="post" id="post-126193">
    <div class="subject"><a href="#post-126193">How to get length of text of a listview item</a></div>
    <div class="body"><div class="quote"><em>Originally posted by AceEmbler </em><br />Is there a way to get acces to the place in memory with ListView informations ??</div><br /><br />Hmmm, it took me a while to do some research on this... Are you still interested? :)</div>
    <div class="meta">Posted on 2003-12-01 17:28:34 by Morris</div>
   </div>
   <div class="post" id="post-126270">
    <div class="subject"><a href="#post-126270">How to get length of text of a listview item</a></div>
    <div class="body">Naturally :)</div>
    <div class="meta">Posted on 2003-12-02 07:50:48 by AceEmbler</div>
   </div>
   <div class="post" id="post-126361">
    <div class="subject"><a href="#post-126361">How to get length of text of a listview item</a></div>
    <div class="body">Well, basically to get to the internal ListView structure you simply have to<pre><code>invoke GetWindowLong,hListView,0</code></pre> But here's where it starts to be complicated. From version to version this structure has ben changed, and to my current knowledge, there are seven variants of this, let's call it, LV_DATA.<br />I've checked comctl32.dll versions from 4.00.950 to 6.0.2800.1106 (with some exceptions, see the attachment). I did not bother to demystify all members of the LV_DATA structure, only those that were easy to guess by their contents. Maybe in the future I'll look at it a bit closer. Any comments welcome.</div>
    <div class="meta">Posted on 2003-12-03 02:23:00 by Morris</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=10304&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=10304&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="10304" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=10304&amp;page=2">&gt;</a><a href="../?id=10304&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>