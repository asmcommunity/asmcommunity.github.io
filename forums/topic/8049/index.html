<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>DDE (with excel) question - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8049" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=8049">DDE (with excel) question</a></p>
   <div class="post" id="post-58874">
    <div class="subject"><a href="#post-58874">DDE (with excel) question</a></div>
    <div class="body">In the past I've used dde to link to excel and poke/request data, but so far I've only done it in aspect (procomm scripting lang).  I'm curious how it's done in real life using the dde api functions.<br /><br />So far this is what I'm (pretty) sure of:<br /><br />1) DdeInitialize w/ APPCLASS_STANDARD or APPCMD_CLIENTONLY<br />      ;this is successful<br />2) DdeCreateStringHandle w/ service name<br />      ;&quot;Excel&quot;<br />3) DdeCreateStringHandle w/ topic name<br />      ;&quot;System&quot;<br />4) DdeConnect w/ hTopic and hService<br />      ;this successfully establishes a connection<br /><br /><br />I've got to open excel first for this to work since I haven't programmatically done this.  But there are at least two things that I don't know how to do:  pass the fileopen command -- , pass the row/col info &quot;r1c1&quot; for example.<br /><br />Is the FileOpen command sent in a DdeClientTransaction call w/ XTYP_EXECUTE?  Then, is the row/col info sent in the form of another DdeClientTransaction call, and if so how?<br /><br />All that I've been able to find in my googling is mostly non-english results.  The english results are either vc++/mfc, vb, matlab, etc specific.  Does anyone have any straightforward language-inspecific docs on this or know where I can find any?  Or if someone could show me a general outline (i.e. like steps 1-4 above) that would be fantastic.<br /><br />thanks,<br />Will</div>
    <div class="meta">Posted on 2002-09-20 10:40:25 by Will</div>
   </div>
   <div class="post" id="post-59134">
    <div class="subject"><a href="#post-59134">DDE (with excel) question</a></div>
    <div class="body">Hi Will,<br /><br /> Have a look at savage's mircdde program. It's an easy<br />to understand sample of a simple DDE client. It should<br />answer your questions.<br /><br /> You can find it here:<br /><a target="_blank" href="http://www.asmcommunity.net/board/showthread.php?threadid=5024">http://www.asmcommunity.net/board/showthread.php?threadid=5024</a></div>
    <div class="meta">Posted on 2002-09-22 10:33:53 by Wayne</div>
   </div>
   <div class="post" id="post-59135">
    <div class="subject"><a href="#post-59135">DDE (with excel) question</a></div>
    <div class="body">Thanks Wayne.  I've seen Savage's example and the client/server example on Iczelion's site.  There's more info that needs to be passed to excel though (i.e. file name, possibly the worksheet name, and the row/col info).  My question is excel-specific I guess--how do you pass that other info to excel?  Sorry if I wasn't clear on that.  Do I just need multiple DdeClientTransaction calls to pass the other info?</div>
    <div class="meta">Posted on 2002-09-22 11:08:19 by Will</div>
   </div>
   <div class="post" id="post-59178">
    <div class="subject"><a href="#post-59178">DDE (with excel) question</a></div>
    <div class="body">Will,<br /><br /> For excel:<br /><br /> Establish connection with topic &quot;System&quot;<br /> You can issue commands to excel with this connection.<br /> If I remember correctly, you have to enclose commands in brackets i.e. &quot;&quot; opens new workbook. In your case something like &quot;&quot; Not 100% sure on syntax here. I will try to find more info.<br /><br /> Also, with &quot;system&quot; topic you can request a list of all topics supported. To do this use &quot;Topics&quot; as Item.<br />In excel, any loaded workbooks are listed as topics.<br /><br />To 'poke' a cell with data, create another connection with<br />your workbook as the &quot;Topic&quot;. You can then 'poke' using<br />&quot;R1C1&quot; format.<br /><br />This is basicly steps needed. Like I said, I'm not 100% on the syntax.</div>
    <div class="meta">Posted on 2002-09-22 18:54:52 by Wayne</div>
   </div>
   <div class="post" id="post-59298">
    <div class="subject"><a href="#post-59298">DDE (with excel) question</a></div>
    <div class="body">Good deal.  The syntax is  I'm pretty sure.  Thanks a bunch.  I'll fiddle around a bit and see if I can get it working with your tips.  Please don't feel like you have to search for any more info for me.  I mean you can if you want to ;) but I just wanted a basic outline of the necessary steps.<br /><br />Thanks a bunch,<br />Will</div>
    <div class="meta">Posted on 2002-09-23 14:13:55 by Will</div>
   </div>
   <div class="post" id="post-59349">
    <div class="subject"><a href="#post-59349">DDE (with excel) question</a></div>
    <div class="body">Got single commands to work i.e (,...) but<br />no success with  command yet. Getting Transaction Failed Error. Could be the syntax. <br /><br />I'll keep trying (I'm interested also).<br />Please Post if you have any results.<br /><br />Documentation on Excel DDE commands is almost non-existant<br />after Excel 5. Of course that's because COM took over.<br /><br />Wayne</div>
    <div class="meta">Posted on 2002-09-23 18:40:22 by Wayne</div>
   </div>
   <div class="post" id="post-59503">
    <div class="subject"><a href="#post-59503">DDE (with excel) question</a></div>
    <div class="body">You'll have to forgive me.  For the past few days I've been working such long hours that I've barely had enough time outside of work to sleep.  I did get the &quot;&quot; to work though (iirc....pretty sure anyways).  I'm home from work early (1/4 till 9) and taking a break from everything.  Tomorrow i'll spend some more time with this and post an update of my luck (or lack thereof).  :)  Thanks for your interest Wayne.  When we're done we'll be able to post examples so other people will have an easier time with the learning curve of dde (even though it seems like MS is phasing it out).<br /><br /><br />cheers,<br />Will</div>
    <div class="meta">Posted on 2002-09-24 21:42:23 by Will</div>
   </div>
   <div class="post" id="post-59555">
    <div class="subject"><a href="#post-59555">DDE (with excel) question</a></div>
    <div class="body">I finally managed to get  command to work the other<br />night. Seems like it does'nt like spaces. da!<br />Anyway, I modified savage's IRCDDE code to test on Excel.<br />Right now, all it does is open a wookbook and poke a value in cell A1.<br /><br />Wayne</div>
    <div class="meta">Posted on 2002-09-25 09:28:21 by Wayne</div>
   </div>
   <div class="post" id="post-59602">
    <div class="subject"><a href="#post-59602">DDE (with excel) question</a></div>
    <div class="body">Cool.  Your example works on excel2k which is what I've got at home.  The code that I was working on is at work and I forgot to email it to myself.  I'll play with it a little tonight and see what I can come up with.  Good deal.<br /><br /><br />cheers,<br />will</div>
    <div class="meta">Posted on 2002-09-25 20:55:54 by Will</div>
   </div>
   <div class="post" id="post-60173">
    <div class="subject"><a href="#post-60173">DDE (with excel) question</a></div>
    <div class="body">Well, I found source (vb3 I think) on MS's site for an app that uses DdeConnectList to enum all running dde servers that respond to a dde connection request with a topic of &quot;system&quot;.  It found 5 servers, and my little test app went through the loop 5 times but all 5 were empty strings and eax returned 1 for the length.  Weird stuff.<br /><br />The only thing that I managed to successfully do is re-arrange your example code in a loop and poke 1 through 1000 to rxc1.  It goes pretty fast too, faster then I thought it would anyways.<br /><br />Anyways, that's where I am right now.<br /><br />will</div>
    <div class="meta">Posted on 2002-09-30 13:08:03 by Will</div>
   </div>
   <div class="post" id="post-60203">
    <div class="subject"><a href="#post-60203">DDE (with excel) question</a></div>
    <div class="body">Hi Will,<br /> Sounds like your making some progress. I, on the other hand <br />have not done any more as I've started a semi-major house<br />project. It will keep me tied up until next week. I'll get<br />back to it then. (Or if it rains)<br /><br />If you have the Platform SDK there are some 'C' DDE examples<br />to look over.<br /><br />Just curious, are you doing this to learn DDE or do you have <br /> a need to control Excel ?<br />I only ask because there are other mechanisms you may want to look into also.<br /><br />Wayne</div>
    <div class="meta">Posted on 2002-09-30 21:24:13 by Wayne</div>
   </div>
   <div class="post" id="post-60280">
    <div class="subject"><a href="#post-60280">DDE (with excel) question</a></div>
    <div class="body">Well I wanted to explore other options then using dde macros in aspect or vba.  Periodically I've got to throw some data in an .xls file and send it off to some other departments at work.  If it can be done using masm I'd be a happy camper.  :)  Other than excel I can't imagine what I'd use it for though.</div>
    <div class="meta">Posted on 2002-10-01 10:14:32 by Will</div>
   </div>
   <div class="post" id="post-60359">
    <div class="subject"><a href="#post-60359">DDE (with excel) question</a></div>
    <div class="body">Will,<br /> Beside DDE you could also consider using COM or ODBC.<br /> IMO, using COM sounds like overkill for what you want to do.<br /> ODBC might an option. I had an example that I had posted on the old messageboard but I can't find it right now. I'll look for it. There are some limitions.<br /><br /> I am not trying to talk you out of using DDE, just thought I would suggest other things. Your needs of your application should be the basis for the method you choose.<br /><br />Wayne</div>
    <div class="meta">Posted on 2002-10-02 06:36:09 by Wayne</div>
   </div>
  </div>
 </body>
</html>