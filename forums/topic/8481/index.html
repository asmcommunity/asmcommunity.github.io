<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Powers of 2 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8481" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=8481">Powers of 2</a></p>
   <div class="post" id="post-62051">
    <div class="subject"><a href="#post-62051">Powers of 2</a></div>
    <div class="body">I'm trying to write a function that will take a two's compliment 32 bit int and return 1 if it is a power of 2 and 0 if it is not, does anyone have any help they could give me on this</div>
    <div class="meta">Posted on 2002-10-16 21:55:38 by samps005</div>
   </div>
   <div class="post" id="post-62054">
    <div class="subject"><a href="#post-62054">Powers of 2</a></div>
    <div class="body">I guess just testing the coresponding bits will do... at least for positive numbers<br /><br />What i mean is if the binary representation of the number has a single 1 bit on any position  then it is a pure power of 2.</div>
    <div class="meta">Posted on 2002-10-16 22:13:31 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-62063">
    <div class="subject"><a href="#post-62063">Powers of 2</a></div>
    <div class="body">This was asked here before, but I couldn't find it.<br />Answer is:<br /><br />mov ecx, eax<br />dec eax<br /><br />and eax, ecx<br />;EAX = zero only if a single bit is set, or EAX = 0 on input EAX<br />;i.e. Must be a power of two.<br /><br /> Has been fixed - memory was a little rusty. :tongue:</div>
    <div class="meta">Posted on 2002-10-16 22:44:37 by bitRAKE</div>
   </div>
   <div class="post" id="post-62095">
    <div class="subject"><a href="#post-62095">Powers of 2</a></div>
    <div class="body"><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=4227">http://www.asmcommunity.net/board/index.php?topic=4227</a></div>
    <div class="meta">Posted on 2002-10-17 01:24:09 by iblis</div>
   </div>
   <div class="post" id="post-62160">
    <div class="subject"><a href="#post-62160">Powers of 2</a></div>
    <div class="body">If I wanted to adjust this so it would test for powers of 4 would I just subtract 3 instead of 1.  since 1 is 0001 and 3 is 0011?</div>
    <div class="meta">Posted on 2002-10-17 06:44:31 by samps005</div>
   </div>
   <div class="post" id="post-62167">
    <div class="subject"><a href="#post-62167">Powers of 2</a></div>
    <div class="body">In a word: No.<br /><pre><code>x    x-3  x&amp;&#40;x-3&#41;<br />0000 1101 0000<br />0001 1110 0000<br />0010 1111 0010<br />0011 0000 0000<br />0100 0001 0000<br />0101 0010 0000<br />0110 0011 0010<br />0111 0100 0100<br />1000 0101 0000<br />1001 0110 0000<br />1010 0111 0010<br />1011 1000 1000<br />1100 1001 1000</code></pre><br /><br /><pre><code><br />mov ecx, eax<br />dec ecx<br />test eax, ecx<br />jnz not_power_of_four<br />test eax, 055555555h<br />jz not_power_of_four<br /></code></pre><br /><br />Of course you wouldn't mind telling us why you need to figure out this problem?<br />There are of course many reasons why you'd want such code, but the fact that this is coupled with such a fundamental mis-comprehension of binary arithmatic suggests to me that maybe we're doing someones homework... Especially as this is the only post to the board...<br /><br />If it is homework, I hope you'll give credit to the appropriate members of the board when you hand it in.<br /><br />Mirno</div>
    <div class="meta">Posted on 2002-10-17 07:27:58 by Mirno</div>
   </div>
   <div class="post" id="post-62207">
    <div class="subject"><a href="#post-62207">Powers of 2</a></div>
    <div class="body">hey man you don't need to make fun of my lack of comprehension.  I'm trying to learn how to program in assembly, and this was one of the practice problems I was having trouble understanding.  If this board is for experts only then I'll not post here anymore</div>
    <div class="meta">Posted on 2002-10-17 12:26:19 by samps005</div>
   </div>
   <div class="post" id="post-62210">
    <div class="subject"><a href="#post-62210">Powers of 2</a></div>
    <div class="body">samps005...to get only numbers that are a power of four:<br /><br />They would be 4,16,64,256 for a byte<br /><br />push em on the stack then pop them one at a time to compare with your byte<br /><br />or you could multiply a value  4 in a register by 4 ...three times to compare to your byte<br /><br />Since your using 32 bit integer just multiply a few more times.<br /><br />Sounds like your sorting numbers.</div>
    <div class="meta">Posted on 2002-10-17 13:01:27 by IwasTitan</div>
   </div>
   <div class="post" id="post-62214">
    <div class="subject"><a href="#post-62214">Powers of 2</a></div>
    <div class="body">This board isn't only for &quot;experts&quot;, there are lots of guys new to assembly here (or were when they joined at least), but this board is not here to do your homework for you.<br /><br />The fact that you don't seem comfortable with binary arithmetic made me suspect that you are solving this problem for some class, and I for one do not like the idea of getting someone else marks they don't deserve.<br /><br />If you aren't doing this for some school problem, then I'm sorry, but it certainly looked like one after your misunderstanding of the logic involved. Also I would suggest that you try to go through the more fundamental aspects of logic, and binary arithmetic, they form the backbone of many seemingly complex algorithms. Of course this is the point, they seem complex until you learn the tricks of the trade, and the trade we are involved in here is the manipulation of binary data.<br />Other than that, there are an excelent set of tutorials that will teach you how to program in assembly (by Iczelion) included with masm32. They try to teach how to program in assembly, within the framework of the Windows 32 bit environment. They also do not try to weigh you down with optimisations early on in your assembly programming life. It is often said that early optimisation is the root of all evil, this is especially true when trying to learn the language you are attempting to optimise in.<br /><br />Mirno</div>
    <div class="meta">Posted on 2002-10-17 13:53:44 by Mirno</div>
   </div>
   <div class="post" id="post-62215">
    <div class="subject"><a href="#post-62215">Powers of 2</a></div>
    <div class="body">it's not for a class, I'm just trying to learn assembly on my own. Yeah I guess you right I don't really understand binary arithmetic that well.<br /><br />anyway here is what I came up with this is in psuedo code, or c basically.<br /><br />for power of 2 or not<br />!(((x + (~0x00)) &amp; x) | (!x))<br />this returns 1 if power of 2 and 0 else. (i think)<br /><br /><br />for power of 4 or not<br />(!((x + (~0x00)) &amp; x) &amp; (!(x &amp; 0xAAAAAAAA)))<br />this returns 1 if a power of 4 and 0 else (i think)<br /><br />This seems to be working, does anyone see any more errors in my logic.</div>
    <div class="meta">Posted on 2002-10-17 14:04:19 by samps005</div>
   </div>
   <div class="post" id="post-62224">
    <div class="subject"><a href="#post-62224">Powers of 2</a></div>
    <div class="body">you should listen to <strong>bitRAKE</strong>'s post.. but if it's C that you want, do something on these lines:<br /><br /><pre><code><br />/* Is an integer number a power of 2? */<br />#define ISPOW2&#40;x&#41; &#40;x &amp;&amp; &#40;x &amp; !&#40;x-1&#41;&#41;&#41;<br /></code></pre></div>
    <div class="meta">Posted on 2002-10-17 15:33:13 by Maverick</div>
   </div>
   <div class="post" id="post-62230">
    <div class="subject"><a href="#post-62230">Powers of 2</a></div>
    <div class="body">Maverick<br /><br /><pre><code><br />/* Is an integer number a power of 2? */<br />#define ISPOW2&#40;x&#41; &#40;x &amp;&amp; &#40;x &amp; !&#40;x-1&#41;&#41;&#41;<br /></code></pre><br /><br />this doesn't seem to work for x = 2<br /><br />my way might not look that pretty, but I'm run a large number of test cases and it seems to work.<br /><br />it is basically what was posted in assembly earlier</div>
    <div class="meta">Posted on 2002-10-17 16:02:32 by samps005</div>
   </div>
   <div class="post" id="post-62312">
    <div class="subject"><a href="#post-62312">Powers of 2</a></div>
    <div class="body">I don't know if it runs, the snippet is not mine.<br />Why not use <strong>bitRAKE</strong>'s code? ;)</div>
    <div class="meta">Posted on 2002-10-18 03:13:59 by Maverick</div>
   </div>
   <div class="post" id="post-62370">
    <div class="subject"><a href="#post-62370">Powers of 2</a></div>
    <div class="body"><strong>Maverick</strong>'s macro should be:<br /><pre><code>#define ISPOW2&#40;x&#41; &#40;x &amp;&amp; !&#40;x &amp; &#40;x-1&#41;&#41;&#41;</code></pre><br /><br />He'd put the ! too early :)<br /><br />Mirno</div>
    <div class="meta">Posted on 2002-10-18 05:20:05 by Mirno</div>
   </div>
   <div class="post" id="post-62437">
    <div class="subject"><a href="#post-62437">Powers of 2</a></div>
    <div class="body">This should work:<br /><br /><pre><code><br />cmp eax, 0<br />jle not_p2<br />lea edx, &#91;eax-1&#93;<br />and eax, edx<br />jnz not_p2<br />inc eax<br />ret<br /><br />not_p2&#58;<br />xor eax, eax<br />ret<br /></code></pre><br /><br />Number to test in EAX and result in EAX (1 if power of 2, 0 otherwise)</div>
    <div class="meta">Posted on 2002-10-18 08:22:03 by gliptic</div>
   </div>
  </div>
 </body>
</html>