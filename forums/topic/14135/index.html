<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Baby steps off the diving board - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14135" />
    <link rel="next" href="../?id=14135&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=14135">Baby steps off the diving board</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=14135&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=14135&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="14135" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=14135&amp;page=2">&gt;</a><a href="../?id=14135&amp;page=2">&raquo;</a></form>   <div class="post" id="post-109218">
    <div class="subject"><a href="#post-109218">Baby steps off the diving board</a></div>
    <div class="body">This is my first venture into COM land.<br />There's a com object I'd like to use for which I have a DLL, and the object's interfaces are already registered.<br /><br />The interface I wish to implemented is registered as a DUAL, DEFAULT Dispatch interface, and it also has a separate Dispatch interface for Event triggers whose methods are decorated with names like &quot;OnHappyEvent&quot;.<br /><br />The methods of the IDispatch interface itself are found at low offsets in the virtual table of the main interface, just after the IUnknown methods. They include an Invoke method.<br /><br />When I implement the interface and try coinvoking the methods directly, I don't have much luck - why not, if the interface is DUAL, does it not support vtable calls? Should I be using the Invoke method which this interface exposes via IDispatch? Should I be actually querying for IDispatch under the main interface and using its interface pointer in calls?<br /><br />Once I can call functions from the main interface without crashing, I'll want to know about implementing its Events interface...<br /><br />ok so assuming that all the non-IUnknown methods are DISPATCH,<br />then does this look ok, or should ALL those lil methods be defined the way the _vtIDispatch macro does it?<br /><br />DECLARE_INTERFACE &lt;IYAcsVtbl_&gt;<br />    ;IUnknown methods<br />    INHERIT_IUnknown<br />    ; IDispatch methods <br />    _vtIDispatch CastName<br />    ;Object methods<br />	STDMETHOD	get_hostName	, :ptr BSTR<br />	STDMETHOD	put_hostName	, :BSTR<br />	STDMETHOD	joinConference	<br />	STDMETHOD	get_userName	, :ptr BSTR<br />	STDMETHOD	put_userName	, :BSTR<br />	STDMETHOD	get_confName	, :ptr BSTR<br />	STDMETHOD	put_confName	, :BSTR<br />	STDMETHOD	startTransmit	<br />	STDMETHOD	stopTransmit	<br />	STDMETHOD	leaveConference	<br />	STDMETHOD	get_monitorGain	, :ptr SWORD<br />	STDMETHOD	put_monitorGain	, :SWORD<br />	STDMETHOD	get_outputGain	, :ptr SWORD<br />	STDMETHOD	put_outputGain	, :SWORD<br />	STDMETHOD	get_inputGain	, :ptr SWORD<br />	STDMETHOD	put_inputGain	, :SWORD<br />	STDMETHOD	get_inputMute	, :ptr SDWORD<br />	STDMETHOD	put_inputMute	, :SDWORD<br />	STDMETHOD	get_outputMute	, :ptr SDWORD<br />	STDMETHOD	put_outputMute	, :SDWORD<br />	STDMETHOD	get_inputSource	, :ptr SWORD<br />	STDMETHOD	put_inputSource	, :SWORD<br />	STDMETHOD	get_monitorMute	, :ptr SDWORD<br />	STDMETHOD	put_monitorMute	, :SDWORD<br />	STDMETHOD	get_socksVersion	, :ptr SWORD<br />	STDMETHOD	put_socksVersion	, :SWORD<br />	STDMETHOD	get_socksHostname	, :ptr BSTR<br />	STDMETHOD	put_socksHostname	, :BSTR<br />	STDMETHOD	get_socksPort	, :ptr SWORD<br />	STDMETHOD	put_socksPort	, :SWORD<br />	STDMETHOD	get_socksUsername	, :ptr BSTR<br />	STDMETHOD	put_socksUsername	, :BSTR<br />	STDMETHOD	get_socksPassword	, :ptr BSTR<br />	STDMETHOD	put_socksPassword	, :BSTR<br />	STDMETHOD	get_confKey	, :ptr BSTR<br />	STDMETHOD	put_confKey	, :BSTR<br />	STDMETHOD	get_inputAGC	, :ptr SDWORD<br />	STDMETHOD	put_inputAGC	, :SDWORD<br />	STDMETHOD	get_inputVOX	, :ptr SDWORD<br />	STDMETHOD	put_inputVOX	, :SDWORD<br />	STDMETHOD	createAndJoinConference	<br />	STDMETHOD	muteSource	, :SDWORD,:BSTR<br />	STDMETHOD	unmuteSource	, :SDWORD,:BSTR<br />	STDMETHOD	get_inputVOXSensitivity	, :ptr SWORD<br />	STDMETHOD	put_inputVOXSensitivity	, :SWORD<br />	STDMETHOD	setSourcePriority	, :SDWORD,:BSTR,:SWORD<br />	STDMETHOD	get_appInfo	, :ptr BSTR<br />	STDMETHOD	put_appInfo	, :BSTR<br />	STDMETHOD	playSound	, :BSTR,:REAL8,:ptr SDWORD<br />	STDMETHOD	stopSound	, :SDWORD<br />	STDMETHOD	loadSound	, :BSTR<br />	STDMETHOD	get_soundLocation	, :ptr BSTR<br />	STDMETHOD	put_soundLocation	, :BSTR<br />	STDMETHOD	startTest	, :SWORD<br />	STDMETHOD	stopTest	, :SWORD</div>
    <div class="meta">Posted on 2003-07-04 00:05:35 by Homer</div>
   </div>
   <div class="post" id="post-109433">
    <div class="subject"><a href="#post-109433">Baby steps off the diving board</a></div>
    <div class="body">Ok, no replies, no suprises either :|<br /><br />I am calling CoCreateInstance to create a interface object, and then querying it for its IDispatch, and then calling IDispatch::Invoke with DISP_PROPERTYGET to fetch BSTR and INT word and dwords from the object's default properties (by name) - so I am understanding what's going on, but when I try to write values to these properties, I get undefined errors, and I'm checking for every error code that m$ has defined for the Invoke method, and its preceding name-id resolution call... so can anyone tell me if they have successfully written bstr's to a com property and if so maybe supply a snippet so I can see where I went wrong ?? I've just been working with m$'s docs and the snippets posted in this forum to get where I am so far, but I'm doing ok I reckon - for example, I only define about 3 GUID's - I realized u dont NEED to define interfaces, if the interface is DualIDispatch and the IDisp methods are upfront and the type lib of the class is registered correctly - just IDispatch is enough, let the IDispatch functions do the dirty work !!! It's cheesy, easy and I'll post a decent example of working this way as soon as I have a reason to code one :tongue:</div>
    <div class="meta">Posted on 2003-07-06 10:24:56 by Homer</div>
   </div>
   <div class="post" id="post-109638">
    <div class="subject"><a href="#post-109638">Baby steps off the diving board</a></div>
    <div class="body">The error turned out to be &quot;Failed to Marshal Interface&quot; - curious !!<br />So I start thinking to myself &quot;did my connection to the object expire? should I be &quot;keeping it alive&quot; or something like that ?&quot;<br />It' a bit weird considering Reading the properties isn't a problem <br />This is an ATL object, and I don't know anything about anything :(<br />I'll just muddle my way through as usual - and if all else fails, I'll start using those cruddy macros too :(</div>
    <div class="meta">Posted on 2003-07-08 01:34:26 by Homer</div>
   </div>
   <div class="post" id="post-109722">
    <div class="subject"><a href="#post-109722">Baby steps off the diving board</a></div>
    <div class="body"><div class="quote">It's cheesy, easy and I'll post a decent example of working this way as soon as I have a reason to code one </div><br />Hey.. cheezy as Visual Basic, and VBA for aplications, etc.   This is how they do their &quot;magic&quot; and how when you type the method name on an object, it magically knows what the parameters are, etc. etc.  Its all becuase every object call goes through a COM interface with dispatchable interfaces, just as your describing.  So in short your writting an example of the Essense of Visual Basic ;)<br /><br /><div class="quote">..and if all else fails, I'll start using those cruddy macros too</div><br />They are far from &quot;cruddy&quot;.  The macro set that both Ernie and Japheth have defined are extremely user friendly and make life far easier.  I would not practice COM without in my opinion.  I can give you examples of calling interfaces with BSTR params, that were done by the IDispatch:Invoke method.  But the are all macro and sub-function calls....<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-07-08 21:37:01 by NaN</div>
   </div>
   <div class="post" id="post-109805">
    <div class="subject"><a href="#post-109805">Baby steps off the diving board</a></div>
    <div class="body">I'm using coinvoke and the other usual suspects, aka <br /><br /><pre><code>coinvoke IYAcs, IDispatch,Invoke,idProp, addr IID_NULL, LOCALE_USER_DEFAULT,DISPATCH_PROPERTYGET,addr pxParams,addr MyVariant,0,0</code></pre><br /><br />and not much else... I don't suppose it could hurt to use the higher com macros but japhephs includes didnt marry neatly to my existing masm includes and it looked like a pain, and besides I prefer to understand the underlying mechanics of the interface data transactions as I'm sure you can appreciate, being as many of us are machinecoders at heart, regardless of what else we do... <br /><br />I'd certainly love to see any clear-coded implementation of propertyput under idispatch tyvm :)<br /><br />I'm still not getting anywhere :( I can call Methods, I can query any kind of property for its value, but I can't set the values of those same properties :(<br />Frustrated he was, and grew his sadness, it did.</div>
    <div class="meta">Posted on 2003-07-09 08:45:01 by Homer</div>
   </div>
   <div class="post" id="post-109807">
    <div class="subject"><a href="#post-109807">Baby steps off the diving board</a></div>
    <div class="body">Hi EvilHomer2k,<br /><br />setting a property differs from getting one that IDispatch::Invoke call requires a named argument, DISPID_PROPERTYPUT. Possibly thats the reason for your problems.<br /><br />I wonder myself a bit why you dont post your code to give others a chance to find the error.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-07-09 08:50:17 by japheth</div>
   </div>
   <div class="post" id="post-109818">
    <div class="subject"><a href="#post-109818">Baby steps off the diving board</a></div>
    <div class="body">Not a problem:<br /><pre><code><br />;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\<br />;Performs a PUT of a BSTR on a PROPERTY of IYAcs Interface<br />;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\<br />PutPropertyString PROC pMethodName&#58;DWORD, cArgs&#58;DWORD, pBuffer&#58;DWORD, cbSize&#58;DWORD<br />;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\<br />LOCAL idProp&#58;DWORD<br />LOCAL xParams&#58;DISPPARAMS<br />LOCAL pxParams&#58;DWORD<br />LOCAL xError&#58;DWORD<br /><br />mov eax,pMethodName<br />mov ebx,pBuffer<br />mov ecx,cbSize<br />pushad<br />.if eax==0<br />    popad<br />    invoke MessageBox,0,CTXT&#40;&quot;No Method Name?&quot;&#41;,CTXT&#40;&quot;Syntax Error!&quot;&#41;,MB_OK+MB_ICONERROR<br />    return FALSE <br />.else     <br />mov	MyVariant.vt, VT_BSTR<br />;mov	MyVariant.wReserved1, 0<br />;mov	MyVariant.wReserved2, 0<br />;mov	MyVariant.wReserved3, 0<br /><br />.endif<br />popad<br />pushad<br />invoke ascii2unicode, pMethodName, pBuffer, cbSize<br />invoke SysAllocString, pBuffer<br />mov MyVariant.bstrVal,eax<br />popad<br /><br /><br />mov idProp,$invoke &#40;GetPropertyID,pMethodName&#41;<br />.if eax==0<br />    jmp auwParam<br />.endif<br /><br />;----------------- fill param struc<br />            invoke RtlZeroMemory, addr xParams, sizeof xParams<br />	xor	edx, edx<br />            lea       ebx,xParams<br />            mov     pxParams,ebx<br />            lea     ebx,MyVariant<br />	mov	xParams.rgvarg, ebx<br /><br />	mov	ecx, cArgs<br />	mov	xParams.cArgs, cx<br /><br />	mov	xParams.cNamedArgs, 1            <br />	lea	ecx, dwPut<br />	mov	xParams.rgdispidNamedArgs, ecx<br />	mov	dwPut,DISPID_PROPERTYPUT<br /><br />auwInvoke&#58;<br />  	xor	eax, eax<br />	coinvoke IYAcs, IDispatch,Invoke,idProp, addr IID_NULL, LOCALE_USER_DEFAULT, DISPATCH_PROPERTYGET,addr pxParams,0,0,addr xError<br />	.if eax !=0<br />                .if eax==DISP_E_BADPARAMCOUNT<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;Bad #Params&quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                .elseif eax==DISP_E_BADVARTYPE<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;Bad Arg in rgvarg&quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                .elseif eax==DISP_E_EXCEPTION<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;I'm meant to raise an Exception&quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                .elseif eax==DISP_E_MEMBERNOTFOUND<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;Nonexistant Member or ReadOnly&quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                .elseif eax==DISP_E_NONAMEDARGS<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;This Method doesn't support Named Args&quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                .elseif eax==DISP_E_OVERFLOW<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;One of the arguments in rgvarg could not be coerced to the specified type&quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                .elseif eax==DISP_E_PARAMNOTFOUND<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;One of the IDs is wrong or a Parm is missing&quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                .elseif eax==DISP_E_TYPEMISMATCH<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;One of the arguments in rgvarg could not be coerced &quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                .elseif eax==DISP_E_UNKNOWNINTERFACE<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;Unknown Interface &quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                .elseif eax==DISP_E_UNKNOWNLCID<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;Unknown LCID &quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                .elseif eax==DISP_E_PARAMNOTOPTIONAL<br />                    push eax<br />                    invoke MessageBox,0,CTXT&#40;&quot;Not enough Params &quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />                    pop eax<br />                 .else<br />                    jmp auwParam<br />                .endif<br />     	   jmp	auwExit<br />            .endif<br />	jmp @F<br />auwParam&#58;	mov	eax, E_INVALIDARG<br />	            jmp	auwExit<br />auwError&#58;	call	GetLastError<br />auwExit&#58;	ret<br />@@&#58;<br /><br /> .if eax!=0<br />   invoke wsprintf,addr szBuffer3,CTXT&#40;&quot;Error#%lu&quot;&#41;,xError<br />   invoke SysFreeString,MyVariant.bstrVal<br />    invoke MessageBox,0,addr szBuffer3,CTXT&#40;&quot;Syntax Error!&quot;&#41;,MB_OK+MB_ICONERROR<br />    return FALSE<br /> .endif  <br /> return TRUE<br />PutPropertyString ENDP<br />;\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\<br /><br /><br /><br /><br />oh, and this...<br /><br /><br />GetPropertyID PROC pPropertyName&#58;DWORD<br />LOCAL WideBuffer&#91;512&#93;&#58;BYTE<br />LOCAL pWideBuffer&#58;BSTR<br />LOCAL idProp&#58;DWORD<br /><br />            lea eax,WideBuffer<br />            mov pWideBuffer,eax<br />	invoke ascii2unicode, pPropertyName, addr WideBuffer, sizeof WideBuffer<br />	.if eax==FALSE<br />                invoke MessageBox,0,CTXT&#40;&quot;Failed AsciiToUnicode&quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />	    return NULL<br />            .endif<br />            mov idProp,NULL<br />	coinvoke IYAcs, IDispatch,GetIDsOfNames, addr IID_NULL, addr pWideBuffer, 1, LOCALE_USER_DEFAULT, addr idProp<br /><br />	.if eax !=0<br />                invoke MessageBox,0,CTXT&#40;&quot;Failed to find ID of Method&quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />            .elseif idProp==NULL<br />                invoke MessageBox,0,CTXT&#40;&quot;Failed to identify Properties&quot;&#41;,CTXT&#40;&quot;cool&quot;&#41;,MB_OK<br />            .else<br />                return idProp<br />            .endif<br />            return NULL<br />GetPropertyID ENDP<br /></code></pre></div>
    <div class="meta">Posted on 2003-07-09 10:08:30 by Homer</div>
   </div>
   <div class="post" id="post-109831">
    <div class="subject"><a href="#post-109831">Baby steps off the diving board</a></div>
    <div class="body">Hey,<br /><br />shouldnt<br /><br /><pre><code><br />auwInvoke&#58;<br />  	xor	eax, eax<br />	coinvoke IYAcs, IDispatch,Invoke,idProp, addr IID_NULL, LOCALE_USER_DEFAULT, DISPATCH_PROPERTYGET,addr pxParams,0,0,addr xError<br />	.if eax !=0<br />                .if eax==DISP_E_BADPARAMCOUNT<br /><br />be changed to<br /><br />auwInvoke&#58;<br />  	xor	eax, eax<br />	coinvoke IYAcs, IDispatch,Invoke,idProp, addr IID_NULL, LOCALE_USER_DEFAULT, DISPATCH_PROPERTYPUT,pxParams,0,0,addr xError<br />	.if eax !=0<br />                .if eax==DISP_E_BADPARAMCOUNT<br /><br /></code></pre></div>
    <div class="meta">Posted on 2003-07-09 12:33:35 by japheth</div>
   </div>
   <div class="post" id="post-109919">
    <div class="subject"><a href="#post-109919">Baby steps off the diving board</a></div>
    <div class="body">Ofcourse, I've tried both, neither was successful.. is there anything else obviously flawed or does it look pretty much right to you too? This source was translated from a snippet I found over at msdn. The erroneous dispatch method in that call was due to the fact that I've been fiddling with it, hoping that I'd either misinterpreted something or made a simple typographical error.<br />Now if it wasn't for the fact that your COMVIEW tool has no problems setting these properties I'd be thinking that the com object itself was displaying some kind of security against my client (something I only just learned about) but the bottom line here is that I'm simply doing something wrong. But what?<br />I have also learned that the ITypeInfo interface can access the Dispatch methods too which seems odd to me since theres no inheritance here...<br />So which of the possibles does your COMVIEW use to create instances and call methods of an interface (since its working and mine isn't, I'd really like to understand where the difference lies)<br />Any help or advice is of course much appreciated, and I thank you for your time.</div>
    <div class="meta">Posted on 2003-07-10 01:51:40 by Homer</div>
   </div>
   <div class="post" id="post-109944">
    <div class="subject"><a href="#post-109944">Baby steps off the diving board</a></div>
    <div class="body">comview uses CoCreateInstance (;) ) and uses IDispatch::Invoke like your source. Your code looks ok to me now. So what error do you receive now? There are some &quot;standard&quot; (more or less well known) IDispatch::Invoke errors which will indicate a wrong call:<br /><br />	dd DISP_E_BADPARAMCOUNT<br />	dd DISP_E_BADVARTYPE<br />	dd DISP_E_MEMBERNOTFOUND <br />	dd DISP_E_NONAMEDARGS <br />	dd DISP_E_OVERFLOW <br />	dd DISP_E_PARAMNOTFOUND <br />	dd DISP_E_TYPEMISMATCH <br />	dd DISP_E_UNKNOWNINTERFACE <br />	dd DISP_E_UNKNOWNLCID <br /> 	dd DISP_E_PARAMNOTOPTIONAL <br /><br />or else you get an error from the object you are calling<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-07-10 05:33:22 by japheth</div>
   </div>
   <div class="post" id="post-110038">
    <div class="subject"><a href="#post-110038">Baby steps off the diving board</a></div>
    <div class="body">This is only indirectly pertinent to the current discussion,<br />but I've found <strong>COLIB</strong> dependent code to  be problematic on <strong>Win2K</strong>. My humble recommendation is to remove all <strong>COLIB</strong> dependencies from your code entirely if you're running  <strong>Win2K</strong>.</div>
    <div class="meta">Posted on 2003-07-10 22:21:24 by Poimander</div>
   </div>
   <div class="post" id="post-110052">
    <div class="subject"><a href="#post-110052">Baby steps off the diving board</a></div>
    <div class="body">Poimander,<br /><br />this colib stuff has its problems, but EvilHomer2k doesnt create a server object, he just uses one. So only bugs in COM include files may matter (there exist some, for example in OAIDL.INC, thats because I would suggest to use the ones supplied with comview)<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-07-11 00:11:30 by japheth</div>
   </div>
   <div class="post" id="post-110139">
    <div class="subject"><a href="#post-110139">Baby steps off the diving board</a></div>
    <div class="body">Thanks for the clarification <strong>japheth</strong>. That's essentially what I was <br />refering to when I cited 'COLIB dependencies'.</div>
    <div class="meta">Posted on 2003-07-11 17:54:34 by Poimander</div>
   </div>
   <div class="post" id="post-110147">
    <div class="subject"><a href="#post-110147">Baby steps off the diving board</a></div>
    <div class="body">The error concerned is &quot;80020011&quot; which translates to &quot;Does not support a collection&quot;. What the heck is that all about?<br />ummm... I replaced all my includes with japheph's ones from his comview source package to see if that would get me sorted, on account of what you guys just said about them... so that certainly narrows the scope !<br />We're using the same build-time includes now I expect.<br /><br />For future reference .. the WINERROR.H automation error codes<br /><br /><pre><code><br />Error/Dec.   Error/Hex    Error Description<br /><br />-2147418113 &#40;8000FFFF&#41;    Catastrophic failure<br />-2147467263 &#40;80004001&#41;    Not implemented<br />-2147024882 &#40;8007000E&#41;    Ran out of memory<br />-2147024809 &#40;80070057&#41;    One or more arguments are invalid<br />-2147467262 &#40;80004002&#41;    No such interface supported<br />-2147467261 &#40;80004003&#41;    Invalid pointer<br />-2147024890 &#40;80070006&#41;    Invalid handle<br />-2147467260 &#40;80004004&#41;    Operation aborted<br />-2147467259 &#40;80004005&#41;    Unspecified error<br />-2147024891 &#40;80070005&#41;    General access denied error<br />-2147483647 &#40;80000001&#41;    Not implemented<br />-2147483646 &#40;80000002&#41;    Ran out of memory<br />-2147483645 &#40;80000003&#41;    One or more arguments are invalid<br />-2147483644 &#40;80000004&#41;    No such interface supported<br />-2147483643 &#40;80000005&#41;    Invalid pointer<br />-2147483642 &#40;80000006&#41;    Invalid handle<br />-2147483641 &#40;80000007&#41;    Operation aborted<br />-2147483640 &#40;80000008&#41;    Unspecified error<br />-2147483639 &#40;80000009&#41;    General access denied error<br />-2147483638 &#40;8000000A&#41;    The data necessary to complete this operation<br />                          not yet available.<br />-2147467258 &#40;80004006&#41;    Thread local storage failure<br />-2147467257 &#40;80004007&#41;    Get shared memory allocator failure<br />-2147467256 &#40;80004008&#41;    Get memory allocator failure<br />-2147467255 &#40;84009&#41;       Unable to initialize class cache<br />-2147467254 &#40;8400A&#41;       Unable to initialize RPC services<br />-2147467253 &#40;8000400B&#41;    Cannot set thread local storage channel control<br />-2147467252 &#40;8000400C&#41;    Could not allocate thread local storage channel<br />                          control<br />-2147467251 &#40;8000400D&#41;    The user supplied memory allocator is<br />                          unacceptable<br />-2147467250 &#40;8000400E&#41;    The OLE service mutex already exists<br />-2147467249 &#40;8000400F&#41;    The OLE service file mapping already exists<br />-2147467248 &#40;80004010&#41;    Unable to map view of file for OLE service<br />-2147467247 &#40;80004011&#41;    Failure attempting to launch OLE service<br />-2147467246 &#40;80004012&#41;    There was an attempt to call CoInitialize a<br />                          second time while single threaded<br />-2147467245 &#40;80004013&#41;    A Remote activation was necessary but was not<br />                          allowed<br />-2147467244 &#40;80004014&#41;    A Remote activation was necessary but the server<br />                          name provided was invalid<br />-2147467243 &#40;80004015&#41;    The class is configured to run as a security id<br />                          different from the caller<br />-2147467242 &#40;80004016&#41;    Use of Ole1 services requiring DDE windows is<br />                          disabled<br />-2147467241 &#40;80004017&#41;    A RunAs specification must be &lt;domain name&gt;\&lt;user<br />                          name&gt; or simply &lt;user name&gt;<br />-2147467240 &#40;80004018&#41;    The server process could not be started.  The<br />                          pathname may be incorrect.<br />-2147467239 &#40;80004019&#41;    The server process could not be started as the<br />                          configured identity.  The pathname may be<br />                          incorrect or unavailable.<br />-2147467238 &#40;8000401A&#41;    The server process could not be started because<br />                          the configured identity is incorrect.  Check the<br />                          username and password.<br />-2147467237 &#40;8000401B&#41;    The client is not allowed to launch this server.<br />-2147467236 &#40;8000401C&#41;    The service providing this server could not be<br />                          started.<br />-2147467235 &#40;8000401D&#41;    This computer was unable to communicate with the<br />                          computer providing the server.<br />-2147467234 &#40;8000401E&#41;    The server did not respond after being launched.<br />-2147467233 &#40;8000401F&#41;    The registration information for this server is<br />                          inconsistent or incomplete.<br />-2147467232 &#40;80004020&#41;    The registration information for this interface<br />                          is inconsistent or incomplete.<br />-2147467231 &#40;80004021&#41;    The operation attempted is not supported.<br />-2147221504 &#40;80040000&#41;    Invalid OLEVERB structure<br />-2147221503 &#40;80040001&#41;    Invalid advise flags<br />-2147221502 &#40;80040002&#41;    Can't enumerate any more, because the associated<br />                          data is missing<br />-2147221501 &#40;80040003&#41;    This implementation doesn't take advises<br />-2147221500 &#40;80040004&#41;    There is no connection for this connection ID<br />-2147221499 &#40;80040005&#41;    Need to run the object to perform this operation<br />-2147221498 &#40;80040006&#41;    There is no cache to operate on<br />-2147221497 &#40;80040007&#41;    Uninitialized object<br />-2147221496 &#40;80040008&#41;    Linked object's source class has changed<br />-2147221495 &#40;80040009&#41;    Not able to get the moniker of the object<br />-2147221494 &#40;8004000A&#41;    Not able to bind to the source<br />-2147221493 &#40;8004000B&#41;    Object is static; operation not allowed<br />-2147221492 &#40;8004000C&#41;    User cancelled out of save dialog<br />-2147221491 &#40;8004000D&#41;    Invalid rectangle<br />-2147221490 &#40;8004000E&#41;    compobj.dll is too old for the ole2.dll<br />                          initialized<br />-2147221489 &#40;8004000F&#41;    Invalid window handle<br />-2147221488 &#40;80040010&#41;    Object is not in any of the inplace active states<br />-2147221487 &#40;80040011&#41;    Not able to convert object<br />-2147221486 &#40;80040012&#41;    Not able to perform the operation because object<br />                          is not given storage yet<br />-2147221404 &#40;80040064&#41;    Invalid FORMATETC structure<br />-2147221403 &#40;80040065&#41;    Invalid DVTARGETDEVICE structure<br />-2147221402 &#40;80040066&#41;    Invalid STDGMEDIUM structure<br />-2147221401 &#40;80040067&#41;    Invalid STATDATA structure<br />-2147221400 &#40;80040068&#41;    Invalid lindex<br />-2147221399 &#40;80040069&#41;    Invalid tymed<br />-2147221398 &#40;8004006A&#41;    Invalid clipboard format<br />-2147221397 &#40;8004006B&#41;    Invalid aspect&#40;s&#41;<br />-2147221396 &#40;8004006C&#41;    tdSize parameter of the DVTARGETDEVICE structure<br />                          is invalid<br />-2147221395 &#40;8004006D&#41;    Object doesn't support IViewObject interface<br />-2147221248 &#40;80040100&#41;    Trying to revoke a drop target that has not been<br />                          registered<br />-2147221247 &#40;80040101&#41;    This window has already been registered as a drop<br />                          target<br />-2147221246 &#40;80040102&#41;    Invalid window handle<br />-2147221232 &#40;80040110&#41;    Class does not support aggregation &#40;or class<br />                          object is remote&#41;<br />-2147221231 &#40;80040111&#41;    ClassFactory cannot supply requested class<br />-2147221184 &#40;80040140&#41;    Error drawing view<br />-2147221168 &#40;80040150&#41;    Could not read key from registry<br />-2147221167 &#40;80040151&#41;    Could not write key to registry<br />-2147221166 &#40;80040152&#41;    Could not find the key in the registry<br />-2147221165 &#40;80040153&#41;    Invalid value for registry<br />-2147221164 &#40;80040154&#41;    Class not registered<br />-2147221163 &#40;80040155&#41;    Interface not registered<br />-2147221136 &#40;80040170&#41;    Cache not updated<br />-2147221120 &#40;80040180&#41;    No verbs for OLE object<br />-2147221119 &#40;80040181&#41;    Invalid verb for OLE object<br />-2147221088 &#40;800401A0&#41;    Undo is not available<br />-2147221087 &#40;800401A1&#41;    Space for tools is not available<br />-2147221056 &#40;800401C0&#41;    OLESTREAM Get method failed<br />-2147221055 &#40;800401C1&#41;    OLESTREAM Put method failed<br />-2147221054 &#40;800401C2&#41;    Contents of the OLESTREAM not in correct format<br />-2147221053 &#40;800401C3&#41;    There was an error in a Windows GDI call while<br />                          converting the bitmap to a DIB<br />-2147221052 &#40;800401C4&#41;    Contents of the IStorage not in correct format<br />-2147221051 &#40;800401C5&#41;    Contents of IStorage is missing one of the<br />                          standard streams<br />-2147221050 &#40;800401C6&#41;    There was an error in a Windows GDI call while<br />                          converting the DIB to a bitmap.<br />-2147221040 &#40;800401D0&#41;    OpenClipboard Failed<br />-2147221039 &#40;800401D1&#41;    EmptyClipboard Failed<br />-2147221038 &#40;800401D2&#41;    SetClipboard Failed<br />-2147221037 &#40;800401D3&#41;    Data on clipboard is invalid<br />-2147221036 &#40;800401D4&#41;    CloseClipboard Failed<br />-2147221024 &#40;800401E0&#41;    Moniker needs to be connected manually<br />-2147221023 &#40;800401E1&#41;    Operation exceeded deadline<br />-2147221022 &#40;800401E2&#41;    Moniker needs to be generic<br />-2147221021 &#40;800401E3&#41;    Operation unavailable<br />-2147221020 &#40;800401E4&#41;    Invalid syntax<br />-2147221019 &#40;800401E5&#41;    No object for moniker<br />-2147221018 &#40;800401E6&#41;    Bad extension for file<br />-2147221017 &#40;800401E7&#41;    Intermediate operation failed<br />-2147221016 &#40;800401E8&#41;    Moniker is not bindable<br />-2147221015 &#40;800401E9&#41;    Moniker is not bound<br />-2147221014 &#40;800401EA&#41;    Moniker cannot open file<br />-2147221013 &#40;800401EB&#41;    User input required for operation to succeed<br />-2147221012 &#40;800401EC&#41;    Moniker class has no inverse<br />-2147221011 &#40;800401ED&#41;    Moniker does not refer to storage<br />-2147221010 &#40;800401EE&#41;    No common prefix<br />-2147221009 &#40;800401EF&#41;    Moniker could not be enumerated<br />-2147221008 &#40;800401F0&#41;    CoInitialize has not been called.<br />-2147221007 &#40;800401F1&#41;    CoInitialize has already been called.<br />-2147221006 &#40;800401F2&#41;    Class of object cannot be determined<br />-2147221005 &#40;800401F3&#41;    Invalid class string<br />-2147221004 &#40;800401F4&#41;    Invalid interface string<br />-2147221003 &#40;800401F5&#41;    Application not found<br />-2147221002 &#40;800401F6&#41;    Application cannot be run more than once<br />-2147221001 &#40;800401F7&#41;    Some error in application program<br />-2147221000 &#40;800401F8&#41;    DLL for class not found<br />-2147220999 &#40;800401F9&#41;    Error in the DLL<br />-2147220998 &#40;800401FA&#41;    Wrong OS or OS version for application<br />-2147220997 &#40;800401FB&#41;    Object is not registered<br />-2147220996 &#40;800401FC&#41;    Object is already registered<br />-2147220995 &#40;800401FD&#41;    Object is not connected to server<br />-2147220994 &#40;800401FE&#41;    Application was launched but it didn't register a<br />                          class factory<br />-2147220993 &#40;800401FF&#41;    Object has been released<br />-2146959359 &#40;80080001&#41;    Attempt to create a class object failed<br />-2146959358 &#40;80080002&#41;    OLE service could not bind object<br />-2146959357 &#40;80080003&#41;    RPC communication failed with OLE service<br />-2146959356 &#40;80080004&#41;    Bad path to object<br />-2146959355 &#40;80080005&#41;    Server execution failed<br />-2146959354 &#40;80080006&#41;    OLE service could not communicate with the object<br />                          server<br />-2146959353 &#40;80080007&#41;    Moniker path could not be normalized<br />-2146959352 &#40;80080008&#41;    Object server is stopping when OLE service<br />                          contacts it<br />-2146959351 &#40;80080009&#41;    An invalid root block pointer was specified<br />-2146959344 &#40;80080010&#41;    An allocation chain contained an invalid link<br />                          pointer<br />-2146959343 &#40;80080011&#41;    The requested allocation size was too large<br />-2147352575 &#40;80020001&#41;    Unknown interface.<br />-2147352573 &#40;80020003&#41;    Member not found.<br />-2147352572 &#40;80020004&#41;    Parameter not found.<br />-2147352571 &#40;80020005&#41;    Type mismatch.<br />-2147352570 &#40;80020006&#41;    Unknown name.<br />-2147352569 &#40;80020007&#41;    No named arguments.<br />-2147352568 &#40;80020008&#41;    Bad variable type.<br />-2147352567 &#40;80020009&#41;    Exception occurred.<br />-2147352566 &#40;8002000A&#41;    Out of present range.<br />-2147352565 &#40;8002000B&#41;    Invalid index.<br />-2147352564 &#40;8002000C&#41;    Unknown language.<br />-2147352563 &#40;8002000D&#41;    Memory is locked.<br />-2147352562 &#40;8002000E&#41;    Invalid number of parameters.<br />-2147352561 &#40;8002000F&#41;    Parameter not optional.<br />-2147352560 &#40;80020010&#41;    Invalid callee.<br />-2147352559 &#40;80020011&#41;    Does not support a collection.<br />-2147319786 &#40;80028016&#41;    Buffer too small.<br />-2147319784 &#40;80028018&#41;    Old format or invalid type library.<br />-2147319783 &#40;80028019&#41;    Old format or invalid type library.<br />-2147319780 &#40;8002801C&#41;    Error accessing the OLE registry.<br />-2147319779 &#40;8002801D&#41;    Library not registered.<br />-2147319769 &#40;80028027&#41;    Bound to unknown type.<br />-2147319768 &#40;80028028&#41;    Qualified name disallowed.<br />-2147319767 &#40;80028029&#41;    Invalid forward reference, or reference to<br />                          uncompiled type.<br />-2147319766 &#40;8002802A&#41;    Type mismatch.<br />-2147319765 &#40;8002802B&#41;    Element not found.<br />-2147319764 &#40;8002802C&#41;    Ambiguous name.<br />-2147319763 &#40;8002802D&#41;    Name already exists in the library.<br />-2147319762 &#40;8002802E&#41;    Unknown LCID.<br />-2147319761 &#40;8002802F&#41;    Function not defined in specified DLL.<br />-2147317571 &#40;800288BD&#41;    Wrong module kind for the operation.<br />-2147317563 &#40;800288C5&#41;    Size may not exceed 64K.<br />-2147317562 &#40;800288C6&#41;    Duplicate ID in inheritance hierarchy.<br />-2147317553 &#40;800288CF&#41;    Incorrect inheritance depth in standard OLE<br />                          hmember.<br />-2147316576 &#40;80028CA0&#41;    Type mismatch.<br />-2147316575 &#40;80028CA1&#41;    Invalid number of arguments.<br />-2147316574 &#40;80028CA2&#41;    I/O Error.<br />-2147316573 &#40;80028CA3&#41;    Error creating unique tmp file.<br />-2147312566 &#40;80029C4A&#41;    Error loading type library/DLL.<br />-2147312509 &#40;80029C83&#41;    Inconsistent property functions.<br />-2147312508 &#40;80029C84&#41;    Circular dependency between types/modules.<br />-2147287039 &#40;80030001&#41;    Unable to perform requested operation.<br />-2147287038 &#40;80030002&#41;    %1 could not be found.<br />-2147287037 &#40;80030003&#41;    The path %1 could not be found.<br />-2147287036 &#40;80030004&#41;    There are insufficient resources to open another<br />                          file.<br />-2147287035 &#40;80030005&#41;    Access Denied.<br />-2147287034 &#40;80030006&#41;    Attempted an operation on an invalid object.<br />-2147287032 &#40;80030008&#41;    There is insufficient memory available to<br />                          complete operation.<br />-2147287031 &#40;80030009&#41;    Invalid pointer error.<br />-2147287022 &#40;80030012&#41;    There are no more entries to return.<br />-2147287021 &#40;80030013&#41;    Disk is write-protected.<br />-2147287015 &#40;80030019&#41;    An error occurred during a seek operation.<br />-2147287011 &#40;8003001D&#41;    A disk error occurred during a write operation.<br />-2147287010 &#40;8003001E&#41;    A disk error occurred during a read operation.<br />-2147287008 &#40;80030020&#41;    A share violation has occurred.<br />-2147287007 &#40;80030021&#41;    A lock violation has occurred.<br />-2147286960 &#40;80030050&#41;    %1 already exists.<br />-2147286953 &#40;80030057&#41;    Invalid parameter error.<br />-2147286928 &#40;80030070&#41;    There is insufficient disk space to complete<br />                          operation.<br />-2147286800 &#40;800300F0&#41;    Illegal write of non-simple property to simple<br />                          property set.<br />-2147286790 &#40;800300FA&#41;    An API call exited abnormally.<br />-2147286789 &#40;800300FB&#41;    The file %1 is not a valid compound file.<br />-2147286788 &#40;800300FC&#41;    The name %1 is not valid.<br />-2147286787 &#40;800300FD&#41;    An unexpected error occurred.<br />-2147286786 &#40;800300FE&#41;    That function is not implemented.<br />-2147286785 &#40;800300FF&#41;    Invalid flag error.<br />-2147286784 &#40;80030100&#41;    Attempted to use an object that is busy.<br />-2147286783 &#40;80030101&#41;    The storage has been changed since the last<br />                          commit.<br />-2147286782 &#40;80030102&#41;    Attempted to use an object that has ceased to<br />                          exist.<br />-2147286781 &#40;80030103&#41;    Can't save.<br />-2147286780 &#40;80030104&#41;    The compound file %1 was produced with an<br />                          incompatible version of storage.<br />-2147286779 &#40;80030105&#41;    The compound file %1 was produced with a newer<br />                          version of storage.<br />-2147286778 &#40;80030106&#41;    Share.exe or equivalent is required for<br />                          operation.<br />-2147286777 &#40;80030107&#41;    Illegal operation called on non-file based<br />                          storage.<br />-2147286776 &#40;80030108&#41;    Illegal operation called on object with extant<br />                          marshallings.<br />-2147286775 &#40;80030109&#41;    The docfile has been corrupted.<br />-2147286768 &#40;80030110&#41;    OLE32.DLL has been loaded at the wrong address.<br />-2147286527 &#40;80030201&#41;    The file download was aborted abnormally.  The<br />                          file is incomplete.<br />-2147286526 &#40;80030202&#41;    The file download has been terminated.<br />-2147418111 &#40;80010001&#41;    Call was rejected by callee.<br />-2147418110 &#40;80010002&#41;    Call was canceled by the message filter.<br />-2147418109 &#40;80010003&#41;    The caller is dispatching an intertask<br />                          SendMessage call and cannot call out via<br />                          PostMessage.<br />-2147418108 &#40;80010004&#41;    The caller is dispatching an asynchronous call<br />                          and cannot make an outgoing call on behalf of<br />                          this call.<br />-2147418107 &#40;80010005&#41;    It is illegal to call out while inside message<br />                          filter.<br />-2147418106 &#40;80010006&#41;    The connection terminated or is in a bogus state<br />                          and cannot be used any more. Other connections<br />                          are still valid.<br />-2147418105 &#40;80010007&#41;    The callee &#40;server &#91;not server application&#93;&#41; is<br />                          not available and disappeared; all connections<br />                          are invalid.  The call may have executed.<br />-2147418104 &#40;80010008&#41;    The caller &#40;client&#41; disappeared while the callee<br />                          &#40;server&#41; was processing a call.<br />-2147418103 &#40;80010009&#41;    The data packet with the marshalled parameter<br />                          data is incorrect.<br />-2147418102 &#40;8001000A&#41;    The call was not transmitted properly; the<br />                          message queue was full and was not emptied after<br />                          yielding.<br />-2147418101 &#40;8001000B&#41;    The client &#40;caller&#41; cannot marshal the parameter<br />                          data - low memory, etc.<br />-2147418100 &#40;8001000C&#41;    The client &#40;caller&#41; cannot unmarshal the return<br />                          data - low memory, etc.<br />-2147418099 &#40;8001000D&#41;    The server &#40;callee&#41; cannot marshal the return<br />                          data - low memory, etc.<br />-2147418098 &#40;8001000E&#41;    The server &#40;callee&#41; cannot unmarshal the<br />                          parameter data - low memory, etc.<br />-2147418097 &#40;8001000F&#41;    Received data is invalid; could be server or<br />                          client data.<br />-2147418096 &#40;80010010&#41;    A particular parameter is invalid and cannot be<br />                          &#40;un&#41;marshalled.<br />-2147418095 &#40;80010011&#41;    There is no second outgoing call on same channel<br />                          in DDE conversation.<br />-2147418094 &#40;80010012&#41;    The callee &#40;server &#91;not server application&#93;&#41; is<br />                          not available and disappeared; all connections<br />                          are invalid. The call did not execute.<br />-2147417856 &#40;80010100&#41;    System call failed.<br />-2147417855 &#40;80010101&#41;    Could not allocate some required resource<br />                          &#40;memory, events, ...&#41;<br />-2147417854 &#40;80010102&#41;    Attempted to make calls on more than one thread<br />                          in single threaded mode.<br />-2147417853 &#40;80010103&#41;    The requested interface is not registered on the<br />                          server object.<br />-2147417852 &#40;80010104&#41;    RPC could not call the server or could not return<br />                          the results of calling the server.<br />-2147417851 &#40;80010105&#41;    The server threw an exception.<br />-2147417850 &#40;80010106&#41;    Cannot change thread mode after it is set.<br />-2147417849 &#40;80010107&#41;    The method called does not exist on the server.<br />-2147417848 &#40;80010108&#41;    The object invoked has disconnected from its<br />                          clients.<br />-2147417847 &#40;80010109&#41;    The object invoked chose not to process the call<br />                          now.  Try again later.<br />-2147417846 &#40;8001010A&#41;    The message filter indicated that the application<br />                          is busy.<br />-2147417845 &#40;8001010B&#41;    The message filter rejected the call.<br />-2147417844 &#40;8001010C&#41;    A call control interfaces was called with invalid<br />                          data.<br />-2147417843 &#40;8001010D&#41;    An outgoing call cannot be made since the<br />                          application is dispatching an input-synchronous<br />                          call.<br />-2147417842 &#40;8001010E&#41;    The application called an interface that was<br />                          marshalled for a different thread.<br />-2147417841 &#40;8001010F&#41;    CoInitialize has not been called on the current<br />                          thread.<br />-2147417840 &#40;80010110&#41;    The version of OLE on the client and server<br />                          machines does not match.<br />-2147417839 &#40;80010111&#41;    OLE received a packet with an invalid header.<br />-2147417838 &#40;80010112&#41;    OLE received a packet with an invalid extension.<br />-2147417837 &#40;80010113&#41;    The requested object or interface does not exist.<br />-2147417836 &#40;80010114&#41;    The requested object does not exist.<br />-2147417835 &#40;80010115&#41;    OLE has sent a request and is waiting for a<br />                          reply.<br />-2147417834 &#40;80010116&#41;    OLE is waiting before retrying a request.<br />-2147417833 &#40;80010117&#41;    Call context cannot be accessed after call<br />                          completed.<br />-2147417832 &#40;80010118&#41;    Impersonate on unsecured calls is not supported.<br />-2147417831 &#40;80010119&#41;    Security must be initialized before any<br />                          interfaces are marshalled or unmarshalled.  It<br />                          cannot be changed once initialized.<br />-2147417830 &#40;8001011A&#41;    No security packages are installed on this<br />                          machine or the user is not logged on or there are<br />                          no compatible security packages between the<br />                          client and server.<br />-2147417829 &#40;8001011B&#41;    Access is denied.<br />-2147417828 &#40;8001011C&#41;    Remote calls are not allowed for this process.<br />-2147417827 &#40;8001011D&#41;    The marshalled interface data packet &#40;OBJREF&#41; has<br />                          an invalid or unknown format.<br />-2147352577 &#40;8001FFFF&#41;    An internal error occurred.<br />-2146893823 &#40;80090001&#41;    Bad UID.<br />-2146893822 &#40;80090002&#41;    Bad Hash.<br />-2146893821 &#40;80090003&#41;    Bad Key.<br />-2146893820 &#40;80090004&#41;    Bad Length.<br />-2146893819 &#40;80090005&#41;    Bad Data.<br />-2146893818 &#40;80090006&#41;    Invalid Signature.<br />-2146893817 &#40;80090007&#41;    Bad Version of provider.<br />-2146893816 &#40;80090008&#41;    Invalid algorithm specified.<br />-2146893815 &#40;80090009&#41;    Invalid flags specified.<br />-2146893814 &#40;8009000A&#41;    Invalid type specified.<br />-2146893813 &#40;8009000B&#41;    Key not valid for use in specified state.<br />-2146893812 &#40;8009000C&#41;    Hash not valid for use in specified state.<br />-2146893811 &#40;8009000D&#41;    Key does not exist.<br />-2146893810 &#40;8009000E&#41;    Insufficient memory available for the operation.<br />-2146893809 &#40;8009000F&#41;    Object already exists.<br />-2146893808 &#40;80090010&#41;    Access denied.<br />-2146893807 &#40;80090011&#41;    Object was not found.<br />-2146893806 &#40;80090012&#41;    Data already encrypted.<br />-2146893805 &#40;80090013&#41;    Invalid provider specified.<br />-2146893804 &#40;80090014&#41;    Invalid provider type specified.<br />-2146893803 &#40;80090015&#41;    Provider's public key is invalid.<br />-2146893802 &#40;80090016&#41;    Keyset does not exist<br />-2146893801 &#40;80090017&#41;    Provider type not defined.<br />-2146893800 &#40;80090018&#41;    Provider type as registered is invalid.<br />-2146893799 &#40;80090019&#41;    The keyset is not defined.<br />-2146893798 &#40;8009001A&#41;    Keyset as registered is invalid.<br />-2146893797 &#40;8009001B&#41;    Provider type does not match registered value.<br />-2146893796 &#40;8009001C&#41;    The digital signature file is corrupt.<br />-2146893795 &#40;8009001D&#41;    Provider DLL failed to initialize correctly.<br />-2146893794 &#40;8009001E&#41;    Provider DLL could not be found.<br />-2146893793 &#40;8009001F&#41;    The Keyset parameter is invalid.<br />-2146893792 &#40;80090020&#41;    An internal error occurred.<br />-2146893791 &#40;80090021&#41;    A base error occurred.<br />-2146762751 &#40;800B0001&#41;    The specified trust provider is not known on this<br />                          system.<br />-2146762750 &#40;800B0002&#41;    The trust verification action specified is not<br />                          supported by the specified trust provider.<br />-2146762749 &#40;800B0003&#41;    The form specified for the subject is not one<br />                          supported or known by the specified trust<br />                          provider.<br />-2146762748 &#40;800B0004&#41;    The subject is not trusted for the specified<br />                          action.<br />-2146762747 &#40;800B0005&#41;    Error due to problem in ASN.1 encoding process.<br />-2146762746 &#40;800B0006&#41;    Error due to problem in ASN.1 decoding process.<br />-2146762745 &#40;800B0007&#41;    Reading / writing Extensions where Attributes are<br />                          appropriate, and visa versa.<br />-2146762744 &#40;800B0008&#41;    Unspecified cryptographic failure.<br />-2146762743 &#40;800B0009&#41;    The size of the data could not be determined.<br />-2146762742 &#40;800B000A&#41;    The size of the indefinite-sized data could not<br />                          be determined.<br />-2146762741 &#40;800B000B&#41;    This object does not read and write self-sizing<br />                          data.<br />-2146762496 &#40;800B0100&#41;    No signature was present in the subject.<br />-2146762495 &#40;800B0101&#41;    A required certificate is not within its validity<br />                          period.<br />-2146762494 &#40;800B0102&#41;    The validity periods of the certification chain<br />                          do not nest correctly.<br />-2146762493 &#40;800B0103&#41;    A certificate that can only be used as an<br />                          end-entity is being used as a CA or visa versa.<br />-2146762492 &#40;800B0104&#41;    A path length constraint in the certification<br />                          chain has been violated.<br />-2146762491 &#40;800B0105&#41;    An extension of unknown type that is labeled<br />                          'critical' is present in a certificate.<br />-2146762490 &#40;800B0106&#41;    A certificate is being used for a purpose other<br />                          than that for which it is permitted.<br />-2146762489 &#40;800B0107&#41;    A parent of a given certificate in fact did not<br />                          issue that child certificate.<br />-2146762488 &#40;800B0108&#41;    A certificate is missing or has an empty value<br />                          for an important field, such as a subject or<br />                          issuer name.<br />-2146762487 &#40;800B0109&#41;    A certification chain processed correctly, but<br />                          terminated in a root certificate which isn't<br />                          trusted by the trust provider.<br />-2146762486 &#40;800B010A&#41;    A chain of certs didn't chain as they should in a<br />                          certain application of chaining.<br /><br /></code></pre></div>
    <div class="meta">Posted on 2003-07-11 19:14:30 by Homer</div>
   </div>
   <div class="post" id="post-110162">
    <div class="subject"><a href="#post-110162">Baby steps off the diving board</a></div>
    <div class="body"><strong>EvilHomer2k</strong>, You may want to review the .idl file prototype<br />of the interface method you're working with in order to verify the <br />parameters are packaged properly and are of the right type. <br />For example if the method requires a VARIANT argument, the <br />VARIANT has to be set up correctly otherwise the method breaks<br />down.</div>
    <div class="meta">Posted on 2003-07-11 21:34:54 by Poimander</div>
   </div>
   <div class="post" id="post-110172">
    <div class="subject"><a href="#post-110172">Baby steps off the diving board</a></div>
    <div class="body">Evilhomer2k,<br /><br />the error you are receiving now doesn't come from IDispatch helper functions (like DispGetParams), so its not a syntax error and it is returned by the object itself. So check your parameter values, for example:<br /><br /><pre><code><br />pushad<br />invoke ascii2unicode, pMethodName, pBuffer, cbSize<br />invoke SysAllocString, pBuffer<br />mov MyVariant.bstrVal,eax<br />popad<br /></code></pre><br /><br />Why do you supply name of the method as BSTR parameter? That looks useless to me.<br /><br />BTW, I would suggest to change your code:<br /><pre><code> <br />invoke VariantInit, addr MyVariant       ;&lt;--- insert<br />mov	MyVariant.vt, VT_BSTR<br /></code></pre><br /><br />just to be on the safe side.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-07-12 02:28:54 by japheth</div>
   </div>
   <div class="post" id="post-110260">
    <div class="subject"><a href="#post-110260">Baby steps off the diving board</a></div>
    <div class="body">Well, I continued pulling hair out for a couple more days, and then I decided that something was really up - so rather than add the extra overhead of implementing the interface indirectly, I fell back on the vtable for PUT methods - and it works.<br />This atl stuff is weird - I'm not allowed to GET anything using the vtable, and I'm not allowed to PUT using Dispatch::Invoke !!<br />Anyways, it's working, and I'm now looking forwards to implementing the Events subinterface ...<br />Now I need to have a bit more finesse when it comes to actually creating my root object instance - I'm supposed to implement a copy of the Events interface in my client(sink), then associate it with the existing Events interface(source), right?<br />Considering the IEvents is DISPATCH only, is there an easier way to late-bind just the callback members I'm interested in?<br />Furthermore, is there a way check for and enumerate running instances of the object and bind to them rather than creating a new one, should we find that at least one already exists?<br />I'm switching over to use the dm() for the next bit :)</div>
    <div class="meta">Posted on 2003-07-13 00:21:07 by Homer</div>
   </div>
   <div class="post" id="post-110264">
    <div class="subject"><a href="#post-110264">Baby steps off the diving board</a></div>
    <div class="body">Hi, Evilhomer2k<br /><br />Congratulations for your working prog!<br /><br />since this outgoing interface (events) is dispatchonly, you will have to supply an IDispatch interface when connecting. So for every event your IDispatch::Invoke proc will be called and you may easily select the ones you are interested in simply by comparing the DISPIDs.<br /><br />Running servers may register themselves in the running object table (ROT). For a client, check function GetActiveObject().<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-07-13 02:09:59 by japheth</div>
   </div>
   <div class="post" id="post-110725">
    <div class="subject"><a href="#post-110725">Baby steps off the diving board</a></div>
    <div class="body">Ok so I don't have to implement the entire interface on the clientside, just its frontend, thats cool... I've found my way through the IConnectionPointContainer to IConnectionPoint, but I come unstuck when it comes to creating my local interface (I'm trying to use AllocObject - but I haven't really defined anything).<br /><br />My question for today is pretty easy, methinks...If my Dispatch interface looks something like this:<br /><br />_vtlMyDispatch MACRO CastName:REQ<br />    _vtIUnknown CastName<br />	&amp;CastName&amp;_GetTypeInfoCount comethod1 ?<br />	&amp;CastName&amp;_GetTypeInfo comethod3 ?<br />	&amp;CastName&amp;_GetIDsOfNames comethod5 ?<br />	&amp;CastName&amp;_Invoke_  comethod8 ?<br /> ENDM<br /><br />IMyDispatch STRUCT<br />    _vtlMyDispatch IMyDispatch <br />IMyDispatch ENDS<br /><br />LPMYDISPATCH typedef ptr IMyDispatch<br /><br />...then how do I point the Invoke_ method at my handler?<br />Furthermore, can I expect IConnectionPoint_Advise to query my interface to check for its suitability to be connected to the outgoing (events) interface? (An idiots check for #methods, that kind of thing?) - or is it totally naive? <br />I'm about to find out I guess :)<br /><br />I like your suggestion anyway in regards to intercepting calls via the dispatch invoke method rather than cloning the interface structure in memory - but on that note, have you ever needed to clone an interface in memory, maybe messing with the pointers and then using it as a sink?<br />Thanks, Homer.</div>
    <div class="meta">Posted on 2003-07-16 08:20:16 by Homer</div>
   </div>
   <div class="post" id="post-110761">
    <div class="subject"><a href="#post-110761">Baby steps off the diving board</a></div>
    <div class="body">An event sink IDispatch can be rather simple.<br /><br />1. your QueryInterface method should succeed for IUnknown, IDispatch and &lt;IEventSink&gt; <br />&lt;IEventSink&gt; stands for the source interface IID you get from the object<br />2. methods GetIdsOfNames, GetTypeInfoCount and GetTypeInfo can simly return E_FAIL, since<br /> the object should know everything about this interface, at least better than you :) . So besides<br />the IUnknown methods you will have to code an IDispatch::Invoke proc, nothing else.<br />3. After calling Advise the object will call your sink's QueryInterfacewith IID of &lt;IEventSink&gt;, thats all<br /><br />-----------------------------------------------------------------------------<br />...then how do I point the Invoke_ method at my handler?<br /><br />Dont understand this question. You must supply an object (your eventsink object) to someone else,<br />so you have to create a vtable with method Invoke_ in it, which will be address of your invoke proc.</div>
    <div class="meta">Posted on 2003-07-16 12:15:09 by japheth</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=14135&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=14135&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="14135" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=14135&amp;page=2">&gt;</a><a href="../?id=14135&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>