<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ListView help - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18734" />
  <link rel="prev" href="../?id=18734&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18734">ListView help</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=18734&amp;page=1" style="">&laquo;</a><a href="../?id=18734&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="18734" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-145321">
    <div class="subject"><a href="#post-145321">ListView help</a></div>
    <div class="body">Hmmm, the fix posted by you, donkey, works to some degree, but if repeatedly clicking on the button, it appears that the problem is still there! I just don't get it? Maybe if there's someone else around here with Windows 2003 can post his result of executing this code?<br /><br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-07-03 02:42:28 by siddhartha</div>
   </div>
   <div class="post" id="post-145329">
    <div class="subject"><a href="#post-145329">ListView help</a></div>
    <div class="body">invoke TrackPopupMenuEx, , TPM_RETURNCMD or TPM_NONOTIFY, , , , NULL<br /><br />				.if eax==IDM_ADD<br /><br />erm, thats wrong too i think<br /><br />Return Values<br /><br />If the function succeeds, the return value is nonzero.<br /><br />according to the win32 api.. the trackpopupmenuex last time i checked sends the selected menu item via wm_command, not as the return value</div>
    <div class="meta">Posted on 2004-07-03 05:18:55 by evlncrn8</div>
   </div>
   <div class="post" id="post-145337">
    <div class="subject"><a href="#post-145337">ListView help</a></div>
    <div class="body">That's what I thought so too, but... msdn says<br /><br /><div class="quote"><br />If you specify TPM_RETURNCMD in the uFlags parameter, the return value is the menu-item identifier of the item that the user selected. If the user cancels the menu without making a selection, or if an error occurs, then the return value is zero.<br /></div></div>
    <div class="meta">Posted on 2004-07-03 07:35:13 by roticv</div>
   </div>
   <div class="post" id="post-145343">
    <div class="subject"><a href="#post-145343">ListView help</a></div>
    <div class="body"><div class="quote"><br />Hmmm, the fix posted by you, donkey, works to some degree, but if repeatedly clicking on the button, it appears that the problem is still there! I just don't get it? Maybe if there's someone else around here with Windows 2003 can post his result of executing this code?</div><br /><br />Sorry, it only dealt with why evlncrn8 could not display your dialog, I did not look at the other problem. Perhaps use GetLastError, or PrintError (from VKim) to find out what the error is. If there is no error and it is not being added then take a count of items, perhaps you only need to set the redraw flag. If you are using a stack based (local) structure to set the item be sure that it is properly set to 0 before filling it, you may have garbage in the structure for some calls and not for others. A common mistake people make is to only fill the parts of the structure that concern them, with a LOCAL you can be pretty sure that the other members will be set to random data and may fail the call.</div>
    <div class="meta">Posted on 2004-07-03 10:33:19 by donkey</div>
   </div>
   <div class="post" id="post-145361">
    <div class="subject"><a href="#post-145361">ListView help</a></div>
    <div class="body">I think I made it work by adding this line:<br /><br />mov lvi.iItem,0<br /><br />Yes, donkey, you are right that I should assign values to all the members of the structure, if I don't want them to be randomly set!<br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-07-03 13:52:34 by siddhartha</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=18734&amp;page=1" style="">&laquo;</a><a href="../?id=18734&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="18734" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>