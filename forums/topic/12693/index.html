<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>a simple question - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12693" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12693">a simple question</a></p>
   <div class="post" id="post-98100">
    <div class="subject"><a href="#post-98100">a simple question</a></div>
    <div class="body">Good Easter to you all!!<br /><br />I have a question about how to &quot;EXPORT&quot; a variable simbol from an assembly written DLL to a VB6 EXE.<br /><br />I can obviously export functions and also receive a string from VB and manipulate it into my DLL but I cannot pass it back!<br /><br />I could store the results of my elaborations into a series of variables in the DLL Data segment and then write a function that I call from VB with the index of the corresponding variable...but it is not pratical. If I have 200 variables I must call the function 200 times to read all them!<br /><br />I am sure it is possible to access directly this memory area, perhaps by a structure, because VB uses its own implementation of arrays and string...<br /><br />That's all because I want to do the hard work in assembly, quickly, and then use the advantages of VB in transferring those data to an Excel sheet...<br /><br />Thank you a lot!</div>
    <div class="meta">Posted on 2003-04-20 02:56:17 by fooCoder</div>
   </div>
   <div class="post" id="post-98105">
    <div class="subject"><a href="#post-98105">a simple question</a></div>
    <div class="body">foo,<br /><br />I don't think you can directly handle addresses in VB unless it has changed a lot recently. Is there a way you can directly write to the Excel spreadsheet without needing to go through VB ?<br /><br />If you can you will avoid the problem.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2003-04-20 03:28:10 by hutch--</div>
   </div>
   <div class="post" id="post-98150">
    <div class="subject"><a href="#post-98150">a simple question</a></div>
    <div class="body">fooCoder,<br />you have two options if you want to be able to read changed data back in VB: <br /> <br /> - pass your string in ByRef. This will pass the pointer to a BSTR to your asm function (VB uses BSTR's internally)<br /><br /> - pass a byte array ByRef, this will pass the pointer to an array of bytes. You can then manipulate this at will, and if necessary reassemble it into a string back in VB.</div>
    <div class="meta">Posted on 2003-04-20 06:21:25 by sluggy</div>
   </div>
   <div class="post" id="post-98539">
    <div class="subject"><a href="#post-98539">thanks</a></div>
    <div class="body">Thank you guys.<br /><br />sluggy, you give me the idea of experimenting with arrays and string....I' ve done it and posted in another thread my results.<br /><br />hutch, you are right, visual basic has its own limitations...I would like to do the hard work in assembly but, because the lack of official documentation and time, it is often difficult to accomplish the same task...<br /><br />For example, if I could translate this piece of code (by COM) in asm I would be the happiest man over this earth!:) :) :) <br /><br />Dim FileExcel As Workbook<br />Dim foglioExcel As Worksheet<br /><br />    ' Open the file<br />    Set FileExcel = Excel.Workbooks.Open(App.Path &amp; &quot;\Stats36Tris.xls&quot;)<br />    ' Select the sheet<br />    Set foglioExcel = FileExcel.Worksheets(&quot;North&quot;)<br /><br />    ' Write value to cell<br />    foglioExcel.Cells(6, 14) = 100<br /><br />    ' Close all<br />    FileExcel.Close<br />    Set FileExcel = Nothing<br />    Set foglioExcel = Nothing<br />    ' It prompts asking to confirm changes<br /><br /><br />Regards,<br /><br />fooCoder</div>
    <div class="meta">Posted on 2003-04-22 03:57:52 by fooCoder</div>
   </div>
  </div>
 </body>
</html>