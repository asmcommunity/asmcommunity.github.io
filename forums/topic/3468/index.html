<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Setting a RichEdit's font - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3468" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3468">Setting a RichEdit's font</a></p>
   <div class="post" id="post-23001">
    <div class="subject"><a href="#post-23001">Setting a RichEdit's font</a></div>
    <div class="body">Hi guys,<br /><br />I'm stuck on trying to set a richedits font... The control is working and is displayed properly but now I want to set the font to something more easier to look at like Courier New, I could do this easier if the struct wanted a pointer to the font name, but it wants an just a zero terminated string. How do I place a string in the struct instead of a pointer to it?<br /><br />Below is code that I've been working on. The error that pops up is &quot;invalid instruction operands&quot; which is caused by the offset instruction. I've tryied everything except of course the right way to get it to work.<br /><br /><pre><code><br />local  cf&#58;CHARFORMAT2<br />mov    cf.cbSize, sizeof cf<br />mov    cf.dwMask, CFM_FACE<br />mov    cf.szFaceName, offset DefFontFace<br />invoke SendMessage, hwndRichEdit, EM_SETCHARFORMAT, SCF_ALL, addr cf<br /></code></pre> <br /><br />How come I can't just go something like this :confused: <br /><pre><code><br />mov    cf.szFaceName, byte ptr &#91;DefFontFace&#93;<br /></code></pre><br /><br />Thanks for all the help! :alright:<br />James</div>
    <div class="meta">Posted on 2002-02-06 00:18:18 by JamesE</div>
   </div>
   <div class="post" id="post-23034">
    <div class="subject"><a href="#post-23034">Setting a RichEdit's font</a></div>
    <div class="body">James,<br /><br />Just send the message WM_SETFONT with the handle of the font you require to the edit control. You can get the font by either using a stock font or creating a font from a true type font using CreateFont.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-02-06 05:13:53 by hutch--</div>
   </div>
  </div>
 </body>
</html>