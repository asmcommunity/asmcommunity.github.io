<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>User Profiles Enumerate? Win9x/NT - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10057" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10057">User Profiles Enumerate? Win9x/NT</a></p>
   <div class="post" id="post-75193">
    <div class="subject"><a href="#post-75193">User Profiles Enumerate? Win9x/NT</a></div>
    <div class="body"><strong>Hello!</strong> Does anyone know how I can enumerate all users and get their<br />profile folder on Windows9x/NT/2K/XP Systems? <br /><br />W/9X Systems: I can retrieve &quot;All Users/Current User&quot; profiles. <br />(&quot;All Users&quot; is not all the users on the system! just the default for all the users) <br /><br />W/NT Systems: On NT based systems I know how I can enumerate all users<br />(NET API) and get their profile folder. <br /><br />Does aynone know of any registry keys or api calls wich works on any Windows<br />system(universal)? NO? Then how I can enumerate all profile folders on a<br />Windows/9X system? I dont own a W/9X systems so I cannot test it.<br /><br />Thanks for any information you can provide me with! :alright:</div>
    <div class="meta">Posted on 2003-01-09 00:44:31 by natas</div>
   </div>
   <div class="post" id="post-75296">
    <div class="subject"><a href="#post-75296">User Profiles Enumerate? Win9x/NT</a></div>
    <div class="body">Hello, <strong>natas</strong> :)<br /><br />First: do you have a machine with win9X to play around with? =) If not, I think it would be better.<br /><br />A while ago I have looked for this kinda thing, without find much info about it. As win9X isn't really a multi user safe system (every user has every right), people don't bother much with profiles, besides the abbility to load different basic schemes (system colors, desktop, ...).<br /><br />What I know:<br /><ul>[*]win98 has poledit on it! I haven't tested it for what it does, but it is present on the installation CD, as many others that are &quot;natural&quot; of WinNT. So it might be usefull to know that (if you don't already ; )<br />[*]If you wanna go for a more direct approach, you can try playing with info in the registry, and the folders on win9X. It is very similar to WinNT based system. Each user has a folder with some files, and the rest is registry info. I don't remeber by head wich key it should be, but I think it is not very much well hidden, capiche? ;)<br /><br /><br />Regards,<br /><br />Wicr0s0ft</div>
    <div class="meta">Posted on 2003-01-09 14:14:13 by wicr0s0ft</div>
   </div>
   <div class="post" id="post-75299">
    <div class="subject"><a href="#post-75299">User Profiles Enumerate? Win9x/NT</a></div>
    <div class="body">Well since W/9X systems are so unstable I only have a W/2K system(as I <br />mentioned above). I know of several ways I can enumerate any/all users<br />on any Windows based system. However, the methods I know are not<br />&quot;clean&quot; methods. In other words the methods may fail on users with other<br />languages and OR machines wich resort to some &quot;freaky&quot; setup.<br /><br />Ofcourse I could say that the methods I know would work on maybe 90%(or more)<br />of all installed versions of Windows. I still dont have that last 10%! And I dont <br />make programs wich are not 99% compatible with other systems. I dont<br />want to depend on a bunch of &quot;maybe's&quot; when im programming for the <br />general public so to speak. It's important to look on a all the &quot;buts/maybes&quot;<br />when creating distributed applications. ( :) )<br /><br />Anyways, to bad noone knows a certified way of doing it. Since noone knows<br />I will just retrieve the All Users/Current User profiles. <br /><br /><br /><strong>Thanks anyway tho!</strong> :alright:</div>
    <div class="meta">Posted on 2003-01-09 14:31:05 by natas</div>
   </div>
   <div class="post" id="post-75316">
    <div class="subject"><a href="#post-75316">User Profiles Enumerate? Win9x/NT</a></div>
    <div class="body">Maybe you could tell us somo' those &quot;maybe&quot;s?<br /><br />It could be interesting for both parties: we gain knowledge, and you might gain your reply through someone, that by &quot;accident&quot;, bump into some info you need...</div>
    <div class="meta">Posted on 2003-01-09 16:54:03 by wicr0s0ft</div>
   </div>
   <div class="post" id="post-75590">
    <div class="subject"><a href="#post-75590">User Profiles Enumerate? Win9x/NT</a></div>
    <div class="body">On 9x machines enumerate values in:  <br />HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\ProfileList<br /><br />btw, if this key is empty or not exist it means no user profiles have been set up.<br /><br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2003-01-11 00:30:18 by czDrillard</div>
   </div>
   <div class="post" id="post-75594">
    <div class="subject"><a href="#post-75594">User Profiles Enumerate? Win9x/NT</a></div>
    <div class="body"><strong>Thanks czDrillard!</strong> I knew there had to be something that could do the job. :alright:</div>
    <div class="meta">Posted on 2003-01-11 01:00:35 by natas</div>
   </div>
  </div>
 </body>
</html>