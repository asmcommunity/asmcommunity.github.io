<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Went from heap to here - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22510" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22510">Went from heap to here</a></p>
   <div class="post" id="post-168892">
    <div class="subject"><a href="#post-168892">Went from heap to here</a></div>
    <div class="body">I forgot the file I need to download which though outdated, has a lot of<br />the Win32 functions. It was win32.hlp or something like that.<br /><br />I would like to make this to where it can read in a text file with <br />additional file names to copy.<br /><br />Thanks.<br /><br />; copyf.asm&nbsp; Copy a file over an existing file<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br /><br /> .486&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; .model flat, stdcall&nbsp; &nbsp; &nbsp;  ; 32 bit memory model<br />&nbsp; &nbsp; option casemap :none&nbsp; &nbsp; &nbsp;  ; case sensitive<br /><br /><br />&nbsp; &nbsp; include \masm32\include\windows.inc<br />&nbsp; &nbsp; include \masm32\include\masm32.inc<br />&nbsp; &nbsp; include \masm32\include\gdi32.inc<br />&nbsp; &nbsp; include \masm32\include\user32.inc<br />&nbsp; &nbsp; include \masm32\include\kernel32.inc<br />&nbsp; &nbsp; include \masm32\include\Comctl32.inc<br />&nbsp; &nbsp; include \masm32\include\comdlg32.inc<br />&nbsp; &nbsp; include \masm32\include\shell32.inc<br />&nbsp; &nbsp; include \masm32\include\oleaut32.inc<br />&nbsp; &nbsp; include \masm32\macros\macros.asm<br /><br />&nbsp; &nbsp; includelib \masm32\lib\masm32.lib<br />&nbsp; &nbsp; includelib \masm32\lib\gdi32.lib<br />&nbsp; &nbsp; includelib \masm32\lib\user32.lib<br />&nbsp; &nbsp; includelib \masm32\lib\kernel32.lib<br />&nbsp; &nbsp; includelib \masm32\lib\Comctl32.lib<br />&nbsp; &nbsp; includelib \masm32\lib\comdlg32.lib<br />&nbsp; &nbsp; includelib \masm32\lib\shell32.lib<br />&nbsp; &nbsp; includelib \masm32\lib\oleaut32.lib<br /><br />.data <br /><br />&nbsp; &nbsp; &nbsp; File1 db &quot;Q:\LabSupplies\lab_order.xls&quot;, 0 ; file names are case sensitive<br />&nbsp; &nbsp; &nbsp; File2 db &quot;C:\spare\lab_order.xls&quot;, 0<br /><br />.code<br /><br />start:<br /><br />main proc<br /><br />&nbsp; &nbsp; LOCAL buffer[260]:BYTE<br />&nbsp; &nbsp; invoke GetCL,1,ADDR buffer<br /><br />&nbsp; &nbsp; ; Specifies how this operation is to proceed if a file of the same <br />&nbsp; &nbsp; ; name as that specified by lpNewFileName already exists. <br />&nbsp; &nbsp; ; If this parameter is TRUE and the new file already exists,<br />&nbsp; &nbsp; ; the function fails. If this parameter is FALSE and the new file<br />&nbsp; &nbsp; ; already exists, the function overwrites the existing file and succeeds.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br /><br />&nbsp; &nbsp; invoke CopyFile, offset File1, offset File2, FALSE<br />&nbsp; &nbsp; invoke ExitProcess,0<br /><br />main endp<br /><br />end start<br /></div>
    <div class="meta">Posted on 2005-12-14 07:48:58 by skywalker</div>
   </div>
  </div>
 </body>
</html>