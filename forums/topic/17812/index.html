<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Toolbar? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17812" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=41">WinAsm Studio</a> &raquo; <a href="../?id=17812">Toolbar?</a></p>
   <div class="post" id="post-137494">
    <div class="subject"><a href="#post-137494">Toolbar?</a></div>
    <div class="body">Hi there,<br /><br />i have a problem with the toolbar.i drop the rad toolbar from winasm studio on an dialog.<br />but where can i add buttons or seperators to the toolbar?<br /><br />sorry for my bad english... :-(<br /><br />can anybod send show me how to use the toolbar?<br /><br />thx<br />Tenshi</div>
    <div class="meta">Posted on 2004-03-31 10:31:29 by Tenshi</div>
   </div>
   <div class="post" id="post-137581">
    <div class="subject"><a href="#post-137581">Toolbar?</a></div>
    <div class="body">Hi Tenshi and welcome,<br /><br />I suppose you are used to how High level languages let you &quot;play&quot; with the buttons of toolbars at design time. Add/delete etc buttons is not possible in TRUE resource editors like the one built-in WinAsm Studio. A TRUE resource editor allows you to add Dialogs/controls, edit their styles, dimensions, Caption. It's your responsibility to send API messages to your control with <strong>code</strong> to get the results you want.<br /><br />Attached is a demo application that shows how to do this and MANY more.<br /><br />I hope my answer helps. Please let me know.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-04-01 06:28:24 by akyprian</div>
   </div>
   <div class="post" id="post-137582">
    <div class="subject"><a href="#post-137582">Toolbar?</a></div>
    <div class="body">Hi,<br /><br />and thanks :)<br /><br />you are right....i normally programm in c/c++ and delphi.<br />but i think asm is more intressting as those....so i startet assambler :)</div>
    <div class="meta">Posted on 2004-04-01 06:35:44 by Tenshi</div>
   </div>
   <div class="post" id="post-137583">
    <div class="subject"><a href="#post-137583">Toolbar?</a></div>
    <div class="body">I actually believe that Assembly is much easier than many people believe. I would dare to say that it is easier than C++ provided you grasp the concept.<br /><br />Enjoy FULL flexibility with Assembly!<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-04-01 06:40:56 by akyprian</div>
   </div>
   <div class="post" id="post-137584">
    <div class="subject"><a href="#post-137584">Toolbar?</a></div>
    <div class="body">THX,<br /><br />it works fine ;)<br /><br />but i have used an other way to build it up....<br /><br /><br />.code <br /><br />start:<br />	<br />    invoke GetModuleHandle, NULL<br />    mov    hInstance,eax<br />    invoke DialogBoxParam, hInstance, 1001 , NULL, addr MainProc, NULL<br />    invoke ExitProcess, eax<br />    <br />;-------------------------------------------------------------------------------<br />; MainProc<br />;-------------------------------------------------------------------------------<br />MainProc proc hWnd:HWND, uMsg:UINT, wParam:WPARAM, lParam:LPARAM<br />    .IF uMsg==WM_INITDIALOG	<br />    	Invoke SendDlgItemMessage,hWnd,1016,TB_BUTTONSTRUCTSIZE,SizeOf TBBUTTON,0<br />    	Invoke SendDlgItemMessage,hWnd,1016,TB_ADDBUTTONS,4,ADDR tbMain    <br />    .ELSEIF uMsg==WM_CLOSE<br />        invoke SendMessage, hWnd, WM_CLOSE, 0, 0<br />    .ELSEIF uMsg==WM_COMMAND<br />    <br />    .ELSE<br />        mov eax,FALSE<br />        ret<br />    .ENDIF<br />    mov eax,TRUE<br />    ret<br />MainProc endp<br /><br /><br />end start <br /><br /><br />is it ok so too??<br />at the moment there are no bitmaps in it but it works so fine :)</div>
    <div class="meta">Posted on 2004-04-01 06:47:08 by Tenshi</div>
   </div>
   <div class="post" id="post-137604">
    <div class="subject"><a href="#post-137604">Toolbar?</a></div>
    <div class="body">As already said: You have full flexibility. Usually there are many different ways to achieve the same (or similar) result.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-04-01 09:18:28 by akyprian</div>
   </div>
   <div class="post" id="post-137695">
    <div class="subject"><a href="#post-137695">Toolbar?</a></div>
    <div class="body">thanks for your help :)</div>
    <div class="meta">Posted on 2004-04-02 01:33:36 by Tenshi</div>
   </div>
   <div class="post" id="post-137698">
    <div class="subject"><a href="#post-137698">Toolbar?</a></div>
    <div class="body">Don't mention.<br /><br />If you want you can post the basic work here so that we all use it as a template. Also, I will upload it to the site.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-04-02 01:41:15 by akyprian</div>
   </div>
   <div class="post" id="post-137736">
    <div class="subject"><a href="#post-137736">Toolbar?</a></div>
    <div class="body">Hi again,<br /><br />i have finished the toolbar template, i hope its good :-)<br /><br />if you miss somthing our you think that somthing i have done ist not correct or bad asm coding please let me know :)<br /><br />thx<br />Tenshi</div>
    <div class="meta">Posted on 2004-04-02 08:54:03 by Tenshi</div>
   </div>
   <div class="post" id="post-137748">
    <div class="subject"><a href="#post-137748">Toolbar?</a></div>
    <div class="body">Hi,<br /><br />Very Good.<br />A couple of points:<br /><br />a)Dialog boxes created by the DialogBox, DialogBoxParam, DialogBoxIndirect, and DialogBoxIndirectParam functions must be destroyed using the <strong>EndDialog</strong> function. An application calls EndDialog from within the dialog box procedure; the function must not be used for any other purpose.<br /><br />So in your code:<br />.ELSEIF uMsg == WM_CLOSE<br />;Invoke SendMessage, hWnd, WM_CLOSE, 0, 0 &lt;-----Commented-Causes a GPF on my Win98SE machine<br /><br />instead, use:<br />Invoke EndDialog,hWnd,NULL<br /><br />b)I always prefer to use ImageList_Destroy to destroy my image lists before application quits.<br /><br />c)I always check HIWORD of wParam in WM_COMMAND. I suggest you do the same<br /><br />.ElseIf uMsg==WM_COMMAND<br />HIWORD wParam<br />.If EAX == 0 || 1 ; 0 is a menu, 1 is an accelerator. Toolbar messages act like menu messages...<br />LOWORD wParam<br />.If AX==....<br />.ElseIf AX==...<br />..<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-04-02 13:59:23 by akyprian</div>
   </div>
   <div class="post" id="post-137931">
    <div class="subject"><a href="#post-137931">Toolbar?</a></div>
    <div class="body">hi again :),<br /><br />thanks for your help i have only one question to your points....<br /><br />c....<br />why should i check the hiword of wParam,<br />may be its an stupid question but i programm asm a feew week ago and dont understand why i should do it :)<br /><br />tenshi</div>
    <div class="meta">Posted on 2004-04-05 02:24:24 by Tenshi</div>
   </div>
   <div class="post" id="post-137936">
    <div class="subject"><a href="#post-137936">Toolbar?</a></div>
    <div class="body">Hi,<br /><br />Most probably there will be controls on your dialogs, so it is a good practice to distinguish between notifications arriving from menus/accelerators/toolbars and controls.<br /><br />WM_COMMAND  <br />wNotifyCode = HIWORD(wParam); // notification code <br />wID = LOWORD(wParam);         // item, control, or accelerator identifier <br />hwndCtl = (HWND) lParam;      // handle of control <br /> <br /><br />Parameters<br /><br />wNotifyCode<br />Value of the high-order word of wParam. Specifies the notification code if the message is from a control. If the message is from an accelerator, this parameter is 1. If the message is from a menu, this parameter is 0. <br /><br />I hope it helps.<br /><br />Please make the appropriate changes to your toolbar demo and post it again so that I upload it to my site.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-04-05 03:56:37 by akyprian</div>
   </div>
   <div class="post" id="post-137939">
    <div class="subject"><a href="#post-137939">Done !</a></div>
    <div class="body">ok i have done the changes....<br />i hope its ok so now :)<br /><br />tenshi</div>
    <div class="meta">Posted on 2004-04-05 04:11:00 by Tenshi</div>
   </div>
   <div class="post" id="post-137941">
    <div class="subject"><a href="#post-137941">Toolbar?</a></div>
    <div class="body">Hi<br /><br />This is wrong:<br />Invoke ImageList_Destroy, ToolBarImage<br /><br />It should be:<br />Invoke ImageList_Destroy, hImgList<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-04-05 04:41:13 by akyprian</div>
   </div>
   <div class="post" id="post-137943">
    <div class="subject"><a href="#post-137943">ohh</a></div>
    <div class="body">ohhh,<br /><br />iam sorry <br /><br />here it is :)</div>
    <div class="meta">Posted on 2004-04-05 05:08:47 by Tenshi</div>
   </div>
   <div class="post" id="post-137944">
    <div class="subject"><a href="#post-137944">Toolbar?</a></div>
    <div class="body">Hi,<br /><br />Are you sure your sample compiles?????? (definately NOT)<br /><br />Replace<br />Invoke ImageList_Destroy, <strong>hImageList</strong><br /><br />with<br />Invoke ImageList_Destroy, <strong>hImgList</strong><br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-04-05 05:13:46 by akyprian</div>
   </div>
   <div class="post" id="post-137945">
    <div class="subject"><a href="#post-137945">Toolbar?</a></div>
    <div class="body">ohh man,<br /><br />today is not my day......<br />iam sorry for that.....<br />i hope this is better now</div>
    <div class="meta">Posted on 2004-04-05 05:25:31 by Tenshi</div>
   </div>
   <div class="post" id="post-137946">
    <div class="subject"><a href="#post-137946">Toolbar?</a></div>
    <div class="body">Fine!<br /><br />Uploaded to my site, thanks<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-04-05 05:55:09 by akyprian</div>
   </div>
  </div>
 </body>
</html>