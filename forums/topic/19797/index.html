<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Japheths AsmCtrl ---&gt; RAGridOcx - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19797" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=19797">Japheths AsmCtrl ---&gt; RAGridOcx</a></p>
   <div class="post" id="post-152170">
    <div class="subject"><a href="#post-152170">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">I am trying to learn how to do ActiveX controls in assembly.<br /><br />What I am trying to figure out:<br /><br />- Proper implementation of a font object.<br />- How to pass structures as parameters.<br /><br />Thanks in advance for any help.<br /><br />Here is what I have so far.<br /><br />KetilO<br /><br />11-09-2004,17 dl, New upload<br />11-10-2004,13 dl, Added more properties, methods and events</div>
    <div class="meta">Posted on 2004-11-02 08:32:55 by KetilO</div>
   </div>
   <div class="post" id="post-152238">
    <div class="subject"><a href="#post-152238">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">About structures: best is to declare your dll as free threaded. This means that  marshalling is never needed and you can pass any pointers as in a normal dll (your dll must be thread-safe, though). And you don't need to define your structures in IDL.<br /><br />If you want/need to use marshalling structures there are 2 ways:<br /><br />- use the VT_RECORD variant (and use the standard, typelib-based marshaller)<br />- write your own marshalling code</div>
    <div class="meta">Posted on 2004-11-03 03:10:42 by japheth</div>
   </div>
   <div class="post" id="post-152596">
    <div class="subject"><a href="#post-152596">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">Hi japheth<br /><br />Thanks for your reply.<br />Seem like I don't need structures after all.<br /><br />New upload at the top.<br /><br />KetilO</div>
    <div class="meta">Posted on 2004-11-09 07:02:33 by KetilO</div>
   </div>
   <div class="post" id="post-152650">
    <div class="subject"><a href="#post-152650">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">Hi all<br /><br />New upload at the top.<br /><br />- Added more properties, methods and events<br /><br />KetilO</div>
    <div class="meta">Posted on 2004-11-10 08:38:04 by KetilO</div>
   </div>
   <div class="post" id="post-152651">
    <div class="subject"><a href="#post-152651">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">calling AddRow with a parameter causes a GPF :-)<br /><br />calling AddCol after AddRow doesnt work?</div>
    <div class="meta">Posted on 2004-11-10 08:52:05 by japheth</div>
   </div>
   <div class="post" id="post-152654">
    <div class="subject"><a href="#post-152654">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">Hi japheth<br /><br />Adding columns to a populated grid will probably not be supported.<br /><br />If you use AddRow with a parameter, the parameter must be a pointer to a structure. The structure must match the number of columns and column types.<br />I really need to find a better way. Any suggestions?<br /><br />KetilO</div>
    <div class="meta">Posted on 2004-11-10 09:13:00 by KetilO</div>
   </div>
   <div class="post" id="post-152656">
    <div class="subject"><a href="#post-152656">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">Hi KetilO<br />Trying to use the control inside VB6 crashes the IDE immediately when it is inserted on a form  :( <br /><br />Regards<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-11-10 09:25:20 by Biterider</div>
   </div>
   <div class="post" id="post-152657">
    <div class="subject"><a href="#post-152657">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">&gt; Trying to use the control inside VB6 crashes the IDE immediately when it is inserted on a form Sad <br /><br />VB5 works  :) <br /><br />&gt; I really need to find a better way. Any suggestions?<br /><br />does this structure contain the contents of the columns?<br />Then as a first and simple solution I would suggest a BSTR as parameter, using TAB or &quot;;&quot; to separate the columns (like in excel).</div>
    <div class="meta">Posted on 2004-11-10 09:31:35 by japheth</div>
   </div>
   <div class="post" id="post-152664">
    <div class="subject"><a href="#post-152664">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">Hi,<br />Tested on VB.NET, but didn't work...  :? <br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-11-10 12:42:31 by Biterider</div>
   </div>
   <div class="post" id="post-152665">
    <div class="subject"><a href="#post-152665">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">Hi japheth<br /><br />Yes, the structure contains the content of the columns.<br />A tab separated BSTR seem like the solution I will go for. Thanks.<br /><br />KetilO</div>
    <div class="meta">Posted on 2004-11-10 13:22:44 by KetilO</div>
   </div>
   <div class="post" id="post-152666">
    <div class="subject"><a href="#post-152666">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">Hi Biterider<br /><br />I am using VB6 and has no problems. Try to unregister and then register the ocx again.<br /><br />I will tyy .net tomorrow.<br /><br />KetilO</div>
    <div class="meta">Posted on 2004-11-10 13:25:31 by KetilO</div>
   </div>
   <div class="post" id="post-153663">
    <div class="subject"><a href="#post-153663">RAGridOcx</a></div>
    <div class="body">Hi KetilO<br />Have you made some advances with your control? <br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-12-03 08:45:11 by Biterider</div>
   </div>
   <div class="post" id="post-153664">
    <div class="subject"><a href="#post-153664">Japheths AsmCtrl ---&gt; RAGridOcx</a></div>
    <div class="body">Hi Biterider<br /><br />I have been busy doing other projects + improving on the RAGrid.dll that is the basis control for this project. I have tested on .net but RAGridOcx is not recognized as a control.<br /><br />KetilO</div>
    <div class="meta">Posted on 2004-12-03 09:10:03 by KetilO</div>
   </div>
  </div>
 </body>
</html>