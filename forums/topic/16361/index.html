<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Task bar size/location - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16361" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16361">Task bar size/location</a></p>
   <div class="post" id="post-127085">
    <div class="subject"><a href="#post-127085">Task bar size/location</a></div>
    <div class="body">I'm currently trying to port an old 16-bit DOS program to Windows full screen in 800x600 mode. When starting from 640x480 mode and switching to 800x600 within the program with the ChangeDisplaySettings function, the Windows task bar gets in the work area unless I create the window with the EX_TOPMOST style. But then I have no access to the task bar. <br /><br />I've been trying to relocate the task bar with the SHAppBarMessage function without any success. I got the task bar handle with the ABM_GETAUTOHIDEBAR parameter and inserted it in the APPBARDATA struc. Using the ABM_GETTASKBARPOS parameter, I can get the current position of the task bar (although the top left horizontal value is returned as 0FEFFFFFFh, other data being seemingly correct). Modifying that data for the 800x600 mode and calling the function with the ABM_SETPOS parameter has been ineffective. <br /><br />The task bar refuses to move regardless of what I try with the SHAppBarMessage function. Any suggestion on which other function would be effective???<br /><br />Any help will be appreciated <br /><br />Raymond</div>
    <div class="meta">Posted on 2003-12-08 20:28:33 by Raymond</div>
   </div>
   <div class="post" id="post-127138">
    <div class="subject"><a href="#post-127138">Task bar size/location</a></div>
    <div class="body">Hi Raymond,<br /><br />From the way I read it the docs say &quot;ABM_SETPOS Sets the size and screen position of an appbar. &quot; but Windows definitely distinguishes between an AppBar and the TaskBar:<br /><br /><div class="quote">An application desktop toolbar(also called an appbar) is a window that is similar to the Microsoft? Windows? taskbar.</div><br /><br />Are you sure that you can set the &quot;TaskBar&quot; position using the AppBar message ? I know you can use the SHAppBarMessage message to get the position of the TaskBar but I thought that was only to allow you to properly position your AppBar so it would not be obscured. I have a feeling that you are not using the right function, I will try to find an interface that explicitly says it is for the task bar.<br /><br />BTW: testing this is annoying. Now my screen has a 28 pixel border around it and I am trying to find a way to reset it :) You can use the SystemParametersInfo to set the works area of the screen but that doesn't seem to move the taskbar, just sort of reserves space for it.</div>
    <div class="meta">Posted on 2003-12-09 09:39:20 by donkey</div>
   </div>
  </div>
 </body>
</html>