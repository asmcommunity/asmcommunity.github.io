<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Its AlIvE - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9312" />
  <link rel="prev" href="../?id=9312&amp;page=1" />  <link rel="next" href="../?id=9312&amp;page=3" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=9312">Its AlIvE</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=9312&amp;page=1" style="">&laquo;</a><a href="../?id=9312&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="9312" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=9312&amp;page=3">&gt;</a><a href="../?id=9312&amp;page=3">&raquo;</a></form>   <div class="post" id="post-69605">
    <div class="subject"><a href="#post-69605">Its AlIvE</a></div>
    <div class="body">BTW I forgot to mention the error I am getting on the ISpObjectTokenCategory_SetId call is:<br /> 800703e6 (Invalid access to memory location.)<br />I don't know why yet but I'll save it for tomorrow.</div>
    <div class="meta">Posted on 2002-12-06 20:09:23 by Wayne</div>
   </div>
   <div class="post" id="post-69608">
    <div class="subject"><a href="#post-69608">Its AlIvE</a></div>
    <div class="body">I might know why... <br /><br />Do you have the Speech control panel installed (you should), and if you do, does it look like &quot;Image #1&quot; below:</div>
    <div class="meta">Posted on 2002-12-06 20:13:50 by NaN</div>
   </div>
   <div class="post" id="post-69609">
    <div class="subject"><a href="#post-69609">Or like &quot;Image #2&quot; Below:</a></div>
    <div class="body">.</div>
    <div class="meta">Posted on 2002-12-06 20:14:38 by NaN</div>
   </div>
   <div class="post" id="post-69611">
    <div class="subject"><a href="#post-69611">Its AlIvE</a></div>
    <div class="body">You should have #2.. (i hope) cause its the SAPI 5 Control Panel.  If you have Image #1, you have the SAPI 4 control panel.  Which for some reason not understood by me, Microsoft decided to not superceed the SAPI 4, but still develop SAPI 5 as a &quot;new&quot; SAPI.   The SAPI.COM file that i transcribed is the SAPI 5 file.<br /><br />However, this maybe me touting hot air, cause the very nature of GUID's insist that the interaces be unique.....???<br /><br />Confused... Wish the DDK included info on how to poperly distribute this stuff....<br /><br />NaN</div>
    <div class="meta">Posted on 2002-12-06 20:20:18 by NaN</div>
   </div>
   <div class="post" id="post-69613">
    <div class="subject"><a href="#post-69613">Its AlIvE</a></div>
    <div class="body">Speech Panel is like Image#2.<br />I have the following Directories:<br />C:\Program Files\Common Files\Microsoft Shared\Speech\1033<br />C:\Program Files\Common Files\Microsoft Shared\SpeechEngines\TTS</div>
    <div class="meta">Posted on 2002-12-06 20:25:51 by Wayne</div>
   </div>
   <div class="post" id="post-69614">
    <div class="subject"><a href="#post-69614">Its AlIvE</a></div>
    <div class="body">Afternoon, Nan.<br /><br />I'm getting the same error as Wayne.<br /><br />I have SAPI 5.1 installed.<br /><br />Since you posted this thread, I've begun mucking about with SAPI 5 in a C++ proggy I'm building.<br />The code is based upon the Coffee01 and 02 examples.<br />So far, there hasn't been a problem. I can now tell the 'puter to move an object up/down/left/right.<br />Also implemented is the text-to-speech stuff, so the proggy welcomes the user to the application, and gives audio(speech) feedback on all voice commands.<br /><br />It'll be interesting to find out why your examples are failing. The GUIDs *are* the same, so it *should* be working, dammit:mad: <br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2002-12-06 20:30:43 by Scronty</div>
   </div>
   <div class="post" id="post-69617">
    <div class="subject"><a href="#post-69617">Its AlIvE</a></div>
    <div class="body">Check the LL Macro??<br /><br />Change the code to DYNAMICALLY do MuiltByteToWideChar and create a unicode string... Cause The Token is gotten using this data... (u_TokenIn).<br /><br />(( If you have the SDK, i based this first version (essentiall) off the &quot;SimpleDict&quot; source))<br /><br />Also, note that there is tutorial/descriptions in the SAPI5.CHM file for the Coffee Series of examples.<br /><br />((( Oddest part is, even with my COM macro fixed, i still get no errors? )))<br /><br />:NaN:</div>
    <div class="meta">Posted on 2002-12-06 20:44:07 by NaN</div>
   </div>
   <div class="post" id="post-69621">
    <div class="subject"><a href="#post-69621">Its AlIvE</a></div>
    <div class="body">Afternoon, Nan.<br /><br />Just checked it with dynamic code between posts.<br />Same result/error:/<br /><br />I just had a little comparison between the coffee code and your example (as you say...based upon the SimpleDict source).<br /><br />Seems to be quite a difference in how the thing is set up.<br />i.e. in my (C++) code, it's set up as (comments and error checking cut out):<br /><pre><code>g_cpEngine.CoCreateInstance&#40;CLSID_SpSharedRecognizer&#41;;<br />g_cpEngine-&gt;CreateRecoContext&#40; &amp;g_cpRecoCtxt &#41;;<br />g_cpRecoCtxt-&gt;SetNotifyWindowMessage&#40; hWnd, WM_RECOEVENT, 0, 0 &#41;;<br />g_cpRecoCtxt-&gt;SetInterest&#40; SPFEI&#40;SPEI_RECOGNITION&#41;, SPFEI&#40;SPEI_RECOGNITION&#41; &#41;;<br />g_cpRecoCtxt-&gt;CreateGrammar&#40;GRAMMARID1, &amp;g_cpCmdGrammar&#41;;<br />g_cpCmdGrammar-&gt;LoadCmdFromResource&#40;NULL, MAKEINTRESOURCEW&#40;IDR_CMD_CFG&#41;,<br />                                                 L&quot;SRGRAMMAR&quot;, MAKELANGID&#40;LANG_NEUTRAL, SUBLANG_NEUTRAL&#41;,<br />                                                 SPLO_DYNAMIC&#41;;<br />g_cpCmdGrammar-&gt;SetRuleState&#40;NULL, NULL, SPRS_ACTIVE &#41;;</code></pre><br /><pre><code>cpRecoEngine.CoCreateInstance&#40;CLSID_SpInprocRecognizer&#41;;<br />cpRecoEngine-&gt;CreateRecoContext&#40; &amp;m_cpRecoCtxt &#41;;<br />m_cpRecoCtxt-&gt;SetNotifyWindowMessage&#40; hDlg, WM_RECOEVENT, 0, 0 &#41;;<br />m_cpRecoCtxt-&gt;SetInterest&#40;ullInterest, ullInterest&#41;;<br />SpCreateDefaultObjectFromCategoryId&#40;SPCAT_AUDIOIN, &amp;cpAudio&#41;;<br />cpRecoEngine-&gt;SetInput&#40;cpAudio, TRUE&#41;;<br />cpRecoEngine-&gt;SetRecoState&#40; SPRST_ACTIVE &#41;;<br />m_cpRecoCtxt-&gt;CreateGrammar&#40; GID_DICTATION, &amp;m_cpDictationGrammar &#41;;<br />m_cpDictationGrammar-&gt;LoadDictation&#40;NULL, SPLO_STATIC&#41;;<br />m_cpDictationGrammar-&gt;SetDictationState&#40; SPRS_ACTIVE &#41;;</code></pre><br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2002-12-06 20:52:52 by Scronty</div>
   </div>
   <div class="post" id="post-69622">
    <div class="subject"><a href="#post-69622">Its AlIvE</a></div>
    <div class="body">It Lives !!! or listens anyway.<br /><br />Using MuiltByteToWideChar to build the UNICODE string did the trick. Everything seems to be working fine.<br /><br />Cool !<br /><br />Thanks Wayne</div>
    <div class="meta">Posted on 2002-12-06 21:03:33 by Wayne</div>
   </div>
   <div class="post" id="post-69624">
    <div class="subject"><a href="#post-69624">Its AlIvE</a></div>
    <div class="body">Afternoon, Nan.<br /><br />dammit!<br /><br />WideCharToMuiltByte  != MuiltByteToWideChar .<br /><br />Listens also. Doesn't shutdown correctly though.<br />I have the mic coming out of the headphone speakers so that I can tell if it works or not.<br />The mic feedback switches off now, however it doesn't come back on after the applcation is closed.<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2002-12-06 21:13:58 by Scronty</div>
   </div>
   <div class="post" id="post-69625">
    <div class="subject"><a href="#post-69625">Its AlIvE</a></div>
    <div class="body">Afternoon, Nan.<br /><br />Yep. Works fine now :grin: .<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2002-12-06 21:19:11 by Scronty</div>
   </div>
   <div class="post" id="post-69627">
    <div class="subject"><a href="#post-69627">Its AlIvE</a></div>
    <div class="body">Like i said, i followed the SimpleDict example.  (simple dictation)<br /><br />This was before there was also a second recognition context type (Command an Control).   As well, for some reason beyond me, their example uses the InProcRecognizer, instead of the SharedRecognizer.  <br /><br />If you go thu the tutorials, it mentions the difference (basically the scope of control over the Microphone), however, if you use InProc, you have to do alot of setup stuff, like the Token business yourself.  If you choose the SharedRecognizer, it will do all this stuff automatically.<br /><br />I didnt find these tuts until i finished transcribing SimpleDict, or I too would have started with Coffee1 + 2.<br /><br />So this is why there is a dramatic difference in code...<br /><br />As for your error, I dunno...  seems Wayne got it working..  What is your OS type?<br /><br />As well, im surprised Wayne cant access a unicode string from the .data section.  (invalid memory type error??).   Wayne, did you alloc memory off the heap for the DYNAMIC result, or did you just guess and make a rather large buffer in the .data segment?<br /><br />Thanx both of you for you help so far!<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-12-06 21:32:04 by NaN</div>
   </div>
   <div class="post" id="post-69634">
    <div class="subject"><a href="#post-69634">Its AlIvE</a></div>
    <div class="body">Afternoon, Nan.<br /><br />It's working fine now (except for the audio feedback from the mic in the speakers not coming back on).<br /><br />I just did another check of the code.<br /><br />I took out the dynamic code, and just put:<br /><pre><code>.data<br />         UNI_AudioIn   UNICODE_TEXT <br />                %LL SPCAT_AUDIOIN <br />                dw 0 <br />.code<br />     ole32 pTokenCategory, ISpObjectTokenCategory_SetId, offset UNI_AudioIn, FALSE<br />     IF_COM_ERROR 'Failed to Set Audio ID from Unicode Registry Key'</code></pre><br />...and it worked fine:) .<br /><br />So the problem actually lies in where &quot;u_AudioIn&quot; is plcaed, *or* there's a problem where those macros are used (UNICODE_TEXT or  %LL ).<br /><br />Oh...and I'm on XP prof.<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2002-12-06 21:53:31 by Scronty</div>
   </div>
   <div class="post" id="post-69636">
    <div class="subject"><a href="#post-69636">Its AlIvE</a></div>
    <div class="body">I bet i know the problem (me grins)<br /><br />I remember reading somewhere that NT os's like to have their kernal stuff alligned on DWORD boundries.  I bet if you put:  ALIGN 4 before the macro it will work...<br /><br />Or maybe im smoking crack, and i simply forgot :)<br />:nAn:</div>
    <div class="meta">Posted on 2002-12-06 22:00:38 by NaN</div>
   </div>
   <div class="post" id="post-69637">
    <div class="subject"><a href="#post-69637">Its AlIvE</a></div>
    <div class="body">Afternoon, Nan.<br /><br />Just moved:<pre><code>         u_AudioIn   UNICODE_TEXT<br />                     %LL SPCAT_AUDIOIN<br />                     dw 0</code></pre> inside the <strong>sr.inc</strong> file, up until it's at the beginning of the .data section.<br /><br />Works fine, again.<br /><br />Just seems to fail if it's defined lower down in the .data section.<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2002-12-06 22:01:38 by Scronty</div>
   </div>
   <div class="post" id="post-69638">
    <div class="subject"><a href="#post-69638">Its AlIvE</a></div>
    <div class="body">Afternoon, Nan.<br /><br /><div class="quote"><br />I bet i know the problem (me grins)<br /><br />I remember reading somewhere that NT os's like to have their kernal stuff alligned on DWORD boundries.  I bet if you put:  ALIGN 4 before the macro it will work...<br /><br />Or maybe im smoking crack, and i simply forgot :)<br />:nAn: </div><br />:alright: <br />Yep!<br />That's what the problem was :)<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2002-12-06 22:10:23 by Scronty</div>
   </div>
   <div class="post" id="post-69642">
    <div class="subject"><a href="#post-69642">Its AlIvE</a></div>
    <div class="body">Thanx.. i will try and work this into the macro...</div>
    <div class="meta">Posted on 2002-12-06 22:58:16 by NaN</div>
   </div>
   <div class="post" id="post-69844">
    <div class="subject"><a href="#post-69844">Its AlIvE</a></div>
    <div class="body">For your Enjoyment, i should have a translated Coffee2 ready before the day is up..  With full commenting etc. etc. :)<br /><br />NaN</div>
    <div class="meta">Posted on 2002-12-08 09:26:47 by NaN</div>
   </div>
   <div class="post" id="post-69957">
    <div class="subject"><a href="#post-69957">It didn't work</a></div>
    <div class="body">hi NaN,<br />the program crashed and gave me:<br /><img src="fault.bmp" /></div>
    <div class="meta">Posted on 2002-12-09 00:28:33 by amr</div>
   </div>
   <div class="post" id="post-69963">
    <div class="subject"><a href="#post-69963">Its AlIvE</a></div>
    <div class="body">Crashed on me too.:( <br />I am using XP Pro.<br /><br />I have the SAPI 4.0 runtime support ,speech recognition and sppech control panel installed from this page which you gave a link to- <br /><a target="_blank" href="http://www.microsoft.com/msagent/downloads.htm">http://www.microsoft.com/msagent/downloads.htm</a> <br /><br />Hell, i even downloaded the Speech Sdk 5.1.:)</div>
    <div class="meta">Posted on 2002-12-09 00:55:06 by clippy</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=9312&amp;page=1" style="">&laquo;</a><a href="../?id=9312&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="9312" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=9312&amp;page=3">&gt;</a><a href="../?id=9312&amp;page=3">&raquo;</a></form>  </div>
 </body>
</html>