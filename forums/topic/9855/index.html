<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Neural Networks: I need a bit of help understading - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9855" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=9855">Neural Networks: I need a bit of help understading</a></p>
   <div class="post" id="post-73401">
    <div class="subject"><a href="#post-73401">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">Well i have checked the past few posts of nn in here and even the essay at generation5 and a few more sites but i still dont seem to get it.  Its probably the maths which is making it so tough for me.<br /><br />Lets take the XOR example. <br />Why does it use 3 perceptrons?<br />When it only has to adjust weights of the neurons till we get the least error why do we need 3 of them? Why not only 1?<br /><br />I get the delta calculation part but dont seem to get the weight adjustion part.<br />This is the bit of wight adjustion code from the XOR example at generation 5<br /><br /><pre><code><br />&#91;COLOR=green&#93;// Now, alter the weights accordingly.&#91;/COLOR&#93; <br />float v1 = i1, v2 = i2;<br />   for&#40;int i=0;i&lt;3;i++&#41; &#123;<br />     &#91;COLOR=green&#93;//Change the values for the output layer, if necessary.&#91;/COLOR&#93; <br />      if &#40;i == 2&#41; &#123;<br />         v1 = i3;<br />         v2 = i4;<br />      &#125;<br />				<br />      m_fWeights&#91;0&#93;&#91;i&#93; += BP_LEARNING*1*deltas&#91;i&#93;;<br />      m_fWeights&#91;1&#93;&#91;i&#93; += BP_LEARNING*v1*deltas&#91;i&#93;;<br />      m_fWeights&#91;2&#93;&#91;i&#93; += BP_LEARNING*v2*deltas&#91;i&#93;;<br />   &#125;<br /><br /></code></pre> <br /><br />What exactly is it doing? Why is it that at i=2, the values are changed?<br />If someone wants to take a look at a more code from the example i can post it.<br /><br />I am abosolutly confused as you can see. Can someone please explain a bit?</div>
    <div class="meta">Posted on 2002-12-30 06:34:24 by clippy</div>
   </div>
   <div class="post" id="post-73410">
    <div class="subject"><a href="#post-73410">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">First here's the way I always looked at things; in a three layer net there are only really two layers of neurons, the hidden and output layers. The input layer is simply an array of values which are fed into the hidden layer. <br /><br />Now, you've gottten up to the stage up deltas calculated and now you want to modify the weights. What you need is a loop which goes through all the neurons, not even in any paticular order. <br /><br />For each neuron you'll want to loop through its weights, for each one you modify the weights in the same way. Get the delta of the neuron it feeds inputs to, multiply that by the learning coefficient, multiply that by the output of the neuron that feeds into the weight (ie the one in the previous layer) and add the result to the weight.<br /><br />Now regarding to code, I think v1 &amp; v2 represent the outsput of the previous layer, initially their set to i1, i2, probably the inputs to the net, for the output layer they're changed to i3 &amp; i4, probably the output of the hidden layer. All in all it seem to be a very badly written bit of code. But I could be completly mistaken here.</div>
    <div class="meta">Posted on 2002-12-30 07:48:42 by EÃ³in</div>
   </div>
   <div class="post" id="post-73412">
    <div class="subject"><a href="#post-73412">Re: Neural Networks: I need a bit of help understading</a></div>
    <div class="body"><div class="quote"><em>Originally posted by gladiator </em><br />When it only has to adjust weights of the neurons till we get the least error why do we need 3 of them? Why not only 1?<br /></div><br />Just try it :) !<br />A perceptron has two inputs, a bias input (always 1 iirc), an output and a weight for all 3 inputs. So the weighted sum will be:<br />sum = weight1 * input1 + weight2 * input2 + weight3 * 1<br />The sum will get through a hard-limiter (sum &lt;= x --&gt; output=0, sum &gt;x --&gt; output =1).<br />Now try to find weight1, weight2 weight 3 and x so that the output will be input1 xor input2. You would find it's impossible. <br /><br />You've seen generation5's essays already but this problem is clearly explained on this page <a target="_blank" href="http://www.generation5.org/perceptron.shtml">http://www.generation5.org/perceptron.shtml</a> . <br /><br />Thomas</div>
    <div class="meta">Posted on 2002-12-30 07:53:46 by Thomas</div>
   </div>
   <div class="post" id="post-73640">
    <div class="subject"><a href="#post-73640">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">Thomas,<br />   I get that the problem has to be linearly separable for the perceptrons to be able to solve it.<br />Now one may determine the number of perceptrons to use in a simple XOR program but how do u do so in large problems like your digital brain example?<br /><br />How did you know the number of perceptrons to use in your digital brain?</div>
    <div class="meta">Posted on 2002-12-31 03:11:40 by clippy</div>
   </div>
   <div class="post" id="post-73676">
    <div class="subject"><a href="#post-73676">Neural Networks: I need a bit of help understading</a></div>
    <div class="body"><div class="quote"><em>Originally posted by gladiator </em><br />I get that the problem has to be linearly separable for the perceptrons to be able to solve it.<br /></div><br />Yes with one perceptron, the problem has to be linearly separable, but with multiple it doesn't have to be.<br /><br /><div class="quote">Now one may determine the number of perceptrons to use in a simple XOR program but how do u do so in large problems like your digital brain example?<br />How did you know the number of perceptrons to use in your digital brain?</div><br /><br />Mostly trial and error :), with a very low number of neurons, recognition is afwul, with too many, it's too hard to train it. I just tried out some values and looked what worked best..<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-12-31 07:39:40 by Thomas</div>
   </div>
   <div class="post" id="post-73841">
    <div class="subject"><a href="#post-73841">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">This is indeed &quot;the problem&quot; with Neural Nets : &quot;there is no mathematical sure way to find the best layout for the neurons in order to solve a problem&quot;<br /><br />This fact together with &quot;the XOR problem&quot; have made researchers ignore NN for about 20years (not anymore).<br /><br />However if you &quot;think&quot; with your intuition and follow some obviouse rules that emerge from experience (and trial and error of course) you will soon understand that:<br /><br />-1) almost any layout will do... yes some will learn faster and some will learn slower but basically ANY  decent layout will do! (not exagerated/denaturated) <br /><br />2) If you want to resolve ONLY one specific problem then there are obvoiuse better layouts. For example image recognition uses more like a matrix with improved vertical and horizontal connections while speech recognition needs a more horizontal (aka time) oriented network.<br /><br />The big big problem is how to learn the network not necesarly the layout, and you will loose a lot of time with learning it, also the data sets and algorithms used for learning need to be very well choosen. You must never forget to present denaturated absurd data to the network from time to time (after each lerning cycle) to check its reponse it is still decent (like: &quot;unknown&quot;)<br /><br />However nature did the same thing; tiral an error (i guess) and after many years we are left with a brain that is able to theoreticaly have more potential connections that Universe is able to have atoms...so... when researchers will achieve that ... we as a humman race are obsolete... so do not hurry :)</div>
    <div class="meta">Posted on 2003-01-01 07:59:51 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-78245">
    <div class="subject"><a href="#post-78245">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">Sorry my 'extremly' late reply on this thread.  I had left neural networks in the middle for a while.<br /><br />Before i continue, thank you eoin, thomas and bodgan ontanu for helping me so far :)<br /><br />Eoin,<br /><div class="quote"><em><strong> originally posted by eoin</strong></em><br />Now regarding to code, I think v1 &amp; v2 represent the outsput of the previous layer, initially their set to i1, i2, probably the inputs to the net, for the output layer they're changed to i3 &amp; i4, probably the output of the hidden layer. All in all it seem to be a very badly written bit of code. But I could be completly mistaken here.</div> <br />You are pretty right. Here is the full code for training the network.<br /><br /><pre><code><br />&#91;color=blue&#93;float&#91;/color&#93; m_fWeights&#91;3&#93;&#91;3&#93;;     &#91;color=green&#93; // Weights for the 3 neurons.&#91;/color&#93;<br />&#91;color=blue&#93;float&#91;/color&#93; Sigmoid&#40;&#91;color=blue&#93;float&#91;/color&#93;&#41;;        &#91;color=green&#93;// The sigmoid function.&#91;/color&#93;<br /><br />&#91;COLOR=red&#93;&#91;b&#93;READ THIS FIRST&#58;&#91;/b&#93; the weights for each neuron are arranged in rows, &#91;b&#93;not &#91;/b&#93; the columns.<br />That is, they are arranged vertically, &#91;b&#93;not&#91;/b&#93; horizontally.<br />The programmer at generation5 explains this by saying he is a &#91;b&#93;visual &#91;/b&#93;programmer&#58;rolleyes&#58; <br />&#91;/COLOR&#93; <br /><br />&#91;color=blue&#93;float&#91;/color&#93; Train&#40;&#91;color=blue&#93;float&#91;/color&#93; i1, &#91;color=blue&#93;float&#91;/color&#93; i2, &#91;color=blue&#93;float&#91;/color&#93; d&#41; &#123;<br />	&#91;color=green&#93;// These are all the main variables used in the <br />	// routine. Seems easier to group them all here.&#91;/color&#93;<br />	&#91;color=blue&#93;float&#91;/color&#93; net1, net2, i3, i4, out;<br />	<br />	&#91;color=green&#93;// Calculate the net values for the hidden layer neurons.&#91;/color&#93;<br />	net1 = 1 * m_fWeights&#91;0&#93;&#91;0&#93; + i1 * m_fWeights&#91;1&#93;&#91;0&#93; +<br />		  i2 * m_fWeights&#91;2&#93;&#91;0&#93;;<br />	net2 = 1 * m_fWeights&#91;0&#93;&#91;1&#93; + i1 * m_fWeights&#91;1&#93;&#91;1&#93; +<br />		  i2 * m_fWeights&#91;2&#93;&#91;1&#93;;<br /><br />	&#91;color=green&#93;// // Use the hardlimiter function - the Sigmoid.&#91;/color&#93;<br />	i3 = Sigmoid&#40;net1&#41;;<br />	i4 = Sigmoid&#40;net2&#41;;<br /><br />	&#91;color=green&#93;// Now, calculate the net for the final output layer.&#91;/color&#93;<br />	net1 = 1 * m_fWeights&#91;0&#93;&#91;2&#93; + i3 * m_fWeights&#91;1&#93;&#91;2&#93; +<br />	   	  i4 * m_fWeights&#91;2&#93;&#91;2&#93;;<br />	out = Sigmoid&#40;net1&#41;;<br /><br />&#91;color=green&#93;	// We have to calculate the deltas for the two layers.<br />	// Remember, we have to calculate the errors backwards<br />	// from the output layer to the hidden layer &#40;thus the<br />	// name 'BACK-propagation'&#41;.&#91;/color&#93;<br />	&#91;color=blue&#93;float&#91;/color&#93; deltas&#91;3&#93;;<br />	<br />	deltas&#91;2&#93; = out*&#40;1-out&#41;*&#40;d-out&#41;;<br />	deltas&#91;1&#93; = i4*&#40;1-i4&#41;*&#40;m_fWeights&#91;2&#93;&#91;2&#93;&#41;*&#40;deltas&#91;2&#93;&#41;;<br />	deltas&#91;0&#93; = i3*&#40;1-i3&#41;*&#40;m_fWeights&#91;1&#93;&#91;2&#93;&#41;*&#40;deltas&#91;2&#93;&#41;;<br /><br />	&#91;color=green&#93;// Now, alter the weights accordingly.&#91;/color&#93;<br />	&#91;color=blue&#93;float&#91;/color&#93; v1 = i1, v2 = i2;<br />	&#91;color=blue&#93;for&#91;/color&#93;&#40;int i=0;i&lt;3;i++&#41; &#123;<br />&#91;color=green&#93;		// Change the values for the output layer, if necessary.&#91;/color&#93;<br />		&#91;color=blue&#93;if &#91;/color&#93;&#40;i == 2&#41; &#123;<br />			v1 = i3;<br />			v2 = i4;<br />		&#125;<br />				<br />		m_fWeights&#91;0&#93;&#91; i&#93; += BP_LEARNING*1*deltas&#91; i&#93;;<br />		m_fWeights&#91;1&#93;&#91; i&#93; += BP_LEARNING*v1*deltas&#91; i&#93;;<br />		m_fWeights&#91;2&#93;&#91; i&#93; += BP_LEARNING*v2*deltas&#91; i&#93;;<br />	&#125;<br /><br />	&#91;color=blue&#93;return&#91;/color&#93; out;<br />&#125;<br /><br /></code></pre><br /><br /><strong><u>My problems</u></strong> - <br /><br />This is the main one really. The back propogation part. I knew i said earlier that i could understand it, but now it seems to me i really cant. So you can see how confused i am-<br /><pre><code><br />&#91;color=green&#93;	// We have to calculate the deltas for the two layers.<br />	// Remember, we have to calculate the errors backwards<br />	// from the output layer to the hidden layer &#40;thus the<br />	// name 'BACK-propagation'&#41;.&#91;/color&#93;<br />	&#91;color=blue&#93;float&#91;/color&#93; deltas&#91;3&#93;;<br />	<br />	deltas&#91;2&#93; = out*&#40;1-out&#41;*&#40;d-out&#41;;<br />	deltas&#91;1&#93; = i4*&#40;1-i4&#41;*&#40;m_fWeights&#91;2&#93;&#91;2&#93;&#41;*&#40;deltas&#91;2&#93;&#41;;<br />	deltas&#91;0&#93; = i3*&#40;1-i3&#41;*&#40;m_fWeights&#91;1&#93;&#91;2&#93;&#41;*&#40;deltas&#91;2&#93;&#41;;<br /><br /></code></pre><br />I cant understand a hell of the above code. There is a formula for the first calculation<br />( delta[2] ) on generation5, but i dont know where they get the rest from and how actually does this back propogation work?:confused: <br /><br /><div class="quote"><em><strong> originally posted by eoin</strong></em><br />First here's the way I always looked at things; in a three layer net there are only really two layers of neurons, the hidden and output layers. The input layer is simply an array of values which are fed into the hidden layer. </div> <br />Now again i am confused. Here there are <strong>actually</strong> three layers and the inputs are in different variables, so what is the 3rd layer used for???:confused: <br /><br />Also if the bias is always supposed to be 1, then why do we use it at all? And if we are supposed to actually change its value then how do we know that its <em>not</em> supposed to be one?:confused:<br /><br /><strong>P.S.</strong> - If you are wondering about the pretty syntax highlighting, i was feeling bored :grin:</div>
    <div class="meta">Posted on 2003-01-25 05:22:03 by clippy</div>
   </div>
   <div class="post" id="post-78247">
    <div class="subject"><a href="#post-78247">Neural Networks: I need a bit of help understading</a></div>
    <div class="body"><div class="quote"><br /><strong><u>My problems</u></strong> - <br /><br />This is the main one really. The back propogation part. I knew i said earlier that i could understand it, but now it seems to me i really cant. So you can see how confused i am-<br /><pre><code><br />&#91;color=green&#93;	// We have to calculate the deltas for the two layers.<br />	// Remember, we have to calculate the errors backwards<br />	// from the output layer to the hidden layer &#40;thus the<br />	// name 'BACK-propagation'&#41;.&#91;/color&#93;<br />	&#91;color=blue&#93;float&#91;/color&#93; deltas&#91;3&#93;;<br />	<br />	deltas&#91;2&#93; = out*&#40;1-out&#41;*&#40;d-out&#41;;<br />	deltas&#91;1&#93; = i4*&#40;1-i4&#41;*&#40;m_fWeights&#91;2&#93;&#91;2&#93;&#41;*&#40;deltas&#91;2&#93;&#41;;<br />	deltas&#91;0&#93; = i3*&#40;1-i3&#41;*&#40;m_fWeights&#91;1&#93;&#91;2&#93;&#41;*&#40;deltas&#91;2&#93;&#41;;<br /><br /></code></pre><br />I cant understand a hell of the above code. There is a formula for the first calculation<br />( delta[2] ) on generation5, but i dont know where they get the rest from and how actually does this back propogation work?:confused: <br /></div><br />The first formula is d = yp(1-yp)(dp - yp). The other two are the same formula applied to different neurons, and is shown on the same page as the first formula (something like dp(q) = xp(q) [ 1 - xp(q)] SUM( w(p+1)(q,i) d(p+1)(i)) (doesn't look very well as plain text :) ). <br />Basically it calculates the weight delta by using the deltas of the previous layer (when going backwards). In the example case this is only one value (deltas[2]) so the sum will only sum one equatation (m_fWeights * deltas[2]). The result is multiplied by xp(q)[1-xp(q)] which is i4 - (1-i4) in this case (same for i3).<br />Any network with more layers or more output nodes will have to sum everything so you can't put it in one statement then (you'll have to use a loop to calculate the sum).<br /> <br /><div class="quote">Also if the bias is always supposed to be 1, then why do we use it at all? And if we are supposed to actually change its value then how do we know that its <em>not</em> supposed to be one?:confused:</div><br />Because the bias is added to the weighted sum, you can 'shift' the output values to a higher or lower range, which might be necessary sometimes to get correct outputs.<br /><br />I don't think its value (1) will ever change, because the weight can change and thus its weighted value can be anything you like.</div>
    <div class="meta">Posted on 2003-01-25 05:41:08 by Thomas</div>
   </div>
   <div class="post" id="post-78899">
    <div class="subject"><a href="#post-78899">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">Hi thomas,<br />  Sorry again for the late reply.<br /><br />My one question is still left of the three layers.<br /><br />As eoin said<br /><div class="quote"><br />in a three layer net there are only really two layers of neurons, the hidden and output layers. </div><br />So why is this array of three layers?<br /><pre><code>float m_fWeights&#91;3&#93;&#91;3&#93;;</code></pre><br /><br /> Whats the use of the third layer when  the input is already in another different variables?</div>
    <div class="meta">Posted on 2003-01-29 02:15:29 by clippy</div>
   </div>
   <div class="post" id="post-78947">
    <div class="subject"><a href="#post-78947">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">Hi Gladiator, sorry if I confused you. <br /><br />What I ment was that thee is only need for two layers of neurons. Only the hidden layer and output layer have bias and inputs for each neuron. The input layer simply represents a vector (array basically) of inputs. <br /><br />However having an input layer of neurons as well and physically inserting the desired input vector into the outputs of the input neurons can simplify coding, espicially if a very OOP approach has been taken.<br /><br />I don't think that XOR net is the greatest example to work from, its too specific to that problem (or rather I should say, to that Net Layout) <a target="_blank" href="http://www.geocities.com/CapeCanaveral/1624/bpn.html">this</a> may be more helpful.</div>
    <div class="meta">Posted on 2003-01-29 07:26:45 by EÃ³in</div>
   </div>
   <div class="post" id="post-79175">
    <div class="subject"><a href="#post-79175">Neural Networks: I need a bit of help understading</a></div>
    <div class="body"><div class="quote"><br />Hi thomas,<br />  Sorry again for the late reply.<br /><br />My one question is still left of the three layers.<br /><br />As eoin said<br /><br />So why is this array of three layers?<br /><pre><code>float m_fWeights&#91;3&#93;&#91;3&#93;;</code></pre><br /><br /> Whats the use of the third layer when  the input is already in another different variables? </div><br /><br />The m_fWeights[3][3] contains two weights and one bias for three neurons. That is (2+1)*3 = 3*3 weights. There is no topology information there at all.</div>
    <div class="meta">Posted on 2003-01-30 09:42:31 by gliptic</div>
   </div>
   <div class="post" id="post-79838">
    <div class="subject"><a href="#post-79838">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">Thanks eoin and gliptic:)<br /><br />eoin,<br />  I am looking at the link you gave me.<br />I must say I cant make much out of it.:)<br /><br />I will post specific questions when i find them.</div>
    <div class="meta">Posted on 2003-02-04 01:21:19 by clippy</div>
   </div>
   <div class="post" id="post-79869">
    <div class="subject"><a href="#post-79869">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">Here's how a trianing loops works. Its probably better if you simply try and program it yourself, its very hard to follow this stuff.<br /><br /><strong>Calculating Deltas</strong><br /><br />You start off  by calculating the deltas for the output layer. <br /><br />Delta = Output(1 - Output)(Desired - Output)<br /><br />After that you'll propagate those deltas backwards. This basically means you start with the first neuron on the 2nd last layer and perform the quick calculation to prepare for the delta value<br /><br />preDelta = Output(1 - Output)<br /><br />Then you need to cycle through the Output weights for that neuron and for each one multiply that weight and the delta of the neuron it points to by the preDelta value. <br /><br />Once you gone through all the weights you the preDelta will be the actual Delta value. Do that for every neuron on the layer then move down to the layer below it and repeat the process.<br /><br /><strong>Weights and Bias.</strong><br /><br />Go to the first neuron on the output (last) layer and enter a loop which will cycle through its input weights. <br /><br />For each weight take the neurons delta multiplied by the learning coefficient and multiply that by the output of the neuron which feeds into that weight on the lower layer. Add this value to the weight.<br /><br />Repeat for all the weights that feed into the neuron. For the bias it's a similar process but there is no output from a previous layer so just take neurons delta multiplied by the learning coefficient and add that to the bias.<br /><br />Then move down a layer and repeat the process. You don't go through this for the input layer as it doesn't have input weights or bias. This is the reason why technically the input layer isn't a layer of neurons, though depending on your style it can make programming easier if you pretend it is.<br /><br /><strong>Note on Weights</strong><br /><br />For me the main confusion in these nets came from understanding the layout of the weights. So I'll try and explain it here.<br /><br />Between two layers there are the weights which connect the layers. These are usually stored as a 2d array in two possible layouts. Weight(1,1) is the weight which connects neuron 1 in the lower layer to neuron 1 in the upper layer. However weight(1,3) could represent the weight which connects neuron 1 in the lower layer to neuron 3 in the upper layer. <br /><br />In this layout the delta calculating loop which goes through the output weights of neuron 1 in the lower layer is accessing weight(1,j) throughout the loop where j is the counter.<br /><br />However for the weight adjusting loop which modifies the input weights of neuron 1 of the upper layer based on neuron j of the lower layers output is modifying weight(j,1).<br /><br />Hope I made this as clear as I could, it's a tricky subject to get your head around. I've written a couple of backpropagation nets and every time I have to sit back and really think about the weights. But it slowly gets easier.</div>
    <div class="meta">Posted on 2003-02-04 07:39:30 by EÃ³in</div>
   </div>
   <div class="post" id="post-80478">
    <div class="subject"><a href="#post-80478">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">hi eoin,<br />thanks a million for going through the pain of explaining me all this.<br /><br />I think i understand much better now. But as you said, its gonna get absolutly clear when i actually code something using it:)</div>
    <div class="meta">Posted on 2003-02-08 04:16:20 by clippy</div>
   </div>
   <div class="post" id="post-80774">
    <div class="subject"><a href="#post-80774">Neural Networks: I need a bit of help understading</a></div>
    <div class="body">I found this site very useful for learning the basics:<br /><a target="_blank" href="http://www.cogs.susx.ac.uk/users/carlos/doc/FCS-ANN-tutorial.htm">http://www.cogs.susx.ac.uk/users/carlos/doc/FCS-ANN-tutorial.htm</a></div>
    <div class="meta">Posted on 2003-02-09 22:59:09 by huh</div>
   </div>
  </div>
 </body>
</html>