<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Flat scroll bar+listbox - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=28203" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=28203">Flat scroll bar+listbox</a></p>
   <div class="post" id="post-199870">
    <div class="subject"><a href="#post-199870">Flat scroll bar+listbox</a></div>
    <div class="body">How can i add flat scroll bars to the listbox, im using Flat blebleble and everythings fine except fucking thumb, it doesnt move to new position...</div>
    <div class="meta">Posted on 2001-05-28 14:05:00 by trab</div>
   </div>
   <div class="post" id="post-199871">
    <div class="subject"><a href="#post-199871">Flat scroll bar+listbox</a></div>
    <div class="body">Please, More code, Less swearing...

NaN</div>
    <div class="meta">Posted on 2001-05-28 16:00:00 by NaN</div>
   </div>
   <div class="post" id="post-199872">
    <div class="subject"><a href="#post-199872">Flat scroll bar+listbox</a></div>
    <div class="body">ok:

push ID_WINDOW
call enable_flat

enable_flat proc near
	pop	eax
	pop	edx
	push	eax

	push	edx
	push	hWindow
	call	GetDlgItem

	push	0
	push	10
	push	1
	push	SB_VERT
	push	eax

	push	eax

	push	1
	push	FSB_FLAT_MODE 
	push	WSB_PROP_VSTYLE
	push	eax

	push	ESB_ENABLE_BOTH 
	push	SB_BOTH
	push	eax

	push	eax
	call	InitializeFlatSB

	call	FlatSB_EnableScrollBar

	
	call	FlatSB_SetScrollProp

	call	scroll_update


	call	FlatSB_SetScrollRange



	ret

enable_flat	endp


scroll_update proc uses edi esi ebx, hScroll:DWORD

	mov	esi,offset GetSystemMetrics
	mov	edi,offset FlatSB_SetScrollProp

	mov	ebx,hScroll

	push	SM_CXVSCROLL
	call	esi

	push	0
	push	eax
	push	WSB_PROP_CXVSCROLL
	push	ebx
	call	edi

	push	SM_CXHSCROLL
	call	esi

	push	0
	push	eax
	push	WSB_PROP_CXHSCROLL
	push	ebx
	call	edi


	push	SM_CYVSCROLL
	call	esi

	push	0
	push	eax
	push	WSB_PROP_CYVSCROLL
	push	ebx
	call	edi


	push	SM_CYHSCROLL
	call	esi

	push	0
	push	eax
	push	WSB_PROP_CYHSCROLL
	push	ebx
	call	edi


	push	SM_CXHTHUMB
	call	esi

	push	0
	push	eax
	push	WSB_PROP_CXHTHUMB
	push	ebx
	call	edi


	push	SM_CYVTHUMB
	call	esi

	push	1
	push	eax
	push	WSB_PROP_CYVTHUMB
	push	ebx
	call	edi


	ret
scroll_update endp</div>
    <div class="meta">Posted on 2001-06-01 15:32:00 by trab</div>
   </div>
  </div>
 </body>
</html>