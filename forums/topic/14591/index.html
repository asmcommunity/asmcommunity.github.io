<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>PickIconDlg - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14591" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14591">PickIconDlg</a></p>
   <div class="post" id="post-112891">
    <div class="subject"><a href="#post-112891">PickIconDlg</a></div>
    <div class="body">I'm still working on the user interface for my little proggy and am currently enhancing the toolbar. I have drag buttons and customization working but I want the user to be able to select the images on the buttons as well. To this end I want the have an icon picker like the ChooseIcon dialog of the windows shell. I found an API for Win2K+ that will do it for me but it doesn't seem to exist in reality even though it has alot of references on the web and at MSDN (part of the lawsuit settlement API docs)<br /><pre><code>&#91;b&#93;PickIconDlg Function&#91;/b&#93;<br /><br />--------------------------------------------------------------------------------<br /><br />Displays a dialog box that allows a user to select an icon from a module.<br /><br />Syntax<br /><br />int PickIconDlg&#40;          HWND hwnd,<br />    LPWSTR pszIconPath,<br />    UINT cchIconPath,<br />    int *piIconIndex<br />&#41;;</code></pre><br /><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/pickicondlg.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/pickicondlg.asp</a><br /><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnapiover/html/api-overview.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnapiover/html/api-overview.asp</a></div>
    <div class="meta">Posted on 2003-08-03 19:18:36 by donkey</div>
   </div>
   <div class="post" id="post-112892">
    <div class="subject"><a href="#post-112892">PickIconDlg</a></div>
    <div class="body">did you check this thread?<br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=13745">http://www.asmcommunity.net/board/index.php?topic=13745</a></div>
    <div class="meta">Posted on 2003-08-03 19:30:54 by Gunner</div>
   </div>
   <div class="post" id="post-112893">
    <div class="subject"><a href="#post-112893">PickIconDlg</a></div>
    <div class="body">Its there. Testing here on winXP, shell32 contains PickIconDlg.<br />I was able to access it through RosAsm.<br /><br />Is this a lib issue?<br /><br />do a load library , its there</div>
    <div class="meta">Posted on 2003-08-03 19:33:12 by RobotBob</div>
   </div>
   <div class="post" id="post-112896">
    <div class="subject"><a href="#post-112896">PickIconDlg</a></div>
    <div class="body">Hi RobotBob,<br /><br />I don't use libs in this one RobotBob, it's in GoAsm. Libs for the API are not necessary. It probably requires XP as both the GoAsm and MASM versions work fine on my XP box. Ah well, a little too specific.<br /><br />Hi Gunner,<br /><br />Thanks, I had hoped to avoid it for 2K,XP but it looks like I have to write my own or steal yours :)</div>
    <div class="meta">Posted on 2003-08-03 20:38:10 by donkey</div>
   </div>
   <div class="post" id="post-112901">
    <div class="subject"><a href="#post-112901">PickIconDlg</a></div>
    <div class="body">Bah, I give up for now. Thanks for the code Gunner but it would take nearly as much work to convert it to my style as to rewrite it and I like consistency in format and style. Converting it to GoAsm is a little easier but though my main app is written in GoAsm my test platform is MASM (easier to test concepts with .IF/.ENDIF etc...). At any rate this is the masm test platform for now. The dragging is a bit off, I'm trying to find a more accurate way to determine placing the button, any ideas would be appreciated. (RadASM project)<br /><br />EDIT: Well, I decided to get rid of the direct drag stuff and go with the default Shift-drag, there were too many weird things with the direct (no shift) drag.</div>
    <div class="meta">Posted on 2003-08-03 23:31:09 by donkey</div>
   </div>
  </div>
 </body>
</html>