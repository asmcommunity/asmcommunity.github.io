<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Simple MessageBox without any include - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9373" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9373">Simple MessageBox without any include</a></p>
   <div class="post" id="post-69261">
    <div class="subject"><a href="#post-69261">Simple MessageBox without any include</a></div>
    <div class="body">Hello,<br /><br />I make a PE-Protector. If I write the code in the file how can I make a MessageBox with<br />Caption, Text, OK-Button ???<br /><br />It can not include lib files. Only with Code make a MessageBox. Can I make this with<br />Windows API too?<br /><br />Mfg<br />Fred</div>
    <div class="meta">Posted on 2002-12-05 13:20:31 by Fred</div>
   </div>
   <div class="post" id="post-69262">
    <div class="subject"><a href="#post-69262">Simple MessageBox without any include</a></div>
    <div class="body">check out LoadLibrary and GetProcAdress</div>
    <div class="meta">Posted on 2002-12-05 13:23:06 by Delight</div>
   </div>
   <div class="post" id="post-69264">
    <div class="subject"><a href="#post-69264">Simple MessageBox without any include</a></div>
    <div class="body">I wonder how you wanna make a PE protector when you ask that kind of questions :rolleyes: :grin:</div>
    <div class="meta">Posted on 2002-12-05 13:38:30 by bazik</div>
   </div>
   <div class="post" id="post-69271">
    <div class="subject"><a href="#post-69271">Simple MessageBox without any include</a></div>
    <div class="body">Read about pe file format, sections, import tables, etc.  As for Delight's suggestion, you'll still have to add imports for those functions as well which if I understand you right you don't want to have to do.  I would estimate that most commercial programs already import the MessageBox api, although you shouldn't rely on that as it isn't always the case.  Look on Iczelion's site for his PE tuts, and also his source for Code Snippet Creator (which will show you how to programmatically add sections, imports, etc).  Although as bazik said, I too wonder how far you could have possibly gotten along with this project without....<br /><br />enough said,<br />Will</div>
    <div class="meta">Posted on 2002-12-05 14:18:25 by Will</div>
   </div>
   <div class="post" id="post-69274">
    <div class="subject"><a href="#post-69274">Simple MessageBox without any include</a></div>
    <div class="body">The more I think about this....  I lost a bid on the rentacoder site for a contract to code this type of program.  The person specifically wanted it to be coded in masm, and if someone googled for a masm forum this is probably the first site that would come up.  Lately there have been at least 2 threads for people asking about how to code a pe password protector.  This leads me to believe that Fred could very well be the person who under bid me on that job.  :(</div>
    <div class="meta">Posted on 2002-12-05 14:31:35 by Will</div>
   </div>
   <div class="post" id="post-69280">
    <div class="subject"><a href="#post-69280">Simple MessageBox without any include</a></div>
    <div class="body">What? how are you supposed to create a PE-Protector wich beats <br />the competition, when youre asking questions like this? <br /><br />If you really want the answer to your inquires then just steal someone's<br />code OR <img src="http://images.deviantart.com/emoticons/icon_censored.gif" /> <span style="font-size:9px>Sorry, <strong>that</strong> would be illegal. ~ bazik</span> <img src="http://images.deviantart.com/emoticons/icon_censored.gif" /><br />That would probably make your software much better then the rest. ( :rolleyes: )<br /><br />Creating such software means that you need to be better then the competition.<br />Therefore you should come up with something that noone else have already<br />used for a protection scheme. In other words: <em>Use your skills and create something fresh and unique.</em></div>
    <div class="meta">Posted on 2002-12-05 15:15:44 by natas</div>
   </div>
   <div class="post" id="post-69313">
    <div class="subject"><a href="#post-69313">Simple MessageBox without any include</a></div>
    <div class="body">What do you mean by includes?<br /><br />You can always copy the equates to your file, but then you'll still be using the same basic data, just not split out across files (which is done on purpose for modularity, clarity, and maintainence). But if you want to do this without calling any library functions, then you don't seem to understand the Windows OS. You can't even use <strong>LoadLibrary</strong> and <strong>GetProcAddress</strong> because even they at some level must be included...<br /><br />The only way you can interact with windows without some serious back door hacking (which would be way beyond me), is to use the API. Thats what they're there for, and you can't expect to be compatable across service packs, let alone OS versions if you don't use them.<br /><br />Doing a PE protector is probably not the best place to start if these are questions you need to ask.<br /><br />Learn to walk before you try to run, no run is too small a step compared to this.<br />Learn to walk before you try to build an ion propulsion system and fly to another planet...<br /><br />Mirno</div>
    <div class="meta">Posted on 2002-12-05 17:58:15 by Mirno</div>
   </div>
   <div class="post" id="post-69325">
    <div class="subject"><a href="#post-69325">Simple MessageBox without any include</a></div>
    <div class="body">Mirno, he wanted to know how to inject the messagebox code into another program without adding the MessageBox import.</div>
    <div class="meta">Posted on 2002-12-05 18:13:12 by Will</div>
   </div>
   <div class="post" id="post-69327">
    <div class="subject"><a href="#post-69327">Simple MessageBox without any include</a></div>
    <div class="body">.</div>
    <div class="meta">Posted on 2002-12-05 18:17:59 by comrade</div>
   </div>
   <div class="post" id="post-69420">
    <div class="subject"><a href="#post-69420">Simple MessageBox without any include</a></div>
    <div class="body">That IS cool but it would maybe be easier (and safer) to hack the import table (quite tricky).</div>
    <div class="meta">Posted on 2002-12-06 01:09:19 by gliptic</div>
   </div>
   <div class="post" id="post-69449">
    <div class="subject"><a href="#post-69449">Simple MessageBox without any include</a></div>
    <div class="body">no, it would be alot more unstable to do that from the import table.<br />look at comrades source, he uses the the kernel EXPORT table to<br />retrieve the api's he need.  GetProcAddress and LoadLibrary are<br />very important because with those two api's you're virtually free but <br />the only api someone really needs is LoadLibrary... GetProcAddress <br />is simple to rewrite and it could even be extended.<br /><br />fred, there should be dozens of examples floating around here but <br />i would recommend studying this stuff at first.<br /><br />btw, look at <a target="_blank" href="http://drcmda.tripod.com/files/pe_inf_new.txt">this file</a><br />a program that adds messageboxes to other applications. i wrote<br />a better version wich used filemapping but i wasn't able to find it<br />anymore.</div>
    <div class="meta">Posted on 2002-12-06 03:59:26 by mob</div>
   </div>
   <div class="post" id="post-72927">
    <div class="subject"><a href="#post-72927">Simple MessageBox without any include</a></div>
    <div class="body">Mob<br /><br />I looked at &quot;This File&quot; that should add messageboxes to other applications, as you said. I ran the program, opened Dialog.exe (Iczelion?s tutorial 10). <br /><br />A messagebox &quot;TARGET HAS BEEN CHANGED SUCCESFULLY!&quot; appears.<br /><br />Running the Dialog.exe result in an error messagebox:<br /><br />Dialog.exe - Application error<br /><br />&quot;The instruction at &quot;0x004071a8&quot; referenced memory at &quot;0x000fc03c&quot;. The memoty could not be &quot;read&quot;.&quot;<br /><br />The changes I can see is in 7 places <br />In the PE structure <br />1) &quot;The addressOfEntryPoint&quot; from 00001010 to 000070cd and <br />2) &quot;Reserved&quot; 00000000 is replaced with &quot;DANI&quot;. <br /><br />In the binary changes is done <br />3) &quot;CD 00&quot; to &quot;26 02&quot; ...<br />4) insertion of 345 bytes messagebox &quot;HELLO FROM PATCHED HOST...<br />5) insertion of path from the original position of the Dialog.pdb file. Move from the last position of the original exe.<br />6) deletion of 100 byte including the name of the EXE (Dialog.exe)<br />7) deletion of 132 of the last bytes<br /><br />The filesize is also increased by 156 bytes.<br /><br />Have you tested this programm or doesn't it work on win 2000 or what else could be wrong?<br /><br />regards</div>
    <div class="meta">Posted on 2002-12-27 17:16:38 by minor28</div>
   </div>
   <div class="post" id="post-74013">
    <div class="subject"><a href="#post-74013">Simple MessageBox without any include</a></div>
    <div class="body">ohw... that's most probaly due to an error i came across back then when i wrote<br />this. the allignment was wrong... but i thought i fixed this bug in that program. <br />however, in all my newer examples it is definitively fixed... if you're still interested<br />just go to the root url. so, yes it's my fault sorry</div>
    <div class="meta">Posted on 2003-01-02 10:54:45 by mob</div>
   </div>
   <div class="post" id="post-74350">
    <div class="subject"><a href="#post-74350">Simple MessageBox without any include</a></div>
    <div class="body">Mob<br /><br />I can't get the messagebox to work. I have checked and I can't find anything wrong in the code. When seaching &quot;LoadLibraryA&quot; in Kernel32.dll the function name is found but the ordinal is 1EA instead of 1E3 which is the correct ordinal according to &quot;STUD_PE Portable Executables editor&quot;. This means that the seach result in 7 functions to much. If you seach for the first function as &quot;AddAtomA&quot;, AddAtomW&quot; and so on then the ordinals are correct.<br /><br />At seach 5F 0,NTDLL.RtlDeleteCriticalSection,0 is found with &quot;DeleteCriticalSection&quot; (Correct ordinal 5E) before and &quot;DeleteFiber&quot; (correct ordinal 5F) after. There are 7 NTDLL.Rtl..... before &quot;LoadLibraryA&quot; that's why seach ordinal i not correct.<br /><br />Is NTDLL.Rtl... Kernel32.dll functions or what is it.<br /><br />BTW. In my example I use filemapping.<br /><br />Another question. If you allocate memory and reads an exe file to the memory, is it possible to run the program when residing in the memory.<br /><br />Regards</div>
    <div class="meta">Posted on 2003-01-04 17:50:12 by minor28</div>
   </div>
  </div>
 </body>
</html>