<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>brilliant looking (ownerdrawn) window - awful scrollbars - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8900" />
    <link rel="next" href="../?id=8900&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=8900">brilliant looking (ownerdrawn) window - awful scrollbars</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=8900&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=8900&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="8900" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=8900&amp;page=2">&gt;</a><a href="../?id=8900&amp;page=2">&raquo;</a></form>   <div class="post" id="post-65409">
    <div class="subject"><a href="#post-65409">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">hi guys,<br />i started coding an mp3player in asm. the most important thing (besides the ability to play music) is the look. i also created my code for the window (looks fine, indeed) - BUT: if i have in my playlist (a listview control) a lot of songs, a scroll bar is displayed - a default color-scrollbar.<br />the listview gets the colors if i return a brush in eax on WM_CTLCOLOR...., but the WM_CTLCOLORSCROLLBAR does not work so. any possibilities?</div>
    <div class="meta">Posted on 2002-11-11 14:45:32 by hartyl</div>
   </div>
   <div class="post" id="post-65417">
    <div class="subject"><a href="#post-65417">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">If it is a window with WS_VSCROLL style and not a scrollbar control, the WM_CTLCOLORSCROLLBAR message won't work. Even if it is a scrollbar control, you will only be able to change the background color. You can use flat scrollbars, although I think that changing the thumb &amp; button color is complicated even in flat scrollbars. Flat scrollbars cannot be used as common controls, so you have to build a window with the WS_VSCROLL style, and give to this window the dimensions of the scrollbar you want. The best way however, would be to build your own scrollbar from scratch. You can take ideas from James Brown's Cool Scrollbar library: (<a target="_blank" href="">http://freespace.virgin.net/james.brown7/sourcecode.html</a>)</div>
    <div class="meta">Posted on 2002-11-11 15:45:50 by micmic</div>
   </div>
   <div class="post" id="post-65486">
    <div class="subject"><a href="#post-65486">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">i had exactly the same problem... i tried everythingb but it isn't possible unless<br />you change the dll the scrollbar control resides in (like in this coolctrl project). the <br />only thing i got was hide the listview/box scrollbar via subclassing. then i added<br />a &quot;real&quot; scrollbar-CONTROL to it. the last step was directing the scrollbar msg's<br />to the new one (via subclassing, too). but even with a real scrollbar control you<br />can ONLY change the background color :(<br /><br />a month ago i wanted to write my own listview... it worked great but i never<br />finished these darn scrollbars... maybe i implemend them sometime... it shouldn't<br />be such hard... however, you can find the test version <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=7963&amp;highlight=listview">here</a> and a test<br />application <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=8374&amp;highlight=listview">here</a></div>
    <div class="meta">Posted on 2002-11-12 04:11:40 by mob</div>
   </div>
   <div class="post" id="post-65488">
    <div class="subject"><a href="#post-65488">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">hi all, i have a little bit related problem. i had made a flat button in C++, exactly in visual C with MFC. now, i want to made this in masm. and here i am, dont know how to this. i though theres no such thing like lpDrawItemStruct in masm, isnt it? how do i made same subclassing and re-used features in masm?<br />the src code and exe are at <a target="_blank" href="http://www.freewebz.com/daner/button.zip">http://www.freewebz.com/daner/button.zip</a><br /><br />thanks</div>
    <div class="meta">Posted on 2002-11-12 04:40:51 by dion</div>
   </div>
   <div class="post" id="post-65516">
    <div class="subject"><a href="#post-65516">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">lpDrawItemStruct IS defined somewhere... i think it's not in hutch's<br />windows.inc but you can look it up from c++ or from msdn. but it would <br />be way better to create your *own* button with gdi operations. it isn't<br />hard to do and you'll have full control over that thing... there should be<br />hundreds of examples somewhere on this board. just serch for it. oh<br />when i remember right then there's also a little example in the latest<br />masm package.</div>
    <div class="meta">Posted on 2002-11-12 10:18:18 by mob</div>
   </div>
   <div class="post" id="post-65574">
    <div class="subject"><a href="#post-65574">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">hi mob, i had search the board for &quot;flat button&quot; but dont find what i want. actually i know that i have to use SetWindowLong to set own winproc and trap WM_PAINT to do the painting . <br />but, i confused about how if theres lot of button? do these button can have common winproc? because in class, i just to have derived it and solved.<br />anyway, i dont see flat button sample in masm32 package.<br />eh, i just see ur button, hartyl. how do u do that?</div>
    <div class="meta">Posted on 2002-11-12 20:14:14 by dion</div>
   </div>
   <div class="post" id="post-65651">
    <div class="subject"><a href="#post-65651">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">i never worked with flat buttons but in my opinion you just have to set<br />a flag to make it apear flat. there are only a few ways to change the look<br />of a button. flags, customdrawn and ownerdraw. microsoft gives you<br />the possibility to draw a ready-made control on your self, this is called<br />&quot;customdrawn&quot;. in this case windows gives you specific messages that <br />tell you what to do... if i remenber right it was WM_NOTIFY, <br />WM_MEASUREITEM and WM_DRAWITEM. if you respond to these msg's<br />you should be able to draw control specific things on your own... just<br />open up your api ref and look it up. msdn has also dozens of informations<br />on these messages. the 3rd way to draw a control would be to make it<br />fully on your own. i call this method ownerdrawn-control or custom-control<br />but i don't know if there's a better name for it. if you want to do listviews<br />and stuff it's hard work but a custom-button is easy to code. i think these<br />buttons in hartyls example *are* custom ones. in the <a target="_blank" href="http://www.asmcommunity.net/board/attachment.php?s=&amp;postid=61190"></a>  i posted above<br />every control is made by me. please look in the latest masm package, there<br />you'll find 2 nice examples on how to do it. nan, a member of this board,<br />also wrote a wonderfull very easy to understand tutorial on how to code<br />custom controls. all you need is a little understanding on how to operate<br />with the windows gdi functions.</div>
    <div class="meta">Posted on 2002-11-13 08:41:15 by mob</div>
   </div>
   <div class="post" id="post-65670">
    <div class="subject"><a href="#post-65670">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">Maybe you can find some info from here: <a target="_blank" href="http://freespace.virgin.net/james.brown7/tuts/coolscroll.htm">http://freespace.virgin.net/james.brown7/tuts/coolscroll.htm</a></div>
    <div class="meta">Posted on 2002-11-13 10:46:10 by WinCC</div>
   </div>
   <div class="post" id="post-65671">
    <div class="subject"><a href="#post-65671">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">have an mp3 player too :grin: , it plays all the stuff (fmod) but it looks like ****<br />For the Playlist I use LISTBOX-Control... but your playlist is cool :alright: how many time have you invested in it? was it hard? I started coding my player on 25.08.02 and Im still working, have some nice details like INI-File an so on, you can test it on:<br /><br /><a target="_blank" href="http://people.freenet.de/cdw/projekte.htm">http://people.freenet.de/cdw/projekte.htm</a> <br />Exe with DLL:<br /><a target="_blank" href="http://people.freenet.de/cdw/pdmp_ganz.zip">http://people.freenet.de/cdw/pdmp_ganz.zip</a> <br /><br />aktual EXE:<br /><a target="_blank" href="http://people.freenet.de/cdw/pdmp.zip">http://people.freenet.de/cdw/pdmp.zip</a> <br /><br />Can read Winamp 2.75 AND 2.7x playlists... can make them, you can add all files of a directory and so on... <br /><br /><img src="http://people.freenet.de/cdw/pdmp.jpg" /></div>
    <div class="meta">Posted on 2002-11-13 11:11:49 by CDW</div>
   </div>
   <div class="post" id="post-65681">
    <div class="subject"><a href="#post-65681">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">i have done the window some time before (coding a keygen 4 practice), but all the time sonique sucked more and more (it hangs all the time and sometimes my whole system - no i wont use WinAMP...), so i startet this mp3Player.<br />the code is pretty easy: i use DialogBoxParam for my windows (syle: flat, no border, no caption (no captiontext either)) and everytime my dialogproc is called, all params go through my DrawItem-func, which responses on:<br /><br />WM_INITDIALOG (creating brushes, setting the captiontext)<br />WM_LBUTTONDOWN (for window-movement)<br />WM_PAINT (drawing the window)<br />all the WM_CTLCOLOR...-Messages (for the nice colors; if the return-value of DrawItem is !=NULL, the dialogbox returns it too (for brushes)<br />WM_DRAWITEM (every button has the OWNERDRAW-flag (0x0b), so the message is sent and the button drawn)<br /><br />i might post my window-code too. it's even done for easy-colorchaning (color-constants)<br /><br />i think i'll do my own ownerdrawn listbox (like moblist (if anyone knows it), but more steadable and with scrollbars)<br /><br />btw: fmod is great!</div>
    <div class="meta">Posted on 2002-11-13 12:25:47 by hartyl</div>
   </div>
   <div class="post" id="post-65723">
    <div class="subject"><a href="#post-65723">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">thx mob and all. but i know those what u talk already. the problem is do i have to make 3 wndproc for 3 button for example to handle WM_DRAWITEM or can i just have a common  shared with all 3 button? its related to class behaviour, so i dont know what if dont have class. <br /><br />btw, is there any easy way to make resource script to be used with masm? the asmedit was too... impractical ;p<br /><br />thanks</div>
    <div class="meta">Posted on 2002-11-13 20:17:40 by dion</div>
   </div>
   <div class="post" id="post-65796">
    <div class="subject"><a href="#post-65796">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">VC++6.0 ressource editor(the only good thing on it *g*)</div>
    <div class="meta">Posted on 2002-11-14 10:37:15 by CDW</div>
   </div>
   <div class="post" id="post-65807">
    <div class="subject"><a href="#post-65807">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">you dont need 3 wndprocs for your 3 buttons. i solved it like this:<br /><br /><pre><code><br />DlgProc proc hWin&#58;HWND,uMsg&#58;UINT,wParam&#58;WPARAM,lParam&#58;LPARAM<br />  invoke DrawItem,hWin,uMsg,wParam,lParam<br />  test eax,eax<br />  jnz @f<br />    ret<br />  @@&#58;<br />  <br />  &#91;your normal dlg-proc goes here&#93;<br />  ret<br />DlgProc endp<br /><br />DrawItem proc hWin&#58;HWND,uMsg&#58;UINT,wParam&#58;WPARAM,lParam&#58;LPARAM<br />  xor eax,eax<br />  .if uMsg==WM_DRAWITEM<br />    mov esi,lParam<br />    assume esi&#58;ptr DRAWITEMSTRUCT<br />    mov eax,&#91;esi&#93;.CtlType<br />    m2m dc,&#91;esi&#93;.hdc<br />    .if eax==ODT_BUTTON<br />      &#91;draw the button&#93;<br />    .endif<br />    xor eax,eax<br />  .elseif uMsg==WM_CTLCOLOREDIT<br />    mov eax,brush<br />  .elseif uMsg==&#91;and so on&#93;<br />  .endif<br />  ret<br />DrawItem endp<br /></code></pre><br />notice, that if the DrawItem-func returns a value != NULL, the DlgProc returns it too (for the brushes), else the DlgProc does the usual - some message might be handeled twice, but that's no problem.</div>
    <div class="meta">Posted on 2002-11-14 13:23:08 by hartyl</div>
   </div>
   <div class="post" id="post-65958">
    <div class="subject"><a href="#post-65958">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">thanks hartyl and all. i had finished the coding, but still lack some... optimizing and might be has a bug within. <br /><br />when i implement what u said, hartyl, i just thinking for a while about how if i have... <br />say 100 buttons in my app, then how do i manage those all efficiently? there is a proprietary button flag that make i have to using old .if-.elseif switch to choose which flag should be changed. <br />u can see i use this switch case several times in my code. is there any way to simplify this?<br /><br /><br /><br />regards</div>
    <div class="meta">Posted on 2002-11-15 20:23:42 by dion</div>
   </div>
   <div class="post" id="post-65989">
    <div class="subject"><a href="#post-65989">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">I was also working on a MP3 player :grin: <br />Same problems as you (scrollbar) but the rest of the GUI looks nice. Part of the sources can be found here:<br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=6586&amp;highlight=bmp+button">http://www.asmcommunity.net/board/index.php?topic=6586&amp;highlight=bmp+button</a><br />(it has buttons with mouse-over effect ;) )</div>
    <div class="meta">Posted on 2002-11-16 05:31:30 by bazik</div>
   </div>
   <div class="post" id="post-66004">
    <div class="subject"><a href="#post-66004">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">ha! the time of ugly scrollbar's over!<br /><br />i coded a complete listview (almost like the moblist - thx mob!), with a header, multiselect, and the scrollbar. but it's only for my purposes. (it's a list for the mp3s, having a artist, songname and the time. everything written into a struct with a pointer to the next item --&gt; a list). when the player is done, i'll post it. i found out, that its only compatible to Win98 (maybe Win95 too). i don't have Win2k, so i'll see if i find the bug...<br /><br />i didn't know that so many guys want to write a mp3 player (i guess with fmod :) and meet here on the board - but thats nice!</div>
    <div class="meta">Posted on 2002-11-16 07:10:59 by hartyl</div>
   </div>
   <div class="post" id="post-66026">
    <div class="subject"><a href="#post-66026">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">Since im sure its long since gone, i will use this oportunity to offer the tut for distribution again ;)<br /><br /><strong>hartyl</strong>,<br /> If you have your listbox working, why not rip out the scroll bar routines into a separate custom control, for future projects that may not need a listbox....?<br /><br />Anywho, for hartyl and anyone else interested, here is the Tutorial that Mob gave reference to earlier...<br /><br />Enjoy<br />:alright:<br />nAn</div>
    <div class="meta">Posted on 2002-11-16 10:53:08 by NaN</div>
   </div>
   <div class="post" id="post-66028">
    <div class="subject"><a href="#post-66028">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">If you guys are talking about flat scrollbars inside listviews maybe this can help:<br /><br />LVM_FIRST equ 01000h ; This is defined in windows.inc<br /><br />LVS_EX_FLATSB equ 0100h<br />LVM_SETEXTENDEDLISTVIEWSTYLE equ LVM_FIRST + 54<br /><br />... (Create your listview here).....;<br /><br />Then insert this:<br /><br />invoke SendMessage,hListview,LVM_SETEXTENDEDLISTVIEWSTYLE,LVS_EX_FLATSB,LVS_EX_FLATSB<br /><br /><br /><br />cheers,<br /><br />h.</div>
    <div class="meta">Posted on 2002-11-16 11:05:59 by hitchhikr</div>
   </div>
   <div class="post" id="post-66050">
    <div class="subject"><a href="#post-66050">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">flat scrollbars would look good, but i can't use them, since the have still the syscolors and i can't cange em.<br /><br />but i've finnaly implemented the great-looking scrollbar.<br />but i cant distribute it, since it works only in combination with the listview itsself. but the listview was also so implemeted, that it works only for my purpose (the header &amp; the list items).<br />but here an image of the final version:</div>
    <div class="meta">Posted on 2002-11-16 14:38:30 by hartyl</div>
   </div>
   <div class="post" id="post-66052">
    <div class="subject"><a href="#post-66052">brilliant looking (ownerdrawn) window - awful scrollbars</a></div>
    <div class="body">Hartyl, I only see the to of the image (only teh beginning of the scrollbar). Either the image (or window :rolleyes: ) is &quot;broken&quot;, or something else is wrong.<br />Any way, the top of the app is looking nice. :)</div>
    <div class="meta">Posted on 2002-11-16 15:07:39 by scientica</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=8900&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=8900&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="8900" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=8900&amp;page=2">&gt;</a><a href="../?id=8900&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>