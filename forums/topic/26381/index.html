<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Main thread and window of a process - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26381" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26381">Main thread and window of a process</a></p>
   <div class="post" id="post-191333">
    <div class="subject"><a href="#post-191333">Main thread and window of a process</a></div>
    <div class="body">How to get main process thead and it's main window handle?

I'm getting the process from CreateToolhelp32Snapshot/ Process32First/ Process32Next and then OpenProcess</div>
    <div class="meta">Posted on 2001-01-09 22:46:00 by The CHEMI$T</div>
   </div>
   <div class="post" id="post-191334">
    <div class="subject"><a href="#post-191334">Main thread and window of a process</a></div>
    <div class="body">I don't know how to separate the "main" thread from others. You can walk the thread list, comparing each thread's processID with the processID of the process you're interested in. To obtain the list of windows associated with a thread, call EnumThreadWindows. The "main" window is the one that has no parent: call GetParent on every window handle and the one that returns 0 is the main window</div>
    <div class="meta">Posted on 2001-01-10 03:20:00 by Iczelion </div>
   </div>
   <div class="post" id="post-191335">
    <div class="subject"><a href="#post-191335">Main thread and window of a process</a></div>
    <div class="body">Hi !

Get main thread..
handle: GetCurrentThread   (pseudo handle)
ID:     GetCurrentThreadID

regards,
      yoda</div>
    <div class="meta">Posted on 2001-01-10 07:46:00 by yoda </div>
   </div>
   <div class="post" id="post-191336">
    <div class="subject"><a href="#post-191336">Main thread and window of a process</a></div>
    <div class="body"><b>y0da</b>: The CHEMI$T wants to get hold of the main thread in other process.</div>
    <div class="meta">Posted on 2001-01-10 08:16:00 by Iczelion </div>
   </div>
  </div>
 </body>
</html>