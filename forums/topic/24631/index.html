<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>usbenum - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24631" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24631">usbenum</a></p>
   <div class="post" id="post-179825">
    <div class="subject"><a href="#post-179825">usbenum</a></div>
    <div class="body">Here is a small example of USB devices enumeration I ended up putting together last nigh while browsing the ddk documentation. Perhaps it could be useful to someone.<br /><br />p.s. tested on win xp sp2. with two double-port usb hubs. suggestions, comments are very welcomed?&nbsp; :) </div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1572" target="_blank">usbenum.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-04-19 05:46:26 by arafel</div>
   </div>
   <div class="post" id="post-179830">
    <div class="subject"><a href="#post-179830">Re: usbenum</a></div>
    <div class="body">It crashes right after displaying some info about the mouse (USB). I have 3 USB 1.1 hubs and 2 USB 2.0 hubs. 2 (of 3) USB 1.1 hubs are disabled.<br /><br />The attached file is drwatson&#39;s crash dump and console&#39;s output.</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1568" target="_blank">dump.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-04-19 06:33:52 by ti_mo_n</div>
   </div>
   <div class="post" id="post-179831">
    <div class="subject"><a href="#post-179831">Re: usbenum</a></div>
    <div class="body">Crashes here too, after this output:<br /><div class="quote"><br />Host Controler: \\.\HCD0<br /> Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0001<br /> HC ID: PCI\VEN_10DE&amp;DEV_005A&amp;SUBSYS_815A1043&amp;REV_A2\3&amp;2411E6FE&amp;0&amp;10<br /> HC Description: Standard OpenHCD USB Host Controller<br /> Root Hub: \\.\USB#ROOT_HUB#4&amp;35297846&amp;0#{f18a0e88-c30c-11d0-8815-00a0c906bed8<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  Driver Key: {745A17A0-74D3-11D0-B6FE-00A0C90F57DA}\0003<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Device Description: USB Human Interface Device<br /></div><br /><br />nForce4 chipset (in case intel-vs-amd USB host controller standard matters), whole bunch of USB ports, etc.<br /><br />Crash is somewhere in user32 (perhaps some string buffer overflow?)<br /></div>
    <div class="meta">Posted on 2006-04-19 07:03:14 by f0dder</div>
   </div>
   <div class="post" id="post-179833">
    <div class="subject"><a href="#post-179833">Re: usbenum</a></div>
    <div class="body">ok, wasn&#39;t handling correctly devices with null control class code. <br />reattached fixed version. </div>
    <div class="meta">Posted on 2006-04-19 07:28:40 by arafel</div>
   </div>
   <div class="post" id="post-179838">
    <div class="subject"><a href="#post-179838">Re: usbenum</a></div>
    <div class="body">Works now, cheers :)<br /></div>
    <div class="meta">Posted on 2006-04-19 08:01:22 by f0dder</div>
   </div>
   <div class="post" id="post-179848">
    <div class="subject"><a href="#post-179848">Re: usbenum</a></div>
    <div class="body">I could be interpreting the data incorrectly but it looks like it cannot see the devices that are past the hub.&nbsp; It sees the hub okay, though.<br /><br />Paul<br /></div>
    <div class="meta">Posted on 2006-04-19 12:42:22 by PBrennick</div>
   </div>
   <div class="post" id="post-179850">
    <div class="subject"><a href="#post-179850">Re: usbenum</a></div>
    <div class="body">rifleman, do you mean it doesn&#39;t sees any devices at all? or just a particular device connected to an external\integral hub?<br /><br />a console dump + list of devices that you have would be helpful. </div>
    <div class="meta">Posted on 2006-04-19 16:24:31 by arafel</div>
   </div>
   <div class="post" id="post-179851">
    <div class="subject"><a href="#post-179851">Re: usbenum</a></div>
    <div class="body">works fine here, xp sp2.. doesnt list units connected to the usb mass storage device though (ide-&gt;usb connector).. </div>
    <div class="meta">Posted on 2006-04-19 16:43:35 by evlncrn8</div>
   </div>
   <div class="post" id="post-179853">
    <div class="subject"><a href="#post-179853">Re: usbenum</a></div>
    <div class="body">arefel,<br />Here is the output.<br /><br /><div class="quote">D:\Downloads\ASMCommunity\usbenum&gt;usbenum<br />Host Controler: \\.\HCD0<br /> Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0000<br /> HC ID: PCI\VEN_1106&amp;DEV_3038&amp;SUBSYS_80F6104D&amp;REV_1A\3&amp;61AAA01&amp;0&amp;3A<br /> HC Description: VIA Rev 5 or later USB Universal Host Controller<br /> Root Hub: \\.\USB#ROOT_HUB#4&amp;1f96bc4b&amp;0#{f18a0e88-c30c-11d0-8815-00a0c906bed8}<br />  No Device Connected<br />  Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0004<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Device Description: Generic USB Hub<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Class Code Triplet: 0x9,0x0,0x0 (Full speed Hub)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Maximum Packet Size: 8<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Vendor ID: 0x451<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Product ID: 0x2046<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Device Release #: 0x125<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Manufacturer Index: 0x0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Product Index: 0x0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Serial Number Index: 0x0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Possible Configurations #: 1<br />Host Controler: \\.\HCD1<br /> Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0001<br /> HC ID: PCI\VEN_1106&amp;DEV_3038&amp;SUBSYS_80F6104D&amp;REV_1A\3&amp;61AAA01&amp;0&amp;3B<br /> HC Description: VIA Rev 5 or later USB Universal Host Controller<br /> Root Hub: \\.\USB#ROOT_HUB#4&amp;cdd0ba6&amp;0#{f18a0e88-c30c-11d0-8815-00a0c906bed8}<br />  No Device Connected<br />  No Device Connected<br /><br />D:\Downloads\ASMCommunity\usbenum&gt;</div><br /><br />If I am just reading it wrong, I am sorry.&nbsp; One Port is empty.&nbsp; The other port has a hub with a mouse and a memeory stick.<br /><br />Paul<br /></div>
    <div class="meta">Posted on 2006-04-19 17:15:03 by PBrennick</div>
   </div>
   <div class="post" id="post-179859">
    <div class="subject"><a href="#post-179859">Re: usbenum</a></div>
    <div class="body">Paul,<br />Here is updated version which should enumerate external hub devices as well. I haven&#39;t tested it much, since I don&#39;t have an external hub. <br /><br />evlncrn8, <br />Is it an IDE harddrive connected trough USB adapter? If it is, than it should be listed as a mass storage device (info regarding internal drive stuff, size, geometry, etc, wont be displayed). </div>
    <div class="meta">Posted on 2006-04-19 19:22:10 by arafel</div>
   </div>
   <div class="post" id="post-179862">
    <div class="subject"><a href="#post-179862">Re: usbenum</a></div>
    <div class="body">Arafel, would you mind putting a version number in the filename when attaching? Makes it easier to spot new versions :)</div>
    <div class="meta">Posted on 2006-04-19 20:30:18 by f0dder</div>
   </div>
   <div class="post" id="post-179870">
    <div class="subject"><a href="#post-179870">Re: usbenum</a></div>
    <div class="body">Arafel,<br />Did you forget the attachment?<br /><br />Paul<br /></div>
    <div class="meta">Posted on 2006-04-19 21:38:12 by PBrennick</div>
   </div>
   <div class="post" id="post-179871">
    <div class="subject"><a href="#post-179871">Re: usbenum</a></div>
    <div class="body">Paul I have updated the attachment in the first message. Sorry for all the confusion... From now on I&#39;ll just add new attachments in subsequent messages. <br /><br />f0dder, ok, ver. info has been added. </div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1573" target="_blank">usbenum-v1.0.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-04-19 22:28:25 by arafel</div>
   </div>
   <div class="post" id="post-179884">
    <div class="subject"><a href="#post-179884">Re: usbenum</a></div>
    <div class="body">Arafel,<br />Works like a charm, would you like to see a dump?<br />Paul<br /></div>
    <div class="meta">Posted on 2006-04-19 23:36:01 by PBrennick</div>
   </div>
   <div class="post" id="post-179887">
    <div class="subject"><a href="#post-179887">Re: usbenum</a></div>
    <div class="body">yes, yes, please post it :)</div>
    <div class="meta">Posted on 2006-04-19 23:55:50 by arafel</div>
   </div>
   <div class="post" id="post-179905">
    <div class="subject"><a href="#post-179905">Re: usbenum</a></div>
    <div class="body">My dump isn&#39;t extremely exciting, considering I don&#39;t have much stuff attached right now, but here goes :)<br /><br /><div class="quote"><br />E:\temp&gt;usbenum.exe<br />USB devices enumerator v1.0&nbsp; &nbsp; &nbsp; (arafel, tsech@mail.ru)<br /><br />USB Host Controler: \\.\HCD0<br /> Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0001<br /> ID: PCI\VEN_10DE&amp;DEV_005A&amp;SUBSYS_815A1043&amp;REV_A2\3&amp;2411E6FE&amp;0&amp;10<br /> Description: Standard OpenHCD USB Host Controller<br /> Root Hub: \\.\USB#ROOT_HUB#4&amp;35297846&amp;0#{f18a0e88-c30c-11d0-8815-00a0c906bed8}<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  Driver Key: {745A17A0-74D3-11D0-B6FE-00A0C90F57DA}\0003<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Device Description: USB Human Interface Device<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Class Code Triplet: 0x0,0x0,0x0 ( )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Maximum Packet Size: 8<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Vendor ID: 0x46d<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Product ID: 0xc024<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Device Release #: 0x9802<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Manufacturer: B16_b_02<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Product: USB-PS/2 Optical Mouse<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Serial Number: ?<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Possible Configurations #: 1<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />USB Host Controler: \\.\HCD1<br /> Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0000<br /> ID: PCI\VEN_10DE&amp;DEV_005B&amp;SUBSYS_815A1043&amp;REV_A3\3&amp;2411E6FE&amp;0&amp;11<br /> Description: Standard Enhanced PCI to USB Host Controller<br /> Root Hub: \\.\USB#ROOT_HUB20#4&amp;1e67b15b&amp;0#{f18a0e88-c30c-11d0-8815-00a0c906bed8<br />}<br />  No Device Connected<br />  Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0011<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Device Description: Generic USB Hub<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Class Code Triplet: 0x9,0x0,0x1 (Hi-speed hub with single TT)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Maximum Packet Size: 64<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Vendor ID: 0x5e3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Product ID: 0x605<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Device Release #: 0x60b<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Manufacturer: ?<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Product: USB2.0 Hub<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Serial Number: ?<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Possible Configurations #: 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  External Hub: \\.\USB#Vid_05e3&amp;Pid_0605#5&amp;3a8ffae1&amp;0&amp;2#{f18a0e88-c30c<br />-11d0-8815-00a0c906bed8}<br />  Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0005<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Device Description: USB Mass Storage Device<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Class Code Triplet: 0x0,0x0,0x0 ( )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Maximum Packet Size: 64<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Vendor ID: 0xaec<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Product ID: 0x3260<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Device Release #: 0x100<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Manufacturer: Generic<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Product: USB Storage Device<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Serial Number: 0AEC326000001A000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Possible Configurations #: 1<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br />  No Device Connected<br /></div><br /></div>
    <div class="meta">Posted on 2006-04-20 04:27:33 by f0dder</div>
   </div>
   <div class="post" id="post-179915">
    <div class="subject"><a href="#post-179915">Re: usbenum</a></div>
    <div class="body">Here is my dump...<br /><br /><div class="quote">Microsoft Windows XP <br />(C) Copyright 1985-2001 Microsoft Corp.<br /><br />D:\Downloads\ASMCommunity\usbenum&gt;usbenum<br />USB devices enumerator v1.0&nbsp; &nbsp; &nbsp; (arafel, tsech@mail.ru)<br /><br />USB Host Controler: \\.\HCD0<br /> Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0000<br /> ID: PCI\VEN_1106&amp;DEV_3038&amp;SUBSYS_80F6104D&amp;REV_1A\3&amp;61AAA01&amp;0&amp;3A<br /> Description: VIA Rev 5 or later USB Universal Host Controller<br /> Root Hub: \\.\USB#ROOT_HUB#4&amp;1f96bc4b&amp;0#{f18a0e88-c30c-11d0-8815-00a0c906bed8}<br />  No Device Connected<br />  Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0004<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Device Description: Generic USB Hub<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Class Code Triplet: 0x9,0x0,0x0 (Full speed Hub)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Maximum Packet Size: 8<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Vendor ID: 0x451<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Product ID: 0x2046<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Device Release #: 0x125<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Manufacturer Index: 0x0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Product Index: 0x0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Serial Number Index: 0x0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Possible Configurations #: 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; External Hub: \\.\USB#Vid_0451&amp;Pid_2046#5&amp;32fc2209&amp;0&amp;2#{f18a0e88-c30c-<br />11d0-8815-00a0c906bed8}<br />  Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0005<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Device Description: USB Mass Storage Device<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Class Code Triplet: 0x0,0x0,0x0 ( )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Maximum Packet Size: 64<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Vendor ID: 0xea0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Product ID: 0x6828<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Device Release #: 0x110<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Manufacturer: USB<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Product: Flash Disk<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Serial Number: 230760A440459430<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Possible Configurations #: 1<br />  No Device Connected<br />  No Device Connected<br />  Driver Key: {745A17A0-74D3-11D0-B6FE-00A0C90F57DA}\0001<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Device Description: USB Human Interface Device<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Class Code Triplet: 0x0,0x0,0x0 ( )<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Maximum Packet Size: 8<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Vendor ID: 0x45e<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Product ID: 0x7d<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Device Release #: 0x0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Manufacturer: Microsoft<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Product: Microsoft 3-Button Mouse with IntelliEye√ñ<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Serial Number: ?<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Possible Configurations #: 1<br />USB Host Controler: \\.\HCD1<br /> Driver Key: {36FC9E60-C465-11CF-8056-444553540000}\0001<br /> ID: PCI\VEN_1106&amp;DEV_3038&amp;SUBSYS_80F6104D&amp;REV_1A\3&amp;61AAA01&amp;0&amp;3B<br /> Description: VIA Rev 5 or later USB Universal Host Controller<br /> Root Hub: \\.\USB#ROOT_HUB#4&amp;cdd0ba6&amp;0#{f18a0e88-c30c-11d0-8815-00a0c906bed8}<br />  No Device Connected<br />  No Device Connected<br /><br />D:\Downloads\ASMCommunity\usbenum&gt;</div><br /><br />Paul<br /></div>
    <div class="meta">Posted on 2006-04-20 05:16:08 by PBrennick</div>
   </div>
   <div class="post" id="post-179917">
    <div class="subject"><a href="#post-179917">Re: usbenum</a></div>
    <div class="body">Holly bananas! f0dder, is there <strong>anything else </strong> on your system besides usb ports ? :mrgreen:<br /><br />P.S. Seems like the text formatting got screwed up for nested hubs... Doesn&#39;t matter much though, because I am thinking about converting it into gui version anyway (..sometime in near future, when the damn middle-term exams will over and I&#39;ll have some more free time)</div>
    <div class="meta">Posted on 2006-04-20 05:55:41 by arafel</div>
   </div>
   <div class="post" id="post-179918">
    <div class="subject"><a href="#post-179918">Re: usbenum</a></div>
    <div class="body">Well, what can I say? nForce4 boards already has a *lot* of USB ports, and I&#39;ve hooked a 3-port hub / 16-in-1 card reader up as well...</div>
    <div class="meta">Posted on 2006-04-20 06:01:12 by f0dder</div>
   </div>
  </div>
 </body>
</html>