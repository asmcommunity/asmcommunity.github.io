<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Barrel Shifter - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21523" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=21523">Barrel Shifter</a></p>
   <div class="post" id="post-162537">
    <div class="subject"><a href="#post-162537">Barrel Shifter</a></div>
    <div class="body">Recently I&#39;ve read that Pentium4 lacks the so called &#39;Barrel Shifter&#39; and that that it hurts its performance badly in some situations. Is it really THAT bad? Has anyone done any benchmarks? I&#39;d really like to see a &#39;practical&#39; difference.</div>
    <div class="meta">Posted on 2005-07-27 22:50:21 by ti_mo_n</div>
   </div>
   <div class="post" id="post-162539">
    <div class="subject"><a href="#post-162539">Re: Barrel Shifter</a></div>
    <div class="body">rotate instructions, encryption functions are slower. Haven&#39;t done benchmarks myself, but that&#39;s the general consensus.<br /></div>
    <div class="meta">Posted on 2005-07-28 01:16:08 by f0dder</div>
   </div>
   <div class="post" id="post-162555">
    <div class="subject"><a href="#post-162555">Re: Barrel Shifter</a></div>
    <div class="body">So that makes it generally worse than, or comparable to, PIII (so that they had to increase the clock drastically) ?&nbsp; (I never had a PIII. Only PII, K6 and now P4)</div>
    <div class="meta">Posted on 2005-07-28 15:25:43 by ti_mo_n</div>
   </div>
   <div class="post" id="post-162562">
    <div class="subject"><a href="#post-162562">Re: Barrel Shifter</a></div>
    <div class="body">One of the general ideas of the P4 architecture is to have somewhat worse instructions per clock, but have a much higher clock frequence. So, some instructions are considerably slower per cycle on a P4 than a P3, but that&#39;s generally compensated for by the high clockspeeds. Ohter instructions, if correctly organized, have *very* good throughput on P4s. Especially when you start using SSE/2/3, things become interesting.<br /><br />I personally prefer somewhat lower clockspeeds but higher IPC - heat and power consumption have been pretty insane in the later-model P4s, while they don&#39;t perform much better than the AMD64s with lower clockspeed.<br /><br />As for concrete examples of encryption, I have a p3 celeron 1.3 GHz running linux, a p4 celeron 1.7 and a p4 &quot;normal&quot; 2.53 running XP - I currently can&#39;t be arsed to write a benchmark test though. I guess Rijndael/AES encryption could be interesting, though.<br /><br />Then again, there&#39;s a lot of factors around performance - like cache size, and memory speed. I&#39;ve got an idea the P3 won&#39;t hold out too well because of the PC-133 SDRAM, where the P4&#39;s have DDR266 and DDR333.<br /></div>
    <div class="meta">Posted on 2005-07-28 16:44:15 by f0dder</div>
   </div>
   <div class="post" id="post-162564">
    <div class="subject"><a href="#post-162564">Re: Barrel Shifter</a></div>
    <div class="body">Oh, so it&#39;s not THAT bad, as some people curse it to be :)</div>
    <div class="meta">Posted on 2005-07-28 16:52:06 by ti_mo_n</div>
   </div>
   <div class="post" id="post-162577">
    <div class="subject"><a href="#post-162577">Re: Barrel Shifter</a></div>
    <div class="body">Well, bad enough IMO :) - I&#39;m not too fond of the P4s after the northwood2 revision. Trading some IPC for higher clock frequency can be okay (since, appearantly, it was hard to push the P3 architecture much more clock frequency wise), but it went amok in the &gt;= prescott P4s, running too hot and requiring too much power.<br /><br />AMD64s are better, and are pretty nifty in general; P4&#39;s still seem to beat them for heavy SSE tasks, seems like the SSE implementation is better on the P4s. But outside of video coding and tasks like that, the AMD64 platform seems a better choice for now. I&#39;m looking forward to see what intel has up it&#39;s sleeve for the next CPU, though.<br /></div>
    <div class="meta">Posted on 2005-07-28 19:28:53 by f0dder</div>
   </div>
   <div class="post" id="post-162607">
    <div class="subject"><a href="#post-162607">Re: Barrel Shifter</a></div>
    <div class="body"><div class="quote"><br />rotate instructions, encryption functions are slower. Haven&#39;t done benchmarks myself, but that&#39;s the general consensus.<br /><br /></div><br />Also affects multiply and divide.<br />Cheers,<br />Randy Hyde<br /></div>
    <div class="meta">Posted on 2005-07-29 11:06:17 by rhyde</div>
   </div>
   <div class="post" id="post-162615">
    <div class="subject"><a href="#post-162615">Re: Barrel Shifter</a></div>
    <div class="body">Thank you guys for your explainations :)<br /><br />So it IS bad :P</div>
    <div class="meta">Posted on 2005-07-29 14:27:07 by ti_mo_n</div>
   </div>
   <div class="post" id="post-162625">
    <div class="subject"><a href="#post-162625">Re: Barrel Shifter</a></div>
    <div class="body">Shouldn&#39;t it also affect the indexed memory access:<br />mov eax,<br />etc etc?<br />The shift here is fixed only to 4 states, so a simpler, dedicated (different) type of unit is probably used, though. </div>
    <div class="meta">Posted on 2005-07-29 20:03:56 by Ultrano</div>
   </div>
   <div class="post" id="post-162675">
    <div class="subject"><a href="#post-162675">Re: Barrel Shifter</a></div>
    <div class="body">Probably.<br /><br />...And if so, then it should be wiser to do scaled LEA (&quot;lea eax, [2*eax]&quot;) instead of SHL (&quot;shl eax, 1&quot;), right ?</div>
    <div class="meta">Posted on 2005-07-31 21:41:40 by ti_mo_n</div>
   </div>
   <div class="post" id="post-162679">
    <div class="subject"><a href="#post-162679">Re: Barrel Shifter</a></div>
    <div class="body">No, it probably uses the same type of unit to execute that microop. And lea might be a bit slower to decode and sequence (into microops). <br /><br /> I don&#39;t have a P4, only a hated P3 and a beloved AthlonXP, thus I can&#39;t make benchmarks, thus the often usage of &quot;probably&quot; ^^&quot;</div>
    <div class="meta">Posted on 2005-07-31 22:17:50 by Ultrano</div>
   </div>
  </div>
 </body>
</html>