<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>HLA main and BCB DLL - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6406" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6406">HLA main and BCB DLL</a></p>
   <div class="post" id="post-46095">
    <div class="subject"><a href="#post-46095">HLA main and BCB DLL</a></div>
    <div class="body">I know, that HLA is not the best. Pure MASM would be better.<br />(so don?t kill me for that)<br /><br />but:<br />I have a DLL compiled by Borland C Builder 6. When I try to compile the hla main file (which tries to contact the DLL) with:<br /><br />hla test.hla mydll.lib<br /><br />I get the result: invalid or corrupt file<br /><br />This is my .lib file...<br /><br />Does anybody have a solution for this ?<br />Does HLA works only with HLA(MASM) compiled DLLs ?<br /><br />thx for any hint</div>
    <div class="meta">Posted on 2002-07-02 15:00:45 by Zero</div>
   </div>
   <div class="post" id="post-46108">
    <div class="subject"><a href="#post-46108">HLA main and BCB DLL</a></div>
    <div class="body">What object file format does hla assembler produce? I know Borland uses <strong>OMF</strong> and Microsoft uses <strong>COFF</strong>. Borland frequently includes <strong>coff2omf</strong> tool with its products, so people could use Microsoft produced libraries with Borland linker. No idea about HLA.</div>
    <div class="meta">Posted on 2002-07-02 17:19:42 by comrade</div>
   </div>
   <div class="post" id="post-46119">
    <div class="subject"><a href="#post-46119">HLA main and BCB DLL</a></div>
    <div class="body">Try posting on alt.lang.asm.x86.  Randall Hyde, the author of HLA posts a lot there.</div>
    <div class="meta">Posted on 2002-07-02 21:31:37 by grv575</div>
   </div>
   <div class="post" id="post-46128">
    <div class="subject"><a href="#post-46128">HLA main and BCB DLL</a></div>
    <div class="body">thx for your help.<br /><br />Inprise has COFF2OMF, but not OMF2COFF.<br /><br />As we can read in the Borland Help:<br />&quot;Coff2Omf  enables C++Builder users to link to Microsoft and other third-party DLLs that use the COFF format. Coff2Omf does not convert .OBJ files.&quot;<br /><br />So I am not able to convert the Borland OMF to a masm compatible COFF DLL (.lib).<br /><br />So there is maybe the only way to attach &quot;non&quot;-Masm DLLs to code them with M$ VC++.<br /><br />Finally this is no problem of HLA, it is a problem of the .lib format.<br /><br />Zero</div>
    <div class="meta">Posted on 2002-07-03 01:34:39 by Zero</div>
   </div>
   <div class="post" id="post-46134">
    <div class="subject"><a href="#post-46134">HLA main and BCB DLL</a></div>
    <div class="body">The MS linker will convert OMF .obj files to COFF before linking. The COFF version of an OMF file is temporary.<br /><br />The .lib files are not converted. You can use a .def file to produce the COFF .lib files.</div>
    <div class="meta">Posted on 2002-07-03 02:59:10 by tenkey</div>
   </div>
   <div class="post" id="post-46139">
    <div class="subject"><a href="#post-46139">HLA main and BCB DLL</a></div>
    <div class="body"><div class="quote"><br />The MS linker will convert OMF .obj files to COFF before linking. <br /></div><br />It will? That never ever seemed to work for me :). Oh well, must have<br />been when I used old linker versions.<br /><br />Zero, make your own (ar-mscoff) import library for the DLL - shouldn't<br />be too hard to get going.</div>
    <div class="meta">Posted on 2002-07-03 05:18:39 by f0dder</div>
   </div>
   <div class="post" id="post-46184">
    <div class="subject"><a href="#post-46184">HLA main and BCB DLL</a></div>
    <div class="body">You can use the Borland DLL Wizard to make a M$ VC++ DLL.<br />This does not works too.<br />It seems that Borland produces a lib file, which has some slight differences from the M$ file.</div>
    <div class="meta">Posted on 2002-07-03 12:11:00 by Zero</div>
   </div>
  </div>
 </body>
</html>