<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Quickk reference to MMX/SSE/SSE2 ... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3708" />
  <link rel="prev" href="../?id=3708&amp;page=1" />  <link rel="next" href="../?id=3708&amp;page=3" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3708">Quickk reference to MMX/SSE/SSE2 ...</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=3708&amp;page=1" style="">&laquo;</a><a href="../?id=3708&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="3708" /><input type="number" name="page" min="1" max="5" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=3708&amp;page=3">&gt;</a><a href="../?id=3708&amp;page=5">&raquo;</a></form>   <div class="post" id="post-25352">
    <div class="subject"><a href="#post-25352">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">bitRAKE,<br /><br />12 cycles (data from/to register) on PMMX,<br />realworld-transform-performance of &gt; 9.000.000 vertices on my P200mmx.<br /><br /><br />-----quote---------<br />&quot;Edit Again: I think the: punpckldq mm5,mm5 should be punpckhdq mm5,mm5? And you might have to mask off the high word of the MM3 before it is stored, if you need that value zero? &quot;<br />---------------------<br />Not necessary: The piece of code in your attachement works correct.<br /><br /><br /><br />Thanks!<br /><br />VShader</div>
    <div class="meta">Posted on 2002-02-21 14:05:28 by VShader</div>
   </div>
   <div class="post" id="post-25353">
    <div class="subject"><a href="#post-25353">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body"><strong>VShader</strong>, can you email me a copy of what your working on when your done, or a URL where it's posted?  Just curious.  Nice to hear it works!</div>
    <div class="meta">Posted on 2002-02-21 14:11:56 by bitRAKE</div>
   </div>
   <div class="post" id="post-25453">
    <div class="subject"><a href="#post-25453">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">Yes, of course. <br /><br />I do attach it here right now, because I do not believe that it ever &quot;will be done&quot;, because I just do it for fun. <br /><br />It's basically a asm only flat shaded 3D-engine for a racing game with using extensively the mmx instructions (even for 3D-transforming, you guess it!). <br /><br />Of course no documentation, just try every key on your keyboard (Num Lock!) and press and move the mouse. <br /><br />Source is there too (MASM 6.14), should be useful for anybody who wants to start gfx with front/backbuffer-rendering under Windows95 (or later?). <br /><br />The &quot;world&quot; can be importet as a 3D-studio ascii file. <br /><br />Can not guarantee that 16-bit colors are correct on your machine, but 32bit-color exe is there too. <br /><br />*If* it runs on your machine then please do me a favor: <br />Navigate to a point so that the whole scenery is on screen, press F1 and later F2, press the &quot;PRINT&quot; key on your keyboard and exit. <br />The screenshot is then in the clipboard. <br /><br />Please mail these to <a href="mailto:eugen@rz-online.de">eugen@rz-online.de</a> and tell me your processor-specs (it runs at 60 Hz on my P200MMX). <br /><br />Just curious too! <br /><br /><br />VShader <br /><br /><br />PS: The Octree is not working yet, but you can visualize it (M). Has anybody here implemented a octree? I could use some hints...</div>
    <div class="meta">Posted on 2002-02-22 11:09:03 by VShader</div>
   </div>
   <div class="post" id="post-25458">
    <div class="subject"><a href="#post-25458">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">The output responses pretty fast to movements etc. but it looks like garbage:<br /><br />Framerate is 75 fps (fixed), probably because the screen is switched to that refresh rate.<br /><br />(Athlon TB 1.4Ghz, 256MB ddr)<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-02-22 11:36:15 by Thomas</div>
   </div>
   <div class="post" id="post-25464">
    <div class="subject"><a href="#post-25464">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">&quot;looks like garbage: &quot;<br /><br /><br />true. (damn)<br /><br />please try the 32bit-color version.<br /><br />If it runs:<br />F1 - screenshot - exit.<br />F3 (sorry, not F2) - screenshot - exit<br /><br /><br /><br />VShader</div>
    <div class="meta">Posted on 2002-02-22 12:30:05 by VShader</div>
   </div>
   <div class="post" id="post-25467">
    <div class="subject"><a href="#post-25467">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">The above screenshots were from the 32-bit versions, both versions give the same problem.<br />Here's the F3 output (32-bit):</div>
    <div class="meta">Posted on 2002-02-22 12:34:09 by Thomas</div>
   </div>
   <div class="post" id="post-25472">
    <div class="subject"><a href="#post-25472">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">It should look like this.<br /><br />Don't complain about the clipping.<br />I will do 3D-Clipping when the octree is in place.<br /><br />VShader</div>
    <div class="meta">Posted on 2002-02-22 12:50:39 by VShader</div>
   </div>
   <div class="post" id="post-25516">
    <div class="subject"><a href="#post-25516">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">Both exes seem to work fine on my pc (PIII 700, 128ram, Win2k)<br /><br />And might I ask you a question? You say you use mmx alot, does that mean your dealing with integer coordinates for the 3d models? I tried looking at the source, but without English comments I'm kinda lost.<br /><br />Its a beautiful program though. And 14,000 lines of code is no mean feat.</div>
    <div class="meta">Posted on 2002-02-22 19:12:41 by Eóin</div>
   </div>
   <div class="post" id="post-25531">
    <div class="subject"><a href="#post-25531">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">It worked great on the computers at my job, but at home I get the same thing <strong>Thomas</strong> posted.  This might be DX8, or the GeForce3 drivers?<br /><br />A combination of fixed point and floating point is used.<br /><br />Very impressive work <strong>VShader</strong>!</div>
    <div class="meta">Posted on 2002-02-22 20:29:16 by bitRAKE</div>
   </div>
   <div class="post" id="post-25550">
    <div class="subject"><a href="#post-25550">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">I get the same problem on my machine...  AMD Duron 800, 256Mb ram, Gforce 2...  <br /><br />But, im inclined to agree with bitRAKE, as my OS is currently using DX8.0 as well...<br /><br />Hope this is some help... (wish it worked, the pics look *real* impressive!).<br /><br />Good Luck..<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-02-23 01:16:24 by NaN</div>
   </div>
   <div class="post" id="post-25563">
    <div class="subject"><a href="#post-25563">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">There are 3 renderers to choose from at runtime:<br /><br />F7: mmx-Slopes<br />F6: Edgetables with midpointalgorithm<br />F8: GDI-Fill polygon<br /><br />The GDI version should work on every machine because the text in timing etc. uses GDI too and it shows correct.<br /><br />But it is dead slow. It even nearly caused to cancel my project because I thought that the Matrox drivers for filling a flat shaded polygon could not be that slow and I wanted a scene with more than 300 triangles.<br /><br />With full scene on screen I get 2 fps with the GDI-filler and &gt; 60 fps with the mmx filler.<br />And this isn't optimized yet because I only write words in 16bit-color mode where I could (in larger tris) write dwords and qwords which should be much faster.<br /><br />I write directly to videoram. If I would use a backbuffer in mainram it could be even faster on faster machines.<br /><br />Hey, If I had one of your monstermachines I could throw in a 7 times complexer scene !!!  But everybody knows that the code wouldn't then be that optimized...<br /><br /><br />---quote Eoin-----<br />does that mean your dealing with integer coordinates for the 3d models?<br />----------------------<br /><br />Yes. <br />Setup of matrizes and movement of the camera is floating point.<br />Transform is mmx-integer fixed point.<br />Perspective is floating point (Can I avoid this?!?!).<br />Rendering is mmx-integer fixed point.<br /> <br />At this demo I use:<br /><br />7 bit after decimalpoint  9:7 (+-256m,... // 1 bit: 0,78 cm)<br /><br />The scene is about 123m long.<br />There are accuracy-issues with the placement of the (fixed) point if you move away from the center of the scene with your camera. They show while rotation and scaling, not while moving.<br /><br />This effect of fixed-point-transform can easily be studied while scaling the whole scene with:<br /><br />U: Scale up<br />I: Scale down<br /><br />(But you must first move away from the center)<br /><br />One way would be to preserve the accuracy of 32 bit after the pmaddwd. You don't pack back to 16 bit but go on with 32 bit fixed point. The mmx-transformation could save there 1 or 2 cycles too (but you have to store 2x the data).<br /><br /><br /><br />Does anybody guess which game inspired me? (played it YEARS ago) <br /><br /><br />VShader</div>
    <div class="meta">Posted on 2002-02-23 03:38:58 by VShader</div>
   </div>
   <div class="post" id="post-25573">
    <div class="subject"><a href="#post-25573">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">Hmm, Annihilation Tank? I doubt it though, your 3d graphics are a thousand times better.</div>
    <div class="meta">Posted on 2002-02-23 07:19:06 by Eóin</div>
   </div>
   <div class="post" id="post-25577">
    <div class="subject"><a href="#post-25577">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body"><div class="quote"><br />Does anybody guess which game inspired me? (played it YEARS ago)</div><br /><br />On my PC (Athlon-XP 1800+ , ATI 8500 Radeon, C2N DataSette :tongue: ) MMX3D_32.exe works, but MMX3D.exe shows that gfx problem (intuitively I'd say wrong modulo/pitch).<br /><br />About which game.. hmm.. Test Drive III? ;)<br /><br />Greets,<br />Maverick</div>
    <div class="meta">Posted on 2002-02-23 08:16:20 by Maverick</div>
   </div>
   <div class="post" id="post-25578">
    <div class="subject"><a href="#post-25578">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">..or Hard Drivin' maybe? ;)</div>
    <div class="meta">Posted on 2002-02-23 08:21:22 by Maverick</div>
   </div>
   <div class="post" id="post-25621">
    <div class="subject"><a href="#post-25621">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">All wrong (shame!)<br /><br />Of course it is STUNT CAR RACER (Geoff Crammond).<br /><br />This should become a clone with an drive anywhere approach (I hope I can start physics soon...)<br /><br />VShader</div>
    <div class="meta">Posted on 2002-02-23 15:45:07 by VShader</div>
   </div>
   <div class="post" id="post-25654">
    <div class="subject"><a href="#post-25654">Unfair! ;)</a></div>
    <div class="body">Don't blame me.. I know Stunt Car Racer VERY well.. played it on the Amiga for years and not only there, it's surely one of my favourite racing games ever.<br /><br />Hey, your game looks good but doesn't look like Stunt Car Racer ;) You added trees, a church.. it looks more like Test Drive III or (although less) Hard Drivin'.<br /><br />SCR roxx :)<br /><br />Bye,<br />Mav</div>
    <div class="meta">Posted on 2002-02-23 21:41:56 by Maverick</div>
   </div>
   <div class="post" id="post-25675">
    <div class="subject"><a href="#post-25675">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">Ironically (and you dont have to believe me), but it was my first guess... :)<br /><br />Too bad i never got my chance to post....<br /><br />The posted sceens look very much alike... the raised &quot;track&quot; is what cued me to it (as i remember countless times falling off and watching the *slow* death... )<br /><br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-02-24 03:37:22 by NaN</div>
   </div>
   <div class="post" id="post-54179">
    <div class="subject"><a href="#post-54179">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">Holiday and heavy at work again ... (the projekt rested for some month because of too much work in real life)<br /><br />Just wanted to show you this really cool dog  and the progress my asm-only 3D-engine makes.<br /><br />To keep it assembler related I will give some insights to the pics.<br /><br />1) A nice dog.<br />2  For debugging reasons I wrote a short routine which rendered the just implemented NormalVector per Triangle (Culling *BEFORE* transforming). Loaded the dog-model in the engine, altered the routine to show 4 normal-vectors per tri and animated them - and it lookes realy cool. A very easy way to make 3D-fur which is moving in the wind.<br />4) Each triangle gets 4 NormalVectors.<br />5) Preparing for the octrree I wrote a routine which divides the longest triangles in the scene (The spheres of the octree must be kept small)<br />6) The last level of the octree without perspective ...<br />7) ... and with perspective.<br />8) Testing a point (the center of an octree-sphere) is very easy and *fast* with mmx:<br /><br />       ; d = Distance  =  n0 . (Q - P1)  =  mm7 . (mm1 - mm6)<br /><br />                                                 ;mm1: mmx Point        = Q<br />        psubw    mm1, mm6        ;mm6: mmx Plane-BasePoint. = P1<br />        pmaddwd  mm7, mm1     ;mm7: mmx-CLipPlaneNormal = n0<br />        movq     mm0, mm7<br />        psrlq    mm7, 32<br />        paddd    mm0, mm7<br />        movd     eax, mm0     ; eax: Distance Point-Plane, +- 17:14<br />                                          ; Distance is negytive if *behind* plane.<br />. <br /><br />Whith this perhaps 6 cycles you can easily test a sphere against a plane and you can throw it away (with all triangles in it) if it is behind the plane.<br /><br />RED: out =&gt; do nothing.<br /><br />9) YELLOW: Cut by plane =&gt; clip the triangles.<br />10)  GREEN: In =&gt; render all triangles.<br /><br />And one point I learned:<br />Use STRUCTS !!!<br />If your project gets more complex it is much easier to read something like<br /><br />mov eax, <br />mov  ebx, <br />mov  cx,  <br /><br />than ...<br /><br />mov eax, <br />mov  ebx, <br />mov  cx, word ptr<br /><br />And ... you can even save comments! (?)</div>
    <div class="meta">Posted on 2002-08-19 19:17:27 by VShader</div>
   </div>
   <div class="post" id="post-83538">
    <div class="subject"><a href="#post-83538">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">.</div>
    <div class="meta">Posted on 2003-02-24 16:27:45 by VShader</div>
   </div>
   <div class="post" id="post-103556">
    <div class="subject"><a href="#post-103556">Quickk reference to MMX/SSE/SSE2 ...</a></div>
    <div class="body">That's amazing! Great work! Only problem I have is that it does not draw polygons unless they fully fit on screen. Clipping problem?</div>
    <div class="meta">Posted on 2003-05-17 12:37:36 by comrade</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=3708&amp;page=1" style="">&laquo;</a><a href="../?id=3708&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="3708" /><input type="number" name="page" min="1" max="5" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=3708&amp;page=3">&gt;</a><a href="../?id=3708&amp;page=5">&raquo;</a></form>  </div>
 </body>
</html>