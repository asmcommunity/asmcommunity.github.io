<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Updated Ownerdraw Menu Sample - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16999" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=16999">Updated Ownerdraw Menu Sample</a></p>
   <div class="post" id="post-131919">
    <div class="subject"><a href="#post-131919">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">I've revamped my ownerdraw menu sample: <br /><br />1. Squashed some bugs. <br />2. Made the source more readable. <br />3. It should even be a little faster. <br /><br />Should I do a &quot;Longhorn&quot; owner draw menu sample? Or will it be in vain? <br /><br />:alright:<br /><br />Xtreme</div>
    <div class="meta">Posted on 2004-01-27 15:10:52 by Xtreme</div>
   </div>
   <div class="post" id="post-134723">
    <div class="subject"><a href="#post-134723">Excellent!...</a></div>
    <div class="body">They are just pretty pretty amazing! :D..:tongue: Excelent! :D</div>
    <div class="meta">Posted on 2004-02-24 13:16:39 by JaiKMw</div>
   </div>
   <div class="post" id="post-134727">
    <div class="subject"><a href="#post-134727">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">Thank You!<br /><br />If you have any additional ideas let me know and I update it again.<br /><br />Glad you liked it...</div>
    <div class="meta">Posted on 2004-02-24 13:21:26 by Xtreme</div>
   </div>
   <div class="post" id="post-134881">
    <div class="subject"><a href="#post-134881">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">Hi.:)... since the code is about 15k (Longhorn), i was thinking something, but, i don't know oif it's a good idea, here it goes, my idea is to make a full stylish menu, maybe with a border, and a different bg (in all menu) and different type/color font. Although you can make a Longhorn/Whidbey toolbar menu :D, that'll be just incredible :alright: , and what (in my 2 months of learning asm) my dream :) , hope you like my idea :) see ya Xtreme :tongue:</div>
    <div class="meta">Posted on 2004-02-26 15:50:43 by JaiKMw</div>
   </div>
   <div class="post" id="post-134883">
    <div class="subject"><a href="#post-134883">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">Hi Xtreme,<br /><br />Just one word - <strong><span style="font-size:18px>WOW</span> </strong></div>
    <div class="meta">Posted on 2004-02-26 16:26:56 by donkey</div>
   </div>
   <div class="post" id="post-134885">
    <div class="subject"><a href="#post-134885">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">JaiK, backgrounds for menus? :-s<br />Be careful you don't overload your programs with graphics, you risk that they end up looking very tacky... just like what happened when all those various delphi components came out - suddenly everybody had &quot;win98 style fading captions&quot; (even when disabled in the control panel), textured toolbars, buttons, ... - it was usually pretty bad, and when the people had no graphical skills/taste (which was the rule rather than the exception &gt;_&lt;).<br /><br />It's okay when not overdone and classy, like this menu from XTreme. I still prefer when people let the OS and User selection handle which kind of menus, buttons (etc) appear in a program, but then again I'm the kinda guy that disables all the effects and animation in WinXP :)</div>
    <div class="meta">Posted on 2004-02-26 16:34:18 by f0dder</div>
   </div>
   <div class="post" id="post-134886">
    <div class="subject"><a href="#post-134886">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">You guys should also see...<br /><br /><a target="_blank" href="http://www.masmforum.com/viewtopic.php?t=1865">http://www.masmforum.com/viewtopic.php?t=1865</a><br /><br />or<br /><br /><a target="_blank" href="http://home.ec.rr.com/abarfield/">http://home.ec.rr.com/abarfield/</a><br /><br /><br /><br />EDIT: Good point f0dder - like when I disable the MediaPlayer<br />         visualization so listening to a MP3 doesn't consume half<br />         my available RAM!</div>
    <div class="meta">Posted on 2004-02-26 16:37:57 by Xtreme</div>
   </div>
   <div class="post" id="post-134896">
    <div class="subject"><a href="#post-134896">Yeah..</a></div>
    <div class="body">Yeah, after all i think you're right f0dder :tongue: , i am like that kinda guy too :) , but... can the longhorn/whidbey toolbar menues idea stay ? :), what do you think guys?...:alright:</div>
    <div class="meta">Posted on 2004-02-26 21:33:32 by JaiKMw</div>
   </div>
   <div class="post" id="post-134902">
    <div class="subject"><a href="#post-134902">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">Well, Microsoft uses undocumented functions to do their<br />owner drawn menus. These are the same functions used<br />to draw the Start menu (you can tell in IE because the<br />icon gets a blue background along with the rest of the<br />highlighted item like the Start menu). Therefore the system<br />already has these functions in memory at startup and it<br />doesn't make much of a difference (system wide) if they're<br />used or not.<br /><br />As for us lowly :mad: 3rd-party programmers, ALL of our OD<br />stuff is in addition to everything else and can certainly cause<br />a slow-down if done to excess...</div>
    <div class="meta">Posted on 2004-02-26 22:18:09 by Xtreme</div>
   </div>
   <div class="post" id="post-134906">
    <div class="subject"><a href="#post-134906">Updated Ownerdraw Menu Sample</a></div>
    <div class="body"><strong>Xtreme:</strong> thanks for sharing. great work !</div>
    <div class="meta">Posted on 2004-02-27 01:09:25 by TBD</div>
   </div>
   <div class="post" id="post-134935">
    <div class="subject"><a href="#post-134935">Hey..</a></div>
    <div class="body">Hey Xtreme :) even though M$ uses undocumented functions :mad: , you owner drawn menues are pretty excellent, i don't think they could be has done a menues like that :), and i don't think that if you overload the menues with graphics or simple color bg, you're gonna slow donw the menues too much :tongue: :alright: ...</div>
    <div class="meta">Posted on 2004-02-27 13:53:28 by JaiKMw</div>
   </div>
   <div class="post" id="post-137540">
    <div class="subject"><a href="#post-137540">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">Hi Xtreme,<br /><br />I had a chance to look into the code for your menus today and found that you are not properly releasing resources.<br /><br />1. When deleting a bitmap it must be selected out of the DC first or the memory cannot be released afterwards<br />2. You should delete brushes and pens, selecting them out of the DC first<br /><br />I noticed that on my Win98 SE box, after opening and closing the menu about 5 or 6 times it was eating up about 50% of system resources. This problem would not be evident on NT based systems but memory would still be eaten.</div>
    <div class="meta">Posted on 2004-03-31 23:53:10 by donkey</div>
   </div>
   <div class="post" id="post-137544">
    <div class="subject"><a href="#post-137544">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">Thanks Donkey!<br /><br />I guess this C# stuff I'm into now is causing some bad habits to develop.<br /><br />Needless to say, you guys have taught me better than that.</div>
    <div class="meta">Posted on 2004-04-01 00:33:26 by Xtreme</div>
   </div>
   <div class="post" id="post-137744">
    <div class="subject"><a href="#post-137744">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">Hi Xtreme,<br /><br />I was palying around with Retro-fitting resource based dialog menus to use your menu style and came up with this. There were a few obstacles in Win98SE and generally. First I needed a way to reliably measure the menu text in case of long strings. Second the handling of separators had to allow for non-zero ID values as some people use 65535. Third the menus had to be dynamically re-styled using an enumerator to allow the text to be properly handled under Win9x, this only applies to resource menus. And finally I fixed up the GDI leaks.<br /><br />I don't use the push/push/call method so they have been replaced by invokes, in GoAsm this does not present the same problems as in MASM. The syntax is GoAsm as that is the assembler I use but should be easy to translate. I replaced all of the .IF/.ELSEIF/.ENDIF statements with test/cmp/jxx as GoAsm does not support high level constructs. All in all it came out rather nicely, I played with the tri-vertex colors a bit for a different look but they can be set back to your values.</div>
    <div class="meta">Posted on 2004-04-02 11:59:24 by donkey</div>
   </div>
   <div class="post" id="post-137751">
    <div class="subject"><a href="#post-137751">Hey yo...</a></div>
    <div class="body">HEy that's a cute job Donkey :), i love that menues :) :alright:</div>
    <div class="meta">Posted on 2004-04-02 17:07:53 by JaiKMw</div>
   </div>
   <div class="post" id="post-137752">
    <div class="subject"><a href="#post-137752">Updated Ownerdraw Menu Sample</a></div>
    <div class="body">Cool/greate job :alright:</div>
    <div class="meta">Posted on 2004-04-02 17:34:58 by bj1500</div>
   </div>
  </div>
 </body>
</html>