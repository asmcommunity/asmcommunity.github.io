<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>WriteFile - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25764" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25764">WriteFile</a></p>
   <div class="post" id="post-187951">
    <div class="subject"><a href="#post-187951">WriteFile</a></div>
    <div class="body">hi all,<br />i have a prob...<br />i need to write a text line to an existing .txt<br />i try WriteFile but nothing...<br />i think my prob is geting the handle of the .txt file<br />can someone help me?<br />by all<br />5k3l3t0r</div>
    <div class="meta">Posted on 2007-02-03 14:23:35 by 5k3l3t0r</div>
   </div>
   <div class="post" id="post-187952">
    <div class="subject"><a href="#post-187952">Re: WriteFile</a></div>
    <div class="body">Hi 5k3l3t0r, how are things?<br /><br />Show us your code? We&#39;ll push you in the right direction :)</div>
    <div class="meta">Posted on 2007-02-03 15:32:29 by JimmyClif</div>
   </div>
   <div class="post" id="post-187954">
    <div class="subject"><a href="#post-187954">Re: WriteFile</a></div>
    <div class="body">Hi, jimmy...<br />i can&#39;t give you my code, because i&#39;m not in my home...(i don&#39;t have internet conexion :(...)<br />but is something like this:<br />======================================================================<br />.elseif eax==1018&nbsp; ;my button<br />invoke CreateFile,addr dir,GENERIC_WRITE,FILE_SHARE_WRITE,NULL,OPEN_ALWAYS,0,0<br />.if eax!=INVALID_HANDLE_VALUE	<br />mov hFile, eax<br />invoke WriteFile,hFile,offset string,SIZEOF string,offset WriteSize,0<br />.else<br />invoke MessageBeep,MB_OK<br />.endif<br />invoke CloseHandle,hFile<br />======================================================================<br />can you correct the code and put some notes?<br />tkx<br />bye...<br />5k3l3t0r<br /></div>
    <div class="meta">Posted on 2007-02-03 16:24:33 by 5k3l3t0r</div>
   </div>
   <div class="post" id="post-187956">
    <div class="subject"><a href="#post-187956">Re: WriteFile</a></div>
    <div class="body">Maybe you forgot the call to SetFilePointer before your call to WriteFile.<br /><br /><pre><code><br />invoke SetFilePointer, hFile,0,0, FILE_END<br /></code></pre></div>
    <div class="meta">Posted on 2007-02-03 16:31:05 by JimmyClif</div>
   </div>
   <div class="post" id="post-187957">
    <div class="subject"><a href="#post-187957">Re: WriteFile</a></div>
    <div class="body">hi...<br />TKX, you solve my prob... so simple for you, very hard for me...:(<br />i just need to change line... do you know how? the text appears all in the same line that it was before, but i want to put my text in the next line. do you understand? sorry, is not easy for me to explain. <br /><br />oh, did you receive my e-mail, last week?<br /><br />bye</div>
    <div class="meta">Posted on 2007-02-03 16:46:35 by 5k3l3t0r</div>
   </div>
   <div class="post" id="post-187960">
    <div class="subject"><a href="#post-187960">Re: WriteFile</a></div>
    <div class="body">hi jimmy... i solved my prob... (the change line) the solution was:<br /><br />string&nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;my string&#39;,10,13 <br /><br />and before i have<br /><br />string&nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;my string&#39;,0<br /><br />bye, and tkx again...<br />5k3l3t0r<br /><br /><br /><br />&nbsp; </div>
    <div class="meta">Posted on 2007-02-03 17:56:49 by 5k3l3t0r</div>
   </div>
   <div class="post" id="post-187961">
    <div class="subject"><a href="#post-187961">Re: WriteFile</a></div>
    <div class="body">Great. Good job! :D<br /><br /><br />... and no I haven&#39;t received any email. I checked my trash and my spam folder. Did you send it to gmail?<br /><br />... and btw: use: string&nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &#39;my string&#39;,10,13<strong>,0</strong></div>
    <div class="meta">Posted on 2007-02-03 18:04:18 by JimmyClif</div>
   </div>
   <div class="post" id="post-188007">
    <div class="subject"><a href="#post-188007">Re: WriteFile</a></div>
    <div class="body">Although 10,13 works, the standard sequence is CR/LF or 13,10.<br /><br />Also, WriteFile is a binary write, so embedded zero bytes will be written to the file. The number of bytes written is controlled by a size argument.</div>
    <div class="meta">Posted on 2007-02-05 20:43:28 by tenkey</div>
   </div>
   <div class="post" id="post-188008">
    <div class="subject"><a href="#post-188008">Re: WriteFile</a></div>
    <div class="body">Nevertheless, it&#39;s a good habit to zero-terminate all strings ;)</div>
    <div class="meta">Posted on 2007-02-05 21:32:59 by ti_mo_n</div>
   </div>
   <div class="post" id="post-188012">
    <div class="subject"><a href="#post-188012">Re: WriteFile</a></div>
    <div class="body"><div class="quote"><br />Nevertheless, it&#39;s a good habit to zero-terminate all strings ;)<br /></div><br />As long as you only write <strong>sizeof(string)-1</strong> or <strong>strlen(string)</strong> to the file.<br /></div>
    <div class="meta">Posted on 2007-02-06 03:26:35 by f0dder</div>
   </div>
  </div>
 </body>
</html>