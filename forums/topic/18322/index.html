<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>toolbar button size/text - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18322" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18322">toolbar button size/text</a></p>
   <div class="post" id="post-141969">
    <div class="subject"><a href="#post-141969">toolbar button size/text</a></div>
    <div class="body">I need to figure out how to center text in my buttons. also i need to figure out how to make my buttons the size i want them to be such as 24x24 etc. Here's my source.<br /><br /><pre><code>.586<br />.model flat, stdcall<br /> option casemap &#58;none<br />      <br />   include      /masm32/include/windows.inc<br />   include      /masm32/include/kernel32.inc<br />   include      /masm32/include/user32.inc<br />   include      /masm32/include/comctl32.inc<br />   <br />   includelib   /masm32/lib/kernel32.lib<br />   includelib   /masm32/lib/user32.lib<br />   includelib   /masm32/lib/comctl32.lib<br />      <br />   WinMain      PROTO &#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD<br /><br /> .const<br />   TB_1         equ 5000<br />   TB_2         equ 5001<br />           <br />.data<br />   ClassName    db &quot;Starting Template&quot;,0<br />   ToolbarClass db &quot;ToolbarWindow32&quot;,0<br />   CaptionText  db &quot;Toolbar&quot;,0<br />   tb_text1     db &quot;Test1&quot;,0<br />   tb_text2     db &quot;Test2&quot;,0<br />      <br />.data?<br />   hWnd         HANDLE    ?<br />   hInstance    HANDLE    ?<br />   hToolbar     HANDLE    ?<br />   tbb          TBBUTTON &lt;?&gt;<br /><br />.code<br /> start&#58;<br />   invoke GetModuleHandle, NULL<br />   mov    hInstance, eax<br />   invoke WinMain,hInstance,NULL,NULL,SW_SHOWDEFAULT<br />   invoke ExitProcess,eax<br />   invoke InitCommonControls<br />; ######################################<br />WinMain proc hInst&#58;DWORD, hPrevIns&#58;DWORD, CmdLine&#58;DWORD, CmdShow&#58;DWORD<br /><br />   LOCAL  wc  &#58;WNDCLASSEX<br />   LOCAL  msg &#58;MSG<br />   LOCAL  Pos &#58;DWORD<br />   <br />   mov    wc.cbSize,       sizeof WNDCLASSEX<br />   mov    wc.style,        CS_HREDRAW + CS_VREDRAW<br />   mov    wc.lpfnWndProc,  offset WndProc<br />   mov    wc.cbClsExtra,   NULL<br />   mov    wc.cbWndExtra,   NULL<br />   mov    eax,             hInstance<br />   mov    wc.hInstance,    eax<br />   invoke LoadIcon,        NULL,IDI_APPLICATION<br />   mov    wc.hIcon,        eax<br />   mov    wc.hIconSm,      eax<br />   invoke LoadCursor,      NULL,IDC_ARROW<br />   mov    wc.hCursor,      eax<br />   mov    wc.hbrBackground,COLOR_BTNFACE+1<br />   mov    wc.lpszMenuName, NULL<br />   mov    wc.lpszClassName,offset ClassName<br />   invoke RegisterClassEx, addr wc<br /> <br />   invoke GetSystemMetrics,SM_CXSCREEN<br />   sub eax,400<br />   shr eax,1<br />   mov Pos, eax<br />   invoke GetSystemMetrics,SM_CYSCREEN<br />   sub eax,300<br />   shr eax,1<br />   mov Pos+4,eax<br />   mov Pos+8,400<br />   mov Pos+12,300<br />   <br />   invoke CreateWindowEx, NULL,<br />                          addr ClassName,<br />                          addr CaptionText,<br />                          WS_OVERLAPPEDWINDOW,<br />                          Pos,Pos+4,Pos+8,Pos+12,<br />                          NULL,<br />                          NULL,<br />                          hInst,<br />                          NULL<br />   mov    hWnd,eax<br />   invoke ShowWindow,hWnd,SW_SHOWNORMAL<br />   invoke UpdateWindow,hWnd<br />   <br />   StartLoop&#58;<br />      invoke GetMessage,addr msg,NULL,0,0<br />      cmp eax, 0<br />      je ExitLoop<br />      invoke TranslateMessage,addr msg<br />      invoke DispatchMessage,addr msg<br />      jmp StartLoop<br />   ExitLoop&#58;<br /><br />      mov eax,msg.wParam<br />      ret<br /><br />WinMain endp<br />; #######################################<br />WndProc proc hWin&#58;HWND, uMsg&#58;UINT, wParam&#58;WPARAM, lParam&#58;LPARAM<br /><br />   .if uMsg == WM_CREATE      <br />      invoke CreateWindowEx, NULL,<br />                             addr ToolbarClass,<br />                             NULL,<br />                             WS_CHILD + WS_VISIBLE + WS_CLIPSIBLINGS + CCS_NODIVIDER + CCS_NORESIZE + TBSTYLE_AUTOSIZE + TBSTYLE_LIST,<br />                             0,-1,400,41,<br />                             hWin,<br />                             NULL,<br />                             hInstance,<br />                             NULL<br />      mov hToolbar,eax<br />      <br />      invoke SendMessage,hToolbar,TB_BUTTONSTRUCTSIZE,sizeof tbb,0<br />      invoke SendMessage,hToolbar,TB_SETBUTTONSIZE,24,24<br />      <br />      mov tbb.iBitmap,0<br />      mov tbb.idCommand,TB_1<br />      mov tbb.fsState,TBSTATE_ENABLED<br />      mov tbb.fsStyle,BTNS_SHOWTEXT<br />      mov tbb.dwData,0<br />      mov tbb.iString,offset tb_text1<br />      invoke SendMessage,hToolbar,TB_ADDBUTTONS,1,ADDR tbb<br />      <br />      mov tbb.iBitmap,0<br />      mov tbb.idCommand,TB_1<br />      mov tbb.fsState,TBSTATE_ENABLED<br />      mov tbb.fsStyle,BTNS_SHOWTEXT<br />      mov tbb.dwData,0<br />      mov tbb.iString,offset tb_text1<br />      invoke SendMessage,hToolbar,TB_ADDBUTTONS,1,ADDR tbb<br />                             <br /><br />     .elseif uMsg==WM_DESTROY<br />        invoke PostQuitMessage,NULL        <br />     .else<br />        invoke DefWindowProc,hWin,uMsg,wParam,lParam		<br />        ret<br />     .endif<br />        xor eax,eax<br />        ret<br /><br />WndProc endp<br />; #########################################<br />end start</code></pre></div>
    <div class="meta">Posted on 2004-05-24 07:05:31 by smurf</div>
   </div>
   <div class="post" id="post-142024">
    <div class="subject"><a href="#post-142024">toolbar button size/text</a></div>
    <div class="body">I think that the toolbar itself will resize the buttons auto if they are first added to the internal string table first.<br /><br />Heres a snip of C code along the same lines that should work...<br /><br /><pre><code><br />// Add the button strings to the toolbar. <br />    LoadString&#40;g_hinst, IDS_CUT, &#40;LPSTR&#41; &amp;szBuf, MAX_LEN&#41;; <br />    iCut = SendMessage&#40;hwndTB, TB_ADDSTRING, 0, &#40;LPARAM&#41; &#40;LPSTR&#41; szBuf&#41;; <br /> <br />    LoadString&#40;g_hinst, IDS_COPY, &#40;LPSTR&#41; &amp;szBuf, MAX_LEN&#41;; <br />    iCopy = SendMessage&#40;hwndTB, TB_ADDSTRING, &#40;WPARAM&#41; 0, <br />        &#40;LPARAM&#41; &#40;LPSTR&#41; szBuf&#41;; <br /><br /> <br />    LoadString&#40;g_hinst, IDS_PASTE, &#40;LPSTR&#41; &amp;szBuf, MAX_LEN&#41;; <br />    iPaste = SendMessage&#40;hwndTB, TB_ADDSTRING, &#40;WPARAM&#41; 0, <br />        &#40;LPARAM&#41; &#40;LPSTR&#41; szBuf&#41;; <br /> <br />    // Fill the TBBUTTON array with button information, and add the <br />    // buttons to the toolbar. <br />    tbb&#91;0&#93;.iBitmap = BMP_CUT; <br />    tbb&#91;0&#93;.idCommand = IDM_CUT; <br />    tbb&#91;0&#93;.fsState = TBSTATE_ENABLED; <br />    tbb&#91;0&#93;.fsStyle = TBSTYLE_BUTTON; <br />    tbb&#91;0&#93;.dwData = 0; <br />    tbb&#91;0&#93;.iString = iCut; <br /> <br />    tbb&#91;1&#93;.iBitmap = BMP_COPY; <br /><br />    tbb&#91;1&#93;.idCommand = IDM_COPY; <br />    tbb&#91;1&#93;.fsState = TBSTATE_ENABLED; <br />    tbb&#91;1&#93;.fsStyle = TBSTYLE_BUTTON; <br />    tbb&#91;1&#93;.dwData = 0; <br />    tbb&#91;1&#93;.iString = iCopy; <br /> <br />    tbb&#91;2&#93;.iBitmap = BMP_PASTE; <br />    tbb&#91;2&#93;.idCommand = IDM_PASTE; <br />    tbb&#91;2&#93;.fsState = TBSTATE_ENABLED; <br />    tbb&#91;2&#93;.fsStyle = TBSTYLE_BUTTON; <br />    tbb&#91;2&#93;.dwData = 0; <br />    tbb&#91;2&#93;.iString = iPaste; <br /> <br />    SendMessage&#40;hwndTB, TB_ADDBUTTONS, &#40;WPARAM&#41; NUM_BUTTONS, <br />        &#40;LPARAM&#41; &#40;LPTBBUTTON&#41; &amp;tbb&#41;; <br /></code></pre></div>
    <div class="meta">Posted on 2004-05-24 17:04:43 by Graebel</div>
   </div>
   <div class="post" id="post-142368">
    <div class="subject"><a href="#post-142368">toolbar button size/text</a></div>
    <div class="body">is there anyway to make a toolbar button smaller than 16x16? whats the smallest size possible?</div>
    <div class="meta">Posted on 2004-05-28 21:03:48 by smurf</div>
   </div>
   <div class="post" id="post-142867">
    <div class="subject"><a href="#post-142867">toolbar button size/text</a></div>
    <div class="body">Hi Smurf,<br /><br />I believe that the problem with your original code may be the TBSTYLE_LIST in the CreateWindowEx function. This style places text to the right of the image in a button (normally, text is placed below the image in a button). As you have specified a button size of 24x24, the text is trying to appear on the right side of a 24x24  button bitmap image. If you remove TBSTYLE_LIST then the text will centre itself in your buttons.<br /><br />All buttons in a toolbar have the same size; they will resize themselves to accomodate the largest string that appears on the buttons.<br /><br /><br />Regards,<br /><br />AsmCoder</div>
    <div class="meta">Posted on 2004-06-04 12:53:26 by AsmCoder</div>
   </div>
  </div>
 </body>
</html>