<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Why this not work? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=586" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=586">Why this not work?</a></p>
   <div class="post" id="post-3529">
    <div class="subject"><a href="#post-3529">Why this not work?</a></div>
    <div class="body">Hello everybody,<br /><br />  ;;;;;;;;;;;;;;;   <br />     invoke GlobalAlloc,GMEM_ZEROINIT,FileSize	<br />     mov hMemory,eax<br />     invoke GlobalLock,hMemory<br />     mov pMemory,eax<br /><br />     invoke ReadFile,hFile,pMemory,0ah,\<br />                     ADDR WriteSize,NULL<br /><br />     invoke WriteFile,hFile,pMemory,FileSizeSize,ADDR WriteSize,NULL<br />     invoke CloseHandle,hFile<br />     invoke GlobalUnlock,pMemory<br />     invoke GlobalFree,hMemory<br />;;;;;;;;;;;;;;;;;;;;;<br /><br />So I read 10 bytes from file into memory full of nothing then write that back to the file.  What I think should happen is 10 bytes are copied to file full of nulls, but this does not happen.  10 bytes are copied but the rest of the file is not nulls!<br /><br />Any ideas or help much appreciated<br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2001-08-12 04:36:05 by czDrillard</div>
   </div>
   <div class="post" id="post-3532">
    <div class="subject"><a href="#post-3532">Why this not work?</a></div>
    <div class="body">What I think is happening here is that write file doesn't simply add more data to the end of a file, it deletes the origional and creates a new one.<br /><br />What I suggest doing is loading the entire file into memory, make any modifications to it there and then write the whole file back to the harddisk.</div>
    <div class="meta">Posted on 2001-08-12 05:18:43 by EÃ³in</div>
   </div>
   <div class="post" id="post-3571">
    <div class="subject"><a href="#post-3571">Why this not work?</a></div>
    <div class="body">or use WIN32 function SetFilePointer</div>
    <div class="meta">Posted on 2001-08-12 15:16:37 by japheth</div>
   </div>
   <div class="post" id="post-3696">
    <div class="subject"><a href="#post-3696">Why this not work?</a></div>
    <div class="body">Thanks Zadkiel, I just read the whole file into memory then make my changes and write it.  and japheth I do need to use setfilepointer and everything working great.  Thanks again for your help.<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2001-08-13 20:00:47 by czDrillard</div>
   </div>
  </div>
 </body>
</html>