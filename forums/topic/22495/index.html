<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>GetOpenFileName and WritePrivateProfile* - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22495" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22495">GetOpenFileName and WritePrivateProfile*</a></p>
   <div class="post" id="post-168777">
    <div class="subject"><a href="#post-168777">GetOpenFileName and WritePrivateProfile*</a></div>
    <div class="body">In an app I am working on, I&#39;ve found that if I run GetOpenFileName and select a file by double-clicking, then later, if I save some settings to my ini file using WritePrivateProfileStruct or String, everything seems to work ok, but the next time I run the program, the ini values are back to their old settings.&nbsp; If I immediately do a GetPrivateProfile* after the write, the values come back with the correct values, but are still incorrect the next time I run the program.&nbsp; I have repeatedly tested this.&nbsp; If I don&#39;t execute the GetOpenFileName and double click a file, the ini settings work properly.&nbsp; It seems that GetOpenFileName is wiping out the cache for the ini writes when I exit the program.&nbsp; Is there some way to get around this problem?</div>
    <div class="meta">Posted on 2005-12-11 11:26:32 by JimG</div>
   </div>
   <div class="post" id="post-168780">
    <div class="subject"><a href="#post-168780">Re: GetOpenFileName and WritePrivateProfile*</a></div>
    <div class="body">Let me guess, you specify a relative path for the .ini file name? GetOpenFileName changes Current Working Directory, so you probably have a couple of .ini files at various locations on your harddisk now :)<br /></div>
    <div class="meta">Posted on 2005-12-11 12:06:42 by f0dder</div>
   </div>
   <div class="post" id="post-168783">
    <div class="subject"><a href="#post-168783">Re: GetOpenFileName and WritePrivateProfile*</a></div>
    <div class="body">Good guess!&nbsp; Next time I&#39;ll ask before wasting two days screwing around.&nbsp; Thanks :P</div>
    <div class="meta">Posted on 2005-12-11 14:50:48 by JimG</div>
   </div>
  </div>
 </body>
</html>