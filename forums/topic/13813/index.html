<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How you code (asm) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13813" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=13813">How you code (asm)</a></p>
   <div class="post" id="post-106880">
    <div class="subject"><a href="#post-106880">How you code (asm)</a></div>
    <div class="body">Just a curious thought went to my mind.<br /><br />I was wonder how does everyone code when it comes to asm. For me I just stick to non-caps when it comes to asm. I wonder about the rest. Give me your comment. :)</div>
    <div class="meta">Posted on 2003-06-12 08:21:19 by roticv</div>
   </div>
   <div class="post" id="post-106900">
    <div class="subject"><a href="#post-106900">Coding style</a></div>
    <div class="body">I use a traditional ASM style -- all opcodes have the same indentation.  I don't use HLL constructs (such as .IF and .WHILE) because I work with other assemblers (for other processors) that don't have these.<br /><br />Lots of comments and long variable names.<br /><br />I use either mixed case or underscores to separate words within variable names. Default case is lower case.<br /><br />I'm not a big fan of Hungarian except for one case -- I always use p for a pointer DWORD.</div>
    <div class="meta">Posted on 2003-06-12 15:04:14 by tenkey</div>
   </div>
   <div class="post" id="post-106904">
    <div class="subject"><a href="#post-106904">How you code (asm)</a></div>
    <div class="body">- everything is lower case except for the important parts I want to stress out.<br />- I never use .IF .WHILE ... except for specific situations like showing an example how to use a function properly, there are routines in code that really has a long list of things to do before you get to the main point and sometimes during this process, too much CMP's, TEST's are performed and can possibly lead to confusion.<br />- Descriptive labels.<br />- I always use a double underscore prefix for the label<br />- sometimes I follow hungarian notation when coding an app that requires you to show the source code to &quot;professional&quot; people. But aside from that I really don't care.<br />- create lots of templates, macros and functions. Reasons? the most unproductive part is the startup code where you spend a portion of your time initializing structures(win32 programming) - which is very common thing to do, so its best to be ready to have all the necessary &quot;tools&quot; for construction...<br />- I rarely comment except for the part I wish the person who looks at my code to understand what exactly it's doing...<br />- 1 tab inbetween the instuction and it's &quot;required parameters&quot;<br />- 2++(depends...) tabs when coding with the usage of MMX and SSE plus other macros that contains long names.<pre><code>    punpckldq MM0, MM1<br /><br />    invoke  LoadCursor, NULL, IDC_ARROW<br />    mov     &#91;wcx+28&#93;, eax<br />    invoke  RegisterClassEx, wcx</code></pre>notice punpckldq, it doesn't look nice with the invoke macro.... I want everything to be aligned<pre><code>    punpckldq   MM0, MM1<br /><br />    invoke      LoadCursor, NULL, IDC_ARROW<br />    mov         &#91;wcx+28&#93;, eax<br />    invoke      RegisterClassEx, wcx</code></pre>- indentation on loops. E.G.<pre><code>__loop&#58;<br />   inc eax<br />   cmp eax, ecx<br />   jb __loop</code></pre>There are still more. These are just the common things I keep in mind.</div>
    <div class="meta">Posted on 2003-06-12 16:06:05 by arkane</div>
   </div>
   <div class="post" id="post-106913">
    <div class="subject"><a href="#post-106913">How you code (asm)</a></div>
    <div class="body">i use lowercase everywhere, except for labels/variables, where i cap the first letter of each word except the first unless it is prefixed (e.g. lpszStringForBleh or timeVal)<br /><br />i only prefix strings as lpsz, pointers /w a 'p' and handles /w an 'h' (the last only if it is written that way in the SDK doco).<br /><br />i use .IF, .ENDIF, .ELSEIF for long sections executed conditionally (indented another space), my message loop, and when i'm debugging stuff.  i comment the fuunction of my functions (ins and outs)...  and individual lines if i'm having major problems /w bugs (writing down expected return values, etc).  i also comment data structures.<br /><br />i like short variable names and labels like perrMsg or hFileIn.</div>
    <div class="meta">Posted on 2003-06-12 17:21:32 by jademtech</div>
   </div>
   <div class="post" id="post-106961">
    <div class="subject"><a href="#post-106961">How you code (asm)</a></div>
    <div class="body">what is hungarian? unless you are referring to the language?<br /><br />i use lowercase and align same as arkane, aside from my variables are all lowercase, i.e &quot;hWnd&quot; would be &quot;hwnd&quot;, or maybe even &quot;h_wnd&quot; if the var name was long enough.<br /><br />i love macros and write as many as i can, they are all prefixed with &quot;_&quot; and all my labels start with &quot;@@&quot;.</div>
    <div class="meta">Posted on 2003-06-13 07:42:02 by abc123</div>
   </div>
   <div class="post" id="post-106963">
    <div class="subject"><a href="#post-106963">How you code (asm)</a></div>
    <div class="body"><div class="quote">what is hungarian? unless you are referring to the language?</div> <br />Hungarian notation is about name the variables according to their uses/function. For example pointers are prefixed with a 'p', handles prefixed with a 'h' and strings prefixed with 'sz'. <br /><br />My code is<br />-lack of usage of proc, replaced by call labels (Generally no stack frame)<br />-lack of comments<br />-use hungarian notation (for handles and pointers)<br />-labels prefixed with 1 underscore<br />-labels not descriptive<br />-mostly lowcase<br /><br />Sample code:<br /><pre><code><br />	lea		edi, _1byteopcode3<br />_stringopcode1&#58;<br />	movzx	edx,byte ptr&#91;esi&#93;<br />	shr		edx,1<br />	pushfd<br />	cmp		edx,&#91;edi&#93;<br />	jnz		@F<br />	xor		edx,edx<br />	test	ebx,prefix_F3h<br />	jz		_norep<br />	push	offset _rep<br />	push	&#91;esp+8&#93;&#91;8&#93;<br />	call	stringcopy<br />_norep&#58;<br />	add		edi,4<br />	popfd<br />	jc		_stringnotbyte<br />	push	&#91;edi&#93;<br />	push	&#91;esp+8&#93;&#91;4&#93;<br />	call	strcat<br />	inc		eax<br />	retn 8<br />_stringnotbyte&#58;<br />	add		edi,4<br />	xor		edx,edx<br />	test	ebx,prefix_66h<br />	setz	dl<br />	lea		edi,&#91;edi+edx*4&#93;<br />	push	&#91;edi&#93;<br />	push	&#91;esp+8&#93;&#91;4&#93;<br />	call	strcat<br />	inc		eax<br />	retn 8<br />@@&#58;<br />	popfd<br />	add		edi,4*4<br />	dec		ecx<br />	jnz		_stringopcode1<br /></code></pre></div>
    <div class="meta">Posted on 2003-06-13 08:04:00 by roticv</div>
   </div>
   <div class="post" id="post-106965">
    <div class="subject"><a href="#post-106965">How you code (asm)</a></div>
    <div class="body">In assembler I am using preferably Pascal (Delphi) style as most readble. Polish notation for labels and variables (every word begins with capital letter - CreateWindowEx ) the type of variables as prefix - hWnd, ptrArray. Long type names C Style like lpsz are only for Windows sys structures, they are meaningless for assembler where types are only byte, word or dword. I am using some prefixes like: cl - for color, h - hor handle, ptr - pointer, c - constant etc.<br /><br />About procedures - local variables in stack frame if needed. Short procedures always with register argument passing. Local labels in the procedures.<br /><br />Comments, everywhere, because I forget the project for 2 weeks and then I must remember what and why I am wrote in this source ;)</div>
    <div class="meta">Posted on 2003-06-13 08:23:59 by JohnFound</div>
   </div>
   <div class="post" id="post-107202">
    <div class="subject"><a href="#post-107202">How you code (asm)</a></div>
    <div class="body">MY code is just a big mess....<br />just kidding<br /><br />-I use all lower case letters for instructions and it seems weird to me to read someone who uses all caps for their CPU opcdes.<br /><br />-Make use of the .IF, .ENDIF if I want to test some flags (SIGN?, CARRY?) but not too heavily (especially in computationally heavy loops)<br /><br />-I also tend to loop large source code files into one large file, a habbit that I must get rid of quickly.<br /><br />-I also like using the registers the way they were defined and I rarely (if ever ) stray away from Intel's definition of how the register is to be used. (For example I almost ALWAYS use ECX as a counter, ESI and EDI as memory pointers, and EAX, EBX and EBX for mathematical operations)<br /><br />-no labels prefexied with _<br /><br />Some of my code:<br /><br /><pre><code><br />SetFPUPrec  PROC fpuprec&#58;DWORD<br />	.IF fpuprec==FPU_SINGLE<br />		fstcw cword          ;Store the FPU control word into LOCAL stack RAM<br />		and cword,0FCFFh       ;Set it <br />		fldcw cword<br />		;Load it back onto FPU<br />	.ELSEIF fpuprec==FPU_DOUBLE<br />		fstcw cword<br />		and cword,0FCFFh<br />		or cword,0200h<br />		fldcw cword<br />	.ELSEIF fpuprec==FPU_EXTENDED<br />		fstcw cword<br />		and cword,0FCFFh<br />		or cword,0300h<br />		fldcw cword<br />	.endif<br />	<br />	ret<br /><br />SetFPUPrec endp<br /><br />	;Byte encoding 01h, nn  &lt;--WORD<br />	inc &#91;esi&#93;.PC                 ;Increment Program counter<br />	push &#91;esi&#93;.PC                ;Push Z-80 program counter onto x86 stack<br />	push Z80_READ                ;Tell about read<br />	push 0 <br />	call &#91;esi&#93;.memproc           ;Call<br />	;AL has byte in Z-80<br />	mov tempbyte,al              ;Store in RAM<br />	inc &#91;esi&#93;.PC                 ;Increment Z-80 program counter<br />	push &#91;esi&#93;.PC<br />	push Z80_READ<br />	push 0<br />	call &#91;esi&#93;.memproc           ;Read 2nd byte in AL<br />	;Now if I recall correctly Z-80 is little endian so first byte goes into C and last byte goes<br />	;into B<br />	movzx ebx,&#91;esi&#93;.BC           ;Fetch state of Virtual Z-80 BC register<br />	mov bl,al                    ;Store last byte into B<br />	mov bh,tempbyte              ;Store first byte into C<br />	mov &#91;esi&#93;.BC,bx              ;Write back new register<br />	;Invoke NEXTINSTRUCTION MACRO<br />	NEXTINSTRUCTION<br /></code></pre><br /><br />Messy isn't it?</div>
    <div class="meta">Posted on 2003-06-15 18:04:35 by x86asm</div>
   </div>
   <div class="post" id="post-107273">
    <div class="subject"><a href="#post-107273">How you code (asm)</a></div>
    <div class="body">My code seems different to understand at first glance, but I follow a strict pattern in coding. I tend to make all my procs &quot;private&quot; and most of them use esi and edi a lot. <br />Here's a sample:<br /><pre><code><br />;=====&#91;&#91; Some Function &gt;&gt;===\ <br />SomeFunction proc uses ebx esi edi me,x,y<br />	local baka, file1<br />	local f1&#58;myfile ; my own types of files<br />	local str1&#91;260&#93;&#58;byte ; strings are always the last to define<br />	<br />	; **** !! Note! If you change the structure, match the cr1 module's one, <br />	;         otherwise cr1 won't work<br />	<br />	<br />	;---&lt; Initiate variables &gt;--\<br />	lea eax,f1<br />	mov file1,eax<br />	mov ebx,me<br />	;---------------------------/<br />	<br />	;---&lt; Load files &gt;-----------------------------------------------------------\<br />	; this loads a packed file<br />	Scall &#91;ebx&#93;.myProgram.LoadFile,CTEXT&#40;&quot;c&#58;\ilko.refill?SomeFolder\settings.ini&quot;&#41; <br />	or ebx,ebx<br />	jz _ret ; Absolutely every function has this label!!<br />	SetupMyFile<br />	;----------------------------------------------------------------------------/<br />	<br />	;--&lt; Load string and get len &gt;---\<br />	invoke ReadStr,file1,addr str1,260<br />	xor ecx,ecx<br />	@@&#58;<br />	cmp str1&#91;ecx&#93;,0<br />	je @F<br />	inc ecx<br />	jmp @B<br />	@@&#58;<br />	or ecx,ecx<br />	jz _ret2<br />	;--------------------------------/<br />	<br />	;---&lt; Do computation &gt;--------------------------\<br />	mov ebx,me<br />	mov eax,&#91;ebx&#93;.myProgram.ScrollBar1.ScrollTotalPos<br />	mov ecx,&#91;ebx&#93;.myProgram.ScrollBar1.ScrollTotalHei<br />	mul ecx<br />	mov ecx,720<br />	div ecx<br />	mov baka, eax<br />	fild baka<br />	fiload edx<br />	fmul<br />	fload 2.446<br />	fmul<br />	fistp baka<br />	mov eax,baka<br />	sub eax,17<br />	mov &#91;ebx&#93;.myProgram.ScrollBar1.ScrollPos,eax<br />	;-----------------------------------------------/<br />	<br />	msgbox &quot;At last! My greatest work's complete! Nooooo, DeeDee....&quot;<br /> _ret2&#58; FreeMyFile<br /> _ret&#58;	ret<br />SomeFunction endp<br />;=======/<br /></code></pre><br />	Explanatory: all functions have their variables named baka,file1 or esi2, or otherwise something specific &quot;Key&quot;,&quot;ZoomY&quot;. If a variable consists of one word and I use this variable a lot, I will use lowcase. I use uppercase only for constants, and I find myself in a nightmare while looking at code that has &quot;MOV    EAX,7h&quot;, and is equally tabbed. Variables, named &quot;file1&quot; contain filehandles, or my custom filehandles. Variables &quot;baka&quot; are like a ninth register for me, and I use them to store data that is to be processed again later in the procedure. If I am short of such variables, I always make &quot;local baka, baka2,baka3,baka4&quot; but when I use them , I explicitly put a comment to show what stuff this variables contain in every significant moment of the procedure. When a large loop is to be executed, and it will use esi , I store the register into the local esi2. Strings (arrays) are named &quot;str1, str2, str3&quot; . Most procedures have &quot;me&quot; for its first argument, which is a pointer to some structure with data and functions' pointers.<br /> I code with my XASM, as it gives me the power to hide the code that I do not need currently, so you see the &quot;;=====[[ TAG_NAME &gt;&gt;===\&quot; and &quot;;=======/&quot; tags, that define a block of code and its name. I use several macros at places that are not time-critical. <br />I use .if .endif at those places, too.</div>
    <div class="meta">Posted on 2003-06-16 10:49:53 by Ultrano</div>
   </div>
   <div class="post" id="post-107292">
    <div class="subject"><a href="#post-107292">How you code (asm)</a></div>
    <div class="body">Hmm. I usually have everything in lowercase, but some big, important subroutines get a capital first letter in their name (e.g. Drawsprites). I never use hungarian notation or leading underscores and I don't give names to temporary variables, because I'm not a big fan of typing. There are no comments, since I work alone. I wouldn't trust anyone to touch my code anyway :P<br /><br />Here's some sample code from a 6502 project I'm working on:<br /><pre><code>...<br />getblock&#58;<br />lda blkdata<br />sta 18<br />sec<br />sbc #$90<br />sta 11<br />lda &#40;12&#41;,y<br />tay<br />asl<br />rol 11<br />asl<br />rol 11<br />sta 10<br />lda &#40;17&#41;,y<br />and #3<br />tay<br />lda colors,y<br />rts<br />...</code></pre><br />And an excerpt from an (incomplete) OPL3 emulator I made last summer, which emulates the OPL3 chip for users of the Creative SBPCI64 card running old DOS programs:<br /><pre><code>...<br />push byte 0<br />push ebx<br />push eax<br />int 32<br />dd 0x10063<br />add esp,12<br />pop eax<br />cli<br />mov dl,0xe8<br />mov &#91;eax+0x37b2d&#93;,dl<br />mov edx,hook1-0x37b32<br />sub edx,eax<br />mov &#91;eax+0x37b2e&#93;,edx<br />mov edi,oldjumps<br />lea esi,&#91;eax+0x4b398&#93;<br />mov ecx,8<br />rep movsd<br />lea esi,&#91;eax+0x4b338&#93;<br />mov ecx,8<br />rep movsd<br />...<br /></code></pre><br />After some hours of working with my code, you'd start to hurt yourself :P</div>
    <div class="meta">Posted on 2003-06-16 16:31:44 by Sephiroth3</div>
   </div>
   <div class="post" id="post-107335">
    <div class="subject"><a href="#post-107335">How you code (asm)</a></div>
    <div class="body">one main rule for good looking code is to be very strict! Just choose some conventions for your code, like caps or small letters, naming conventions, label conventions and apply them very strict on your text. This results in good readable and professional looking sources.</div>
    <div class="meta">Posted on 2003-06-17 02:48:38 by beaster</div>
   </div>
   <div class="post" id="post-107351">
    <div class="subject"><a href="#post-107351">How you code (asm)</a></div>
    <div class="body">my style is based on the order of everithing.<br /><br />+Global Variables start as g_<br />+Local Starts as s_<br />+I sort all the variables for name, it takes longer time but lower for maintenance<br />+I write all my code as much coulmn aligned as possible<br />+No .IF .ENDIF as someone said some time ago, are we asm coders or what ?<br />+Divide program sections with big comments, plus descriptive commets of every routine<br /><br />Sorry i'm at job now, can't past code image :(<br /><br />B7</div>
    <div class="meta">Posted on 2003-06-17 06:55:35 by Bit7</div>
   </div>
  </div>
 </body>
</html>