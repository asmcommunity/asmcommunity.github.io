<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>System Wide Hook ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15015" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15015">System Wide Hook ?</a></p>
   <div class="post" id="post-116528">
    <div class="subject"><a href="#post-116528">System Wide Hook ?</a></div>
    <div class="body">Could someone direct me to a thread that has any kind of  System Wide hook directly in a small program and not a dll.  I saw it only one a few years back but none when i tried to do a search today.  I just want to be sure that i am doing things right.<br /><br />I know that this is not the way to go but i need to use it so i can test and see the result for a  function in my app again my dll. Nine out of ten i i will go back to the dll but in this case i will know why for myself.<br /><br />Thanks in advance</div>
    <div class="meta">Posted on 2003-09-01 20:35:41 by cmax</div>
   </div>
   <div class="post" id="post-116841">
    <div class="subject"><a href="#post-116841">System Wide Hook ?</a></div>
    <div class="body"><strong>cmax</strong><br />may be <a target="_blank" href="">http://handsoff.infomedia.it/cgi-bin/lwgate/CPP-IT/archives/cpp-it.log.0006/Subject/article-53.html</a> ?</div>
    <div class="meta">Posted on 2003-09-03 23:20:54 by P2M</div>
   </div>
   <div class="post" id="post-116894">
    <div class="subject"><a href="#post-116894">System Wide Hook ?</a></div>
    <div class="body">I gave up on trying after wasting 2 days with nothing that works or works to greedy.  I think i'll try again.<br /><br />Thanks <strong>P2M</strong></div>
    <div class="meta">Posted on 2003-09-04 05:39:54 by cmax</div>
   </div>
   <div class="post" id="post-117032">
    <div class="subject"><a href="#post-117032">System Wide Hook ?</a></div>
    <div class="body"><a target="_blank" href="http://www.wasm.ru/forum/index.php?action=vthread&amp;forum=4&amp;topic=2102">http://www.wasm.ru/forum/index.php?action=vthread&amp;forum=4&amp;topic=2102</a> <br /><br />Sorry - russian content.<br /><br />The question by R4DX was: &quot;Why my c-code works but asm-code does not?&quot;<br />The answer: &quot;because c-code was compiled as debug&quot;<br />The 2 code by R4DX (with ; ###################### comments) works under 98 but does not under NT-clone. After some research i came to the solution.<br /><br />Solution: Build exe with relocations (specify /FIXED:NO to the linker) and make your hook-function base-independent. See my attachment HookCalc.zip. It hooks calc.exe and contrary to MSDN says the hook function resides in exe not in the dll. I'm sure it will work sistem-wide too. And remember it fully undocumented. So, now it works but...<br /><br />Hope this helps.</div>
    <div class="meta">Posted on 2003-09-05 02:21:19 by Four-F</div>
   </div>
  </div>
 </body>
</html>