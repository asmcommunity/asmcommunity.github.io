<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>CommandLine - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13416" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=13416">CommandLine</a></p>
   <div class="post" id="post-103919">
    <div class="subject"><a href="#post-103919">CommandLine</a></div>
    <div class="body">I am currently using this code to parse the commandline which I found on this board.<br />But When I display the commandline i get garbage characters. What am I doing wrong?<br /><br /><br />.data?<br />lpCommandLine dd ?<br /><br /><br />  call ProcessCmdLine<br />  mov esi,<br />  mov lpCommandLine,esi<br /><br /><br /><br />ProcessCmdLine proc<br />	push	edi<br />	push	esi<br />	push	ebx<br />	call	GetCommandLine<br />	mov	esi, eax<br />	mov	edi, OFFSET argv<br />	xor	ecx, ecx<br />	xor	ebx, ebx<br />	xor	edx, edx<br />@@cmss:	mov	eax, esi<br />	mov	dl, 20h<br />	cmp	byte ptr , 22h<br />	sete	cl<br />	lea	edx, <br />	add	eax, ecx<br />	stosd<br />@@cm00:	inc	esi<br />	cmp	byte ptr , 0<br />	je	@@cm01<br />	cmp	byte ptr , dl<br />	jne	@@cm00<br />	mov	byte ptr , 0<br />	add	esi, ecx<br />	inc	esi<br />	cmp	byte ptr , 0<br />	je	@@cm01<br />	inc	<br />	jmp	@@cmss<br />@@cm01:	pop	ebx<br />	pop	esi<br />	pop	edi<br />	inc	<br />	ret<br />ProcessCmdLine endp</div>
    <div class="meta">Posted on 2003-05-19 18:59:10 by gorge</div>
   </div>
   <div class="post" id="post-103971">
    <div class="subject"><a href="#post-103971">CommandLine</a></div>
    <div class="body">Your source code is missing some important elements.<br />Where are defined the argc and argv variables?</div>
    <div class="meta">Posted on 2003-05-20 01:29:53 by Vortex</div>
   </div>
   <div class="post" id="post-104048">
    <div class="subject"><a href="#post-104048">CommandLine</a></div>
    <div class="body">.data<br />argc		dd		?<br />argv		dd		16 dup (?)<br /><br /><br />here is the declaration.</div>
    <div class="meta">Posted on 2003-05-20 10:17:33 by gorge</div>
   </div>
  </div>
 </body>
</html>