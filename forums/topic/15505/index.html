<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Dll questions - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15505" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15505">Dll questions</a></p>
   <div class="post" id="post-120455">
    <div class="subject"><a href="#post-120455">Dll questions</a></div>
    <div class="body">Hey, i would need some help on a dll.<br /><br />In the dll, let's say i would have a 'something db &quot;blah&quot;,0'.<br />I want to return that &quot;something&quot; when the respective function is called; how would i do that?<br /><br />Also, in the exe that's calling the dll, i would use loadlibrary and getprocaddress to call the function.<br />Same as above, how would i call the function with &quot;something&quot; as a param?<br /><br />Thanks.</div>
    <div class="meta">Posted on 2003-10-04 02:23:20 by Ghirai</div>
   </div>
   <div class="post" id="post-120457">
    <div class="subject"><a href="#post-120457">Dll questions</a></div>
    <div class="body">Return the address of the string in eax. <br /><br /><pre><code><br />invoke	GetProcAddress,hDll,offset functionname<br />xchg eax, esi<br />call esi ;call that function<br /></code></pre><br /><br />You can store the address of the function in a dword and call it when needed.</div>
    <div class="meta">Posted on 2003-10-04 02:43:00 by roticv</div>
   </div>
   <div class="post" id="post-120458">
    <div class="subject"><a href="#post-120458">Dll questions</a></div>
    <div class="body">Pass the the offset of the string in eax then return from the function<br /><br />In your DLL (the Callee)<br /><br />MyDllFunction proc<br />mov eax,OFFSET something<br />ret<br />MyDllFunction endp<br /><br />In your main program (the Caller)<br /><br />invoke MyDllFunction<br />mov psomething,eax</div>
    <div class="meta">Posted on 2003-10-04 02:44:17 by donkey</div>
   </div>
   <div class="post" id="post-120459">
    <div class="subject"><a href="#post-120459">Dll questions</a></div>
    <div class="body">Hi roticv,<br /><br />perfectly synchronized :grin:</div>
    <div class="meta">Posted on 2003-10-04 02:44:54 by donkey</div>
   </div>
   <div class="post" id="post-120461">
    <div class="subject"><a href="#post-120461">Dll questions</a></div>
    <div class="body">Thanks guys, you're great :)</div>
    <div class="meta">Posted on 2003-10-04 03:13:26 by Ghirai</div>
   </div>
  </div>
 </body>
</html>