<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Loading DLLs Dynamically - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26196" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26196">Loading DLLs Dynamically</a></p>
   <div class="post" id="post-190592">
    <div class="subject"><a href="#post-190592">Loading DLLs Dynamically</a></div>
    <div class="body">I was wondering if there was any way I could 
incorporate my Keyboard Hook DLL into my 
executable.  Is there any relatively simple way
I could load a DLL dynamically from memory?

Thanks</div>
    <div class="meta">Posted on 2000-11-21 20:31:00 by martin</div>
   </div>
   <div class="post" id="post-190593">
    <div class="subject"><a href="#post-190593">Loading DLLs Dynamically</a></div>
    <div class="body">Sure, several ways. The LoadLibrary/FreeLibrary calls work just fine, but I prefer to let MASM do all it can for me and do that work.

Iczelion has some excellent tuts on dlls. I suggest you read them.</div>
    <div class="meta">Posted on 2000-11-22 00:47:00 by TTom </div>
   </div>
   <div class="post" id="post-190594">
    <div class="subject"><a href="#post-190594">Loading DLLs Dynamically</a></div>
    <div class="body">But how can I load a DLL from memory, rather than a file?</div>
    <div class="meta">Posted on 2000-11-22 17:35:00 by martin </div>
   </div>
   <div class="post" id="post-190595">
    <div class="subject"><a href="#post-190595">Loading DLLs Dynamically</a></div>
    <div class="body">It can be done but not easy. You must allocate enough address space for the DLL with VirtualAlloc then write the dll to the allocated block section by section. You also need to modify the PE header of the dll and you must use the information in the reloc section to relocate the whole dll.</div>
    <div class="meta">Posted on 2000-11-22 19:55:00 by Iczelion </div>
   </div>
  </div>
 </body>
</html>