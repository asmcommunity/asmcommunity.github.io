<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>New Dword2Hex algos - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22187" />
    <link rel="next" href="../?id=22187&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=22187">New Dword2Hex algos</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=22187&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=22187&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="22187" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=22187&amp;page=2">&gt;</a><a href="../?id=22187&amp;page=2">&raquo;</a></form>   <div class="post" id="post-166924">
    <div class="subject"><a href="#post-166924">New Dword2Hex algos</a></div>
    <div class="body"><strong>f0dder,</strong> :)<br /><br />I tested new Dword2Hex algos on my P4 3.6 ghz<pre><code><br />1906 hutch<br />1469 lingo<br />2781 BiteRider<br />1906 hutch<br />1469 lingo<br />2766 BiteRider<br />1906 hutch<br />1469 lingo<br />2735 BiteRider<br />1922 hutch<br />1468 lingo<br />2750 BiteRider<br />1906 hutch<br />1485 lingo<br />2765 BiteRider<br />1906 hutch<br />1469 lingo<br />2750 BiteRider<br />1906 hutch<br />1485 lingo<br />2812 BiteRider<br />1906 hutch<br />1485 lingo<br />2781 BiteRider<br />-------<br />Results<br />-------<br />1908 hutch average<br />1474 lingo average<br />2767 BiteRider average<br /><br /><br />Dword2Hex Tests:<br /><br />Dword2Hex1: 24&nbsp; clocks; Result: 1C2B3A4B<br />Dword2Hex : 27&nbsp; clocks; Result: 1C2B3A4B<br />DwH-&gt;Jeff : 168 clocks; Result: 1C2B3A4B<br />d2H-lingo : 16&nbsp; clocks; Result: 1C2B3A4B<br />dw2hex_ex:&nbsp; 38&nbsp; clocks; Result: 1C2B3A4B<br /><br />Press ENTER to exit...</code></pre><br /><br />Pls, if you have time test for me 2 files <strong>dword2h.exe</strong> and <br /><strong>bench.exe</strong> on your new box and post results<br />Thanks in advance<br /><br />Regards,<br />Lingo<br /> <br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1058" target="_blank">Dw2Hex.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-10-15 07:29:14 by lingo12</div>
   </div>
   <div class="post" id="post-166927">
    <div class="subject"><a href="#post-166927">Re: New Dword2Hex algos</a></div>
    <div class="body">I&#39;ll do later - have to celebrate my birthday and stuff first =)<br /></div>
    <div class="meta">Posted on 2005-10-15 09:20:26 by f0dder</div>
   </div>
   <div class="post" id="post-166933">
    <div class="subject"><a href="#post-166933">Re: New Dword2Hex algos</a></div>
    <div class="body">here is a variant of biterider&#39;s code, 512byte table is not neccessary<br /><pre><code><br />OPTION PROLOGUE:NONE<br />OPTION EPILOGUE:NONE<br />DwtoHex proc stdcall public pBuffer:DWORD,dwValue:DWORD<br />	mov ecx,;dwValue<br />	mov edx,ecx<br />	shr edx,4<br />	push ebx<br />	and ecx,0F0F0F0Fh<br />	and edx,0F0F0F0Fh<br />	lea ebx,<br />	lea eax,<br />	and ebx,10101010h<br />	and eax,10101010h<br />	shr ebx,4<br />	shr eax,4<br />	lea ecx,<br />	lea edx,<br />	sub ecx,ebx<br />	sub edx,eax<br />	mov eax,;pBuffer<br />	mov byte ptr ,0<br />	mov ,cl<br />	mov ,dl<br />	mov ,ch<br />	mov ,dh<br />	shr ecx,16<br />	pop ebx<br />	shr edx,16<br />	mov ,cl<br />	mov ,dl<br />	mov ,ch<br />	mov ,dh<br />	ret 2*4<br />DwToHex endp<br />OPTION PROLOGUE:PROLOGUEDEF <br />OPTION EPILOGUE:EPILOGUEDEF<br /></code></pre><br /><br /><em><strong>f0dder</strong> : happy birthday!</em></div>
    <div class="meta">Posted on 2005-10-15 17:07:51 by drizz</div>
   </div>
   <div class="post" id="post-166935">
    <div class="subject"><a href="#post-166935">Re: New Dword2Hex algos</a></div>
    <div class="body">Interesting non LUT method<br /><br />I rewrote the code using SSE.<br />It&#39;s not optimized but it should still run faster.<br /><pre><code><br />D2HSSE32:<br />;;esp+4 buff<br />;;esp+8 dw val<br />mov eax,dword<br />mov edx,dword<br />&nbsp;  movd xmm1,eax<br />&nbsp;  pxor xmm0,xmm0<br />&nbsp;  punpcklbw xmm1,xmm0 ;; 00 b4 00 b3 00 b2 00 b1<br />&nbsp;  movdqa xmm0,xmm1 ;;copy<br />&nbsp;  psllw xmm0, 12 ;;rearrange nibbles<br />&nbsp;  psrlw xmm1, 4&nbsp; ;;so after calculations<br />&nbsp;  psrlw xmm0, 4&nbsp; ;;ascii will output in the right order<br />&nbsp;  por xmm0,xmm1 ;; 0h 0l 0h 0l 0h 0l 0h 0l<br />&nbsp;  pshuflw xmm0,xmm0,00011011b ;flip words<br />&nbsp;  movdqa xmm1,xmm0 ;;copy<br />&nbsp;  paddb xmm0,dqword<br />&nbsp;  pand xmm0,dqword<br />&nbsp;  psrlw xmm0,1 ;;8&#39;s or 0&#39;s<br />&nbsp;  paddb xmm1,xmm0<br />&nbsp;  psrlw xmm0,3;;;1&#39;s or 0&#39;s<br />&nbsp;  paddb xmm1,dqword<br />&nbsp;  psubb xmm1,xmm0<br />&nbsp;  movq qword,xmm1<br />&nbsp;  ret 8<br />align 16<br />addb6 dq 0606060606060606h,0606060606060606h<br />and16 dq 1010101010101010h,1010101010101010h<br />addb48 dq 3030303030303030h,3030303030303030h<br /></code></pre></div>
    <div class="meta">Posted on 2005-10-15 21:14:00 by r22</div>
   </div>
   <div class="post" id="post-166936">
    <div class="subject"><a href="#post-166936">Re: New Dword2Hex algos</a></div>
    <div class="body">r22,<br />&nbsp; &nbsp;  Isn&#39;t this shorter?&nbsp; Ratch<br /><br /><pre><code><br />.686<br />;.MMX<br />;.K3D<br />;.XMM<br /> .MODEL FLAT,STDCALL<br />;&nbsp; &nbsp; &nbsp; option casemap :none&nbsp;  ; case sensitive<br />;.LISTMACROALL<br /><br />.NOLIST<br />&nbsp; &nbsp; &nbsp; include \masm32\include\windows.inc<br />&nbsp; &nbsp; &nbsp; include \masm32\include\user32.inc<br />&nbsp; &nbsp; &nbsp; include \masm32\include\kernel32.inc<br />&nbsp; &nbsp; &nbsp; include \masm32\include\gdi32.inc<br />&nbsp; &nbsp; &nbsp; include \masm32\include\advapi32.inc<br />.LIST&nbsp;  <br />&nbsp; &nbsp; &nbsp; includelib \masm32\lib\user32.lib<br />&nbsp; &nbsp; &nbsp; includelib \masm32\lib\kernel32.lib<br />&nbsp; &nbsp; &nbsp; includelib \masm32\lib\gdi32.lib<br />&nbsp; &nbsp; &nbsp; includelib \masm32\lib\advapi32.lib<br /><br />W&nbsp; &nbsp; &nbsp; &nbsp; EQU&nbsp; &nbsp;  WORD PTR<br />B&nbsp; &nbsp; &nbsp; &nbsp; EQU&nbsp; &nbsp;  BYTE PTR<br /><br /> .DATA?<br />szBuffer BYTE 120 DUP (?)<br /><br /> .DATA<br />STRING1 BYTE &#39;ABCDEFGHIJKLMNOPQRSTUVWSXZ1234567890&#39;<br />TEXT1&nbsp;  BYTE &#39;HEX DUMP&#39;,0<br /> <br /><br /> .CODE<br />BTH:<br />BTH$ STRUC<br /> EDISAV DWORD ?<br /> ESISAV DWORD ?<br /> RETURN DWORD ?<br />BTH$1 = $<br /> STRSIZ DWORD ?<br /> BUFFER DWORD ?<br /> STRING DWORD ?<br />BTH$2 = $<br />BTH$ ENDS<br /><br /> .DATA<br /> .CODE<br /> PUSH ESI<br /> PUSH EDI<br /> MOV ESI,<br /> MOV EDI,<br /> MOV ECX,<br /><br /> .REPEAT<br />&nbsp;  MOVZX EAX,B<br />&nbsp;  SHL EAX,4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;shift &#39;n shuffle<br />&nbsp;  INC ESI&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;bump up the input pointer<br />&nbsp;  SHR AL,4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;shift &#39;n shuffle<br /><br />&nbsp;  CMP AL,10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;thanks to Norbert Juffa for this 3 line code sequence<br />&nbsp;  SBB AL,069H<br />&nbsp;  DAS <br /><br />&nbsp;  ROR AX,8&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;XCHG bytes<br /><br />&nbsp;  CMP AL,10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;thanks to Norbert Juffa for this 3 line code sequence<br />&nbsp;  SBB AL,069H<br />&nbsp;  DAS<br /><br />&nbsp;  OR EAX,&#39; &#39; SHL 16&nbsp; &nbsp; &nbsp; ;insert a space <br /><br />&nbsp;  MOV ,EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;EAX automatically writes a zero terminator on the end<br /><br />&nbsp;  ADD EDI,WORD+BYTE&nbsp; &nbsp; &nbsp; ;bump up the output pointer<br />&nbsp; DEC ECX<br /> .UNTIL ZERO?<br /><br /> POP EDI<br /> POP ESI<br /> RET BTH$2-BTH$1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;return to sender<br /><br />MAIN:<br /><br /> PUSH OFFSET STRING1<br /> PUSH OFFSET szBuffer<br /> PUSH SIZEOF STRING1<br /> CALL BTH<br /><br /> INVOKE MessageBox,0,OFFSET szBuffer,OFFSET TEXT1,0<br /><br /> XOR EAX,EAX<br /> INVOKE ExitProcess,EAX<br />END MAIN<br /></code></pre></div>
    <div class="meta">Posted on 2005-10-15 21:21:16 by Ratch</div>
   </div>
   <div class="post" id="post-166939">
    <div class="subject"><a href="#post-166939">Re: New Dword2Hex algos</a></div>
    <div class="body">ratch your code is shorter (instruction wise), which isn&#39;t really true if you fully unwrap the loop.<br />But it&#39;s slower executing because of the cmp and jmp.<br /><br />You can always benchmark the two functions and see for sure.<br />It may run faster for a 1byte conversion but not a full dword.</div>
    <div class="meta">Posted on 2005-10-16 00:01:02 by r22</div>
   </div>
   <div class="post" id="post-166946">
    <div class="subject"><a href="#post-166946">Re: New Dword2Hex algos</a></div>
    <div class="body">and here is my <u>plain PMMX</u> code ;)<br /><pre><code><br />OPTION PROLOGUE:NONE<br />OPTION EPILOGUE:NONE<br />.data<br />	align 8<br />	msk0F dq 00F0F0F0F0F0F0F0Fh<br />	gtb09 dq 00909090909090909h<br />	and07 dq 00707070707070707h<br />	add30 dq 03030303030303030h<br />.code<br />align 16<br />_DwToHexMMX proc stdcall public dwValue:DWORD,pBuffer:DWORD<br />	mov eax,<br />	mov edx,;dwValue<br />	mov byte ptr ,0<br />	bswap edx<br />	movd mm0,edx<br />	pxor mm1,mm1<br />	punpcklbw mm1,mm0<br />	movq mm0,mm1<br />	psrlq mm0,12<br />	pand mm1,msk0F<br />	pand mm0,msk0F<br />	por mm0,mm1<br />	movq mm1,mm0<br />	pcmpgtb mm0,gtb09<br />	pand mm0,and07<br />	paddb mm0,mm1<br />	paddb mm0,add30<br />	movq ,mm0 <br />	ret 2*4<br />_DwToHexMMX endp<br />OPTION PROLOGUE:PROLOGUEDEF <br />OPTION EPILOGUE:EPILOGUEDEF<br /></code></pre><br />Here is unrolled Ratch&#39;s code<br /><pre><code><br />OPTION PROLOGUE:NONE<br />OPTION EPILOGUE:NONE<br />align 16<br />Ratch proc dwValue:DWORD, lpBuffer:DWORD<br />	MOV EDX,<br />	xi = 0<br />	REPEAT 4<br />	MOVZX EAX,BYTE PTR <br />	SHL EAX,4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;shift &#39;n shuffle<br />	SHR AL,4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;shift &#39;n shuffle<br />	CMP AL,10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;thanks to Norbert Juffa for this 3 line code sequence<br />	SBB AL,069H<br />	DAS <br />	XCHG AL,AH&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;XCHG bytes<br />	CMP AL,10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;thanks to Norbert Juffa for this 3 line code sequence<br />	SBB AL,069H<br />	DAS<br />	MOV ,EAX&nbsp; &nbsp;  ;EAX automatically writes a zero terminator on the end<br />	xi = xi + 1<br />	ENDM <br />	RET 2*4<br />Ratch endp<br />OPTION PROLOGUE:PROLOGUEDEF<br />OPTION EPILOGUE:EPILOGUEDEF<br /></code></pre><br />Dword2Hex Tests:<br /><pre><code><br />P2MMX533<br />Dword2Hex1: 32 clocks; Result: 1C2B3A4B<br />BiteRider : 32 clocks; Result: 1C2B3A4B<br />DwH-&gt;Jeff : 95 clocks; Result: 1C2B3A4B<br />d2H-lingo : 32 clocks; Result: 1C2B3A4B<br />dw2hex_ex : 26 clocks; Result: 1C2B3A4B<br />d2H-drizz : 21 clocks; Result: 1C2B3A4B<br />MMX-drizz : 17 clocks; Result: 1C2B3A4B<br />Ratch&nbsp; &nbsp;  : 90 clocks; Result: 1C2B3A4B<br /></code></pre><br />sorry r22 i dont have SSE<br /></div>
    <div class="meta">Posted on 2005-10-16 08:13:18 by drizz</div>
   </div>
   <div class="post" id="post-166965">
    <div class="subject"><a href="#post-166965">Re: New Dword2Hex algos</a></div>
    <div class="body">Happy birthday <strong>f0dder!</strong><br /><br /><strong>drizz,</strong><br />very nice<br /><br /><strong>r22,</strong><br /><br />Since XMM registers are wider than MMX registers, however, some instructions take much longer to complete when operating on XMM registers, even though they use the same execution units.For example, the instruction paddq takes six clock cycles on XMM registers, but only two clock cycles to complete on MMX registers.<br /> <br />Here is the times on my P4 3.6 GHz with WinXP SP2:<pre><code><br /><br /> Dword2Hex Tests:<br /><br />Dword2Hex : 26  clocks; Result: 1C2B3A4B<br />dw2hex_ex : 38  clocks; Result: 1C2B3A4B<br />d2H-lingo : 15  clocks; Result: 1C2B3A4B<br />MMX_Lingo : 15  clocks; Result: 1C2B3A4B<br />dw2D - r22: 27  clocks; Result: 1C2B3A4B<br />dw2D-drizz: 19  clocks; Result: 1C2B3A4B<br /><br />Press ENTER to exit...</code></pre><br /><br />Regards,<br />Lingo</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1064" target="_blank">Dw2Hex.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-10-16 15:35:30 by lingo12</div>
   </div>
   <div class="post" id="post-166971">
    <div class="subject"><a href="#post-166971">Re: New Dword2Hex algos</a></div>
    <div class="body">Ok, here is my last try, a bit faster than my last mmx routine.<br /><em>** added a bonus qword 2 hex routine :) **<em><br /><pre><code><br />OPTION PROLOGUE:NONE<br />OPTION EPILOGUE:NONE<br />	.data<br />	align 8<br />	msk0F dq 00F0F0F0F0F0F0F0Fh<br />	gtb09 dq 00909090909090909h<br />	and07 dq 00707070707070707h<br />	add30 dq 03030303030303030h<br />	.code<br />align 16<br />DwToHexMMX2 proc stdcall public dwValue:DWORD,pBuffer:DWORD<br />	mov eax,<br />	mov edx,;dwValue<br />	bswap edx<br />	mov ecx,edx<br />	and edx,0f0f0f0f0h<br />	shr edx,4<br />	mov byte ptr ,0<br />	and ecx,00f0f0f0fh <br />	movd mm0,edx<br />	movd mm1,ecx<br />	punpcklbw mm0,mm1<br />	movq mm1,mm0<br />	pcmpgtb mm1,gtb09<br />	pand mm1,and07<br />	paddb mm0,add30<br />	paddb mm0,mm1<br />	movq ,mm0 <br />	ret 2*4<br />DwToHexMMX2 endp<br />align 16<br />QwToHexMMX proc stdcall public qwValue:QWORD,pBuffer:DWORD<br />	mov edx,[0]<br />	mov ecx,[4]<br />	mov eax,<br />	bswap ecx<br />	bswap edx<br />	movd mm0,ecx<br />	movd mm1,edx<br />	psllq mm0,32<br />	por mm0,mm1<br />	movq mm1,mm0<br />	psrlq mm0,4<br />	pand mm0,msk0F<br />	pand mm1,msk0F<br />	movq mm2,mm0<br />	punpcklbw mm2,mm1<br />	punpckhbw mm0,mm1<br />	movq mm3,mm2<br />	movq mm1,mm0<br />	pcmpgtb mm2,gtb09<br />	pcmpgtb mm0,gtb09<br />	pand mm2,and07<br />	pand mm0,and07<br />	paddb mm2,add30<br />	paddb mm0,add30<br />	paddb mm2,mm3<br />	paddb mm0,mm1<br />	movq [0],mm0<br />	movq [8],mm2 <br />	mov byte ptr ,0<br />	ret 3*4<br />QwToHexMMX endp<br />OPTION PROLOGUE:PROLOGUEDEF <br />OPTION EPILOGUE:EPILOGUEDEF<br /></code></pre><br /></div>
    <div class="meta">Posted on 2005-10-16 18:27:14 by drizz</div>
   </div>
   <div class="post" id="post-166973">
    <div class="subject"><a href="#post-166973">Re: New Dword2Hex algos</a></div>
    <div class="body">I was going to use the SSE for making a qw2hex, but obviously the add 6 and 16 shift add and sub method wasn&#39;t the most efficient to begin with.<br /><br />Here&#39;s the fastest method.<br />260ish KB LUT that takes words and turns them into dword strings.<br /><br />I threw together some code to create a LUT that big in the data section then I benchmakred the little look up function.<br />Even with the giant LUT it only beat LINGO&#39;s MMX code by a clock or so (100ms faster over 7FFFFFFh calls).<br /><br />For all those who care nothing for saving memory.<br /><pre><code><br />D2H_LUT: ;;;esp+4 buffer ;;;esp+8 value<br />mov eax,<br />mov edx,<br />movzx ecx,ax<br />shr eax,16<br />mov ecx,dword<br />mov eax,dword<br />mov dword,ecx<br />mov dword,eax<br />ret 8<br /><br />MakeD2HLUT: ;;esp+4 = address to make LUT 263ish kb rb<br />mov edx,<br />xor ecx,ecx<br />mov al,48<br />&nbsp;  .LP1:<br />mov byte,al<br />add cx,1<br />jc .next1<br />test ecx,0FFFh<br />jne .LP1<br />add al,1<br />cmp al,58<br />jne .LP1<br />add al,7<br />jmp .LP1<br />.next1:<br />;---------<br />xor ecx,ecx<br />mov al,48<br />&nbsp;  .LP2:<br />mov byte,al<br />add cx,1<br />jc .next2<br />test ecx,0FFh<br />jne .LP2<br />add al,1<br />cmp al,71<br />jne .skp2<br />mov al,48<br />.skp2:<br />cmp al,58<br />jne .LP2<br />add al,7<br />jmp .LP2<br />.next2:<br />;----------<br />xor ecx,ecx<br />mov al,48<br />&nbsp;  .LP3:<br />mov byte,al<br />add cx,1<br />jc .next3<br />test ecx,0Fh<br />jne .LP3<br />add al,1<br />cmp al,71<br />jne .skp3<br />mov al,48<br />.skp3:<br />cmp al,58<br />jne .LP3<br />add al,7<br />jmp .LP3<br />.next3:<br />;----------<br />xor ecx,ecx<br />mov al,48<br />&nbsp;  .LP4:<br />mov byte,al<br />add cx,1<br />jc .next4<br />add al,1<br />cmp al,71<br />jne .skp4<br />mov al,48<br />.skp4:<br />cmp al,58<br />jne .LP4<br />add al,7<br />jmp .LP4<br />.next4:<br />ret 4<br /></code></pre><br /><br />Someone come up with a legit reason to use a 260kb LUT for a formating function quick, because I can&#39;t think of one :D</div>
    <div class="meta">Posted on 2005-10-16 22:41:10 by r22</div>
   </div>
   <div class="post" id="post-167039">
    <div class="subject"><a href="#post-167039">Re: New Dword2Hex algos</a></div>
    <div class="body"><strong>drizz,</strong> :)<br /><br /><strong>&quot;Ok, here is my last try, a bit faster than my last mmx routine.&quot;</strong><br />Nice, but I have two faster MMX variants too... :)<br />The times are:<pre><code><br /> Dword2Hex Tests:<br /><br />d2h32&nbsp; -lingo : 15&nbsp; clocks; Result: 1C2B3A4B<br />d2hMMX1-lingo : 12&nbsp; clocks; Result: 1C2B3A4B<br />d2hMMX2-lingo : 12&nbsp; clocks; Result: 1C2B3A4B<br />d2hMMX1-drizz : 19&nbsp; clocks; Result: 1C2B3A4B<br />d2hMMX2-drizz : 17&nbsp; clocks; Result: 1C2B3A4B<br /><br /> Press ENTER to exit...</code></pre><br />Regards,<br />Lingo<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1073" target="_blank">Dw2Hex.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-10-18 18:47:56 by lingo12</div>
   </div>
   <div class="post" id="post-167064">
    <div class="subject"><a href="#post-167064">Re: New Dword2Hex algos</a></div>
    <div class="body">lingo, :), well, what is 1 clock compared to infinity :)<br /><br /><pre><code>d2h32 -lingo : 31&nbsp; clocks; Result: 1C2B3A4B<br />d2hMMX1-lingo : 13&nbsp; clocks; Result: 1C2B3A4B<br />d2hMMX2-lingo : 14&nbsp; clocks; Result: 1C2B3A4B<br />d2hMMX1-drizz : 16&nbsp; clocks; Result: 1C2B3A4B<br />d2hMMX2-drizz : 13&nbsp; clocks; Result: 1C2B3A4B</code></pre><br /><br />Regards</div>
    <div class="meta">Posted on 2005-10-19 18:54:11 by drizz</div>
   </div>
   <div class="post" id="post-167076">
    <div class="subject"><a href="#post-167076">Re: New Dword2Hex algos</a></div>
    <div class="body">I don&#39;t think this is the fastest, but is the simpliest<br /><pre><code><br />&nbsp; &nbsp; &nbsp; &nbsp; ;it returns the result in eax:edx and the source is ecx, ebx is the base and must be zero<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; mov bl, ch<br />&nbsp; &nbsp; &nbsp; &nbsp; mov dx, word ptr <br />&nbsp; &nbsp; &nbsp; &nbsp; shl dx, 16<br />&nbsp; &nbsp; &nbsp; &nbsp; mov bl, cl<br />&nbsp; &nbsp; &nbsp; &nbsp; mov dx, word ptr <br />&nbsp; &nbsp; &nbsp; &nbsp; shr ecx<br />&nbsp; &nbsp; &nbsp; &nbsp; mov bl, ch<br />&nbsp; &nbsp; &nbsp; &nbsp; mov ax, word ptr <br />&nbsp; &nbsp; &nbsp; &nbsp; shl ax, 16<br />&nbsp; &nbsp; &nbsp; &nbsp; mov bl, cl<br />&nbsp; &nbsp; &nbsp; &nbsp; mov ax, word ptr <br />;done<br />tb:&nbsp; <br />&nbsp; &nbsp; db &quot;000102030405060708090A0B0C0D0E0F&quot;<br />&nbsp; &nbsp; db &quot;101112131415161718191A1B1C1D1E1F&quot;<br />&nbsp; &nbsp; db &quot;202122232425262728292A2B2C2D2E2F&quot;<br />&nbsp; &nbsp; db &quot;303132333435363738393A3B3C3D3E3F&quot;<br />&nbsp; &nbsp; db &quot;404142434445464748494A4B4C4D4E4F&quot;<br />&nbsp; &nbsp; db &quot;505152535455565758595A5B5C5D5E5F&quot;<br />&nbsp; &nbsp; db &quot;606162636465666768696A6B6C6D6E6F&quot;<br />&nbsp; &nbsp; db &quot;707172737475767778797A7B7C7D7E7F&quot;<br />&nbsp; &nbsp; db &quot;808182838485868788898A8B8C8D8E8F&quot;<br />&nbsp; &nbsp; db &quot;909192939495969798999A9B9C9D9E9F&quot;<br />&nbsp; &nbsp; db &quot;A0A1A2A3A4A5A6A7A8A9AAABACADAEAF&quot;<br />&nbsp; &nbsp; db &quot;B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF&quot;<br />&nbsp; &nbsp; db &quot;C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF&quot;<br />&nbsp; &nbsp; db &quot;D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF&quot;<br />&nbsp; &nbsp; db &quot;E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF&quot;<br />&nbsp; &nbsp; db &quot;F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF&quot;<br /></code></pre><br /><br /></div>
    <div class="meta">Posted on 2005-10-20 19:12:04 by Eduardo Schardong</div>
   </div>
   <div class="post" id="post-167092">
    <div class="subject"><a href="#post-167092">Re: New Dword2Hex algos</a></div>
    <div class="body">Been pretty busy celebrating birthday (and hangovers), visiting family, and assembling a new box... when I get back from work tomorrow, I should be able to run the code on an AMD64x2 4400+ :D<br /></div>
    <div class="meta">Posted on 2005-10-21 15:57:32 by f0dder</div>
   </div>
   <div class="post" id="post-167098">
    <div class="subject"><a href="#post-167098">Re: New Dword2Hex algos</a></div>
    <div class="body">Lingo, I couldn&#39;t compile your file. It needs &#39;timers.asm&#39; macro file to do that. I will search it on the forum. The execution of the file end when r22 routine get executed (I&#39;ve got an AMD Duron, not P4), but I saw this on my screen before crashing:<br /><pre><code><br />Dword2Hex : 18&nbsp; clocks; Result: 1C2B3A4B<br />dw2hex_ex : 30&nbsp; clocks; Result: 1C2B3A4B<br />d2H-lingo : 25&nbsp; clocks; Result: 1C2B3A4B<br />MMX_Lingo : 9&nbsp; clocks; Result: 1C2B3A4B<br /></code></pre><br />And your last posted file showed that:<br /><pre><code><br />word2Hex1: 23&nbsp; clocks; Result: 1C2B3A4B<br />word2Hex : 23&nbsp; clocks; Result: 1C2B3A4B<br />wH-&gt;Jeff : 84 clocks; Result: 1C2B3A4B<br />2H-lingo : 26&nbsp; clocks; Result: 1C2B3A4B<br />w2hex_ex : 26&nbsp; clocks; Result: 1C2B3A4B<br /></code></pre><br /><br /><div class="quote">I should be able to run the code on an AMD64x2 4400+</div><br /><br />f0dder, after that, you will be able of starting to program using VB environment.<br /> :D</div>
    <div class="meta">Posted on 2005-10-21 19:01:13 by Kecol</div>
   </div>
   <div class="post" id="post-167099">
    <div class="subject"><a href="#post-167099">Re: New Dword2Hex algos</a></div>
    <div class="body">Hehe Kecol... I still have a P4 2.53, P4-cel-1.7, P3-1300 (linux) and a PII-350 to test stuff on... so I won&#39;t revert to sloppy code. It&#39;s just nice having a powerful machine to develop on.<br /></div>
    <div class="meta">Posted on 2005-10-21 19:45:16 by f0dder</div>
   </div>
   <div class="post" id="post-167114">
    <div class="subject"><a href="#post-167114">Re: New Dword2Hex algos</a></div>
    <div class="body"><strong>Eduardo,</strong><br /><br /><strong>&quot;but is the simpliest&quot;</strong><br />I don&#39;t understand why you think <br />your part of code ( I assume you are lazy to post<br />the working proc) is simplest ...<br />and&nbsp; simplest for whom: for you, for the people<br />without assembly knowledge or for other assembly coders<br />here...<br />You can learn more about&nbsp; <strong>&quot;simplest&quot;</strong> Dword2Hex code here:<br />http://www.masmforum.com/simple/index.php?topic=2974.0<br />and here:<br />http://www.asmcommunity.net/board/index.php?topic=3789.0<br /><br /> <br /><br /><strong>Kecol,</strong><br /><br />Thank you for testing.&nbsp; :)<br />You&nbsp; can get MASM32 with all files and macros (incl. timers.asm) here:<br />www.masm32.com<br /><br /><strong>&quot;...on my screen before crashing:&quot;</strong><br />to avoid crash just try to update your CPU (as f0dder did)&nbsp; :)<br /><br /><br /><strong>f0dder,</strong><br /><br /><strong>&quot;It&#39;s just nice having a powerful machine to develop on ..&quot;</strong><br />.. and to test my fast algos too. :)<br /><br />Regards,<br />Lingo&nbsp; <br /></div>
    <div class="meta">Posted on 2005-10-22 13:23:14 by lingo12</div>
   </div>
   <div class="post" id="post-167116">
    <div class="subject"><a href="#post-167116">Re: New Dword2Hex algos</a></div>
    <div class="body">lingo, the working proc is a little different:<br /><pre><code><br />bin2hex2 proc uses ebx, edi, esi src:DWORD, dst:DWORD, len:DWORD<br />;with a 512 bytes ascii table<br />&nbsp; &nbsp; mov edi, dst<br />&nbsp; &nbsp; mov esi, src<br />&nbsp; &nbsp; mov ecx, len<br />&nbsp; &nbsp; xor eax, eax<br />&nbsp; &nbsp; xor ebx, ebx<br /><br />&nbsp; &nbsp; mov bl, <br />&nbsp; &nbsp; mov dx, word ptr <br />&nbsp; &nbsp; mov , dx<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; shr ecx, 1<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; lstart:<br />&nbsp; &nbsp; &nbsp; &nbsp; mov ax,<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; mov bl, al<br />&nbsp; &nbsp; &nbsp; &nbsp; mov dx, word ptr <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ,dx<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; mov bl, ah<br />&nbsp; &nbsp; &nbsp; &nbsp; mov dx, word ptr <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ,dx<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; dec ecx<br />&nbsp; &nbsp; jnz lstart<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; ret<br />tb:&nbsp; <br />&nbsp; &nbsp; db &quot;000102030405060708090A0B0C0D0E0F&quot;<br />&nbsp; &nbsp; db &quot;101112131415161718191A1B1C1D1E1F&quot;<br />&nbsp; &nbsp; db &quot;202122232425262728292A2B2C2D2E2F&quot;<br />&nbsp; &nbsp; db &quot;303132333435363738393A3B3C3D3E3F&quot;<br />&nbsp; &nbsp; db &quot;404142434445464748494A4B4C4D4E4F&quot;<br />&nbsp; &nbsp; db &quot;505152535455565758595A5B5C5D5E5F&quot;<br />&nbsp; &nbsp; db &quot;606162636465666768696A6B6C6D6E6F&quot;<br />&nbsp; &nbsp; db &quot;707172737475767778797A7B7C7D7E7F&quot;<br />&nbsp; &nbsp; db &quot;808182838485868788898A8B8C8D8E8F&quot;<br />&nbsp; &nbsp; db &quot;909192939495969798999A9B9C9D9E9F&quot;<br />&nbsp; &nbsp; db &quot;A0A1A2A3A4A5A6A7A8A9AAABACADAEAF&quot;<br />&nbsp; &nbsp; db &quot;B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF&quot;<br />&nbsp; &nbsp; db &quot;C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF&quot;<br />&nbsp; &nbsp; db &quot;D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF&quot;<br />&nbsp; &nbsp; db &quot;E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF&quot;<br />&nbsp; &nbsp; db &quot;F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF&quot;<br />bin2hex2 endp<br /></code></pre><br />As you see it transform a array of 2 or more bytes to a string of hex, the part of code i post just get a dword in ecx and put the result in eax:edx, it isn&#39;t a proc, only &quot;part of code&quot;, you can put it in a macro or something, i don&#39;t see any reason to make a proc that the call will take more time to execute than the code.<br />Simpliest for me is something you don&#39;t spend more than five minutes writting it because it is easy.<br /><br />Anyway, your MMX code take only 8 clocks on my XP 1800+.</div>
    <div class="meta">Posted on 2005-10-22 16:31:17 by Eduardo Schardong</div>
   </div>
   <div class="post" id="post-167120">
    <div class="subject"><a href="#post-167120">Re: New Dword2Hex algos</a></div>
    <div class="body"><strong>Eduardo,</strong><br /><br />Many thanks for testing :)<br /><br />Regards,<br />Lingo </div>
    <div class="meta">Posted on 2005-10-22 17:23:32 by lingo12</div>
   </div>
   <div class="post" id="post-167136">
    <div class="subject"><a href="#post-167136">Re: New Dword2Hex algos</a></div>
    <div class="body"><strong>bench.exe</strong><br /><pre><code><br />E:\temp\Dw2Hex&gt;bench<br />2687 hutch<br />2344 lingo<br />2515 BiteRider<br />2579 hutch<br />2343 lingo<br />2547 BiteRider<br />2578 hutch<br />2469 lingo<br />2594 BiteRider<br />2578 hutch<br />2531 lingo<br />2453 BiteRider<br />2657 hutch<br />2406 lingo<br />2469 BiteRider<br />2671 hutch<br />2469 lingo<br />2625 BiteRider<br />2688 hutch<br />2328 lingo<br />2453 BiteRider<br />2578 hutch<br />2547 lingo<br />2531 BiteRider<br />-------<br />Results<br />-------<br />2627 hutch average<br />2429 lingo average<br />2523 BiteRider average<br /></code></pre><br /><br />...early in the timings, the thread switched execution from core #1 to core #2 and back again shortly after.<br /><br /><strong>dword2h.exe</strong><br /><pre><code><br />E:\temp\Dw2Hex&gt;dword2h.exe<br /> Please terminate any high-priority tasks and press ENTER to begin.<br /><br /><br /> Dword2Hex Tests:<br /><br />Dword2Hex1: 15&nbsp; clocks; Result: 1C2B3A4B<br />Dword2Hex : 16&nbsp; clocks; Result: 1C2B3A4B<br />DwH-&gt;Jeff : 66 clocks; Result: 1C2B3A4B<br />d2H-lingo : 24&nbsp; clocks; Result: 1C2B3A4B<br />dw2hex_ex : 26&nbsp; clocks; Result: 1C2B3A4B<br /><br /> Press ENTER to exit...<br /></code></pre><br /><br /><br />...and now it&#39;s time to sleep :)</div>
    <div class="meta">Posted on 2005-10-23 02:29:49 by f0dder</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=22187&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=22187&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="22187" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=22187&amp;page=2">&gt;</a><a href="../?id=22187&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>