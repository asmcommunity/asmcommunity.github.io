<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Port &amp; app. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3238" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=3238">Port &amp; app.</a></p>
   <div class="post" id="post-21308">
    <div class="subject"><a href="#post-21308">Port &amp; app.</a></div>
    <div class="body">I know how to display all open ports and to show<br />the IP and names of who is connected and what<br />state the ports are in, I even know how to close them<br />off, but my question is this, is there away to find out<br />what program owns what port?? because I want to show<br />the program that owns the port in my port viewer program<br />so the user will know what program is using a port before<br />desiding to close the port and app. ect.<br /><br /><br />zcoder....</div>
    <div class="meta">Posted on 2002-01-26 15:18:05 by Zcoder</div>
   </div>
   <div class="post" id="post-21388">
    <div class="subject"><a href="#post-21388">Port &amp; app.</a></div>
    <div class="body">My best guess :)<br /><br />Look up the WSADuplicateSocket API, it's used to share sockets between apps. It uses the IPC (Interprocess Communication) to hand the info about the socket to the other (your) app. Perhaps it's possible to check who's app is sending you this info? Just a guess, 'cause I don't really know how IPC works :rolleyes:</div>
    <div class="meta">Posted on 2002-01-27 02:54:04 by Qweerdy</div>
   </div>
   <div class="post" id="post-21412">
    <div class="subject"><a href="#post-21412">FoundStone's FPORT</a></div>
    <div class="body">there's a program for NT/2k called Fport by Foundstone that lists open ports (TCP and UDP) and the program that opened the port.<br /><br />here an output example:<br /><br /><pre><code>FPort v1.33 - TCP/IP Process to Port Mapper<br />Copyright 2000 by Foundstone, Inc.<br />&#91;url&#93;http&#58;//www.foundstone.com&#91;/url&#93;<br /><br />Pid   Process            Port  Proto Path                          <br />412   svchost        -&gt;  135   TCP   C&#58;\WINNT\system32\svchost.exe <br />8     System         -&gt;  139   TCP                                 <br />8     System         -&gt;  445   TCP                                 <br />548   MSTask         -&gt;  1025  TCP   C&#58;\WINNT\system32\MSTask.exe  <br />8     System         -&gt;  1027  TCP                                 <br />8     System         -&gt;  1031  TCP                                 <br />1040  WFICA32        -&gt;  1034  TCP   C&#58;\PROGRA~1\Citrix\ICACLI~1\WFICA32.EXE<br />1068  IEXPLORE       -&gt;  1173  TCP   C&#58;\Program Files\Internet Explorer\IEXPLORE.EXE<br />8     System         -&gt;  137   UDP                                 <br />8     System         -&gt;  138   UDP                                 <br />8     System         -&gt;  445   UDP                                 <br />244   lsass          -&gt;  500   UDP   C&#58;\WINNT\system32\lsass.exe   <br />232   services       -&gt;  1030  UDP   C&#58;\WINNT\system32\services.exe<br />992   msimn          -&gt;  1041  UDP   C&#58;\Program Files\Outlook Express\msimn.exe</code></pre><br />get it from:<br /><a target="_blank" href="http://www.foundstone.com/knowledge/termsofuse.html?filename=FPortNG.zip">http://www.foundstone.com/knowledge/termsofuse.html?filename=FPortNG.zip</a><br /><br />Not sure how exactly the program works, but i think it uses Native Api's to get the job done.</div>
    <div class="meta">Posted on 2002-01-27 09:17:05 by savage</div>
   </div>
   <div class="post" id="post-21620">
    <div class="subject"><a href="#post-21620">Port &amp; app.</a></div>
    <div class="body">Looks like they are using the PSAPI.DLL(Process Status API) to get the info.  This is similar to ToolHelp32 library.  Here is a link to the PSAPI info on msdn:<br /><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/perfmon/psapi_25ki.asp?frame=true">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/perfmon/psapi_25ki.asp?frame=true</a></div>
    <div class="meta">Posted on 2002-01-28 13:46:03 by rdaneel</div>
   </div>
   <div class="post" id="post-22299">
    <div class="subject"><a href="#post-22299">Port &amp; app.</a></div>
    <div class="body">Thanks for this info, but it seems<br />to not work on XP, also I am mostly<br />looking for something  that would<br />work on 98/me/2000,xp ect.<br /><br /><br />Thanks Zcoder....</div>
    <div class="meta">Posted on 2002-02-01 04:38:13 by Zcoder</div>
   </div>
  </div>
 </body>
</html>