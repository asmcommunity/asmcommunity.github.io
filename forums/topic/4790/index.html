<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>val function - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4790" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=4790">val function</a></p>
   <div class="post" id="post-33552">
    <div class="subject"><a href="#post-33552">val function</a></div>
    <div class="body">I have updated the ATODW from M32LIB functions to make it like the VAL function in basic and work like it.<br />here is it :<br /><pre><code><br />val proc String&#58;DWORD<br /><br />  ; ----------------------------------------<br />  ; Convert decimal string into dword value<br />  ; return value in eax<br />  ; ----------------------------------------<br /><br />    push esi<br />    push edi<br /><br />    xor eax, eax<br />    mov esi, String<br />    xor ecx, ecx<br />    xor edx, edx<br />    mov al, &#91;esi&#93;<br />    inc esi<br />    cmp al, 2dh<br />    jne proceed<br />    mov al, byte ptr &#91;esi&#93;<br />    not edx<br />    inc esi<br />    jmp proceed<br /><br />  @@&#58;<br />    cmp al,'0'<br />    jl	Endit<br />    cmp al,'9'<br />    jg	Endit<br />    sub al, 30h<br />    lea ecx,  dword ptr &#91;ecx+4*ecx&#93;<br />    lea ecx, dword ptr &#91;eax+2*ecx&#93;<br />    mov al, byte ptr &#91;esi&#93;<br />    inc esi<br /><br />  proceed&#58;<br />    or al, al<br />    jne @B<br />Endit&#58;<br />    lea eax, dword ptr &#91;edx+ecx&#93;<br />    xor eax, edx<br /><br />    pop edi<br />    pop esi<br /><br />    ret<br /><br />val endp<br /></code></pre><br /><br /><br /><span style="font-size:9px>(added code tags)</span></div>
    <div class="meta">Posted on 2002-04-15 07:19:26 by amr</div>
   </div>
  </div>
 </body>
</html>