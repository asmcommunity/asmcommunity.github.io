<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Masm DLL and Visual Basic - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20805" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20805">Masm DLL and Visual Basic</a></p>
   <div class="post" id="post-158217">
    <div class="subject"><a href="#post-158217">Masm DLL and Visual Basic</a></div>
    <div class="body">im not sure if this is the right place, but i couldent find anywhere else for it to go.<br /><br />ive been searching this topic for ages and have found a few small helpfull things, but nothing overly usefull.<br />i can do the send 2 longs and add them to receive a long easily enough, and i can send a vb string to my masm dll and change it, but what i want to do is return a string that is declaired within the dll.<br />ive been playing with masm for a few years, nothing serious and i want to convert some vb progs accross slowly, the firsts thing i want to do is beable to send a sql query to masm from VB, have masm connect to the database and store an array of strings, ints, or whatever comes out, (probably only strings at this point) and then be able to crawl through them to find what i want or i send an index and it returns a value.<br /><br />the database stuff through straight masm i have under control, its just the simple thing of getting a string from the dll into VB that seems to be a problem, everything i try seems to kill VB.<br /><br />so does anyone know how to do this or any tutorials on how to move strings/structures/arrays from a dll into VB without sending them to the dll from VB to begin with?<br /><br />any help would be appreciated, thanks<br />Paul<br /></div>
    <div class="meta">Posted on 2005-03-22 05:36:38 by Street_Rat</div>
   </div>
   <div class="post" id="post-158245">
    <div class="subject"><a href="#post-158245">Re: Masm DLL and Visual Basic</a></div>
    <div class="body">Paul,<br /><br />You are in trouble with the idea of creating a string in a DLL and sending it back. It can be done by creating a string handle with OLE memory and passing back the string handle in EAX but anything created on the stack is lost on proc exit.</div>
    <div class="meta">Posted on 2005-03-22 20:22:52 by hutch--</div>
   </div>
   <div class="post" id="post-158252">
    <div class="subject"><a href="#post-158252">Re: Masm DLL and Visual Basic</a></div>
    <div class="body">VB strings are not the C strings used in typical MASM programming.<br /><br />VB6 uses BSTRs for strings, and there are restrictions on how they are created, if you want to export these strings to VB.</div>
    <div class="meta">Posted on 2005-03-22 23:02:11 by tenkey</div>
   </div>
   <div class="post" id="post-158254">
    <div class="subject"><a href="#post-158254">Re: Masm DLL and Visual Basic</a></div>
    <div class="body">so the only way to get data out of a dll easily is to send a refrence to an item first and have the dll modify the data sent?<br /><br />if so is there any way to increase the size of a string sent?<br />if i send a string like &quot;Hello&quot; from VB to the dll, and use string copy to copy another string defined in the dll over the top, it only uses the number of characters in the origional string.<br />ie, if i wanted to return &quot;I made this&quot;, ill only get, &quot;I mad&quot; back.<br />does this mean i need to declare the string as a size of 255 before i send it to the dll and just send it empty?<br /><br />im not too sure about sending structures/types from VB to the dll either and having them modified, but ill have a look around and see what i find on that before i bother too many people here<br /><br />thanks for the help so far<br />Paul</div>
    <div class="meta">Posted on 2005-03-22 23:39:03 by Street_Rat</div>
   </div>
  </div>
 </body>
</html>