<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Simulate a click on a button - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2364" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2364">Simulate a click on a button</a></p>
   <div class="post" id="post-15046">
    <div class="subject"><a href="#post-15046">Simulate a click on a button</a></div>
    <div class="body">Hi there,<br /><br />I have a problem which I can't solve since I am a bit rusty in programming (due to NAVY TIME :mad: ).<br /><br />I have a program which displays a messagebox with two buttons on it. I use a timer function in my own program which waits until this messagebox comes up on the target. Then it is supposed to click on one of the buttons. I already have the handle of the button, but how do I simulate a press on this button?<br /><br />Please help me.<br /><br />Yawns</div>
    <div class="meta">Posted on 2001-12-15 09:08:56 by YaWNS</div>
   </div>
   <div class="post" id="post-15047">
    <div class="subject"><a href="#post-15047">Simulate a click on a button</a></div>
    <div class="body">well, i can't personally help ya, but...<br /><br />[9:02am] &lt;YaWNS&gt; Can someone tell me, how I can click a button by commands? I mean, I get a messagebox wit two buttons on it using findwindow, then I find the button I need, but how do I simulate the click on that button? Is there a style with SendMessage?<br />[9:05am] &lt;YaWNS&gt; Noone?<br />[9:06am] Quits: YaWNS (xxxxxx@xxxxxx.foo.net) ($null)<br />[9:16am] &lt;Nerz&gt; yawn: WM_COMMAND<br />[9:17am] &lt;_death&gt; he quit<br />[9:18am] &lt;Nerz&gt; still I said it<br />[9:18am] &lt;Nerz&gt; hehe</div>
    <div class="meta">Posted on 2001-12-15 09:52:32 by nev</div>
   </div>
   <div class="post" id="post-15052">
    <div class="subject"><a href="#post-15052">Simulate a click on a button</a></div>
    <div class="body">yeah but what if you don't know the exact<br />button-handle? sooner i had a little dumb vb<br />bruteforce prog that was able to get though a<br />password list and send password for password<br />to the current (focused) dialog (you could define<br />buttons like enter or tab or whatever)...<br />you can definitively do this with a playback-hook<br />or even better with a mouse hook that retrives<br />the current class/handle so you can send <br />WM_COMMAND msg's but these ways seem to be<br />very dirty and circular (assuming i'll choose the 2nd<br />way i'll definitively not use a dll hook (uh i hate it!)<br />so i will try to set up a journal record to do this, but<br />these hooks are very slow i think), are there other <br />ways to do it?<br /><br />btw: und? wars toll in der marine? :)</div>
    <div class="meta">Posted on 2001-12-15 13:13:24 by mob</div>
   </div>
   <div class="post" id="post-15067">
    <div class="subject"><a href="#post-15067">Simulate a click on a button</a></div>
    <div class="body"><div class="quote"><br />[9:16am] &lt;Nerz&gt; yawn: WM_COMMAND<br /></div><br /><br />And you should send that message to the parent window of the button. Of course, if you don't actually own the parent window you would need to do an EnumWindows() first to find it.</div>
    <div class="meta">Posted on 2001-12-15 16:21:41 by sluggy</div>
   </div>
   <div class="post" id="post-15092">
    <div class="subject"><a href="#post-15092">yeah</a></div>
    <div class="body">hey YaWNS,<br /><br />sluggy is right, you gotta send a WM_COMMAND message to the parent window of the message box. you should choose wParam and lParam, like if you would check in your application if a button was pressed. get it? ;) <br /><br />90h</div>
    <div class="meta">Posted on 2001-12-16 03:29:58 by NOP-erator</div>
   </div>
   <div class="post" id="post-15117">
    <div class="subject"><a href="#post-15117">Simulate a click on a button</a></div>
    <div class="body">you could send a message directly to the button, those messages:<br /><pre><code><br />Invoke SendMessage, hWndOfTheBUTTON, WM_LBUTTONDOWN, 0, 0<br />Invoke SendMessage, hWndOfTheBUTTON, WM_LBUTTONUP, 0, 0<br /></code></pre> <br /><br />cya</div>
    <div class="meta">Posted on 2001-12-16 07:04:15 by NEMO</div>
   </div>
   <div class="post" id="post-15127">
    <div class="subject"><a href="#post-15127">Simulate a click on a button</a></div>
    <div class="body">Yuhu,<br /><br />I finally found out my problem. Your Reply, NEMO, gave the important thing. I just forgot about one fact on the target programm and now everything works fine.<br /><br />Thanks to all who tried to help. Stay tuned as there will be new probs from my side :D<br /><br />Greets YaWNS</div>
    <div class="meta">Posted on 2001-12-16 09:43:06 by YaWNS</div>
   </div>
  </div>
 </body>
</html>