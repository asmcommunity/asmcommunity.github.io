<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>CreateFile error! Help me please... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1998" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1998">CreateFile error! Help me please...</a></p>
   <div class="post" id="post-12826">
    <div class="subject"><a href="#post-12826">CreateFile error! Help me please...</a></div>
    <div class="body">Hi,<br /><br />I write a VxD and another win32 program to load that VxD by CreateFile. And use DeviceIoControl() to communicate with VxD.<br /><br />My code is:<br />hVxD = CreateFile(  VXD_NAME, 0, 0, NULL, 0, FILE_FLAG_DELETE_ON_CLOSE, NULL );<br /><br />But I always get (hVxD == INVALID_HANDLE_VALUE), I don't understand why?<br /><br />My program use MFC, Dialog program!<br /><br />Thanks a lot!<br /><br />Bung</div>
    <div class="meta">Posted on 2001-11-23 00:55:44 by bung</div>
   </div>
   <div class="post" id="post-12827">
    <div class="subject"><a href="#post-12827">CreateFile error! Help me please...</a></div>
    <div class="body">Try specifying that you want GENERIC_READ access, and open in<br />FILE_SHARE_READ mode. You might want to add OPEN_EXISTING<br />to the FILE_FLAG_DELETE_ON_CLOSE.<br /><br />Also, how do you define VXD_NAME? Remember that you must<br />specify it like &quot;\\.\myvxd.vxd&quot;... which, in C, means &quot;\\\\.\\myvxd.vxd&quot;.<br /><br />Good luck.</div>
    <div class="meta">Posted on 2001-11-23 01:59:06 by f0dder</div>
   </div>
   <div class="post" id="post-12830">
    <div class="subject"><a href="#post-12830">CreateFile error! Help me please...</a></div>
    <div class="body">Thank you for your help!<br /><br />But I think that error not in my program. Problem is in VxD.<br /><br />I found a article in Internet and download zip file to see his example.<br /><br />When I run original file it ran well. But when I rebuild with my command line below, it generates another vxd file. But with this file, the EXE don't open it. And error code return when GetLastError() is 2.<br /><br />Please help me!<br /><br />Here is record.zip, contains VXD source and EXE source. If you build again with options below:<br /><br />ml -coff -c -Cx -DMASM6 -DBLD_COFF -DIS_32 record.asm<br /><br />and<br /><br />link -vxd record.obj<br /><br />then overwrite original file. It will fail.</div>
    <div class="meta">Posted on 2001-11-23 03:15:57 by bung</div>
   </div>
   <div class="post" id="post-12834">
    <div class="subject"><a href="#post-12834">CreateFile error! Help me please...</a></div>
    <div class="body">Normally you need a .DEF file to export the DDB of your vxd. I cant find any. This might be a problem.<br /><br />japheth</div>
    <div class="meta">Posted on 2001-11-23 04:44:35 by japheth</div>
   </div>
   <div class="post" id="post-12835">
    <div class="subject"><a href="#post-12835">When I download, it don't have this file...</a></div>
    <div class="body">Dir,<br /><br />When I download it from any where, I didn't remember, the ZIP file didn't have any file like .DEF<br /><br />I will try again follow your advice! If any thing, will you help me again?<br /><br />Thank you very much!</div>
    <div class="meta">Posted on 2001-11-23 04:52:26 by bung</div>
   </div>
   <div class="post" id="post-12873">
    <div class="subject"><a href="#post-12873">Problem is resolved....</a></div>
    <div class="body">Dir Japheth,<br /><br />Thank your for your help. If I create new .DEF file and build again, it ran well.<br /><br />I don't know why is it? Because, when I build it without .DEF, no error appears.<br /><br />Would you please to explain it to me!<br /><br />Thank you very much!</div>
    <div class="meta">Posted on 2001-11-23 18:33:27 by bung</div>
   </div>
   <div class="post" id="post-13047">
    <div class="subject"><a href="#post-13047">CreateFile error! Help me please...</a></div>
    <div class="body">the VMM needs to know the address of the DDB (to get the device ID and other things).  So it must be exported (by ordinal @1 as far as I know).<br /><br />japheth</div>
    <div class="meta">Posted on 2001-11-26 04:24:59 by japheth</div>
   </div>
  </div>
 </body>
</html>