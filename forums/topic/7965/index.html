<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>socket call on win2000 fails in thread!! - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7965" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=7965">socket call on win2000 fails in thread!!</a></p>
   <div class="post" id="post-58177">
    <div class="subject"><a href="#post-58177">socket call on win2000 fails in thread!!</a></div>
    <div class="body">Howdy All,<br /><br />I'm new to the board, but I have a pretty serious issue, I can't seem to fix on my own... would someone please help!!<br /><br />I have a small TFTP server application I'm writting, and it works fine in Win98, but It won't work properly on Win2000.<br /><br />The main application sets up a listening UDP socket (port 69) using winsock 1.1, and starts a thread to deal with responses.<br /><br />The thread starts a new socket, binds to port 0 (winsock sets the port), and it continues the trivial file transfer.<br /><br />On a Windows 2000 machine, the thread actually fails the socket call with WSAEINVAL<br /><br />Any ideas? :confused: <br /><br />Thanx tk<br /><br />The call on the thread is:<br /><br />invoke socket, PF_INET, SOCK_DGRAM, IPPROTO_UDP</div>
    <div class="meta">Posted on 2002-09-16 13:46:43 by tk627</div>
   </div>
   <div class="post" id="post-58423">
    <div class="subject"><a href="#post-58423">Update</a></div>
    <div class="body">Howdy All,<br /><br />I've noticed a number of views on my request for help, so I guess some of you might be interested...<br /><br />I found that it wasn't the call to the socket(), it was a previous call to ntohs() that was causing the trouble on Win 2000. I thought it might be some kind of word alignment problem, but nothing seemed to fix the problem using the call...<br /><br />I replaced the call with a simple byte swap, and it works... <br /><br />Anyone care to comment on this?? Has anyone else seen this behavior?<br /><br />Interesting... eh?<br /><br />Thanx tk;)</div>
    <div class="meta">Posted on 2002-09-17 22:33:53 by tk627</div>
   </div>
  </div>
 </body>
</html>