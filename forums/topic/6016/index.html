<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How can I know what DDRAW interface I'm using? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6016" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=6016">How can I know what DDRAW interface I'm using?</a></p>
   <div class="post" id="post-43068">
    <div class="subject"><a href="#post-43068">How can I know what DDRAW interface I'm using?</a></div>
    <div class="body">I just figure out how to get the ddraw.inc included with MASM32 to work.  Did a call to set cooperative level and got DD_OK:alright: <br /><br />I have DD8.1 so I guess I'm using the DD7 interface?<br /><br />Here is some code:<br /><pre><code><br />	invoke LoadLibrary, addr DdrawDll<br />	mov hDDlib, eax<br /><br />	invoke GetProcAddress, hDDlib, addr DDC<br /><br />	invoke DirectDrawCreate, 0,ADDR lpDD ,0<br />.<br />.<br />create window<br />.<br />.<br />	mov  ecx,&#91;lpDD&#93;<br />	mov  ecx,&#91;ecx&#93;<br /><br />	push 8<br />	push 0<br />	push hwnd<br />	call dword ptr&#91;ecx&#93;&#91;4&#93; ; SetCooperativeLevel<br /></code></pre><br /><br />The first parameter of DirectDrawCreate can be GUID or NULL.  If it is NULL, the active displaydriver is used.  Does that mean I'm using DD7.  If not, where can, and how do I use the GUID of DD7 as a parameter with DirectDrawCreate?<br /><br />Thanks.</div>
    <div class="meta">Posted on 2002-06-13 06:59:15 by ThoughtCriminal</div>
   </div>
   <div class="post" id="post-43346">
    <div class="subject"><a href="#post-43346">How can I know what DDRAW interface I'm using?</a></div>
    <div class="body">From the above code you are using IDirectDraw1 <br /><br />you will have to call QuerryInterface with the GUID of the desired DD interface or use CoCreateInstance with the required GUID</div>
    <div class="meta">Posted on 2002-06-14 09:27:45 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-43402">
    <div class="subject"><a href="#post-43402">How can I know what DDRAW interface I'm using?</a></div>
    <div class="body">Thanks, I'll see what I can find out then.....</div>
    <div class="meta">Posted on 2002-06-15 04:51:50 by ThoughtCriminal</div>
   </div>
  </div>
 </body>
</html>