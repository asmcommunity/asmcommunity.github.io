<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>GetWinVersionString - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15926" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15926">GetWinVersionString</a></p>
   <div class="post" id="post-123379">
    <div class="subject"><a href="#post-123379">GetWinVersionString</a></div>
    <div class="body">Hi folks<br /><br />I'm trying to write a proc for a dll that spits out the version information string in an argument to it. According to MSDN, the OSVERSIONINFOEX structure isn't available on WinNT SP5 or earlier. I want the proc to be able to retrieve and present info for all Windows versions including WINNT4 SP5 or earlier. Can someone suggest a way to do this. There's a C++ example in the MSDN library but it uses casting to check for the presence of OSVERSIONINFOEX, and if it isn't available the code switches to using the registry instead.<br /><br />Thanks in advance for your help guys,<br /><br />Regards,<br />Art</div>
    <div class="meta">Posted on 2003-11-03 23:51:26 by art_sands</div>
   </div>
   <div class="post" id="post-123411">
    <div class="subject"><a href="#post-123411">GetWinVersionString</a></div>
    <div class="body">hi,<br /><br />OSVERSIONINFOEX isn't available under win9x and before nt sp6 so use OSVERSIONINFO instead of OSVERSIONINFOEX (with GetVersionEx() also).<br /><br />h.</div>
    <div class="meta">Posted on 2003-11-04 10:03:08 by hitchhikr</div>
   </div>
   <div class="post" id="post-123419">
    <div class="subject"><a href="#post-123419">GetWinVersionString</a></div>
    <div class="body">thanks h<br /><br />  i figured that out already. anyway. thanx again for your help. I will post the code here for testing after i finished writing it. I don't have NT4, win95, or win NT3.51 available for testing.<br /><br />Regards,<br />Art</div>
    <div class="meta">Posted on 2003-11-04 12:05:17 by art_sands</div>
   </div>
  </div>
 </body>
</html>