<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Prototypes Of Native Apis - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=28813" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=113">Low Level Concepts</a> &raquo; <a href="../?id=28813">Prototypes Of Native Apis</a></p>
   <div class="post" id="post-203590">
    <div class="subject"><a href="#post-203590">Prototypes Of Native Apis</a></div>
    <div class="body">Please don&#039;t post some link or some book&#039;s name (like Gary Nebbet&#039;s book) listing the prototypes of the native APIs.<br />What I want is how can I reverse engineer the ntdll.dll and ntoskrnl.exe to find the prototype myself.(I have fairly good knowledge of reverse engineering so you can use the jargon associated with that).<br /><br />For Example, if I see the following code in the dissasembly of the above files<br /><pre><code><br />push sth<br />push sth_else<br />call 0x12345<br /></code></pre><br /><br />How do I know what is sth (is it a window handle or pointer to a string or whatever) and sth_else ?</div>
    <div class="meta">Posted on 2007-11-14 12:55:53 by shakuni</div>
   </div>
   <div class="post" id="post-203591">
    <div class="subject"><a href="#post-203591">Re: Prototypes Of Native Apis</a></div>
    <div class="body">The same if someone gives you only the following line of HLL code and the library source code of that function<pre><code>foo((void *)a, (void*)b)</code></pre><br /><br />Now, what is the actual type of those voids? You have to look inside foo&#039;s code to try to figure them out. And of course, it is possible that you will need to look inside functions that foo calls to completely reverse the type and even with that perhaps it will be not enough since you have no guarantees that all the code you have analysed actually accesses the whole data (even less if the same memory portion is an union or not).<br /><br />It is not a trivial task if that is you wanted to know, sometimes is very easy other times not (especially when the function is not a leaf or when the parameter doesn&#039;t seems to be fully touched).</div>
    <div class="meta">Posted on 2007-11-14 13:07:59 by LocoDelAssembly</div>
   </div>
   <div class="post" id="post-203593">
    <div class="subject"><a href="#post-203593">Re: Prototypes Of Native Apis</a></div>
    <div class="body"><div class="quote"><br />What I want is how can I reverse engineer the ntdll.dll and ntoskrnl.exe to find the prototype myself.else ?<br /></div><br /><br />seems pointless, you&#039;ll use the native method, and have to keep updating your code for another os (2k-&gt;vista etc), or service pack or possibly kb update... no sense in doing it really...</div>
    <div class="meta">Posted on 2007-11-14 13:15:25 by evlncrn8</div>
   </div>
  </div>
 </body>
</html>