<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>WinInet files download program - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7596" />
    <link rel="next" href="../?id=7596&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=7596">WinInet files download program</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=7596&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=7596&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="7596" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=7596&amp;page=2">&gt;</a><a href="../?id=7596&amp;page=2">&raquo;</a></form>   <div class="post" id="post-55183">
    <div class="subject"><a href="#post-55183">WinInet files download program</a></div>
    <div class="body">Hi!<br />I 've written a program based on WinInet that download files. It parses URL, can download using modem or proxy, select local directory for files and so on. Please test it and say how it works.<br />Thanks to all, <br />Mike</div>
    <div class="meta">Posted on 2002-08-28 05:54:18 by Mike</div>
   </div>
   <div class="post" id="post-55187">
    <div class="subject"><a href="#post-55187">excellent!</a></div>
    <div class="body">very nice ... clean code ... like it! :alright: <br /><br />maybe for the next version you can add<br />handler for redirectors and file size check,<br /><br />for example for &quot;http://www.google.com&quot;<br />it returns &quot;Success, 18221159 bytes downloaded.&quot;<br />and the html returned is only 2379bytes :tongue: <br /><br />keep up the good work,<br />TBD</div>
    <div class="meta">Posted on 2002-08-28 06:21:30 by TBD</div>
   </div>
   <div class="post" id="post-55225">
    <div class="subject"><a href="#post-55225">WinInet files download program</a></div>
    <div class="body">Thank you TBD!<br />You are right, there is some little error in algorithm and exept it I must change variable for file length: now I store file length in DWORD but there are a lot of files &gt; 4.2 Mb (2^32-1). All changes you'll see some days later. <br />But I don't know what you call as redirector. Can you describe it with more details?<br />Mike</div>
    <div class="meta">Posted on 2002-08-28 09:38:35 by Mike</div>
   </div>
   <div class="post" id="post-55229">
    <div class="subject"><a href="#post-55229">WinInet files download program</a></div>
    <div class="body">Just want to point out that 2^32 is 4 Gigabytes and not 4 megabytes... I'm sure there are few files out there that are bigger than this...<br /><br />--Chorus</div>
    <div class="meta">Posted on 2002-08-28 09:51:59 by chorus</div>
   </div>
   <div class="post" id="post-55289">
    <div class="subject"><a href="#post-55289">WinInet files download program</a></div>
    <div class="body">i think he meant<br />2^32-1 <br />in bits , not bytes</div>
    <div class="meta">Posted on 2002-08-28 21:15:12 by eko</div>
   </div>
   <div class="post" id="post-55299">
    <div class="subject"><a href="#post-55299">relocator</a></div>
    <div class="body"><strong>Mike:</strong> i was thinking for something like this in html files:<br />&lt;META HTTP-EQUIV=&quot;Refresh&quot; CONTENT=&quot;0;URL=http://www.google.com&quot;&gt;<br />but for this you need to have a HTML parser. bad ideea :)<br /><br />also i dont know why i cannot get any file by using this url<br /><a target="_blank" href="http://www.pocketgear.com/download.asp?product_id=631">http://www.pocketgear.com/download.asp?product_id=631</a><br /><br />HTTP download 1.5 by Iczelion timeouts too :confused:</div>
    <div class="meta">Posted on 2002-08-29 00:53:52 by TBD</div>
   </div>
   <div class="post" id="post-55302">
    <div class="subject"><a href="#post-55302">WinInet files download program</a></div>
    <div class="body"><pre><code><br />bazik@antares temp $ wget &#91;url&#93;http&#58;//www.pocketgear.com/download.asp?product_id=631&#91;/url&#93;<br />--08&#58;30&#58;32--  &#91;url&#93;http&#58;//www.pocketgear.com&#58;80/download.asp?product_id=631&#91;/url&#93;<br />           =&gt; `download.asp@product_id=631.1'<br />Connecting to &#91;url&#93;www.pocketgear.com&#58;80...&#91;/url&#93; connected!<br />HTTP request sent, awaiting response... 200 OK<br />Length&#58; 45,675 &#91;application/x-msdownload&#93;<br /><br />    0K -&gt; .......... .......... .......... .......... ....       &#91;100%&#93;<br /> <br />08&#58;30&#58;34 &#40;22.30 KB/s&#41; - `download.asp@product_id=631.1' saved &#91;45675/45675&#93;<br /></code></pre><br /><br />The filename is a bit fscked up though :)<br />Notice the stupid mime-type used there....</div>
    <div class="meta">Posted on 2002-08-29 01:33:13 by bazik</div>
   </div>
   <div class="post" id="post-55329">
    <div class="subject"><a href="#post-55329">WinInet files download program</a></div>
    <div class="body">Thanks to all!<br />Sorry for Mb &amp; Gb. I was not right. This edition better, there are no in it &quot;Success, 18221159 bytes downloaded.&quot; Exept it there some other changes.<br />I understand TBD's idea and I'll try to include it later. As I understand I may browse downloaded HTML file for references such as <a target="_blank" href="http://www.anysite.com/secondpage.html">http://www.anysite.com/secondpage.html</a> or <br /><a target="_blank" href="http://www.anysite.com/pic/prettygirl.jpg">http://www.anysite.com/pic/prettygirl.jpg</a> etc., insert them into list and download it by request. It's very interesting idea, thank you TBD.<br /><br />Regards, <br />Mike</div>
    <div class="meta">Posted on 2002-08-29 05:30:52 by Mike</div>
   </div>
   <div class="post" id="post-55332">
    <div class="subject"><a href="#post-55332">WinInet files download program</a></div>
    <div class="body">I understand why you can't download file from <a target="_blank" href="http://www.pocketgear.com/download.asp?product_id=631">http://www.pocketgear.com/download.asp?product_id=631</a><br />There was some logical error in algorithm. This version can download your file, you must only change file name during download. <br />I yet have been download your file. Try it!alright: <br /><br />Mike:</div>
    <div class="meta">Posted on 2002-08-29 06:32:34 by Mike</div>
   </div>
   <div class="post" id="post-55333">
    <div class="subject"><a href="#post-55333">WinInet files download program</a></div>
    <div class="body">working like a charm !!! :alright: <br />except now it doesnt autodetect the proxy as in 2.0 version :(<br /><br />also check your private messages :)<br />TBD</div>
    <div class="meta">Posted on 2002-08-29 06:38:29 by TBD</div>
   </div>
   <div class="post" id="post-55358">
    <div class="subject"><a href="#post-55358">WinInet files download program</a></div>
    <div class="body">Hi, TBD!<br /><br />In this version you can choice any mode for connecting <br />to Internet without problems. Program also save it. <br />For example, if you choice today Autodetect then <br />tomorrow program detects it automatically.<br /><br />Mike:alright:</div>
    <div class="meta">Posted on 2002-08-29 09:54:12 by Mike</div>
   </div>
   <div class="post" id="post-55443">
    <div class="subject"><a href="#post-55443">WinInet files download program</a></div>
    <div class="body">excelent :alright: <br /><br />do you plan to add something in the next version ?<br />or it is finished ? :)<br /><br />TBD<br />&lt;To Be Defined&gt;</div>
    <div class="meta">Posted on 2002-08-30 00:33:20 by TBD</div>
   </div>
   <div class="post" id="post-55493">
    <div class="subject"><a href="#post-55493">WinInet files download program</a></div>
    <div class="body">Certainly continuation will be. But now it is necessary to write the same program for WinSocks instead of WinInet. There there are more opportunities in WinSocks.<br />Mike</div>
    <div class="meta">Posted on 2002-08-30 10:30:41 by Mike</div>
   </div>
   <div class="post" id="post-55503">
    <div class="subject"><a href="#post-55503">WinInet files download program</a></div>
    <div class="body">Hi Mike<br /><br />Not bad! But if I close the main window all other download windows remained opened! And if I klick the close button nothing happens! The download doesn't stop, but it seems that no window message is processed. (no repainting, no activation of the window if I click in it. Maybe you could fix it.<br /><br />   :)  Marwin</div>
    <div class="meta">Posted on 2002-08-30 11:28:39 by Marwin</div>
   </div>
   <div class="post" id="post-55605">
    <div class="subject"><a href="#post-55605">WinInet files download program</a></div>
    <div class="body">Thank you Marvin!<br />You are right! A'll correct this bug, It may take a day.<br />Mike</div>
    <div class="meta">Posted on 2002-08-31 07:37:11 by Mike</div>
   </div>
   <div class="post" id="post-55766">
    <div class="subject"><a href="#post-55766">WinInet files download program</a></div>
    <div class="body">This version of the program close all dialogs and threads before exit.<br /><br />Thanks, <br />Mike</div>
    <div class="meta">Posted on 2002-09-02 02:31:51 by Mike</div>
   </div>
   <div class="post" id="post-76370">
    <div class="subject"><a href="#post-76370">WinInet files download program</a></div>
    <div class="body"><pre><code><br />DlgProc proc hWin&#58;DWORD,uMsg&#58;DWORD, wParam&#58;DWORD, lParam&#58;DWORD<br />	LOCAL Buffer&#91;128&#93;&#58;BYTE, hThread&#58;DWORD<br /></code></pre><br /><br />frankly, i never seen someone using LOCAL var in dlgproc to save thread handle like yours, Mike. actually i used to make it global var instead. i know its impossible because the thread is created dynamically. <br />but, i really dont understand how can it keep preserved while dlgproc is can be called several times? <br />is it the top of stack keep on same offset? would it be written or free up when exiting dlgproc? gosh, i really stupid and dont get how it done :(<br />would you tell me what wrong in my mind, Mike?<br /><br />thanks</div>
    <div class="meta">Posted on 2003-01-14 20:50:13 by dion</div>
   </div>
   <div class="post" id="post-76374">
    <div class="subject"><a href="#post-76374">WinInet files download program</a></div>
    <div class="body">It seem a pretty slow for me, but may be depend on connection<br />Your icon very nice :)</div>
    <div class="meta">Posted on 2003-01-14 21:11:05 by Halong</div>
   </div>
   <div class="post" id="post-76395">
    <div class="subject"><a href="#post-76395">WinInet files download program</a></div>
    <div class="body">hi Halong, i would to ask that one too ; but i'm waiting someone told me out the LOCAL problem above :(</div>
    <div class="meta">Posted on 2003-01-15 01:56:21 by dion</div>
   </div>
   <div class="post" id="post-76427">
    <div class="subject"><a href="#post-76427">WinInet files download program</a></div>
    <div class="body">Local variables resides in the stack. I can't recommend you to open file and store it's header (e.g. hFile) there, but sometimes you can use LOCALs.  You are right  sometimes there a lot of problems with local variables.<br /><br />Mike</div>
    <div class="meta">Posted on 2003-01-15 06:53:20 by Mike</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=7596&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=7596&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="7596" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=7596&amp;page=2">&gt;</a><a href="../?id=7596&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>