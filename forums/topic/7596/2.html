<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>WinInet files download program - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7596" />
  <link rel="prev" href="../?id=7596&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=7596">WinInet files download program</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=7596&amp;page=1" style="">&laquo;</a><a href="../?id=7596&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="7596" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-76543">
    <div class="subject"><a href="#post-76543">WinInet files download program</a></div>
    <div class="body">thanks Mike, but i talk about your source code here :)<br />how could you explain about hThread in your LOCAL?<br /><br />thanks</div>
    <div class="meta">Posted on 2003-01-15 21:03:22 by dion</div>
   </div>
   <div class="post" id="post-76633">
    <div class="subject"><a href="#post-76633">WinInet files download program</a></div>
    <div class="body">Agree, this code is not correct. I never close thread by <br />invoke TerminateThread, hThread, 0 ; in WM_CLOSE<br />Program works while thread close himself by <br />invoke ExitThread, 0<br />But what can you recommend me? I must download variable number of files. I can use array of hThreads and use those by counter. Another way is to write module for file downloading and another module that starts the first when it needs. Have you another ideas?<br /><br />Thanks,<br />Mike</div>
    <div class="meta">Posted on 2003-01-16 07:41:05 by Mike</div>
   </div>
   <div class="post" id="post-76767">
    <div class="subject"><a href="#post-76767">WinInet files download program</a></div>
    <div class="body">hi Mike, sorry, but i dont dispute the method. but, what i dont understand is how can hThread LOCAL var in stack doesnt get overwritten? like i said before, is it the dlgproc would be looped in somekind of messagepump? i mean it would be called and exit, and get called and exit, get called and exit and soon. so while it exit, would it free the stack? i dont understand in that point. would you mind telling me what wrong with my concept?<br /><br />thanks</div>
    <div class="meta">Posted on 2003-01-16 20:23:26 by dion</div>
   </div>
   <div class="post" id="post-76873">
    <div class="subject"><a href="#post-76873">WinInet files download program</a></div>
    <div class="body">Hi, Dion!<br /><br />hThread will lost so &lt;invoke TerminateThread, hThread, 0&gt; is not effective.<br />But 2 or more threads will use variables in different addresses. So there <br />are no problems while thread starts and stops himself normally, only. When <br />dialog program starts it allocates memory for local variables and automatically <br />free it when ends. Local variables must uses only for temporary variables.<br />hThread (hFile, hMem) in THIS CASE must not be locals, that's MY error.<br />My concept was wrong and I'll rewrite this program!<br /><br />Mike</div>
    <div class="meta">Posted on 2003-01-17 10:45:10 by Mike</div>
   </div>
   <div class="post" id="post-76940">
    <div class="subject"><a href="#post-76940">WinInet files download program</a></div>
    <div class="body">hi Mike, sorry to bother you again ;)<br />uhm... maybe i'm wrong looking in your code, gotta look more :o<br />wierd, if you said it is wrong, but it is work, eh?<br />argh... i'm eager to code something... but darn i dont have msdn in my hand :(</div>
    <div class="meta">Posted on 2003-01-17 20:42:17 by dion</div>
   </div>
   <div class="post" id="post-77015">
    <div class="subject"><a href="#post-77015">WinInet files download program</a></div>
    <div class="body">Hi!<br />There are a lot of programs that works. But 75% of those works not fully correctly because have some bugs.  E.g. another my program (recoder) sometimes blew up (with fire and not only :-)&gt; ) Approximately one hour ago it has been rewritten and now problem disappeared.<br />Msdn. I have no msdn too. I use only .hlp files but sometimes read msdn information via internet. <br />Mike</div>
    <div class="meta">Posted on 2003-01-18 09:04:13 by Mike</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=7596&amp;page=1" style="">&laquo;</a><a href="../?id=7596&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="7596" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>