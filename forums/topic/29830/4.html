<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>BHM File Format - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29830" />
  <link rel="prev" href="../?id=29830&amp;page=3" />  <link rel="next" href="../?id=29830&amp;page=5" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=29830">BHM File Format</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=29830&amp;page=1" style="">&laquo;</a><a href="../?id=29830&amp;page=3" style="">&lt;</a><input type="hidden" name="id" value="29830" /><input type="number" name="page" min="1" max="7" step="1" value="4" onchange="this.form.submit();" /><a href="../?id=29830&amp;page=5">&gt;</a><a href="../?id=29830&amp;page=7">&raquo;</a></form>   <div class="post" id="post-214552">
    <div class="subject"><a href="#post-214552">Re: BHM File Format</a></div>
    <div class="body">Well, I&#039;m not sure of X11 is even required. I am not using it directly, as far as I know. I let GLUT take care of the platform-specific windowing stuff. Which is why it also works on Windows without a problem.<br />So it mostly depends on what GLUT does on OS X, I think.<br /><br />I have been thinking of dropping GLUT in favour of my own code though... GLUT has a few bugs, and it is abandoned anyway. GLUT also doesn&#039;t allow you to use a specific version for an OpenGL context, as far as I know... Which is one of the points I mentioned above, I&#039;d like to support OGL 4.1 directly.<br />In that case I&#039;d need a Windows, X and native OS X implementation.<br /><br />How does OS X handle 32/64-bit by the way? Is it the same as in Windows, where a 32-bit executable will just work transparently on a 64-bit OS? In that case I wouldn&#039;t mind including a 32-bit version only, for x86. And I think ignoring PowerPC isn&#039;t a big deal either. Don&#039;t think many people still use those.</div>
    <div class="meta">Posted on 2011-07-09 15:15:41 by Scali</div>
   </div>
   <div class="post" id="post-214553">
    <div class="subject"><a href="#post-214553">Re: BHM File Format</a></div>
    <div class="body">Same as Windows, utilizing Compatibility Mode to run 32-bit apps natively in 64-bit Long Mode.</div>
    <div class="meta">Posted on 2011-07-09 20:20:00 by SpooK</div>
   </div>
   <div class="post" id="post-214554">
    <div class="subject"><a href="#post-214554">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br />I have been thinking of dropping GLUT in favour of my own code though... GLUT has a few bugs, and it is abandoned anyway.<br /></div><br /><br /><a target="_blank" href="http://www.sfml-dev.org/">SFML</a> might be a decent compromise between legacy GLUT and rolling your own.</div>
    <div class="meta">Posted on 2011-07-09 22:59:04 by SpooK</div>
   </div>
   <div class="post" id="post-214555">
    <div class="subject"><a href="#post-214555">Re: BHM File Format</a></div>
    <div class="body"><strong>Native OpenGL for Mac OS X Instructions</strong><br /><hr /><br />On top of the <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=29830.msg214549#msg214549">previous instructions</a>, modify <em>BHMFile-0.1a/src/BHM3DSample/GL/GLUX.cpp</em> as follows...<br /><br /><pre><code><br />/*<br /> GLUX (GL Useful eXtensions)<br /> Author: Scali<br /><br /> This code is released under the BSD license. See COPYRIGHT.txt for more information.<br /> */<br /><br />#include &quot;GLUX.h&quot;<br />#ifdef _WINDOWS<br />#include &lt;Windows.h&gt;<br />#include &lt;Wingdi.h&gt;<br />#elif defined(__APPLE__)<br />#include &lt;GLUT/glut.h&gt;<br />#else<br />#include &lt;GL/glx.h&gt;<br />#endif<br />#include &quot;FreeImage.h&quot;<br />#include &lt;stdio.h&gt;<br />#include &lt;string.h&gt;<br /><br />void gluxSwapInterval(int interval)<br />{<br />#ifdef _WINDOWS<br />	// http://www.opengl.org/registry/specs/EXT/wgl_swap_control.txt<br />#ifndef PFNWGLSWAPINTERVALFARPROC<br />	typedef BOOL (APIENTRY *PFNWGLSWAPINTERVALFARPROC)( int );<br />#endif /* PFNWGLSWAPINTERVALFARPROC */<br /><br />	PFNWGLSWAPINTERVALFARPROC wglSwapIntervalEXT = 0;<br /><br />	wglSwapIntervalEXT = (PFNWGLSWAPINTERVALFARPROC)wglGetProcAddress( &quot;wglSwapIntervalEXT&quot; );<br /><br />	if( wglSwapIntervalEXT )<br />		wglSwapIntervalEXT(interval);<br />#elif defined(__APPLE__)<br />	// Support for MESA swap control<br />#ifndef PFNGLXSWAPINTERVALMESAPROC<br />	typedef int (*PFNGLXSWAPINTERVALMESAPROC)(unsigned int interval);<br />#endif /* PFNGLXSWAPINTERVALMESAPROC */<br /><br />	PFNGLXSWAPINTERVALMESAPROC glXSwapIntervalMESA = (PFNGLXSWAPINTERVALMESAPROC)glutGetProcAddress(&quot;glXSwapIntervalMESA&quot;);<br /><br />	if (glXSwapIntervalMESA != NULL)<br />	{<br />		glXSwapIntervalMESA(interval);<br />		return;<br />	}<br /><br />	// Support for SGI swap control<br />	// http://www.opengl.org/registry/specs/SGI/swap_control.txt<br />#ifndef PFNGLXSWAPINTERVALSGIPROC<br />	typedef int ( * PFNGLXSWAPINTERVALSGIPROC) (int interval);<br />#endif /* PFNGLXSWAPINTERVALSGIPROC */<br /><br />	PFNGLXSWAPINTERVALSGIPROC glXSwapIntervalSGI = (PFNGLXSWAPINTERVALSGIPROC)glutGetProcAddress(&quot;glXSwapIntervalSGI&quot;);<br /><br />	if (glXSwapIntervalSGI != NULL)<br />	{<br />		glXSwapIntervalSGI(interval);<br />		return;<br />	}<br />	<br />	// Support for SGI WaitVideoSync<br />	// http://www.opengl.org/registry/specs/SGI/video_sync.txt<br />#ifndef PFNGLXWAITVIDEOSYNCSGIPROC<br />	typedef int ( * PFNGLXWAITVIDEOSYNCSGIPROC) (int divisor, int remainder, unsigned int *count);<br />#endif /* PFNGLXWAITVIDEOSYNCSGIPROC */<br /><br />	PFNGLXWAITVIDEOSYNCSGIPROC glXWaitVideoSyncSGI = (PFNGLXWAITVIDEOSYNCSGIPROC)glutGetProcAddress(&quot;glXWaitVideoSyncSGI&quot;);<br />	<br />	if (glXWaitVideoSyncSGI != NULL)<br />	{<br />		unsigned int count = 0;<br /><br />		glXWaitVideoSyncSGI((interval+1), 0, &amp;count);<br />	}<br />#else<br />	// Support for MESA swap control<br />#ifndef PFNGLXSWAPINTERVALMESAPROC<br />	typedef int (*PFNGLXSWAPINTERVALMESAPROC)(unsigned int interval);<br />#endif /* PFNGLXSWAPINTERVALMESAPROC */<br /><br />	PFNGLXSWAPINTERVALMESAPROC glXSwapIntervalMESA = (PFNGLXSWAPINTERVALMESAPROC)glXGetProcAddress((GLubyte*)&quot;glXSwapIntervalMESA&quot;);<br /><br />	if (glXSwapIntervalMESA != NULL)<br />	{<br />		glXSwapIntervalMESA(interval);<br />		return;<br />	}<br /><br />	// Support for SGI swap control<br />	// http://www.opengl.org/registry/specs/SGI/swap_control.txt<br />#ifndef PFNGLXSWAPINTERVALSGIPROC<br />	typedef int ( * PFNGLXSWAPINTERVALSGIPROC) (int interval);<br />#endif /* PFNGLXSWAPINTERVALSGIPROC */<br /><br />	PFNGLXSWAPINTERVALSGIPROC glXSwapIntervalSGI = (PFNGLXSWAPINTERVALSGIPROC)glXGetProcAddress((GLubyte*)&quot;glXSwapIntervalSGI&quot;);<br /><br />	if (glXSwapIntervalSGI != NULL)<br />	{<br />		glXSwapIntervalSGI(interval);<br />		return;<br />	}<br />	<br />	// Support for SGI WaitVideoSync<br />	// http://www.opengl.org/registry/specs/SGI/video_sync.txt<br />#ifndef PFNGLXWAITVIDEOSYNCSGIPROC<br />	typedef int ( * PFNGLXWAITVIDEOSYNCSGIPROC) (int divisor, int remainder, unsigned int *count);<br />#endif /* PFNGLXWAITVIDEOSYNCSGIPROC */<br /><br />	PFNGLXWAITVIDEOSYNCSGIPROC glXWaitVideoSyncSGI = (PFNGLXWAITVIDEOSYNCSGIPROC)glXGetProcAddress((GLubyte*)&quot;glXWaitVideoSyncSGI&quot;);<br />	<br />	if (glXWaitVideoSyncSGI != NULL)<br />	{<br />		unsigned int count = 0;<br /><br />		glXWaitVideoSyncSGI((interval+1), 0, &amp;count);<br />	}<br />#endif<br />}<br /></code></pre><br /><br />... and utilize the following Makefile to build:<br /><br /><pre><code><br />INCLUDE = -I/usr/X11R6/include/ -I/usr/local/include -I/opt/local/include -I. -I../BHMFile -I../<br />LIBDIR&nbsp; = -L/usr/X11R6/lib -L/usr/local/lib -L/opt/local/lib -L../ -L.<br /><br />COMPILERFLAGS = -Wall<br />CC = c++<br />CFLAGS = $(COMPILERFLAGS) $(INCLUDE)<br />LIBRARIES = -framework OpenGL -framework GLUT \<br />	-lGLEW -lm -lfreeimage -lbhmfile -lglux<br /><br />HEADERS	= State.h \<br />	Geometry/Object3D.h Geometry/Mesh.h Geometry/BHMObject.h \<br />	Geometry/VertexDescriptor.h Geometry/Buffer.h Geometry/VBOMesh.h \<br />	Material/Material.h Material/FFMaterial.h \<br />	Material/ShaderMaterial.h Material/SkinnedMaterial.h \<br />	Material/ASMMaterial.h Material/Texture.h Material/ASMShader.h \<br />	Material/Shader.h Material/Program.h Material/SkinnedASMMaterial.h&nbsp; \<br />	Anim/Interpolate.h Anim/Movable.h Anim/AnimKey.h Anim/PosKey.h&nbsp; \<br />	Anim/RotKey.h Anim/BezPosKey.h Anim/TCBRotKey.h<br />	<br /><br />SOURCES = Main.cpp State.cpp \<br />	Geometry/Object3D.cpp Geometry/Mesh.cpp Geometry/BHMObject.cpp \<br />	Geometry/VertexDescriptor.cpp Geometry/Buffer.cpp Geometry/VBOMesh.cpp \<br />	Material/Material.cpp Material/FFMaterial.cpp \<br />	Material/ShaderMaterial.cpp Material/SkinnedMaterial.cpp \<br />	Material/ASMMaterial.cpp Material/Texture.cpp Material/ASMShader.cpp \<br />	Material/Shader.cpp Material/Program.cpp Material/SkinnedASMMaterial.cpp \<br />	Anim/Interpolate.cpp Anim/Movable.cpp<br />	<br />BHM3DSample: $(HEADERS) $(SOURCES) libglux.a<br />	$(CC) $(CFLAGS) -g -o $@ $(LIBDIR) $&lt; $(SOURCES) $(LIBRARIES)<br /><br />libglux.a: GLUX<br />	ar rv libglux.a GLUX.o GLUXMath.o<br />	ranlib libglux.a<br /><br />GLUX: GL/GLTypes.h GL/GLUXMath.h GL/GLUX.h GL/GLUXUtil.h \<br />	GL/GLUXMath.cpp GL/GLUX.cpp<br />	$(CC) $(CFLAGS) -g -c $(LIBDIR) $&lt; GL/GLUX.cpp GL/GLUXMath.cpp<br /><br />clean:<br />	rm -rf *.o *.a BHM3DSample<br /><br />depend:<br />	$(CC) -E -MM *.c* &gt; .depend<br /></code></pre><br /><br />The results: On my computer, the X11 version takes a few seconds to start (busy loading X11) and averages 60 fps, while the native version starts instantly and averages 333 fps. I am not sure if this is a design/implementation characteristic of X11 for Mac, as 60 fps is a little too &quot;perfect&quot; of an arbitrary limit.</div>
    <div class="meta">Posted on 2011-07-09 23:56:17 by SpooK</div>
   </div>
   <div class="post" id="post-214556">
    <div class="subject"><a href="#post-214556">Re: BHM File Format</a></div>
    <div class="body">Ah, yes, I see the problem... Yea, the makefile would pull in the X11 libraries automatically. Which *can* work on OS X, but apparently they have their own framework with its own GLUT, which works better.<br />As you can see, the swap interval stuff is a mess. OpenGL never introduced a proper standardized vsync control, so I tried to wrap the different versions into a single function. It&#039;s not a catch-all. If it runs 60 fps, it probably couldn&#039;t disable vsync. I have the same problem with my FreeBSD system and its Intel IGP, it runs exactly 60 fps, which I think is vsync.<br />(And as you can see, Microsoft supplies a wgl function which DOES work, nice of them, why can&#039;t others follow suit?)<br /><br />By the way, 333 fps? What kind of machine spec is that?<br />My system runs at about 4500 fps in Windows. Core2 Duo 3 GHz with a GeForce GTX460.<br /></div>
    <div class="meta">Posted on 2011-07-10 03:40:49 by Scali</div>
   </div>
   <div class="post" id="post-214557">
    <div class="subject"><a href="#post-214557">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br />By the way, 333 fps? What kind of machine spec is that?<br /></div><br /><br />Core2 Duo 2.8GHz. ATI Radeon 2600HD.</div>
    <div class="meta">Posted on 2011-07-10 05:27:53 by SpooK</div>
   </div>
   <div class="post" id="post-214558">
    <div class="subject"><a href="#post-214558">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br /><div class="quote"><br />By the way, 333 fps? What kind of machine spec is that?<br /></div><br /><br />Core2 Duo 2.8GHz. ATI Radeon 2600HD.<br /></div><br /><br />Hum okay... still a tad slow, I guess... <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=29617.msg210733#msg210733">The D3D9 version did ~360 fps on an Intel Q35 IGP.</a> But I don&#039;t think we can expect 4000+ fps from a 2600HD even under the best of circumstances. I think it would still do 1000+ fps under Windows though.</div>
    <div class="meta">Posted on 2011-07-10 07:47:22 by Scali</div>
   </div>
   <div class="post" id="post-214566">
    <div class="subject"><a href="#post-214566">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br />My system runs at about 4500 fps in Windows. Core2 Duo 3 GHz with a GeForce GTX460.<br /></div><br /><br />OK... time to break out the test piggy...<br /><br />Test Box Specs:<br /><ul><br /><li>Dual Core Xeon @ 3GHz</li><br /><li>8GB DDR3 1066MHz RAM</li><br /><li>GeForce GTX 460 w/ 2GB RAM</li><br /></ul><br />Results:<br /><ul><br /><li>Windows 7 Home Premium 64-bit using 32-bit Example: ~6150 FPS</li><br /><li>Windows 7 Home Premium 64-bit using 64-bit Example: ~6400 FPS</li><br /><li>Mac OS X 10.6.8 under X11/64-bit: ~3000 FPS</li><br /><li>Mac OS X 10.6.8 Native/64-bit: ~5400 FPS</li><br /></ul><br />Both operating systems are kept clean and light, and even with Windows running under Bootcamp (in which shouldn&#039;t be a concern as it is mostly BIOS emulation) it does slightly outperform OS X on this setup.</div>
    <div class="meta">Posted on 2011-07-10 20:57:06 by SpooK</div>
   </div>
   <div class="post" id="post-214569">
    <div class="subject"><a href="#post-214569">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br /><div class="quote"><br />My system runs at about 4500 fps in Windows. Core2 Duo 3 GHz with a GeForce GTX460.<br /></div><br /><br />OK... time to break out the test piggy...<br /><br />Test Box Specs:<br /><ul><br /><li>Dual Core Xeon @ 3GHz</li><br /><li>8GB DDR3 1066MHz RAM</li><br /><li>GeForce GTX 460 w/ 2GB RAM</li><br /></ul><br />Results:<br /><ul><br /><li>Windows 7 Home Premium 64-bit using 32-bit Example: ~6150 FPS</li><br /><li>Windows 7 Home Premium 64-bit using 64-bit Example: ~6400 FPS</li><br /><li>Mac OS X 10.6.8 under X11/64-bit: ~3000 FPS</li><br /><li>Mac OS X 10.6.8 Native/64-bit: ~5400 FPS</li><br /></ul><br />Both operating systems are kept clean and light, and even with Windows running under Bootcamp (in which shouldn&#039;t be a concern as it is mostly BIOS emulation) it does slightly outperform OS X on this setup.<br /></div><br /><br />That looks a whole lot better. I think it makes quite a bit of difference that this is an nVidia card. nVidia&#039;s drivers for OpenGL have always been more mature, especially on alternative OSes. My Radeon 5770 was fine in Windows, but dramatic in linux, and not even supported at all in FreeBSD (and still isn&#039;t).<br />Interesting to see that the native version is so much faster than X11 by the way.<br /><br />Mind you, Win7 is not the ideal OS for OpenGL. I tested it in XP and XP x64 yesterday, and it went over 10000 fps.<br />And to think that DX9 is even faster than that.<br />Not that it really matters... Once you get to more realistic scenes, the difference will be negligible.</div>
    <div class="meta">Posted on 2011-07-11 02:57:11 by Scali</div>
   </div>
   <div class="post" id="post-214579">
    <div class="subject"><a href="#post-214579">Re: BHM File Format</a></div>
    <div class="body">That&#039;s why it&#039;s irrelevant to count in fps instead of milliseconds here, the nonlinearity, the big numbers, the OS and app logic overhead, etc, cant be bothered to look for good articles describing this :)<br /><br />FPS can have its use, but more in the 2-120 range I&#039;d say, and still it&#039;s important to keep nonlinearity in mind.<br /><br />I cant understand why theres no little moving graph showing the duration of the last few hundred frames in each and every modern graphic developer framework instead of an fps counter, this would be orders of magnitude superior. Imho with complex modern engines another big problem is hidden : heterogenous distribution of frame duration, with microstutters, lag, occasional long frames due to different parts of the engine running at different fps, caching, asynchronic things, multithread, data streaming and all those things that take us farther everyday from a beautiful realtime clockwork-like machine. Find me a modern game that has rock-solid frame rate and as little lag when you shake the mouse like crazy, as quake 3 on&nbsp; an Athlon 1000 with ps2 mouse and fixed pipe GF2MX on a CRT. (just trolling...am i? :) )<br />(and I know that the system I described is already incredibly non-deterministic, and that every frame is bound to be dependant on what is displayed. But it was, well. Shockingly fast. It also had windows Me :) )<br /></div>
    <div class="meta">Posted on 2011-07-11 22:50:40 by HeLLoWorld</div>
   </div>
   <div class="post" id="post-214580">
    <div class="subject"><a href="#post-214580">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br />That&#039;s why it&#039;s irrelevant to count in fps instead of milliseconds here, the nonlinearity, the big numbers, the OS and app logic overhead, etc, cant be bothered to look for good articles describing this :)<br /><br />FPS can have its use, but more in the 2-120 range I&#039;d say, and still it&#039;s important to keep nonlinearity in mind.</div><br /><br />You can easily calc the frame time from fps, so it&#039;s no big deal really (Saw the fps-argument before, always thought it was nonsensical. Guess it&#039;s another internet hype. You&#039;re talking to a guy who&#039;s been doing gfx for over 20 years. You develop a natural feel for these things over time).<br />3000 fps: 1000/3000 = 0.33 ms per frame<br />5400 fps: 1000/5400 = 0.18 ms per frame<br />6000 fps: 1000/6000 = 0.16 ms per frame<br />10000 fps: 1000/10000 = 0.10 ms per frame<br /><br />Doesn&#039;t really change the initial impression you got from fps.<br />Not sure what your point is about OS/app overhead, since this should show EXACTLY that (the GPU was the same in all cases, so we can assume that the actual render time is constant).<br />The code is identical for all platforms. Windows XP runs much faster than Windows 7 simply because there&#039;s less overhead (probably mostly because it doesn&#039;t have Aero).<br />And on OS X we can clearly see how X11 has a lot of additional overhead compared to native OpenGL as well.<br /><br />In a way it&#039;s amazing to see just how fast a GPU has become these days. This scene has more polygons and more complex rendering than an entire Quake level. Yet the performance is determined more by the OS overhead than by the actual GPU rendering time.<br />But as I said, when you get into more &#039;realistic&#039; framerates, these differences won&#039;t matter much.<br />For example, if you want to run at 100 fps, your frame time is 1000/100 = 10 ms. A ~0.3 ms margin between the OSes is negligible... Say you get 10.3 ms frametime instead, that would be 97 fps instead. Not a big deal really.<br /><br />However, I&#039;ve seen cases that were far worse. Take for example my Intel X3100 IGP... It gets 360 fps in DX9 if I use software VP. It gets 185 fps in DX9 with hardware vp. It gets 130 fps with OpenGL using vertex/fragment programs, and it gets about 80 fps with GLSL.<br />These are differences in overhead you&#039;re going to notice. Intel&#039;s OpenGL implementation is just very spotty, even on Windows.<br />But the difference between OS X and Windows here is not such a big deal (at least, on an nVidia card), and that&#039;s good to know.</div>
    <div class="meta">Posted on 2011-07-12 04:39:57 by Scali</div>
   </div>
   <div class="post" id="post-214582">
    <div class="subject"><a href="#post-214582">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br /><strong>Native OpenGL for Mac OS X Instructions</strong><br /><hr /><br />On top of the <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=29830.msg214549#msg214549">previous instructions</a>, modify <em>BHMFile-0.1a/src/BHM3DSample/GL/GLUX.cpp</em> as follows...</div><br /><br />Okay, upon closer inspection it appears that you just use glutGetProcAddress() instead of glXGetProcAddress(), and then the -framework flags in the makefile, rather than regular libs.<br /><br />This makes three different *GetProcAddress() functions already... so I&#039;m going to introduce a gluxGetProcAddress() that takes care of it.<br />By the looks of it, the rest of the code is the same as for non-Windows versions (the function prototypes and even the function names are the same).<br />I wonder though... glutGetProcAddress() is a function introduced by openglut (so it&#039;s not in *all* implementations of glut, not the one I use on Windows anyway). It abstracts between wglGetProcAddress() and glXGetProcAddress().... But what exactly does it do on Apple machines? Does it redirect to an Apple-specific version? Or is the glut implementation on Apple written in such a way that it *is* the Apple-specific version, and glXGetProcAddress() is some kind of wrapper?<br /><br />I&#039;ll have to look into the makefile syntax more closely, to see if there is a way to do any kind of conditionals (like #if defined(__APPLE__) ). If that doesn&#039;t work, I guess I must make different makefiles for different platforms. Which could theoretically be generated by a shell-script or such, which DOES support conditionals.</div>
    <div class="meta">Posted on 2011-07-12 07:54:45 by Scali</div>
   </div>
   <div class="post" id="post-214583">
    <div class="subject"><a href="#post-214583">Re: BHM File Format</a></div>
    <div class="body">Okay, my virtual Hackintosh can now run the BHM3DSample:<br /><img src="http://bohemiq.scali.eu.org/BHMOSX.png" /><br /><br />Given that it runs in software, performance is pretty good I guess.<br />It is running natively as well. No X11.<br />In fact, the X11 version compiles, but doesn&#039;t work in my VM. It complains about an invalid pixel format. Not sure if I can fix that. Could just be a shortcoming of the virtual videocard/poor driver support in X11.<br /><br />Now if I could package this as a .app, that&#039;d be pretty neat.<br />I&#039;d need to include FreeImage... the rest is linked statically I suppose, or preinstalled (I guess OpenGL/GLUT are standard on OS X?).<br /><br />In fact, could you point me to some handy tools for Mac development/deployment? Something similar to Dependency Walker on Windows perhaps? I&#039;m completely new to the platform...</div>
    <div class="meta">Posted on 2011-07-12 08:56:53 by Scali</div>
   </div>
   <div class="post" id="post-214584">
    <div class="subject"><a href="#post-214584">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br />I wonder though... glutGetProcAddress() is a function introduced by openglut (so it&#039;s not in *all* implementations of glut, not the one I use on Windows anyway). It abstracts between wglGetProcAddress() and glXGetProcAddress().... But what exactly does it do on Apple machines? Does it redirect to an Apple-specific version? Or is the glut implementation on Apple written in such a way that it *is* the Apple-specific version, and glXGetProcAddress() is some kind of wrapper?<br /></div><br /><br />I am not sure exactly, but I&#039;d be willing to bet it is a wrapper for something in tthe System or Application frameworks.</div>
    <div class="meta">Posted on 2011-07-12 10:47:19 by SpooK</div>
   </div>
   <div class="post" id="post-214585">
    <div class="subject"><a href="#post-214585">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br />In fact, the X11 version compiles, but doesn&#039;t work in my VM. It complains about an invalid pixel format. Not sure if I can fix that. Could just be a shortcoming of the virtual videocard/poor driver support in X11.<br /></div><br /><br />It would be interesting to see if it works better within <a target="_blank" href="http://www.virtualbox.org/">VirtualBox</a>.</div>
    <div class="meta">Posted on 2011-07-12 10:49:27 by SpooK</div>
   </div>
   <div class="post" id="post-214586">
    <div class="subject"><a href="#post-214586">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br />Something similar to Dependency Walker on Windows perhaps? I&#039;m completely new to the platform...<br /></div><br /><br />In my limited experience, the closest tool to that is <em>otool</em>. There is a GUI equivalent for it on Mac: <a target="_blank" href="http://code.google.com/p/macdependency/">macdependency</a>.</div>
    <div class="meta">Posted on 2011-07-12 10:53:20 by SpooK</div>
   </div>
   <div class="post" id="post-214587">
    <div class="subject"><a href="#post-214587">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br />In fact, could you point me to some handy tools for Mac development/deployment?<br /></div><br /><br />Beside the standard XCode SDK on Mac, you can try <a target="_blank" href="http://build1.openftd.org/fedora-cross-darwinx/">DarwinX</a> for cross-compilation under a Linux-based host.</div>
    <div class="meta">Posted on 2011-07-12 11:52:10 by SpooK</div>
   </div>
   <div class="post" id="post-214588">
    <div class="subject"><a href="#post-214588">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br /><div class="quote"><br />I wonder though... glutGetProcAddress() is a function introduced by openglut (so it&#039;s not in *all* implementations of glut, not the one I use on Windows anyway). It abstracts between wglGetProcAddress() and glXGetProcAddress().... But what exactly does it do on Apple machines? Does it redirect to an Apple-specific version? Or is the glut implementation on Apple written in such a way that it *is* the Apple-specific version, and glXGetProcAddress() is some kind of wrapper?<br /></div><br /><br />I am not sure exactly, but I&#039;d be willing to bet it is a wrapper for something in tthe System or Application frameworks.<br /></div><br /><br />Well, I did some digging with MacDependency first... didn&#039;t find any imports resembling any *GetProcAddress()...<br />So I dug a bit deeper. Found that the source code for the Mac version of GLUT is actually available on their website (and is just a slight modification of Mark Kilgard&#039;s original GLUT codebase).<br />Here it is:<br />http://developer.apple.com/library/mac/#samplecode/glut/Listings/macx_util_m.html<br /><br />Apparently it is just a lowlevel approach, similar to LoadLibrary()/GetProcAddress() in Windows, wrapped into a form that resembles wglGetProcAddress()/glXGetProcAddress(). This is the internal function, that is called by glutGetProcAddress(), which also still has wgl/glX paths in there.<br /><br />Well, that works for me. Don&#039;t see a need to paste this code directly into my codebase, I can just rely on Apple&#039;s GLUT to do that for me. That way I don&#039;t have to worry about the code breaking either.<br /><br />As for VirtualBox... might be better, but I haven&#039;t found a pre-installed image for it. The VMWare image is just one that I downloaded as-is. I don&#039;t have the installation media... and it might not be that easy to get it working in a non-Apple environment.</div>
    <div class="meta">Posted on 2011-07-12 12:17:56 by Scali</div>
   </div>
   <div class="post" id="post-214589">
    <div class="subject"><a href="#post-214589">Re: BHM File Format</a></div>
    <div class="body">I&#039;ve tried to package it as a .app: http://scali.scali.eu.org/BHM3DSample.zip<br />Not sure if I did the libraries right... the .app works in my VM, but I don&#039;t know if it picks the right libs, as I have them installed anyway.<br /><br />Edit: I think I got it now...<br />I tested it by just renaming my /opt/local/lib, so that it would only work if it grabbed the libraries from the bundle.<br />I had to use a Python script called <a target="_blank" href="http://pypi.python.org/pypi/macholib/">macholib</a> which rewrote the paths for the dylds from absolute /opt/local/lib to app-bundle relative references. It also automatically copied them into the app bundle.<br />Seems to work.</div>
    <div class="meta">Posted on 2011-07-12 15:07:41 by Scali</div>
   </div>
   <div class="post" id="post-214590">
    <div class="subject"><a href="#post-214590">Re: BHM File Format</a></div>
    <div class="body"><div class="quote"><br />Seems to work.<br /></div><br /><br />Works on 10.7/Lion.</div>
    <div class="meta">Posted on 2011-07-12 15:40:59 by SpooK</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=29830&amp;page=1" style="">&laquo;</a><a href="../?id=29830&amp;page=3" style="">&lt;</a><input type="hidden" name="id" value="29830" /><input type="number" name="page" min="1" max="7" step="1" value="4" onchange="this.form.submit();" /><a href="../?id=29830&amp;page=5">&gt;</a><a href="../?id=29830&amp;page=7">&raquo;</a></form>  </div>
 </body>
</html>