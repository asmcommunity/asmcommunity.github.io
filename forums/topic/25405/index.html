<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Taborder problem. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25405" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25405">Taborder problem.</a></p>
   <div class="post" id="post-185768">
    <div class="subject"><a href="#post-185768">Taborder problem.</a></div>
    <div class="body">Taborder don&#39;t work. This must be a simple problem. I can&#39;t find out why it doesn&#39;t work. <br /><pre><code><br />WinMain proc hInst:HINSTANCE,hPrevInst:HINSTANCE,CmdLine:LPSTR,CmdShow:DWORD<br />	LOCAL wc:WNDCLASSEX<br />	LOCAL msg:MSG<br />	LOCAL hwnd:HWND<br />	<br />	mov wc.cbSize,SIZEOF WNDCLASSEX<br />	mov wc.style,CS_HREDRAW or CS_VREDRAW<br />	mov wc.lpfnWndProc,OFFSET WndProc<br />	mov wc.cbClsExtra,0<br />	mov wc.cbWndExtra,0<br />;	mov wc.cbWndExtra,DLGWINDOWEXTRA<br />;	mov wc.cbWndExtra,32<br />;	mov wc.cbWndExtra,36<br />	push hInstance<br />	pop wc.hInstance<br />	mov wc.hbrBackground,COLOR_BTNFACE+1<br />	mov wc.lpszMenuName,0<br />	mov wc.lpszClassName,OFFSET ClassName<br />	<br />	invoke LoadIcon,0,IDI_APPLICATION<br />	mov wc.hIcon,eax<br />	mov wc.hIconSm,eax<br />	<br />	invoke LoadCursor,0,IDC_ARROW<br />	mov wc.hCursor,eax<br />	<br />	invoke RegisterClassEx,addr wc<br />	invoke CreateWindowEx,0,addr ClassName,addr AppName,WS_OVERLAPPEDWINDOW,\<br />		CW_USEDEFAULT,CW_USEDEFAULT,CW_USEDEFAULT,CW_USEDEFAULT,0,0,hInst,0<br />	mov&nbsp;  hwnd,eax<br />	<br />	invoke ShowWindow,hwnd,CmdShow<br />	invoke UpdateWindow,hwnd<br /><br />@@:	<br />	invoke GetMessage,addr msg,0,0,0<br />	.if eax==0<br />		jmp @F<br />	.endif<br />	invoke IsDialogMessage,hwnd, ADDR msg<br />&nbsp; 	.if eax==0<br />		invoke TranslateMessage,addr msg<br />		invoke DispatchMessage,addr msg<br />	.endif<br />	jmp @B<br />@@:	<br />	mov eax,msg.wParam<br />	ret<br />WinMain endp<br /><br />WndProc proc hwnd:HWND, uMsg:UINT, wParam:WPARAM, lParam:LPARAM<br />	<br />	.if uMsg==WM_DESTROY<br />		invoke PostQuitMessage,0<br />		<br />	.elseif uMsg==WM_CREATE<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke CreateWindowEx,WS_EX_CLIENTEDGE,addr szEdit, 0, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_VISIBLE Or WS_CHILD Or WS_VSCROLL Or ES_MULTILINE Or WS_TABSTOP, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10,10,470,100,hwnd,1000,hInstance, 0<br />		mov hEdt1,eax<br />		<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke CreateWindowEx,0,addr szButton,addr szButton,\<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_CHILD Or WS_VISIBLE Or WS_TABSTOP,\<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10,120,110,30,hwnd,1001,hInstance,0<br />&nbsp; &nbsp; &nbsp; &nbsp; mov hBtn1,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke CreateWindowEx,0,addr szButton,addr szButton, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_CHILD Or WS_VISIBLE Or WS_TABSTOP, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 120,120,140,30,hwnd,1002,hInstance,0<br />&nbsp; &nbsp; &nbsp; &nbsp; mov hBtn2,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke CreateWindowEx,0,addr szButton,addr szButton, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_CHILD Or WS_VISIBLE Or WS_TABSTOP, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 260,120,110,30,hwnd,1003,hInstance,0<br />&nbsp; &nbsp; &nbsp; &nbsp; mov hBtn3,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke CreateWindowEx,0,addr szButton,addr szButton, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_CHILD Or WS_VISIBLE Or WS_TABSTOP, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 370,120,110,30,hwnd,1004,hInstance,0<br />&nbsp; &nbsp; &nbsp; &nbsp; mov hBtn4,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke GetStockObject,DEFAULT_GUI_FONT<br />&nbsp; &nbsp; &nbsp; &nbsp; mov hFont,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,hEdt1,WM_SETFONT,hFont,TRUE <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,hBtn1,WM_SETFONT,hFont,TRUE <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,hBtn2,WM_SETFONT,hFont,TRUE <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,hBtn3,WM_SETFONT,hFont,TRUE <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke SendMessage,hBtn4,WM_SETFONT,hFont,TRUE <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />	.else<br />		invoke DefWindowProc,hwnd,uMsg,wParam,lParam		<br />		ret<br />	.endif<br />	<br />	xor eax,eax<br />	ret<br />WndProc endp<br /></code></pre><br /><br />I should say that if no window is on focus first tab focus edit window, next tab don&#39;t work. If a button is on focus first tab focus next button and so on till edit window focus but stops there.</div>
    <div class="meta">Posted on 2006-10-07 07:54:12 by minor28</div>
   </div>
   <div class="post" id="post-185790">
    <div class="subject"><a href="#post-185790">Re: Taborder problem.</a></div>
    <div class="body">Find the problem.<br /><div class="quote"><br />Because the dialog box keyboard interface uses direction keys to move between controls in a dialog box, an application cannot use these keys to scroll the contents of any modal dialog box or any modeless dialog box for which IsDialogMessage is called. When a dialog box has scroll bars, the application must provide an alternate keyboard interface for the scroll bars. Note that the mouse interface for scrolling is available when the system includes a mouse.<br /></div><br /><br />Now I must find a way to provide an alternate keyboard interface for the scroll bars.</div>
    <div class="meta">Posted on 2006-10-08 08:18:41 by minor28</div>
   </div>
  </div>
 </body>
</html>