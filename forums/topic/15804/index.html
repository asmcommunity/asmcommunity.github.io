<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Block File Execution - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15804" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15804">Block File Execution</a></p>
   <div class="post" id="post-122451">
    <div class="subject"><a href="#post-122451">Block File Execution</a></div>
    <div class="body">Hello,<br />id like to make a program for win98 what block first all open exe files.<br />the program should wait for a file execution and pop up a windows to ask user for permission.<br /><br />do i have to program a hook for shellexecute ?<br />i think i cant use it because when the hook send a message the file allready starts.<br />or should i patch the regkey for shellexecution to send the open file command to a dll first ?<br /><br />what must i do to get execution info and stop it so the file can only run if the user permit it ?<br /><br />Thanks</div>
    <div class="meta">Posted on 2003-10-25 13:11:47 by xanthos</div>
   </div>
   <div class="post" id="post-122457">
    <div class="subject"><a href="#post-122457">Block File Execution</a></div>
    <div class="body">If I remember correctly window makes use of CreateProcess and not ShellExceute to open executables.</div>
    <div class="meta">Posted on 2003-10-25 13:59:03 by roticv</div>
   </div>
  </div>
 </body>
</html>