<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Trouble while handing over parameters to a batch file - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6148" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6148">Trouble while handing over parameters to a batch file</a></p>
   <div class="post" id="post-44080">
    <div class="subject"><a href="#post-44080">Trouble while handing over parameters to a batch file</a></div>
    <div class="body"><u>Ok, here I am again</u> :rolleyes: <br /><br />Now I've got a problem to execute a batch file. My program hands over parameter to this batch file. When I consign only one or no parameter all is okay. But when I consign more than one parameter either nothing happens or the DOS-promt is opened instead of the batch file. I've already quoted the single parameters. But without having success. Here a listing of the used strings to help you understanding my trouble:<br /><br /><br />  ; hWindow : handle of the program-window<br />  ; Open    : contains &quot;OPEN&quot;, 0<br />  ; File    : contains &quot;e:\_marwin\mds\bin\batch.bat&quot;, 0<br />  ; Param   : contains &quot;e:\_marwin\mds\bin e:\_marwin\mds e:\_marwin\mds\mds\inc&quot;, 0<br /><br /><br /><br />invoke  ShellExecute, hWindow, ADDR Open, ADDR File, ADDR Param, 0, SW_SHOWNORMAL<br /><br /><br />  I thank you already in advance for your responses</div>
    <div class="meta">Posted on 2002-06-19 03:41:33 by Marwin</div>
   </div>
   <div class="post" id="post-44133">
    <div class="subject"><a href="#post-44133">Trouble while handing over parameters to a batch file</a></div>
    <div class="body">Does anyone know what I mean, or don't you know how to solve this problem ?? :(</div>
    <div class="meta">Posted on 2002-06-19 08:02:55 by Marwin</div>
   </div>
   <div class="post" id="post-44136">
    <div class="subject"><a href="#post-44136">Trouble while handing over parameters to a batch file</a></div>
    <div class="body">&gt;either nothing happens or the DOS-promt is opened instead of the batch file<br /><br />The &quot;dos prompt&quot; indicates at least that the file was executed.<br />Please post your batch file... perhaps you have a error there.<br /><br />BTW, you should also NOT set the workdirectory to &quot;0&quot;.</div>
    <div class="meta">Posted on 2002-06-19 08:10:07 by bazik</div>
   </div>
   <div class="post" id="post-44149">
    <div class="subject"><a href="#post-44149">Trouble while handing over parameters to a batch file</a></div>
    <div class="body">i am a foool. i'm so new to asm i havn't even tried ShellExec (some thing i do a lot in c) or even using a path. <br />i did this in masm and had no probs...<br /><br />Open       db &quot;OPEN&quot;, 0<br />File           db &quot;c:\code\tryme.bat&quot;, 0<br />Param      db &quot;c:\autoexec.bat c:\config.sys&quot;, 0<br />WorkPath db &quot;.\&quot;, 0 <br />....<br />....<br />invoke ShellExecute, hWin, ADDR Open, ADDR File, ADDR Param, addr WorkPath, SW_SHOW<br /><br />tryme.bat----<br />echo ..first one<br />type %1<br />echo ..second one<br />type %2<br /><br />and had no problems.again, sorry for the over hasty post.</div>
    <div class="meta">Posted on 2002-06-19 09:05:24 by Kremen</div>
   </div>
   <div class="post" id="post-44281">
    <div class="subject"><a href="#post-44281">Thanks for your responses</a></div>
    <div class="body">Ok, I'll try it again with respect to your answers. Hope it works now.:alright:</div>
    <div class="meta">Posted on 2002-06-20 05:11:25 by Marwin</div>
   </div>
  </div>
 </body>
</html>