<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Mouse coordinate on Treeview - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=11401" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=11401">Mouse coordinate on Treeview</a></p>
   <div class="post" id="post-86223">
    <div class="subject"><a href="#post-86223">Mouse coordinate on Treeview</a></div>
    <div class="body">Hi all<br /><br />I want to make a popup menu on a treeview control.<br />I use after WM_NOTIFY and NM_RCLICK event.<br /><br />                invoke CreatePopupMenu<br />                mov handle_menu,eax<br />                szText szstrExport,&quot;Export&quot;<br />                invoke AppendMenu,handle_menu,MF_STRING,1,addr szstrExport<br />and i would like to use:<br /><br />                invoke TrackPopupMenu,handle_menu,TPM_LEFTALIGN or TPM_RETURNCMD or TPM_TOPALIGN ,mouse_X,mouse_Y,NULL,hWnd,NULL<br /><br />My problem is to get mouse x,y on the treeview to draw popup menu at right location.<br /><br />Anyone can help me please ?<br /><br />Thanks<br /><br />Regards</div>
    <div class="meta">Posted on 2003-03-10 06:01:57 by sv_reverser</div>
   </div>
   <div class="post" id="post-86226">
    <div class="subject"><a href="#post-86226">Mouse coordinate on Treeview</a></div>
    <div class="body">You can probably use GetMessagePos:<br /><div class="quote">The GetMessagePos function retrieves the cursor position for the last message retrieved by the GetMessage function.<br /><strong>Syntax</strong><br />DWORD GetMessagePos(VOID);<br /><br /><strong>Return Value</strong><br />The return value specifies the x- and y-coordinates of the cursor position. The x-coordinate is the low order int and the y-coordinate is the high-order int. </div><br /><br />Thomas</div>
    <div class="meta">Posted on 2003-03-10 06:13:12 by Thomas</div>
   </div>
   <div class="post" id="post-86232">
    <div class="subject"><a href="#post-86232">Mouse coordinate on Treeview</a></div>
    <div class="body">Hi Thomas :alright: <br /><br />Thanks a lot !!!!!<br /><br />It works and MSDN GetMessagePos Function refers to another one : BOOL GetCursorPos( LPPOINT lpPoint);<br />wich works well too :)<br /><br />Regards<br /><br />SV</div>
    <div class="meta">Posted on 2003-03-10 07:17:02 by sv_reverser</div>
   </div>
   <div class="post" id="post-86233">
    <div class="subject"><a href="#post-86233">Mouse coordinate on Treeview</a></div>
    <div class="body">Yes but GetCursorPos gets the mouse position at the time this function is called while GetMessagePos will give the mouse position at the time of the right click (or any other message).  So GetMessagePos is more accurate.<br /><br />Thomas</div>
    <div class="meta">Posted on 2003-03-10 07:26:40 by Thomas</div>
   </div>
  </div>
 </body>
</html>