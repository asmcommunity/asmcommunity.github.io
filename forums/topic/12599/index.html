<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Locking a windows 2000 program - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12599" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12599">Locking a windows 2000 program</a></p>
   <div class="post" id="post-97506">
    <div class="subject"><a href="#post-97506">Locking a windows 2000 program</a></div>
    <div class="body">Hi all,<br /><br />I'm stuck.  I'm trying to find a good way to keep a program from being quit without authorization on a windows 2000 system.  Now I could do it on 9x with the SystemParametersInfo by setting the flag SPI_SETSCREENSAVERRUNNING -- but this was just a cheap trick (which I don't believe works with 2000)<br /><br />So my question: Is there another way to prevent logging out of a program either by administrative settings or through programming?<br /><br />note: I perfer not to have to create my own device driver to hook keyboard inputs... So anything would be helpful in this regard<br /><br />Sliver</div>
    <div class="meta">Posted on 2003-04-17 11:47:03 by Sliver</div>
   </div>
   <div class="post" id="post-97550">
    <div class="subject"><a href="#post-97550">Locking a windows 2000 program</a></div>
    <div class="body">You can prevent it being shut down by normal users by running it as a service, however you won't be able to have a user interface while running as a service.<br /><br />If you do have a UI, you could intercept the WM_CLOSE message, check the security context of the current user, and if the user is not in the admin group then cancel the WM_CLOSE. This method is not totally reliable, as the user could still use the task manager to shut the app down.</div>
    <div class="meta">Posted on 2003-04-17 17:42:43 by sluggy</div>
   </div>
   <div class="post" id="post-97564">
    <div class="subject"><a href="#post-97564">Locking a windows 2000 program</a></div>
    <div class="body"><div class="quote"><br />This method is not totally reliable, as the user could still use the task manager to shut the app down. </div><br /><br />Not if you block this.<br /><br />See: <a target="_blank" href="http://internals.com/utilities/winnt/stickyapp32/StickyApp32.zip">http://internals.com/utilities/winnt/stickyapp32/StickyApp32.zip</a></div>
    <div class="meta">Posted on 2003-04-17 19:44:16 by bazik</div>
   </div>
   <div class="post" id="post-97566">
    <div class="subject"><a href="#post-97566">Locking a windows 2000 program</a></div>
    <div class="body">I can imagine some instancies where it might be better to have a second application which insures the first is running.  This would allow the user to quit (reset) the application in the event of a problem, but also gaurantee an instance of the program is running.  This second application could be run as a service as suggested by <strong>sluggy</strong>.</div>
    <div class="meta">Posted on 2003-04-17 20:07:35 by bitRAKE</div>
   </div>
  </div>
 </body>
</html>