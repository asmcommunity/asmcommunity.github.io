<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Intel vs AT&amp;T syntax - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30279" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=30279">Intel vs AT&amp;T syntax</a></p>
   <div class="post" id="post-213383">
    <div class="subject"><a href="#post-213383">Intel vs AT&amp;T syntax</a></div>
    <div class="body">I&#039;m trying to copy a section of assembly language into a C program, but I&#039;m having issues making the code translate because the source is in Intel format and the C compiler I&#039;m using (MinGW through Bloodshed Dev C++ on Windows) accepts only AT&amp;T syntax. &nbsp;I&#039;ve gotten everything but a single instruction to work flawlessly (disassembling the two programs shows my code is identical, line for line until the problematic section). &nbsp;The instruction that is giving me trouble is &quot;fild&quot;:<br /><pre><code><br />push &nbsp; &nbsp;edx<br />push &nbsp; &nbsp;eax<br />fild qword ptr <br /></code></pre><br /><br />The code that I put in my C program is:<br /><pre><code><br />__asm(&quot;push %edx&quot;);<br />__asm(&quot;push %eax&quot;);<br />__asm(&quot;fild (%esp)&quot;);<br /></code></pre><br />The issue is that the two instructions load different values into the ST0 register (verified in a debugger). &nbsp;In both cases, eax and edx have the same values before pushing (eax = 0xFE8BC1A0, edx = 0x00000000, verified in a debugger). In the assembly program, the value 4.270571936e9 is loaded into ST0, but in my C program it&#039;s very different: -1.5968e4. I looked at the instructions (in Intel format) generated by my program by doing a disassembly:<br /><pre><code><br />push &nbsp; &nbsp;edx<br />push &nbsp; &nbsp;eax<br />fild &nbsp; &nbsp;word ptr <br /></code></pre><br />So it seems that it&#039;s trying to act on a word instead of a qword. But, nothing I try fixes the problem. &nbsp;I read that you can append certain letters to an instruction in AT&amp;T format to force the instruction to act on certain sizes. &nbsp;So, I appended some letters to &quot;fild&quot; to hopefully make it act on a qword. &nbsp;Appending &quot;L&quot; loaded -2.439536e7 into ST0, while appending &quot;Q&quot; loaded 4.270571936e9 into ST0, and appending &quot;S&quot; loaded -1.5968e4. &nbsp;I tried every letter of the alphabet as a suffix, but those were the only that worked (&quot;B&quot; and &quot;W&quot; generated messages indicating they are valid, but not for this instruction for some reason).<br /><br />I&#039;ve been tearing my hair out over this because nothing I do seems to fix the problem. &nbsp;If anyone has any ideas or suggestions about the issue I would love to hear about it!</div>
    <div class="meta">Posted on 2010-10-23 20:38:19 by skunkiller3</div>
   </div>
   <div class="post" id="post-213384">
    <div class="subject"><a href="#post-213384">Re: Intel vs AT&amp;T syntax</a></div>
    <div class="body">Start by checking your disassembly in another disassembler (you did not mention which you used, and not all disassemblers are equal).<br /><br />There&#039;s a good chance that your code DID assemble correctly, but that the disassembler is unaware of &quot;size prefixed&quot; instructions.<br /><br /></div>
    <div class="meta">Posted on 2010-10-23 21:48:12 by Homer</div>
   </div>
   <div class="post" id="post-213385">
    <div class="subject"><a href="#post-213385">Re: Intel vs AT&amp;T syntax</a></div>
    <div class="body"><div class="quote">In the assembly program, the value 4.270571936e9 is loaded into ST0<br />...<br />while appending &quot;Q&quot; loaded 4.270571936e9 into ST0</div><br /><br />Isn&#039;t that what you were trying to do??</div>
    <div class="meta">Posted on 2010-10-23 22:12:50 by Raymond</div>
   </div>
   <div class="post" id="post-213386">
    <div class="subject"><a href="#post-213386">Re: Intel vs AT&amp;T syntax</a></div>
    <div class="body">Shoot, you&#039;re right Raymond. Well, that solves this issue. &quot;fildq&quot; loads the correct value.&nbsp; I must have additional errors later in my program when I print the value out later, because the values are different there. But, that&#039;s an issue for another day and another forum&nbsp; 8)<br /><br />By the way, Homer.&nbsp; I neglected to mention that the first section of code above (the source of my code translation effort) is in fact a disassembly.&nbsp; I&#039;m reversing a CrackMe program for the fun of it.&nbsp; I&#039;m using IDApro, by the way, for both disassembly and debug. The disassembler does show that in the original program it&#039;s a QWORD and in my C program it&#039;s a regular word.<br /><br />Thanks for your help, both of you!</div>
    <div class="meta">Posted on 2010-10-23 22:32:38 by skunkiller3</div>
   </div>
  </div>
 </body>
</html>