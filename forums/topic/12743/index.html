<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Using Dll Functions - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12743" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12743">Using Dll Functions</a></p>
   <div class="post" id="post-98556">
    <div class="subject"><a href="#post-98556">Using Dll Functions</a></div>
    <div class="body">How can i create a function in the DLL in which i can push my Parameters and then call the procedure from the DLL eg:-<br />*******************************<br />MyProgram.asm<br />*******************************<br /> 			push OFFSET MyMsg<br />			push OFFSET MyCap<br />                                                call <br /><br />Here TestHelloAddr Function displays a messagebox but i want the user to<br />push his text and caption and then call the Procedure.<br />So how do i create such a function in DLL such that i will except the<br />parameters from the user and then use it in the function???<br /><br />Thankx in advance.</div>
    <div class="meta">Posted on 2003-04-22 05:09:18 by telophase</div>
   </div>
   <div class="post" id="post-98564">
    <div class="subject"><a href="#post-98564">Using Dll Functions</a></div>
    <div class="body">How about this example?<br /><br />Mike</div>
    <div class="meta">Posted on 2003-04-22 05:56:46 by Mike</div>
   </div>
   <div class="post" id="post-98829">
    <div class="subject"><a href="#post-98829">Using Dll Functions</a></div>
    <div class="body">Thankyou  Mike for your code it has helped me a lot.<br />But i still have 2 queries:-<br /><br />In the function that you have defined in the DLL you have used szMsg:DWORD<br /><br />is it necessary to use the sz Parameter in case of strings or you have used it to<br /><br />distinguish the function and also you have used szMsg:DWORD should DWORD be always<br /><br />used or i will vary on the API that you are calling<br /><br />	MsgBox proc szMsg:DWORD, szTitle:DWORD<br />	invoke MessageBox,NULL, szMsg, szTitle, MB_OK<br />	ret	<br />	MsgBox endp</div>
    <div class="meta">Posted on 2003-04-23 08:55:55 by telophase</div>
   </div>
   <div class="post" id="post-98833">
    <div class="subject"><a href="#post-98833">Using Dll Functions</a></div>
    <div class="body">Hi telophase,<br /><br />The sz prefix is just a naming convention (<strong>s</strong>tring <strong>z</strong>ero terminated) you can use it or not, it's up to you. I haven't looked at the DLL example but the parameters that you are using are pointers to strings, in a 32 bit environment these will always be DWORDs. I only use DWORDs as parameters with DLLs but you can use any valid type that you want as long as the calling program is capable of passing that type, all languages are capable of passing DWORDs.</div>
    <div class="meta">Posted on 2003-04-23 09:11:28 by donkey</div>
   </div>
   <div class="post" id="post-98834">
    <div class="subject"><a href="#post-98834">Thankyou</a></div>
    <div class="body">Thankyou donkey i have understood the concept well.<br />Thanks for your help <br />:grin:</div>
    <div class="meta">Posted on 2003-04-23 09:15:06 by telophase</div>
   </div>
   <div class="post" id="post-98844">
    <div class="subject"><a href="#post-98844">Using Dll Functions</a></div>
    <div class="body">Well, just take it as a form of hungarian notation. It is used so that it would be easier to read and understand what the code is saying.  By the way, I think there is something wrong with the usuage of the prefix sz. I think it should be pMsg and pTitle.</div>
    <div class="meta">Posted on 2003-04-23 09:48:38 by roticv</div>
   </div>
   <div class="post" id="post-98846">
    <div class="subject"><a href="#post-98846">Using Dll Functions</a></div>
    <div class="body">p would just imply pointer - sz is more intuitive. You can go psz if you want to :). It's a matter of taste anyway.</div>
    <div class="meta">Posted on 2003-04-23 09:52:51 by f0dder</div>
   </div>
   <div class="post" id="post-98848">
    <div class="subject"><a href="#post-98848">Using Dll Functions</a></div>
    <div class="body">Haha... My style would be not to use prefix except for handles.</div>
    <div class="meta">Posted on 2003-04-23 09:55:12 by roticv</div>
   </div>
  </div>
 </body>
</html>