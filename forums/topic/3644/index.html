<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>adding assembly functions to VC++ - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3644" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3644">adding assembly functions to VC++</a></p>
   <div class="post" id="post-24324">
    <div class="subject"><a href="#post-24324">adding assembly functions to VC++</a></div>
    <div class="body">I noticed alot of people on the <a target="_blank" href="www.cprogramming.com">www.cprogramming.com</a> message board talking about using the _asm{} inline thing to replace some stuff that is compiled iniffeciently.  I read that you can make functions in assembly and call them from C++.  I've seen how to use asm for the main body of the function, and do everything.   <br /><br /><br />addsomething(int X, int Y)<br />{<br />_asm<br />{assembly here}<br /><br />}<br /><br /><br />I don't know much about assembly yet, but I'm wondering if I go about it like that, will I be losing many advantages of using assembly?<br />Can I call one of my C++ functions from within a block of assembly like that?<br /><br />I've seen a tutorial mention that you can compile assembly as a library or something and use it for calling it's functions from C++<br /><br />If you know where I can find resources that discuss this kind of stuff in detail I'd appreciate it.<br /><br />Thanks in advance.</div>
    <div class="meta">Posted on 2002-02-15 00:56:38 by WebSnozz</div>
   </div>
   <div class="post" id="post-24327">
    <div class="subject"><a href="#post-24327">adding assembly functions to VC++</a></div>
    <div class="body">snozz,<br /><br />there are a couple of approaches to using assembler in VC++. You can either write it inline as you have mentioned which may effect some of the internal optimisation or you can write seperate modules and link them into your C++ program which is probably a better way to do it. For VC++ you will need to use MASM to get the correct module format. You will of course have to write your own prototypes in VC++ for the assembler modules you write.<br /><br />To mix inline assembler and high level code, you will have to understand the conventions for register preservations used by VC++. With API calls its simple enough but with C++ functionality, you will have to read up the data with the VC++ compiler.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-02-15 01:34:25 by hutch--</div>
   </div>
   <div class="post" id="post-24329">
    <div class="subject"><a href="#post-24329">adding assembly functions to VC++</a></div>
    <div class="body">When you say I have to use MASM, is MASM32 an option if I go the route of linking?</div>
    <div class="meta">Posted on 2002-02-15 01:42:12 by WebSnozz</div>
   </div>
   <div class="post" id="post-24331">
    <div class="subject"><a href="#post-24331">adding assembly functions to VC++</a></div>
    <div class="body">snozz,<br /><br />MASM32 is built using ML.EXE which you need to assembler a module. You use the version of link that comes with the compiler for your VC++ code.<br /><br />MASM32 has the information to build libraries out of modules and this is probably the most efficient way to handle assembler modules in VC++.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-02-15 01:57:26 by hutch--</div>
   </div>
   <div class="post" id="post-24389">
    <div class="subject"><a href="#post-24389">adding assembly functions to VC++</a></div>
    <div class="body">If you are doing any calculations inside a function, be sure to save all the final result to <strong>memory</strong>, don't expect EAX will be returned as the original value like we do in pure ASM. You can't create MASM stye macros(maybe if you use the linker that comes with masm32 it'll work). Remember that when you link inside VC++, the linker isn't MASM.<br /><br />Happy Coding!!!</div>
    <div class="meta">Posted on 2002-02-15 12:29:16 by stryker</div>
   </div>
   <div class="post" id="post-24398">
    <div class="subject"><a href="#post-24398">adding assembly functions to VC++</a></div>
    <div class="body">I attached a VC project showing one approach.  It's a simple program that finds the area of a circle, which isn't important, but it calls an assembly funciton to find it.  In the workspace window right click on the areaproc.asm file and look at the custom build settings.  You need to adjust the path to point to where ml.exe is installed on your system.  If you have the processor pack for VC installed, you shouldn't need to specify the path.<br /><br />HTH,<br />malone</div>
    <div class="meta">Posted on 2002-02-15 15:18:58 by malone</div>
   </div>
   <div class="post" id="post-24426">
    <div class="subject"><a href="#post-24426">adding assembly functions to VC++</a></div>
    <div class="body">I'll check that out, thanks all to all of you.:alright:</div>
    <div class="meta">Posted on 2002-02-15 17:55:25 by WebSnozz</div>
   </div>
  </div>
 </body>
</html>