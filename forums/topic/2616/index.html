<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Heres a Shell Namespace Extension sample - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2616" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=2616">Heres a Shell Namespace Extension sample</a></p>
   <div class="post" id="post-16648">
    <div class="subject"><a href="#post-16648">Heres a Shell Namespace Extension sample</a></div>
    <div class="body">Hi guys,<br /><br />the last week I have converted REGVIEW, a shell namespace extension sample from MS, to ASM. Such a code makes heavily usage of COM and it cannot be placed in 10 lines of code, so it is not always easy to understand. But I think its good as a base for own experiments.<br /><br />Have a look at it and tell me what you think.<br /><br />japheth</div>
    <div class="meta">Posted on 2001-12-29 15:25:26 by japheth</div>
   </div>
   <div class="post" id="post-16753">
    <div class="subject"><a href="#post-16753">Heres a Shell Namespace Extension sample</a></div>
    <div class="body">Japheth,<br /><br />I don't have nmake. Could you please include the assembled dll file so I can get an idea of how it works before I start to study the code?</div>
    <div class="meta">Posted on 2001-12-30 03:40:16 by Qweerdy</div>
   </div>
   <div class="post" id="post-16795">
    <div class="subject"><a href="#post-16795">Heres a Shell Namespace Extension sample</a></div>
    <div class="body">Qweerdy,<br /><br />the dll (NAMSPEXT.DLL) was included in the package.<br /><br />I have played around with the code now for some time and found some memory leaks. So here is my improved version.</div>
    <div class="meta">Posted on 2001-12-30 09:41:01 by japheth</div>
   </div>
   <div class="post" id="post-17204">
    <div class="subject"><a href="#post-17204">Heres a Shell Namespace Extension sample</a></div>
    <div class="body">So, here is my &quot;last&quot; version. Now all files are converted to ASM,  some &quot;optimization&quot; has been done and the &quot;last&quot; bugs has been eliminated :) . <br /><br />Please note: after registering the dll you should restart the shell<br /><br />japheth</div>
    <div class="meta">Posted on 2002-01-02 04:18:35 by japheth</div>
   </div>
   <div class="post" id="post-17380">
    <div class="subject"><a href="#post-17380">Heres a Shell Namespace Extension sample</a></div>
    <div class="body">How do I uninstall it?</div>
    <div class="meta">Posted on 2002-01-03 04:42:17 by Qweerdy</div>
   </div>
   <div class="post" id="post-17384">
    <div class="subject"><a href="#post-17384">Heres a Shell Namespace Extension sample</a></div>
    <div class="body">:grin: <br /><br />Impossible, sorry.</div>
    <div class="meta">Posted on 2002-01-03 05:34:49 by japheth</div>
   </div>
   <div class="post" id="post-17398">
    <div class="subject"><a href="#post-17398">Heres a Shell Namespace Extension sample</a></div>
    <div class="body">Asshole :mad: <br /><br />Anyway, with that out of the way, this is what I did:<br />I removed the clsid manually from the registry (since resvr32 /u didn't work...), restarted, and deleted the icon from the desktop. I no longer see any of the modifications, but I just want to know: should this be all, or are there more things I should delete from my registry?</div>
    <div class="meta">Posted on 2002-01-03 08:58:26 by Qweerdy</div>
   </div>
   <div class="post" id="post-17400">
    <div class="subject"><a href="#post-17400">Heres a Shell Namespace Extension sample</a></div>
    <div class="body">Queerdy,<br /><br />since you have asked so polite :) I'll give you a hint: look in proc DllRegisterServer (located in NamSpExt.asm). This proc does all the register stuff and should be easy to understand :) .<br /><br />japheth</div>
    <div class="meta">Posted on 2002-01-03 09:41:55 by japheth</div>
   </div>
   <div class="post" id="post-17410">
    <div class="subject"><a href="#post-17410">Heres a Shell Namespace Extension sample</a></div>
    <div class="body">:)  Thanx<br /><br />I only missed the &quot;Software\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\%s&quot; key, but when I looked, it was already gone! I guess Win98 deleted it when it found the clsid was deleted... big surprise there, I've never seen Win98 do anything so intelligent :cool:</div>
    <div class="meta">Posted on 2002-01-03 11:36:52 by Qweerdy</div>
   </div>
   <div class="post" id="post-17568">
    <div class="subject"><a href="#post-17568">Well, actually, it was removed when you deleted the icon</a></div>
    <div class="body">Qweerdy: The shell namespace clsid didn't removed itself when you deleted the clsid for the dll. It removed itself when you deleted the icon from the desktop. Normally, you wouldn't have been able to delete it, but since the namspext clsid was removed, you were able to delete it. <br /><br />japheth: Thanks a lot for bringing this sample, I used it a couple of years ago (the microsoft version) and lost track of it. It's great!<br />Your's even better! I'll look for the write enabled version or try to update it if I can get some time. Thanks again!<br /><br />The registry is just full of surprises...</div>
    <div class="meta">Posted on 2002-01-04 11:28:13 by Silas</div>
   </div>
  </div>
 </body>
</html>