<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ability of api hooking ? w.r.t files - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16925" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=12">The Heap</a> &raquo; <a href="../?id=16925">ability of api hooking ? w.r.t files</a></p>
   <div class="post" id="post-131312">
    <div class="subject"><a href="#post-131312">ability of api hooking ? w.r.t files</a></div>
    <div class="body">Just a quick question, I am currently investigating<br />the security of an app I have, and am wondering if<br />it would be relatively simply to hook the file-opening<br />API such that I can be aware of the first few bytes of<br />the file are before returning the handle to the program<br />that actually requested it opened ... I am assuming its<br />possible but just wanted confirmation from someone<br />with a bit more knowledge than me ....<br /><br />apprecate it :)</div>
    <div class="meta">Posted on 2004-01-21 21:20:57 by latte</div>
   </div>
   <div class="post" id="post-131333">
    <div class="subject"><a href="#post-131333">ability of api hooking ? w.r.t files</a></div>
    <div class="body">I sure hope you're not planning to use this for evil-doing...<br /><br />You can CreateProcess in suspended mode, and inject code to patch the ReadFile IAT entry with code of your own. This will trap one particular application. Will not handle GetProcAddress imports, nor &quot;unconventional&quot; ways of doing imports.<br /><br />If you want full hooking, you'll have to write a driver and trap at a lower level.</div>
    <div class="meta">Posted on 2004-01-22 03:36:01 by f0dder</div>
   </div>
   <div class="post" id="post-131335">
    <div class="subject"><a href="#post-131335">ability of api hooking ? w.r.t files</a></div>
    <div class="body">f0dder, thanks for the reply ...<br /><br />no, i am not using it for anything bad :) I don't really need to know<br />how, just if .. but it seems its harder than i thought ..., but still possible,<br />but its not as simple as just hooking the &quot;ReadFile&quot; function...?<br /><br />i.e:<pre><code>pOpenProcess = &#40;OPENPROCESS_PROC&#41;HookAPIFunction&#40;GetModuleHandle&#40;NULL&#41;, &quot;KERNEL32.DLL&quot;, &quot;OpenProcess&quot;, &#40;PROC&#41;OpenProcess_Handler&#41;;</code></pre> is used in the  source of a demo hooking ap from sys-internals, the same won't work for Readfile ?</div>
    <div class="meta">Posted on 2004-01-22 03:49:11 by latte</div>
   </div>
   <div class="post" id="post-131336">
    <div class="subject"><a href="#post-131336">ability of api hooking ? w.r.t files</a></div>
    <div class="body">or is that doing exactly what you said, but just in the dll and not the<br />actual executable... i think so.<br /><br />let me know if i'm wrong ...<br /><br />thanks again :)</div>
    <div class="meta">Posted on 2004-01-22 03:53:05 by latte</div>
   </div>
  </div>
 </body>
</html>