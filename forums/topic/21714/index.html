<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>File delete across all Win32 OSes - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21714" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21714">File delete across all Win32 OSes</a></p>
   <div class="post" id="post-163816">
    <div class="subject"><a href="#post-163816">File delete across all Win32 OSes</a></div>
    <div class="body">I have some code that uses SHFileOperation, but my Win32.hlp says it doesn&#39;t work on NT.(Does that include NT4/2K/XP?)<br /><br />Is there file delete options that work on Win95+ ?<br />Or would you have to do an OS detection and then go from there ?<br /><br />Thanks.</div>
    <div class="meta">Posted on 2005-08-27 09:02:28 by skywalker</div>
   </div>
   <div class="post" id="post-163817">
    <div class="subject"><a href="#post-163817">Re: File delete across all Win32 OSes</a></div>
    <div class="body"><strong>SHFileOperation:</strong><br /><em>Windows NT/2000</em>: Requires Windows NT 4.0 or later. <br /><em>Windows 95/98/Me</em>: Requires Windows 95 or later. <br /><br />...so this should be a pretty safe function to use.<br /><br />If you just want to delete a file without the shell stuff, use DeleteFile which is supported even on NT3.1<br /><br />PS: win32.hlp is somewhat crappy, if you&#39;re on broadband you should get the PlatformSDK.<br /></div>
    <div class="meta">Posted on 2005-08-27 09:11:11 by f0dder</div>
   </div>
   <div class="post" id="post-163821">
    <div class="subject"><a href="#post-163821">Re: File delete across all Win32 OSes</a></div>
    <div class="body"><div class="quote"><br /><strong>SHFileOperation:</strong><br /><em>Windows NT/2000</em>: Requires Windows NT 4.0 or later. <br /><em>Windows 95/98/Me</em>: Requires Windows 95 or later. <br /><br />...so this should be a pretty safe function to use.<br /><br />If you just want to delete a file without the shell stuff, use DeleteFile which is supported even on NT3.1<br /><br />PS: win32.hlp is somewhat crappy, if you&#39;re on broadband you should get the PlatformSDK.<br /><br />Thanks.<br /><br />Can&#39;t you only get the SDK for Win2K +? I am still using 98 at the house. What do you get for those 100 megs.<br /><br /></div>
    <div class="meta">Posted on 2005-08-27 14:02:30 by skywalker</div>
   </div>
   <div class="post" id="post-163829">
    <div class="subject"><a href="#post-163829">Re: File delete across all Win32 OSes</a></div>
    <div class="body">Hm, don&#39;t know if the SDK requires a NT machine to install to - it might. Unless you&#39;re on very old hardware, I&#39;d recommend getting win2k or XP, it&#39;s much better in terms of stability.<br /><br />The PlatformSDK has *very* comprehensive information of the win32 API, examples, tools, et cetera.<br /><br />You can probably get by with win32.hlp and the online http://msdn.microsoft.com if you don&#39;t have the resources to download and run the PSDK.<br /></div>
    <div class="meta">Posted on 2005-08-27 19:36:31 by f0dder</div>
   </div>
   <div class="post" id="post-163887">
    <div class="subject"><a href="#post-163887">Re: File delete across all Win32 OSes</a></div>
    <div class="body">Never heard of anyone having a problem with the PSDK on 98+ but you could be right. It has been a long time since I used 9x on my dev box, usually use 2K but now I am running XP pro. I have XP64 but formatting is a pain and I haven&#39;t installed it yet.<br /><br />I agree with f0dder here, if your hardware is recent enough then upgrade to Windows 2000, it is the best of breed for the Windows family, none of the superfluous GUI crap of XP and you don&#39;t have to shut off PAE mode in order to run some older programs (like VirtualPC).</div>
    <div class="meta">Posted on 2005-08-28 12:54:13 by donkey</div>
   </div>
   <div class="post" id="post-163889">
    <div class="subject"><a href="#post-163889">Re: File delete across all Win32 OSes</a></div>
    <div class="body">donkey, did you use old .chm or the newer htmlhelp v2 format of the PSDK back in the 9x days? I think the v2 might require 2k or better, but not confirmed. Even on my main amd64 box, I have both the .chm and v2 versions installed, as .chm is much faster and easier to code for.<br /><br />I run XP myself - when all the crudd is turned off, I feel that it adds a bunch of minor things that makes daily work easier. I&#39;ve been considering 2k a couple of times, but when using a www.nliteos.com tweaked XP, it doesn&#39;t seem worth it. I&#39;ll probably be migrating to XP64 soon anyway. Btw, you don&#39;t need a format to install XP64 and you can dualboot it with 2k or XP or whatever - AS LONG AS you put it on a secondary partition.<br /></div>
    <div class="meta">Posted on 2005-08-28 13:29:02 by f0dder</div>
   </div>
   <div class="post" id="post-163895">
    <div class="subject"><a href="#post-163895">Re: File delete across all Win32 OSes</a></div>
    <div class="body">I think I only used the HTML Help 2 version, before that I had the Win32hlp file IIRC. Yeah, the CHM files are much faster, probably the reason MS dropped HTMLHelp2 except for the PSDK and MSDN library.<br /><br />I have the Tech Advancement Program version (not the OEM), I plan to get the OEM version eventually but I since my system (stupidly from the store) has a single partition I would have to reformat as I don&#39;t trust repartitioning software at all.</div>
    <div class="meta">Posted on 2005-08-28 14:30:46 by donkey</div>
   </div>
   <div class="post" id="post-163899">
    <div class="subject"><a href="#post-163899">Re: File delete across all Win32 OSes</a></div>
    <div class="body"><div class="quote"><br />donkey, did you use old .chm or the newer htmlhelp v2 format of the PSDK back in the 9x days? I think the v2 might require 2k or better, but not confirmed. Even on my main amd64 box, I have both the .chm and v2 versions installed, as .chm is much faster and easier to code for.<br /></div><br /><br />I checked MS site and they have a 2002 version of the SDK I can order. But it doesn&#39;t say what version of OS it requires. Till I get an XP system, Win98 is what I have for now.<br /><br /></div>
    <div class="meta">Posted on 2005-08-28 15:56:17 by skywalker</div>
   </div>
   <div class="post" id="post-163901">
    <div class="subject"><a href="#post-163901">Re: File delete across all Win32 OSes</a></div>
    <div class="body">I believe the 2002 version is htmlhelp2 as well... I think the latest .chm version I have is october 2001 or something.<br /><br />I wonder why MS f00ked up so much with v2, it&#39;s *really* slow... and .chm seemed like a fine enough format? :s</div>
    <div class="meta">Posted on 2005-08-28 16:41:15 by f0dder</div>
   </div>
   <div class="post" id="post-163985">
    <div class="subject"><a href="#post-163985">Re: File delete across all Win32 OSes</a></div>
    <div class="body"><div class="quote"><br />Never heard of anyone having a problem with the PSDK on 98+ but you could be right. It has been a long time since I used 9x on my dev box, usually use 2K but now I am running XP pro. I have XP64 but formatting is a pain and I haven&#39;t installed it yet.<br /><br />I agree with f0dder here, if your hardware is recent enough then upgrade to Windows 2000, it is the best of breed for the Windows family, none of the superfluous GUI crap of XP and you don&#39;t have to shut off PAE mode in order to run some older programs (like VirtualPC).<br /></div><br /><br />I still have an AMD K-5 485 MHz with 256Megs.<br /><br /></div>
    <div class="meta">Posted on 2005-08-30 16:03:43 by skywalker</div>
   </div>
  </div>
 </body>
</html>