<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>COMponent for use in ASP - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=927" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=927">COMponent for use in ASP</a></p>
   <div class="post" id="post-5966">
    <div class="subject"><a href="#post-5966">COMponent for use in ASP</a></div>
    <div class="body">Hi,<br />I'm really very new on this, but I'd like to write a COM-DLL with MASM32 to use it in ASP.<br />I already made the API-DLL version.<br /><br />How do I make this work?<br /><br />Thanks! :alright:</div>
    <div class="meta">Posted on 2001-09-03 14:22:02 by Butch77</div>
   </div>
   <div class="post" id="post-6061">
    <div class="subject"><a href="#post-6061">COMponent for use in ASP</a></div>
    <div class="body">Try looking at the MyCom2 program and tut in SP2 or <a target="_blank" href="http://here.is/COMinASM">my page.</a></div>
    <div class="meta">Posted on 2001-09-04 06:32:16 by Ernie</div>
   </div>
   <div class="post" id="post-7588">
    <div class="subject"><a href="#post-7588">COMponent for use in ASP</a></div>
    <div class="body">Thanks for the tutorials and Samples on your page! :)<br /><br />But when trying to execute the MyCom2 Example I get an Error:<br />&quot;ActiveX component can't create object&quot;<br />The first MyCom Example works fine!<br />But the sourcecode is much longer.<br /><br />Is there something I did wrong?<br />(I did the regsvr32 thing with success.)<br /><br />Can I use the &quot;NaN's Object Creator&quot; to create my DLL? I couldn't find any example where the &quot;NaN's Object Creator&quot;-generated code is used for a dll...<br /><br />Thanks</div>
    <div class="meta">Posted on 2001-09-20 04:48:35 by Butch77</div>
   </div>
   <div class="post" id="post-7591">
    <div class="subject"><a href="#post-7591">COMponent for use in ASP</a></div>
    <div class="body">No..  The tool will only generate an empty class by your tailoring.  You can specify Methods and Variables.. and then let the program do the rest.  I will build &quot;proc&quot; statements for every methods, all set and ready for your specific code to be between the PROC and ENDP statements.  As well the class structure is built for you (variables &amp; methods).  All this is needed for our MASM32 Objects design, and its based about Ernie's COM model (and expanded), but it definitely has nothing to do will making DLL's.<br /><br />All tho i can see how the &quot;template&quot; could look like a basic DLL layout. :)  Sorry for the confusion.<br /><br />NaN</div>
    <div class="meta">Posted on 2001-09-20 06:17:04 by NaN</div>
   </div>
   <div class="post" id="post-7597">
    <div class="subject"><a href="#post-7597">COMponent for use in ASP</a></div>
    <div class="body">I don't see any fundamental reason why Nan's classes can't be used as COM classes. After all, if you just look at his METHOD macro, it's identical to the coinvoke macro as to what code gets called to run an object's method.<br /><br />Since it follows the binary layout of COM, it can generate COM objects.<br /><br />A COM dll needs it's 5 basic export functions (which CoLib will supply for you), so using Nan's work means you need do these yourself. But you can cheat and forget register and unregister and do these other ways (for init testing, don't release THAT please). GetClassObject would be interesting to re-impliment dealing out NanObjects.<br /><br />Such objects (if all STDCALL) would work quite nicely with COM. After all, COM is grafted on top of C++'s ability and layout of making objects, the form of such is almost a given.<br /><br />(I didn't forget Thomas's contribution here, it's just Nan is the blabbermouth here. Both you guys did great work here)</div>
    <div class="meta">Posted on 2001-09-20 07:07:08 by Ernie</div>
   </div>
   <div class="post" id="post-7607">
    <div class="subject"><a href="#post-7607">COMponent for use in ASP</a></div>
    <div class="body">Bla Bla Bla Bla <br /><br /><br />Blab... <br /><br /><br /><br />Heehehehehe...<br /><br /><br />Thanx you Ernie... glad <em>we</em> can impress.  (Like i said eons ago, it was your start that inspired me on this road to begin with...)<br /><br />Thomas had a big part in fine-tunning the code.. he was much more experienced in seeing waste full code than i am.  As well he contributed to some of the really fundemental macros to keep it simple.  Just wanted to pass credit where its due before ol' blabber mouth here gets people all confused :)  As well, BitRake helped streamline the METHOD macro into not requiring any LOCALS at all.. And since this is the most used macro this is a definite advantage in compiling time.<br /><br /><br />COM:<br /><br />  I understand com to a user's extense (instanciating COM's).  But i don't know *how* to create a com object.  I never researched this area, or if our model has any overlap.   I look forward to seeing what you can do this the layout.    If you get a basic template going (using our object model) please post it, i would like to give it a study...<br /><br />Anywho.. All, Keep asking questions...  I will help when i can... the Objects.inc documentation is specific to the macro so you may wonder how macro's interact at compile time, or then again, maybe not :)<br /><br /><br />NaN</div>
    <div class="meta">Posted on 2001-09-20 10:27:20 by NaN</div>
   </div>
   <div class="post" id="post-7629">
    <div class="subject"><a href="#post-7629">COMponent for use in ASP</a></div>
    <div class="body">Butch77, <br /><br />Because of a little bug in colib, you need to modify GetCachedTypeInfo.asm in order to use the Dispatch Interface of your component (if you want to use it with asp or vbscript for example)</div>
    <div class="meta">Posted on 2001-09-20 13:14:46 by Amokila</div>
   </div>
  </div>
 </body>
</html>