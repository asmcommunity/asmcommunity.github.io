<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How to get rid of CoLib: an OCX sample - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2867" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=2867">How to get rid of CoLib: an OCX sample</a></p>
   <div class="post" id="post-18492">
    <div class="subject"><a href="#post-18492">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">Hi,<br /><br />Heres a full OCX/Active-X control without any usage of Ernies CoLib or other restricted software. Event sinks are supported, of course. For all those people having trouble with this CoLib thing.<br /><br /><br />japheth</div>
    <div class="meta">Posted on 2002-01-10 03:59:16 by japheth</div>
   </div>
   <div class="post" id="post-18537">
    <div class="subject"><a href="#post-18537">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">it works  except for the fact that it crashes my internet explorer/windows explorer when I decide to exit the page :-/</div>
    <div class="meta">Posted on 2002-01-10 11:12:10 by Hiroshimator</div>
   </div>
   <div class="post" id="post-18609">
    <div class="subject"><a href="#post-18609">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">Do be careful when using j's code.<br /><br />WARNING: The control in the source file CAN NOT be unregistered without manually editing the registry. You may be stuck with this thing forever on your system.<br /><br />Any other things it may do are unknown, as this is a large project without documentation.<br /><br />Please note the people who manage this menagerie DO NOT preview and approve code posting. <br /><br />So you run this code at your own risk.</div>
    <div class="meta">Posted on 2002-01-11 00:30:21 by Ernie</div>
   </div>
   <div class="post" id="post-18639">
    <div class="subject"><a href="#post-18639">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">Dear Hiro, dear Ernie,<br /><br />you both are right.<br /><br />- crashes with IE: This sample was tested with VB, Test Container of VC and IE. It crashes when exiting IE. Hope I can find the error, but actually I'm just too busy.<br /><br />- control does not unregister. Thats right and I have pointed that out in the readme. Function DllUnregister is a dummy at that point. But hey, this code is not for beginners and the unregister job isn't that hard for experienced programmers. Just look at the register job in DllRegister.<br /><br />- the project is large: It isn't really large, but it is splitted in several source files. An active-x control has to support a bunch of interfaces, so it doesn't fit in 10 lines of code. <br /><br />- documentation lacks: thats true. And actually I dont think I will supply one. So if you are a beginner in COM, you will possibly have some difficulty understanding what's happerning there.<br /><br /><br /><br />Thats all true. But I have posted this code because:<br /><br />- the colib licence supplied with masm7.0 is restricted. For commercial software you need to &quot;buy&quot; a licence from Ernie, developping free software using the colib may be problematic.<br /><br />- in the colib version supplied with masm 7.0 there are some annoying bugs. So for example the main benefit of that code, the &quot;registry script handler&quot;, doesnt work in that version.<br /><br />- all parameters in the colib stuff are &quot;untyped&quot; (defined as simple DWORDS). Very bad for debuggers like that one in VC. In the sample i have posted you easily can watch all member variables or your object.<br /><br />- the structure of objects generated with colib aren't compatible with VC (which requires that all vtables of all supported interfaces are located at the start of an object, without a &quot;base pointer&quot; between them.<br /><br /><br /><br />To Ernie: please do not edit this reply. May be that's a nice joke.  But I am German and we all totally lacks  sense of humour, as you all probably know.<br /><br /><br />japheth</div>
    <div class="meta">Posted on 2002-01-11 03:14:35 by japheth</div>
   </div>
   <div class="post" id="post-18651">
    <div class="subject"><a href="#post-18651">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">Guys,<br /><br />I will ask a favour from both of you in this area, programming thrives on variation and in particular assembler programming has its hallmark in difference. If I have it right, Microsoft &quot;own&quot; the idea of COM so it is not really anyones exclusive domain.<br /><br />Having different approaches to the same field is not without its advantages and having this variation can only be of benefit to those who are interested in the COM field.<br /><br />All I ask of both of you is that each other will be respected and the differences can be managed in a friendly manner. This way everybody will gain from the dialogue.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a><br /><br />PS : Japheth, most Germans I know have an interesting sense of humour, different but not without its virtue, what happened ? :tongue:</div>
    <div class="meta">Posted on 2002-01-11 05:11:15 by hutch--</div>
   </div>
   <div class="post" id="post-18737">
    <div class="subject"><a href="#post-18737">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">Well put Hutch.<br /><br />My only extra thoughts is why am i reading what should be constructive feedback now?  And its not being used as a constructive device, but rather a power stuggle of who's design is most benificial?<br /><br />I just wish people would post their thoughts like this before it turns into an issue.  I do think Ernie is a very understanding person, and to point this out earlier couldnt have done anything but help each other (most likely).<br /><br />NaN</div>
    <div class="meta">Posted on 2002-01-11 16:31:09 by NaN</div>
   </div>
   <div class="post" id="post-18765">
    <div class="subject"><a href="#post-18765">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">Shall we take them in order?<br /><br /><br /> <div class="quote">- - documentation lacks: thats true. And actually I dont think I will supply one. So if you are a beginner in COM, you will possibly have some difficulty understanding what's happerning there. </div> <br />I'm wondering how this code then rates as a replacement for CoLib, as is implied in the thread topic. Perhaps that was just a bit too boastful on the part of the original poster.<br /><br /><br /><br /><div class="quote">- the colib licence supplied with masm7.0 is restricted. For commercial software you need to &quot;buy&quot; a licence from Ernie, developping free software using the colib may be problematic.</div> <br />Yeah, I agree. All those popup adds and transaction processing scriptlets on my web page must dog your browser when all you wanna do is read a tut or two of mine. <br /><br />At this point, CoLib has had a total of ONE full license granted for it, and even that was unasked for. I granted it to someone who made an addition to CoLib, and was so kind to email me his code along with an explanation as to the problem it solved. <br /><br />Copyrighting my own work is my right. I did it mostly to keep my code out of the CD ROM for the next edition of &quot;Mastering Assembly Super Bible.&quot; If this copyright restriction has seriously limited anyone, they have yet to email me about it.<br /><br />I *have* seen some of my code popping up in other people's work. Maybe you should take a poll of how many of them I have hassled over copyright restriction violations? The answer is zero, no one hears from me. This works against my self-interest, because US copyright law is specific that if a copyright is not &quot;vigorously defended&quot; then it lapses by default. <br /><br />But I much prefer to see people learning from my work, and actually feel honored when I see I've inspired someone to do something with it.<br /><br />Finally, if someone should reuse someone else's code in a commercial work, and earns themselves a ton of money over it, wouldn't you think they owe the producer of that code something? If you don't, you truly lack any sort of maturity. <br /><br />There ain't no such thing as a free lunch.<br /><br /><br /><br /><div class="quote">- developping free software using the colib may be problematic</div><br />I want to revisit this minor point to make it crystal clear. &quot;Free software&quot; can hardly be construed to be &quot;commercial use.&quot;  &quot;Commercial use&quot; means you get PAID for selling something. <br /><br />If you make some handy helper application and wish to give it away, by all means use CoLib, and with my blessing too!<br /><br />Geeze, do we need a Clarence Darrow to figure out &quot;I learned something while I wrote this, and I didn't make any money from it cause I'm giving it away&quot; is fair use of code marked: &quot;For educational use only&quot;?<br /><br /><br /><br /><div class="quote">- - in the colib version supplied with masm 7.0 there are some annoying bugs. So for example the main benefit of that code, the &quot;registry script handler&quot;, doesnt work in that version.</div><br />Polite bug reports are always welcome as they lead to further refinements. As far as the &quot;registry script handler&quot; is concerned, it's always been a known, reported issue. It works enough to suit most needs (one can usually change the elements of a registrar script (not registry script) and usually get it to work. If anyone is really concerned over it, they are free to write their own version.<br /><br />But if you do write one, PLEASE DO include the uninstaller code. Not only is the uninstaller part of the COM standard, but it is downright RUDE not to put it there.<br /><br />You think everyone wants your code dogging their machine forever?<br /><br /><br /><br /><div class="quote">- - all parameters in the colib stuff are &quot;untyped&quot; (defined as simple DWORDS). Very bad for debuggers like that one in VC. In the sample i have posted you easily can watch all member variables or your object. </div><br />This in intentional and by design and in keeping with MASM32's general method of loose type checking. <br /><br /><br /><br /><div class="quote">- - the structure of objects generated with colib aren't compatible with VC (which requires that all vtables of all supported interfaces are located at the start of an object, without a &quot;base pointer&quot; between them. </div><br />Why would you expect them to be? This isn't an extension to VC. It is a library to compliment MASM32 for applications written in assembly. If you want VC objects, use VC!<br /><br />As far as using these COM objects from a VC app, as long as you do so through the COM interfaces it will work. COM is a binary standard communications between applications, and CoLib upholds that standard 100%<br /><br />No where no how was it ever intended to enforce VC's method of defining objects.<br /><br /><br /><br /><div class="quote">- To Ernie: please do not edit this reply. May be that's a nice joke. But I am German and we all totally lacks sense of humour, as you all probably know. </div><br />Rattling the cage of humorless people is one of the most sportingly fun things one may do on the net. Please don't make it overly tempting for me. <br /><br />As far as leaving little j's rude posts, not to worry, I shall never again edit them.<br /><br />I will simply delete them.<br /><br /><br /><br /><br /><br /><br />To japheth: Never assume you are the prototypical person. I'm 3/4 German ancestry and cannot remember anyone in my lineage that lacked any of the basic human traits. And yes, you have demonstrated one may write a large app completely by hand, re-writing the same code over and over. <br /><br />&lt;golf course clap inserted here&gt;<br /><br />So what do you think the next step is, some student starving for knowledge will study your code endlessly until by divine inspiration he gets the WHY and HOW it works? <br /><br />If you wish to author another COM in ASM standard, then do so. Don't pretend you have already done so just because you have some code that seems to work.<br /><br />The documentation you care nothing for is the difference. <br /><br />All you have here is a &quot;don't you love my code?&quot; posting.</div>
    <div class="meta">Posted on 2002-01-11 21:11:36 by Ernie</div>
   </div>
   <div class="post" id="post-18772">
    <div class="subject"><a href="#post-18772">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">This is an interesting set of posts and one should never butt into anothers conversation but I have one thing to say:<br /><br />I believe that J's original intent was not to dethrown E or take glory from anyone but that it came across as a communication difference.  Rather than shooting arrows for sport lets just act curtious towards one another.<br /><br />It's one thing when two members have a difference.  It's another thing when I mod is on the defensive side of the fence as it gives off the wrong message (unless it's for the right reason) and IMHO, this isn't the right reason.<br /><br /><br />Thanks,<br />_Shawn</div>
    <div class="meta">Posted on 2002-01-11 22:04:52 by _Shawn</div>
   </div>
   <div class="post" id="post-18780">
    <div class="subject"><a href="#post-18780">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body"><strong>_Shawn</strong>, that was defensive?<br /><br /><strong>Ernie</strong>, thanks for the wit.<br /><br /><strong>japheth</strong>, thanks for the example.<br /><br /><strong>Hutch--</strong>, good advice.<br /><br />Much to be learnt in this thread. :grin:</div>
    <div class="meta">Posted on 2002-01-11 23:07:47 by bitRAKE</div>
   </div>
   <div class="post" id="post-18795">
    <div class="subject"><a href="#post-18795">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">... unless it suddenly disappears.</div>
    <div class="meta">Posted on 2002-01-12 02:31:33 by f0dder</div>
   </div>
   <div class="post" id="post-18799">
    <div class="subject"><a href="#post-18799">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">f0dder:<br /><br /><div class="quote">unless it suddenly disappears</div> <br /><br />That's EVIL!!! :grin:</div>
    <div class="meta">Posted on 2002-01-12 03:21:36 by Qweerdy</div>
   </div>
   <div class="post" id="post-18804">
    <div class="subject"><a href="#post-18804">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">Qweerdy, indeed it is. I wish those two would stop fighting, *sigh*.</div>
    <div class="meta">Posted on 2002-01-12 04:38:52 by f0dder</div>
   </div>
   <div class="post" id="post-18814">
    <div class="subject"><a href="#post-18814">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">Hi,<br /><br />Ernie, you have convinced me not providing an unregister function is rude. So I added one. Thank you very much for pointing that out.<br /><br />To unregister execute &quot;regsvr32 /u AsmCtrl.ocx&quot;. This will unregister any old version too, since the CLSID hasn't changed.<br /><br />And one point I have forgotten to mention: This sample is some sort of conversion of Ernies sample &quot;AsmCtrl&quot; from his colib.zip. Parts of the original code are still included. Just in case you haven't look at this corner of the masm32 package until now.<br /><br />The IE explorer crash seems to have vanished, at least with my version of IE (5.5). I don't know why :) .<br /><br />japheth</div>
    <div class="meta">Posted on 2002-01-12 08:23:13 by japheth</div>
   </div>
   <div class="post" id="post-18865">
    <div class="subject"><a href="#post-18865">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body">I understand Ernie's concern with commercial exploitation of the code that he has written and it is for the same reason that I have copyrighted the entire content of MASM32. After many offers to commercialise MASM32 &quot;Hey man, I/we can market your product to ...&quot;, &quot;Oh BTW, can I add MASM32 to the appendix of the CD for my new book&quot; I chose to completely close the door on further offers with the copyright that MASM32 currently has.<br /><br />This allows programmers to write their own commercial code using the contents that I have written myself without any form of royalties or costs but protects the content from any form of commercial exploitation.<br /><br />My intention was to ensure that any programmer who was interested in writing assembler could obtain the package without being beholding to anyone or dependent on other peoples commercial considerations.<br /><br />With contributed code, the consideration was that it was available to programmers for non-commercial use without cost. It is reasonable that when someone contributes code that it is not commercially exploited without their approval so the overall copyright for MASM32 protects the code from that type of usage and if someone is interested, they can contact the author.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-01-12 17:36:26 by hutch--</div>
   </div>
   <div class="post" id="post-18883">
    <div class="subject"><a href="#post-18883">How to get rid of CoLib: an OCX sample</a></div>
    <div class="body"><div class="quote"><br />his allows programmers to write their own commercial code using the contents that I have written myself without any form of royalties or costs but protects the content from any form of commercial exploitation. <br /></div><br />If I read it right, this is very fair usage. People trying to sell the<br />masm32 package would be bastards anyway. However, masm32<br />on some magazine front-cover CD? Dunno... could greatly increase<br />the knowledge of masm32 (for good and evil). I had a program of<br />mine on the walnut creek CD. Got a lot more useless mails from AOL,<br />but also some good mails from various people (and even found out<br />that at least two AOL users weren't total idiots, but quite nice and<br />intelligent and whatnot ;)).</div>
    <div class="meta">Posted on 2002-01-12 20:26:25 by f0dder</div>
   </div>
  </div>
 </body>
</html>