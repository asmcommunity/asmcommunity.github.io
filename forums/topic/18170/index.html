<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Debuggers :( - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18170" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18170">Debuggers :(</a></p>
   <div class="post" id="post-140435">
    <div class="subject"><a href="#post-140435">Debuggers :(</a></div>
    <div class="body">how can i detect ring-3 debuggers(like OllyDbg) with out IsDebuggerPresent API ?</div>
    <div class="meta">Posted on 2004-04-29 05:56:53 by Criminal2</div>
   </div>
   <div class="post" id="post-140438">
    <div class="subject"><a href="#post-140438">Debuggers :(</a></div>
    <div class="body">Don't bother. If anybody is going to attack your application, they'll either use a ring0 debugger or know how to defeat ring3 debugger checks. If you really insist on doing this, I believe there's some TIB/TEB field to check, but I can't remember exactly nor whether if it's 9x/NT dependant (probably is).</div>
    <div class="meta">Posted on 2004-04-29 06:49:21 by f0dder</div>
   </div>
   <div class="post" id="post-140446">
    <div class="subject"><a href="#post-140446">Debuggers :(</a></div>
    <div class="body"><pre><code><br />	mov	ecx, &#91;fs&#58;30h&#93;<br />	test	ecx, ecx<br />	js	_9x<br />	movzx	ecx, byte&#91;ecx+2&#93;<br />	jecxz	@F<br />                jmp detected<br />_9x&#58;<br />	mov	ecx, &#91;fs&#58;20h&#93;<br />	jecxz	@F<br />detected&#58;<br />....<br /></code></pre><br /><br />Anyway do not bother because some people have patched their TIB/TEB field to stop this kind of detection</div>
    <div class="meta">Posted on 2004-04-29 07:23:47 by roticv</div>
   </div>
  </div>
 </body>
</html>