<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How to static link in MASM32? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21139" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21139">How to static link in MASM32?</a></p>
   <div class="post" id="post-160085">
    <div class="subject"><a href="#post-160085">How to static link in MASM32?</a></div>
    <div class="body">How to static link in MASM32?<br /><br />I am writing a screen saver program with MASM32.(the source files in attach archive)<br />a screen saver program need static link the scrnsave.lib<br /><br />I look the option of LINK.EXE:<br /><div class="quote"><br />Microsoft (R) Incremental Linker Version 5.12.8078<br />Copyright (C) Microsoft Corp 1992-1998. All rights reserved.<br /><br />usage: LINK   [@commandfile]<br /><br />&nbsp;  options:<br /><br />&nbsp; &nbsp; &nbsp; /ALIGN:#<br />&nbsp; &nbsp; &nbsp; /BASE:{address|@filename,key}<br />&nbsp; &nbsp; &nbsp; /COMMENT:comment<br />&nbsp; &nbsp; &nbsp; /DEBUG<br />&nbsp; &nbsp; &nbsp; /DEBUGTYPE:{CV|COFF}<br />&nbsp; &nbsp; &nbsp; /DEF:filename<br />&nbsp; &nbsp; &nbsp; /DEFAULTLIB:library<br />&nbsp; &nbsp; &nbsp; /DLL<br />&nbsp; &nbsp; &nbsp; /DRIVER[:{UPONLY|WDM}]<br />&nbsp; &nbsp; &nbsp; /ENTRY:symbol<br />&nbsp; &nbsp; &nbsp; /EXETYPE:DYNAMIC<br />&nbsp; &nbsp; &nbsp; /EXPORT:symbol<br />&nbsp; &nbsp; &nbsp; /FIXED[:NO]<br />&nbsp; &nbsp; &nbsp; /FORCE[:{MULTIPLE|UNRESOLVED}]<br />&nbsp; &nbsp; &nbsp; /GPSIZE:#<br />&nbsp; &nbsp; &nbsp; /HEAP:reserve[,commit]<br />&nbsp; &nbsp; &nbsp; /IMPLIB:filename<br />&nbsp; &nbsp; &nbsp; /INCLUDE:symbol<br />&nbsp; &nbsp; &nbsp; /INCREMENTAL:{YES|NO}<br />&nbsp; &nbsp; &nbsp; /LARGEADDRESSAWARE[:NO]<br />&nbsp; &nbsp; &nbsp; /LIBPATH:dir<br />&nbsp; &nbsp; &nbsp; /MACHINE:{ALPHA|ARM|IX86|MIPS|MIPS16|MIPSR41XX|PPC|SH3|SH4}<br />&nbsp; &nbsp; &nbsp; /MAP[:filename]<br />&nbsp; &nbsp; &nbsp; /MAPINFO:{EXPORTS|FIXUPS|LINES}<br />&nbsp; &nbsp; &nbsp; /MERGE:from=to<br />&nbsp; &nbsp; &nbsp; /NODEFAULTLIB[:library]<br />&nbsp; &nbsp; &nbsp; /NOENTRY<br />&nbsp; &nbsp; &nbsp; /NOLOGO<br />&nbsp; &nbsp; &nbsp; /OPT:{ICF[,iterations]|NOICF|NOREF|NOWIN98|REF|WIN98}<br />&nbsp; &nbsp; &nbsp; /ORDER:@filename<br />&nbsp; &nbsp; &nbsp; /OUT:filename<br />&nbsp; &nbsp; &nbsp; /PDB:{filename|NONE}<br />&nbsp; &nbsp; &nbsp; /PDBTYPE:{CON|SEPT}<br />&nbsp; &nbsp; &nbsp; /PROFILE<br />&nbsp; &nbsp; &nbsp; /RELEASE<br />&nbsp; &nbsp; &nbsp; /SECTION:name,<span class="strike"><br />&nbsp; &nbsp; &nbsp; /STACK:reserve[,commit]<br />&nbsp; &nbsp; &nbsp; /STUB:filename<br />&nbsp; &nbsp; &nbsp; /SUBSYSTEM:{NATIVE|WINDOWS|CONSOLE|WINDOWSCE|POSIX}[,#[.##]]<br />&nbsp; &nbsp; &nbsp; /SWAPRUN:{CD|NET}<br />&nbsp; &nbsp; &nbsp; /VERBOSE[:LIB]<br />&nbsp; &nbsp; &nbsp; /VERSION:#[.#]<br />&nbsp; &nbsp; &nbsp; /VXD<br />&nbsp; &nbsp; &nbsp; /WARN[:warninglevel]<br />&nbsp; &nbsp; &nbsp; /WINDOWSCE:{CONVERT|EMULATION}<br />&nbsp; &nbsp; &nbsp; /WS:AGGRESSIVE<br /></div><br />but no found the stalic link potion.<br /><br />I build the program in QEDITOR.EXE, the run the program, I get a error message box, tell me the system can not locate the scrnsave.dll<br /><br />I try to link as following, but failed:<br /><br /><div class="quote"><br />D:\masm32\myworks\scrsaver&gt;link /SUBSYSTEM:WINDOWS&nbsp; /LIBPATH:d:\masm32\lib 1.obj rsrc.obj /DEFAULTLIB:d:\masm32\lib\scrnsave.lib&nbsp; /DEF:1.def<br />Microsoft (R) Incremental Linker Version 5.12.8078<br />Copyright (C) Microsoft Corp 1992-1998. All rights reserved.<br /><br />&nbsp;  Creating library 1.lib and object 1.exp<br /></div><br /><br /><div class="quote"><br />D:\masm32\myworks\scrsaver&gt;link /SUBSYSTEM:CONSOLE&nbsp; /LIBPATH:d:\masm32\lib 1.obj<br /> rsrc.obj /DEF:1.def<br />Microsoft (R) Incremental Linker Version 5.12.8078<br />Copyright (C) Microsoft Corp 1992-1998. All rights reserved.<br /><br />&nbsp;  Creating library 1.lib and object 1.exp<br /></div><br /><br /><br />How can I static link in MASM32?</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=628" target="_blank">scrsaver.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-05-14 02:21:57 by purpleendurer</div>
   </div>
   <div class="post" id="post-160086">
    <div class="subject"><a href="#post-160086">Re: How to static link in MASM32?</a></div>
    <div class="body">If you have a static library, us the standard MASM syntax of INCLUDE for the prototypes and INCLUDELIB for the library. If it is an export library you must have the DLL present or you will get a runtime error about the missing DLL.</div>
    <div class="meta">Posted on 2005-05-14 02:25:42 by hutch--</div>
   </div>
   <div class="post" id="post-160087">
    <div class="subject"><a href="#post-160087">Re: How to static link in MASM32?</a></div>
    <div class="body">Thanks hutch-- <br /><br />I include the scrnsave.inc and scrnsave.lib in my source file:<br /><div class="quote"><br />include \masm32\include\windows.inc<br />include \masm32\include\user32.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\comctl32.inc<br />include \masm32\include\comdlg32.inc<br />include \masm32\include\gdi32.inc<br />include \masm32\include\advapi32.inc<br />include \masm32\include\shell32.inc<br />include \masm32\include\scrnsave.inc<br /><br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\comctl32.lib<br />includelib \masm32\lib\comdlg32.lib<br />includelib \masm32\lib\gdi32.lib<br />includelib \masm32\lib\advapi32.lib<br />includelib \masm32\lib\shell32.lib<br />includelib \masm32\lib\scrnsave.lib<br />includelib \masm32\lib\msvcrt.lib<br /><br /></div><br /><br />My program can build successfully in QEDITOR.EXE, but run the program, I was prompted that missed scrnsave.dll</div>
    <div class="meta">Posted on 2005-05-14 02:48:15 by purpleendurer</div>
   </div>
   <div class="post" id="post-160102">
    <div class="subject"><a href="#post-160102">Re: How to static link in MASM32?</a></div>
    <div class="body">Your scrnsave.lib is probably broken, try with the attached one.</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=629" target="_blank">SCRNSAVE.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-05-14 15:18:17 by thefox</div>
   </div>
   <div class="post" id="post-160104">
    <div class="subject"><a href="#post-160104">Re: How to static link in MASM32?</a></div>
    <div class="body">Thanks hutch-- and thefox&nbsp; very much....<br /><br />At first, I found the scrnsave.lib in \masm32\lib, It&#39;s length is 14,980 bytes, <br />and the length of scrnsave.lib&nbsp; thefox attached is 37,900 bytes,<br /><br />I renamed the old scrnsave.lib&nbsp; to scrnsave0.lib, down and unziped&nbsp; scrnsave.lib that thefox attached&nbsp; to \masm32\lib<br /><br />then builded my program in QEDITOR.EXE, an link error message gived: <br /><br /><div class="quote"><br />Microsoft (R) Macro Assembler Version 6.14.8444<br />Copyright (C) Microsoft Corp 1981-1997.&nbsp; All rights reserved.<br /><br /> Assembling: D:\masm32\myworks\scrsaver\1.asm<br />Microsoft (R) Incremental Linker Version 5.12.8078<br />Copyright (C) Microsoft Corp 1992-1998. All rights reserved.<br /><br />LINK : fatal error LNK1104: cannot open file &quot;\masm32\lib\msvcrt.lib&quot;<br />_<br />Link error<br />??????? . . .<br /></div><br /><br />I found msvcrt.lib in VC6, and copied it to \masm32\lib, <br /><br />builded my program in QEDITOR again, It was successful this time.<br /><br />the attached file is msvcrt.lib of VC6</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=630" target="_blank">msvcrt.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-05-15 02:10:35 by purpleendurer</div>
   </div>
   <div class="post" id="post-160106">
    <div class="subject"><a href="#post-160106">Re: How to static link in MASM32?</a></div>
    <div class="body">Just for your information, the scrnsave.lib I attached is from Microsoft Visual C++ 6 also :)</div>
    <div class="meta">Posted on 2005-05-15 16:48:48 by thefox</div>
   </div>
   <div class="post" id="post-160144">
    <div class="subject"><a href="#post-160144">Re: How to static link in MASM32?</a></div>
    <div class="body">The problem with the MASM32 .lib files is that they only work for DLL modules, since they&#39;re built from the .inc files. However, a number of libraries from the PlatformSDK includes code/data as well as imports - including, but not limited to, scrnsave.lib .<br /></div>
    <div class="meta">Posted on 2005-05-17 08:08:32 by f0dder</div>
   </div>
  </div>
 </body>
</html>