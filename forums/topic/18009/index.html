<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>C code generated a CCCCCCCC area. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18009" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18009">C code generated a CCCCCCCC area.</a></p>
   <div class="post" id="post-139064">
    <div class="subject"><a href="#post-139064">C code generated a CCCCCCCC area.</a></div>
    <div class="body">I'm looking at the asm code generated by a VC compiler. I'm curious to see how ebp reg is used. <br /><br />The source code is written in C language. What I'm looking is<br /><br />===<br />int myFunc (par1, par2, par3) {<br />	int iLoc ;<br />	if (par1 == 1) iLoc = 16 ;<br />	else iLoc = 1 ;<br /><br />	par2 = 0 ;<br /><br />	par3 = par3 * 2 ;<br /><br />	return 1 ;<br />}<br />===<br /><br />When my function is called I see that a large stack area is reserved for local variables. In my case the only local variable - which is an int so 4 bytes long - would need 4 bytes. Instead the compiler reserved an area of 44h bytes and moreover filled with 0CCCCCCCCh values.<br /><br />The asm code is<br /><br />===<br />	push 		ebp<br />	mov		ebp,esp<br />	sub		esp,44h                ; an area of 17 DWORDs !!!<br />	push		ebx<br />	push		esi<br />	push		edi<br />	lea		edi,	<br />	mov		ecx,11h<br />	mov		eax,0CCCCCCCCh<br />	rep stos	dword ptr                      ; the area is filled with 'C'... is it because source code was written in 'C'???  ;-P<br />===<br /><br /><br />Why?<br />Thanks.</div>
    <div class="meta">Posted on 2004-04-15 08:53:03 by _OuzO_</div>
   </div>
   <div class="post" id="post-139075">
    <div class="subject"><a href="#post-139075">C code generated a CCCCCCCC area.</a></div>
    <div class="body">I presume it is because you build your program in debug mode and CC should be a kind of protection in casa an error occurs ;) . It is unlikely that the C compiler you are using is so much unoptimised...</div>
    <div class="meta">Posted on 2004-04-15 13:14:00 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-139077">
    <div class="subject"><a href="#post-139077">C code generated a CCCCCCCC area.</a></div>
    <div class="body">You are probably using one of the more recent .net versions of visual studio. Have a look at project properties -&gt; C/C++ -&gt; Code Generation. For release builds, turn off &quot;Buffer security checks&quot;, &quot;Function-level linking&quot;, &quot;basic runtime checks&quot;, &quot;smaller type checks&quot;.</div>
    <div class="meta">Posted on 2004-04-15 13:33:15 by f0dder</div>
   </div>
   <div class="post" id="post-139114">
    <div class="subject"><a href="#post-139114">C code generated a CCCCCCCC area.</a></div>
    <div class="body">it will initilize stack values with the value of 0xCCCCCCCC  in debug. so compile as release and it should'nt do that. i guess it does that so if theres a buffer overflow/run etc it will exec opcode CCh which is int 13 and break execution. at least thats my explanation of why they have it do that.</div>
    <div class="meta">Posted on 2004-04-16 00:45:55 by Qages</div>
   </div>
   <div class="post" id="post-139155">
    <div class="subject"><a href="#post-139155">C code generated a CCCCCCCC area.</a></div>
    <div class="body"><div class="quote"><br />... it will exec opcode CCh which is int 13 ...</div><br /><br />God (IA32 protection) forbid if it was INT 13 (disk operations!)... You mean INT 3.</div>
    <div class="meta">Posted on 2004-04-16 11:04:35 by death</div>
   </div>
   <div class="post" id="post-139395">
    <div class="subject"><a href="#post-139395">C code generated a CCCCCCCC area.</a></div>
    <div class="body">oops yes int 3</div>
    <div class="meta">Posted on 2004-04-18 22:26:28 by Qages</div>
   </div>
  </div>
 </body>
</html>