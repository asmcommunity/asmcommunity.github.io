<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Toolbar - Help plz - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9501" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9501">Toolbar - Help plz</a></p>
   <div class="post" id="post-70298">
    <div class="subject"><a href="#post-70298">Toolbar - Help plz</a></div>
    <div class="body">i added a scrollbar to my window trought the Window Style parameter of CreateWindowEx  but i found that when i set it the scroll box stays in the same place and don't move, it only change the size of the box.<br />im using Iczelion skeleton of a win32 app:<br /><br />This is the code, i just will write the specific code:<br /><br />---- CODE ----<br /><br />.data?<br /><br />hwnd HWND ?                             &lt;---- I changed the main window var to global so i can reference it<br />                                                            outside of WinMain and WndProc<br />ScrBar SCROLLINFO &lt;&gt;               &lt;---- ScrollBar Structure<br /><br />.code<br />start:<br /><br /><br /><br />Init_Scroll proc<br /><br />	mov ScrBar.cbSize, sizeof  ScrBar<br />	mov ScrBar.fMask, SIF_ALL<br />	mov ScrBar.nMin, 0<br />	push dword ptr 48<br />	pop ScrBar.nMax<br />	mov ScrBar.nPage, 1<br />	mov ScrBar.nPos, 0<br />	mov ScrBar.nTrackPos, NULL<br />	<br />	invoke SetScrollInfo,hwnd,SB_HORZ,addr ScrBar,TRUE<br /><br /><br />                ret<br />Init_Scroll endp<br /><br />end start<br /><br />--- END CODE ---<br /><br />Well i think that is enough to set a scroll bar... <br /><strong>CAN SOMEBODY TELL ME WHY DOESN'T MOVE????</strong> :confused:</div>
    <div class="meta">Posted on 2002-12-10 17:46:03 by IrOn</div>
   </div>
   <div class="post" id="post-70301">
    <div class="subject"><a href="#post-70301">Toolbar - Help plz</a></div>
    <div class="body"><strong>Ir0n,</strong> Im assuming that you cant figure out why the scrollbar wont move<br />when you try to drag it with your mouse? Well you need to use the abovecode<br />to respond to these messages: WM_HSCROLL,SB_THUMBTRACK,SB_THUMBPOSITION,<br />SB_LINEUP,SB_LINEDOWN,SB_PAGEUP,SB_PAGEDOWN. Windows does not control the <br />scrollbar for you. So you need to update the scrollbar position,etc. using the code above(SetScrollInfo).<br /><br />MSDN_MESSAGES: <a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/scrollbars/scrollbarreference/scrollbarmessages/wm_hscroll.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/commctls/scrollbars/scrollbarreference/scrollbarmessages/wm_hscroll.asp</a></div>
    <div class="meta">Posted on 2002-12-10 18:14:51 by natas</div>
   </div>
   <div class="post" id="post-70460">
    <div class="subject"><a href="#post-70460">Thanks</a></div>
    <div class="body">Thanks natas</div>
    <div class="meta">Posted on 2002-12-11 09:31:25 by IrOn</div>
   </div>
  </div>
 </body>
</html>