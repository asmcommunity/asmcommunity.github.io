<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>COM made easy - we hope... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16813" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=16813">COM made easy - we hope...</a></p>
   <div class="post" id="post-130477">
    <div class="subject"><a href="#post-130477">COM made easy - we hope...</a></div>
    <div class="body">Ultrano's ATC oop support is growing to support COM objects.<br />We are attempting to implement an example COM server using ATC.<br />It's early days, but everything looks positive.<br />It will be possible to define interfaces of classes using the same format used to define regular classes under ATC using the following directive:<br /><br />class IMyClass, ,COM compatible<br />;IUnknown methods<br />;Whatever else<br />;Some datas<br />endclass<br /><br />The major difference when using the COM compatible switch is that the vtable is built differently such that the IUnknown methods are first in the vtbl.<br />Also some COM related macros were added to ATC which allow for generic coding of the QueryInterface etc ..<br />This removes the need for an ObjectMap in the data segment.<br />Currently we are modifying Ernie's SimpleServer example to use the ATC stuff.<br />The aim is to simplify the building of COM stuff with a common base.<br />Wish us some luck :)</div>
    <div class="meta">Posted on 2004-01-12 21:41:16 by Homer</div>
   </div>
   <div class="post" id="post-130618">
    <div class="subject"><a href="#post-130618">COM made easy - we hope...</a></div>
    <div class="body">Here's the ATC v31, theoretically it works perfectly, but I want to make macros that make the .idl source too and then publish working code. Otherwise it'd be half-done work.</div>
    <div class="meta">Posted on 2004-01-14 10:48:34 by Ultrano</div>
   </div>
   <div class="post" id="post-130640">
    <div class="subject"><a href="#post-130640">COM made easy - we hope...</a></div>
    <div class="body">Hi guys,<br /><br />posting some includes without a tutorial, some sample code or at least a readme file is possibly less than nothing and - if it is not a mistake - I wonder how you can complain about lacking interest from others.<br />What do you expect potential users to do? Analyze this code until everything is clear?<br />I understand that writing docs isnt fun, but it is unevitable for some acceptance.<br /><br />Japheth</div>
    <div class="meta">Posted on 2004-01-14 14:09:55 by japheth</div>
   </div>
   <div class="post" id="post-130643">
    <div class="subject"><a href="#post-130643">COM made easy - we hope...</a></div>
    <div class="body">Hi, japheth, <br />ATC has documentation, and 13 complete tutorials that show all macros in action (except for the $new macro). I suppose that anyone, who has learnt tute 13, can see the additional stuff that the macros do if used with the several lines of code EvilHomer2k posted above. Ok, I guess I'm too naive to ask for moral support too. I guess I should stop asking for feedback that can give me ideas about improvements in my code. I guess I should make my open-source code unreadable and usable only by me. <br />:grin: <br />Here's the incomplete code you want. I think you should read at least tute 1 - the complete package can be found in the top thread of the OOP forum.</div>
    <div class="meta">Posted on 2004-01-14 14:36:36 by Ultrano</div>
   </div>
   <div class="post" id="post-130659">
    <div class="subject"><a href="#post-130659">COM made easy - we hope...</a></div>
    <div class="body">Thanks Ultrano,<br /><br />I downloaded the code and can see it may work in the near future. <br /><br />BTW: trying to compile it MASM complains about HeapAlloc/HeapFree redefined (thats because I used IExtIA.EXE tool I guess, no big issue).<br /><br />I must admit also that in the first post there was a sample, but I didnt recognize it at first glance, because the .ASM extension was missing and no comment at the start of the file (and it didnt compile either)<br /><br />And if you would accept a hint (no offense): its not wise to react with sarcasm at some (mild) critics.<br /><br />Japheth</div>
    <div class="meta">Posted on 2004-01-15 00:19:21 by japheth</div>
   </div>
  </div>
 </body>
</html>