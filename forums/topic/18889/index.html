<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>my movie database program - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18889" />
    <link rel="next" href="../?id=18889&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18889">my movie database program</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=18889&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=18889&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="18889" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=18889&amp;page=2">&gt;</a><a href="../?id=18889&amp;page=2">&raquo;</a></form>   <div class="post" id="post-146173">
    <div class="subject"><a href="#post-146173">my movie database program</a></div>
    <div class="body">final beta version posted at newer post. let me know if you find any bugs and let me know what you think.</div>
    <div class="meta">Posted on 2004-07-16 00:05:14 by smurf</div>
   </div>
   <div class="post" id="post-146176">
    <div class="subject"><a href="#post-146176">my movie database program</a></div>
    <div class="body">Hi Smurf,<br /><br />Cool. A couple of suggestions though. First the FIND function should be capable of finding any word or string in the title, for example A Fist Full of Dollars was not found when I searched for &quot;fist&quot;, wildcards would be ideal. Second you should parse the title to not sort &quot;the&quot; and &quot;a&quot; for example The Matrix should be listed under M not T, otherwise you will just end up with 2 letters containing 80% of all titles. Finally since you are using SQL to seach the database, it would be nice to include a user defined grouping tab, the user could set it up with combo boxes. The information is too limited, a synopsis and/or rating field is needed perhaps a type as well (VHS/DVD/VCD). These need not be displayed but a double click could present a &quot;more info&quot; dialog.</div>
    <div class="meta">Posted on 2004-07-16 01:01:50 by donkey</div>
   </div>
   <div class="post" id="post-146187">
    <div class="subject"><a href="#post-146187">my movie database program</a></div>
    <div class="body">I'm also interested in a robust filesearch based on wildcard patterns, I've written one for my p2p but it's not very strong.<br />What I do is search for *$*.* (where $ represents the searchterm), and if no result is obtained, I decrease the length of the search string..<br /><br />*fist*.*<br />*fis*.*<br />*fi*.*<br />*f*.*<br /><br />I'm almost certain to find a result this way, but it may be far and away from the intended.<br /><br />Who has a better idea?</div>
    <div class="meta">Posted on 2004-07-16 04:28:56 by Homer</div>
   </div>
   <div class="post" id="post-146197">
    <div class="subject"><a href="#post-146197">my movie database program</a></div>
    <div class="body">i still need to implement listvew editing.<br /><br /><div class="quote">First the FIND function should be capable of finding any word or string in the title, for example A Fist Full of Dollars was not found when I searched for &quot;fist&quot;, wildcards would be ideal.</div><br />this will be easy to do. i was surprised as to how easy it is to work with sql statements.<br /><br /><div class="quote">Second you should parse the title to not sort &quot;the&quot; and &quot;a&quot; for example The Matrix should be listed under M not T, otherwise you will just end up with 2 letters containing 80% of all titles.</div><br />good point!<br /><br /><div class="quote">Finally since you are using SQL to seach the database, it would be nice to include a user defined grouping tab, the user could set it up with combo boxes. The information is too limited, a synopsis and/or rating field is needed perhaps a type as well (VHS/DVD/VCD). These need not be displayed but a double click could present a &quot;more info&quot; dialog</div><br />i dont think i will be implementing anything along those lines. this is pretty much tailored to my needs. i will release the source and if someone wants to they can change it.</div>
    <div class="meta">Posted on 2004-07-16 08:52:32 by smurf</div>
   </div>
   <div class="post" id="post-146218">
    <div class="subject"><a href="#post-146218">Can Your Posted your code?</a></div>
    <div class="body">I'm having problem with odbc and sql. I would like to see how you did it. Just post that part if<br />you want.</div>
    <div class="meta">Posted on 2004-07-16 13:58:42 by avalon</div>
   </div>
   <div class="post" id="post-146226">
    <div class="subject"><a href="#post-146226">my movie database program</a></div>
    <div class="body">I was thinking about wildcard searches and I'm going to try to come up with something. In the mean time I was reading about SoundEx which seems pretty cool, it lets you find words that sound similar so I wrote a routine to generate a SoundEx key and added it to my Strings library. It will generate a 4 byte key for any word and you can use it to search for words that sound the same. I am not sure how effective it is but it seemed interesting. For example :<br /><br />Philosophy = F421<br />filosofy = F421<br />lamb = L500<br />lamn = L500<br /><br />The function in the lib is lszSoundEx, the source is available in the Strings.lib download from my website.<br /><br />Note: My SoundEx is a little different than the one in SQL which I have just discovered. It allows for 2 characters separated by a vowel to generate separate numbers also it will replace some of the more common letter combinations that sound the same (PH is replaced by F). I think this will make it a little more accurate than the SQL version. Besides those 2 major differences it should generate the same values.</div>
    <div class="meta">Posted on 2004-07-16 16:06:20 by donkey</div>
   </div>
   <div class="post" id="post-146232">
    <div class="subject"><a href="#post-146232">my movie database program</a></div>
    <div class="body">Oh, there's a SoundEx in SQL? How do you use it? :)</div>
    <div class="meta">Posted on 2004-07-16 20:52:08 by f0dder</div>
   </div>
   <div class="post" id="post-146234">
    <div class="subject"><a href="#post-146234">my movie database program</a></div>
    <div class="body"><div class="quote"><br />Oh, there's a SoundEx in SQL? How do you use it? :) </div><br />No idea, I was just googling around for more information after I wrote my SoundEx from an outline I found and found that SQL has it too...<br /><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_setu-sus_3o6w.asp">MS Transact-SQL</a><br /><br /><a target="_blank" href="https://aurora.vcu.edu/db2help/db2s0/frame3.htm#sqls0489">DB2 SQL Reference</a><br /><br />I was working from these notes:<br /><br /><div class="quote">The SoundEx Algorithm as an Outline<br /><ul>[*]Capitalize all letters in the word and drop all punctuation marks. Pad the word with rightmost blanks as needed during each procedure step.<br />[*]Retain the first letter of the word.<br />[*]Change all occurrence of the following letters to '0' (zero):<br />        'A', E', 'I', 'O', 'U', 'H', 'W', 'Y'.<br />[*]Change letters from the following sets into the digit given:<br />          * 1 = 'B', 'F', 'P', 'V'<br />          * 2 = 'C', 'G', 'J', 'K', 'Q', 'S', 'X', 'Z'<br />          * 3 = 'D','T'<br />          * 4 = 'L'<br />          * 5 = 'M','N'<br />          * 6 = 'R' <br />[*]Remove all pairs of digits which occur beside each other from the string that resulted after step (4).<br />[*]Remove all zeros from the string that results from step 5.0 (placed there in step 3)<br />[*]Pad the string that resulted from step (6) with trailing zeros and return only the first four positions, which will be of the form &lt;uppercase letter&gt; &lt;digit&gt; &lt;digit&gt; &lt;digit&gt;. </div><br /><br />I looked at the Smith/Smythe example from the MSDN page and I got S530 in both cases, as well the LUCCHESSI/Loucesy example from the other site gives me matching SoundEx keys (L220).</div>
    <div class="meta">Posted on 2004-07-16 21:22:05 by donkey</div>
   </div>
   <div class="post" id="post-146363">
    <div class="subject"><a href="#post-146363">my movie database program</a></div>
    <div class="body">i cleaned up the code a bit so i can post it. the controls are all in separate include files. You can download the new version along with the source up at my original post. the attachment has been changed.<br /><br />I was also wondering where movies that start with numbers like &quot;28 days&quot; should be listed under? should i make another button instead of including them alphabetically?<br /><br />When my complete list is shown should i also sort the list by inoring the &quot;The&quot; and &quot;A&quot; at the begining or should i leave it like i have it. The alphabetically list now sorts them appropriately.</div>
    <div class="meta">Posted on 2004-07-18 21:31:26 by smurf</div>
   </div>
   <div class="post" id="post-146364">
    <div class="subject"><a href="#post-146364">my movie database program</a></div>
    <div class="body">Hi smurf,<br /><br />Didn't have alot of time to look at it yet but I would go with another button for 0..9, just one should do, there are not alot of movies that would fall into that category. The program seems to work fine with Win2K on a quick look.</div>
    <div class="meta">Posted on 2004-07-18 21:43:31 by donkey</div>
   </div>
   <div class="post" id="post-146463">
    <div class="subject"><a href="#post-146463">my movie database program</a></div>
    <div class="body">im not able to find a solution for sorting the movies in the database in the complete listing in my program.<br /><br />im sure there must be an sql statement that will sort by ignoring leading words such as &quot;The&quot; or &quot;A&quot;.  Anyone familar with sql?</div>
    <div class="meta">Posted on 2004-07-20 00:06:03 by smurf</div>
   </div>
   <div class="post" id="post-146465">
    <div class="subject"><a href="#post-146465">my movie database program</a></div>
    <div class="body">Hi Smurf,<br /><br />The normal way would be to parse the input to move them to the end...<br /><br /><strong>The Matrix</strong> is stored as <strong>Matrix, The</strong> You can then decide whether to display them like this or to switch it back before adding them to the listview.</div>
    <div class="meta">Posted on 2004-07-20 00:50:47 by donkey</div>
   </div>
   <div class="post" id="post-146527">
    <div class="subject"><a href="#post-146527">my movie database program</a></div>
    <div class="body">so far everything is going good. the problem i have is when editing a subitem in my listview. i create a combobox as a child of the listview and place if over the subitem to edit.  my problem is detecting when the combobox loses focus. So far my method detects WM_LBUTTONDOWN, WM_RBUTTONDOWN, WM_MBUTTONDOWN, WM_MOUSEWHEEL AND WM_VSCROLL. This seems to be too much and there should be something easier to implement.</div>
    <div class="meta">Posted on 2004-07-21 07:11:14 by smurf</div>
   </div>
   <div class="post" id="post-146528">
    <div class="subject"><a href="#post-146528">my movie database program</a></div>
    <div class="body">I create a combobox in a listview in the UpdateManager program on my website, in essence I subclass the control so I can find out when it loses focus. You must be careful to also watch for scrolling when you create the combo as well.<br /><br /><pre><code>ComboboxProc FRAME hwnd,uMsg,wParam,lParam<br />	uses ebx,edi,esi<br />	LOCAL lvi		&#58;LV_ITEM<br /><br />	cmp D&#91;uMsg&#93;,WM_KILLFOCUS<br />	jne &gt;&gt;M3<br />		invoke GetWindowLong,&#91;hwnd&#93;,GWL_USERDATA<br />		mov ebx,eax<br />		cmp D&#91;ebx+CHILDDATA.fType&#93;,0<br />		jne &gt;&gt;M5<br />			invoke SendMessage,&#91;hwnd&#93;,CB_GETCURSEL,0,0<br />			or eax,eax<br />			js &gt;&gt;<br />				invoke SendMessage, &#91;hwnd&#93;, CB_GETLBTEXT, eax, OFFSET cbstring<br />				mov eax,&#91;ebx+CHILDDATA.iItem&#93;<br />				mov &#91;lvi.iItem&#93;,eax<br />				mov eax,&#91;ebx+CHILDDATA.iSubitem&#93;<br />				mov &#91;lvi.iSubItem&#93;,eax<br />				mov D&#91;lvi.imask&#93;,LVIF_TEXT<br />				mov D&#91;lvi.pszText&#93;,OFFSET cbstring<br />				invoke SendMessage, &#91;ebx+CHILDDATA.hParent&#93;, LVM_SETITEMTEXT,<br />						&#91;ebx+CHILDDATA.iItem&#93;, OFFSET lvi<br />				mov D&#91;UpdateFlag&#93;, TRUE<br />			&#58;<br />			invoke SendMessage, &#91;hwnd&#93;, WM_CLOSE, 0, 0<br />			jmp &gt;&gt;M5<br /><br />	M3&#58;<br />	cmp D&#91;uMsg&#93;, WM_CLOSE<br />	jne &gt;M5<br />		invoke DestroyWindow,&#91;hwnd&#93;<br />		<br />	M5&#58;<br />	; Win9x can return a zero for GWL_USERDATA so we must<br />	; check it and call DefWindowProc if it returns 0 or it will GPF<br />	invoke GetWindowLong,&#91;hwnd&#93;,GWL_USERDATA<br />	or eax,eax<br />	jz &gt;<br />		invoke CallWindowProc,&#91;eax+CHILDDATA.pOldProc&#93;,&#91;hwnd&#93;,&#91;uMsg&#93;,&#91;wParam&#93;,&#91;lParam&#93;<br />		ret<br />	&#58;<br />		invoke DefWindowProc,&#91;hwnd&#93;,&#91;uMsg&#93;,&#91;wParam&#93;,&#91;lParam&#93;<br />		ret<br /><br />ENDF</code></pre><br /><br />The CHILDDATA structure just contains information about the item that created the combo...<br /><br /><pre><code>CHILDDATA struct<br />	pOldProc	DD<br />	hParent		DD<br />	iItem		DD<br />	iSubitem	DD<br />	fType		DD<br />ENDS</code></pre></div>
    <div class="meta">Posted on 2004-07-21 07:19:21 by donkey</div>
   </div>
   <div class="post" id="post-146530">
    <div class="subject"><a href="#post-146530">my movie database program</a></div>
    <div class="body">confusion regarding the CHILDDATA structure. does sending the getwindowlong with GWL_USERDATA to a listview also return the same values you have for your CHILDDATA structure?<br /><br />ok figured out my problem was that my combobox never had focus after it was created.<br /><br /><br />why can i not add this struture in my .data? section only as a LOCAL in a procedure without getting an error?<br /><br />LV_HITTESTINFO or<br />LVHITTESTINFO</div>
    <div class="meta">Posted on 2004-07-21 07:47:50 by smurf</div>
   </div>
   <div class="post" id="post-146535">
    <div class="subject"><a href="#post-146535">my movie database program</a></div>
    <div class="body">Hi Smurf,<br /><br />Actually the GWL_USERDATA contains a pointer to the CHILDDATA structure for that particular control. It is just a structured way of keeping track of handles and pointers for child controls that I use from time to time though it was not essential in this case I put it in to allow for easy expansion later. I am not sure why you are having a problem with LOCAL vs GLOBAL allocations for LV_HITTESTINFO, it should not make a difference.</div>
    <div class="meta">Posted on 2004-07-21 09:55:20 by donkey</div>
   </div>
   <div class="post" id="post-146733">
    <div class="subject"><a href="#post-146733">my movie database program</a></div>
    <div class="body">ok final beta version is posted at first thread. Lots of time spent fine tuning it. Could I get some testers to see if you can find some bugs? Let me know how things turn out.</div>
    <div class="meta">Posted on 2004-07-24 21:32:12 by smurf</div>
   </div>
   <div class="post" id="post-146735">
    <div class="subject"><a href="#post-146735">my movie database program</a></div>
    <div class="body">Bug Report :) <br /><br />In complete list window : <br />1) changing genre doesn't work.<br />2) after changing te genre, tried to change the movie, this doesn't work either.<br /><br />That's all i found so far.</div>
    <div class="meta">Posted on 2004-07-24 21:56:14 by Jurgen</div>
   </div>
   <div class="post" id="post-146741">
    <div class="subject"><a href="#post-146741">my movie database program</a></div>
    <div class="body"><div class="quote"><br />im not able to find a solution for sorting the movies in the database in the complete listing in my program.<br /><br />im sure there must be an sql statement that will sort by ignoring leading words such as &quot;The&quot; or &quot;A&quot;.  Anyone familar with sql? </div><br />Hi<br /><br />Did you &quot;play&quot; with RIGHT or SUBSTR function?<br /><br />RIGHT(&lt;string&gt;,X) - Returns the rightmost X characters of the string<br />SUBSTR(&lt;string&gt;,X,Y) - Extracts Y letters from the string beginning at position X<br /><br />stanks</div>
    <div class="meta">Posted on 2004-07-25 02:19:49 by stanks</div>
   </div>
   <div class="post" id="post-146755">
    <div class="subject"><a href="#post-146755">my movie database program</a></div>
    <div class="body"><div class="quote">Did you &quot;play&quot; with RIGHT or SUBSTR function?<br /><br />RIGHT(&lt;string&gt;,X) - Returns the rightmost X characters of the string<br />SUBSTR(&lt;string&gt;,X,Y) - Extracts Y letters from the string beginning at position X</div><br /><br />used hutch's masm32 library for that. my sorting works like i want it to now. just have some bugs to work out on the editing of text in the listview.</div>
    <div class="meta">Posted on 2004-07-25 08:08:48 by smurf</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=18889&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=18889&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="18889" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=18889&amp;page=2">&gt;</a><a href="../?id=18889&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>