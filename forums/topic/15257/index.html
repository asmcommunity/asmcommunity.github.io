<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Build Plugin Support... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15257" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15257">Build Plugin Support...</a></p>
   <div class="post" id="post-118526">
    <div class="subject"><a href="#post-118526">Build Plugin Support...</a></div>
    <div class="body">Ok the first question should be an easy on to answer but i have never try to do it before so i dont know what i need to do...<br /><br />First off i want to build a program that can take and use plugins made for it.... I would like to have the program look into a directory and grab a list of all dlls... i dont know how to do that so if you could help me out there...<br /><br />i know to make a plugin system work i have to have a default PROC to be called on... it is possible to have the program grab the needed info from that proc or will i have to have a plugin ini like for 3D Studio Max..</div>
    <div class="meta">Posted on 2003-09-18 02:37:21 by devilsclaw</div>
   </div>
   <div class="post" id="post-118529">
    <div class="subject"><a href="#post-118529">Build Plugin Support...</a></div>
    <div class="body">Use the FindFirstFile and FindNextFile API in a loop to build your DLL list.<br />Then for each DLL filename call LoadLibrary and pass the returned handle to GetProcAddress, specifying the name or ordinal of the exported procedure according to your plugin specifications.  If the procedure doesn't exist then be sure to call FreeLibrary on the module.<br /><br />Consult the platform SDK on these APIs.</div>
    <div class="meta">Posted on 2003-09-18 03:18:00 by iblis</div>
   </div>
   <div class="post" id="post-118531">
    <div class="subject"><a href="#post-118531">Build Plugin Support...</a></div>
    <div class="body">You might want to take a look at Ketil's AddInManager DLL. It is available with source code from his RadASM site. The &quot;ListDlls&quot; procedure does exactly that. If your DLL has a predefined procedure that returns the info you need you can get the information as you build the list by loading the DLL then calling the procedure.</div>
    <div class="meta">Posted on 2003-09-18 03:44:54 by donkey</div>
   </div>
   <div class="post" id="post-118532">
    <div class="subject"><a href="#post-118532">Build Plugin Support...</a></div>
    <div class="body">thanks both of you i will try them both..</div>
    <div class="meta">Posted on 2003-09-18 03:59:24 by devilsclaw</div>
   </div>
  </div>
 </body>
</html>