<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>masm loader with exception handler - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17886" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=24">IDE usage &amp; development</a> &raquo; <a href="../?id=17886">masm loader with exception handler</a></p>
   <div class="post" id="post-138118">
    <div class="subject"><a href="#post-138118">masm loader with exception handler</a></div>
    <div class="body">hi guys,<br /><br />i'm looking for help in creating a loader with exception (SEH) handler<br /><br />does anyone have a MASM example of a loader that handles exceptions ??<br /><br />thanx, JohnDoe1</div>
    <div class="meta">Posted on 2004-04-06 11:58:50 by JohnDoe1</div>
   </div>
   <div class="post" id="post-138122">
    <div class="subject"><a href="#post-138122">masm loader with exception handler</a></div>
    <div class="body">'loader'?</div>
    <div class="meta">Posted on 2004-04-06 12:12:10 by f0dder</div>
   </div>
   <div class="post" id="post-138128">
    <div class="subject"><a href="#post-138128">masm loader with exception handler</a></div>
    <div class="body">yes,<br /><br />i want to write a loader for my project i created in VB<br />need to be able to catch the SEH's from that program <br /><br />i want to start the process of the vb exe as a sort of debuggee<br /><br />so i can catch any info on it.. i thought that was called a loader....</div>
    <div class="meta">Posted on 2004-04-06 12:39:07 by JohnDoe1</div>
   </div>
   <div class="post" id="post-138133">
    <div class="subject"><a href="#post-138133">masm loader with exception handler</a></div>
    <div class="body">SEH's are per-thread, so this would require some work. I also don't quite see the usefulness of this, perhaps you could elaborate a bit more and convince me you're not trying to use this for crax0ring?</div>
    <div class="meta">Posted on 2004-04-06 12:51:14 by f0dder</div>
   </div>
   <div class="post" id="post-138138">
    <div class="subject"><a href="#post-138138">masm loader with exception handler</a></div>
    <div class="body">well, if i would want to crack a program<br /><br />i could use a template and then i prolly wouldn't need SEH handling...<br /><br />i created a program in vb that has an activeX component that load a HOOK dll<br /><br />to intercept all create processes...<br /><br />this is because i want to be able to write a license tracking system for use at our office<br /><br />the program i wrote functions ok, but... i get errors on unhooking the dll<br /><br />and on returning values to the hooked dll... ( but the program doesn't crash however<br />just don't get the result i was expecting)<br /><br />if i was able to have a loader that could catch all seh' exceptions<br />and write them to a textfile or whatsoever<br /><br />i could prolly see on what part of the memory the problems occurs and then readjust / rewrite my code...<br /><br />using the debug function in vb itself didn't help me....<br /><br />convinced ??</div>
    <div class="meta">Posted on 2004-04-06 13:11:56 by JohnDoe1</div>
   </div>
   <div class="post" id="post-152068">
    <div class="subject"><a href="#post-152068">masm loader with exception handler</a></div>
    <div class="body">I don't know about a loader, but if we're talking about the code address stored in FS:[0], you can chain into it like this:<br /><pre><code><br />push offset myhandler<br />xor ebx,ebx<br />db 64h      ;FS segment override prefix<br />push &#91;ebx&#93; ;push dword ptr FS&#58;&#91;0&#93; without arousing suspicion<br />db 64h<br />mov &#91;ebx&#93;,esp<br /></code></pre><br />You'll want to restore FS:[0] later, I think. MASM doesn't seem to like us playing with FS.</div>
    <div class="meta">Posted on 2004-10-31 03:21:22 by LarryH</div>
   </div>
   <div class="post" id="post-152070">
    <div class="subject"><a href="#post-152070">masm loader with exception handler</a></div>
    <div class="body"><pre><code><br />assume fs&#58;nothing<br /></code></pre></div>
    <div class="meta">Posted on 2004-10-31 05:25:46 by roticv</div>
   </div>
  </div>
 </body>
</html>