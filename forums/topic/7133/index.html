<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>linker /OPT:REF option - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7133" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=7133">linker /OPT:REF option</a></p>
   <div class="post" id="post-51608">
    <div class="subject"><a href="#post-51608">linker /OPT:REF option</a></div>
    <div class="body">My goal is to eliminate from project functions and data that is never referenced.<br />And linker option /OPT:REF is exactly for this.<br />But can't force linker to understand it.<br />Link's version is 5.012.8078.0 (from masm32 package).<br />Asmvars by J.Collake is good but don't scan for unreferenced functions.<br />May be is there some tools for this? And what's wrong with /OPT:REF?<br />Thanks.</div>
    <div class="meta">Posted on 2002-08-04 08:03:25 by Four-F</div>
   </div>
   <div class="post" id="post-51779">
    <div class="subject"><a href="#post-51779">linker /OPT:REF option</a></div>
    <div class="body">Let me guess.  You put all your code in one big source file (or maybe a few files) and you want to use the linker option to remove unnecessary parts.  Right?<br /><br />That does not work unless you use Visual C/C++.  It is not linker's fault.  It is not MASM's fault, either.  MASM is just too old to exploit Microsoft's own extention of COFF object file format.<br /><br />The solution is;<br />you have to separate all of your PROCs into separate files, assemble each of them, create a library, then link the library.  There is no other way to achieve what you want at this time.<br /><br />AFAIK, the only compiler exploits the Microsoft extension of COFF format is Visual C/C++.  So, don't bother to use '/opt:ref' with your asm files.</div>
    <div class="meta">Posted on 2002-08-05 14:14:12 by Starless</div>
   </div>
  </div>
 </body>
</html>