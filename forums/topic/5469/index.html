<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Import library question???? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5469" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5469">Import library question????</a></p>
   <div class="post" id="post-38832">
    <div class="subject"><a href="#post-38832">Import library question????</a></div>
    <div class="body">If an api within an &quot;.asm&quot; file makes the linker(tasm linker) send an error for external unresolved, would that be an error within the asm or inc files or because the import library doesn't have the api under kernel32: lstrlen api. My import library is dated from 1996. If it's the import library short coming how do I solve that for tasm32. Please be specific as I'm a newbie.<br /><br />(sorry NaN, hope this post isn't against the rules. Oh please delete the previous thread if possible Thanks. I wish to learn asm programing but the books are very few and the compilers/assemblers are not that compatible with each other to just use another assembler.)</div>
    <div class="meta">Posted on 2002-05-18 15:11:50 by BeHereNow</div>
   </div>
   <div class="post" id="post-38835">
    <div class="subject"><a href="#post-38835">Import library question????</a></div>
    <div class="body">have you included both the kernel inc and lib file.</div>
    <div class="meta">Posted on 2002-05-18 15:46:57 by Kudos</div>
   </div>
   <div class="post" id="post-38836">
    <div class="subject"><a href="#post-38836">Kernel.inc?</a></div>
    <div class="body">I have an import library for tasm32. It didn't have a kernel.inc in the folder. Is that a command I have to put in the .asm file like:<br />include kernel.inc<br />or is it a file I generate from windows(if so how do I do that) or download somewhere. or is it to be included in the .inc file? what would be the proper way to list it there?<br />Thanks for taking the time to read and answer the question.</div>
    <div class="meta">Posted on 2002-05-18 15:53:43 by BeHereNow</div>
   </div>
   <div class="post" id="post-38839">
    <div class="subject"><a href="#post-38839">Unresolved external</a></div>
    <div class="body">What does it mean? My understanding is that this is a code line that cannot function or be implemented either due to not being in the .inc file and/or has no reference in the import library.<br />Am I understanding it correctly?</div>
    <div class="meta">Posted on 2002-05-18 16:02:28 by BeHereNow</div>
   </div>
   <div class="post" id="post-38840">
    <div class="subject"><a href="#post-38840">Import library question????</a></div>
    <div class="body">the inc file would be included by your asm file. Maybe you have a different inc file, it dosen't realy matter what the inc file's name is as long as it contains the prototypes for the functions. usually you have one inc and one lib file for every library you want to link to.</div>
    <div class="meta">Posted on 2002-05-18 16:05:15 by Kudos</div>
   </div>
   <div class="post" id="post-38842">
    <div class="subject"><a href="#post-38842">Unresolved external</a></div>
    <div class="body">it means you are using a function that the assembler can't find.</div>
    <div class="meta">Posted on 2002-05-18 16:07:06 by Kudos</div>
   </div>
   <div class="post" id="post-38844">
    <div class="subject"><a href="#post-38844">Yes</a></div>
    <div class="body">I do have an .inc , .asm , .rc , .res , and I managed to get an .obj file from &quot;make.exe&quot;.<br />My .exe that's generated is being deleted by my linker.exe because of unresolved function, that is included in the .inc file and the .asm file.<br />My thought is since the &quot;make.exe&quot; is generating an .obj file then probably the .asm file is fine. This leaves the .inc file to probably not having the proper declaration or the declaration is not having a way to be linked with the import library because it's not there.<br />Why? Because the api function is from windoz 95 and above, while the library is old so most likely it doesn't list this api(mine doesn't because I looked for it, but it might not have to be listed there. That's why I'm here asking this question).<br />Thanks again and I hope I clarified my question.<br />BTW the api's are:<br />lstrlenA<br />wsprintfA<br /><br />They are both included in the .asm file as follow:<br /><br />include xxxx.inc<br />extrn _wsprintfA:proc<br />extrn _lstrlenA:proc<br />fmat db &quot;%lu&quot;,0<br /><br />and included in the .inc file as follow:<br /><br />lstrlenA           PROCDESC  WINAPI    :LPCSTR<br /><br />I didn't know how to list wsprintf there.<br /><br />Thanks again.</div>
    <div class="meta">Posted on 2002-05-18 16:22:39 by BeHereNow</div>
   </div>
   <div class="post" id="post-38846">
    <div class="subject"><a href="#post-38846">Import library question????</a></div>
    <div class="body">I think that the problem is that your not linking to the lib file. I use masm and that uses includelib xxx.lib but I'm sure tasm has a similar command.</div>
    <div class="meta">Posted on 2002-05-18 16:27:49 by Kudos</div>
   </div>
   <div class="post" id="post-38848">
    <div class="subject"><a href="#post-38848">Thanks</a></div>
    <div class="body">I'll check the code to see if I link to the .lib file or not.</div>
    <div class="meta">Posted on 2002-05-18 16:32:12 by BeHereNow</div>
   </div>
   <div class="post" id="post-38850">
    <div class="subject"><a href="#post-38850">Import library question????</a></div>
    <div class="body">The API functions in the TASM lib file do not start with &quot;_&quot;. You should be linking to lstrlenA, not _lstrlenA.</div>
    <div class="meta">Posted on 2002-05-18 17:01:12 by tenkey</div>
   </div>
   <div class="post" id="post-38851">
    <div class="subject"><a href="#post-38851">Problem solved</a></div>
    <div class="body">Thanks tenkey and Kudos. I deleted the _ like you said. I also deleted the <br />&quot;extrn _wsprintfA:proc&quot; line from the asm file and it did compile fine.However the program causes a fault when executed and it doesn't run, but this is another problem that I have to look into. I also downloaded an updated import32.lib file that has much more functions listed(but that alone didn't solve the problem). Thank you again and happy assembling.</div>
    <div class="meta">Posted on 2002-05-18 17:32:49 by BeHereNow</div>
   </div>
   <div class="post" id="post-38856">
    <div class="subject"><a href="#post-38856">Import library question????</a></div>
    <div class="body">You are coding under TASM, so you tried this?<br /><br />Note  Unlike other Windows functions, wsprintf uses the C calling convention (_cdecl), rather than the Pascal calling convention. As a result, it is the responsibility of the calling process to pop arguments off the stack, and arguments are pushed on the stack from right to left. In C-language modules, the C compiler performs this task. <br /><br /><br />&quot;invoke&quot; (MASM) pop argumentos off the stack automatically ... while &quot;call&quot; (TASM) not ...</div>
    <div class="meta">Posted on 2002-05-18 18:27:19 by hunter</div>
   </div>
   <div class="post" id="post-38858">
    <div class="subject"><a href="#post-38858">pop the stack</a></div>
    <div class="body">I believe I did that. I think the code needs to be worked on for a little longer and I would have liked to use masm32 but the code doesn't transfer well between tasm and masm, so I just want to finish this program and then move to masm in other projects. Any tutorials on converting code between assemblers? BTW this is my very first programming experience ever and asm isn't the easiest to start with but I think it's very compact and offers better control of the compiling process(with it's own drawbacks like having to put in the right code). :)<br />Oh well I might do a little debugging to see where it crashes, and then I might have a clue on what I did wrong.<br />Cheers.</div>
    <div class="meta">Posted on 2002-05-18 20:05:59 by BeHereNow</div>
   </div>
   <div class="post" id="post-38859">
    <div class="subject"><a href="#post-38859">Import library question????</a></div>
    <div class="body">BeHereNow,<br /><br />I am getting a bit rusty with TASM as I have not used it for years bit if you have the installation disks and installed it completely, it has a set of utilities for creating import libraries from existing DLLs so you can make your own.<br /><br />With new projects, working with MASM will be a lot easier as it is a later assembler that has a lot more support available, help files, accessories etc ...<br /><br />Regards &amp; good luck with your project.<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-05-18 20:33:19 by hutch--</div>
   </div>
   <div class="post" id="post-39771">
    <div class="subject"><a href="#post-39771">Thanks</a></div>
    <div class="body">I finally got it running. I had to do it through Masm32 instead of Tasm because like Hutch said it's much better supported and I relied on examples to get my program running. I did find the utilty in tasm for making import library but somehow I ended up with smaller lib file than the ones included with tasm. Thanks again.</div>
    <div class="meta">Posted on 2002-05-24 15:05:32 by BeHereNow</div>
   </div>
  </div>
 </body>
</html>