<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>[API] Close window without killing the process. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21151" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21151">[API] Close window without killing the process.</a></p>
   <div class="post" id="post-160148">
    <div class="subject"><a href="#post-160148">[API] Close window without killing the process.</a></div>
    <div class="body">Hi all. :D<br /><br />My problem : I would like to open a web page (for instance &quot;http://www.google.fr&quot;) in the default browser then later close the window of this browser where there is that page.<br /><br />This code allows me to open the default browser at the url of Google :<br /><br />&nbsp; &nbsp; .586<br />&nbsp; &nbsp; .model flat,stdcall<br />&nbsp; &nbsp; option casemap :none<br /><br />&nbsp; &nbsp; Include \masm32\include\windows.inc<br />&nbsp; &nbsp; Include \masm32\include\kernel32.inc<br />&nbsp; &nbsp; Include \masm32\include\advapi32.inc<br />&nbsp; &nbsp; Include \masm32\include\user32.inc<br />&nbsp; &nbsp; include \masm32\include\shell32.inc<br /><br />&nbsp; &nbsp; Includelib \masm32\lib\shell32.lib<br />&nbsp; &nbsp; Includelib \masm32\lib\user32.lib<br />&nbsp; &nbsp; Includelib \masm32\lib\kernel32.lib<br />&nbsp; &nbsp; Includelib \masm32\lib\advapi32.lib<br /><br />&nbsp; &nbsp; .data<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; url&nbsp; &nbsp; &nbsp; &nbsp; db &quot;http://www.google.fr&quot;<br /><br />&nbsp; &nbsp; .data?<br /><br />&nbsp; &nbsp; .code<br /><br />&nbsp; &nbsp; start:<br />&nbsp; &nbsp; &nbsp; &nbsp; push SW_NORMAL<br />&nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; push OFFSET url<br />&nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; call ShellExecute<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; push 0<br />&nbsp; &nbsp; &nbsp; &nbsp; call ExitProcess<br /><br />&nbsp; &nbsp; end start<br /><br />Now, what I would like to know to do is to close the window have just opened while avoiding killing the process. It is not very<br />pleasant to see all the windows closing themselves if one of opened of it others, I would like to thus close only that there... I sought already in FindWindow to try to recover the handle window but I do not see what to put in parameter because I do not know how I can do to get the title of the window.<br /><br />Consequently you would be super sympas to agree to help me. :D<br /><br />Thanks in advance.</div>
    <div class="meta">Posted on 2005-05-17 08:56:49 by azerty1000</div>
   </div>
   <div class="post" id="post-160153">
    <div class="subject"><a href="#post-160153">Re: [API] Close window without killing the process.</a></div>
    <div class="body">If you destroy the window, it&#39;s up to the owner application whether to exit or not - there&#39;s not much you can do about that. You can use a value other than SW_NORMAL when calling ShellExecute, though.<br /><br />http://msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/functions/shellexecute.asp<br /><br />Hope that helps! :)</div>
    <div class="meta">Posted on 2005-05-17 13:40:27 by QvasiModo</div>
   </div>
   <div class="post" id="post-160154">
    <div class="subject"><a href="#post-160154">Re: [API] Close window without killing the process.</a></div>
    <div class="body">I don&#39;t think there&#39;s any easy way to close just the google results window - there are different browsers around (most notably internet explorer, firefox, mozilla and Opera), various versions of these browsers, and tabbed versions as well.<br /><br />If you want decent control, you should embed a browser object in your application instead. Someone from this board had an example how to embed both Internet Explorer and the Mozilla engines with assembly..<br /></div>
    <div class="meta">Posted on 2005-05-17 13:49:58 by f0dder</div>
   </div>
  </div>
 </body>
</html>