<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>HTML Help 2 viewer - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29291" />
    <link rel="next" href="../?id=29291&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=29291">HTML Help 2 viewer</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=29291&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=29291&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="29291" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=29291&amp;page=2">&gt;</a><a href="../?id=29291&amp;page=2">&raquo;</a></form>   <div class="post" id="post-206882">
    <div class="subject"><a href="#post-206882">HTML Help 2 viewer</a></div>
    <div class="body">An HTML help 2 viewer with GoAsm source code. This viewer uses the IHx group of interfaces, which are largely undocumented to display, search and manipulate Help2 namespaces like the PSDK and MSDN. It is available on my website with source and executable. Comments and bug reports would be very welcome.<br /><br /><a target="_blank" href="http://www.quickersoft.com/donkey/help2_viewer.htm">Help2 Viewer</a></div>
    <div class="meta">Posted on 2009-02-23 23:29:07 by donkey</div>
   </div>
   <div class="post" id="post-206892">
    <div class="subject"><a href="#post-206892">Re: HTML Help 2 viewer</a></div>
    <div class="body">Rob Chandler, author of FAR and H2Viewer and Microsoft Help MVP has helped me out with the home page issue, I was not getting a home page for MSDN Express edition. He emailed me how he accomplished it in FAR and it solved the problem nicely, version 0.4.0.0 has the GetHomePage function that is my attempt at implementing what he told me he did in H2Viewer. Essentially he first tries for the HomePage entry, if that&#039;s not found then the DefaultPage entry if that fails then he scans the table of contents to find the topmost url. I did not fully implement the scan of the TOC, I simply look at the first slot and if it contains a valid URL I use that, if not then I show a blank page.<br /><br />Again, I would appreciate feedback on whether everything is working.</div>
    <div class="meta">Posted on 2009-02-25 03:00:08 by donkey</div>
   </div>
   <div class="post" id="post-206897">
    <div class="subject"><a href="#post-206897">Re: HTML Help 2 viewer</a></div>
    <div class="body">hi..donkey:<br />Download your Source code to test the look .. but sometimes may crash .. do not know whether or because resources are not released due to other reasons .. Although the source code, but temporarily did not have time to read recently .. sorry<br /></div>
    <div class="meta">Posted on 2009-02-25 03:33:27 by Fido</div>
   </div>
   <div class="post" id="post-206901">
    <div class="subject"><a href="#post-206901">Re: HTML Help 2 viewer</a></div>
    <div class="body">Thanks Fido,<br /><br />If you get a chance, a little more information would be helpful. What Windows version, does it crash on startup, what Help 2 namespace are you using etc.. would be most useful in tracking the bug. Since there are no docs for iHx, I can&#039;t be sure whether the interfaces that are opened by another interface are shut down by it so I am going through the code checking as best I can, for other types of esources (i.e. memory and gui) it should not be a problem.</div>
    <div class="meta">Posted on 2009-02-25 07:03:29 by donkey</div>
   </div>
   <div class="post" id="post-206907">
    <div class="subject"><a href="#post-206907">Re: HTML Help 2 viewer</a></div>
    <div class="body">You have to love GoAsm,<br /><br />Nearly 2000 lines of code and the ANSI to UNICODE transition took less than half an hour and everything was working, I am so happy I picked this assembler !!!<br /><br />The UNICODE version has been uploaded (0.5.0.0) there was an issue with the commctrl header file under UNICODE that has been dealt with, headers version 0x013002 is required to build the application because of the error, that has been uploaded as well. There is very little code changed since the change over from ANSI to UNICODE apis is automatically handled in the headers. The most significant difference is the lack of conversion back and forth, there were places where the lstrcpyn function was used when moving data from bstr return values to memory buffers. I decided on lstrcpyn because since I have no control over the length of string returned from the COM calls it protects the buffers from overruns. Any inline quoted text has the L modifier to indicate UNICODE, declared text uses DUS. The only real issue I ran into was the registry, you will have to delete the registry key created by the ANSI version and run the program to reselect it, it is found under <br /><br />HKCU\Software\Donkey\HelpViewer\<br /><br />Just delete the whole thing, the namespace is the only thing saved there for now anyway.</div>
    <div class="meta">Posted on 2009-02-25 13:35:23 by donkey</div>
   </div>
   <div class="post" id="post-206911">
    <div class="subject"><a href="#post-206911">Re: HTML Help 2 viewer</a></div>
    <div class="body">Error Messages on Help2 Viewer.exe</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=2739" target="_blank">ER_MSG2009-02-26__10;53;01.txt</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2009-02-25 21:08:27 by dcskm4200</div>
   </div>
   <div class="post" id="post-206912">
    <div class="subject"><a href="#post-206912">Re: HTML Help 2 viewer</a></div>
    <div class="body">Hi dcskm4200,<br /><br />What was the version number you tested, there were many errors that were taken care of in the last upload (0.5.0.1) including a particularly nasty bug when changing namespaces. When was the error encountered ?<br /><br />Edgar</div>
    <div class="meta">Posted on 2009-02-25 21:21:12 by donkey</div>
   </div>
   <div class="post" id="post-206913">
    <div class="subject"><a href="#post-206913">Re: HTML Help 2 viewer</a></div>
    <div class="body">hi,donkey<br />thanks your responses.<br /><br />last download (0.5.0.1).<br /><div class="quote">When was the error encountered ?</div><br />startup.</div>
    <div class="meta">Posted on 2009-02-25 21:34:37 by dcskm4200</div>
   </div>
   <div class="post" id="post-206914">
    <div class="subject"><a href="#post-206914">Re: HTML Help 2 viewer</a></div>
    <div class="body">Thanks dcskm4200,<br /><br />I will look at the Dr Watson dump you posted and try to figure this one out. I hate Dr. Watson, it dumps itself as part of the stack and makes it difficult to trace back the last parameters pushed (then I can tell what the last call was). The error occured in Kernal32 and from the look of the stack was very early on, my guess is it was in the InitializeNamespace or LoadLastNamespace functions but I can&#039;t be sure until I take a closer look.<br /><br />The latest version is 0.5.0.3, though that was uploaded only a short time ago and just has the minor change that adds the version number to the about box. It should not affect your issue.<br /><br />Edgar</div>
    <div class="meta">Posted on 2009-02-25 22:14:02 by donkey</div>
   </div>
   <div class="post" id="post-206917">
    <div class="subject"><a href="#post-206917">Re: HTML Help 2 viewer</a></div>
    <div class="body">Hi dcskm4200,<br /><br />I am still not having any luck reproducing the error here and the dump file isn&#039;t very helpful, is there any way you can trace the execution to find out where the fault is, no one else has reported any start up problems on this version so I don&#039;t hav anything to validate a bug against. That said, not many people bother to report bugs, they just leech the code and leave you hanging (little pun), I have started to think it isn&#039;t worth it to post code since there is almost no feedback anymore. I will keep trying to reproduce the failure.</div>
    <div class="meta">Posted on 2009-02-26 18:31:08 by donkey</div>
   </div>
   <div class="post" id="post-206918">
    <div class="subject"><a href="#post-206918">Re: HTML Help 2 viewer</a></div>
    <div class="body">Didn&#039;t get to test this until now... Works fine on XP PRO SP2, Great feature the namespace thingy... I was worried that I would have to search through my quite messy tree of folders for any specific file but you handled it just fine :thumbsup:<br /><br /></div>
    <div class="meta">Posted on 2009-02-26 19:22:41 by JimmyClif</div>
   </div>
   <div class="post" id="post-206920">
    <div class="subject"><a href="#post-206920">Re: HTML Help 2 viewer</a></div>
    <div class="body">Thanks,<br /><br />Yes, Help2 uses registered namespaces, enumerating them was pretty simple once you figure out which interface to use. Help3 is supposed to be out very soon, the next release of VS is supposed to have a completely new (and documented ?) help system. Right now my major issue is to reverse engineer the CHM file format so I can extract an index and the topic URLs. I want to have a single help viewer for all the help files I have so I am busy with a hex editor and a couple of CHM files.<br /><br />Edgar</div>
    <div class="meta">Posted on 2009-02-27 01:28:34 by donkey</div>
   </div>
   <div class="post" id="post-206938">
    <div class="subject"><a href="#post-206938">Re: HTML Help 2 viewer</a></div>
    <div class="body">I have added a table of contents to the viewer along with a synchronize button on the toolbar. In order to add the TOC I also had to add a tab control which should allow for better expandability in the future as I can now add new windows easily. I have yet to code the splitter bar, too many things going on with other parts of the program right now. I am currently working on adding the ability to open CHM files in the viewer and making the UI transparent to the difference. This will allow for a fully integrated help system for both HTML Help 1.x and 2.0 with complete transparency to the user.<br /><br />The progress with HTMLHelp 1.x is slow, I have implemented the IStorage interface and can extract a Keyword index in XML format from any CHM file, the major outstanding issue is to parse the XML file. The TOC should be straight forward enough once I finish the parser. Once this is finished and implemented I will begin to scratch my head over the splitter bar and a few other UI issues.<br /><br />You can download the source and executable at my website.<br /><br />EDIT: The new version number is 0.6.0.0<br /><br />EDIT: Uploaded 0.6.1.1, moved the search to the tab bar, hopefully fixed dcskm4200&#039;s bug</div>
    <div class="meta">Posted on 2009-03-01 12:44:54 by donkey</div>
   </div>
   <div class="post" id="post-206940">
    <div class="subject"><a href="#post-206940">Re: HTML Help 2 viewer</a></div>
    <div class="body"><div class="quote">Uploaded 0.6.1.1, moved the search to the tab bar, hopefully fixed dcskm4200&#039;s bug</div><br />still crashed.<br /><br />maybe error here.<br /><pre><code>	// Get the available collections<br />	invoke CoCreateInstance,offset CLSID_HxRegistryWalker, NULL, CLSCTX_ALL,offset IID_IHxRegistryWalker, offset pHxRegSession<br />	CoInvoke(pHxRegSession,IHxRegistryWalker.RegisteredNamespaceList,,offset pIHxRegNamespaceList)<br />	CoInvoke(pIHxRegNamespaceList,IHxRegNamespaceList.Count,offset nNamespaces)<br />	mov ebx,<br />	test ebx,ebx<br />	Jz &gt;&gt;.EXITPROGRAM<br /></code></pre><br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=2740" target="_blank">er.jpg</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2009-03-01 18:57:39 by dcskm4200</div>
   </div>
   <div class="post" id="post-206941">
    <div class="subject"><a href="#post-206941">Re: HTML Help 2 viewer</a></div>
    <div class="body">Hi dcskm4200,<br /><br />looks like it crashes on the call to IHxRegistryWalker.RegisteredNamespaceList, this is likely because HxRegistryWalker failed to instantiate, I will attach a copy here of the executable only, run it and if you could report the error that it returns. I am working under the assumption that you have at least one Help2 namespace installed on your system, either the PSDK or MSDN. At any rate I should have caught the error even if there are no namespaces installed (and hence no Hx functionality)<br /><br />Edgar<br /><br />&lt;attachment removed&gt;</div>
    <div class="meta">Posted on 2009-03-01 21:08:50 by donkey</div>
   </div>
   <div class="post" id="post-206942">
    <div class="subject"><a href="#post-206942">Re: HTML Help 2 viewer</a></div>
    <div class="body">hi,donkey<br />Failed to find namespace error code = 80040154<br />could not find any help2 namespaces</div>
    <div class="meta">Posted on 2009-03-01 21:27:14 by dcskm4200</div>
   </div>
   <div class="post" id="post-206943">
    <div class="subject"><a href="#post-206943">Re: HTML Help 2 viewer</a></div>
    <div class="body">Hi,<br /><br />Error 0x80040154 &gt; Class not registered<br /><br />The program cannot find the Hx classes that are installed with DExplore. DExplore is installed when you install either the PSDK or MSDN, you cannot view the Help2 files without these interfaces installed. Could you check to see if DExplore operates properly ? You are the only person to report a bug in the interface list part of the program so I am curious as to how DExplore can find the available namespaces without HxRegistryWalker.<br /><br />DExplore can be found in the following path:<br /><br />C:\Program Files\Common Files\Microsoft Shared\Help 9<br /><br />Thanks,<br />Edgar</div>
    <div class="meta">Posted on 2009-03-01 21:37:14 by donkey</div>
   </div>
   <div class="post" id="post-206945">
    <div class="subject"><a href="#post-206945">Re: HTML Help 2 viewer</a></div>
    <div class="body">Version 0.6.1.4:<br /><br />A few minor changes to the UI, the DISPID_COMMANDSTATECHANGE event is processed allowing the back and forward buttons to be disabled when there are no pages for them to navigate to. The top of the web browser has been aligned to the tab control and the search window resizing issue has been dealt with.<br /><br />The initialization of the application had a bug where I assumed that any one running the app would have Help2 installed, that may not be the case so it will exit gracefully if the required class is not found. The OLE error code is reported in the termination dialog if the program cannot load Help2.<br /><br />Edgar</div>
    <div class="meta">Posted on 2009-03-02 02:21:20 by donkey</div>
   </div>
   <div class="post" id="post-206960">
    <div class="subject"><a href="#post-206960">Re: HTML Help 2 viewer</a></div>
    <div class="body">Version 0.6.2.1<br /><br />Added a command line option to do an index search, this is primarily for integration into an IDE. The command line is very simple...<br /><br />Help2 Viewer.exe /Keyword /Namespace<br /><br />The keyword cannot contain spaces, nor can there be a space after the /. In order to make the program workable I also added a SingleInstance function, it enforces only one instance of the program to be running at a time. If another is started the command line is parsed and through some fancy interprocess communication it passes the keyword to the running instance. However, I am not entirely sure that Vista allows this type of thing so I need someone to test on Vista. Also the program needs to be run in Admin mode as far as I know, if someone can test that as well I would greatly appreciate it.<br /><br />EDIT&gt; I thought about the command line and added the /Namespace as well. The program will check to see if one was specified and initialize it if it is. The arguments are location specific, in other words the first argument must be the keyword. The namespace is as it appears in the select namespace dialog, that is :<br /><br />MS.MSDNQTR.v90.en<br /><br />Do not add the &quot;ms-help://&quot; prefix, it is added by the program.<br /><br />Since this feature is aimed at IDE plugin authors I have decided the strictness is not a limitation so I will most likely not be changing it to a more robust method. It is up to the IDE to determine the fitness of the data passed.</div>
    <div class="meta">Posted on 2009-03-03 16:58:01 by donkey</div>
   </div>
   <div class="post" id="post-206969">
    <div class="subject"><a href="#post-206969">Re: HTML Help 2 viewer</a></div>
    <div class="body">Version 0.6.2.4<br /><br />Had to redo the command line parser to parse it completely from within the application as there were issues with instances started through CreateProcess when lpApplicationName was non-NULL. It should now catch the problem and deal with it appropriately, I also added the option to change collections from an IDE, the command line syntax remains the same.</div>
    <div class="meta">Posted on 2009-03-05 19:06:19 by donkey</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=29291&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=29291&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="29291" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=29291&amp;page=2">&gt;</a><a href="../?id=29291&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>