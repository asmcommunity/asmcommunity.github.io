<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>C to FASM define/macro conversion - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25273" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25273">C to FASM define/macro conversion</a></p>
   <div class="post" id="post-184854">
    <div class="subject"><a href="#post-184854">C to FASM define/macro conversion</a></div>
    <div class="body">Hi ppl, <br /><br />I am having trouble with converting something from C to FASM:<br /><br /><pre><code>#define _IOC(dir,type,nr,size) \<br />	(((dir)&nbsp; &lt;&lt; _IOC_DIRSHIFT) | \<br />	 ((type) &lt;&lt; _IOC_TYPESHIFT) | \<br />	 ((nr)&nbsp; &nbsp;&lt;&lt; _IOC_NRSHIFT) | \<br />	 ((size) &lt;&lt; _IOC_SIZESHIFT))<br />	 <br />#define _IOR(type,nr,size) _IOC(_IOC_READ,(type),(nr),(size))<br /><br />#define	TEST _IOR(&#39;t&#39;, 90, 4)</code></pre><br /><br />Basically I want to make the FASM variant as close to C as possible:<br /><br /><pre><code>macro _IOC dir,type,nr,size<br />{((dir shl _IOC_DIRSHIFT) or (type shl _IOC_TYPESHIFT) or (nr shl _IOC_NRSHIFT) or (size shl _IOC_SIZESHIFT))}<br /><br />macro _IOR type, nr, size {_IOC _IOC_READ, type, nr, size}<br /><br />TEST equ (_IOR &#39;t&#39;, 90, 4)&nbsp; &nbsp; &nbsp;;&nbsp; &lt;---&nbsp; &nbsp; the problem.</code></pre><br /><br />Is there any way to make FASM to assign a result of a macro instead of the macro invoking string?<br />Or any other way to convert this? I suspect that I am taking a completely wrong direction here... Saw somewhere same thing being done differently, but forgot where or how&nbsp; :sad: <br /><br /></div>
    <div class="meta">Posted on 2006-08-28 15:24:31 by arafel</div>
   </div>
   <div class="post" id="post-184857">
    <div class="subject"><a href="#post-184857">Re: C to FASM define/macro conversion</a></div>
    <div class="body">Hmmm, good question... the FASM macro system doesn&#39;t have an equivalent to MASM&#39;s &quot;EXITM&quot;... but I&#39;m pretty green with fasm macros. You might have a better chance of decent replies on the FASM board :)<br /></div>
    <div class="meta">Posted on 2006-08-28 17:30:19 by f0dder</div>
   </div>
   <div class="post" id="post-184875">
    <div class="subject"><a href="#post-184875">Re: C to FASM define/macro conversion</a></div>
    <div class="body"><div class="quote"><br />You might have a better chance of decent replies on the FASM board :)<br /></div><br /><br />Yep, I guess I should overcome my laziness and finally register there. :)</div>
    <div class="meta">Posted on 2006-08-29 04:01:16 by arafel</div>
   </div>
  </div>
 </body>
</html>