<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>again desktop handle problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26714" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26714">again desktop handle problem</a></p>
   <div class="post" id="post-192718">
    <div class="subject"><a href="#post-192718">again desktop handle problem</a></div>
    <div class="body">ok, here is my problem: my program gets the foregroundwindow's handle every 10 seconds and shows it in a messagebox after converting it with wsprintf. buf if i click on the desktop my program for example retrieves handle 360. ok, if i use a program that hooks the mouse, i can't find the handle 360 anywhere! but why? the mouse hook program shows that the desktops classname is SysListView, and the handle is another than 360. GetDesktopWindow also doesn't work, it retrieves another handle. why?
tnx for help</div>
    <div class="meta">Posted on 2001-01-30 12:12:00 by [SaFc0n]</div>
   </div>
   <div class="post" id="post-192719">
    <div class="subject"><a href="#post-192719">again desktop handle problem</a></div>
    <div class="body">Hi,
maybe the value is in hex or maybe the handle changes at each start (i'm not sure) but when you execute a prog, the handle changes.

Vom-bonjour:-()</div>
    <div class="meta">Posted on 2001-01-30 13:23:00 by Vom-bonjour:-()</div>
   </div>
   <div class="post" id="post-192720">
    <div class="subject"><a href="#post-192720">again desktop handle problem</a></div>
    <div class="body">You might want to find out what kind of window you're getting with GetClassName.</div>
    <div class="meta">Posted on 2001-01-30 14:47:00 by tank</div>
   </div>
   <div class="post" id="post-192721">
    <div class="subject"><a href="#post-192721">again desktop handle problem</a></div>
    <div class="body">yeah, you're right, the handle changes every time i reboot my computer. the classname of the desktop is "program manager". but i don't know what i need this class name for. so, has anybody an idea what i could do to get the real desktops handle?

tnx for replies</div>
    <div class="meta">Posted on 2001-01-31 03:47:00 by [SaFc0n]</div>
   </div>
  </div>
 </body>
</html>