<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>icons in buttons - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29973" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=29973">icons in buttons</a></p>
   <div class="post" id="post-211597">
    <div class="subject"><a href="#post-211597">icons in buttons</a></div>
    <div class="body">hello, I have a problem trying to painting an icon into a button. I have tried several ways, but no one works. I share a code where I couldn&#039;t do this job.<br /><br />Can anyone help, please?<br /><br />VentWN1.asm:<br /><pre><code><br />; ----------------------------------------------------------------------------<br />; -&nbsp; &nbsp; &nbsp;  TITULO&nbsp; : Ejemplo de botón con icono W-NASM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -<br />; -----&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -----<br />; -&nbsp; &nbsp; &nbsp;  AUTOR&nbsp;  : Alfonso Víctor Caballero Hurtado&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  -<br />; -----&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -----<br />; -&nbsp; &nbsp; &nbsp;  VERSION : 1.0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; -<br />; ----------------------------------------------------------------------------<br /><br />%include &#039;..\..\..\inc\nasmx.inc&#039;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Incluímos macros<br />%include &#039;..\..\..\inc\win32\windows.inc&#039;&nbsp; &nbsp; &nbsp; ; Incluímos definiciones de estructuras y constantes<br />%include &#039;..\..\..\inc\win32\kernel32.inc&#039;&nbsp; &nbsp;  ; Importamos las bibliotecas para que el enlazador pueda trabajar<br />%include &#039;..\..\..\inc\win32\user32.inc&#039;&nbsp; &nbsp; &nbsp;  ; Importamos las bibliotecas para que el enlazador pueda trabajar<br /><br />cdXPos&nbsp; &nbsp; &nbsp; EQU&nbsp; 128&nbsp; &nbsp; &nbsp; &nbsp;  ; Constante double X-Posición de la ventana(esq sup izqda)<br />cdYPos&nbsp; &nbsp; &nbsp; EQU&nbsp; 128&nbsp; &nbsp; &nbsp; &nbsp;  ; Constante double Y-Posición de la ventana(esq sup izqda)<br />cdXSize&nbsp; &nbsp;  EQU&nbsp; 320&nbsp; &nbsp; &nbsp; &nbsp;  ; Constante double X-tamaño de la ventana<br />cdYSize&nbsp; &nbsp;  EQU&nbsp; 200&nbsp; &nbsp; &nbsp; &nbsp;  ; Constante double Y-tamaño de la ventana<br />cdColFondo&nbsp; EQU&nbsp; COLOR_BTNFACE + 1&nbsp; ; Color de fondo de la ventana: gris de un botón de comando<br />cdVIcono&nbsp; &nbsp; EQU&nbsp; IDI_APPLICATION ; Icono de la ventana<br />cdVCursor&nbsp;  EQU&nbsp; IDC_ARROW&nbsp;  ; Cursor para la ventana<br />cdVBarTipo&nbsp; EQU&nbsp; NULL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; Normal, con icono<br />cdVBtnTipo&nbsp; EQU&nbsp; WS_VISIBLE+WS_DLGFRAME+WS_SYSMENU&nbsp; &nbsp; ; Normal sólo con botón cerrar<br /><br />entry Entrada<br /><br /><br />&nbsp; proc&nbsp; &nbsp; Entrada<br />&nbsp; &nbsp; invoke&nbsp;  GetModuleHandleA, dword NULL<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , eax<br />&nbsp; &nbsp; INVOKE&nbsp;  GetCommandLineA<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , EAX<br />&nbsp; &nbsp; invoke&nbsp;  WinMain, dword wc + WNDCLASSEX.hInstance, dword NULL, dword CommandLine, dword SW_SHOWNORMAL<br />&nbsp; &nbsp; invoke&nbsp;  ExitProcess, dword NULL<br />&nbsp; &nbsp; ret<br />&nbsp; endproc<br />&nbsp; <br />&nbsp; proc&nbsp; &nbsp; WinMain<br />&nbsp; &nbsp; ;&nbsp; Propósito: Inicializamos la ventana principal de la aplicación y captura errores, si los hubiere<br />&nbsp; &nbsp; ;&nbsp; Entrada&nbsp; : hInst:HINSTANCE, hPrevInst:HINSTANCE, CmdLine:LPSTR, CmdShow:DWORD<br />&nbsp; &nbsp; ;&nbsp; Salida&nbsp;  : Ninguna<br />&nbsp; &nbsp; ;&nbsp; Destruye : Ninguna<br />&nbsp; &nbsp; ; Recogemos los parámetros<br />&nbsp; &nbsp; hinst&nbsp; &nbsp; argd&nbsp; &nbsp; &nbsp; &nbsp; ; Current instance handle - enganche a la instancia actual<br />&nbsp; &nbsp; hpinst&nbsp;  argd&nbsp; &nbsp; &nbsp; &nbsp; ; Previous instance handle- enganche a la instancia previa<br />&nbsp; &nbsp; cmdln&nbsp; &nbsp; argd&nbsp; &nbsp; &nbsp; &nbsp; ; Command line arguments&nbsp; - argumentos de la línea de comandos<br />&nbsp; &nbsp; dwshow&nbsp;  argd&nbsp; &nbsp; &nbsp; &nbsp; ; Display style&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  - Estilo de despliegue<br /><br />&nbsp; &nbsp; invoke&nbsp;  LoadIconA, dword argv(hinst), NULL;dword cdVIcono<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; edx, eax<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; eax, dword argv(hinst)<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; ebx, dword NombreClase<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; ecx, dword WndProc<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , eax<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , ebx<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , ecx<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , edx<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , edx<br /><br />&nbsp; &nbsp; invoke&nbsp;  LoadCursorA, NULL, cdVCursor<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , eax<br /><br />&nbsp; &nbsp; invoke&nbsp;  RegisterClassExA, dword wc<br />&nbsp; &nbsp; test&nbsp; &nbsp;  eax, eax<br />&nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp;  L_Error<br /><br />&nbsp;  invoke&nbsp; &nbsp; CreateWindowExA, dword cdVBarTipo, dword NombreClase, dword MsgCabecera, dword cdVBtnTipo,dword cdXPos, dword cdYPos, dword cdXSize, dword cdYSize, dword NULL, dword NULL, dword , dword NULL<br />&nbsp; &nbsp; test&nbsp; &nbsp;  eax, eax<br />&nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp;  L_Error<br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , eax<br /><br />&nbsp; &nbsp; invoke&nbsp;  ShowWindow, dword hWnd, dword SW_SHOWNORMAL<br />&nbsp; &nbsp; invoke&nbsp;  UpdateWindow, dword hWnd<br /><br />&nbsp; &nbsp; .msgloop:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  GetMessageA, dword message, dword NULL, dword NULL, dword NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; eax, dword 0<br />&nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp;  end_loop<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  TranslateMessage, dword message<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  DispatchMessageA, dword message<br />&nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; .msgloop<br /><br />&nbsp; &nbsp; L_Error:<br />&nbsp; &nbsp; &nbsp; invoke&nbsp; &nbsp; MessageBoxA, DWORD NULL, DWORD MsgError, NULL, DWORD MB_ICONERROR+MB_OK<br /><br />&nbsp; &nbsp; end_loop:<br /><br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; eax, dword <br />&nbsp; &nbsp; ret<br />&nbsp; endproc<br /><br />&nbsp; proc&nbsp; &nbsp; WndProc<br />&nbsp; &nbsp; ;&nbsp; Propósito: Procesa los mensajes provenientes de las ventanas<br />&nbsp; &nbsp; ;&nbsp; Entrada&nbsp; : hWnd:HWND, uMsg:UINT, wParam:WPARAM, lParam:LPARAM<br />&nbsp; &nbsp; ;&nbsp; Salida&nbsp;  : Ninguna<br />&nbsp; &nbsp; ;&nbsp; Destruye : Ninguna<br />&nbsp; &nbsp; ; Recogemos los parámetros<br />&nbsp; &nbsp; uhwnd&nbsp;  argd&nbsp; &nbsp; &nbsp; &nbsp; ; Window handle<br />&nbsp; &nbsp; uMsg&nbsp; &nbsp; argd&nbsp; &nbsp; &nbsp; &nbsp; ; Window message<br />&nbsp; &nbsp; wParam&nbsp; argd&nbsp; &nbsp; &nbsp; &nbsp; ; wParam<br />&nbsp; &nbsp; lParam&nbsp; argd&nbsp; &nbsp; &nbsp; &nbsp; ; lParam<br /><br />&nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;  eax, dword argv(uMsg)<br />&nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;  eax, WM_DESTROY<br />&nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp; &nbsp; wm_destroy<br />&nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;  eax, WM_COMMAND<br />&nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp; &nbsp; wm_command<br />&nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;  eax, WM_CREATE<br />&nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp; &nbsp; wm_create<br />&nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp;  wm_default<br /><br />&nbsp; &nbsp; wm_create:<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; eax, dword argv(uhwnd)<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , eax<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  CreateWindowExA,dword cdVBarTipo,ClaseBoton,blnk1,WS_CHILD + WS_VISIBLE + BS_ICON,dword 20,dword 20,dword 36,dword 36,dword argv(uhwnd),400,dword ,NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , eax<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  LoadIconA,dword ,101<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  SendMessageA,,BM_SETIMAGE,1,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; wm_fin<br />&nbsp; &nbsp; wm_command:<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; eax,&nbsp; argv(wParam)<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; eax, 400<br />&nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp;  btn_Informa<br />&nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; wm_fin<br />&nbsp; &nbsp; &nbsp; &nbsp; btn_Informa:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  MessageBoxA,dword argv(uhwnd), icoMsg1, icoMsgCab,MB_OK+MB_ICONASTERISK <br />&nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; wm_fin<br />&nbsp; &nbsp; wm_destroy:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  PostQuitMessage,0<br />&nbsp; &nbsp; wm_default:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  DefWindowProcA, dword argv(uhwnd), dword argv(uMsg), dword argv(wParam), dword argv(lParam)<br />&nbsp; &nbsp; wm_fin:&nbsp; &nbsp; <br />&nbsp; &nbsp; ret<br />&nbsp; endproc<br /><br /><br />&nbsp; CommandLine&nbsp; resd 1<br />&nbsp; hWnd&nbsp; &nbsp; &nbsp; &nbsp;  resd 1<br />&nbsp; hBtn1&nbsp; &nbsp; &nbsp; &nbsp; resd 1<br />&nbsp; wHandle&nbsp; &nbsp; &nbsp; resd 1<br /><br /><br />&nbsp; &nbsp; MsgCabecera:&nbsp; &nbsp; db&nbsp; &nbsp; &quot;Botón con icono (NASM)&quot;, 0x0<br />&nbsp; &nbsp; NombreClase:&nbsp; &nbsp; db&nbsp; &nbsp; &quot;SimpleWinClass&quot;, 0x0<br />&nbsp; &nbsp; MsgError:&nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &quot;Carga inicial fallida.&quot;,0x0<br />&nbsp; &nbsp; icoMsg1&nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &quot;Programado 100% en ensamblador (Nasm)&quot;,0x0<br />&nbsp; &nbsp; icoMsgCab&nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &quot;Información&quot;, 0x0<br />&nbsp; &nbsp; ClaseBoton&nbsp; &nbsp; &nbsp; db&nbsp; &nbsp; &quot;BUTTON&quot;, 0x0<br />&nbsp; &nbsp; blnk1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; 0x0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; wc:<br />&nbsp; &nbsp; istruc WNDCLASSEX<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.cbSize,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; &nbsp; WNDCLASSEX_size<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.style,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; CS_VREDRAW + CS_HREDRAW<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.lpfnWndProc,&nbsp; &nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.cbClsExtra,&nbsp; &nbsp; &nbsp; dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.cbWndExtra,&nbsp; &nbsp; &nbsp; dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.hInstance,&nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.hIcon,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.hCursor,&nbsp; &nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.hbrBackground,&nbsp;  dd&nbsp; &nbsp; cdColFondo<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.lpszMenuName,&nbsp; &nbsp; dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.lpszClassName,&nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at WNDCLASSEX.hIconSm,&nbsp; &nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; iend<br /><br />&nbsp; &nbsp; message:<br />&nbsp; &nbsp; istruc MSG<br />&nbsp; &nbsp; &nbsp; &nbsp; at MSG.hwnd,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at MSG.message,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at MSG.wParam,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at MSG.lParam,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at MSG.time,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; at MSG.pt,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; NULL<br />&nbsp; &nbsp; iend<br /></code></pre><br /><br />VentWN1.rc:<br /><pre><code><br />#define IDR_VERSION1 1<br />#define BUTTON_ICON 101<br /><br />LANGUAGE 10,1<br /><br />IDR_VERSION1 VERSIONINFO<br />FILEVERSION 1,0,0,0<br />PRODUCTVERSION 1,0,0,0<br />FILEOS 0x00000004<br />FILETYPE 0x00000000<br />BEGIN<br />&nbsp; BLOCK &quot;StringFileInfo&quot;<br />&nbsp; BEGIN<br />&nbsp; &nbsp; BLOCK &quot;FFFF0000&quot;<br />&nbsp; &nbsp; BEGIN<br />&nbsp; &nbsp; &nbsp; VALUE &quot;FileVersion&quot;, &quot;1.0.0.0\0&quot;<br />&nbsp; &nbsp; &nbsp; VALUE &quot;ProductVersion&quot;, &quot;1.0.0.0\0&quot;<br />&nbsp; &nbsp; &nbsp; VALUE &quot;CompanyName&quot;, &quot;Abre los ojos al ensamblador\0&quot;<br />&nbsp; &nbsp; &nbsp; VALUE &quot;FileDescription&quot;, &quot;Botón con icono\0&quot;<br />&nbsp; &nbsp; &nbsp; VALUE &quot;InternalName&quot;, &quot;VentWN1\0&quot;<br />&nbsp; &nbsp; &nbsp; VALUE &quot;LegalCopyright&quot;, &quot;no rights reserved\0&quot;<br />&nbsp; &nbsp; &nbsp; VALUE &quot;OriginalFilename&quot;, &quot;VentWN1.exe\0&quot;<br />&nbsp; &nbsp; &nbsp; VALUE &quot;ProductName&quot;, &quot;VentWN1\0&quot;<br />&nbsp; &nbsp; END<br />&nbsp; END<br />&nbsp; BLOCK &quot;VarFileInfo&quot;<br />&nbsp; BEGIN<br />&nbsp; &nbsp; VALUE &quot;Translation&quot;, 0xFFFF, 0x0000<br />&nbsp; END<br />END<br /><br />BUTTON_ICON ICON DISCARDABLE &quot;ambU.ico&quot;<br /><br /></code></pre><br /><br />Compila.bat<br /><pre><code><br />del VentWN?.exe<br />..\..\..\bin\nasm -f win32 VentWN1.ASM -o VentWN1.obj<br />..\..\..\bin\GoRC.exe /r=VentWN1.res VentWN1.rc<br />..\..\..\bin\GoLink.exe /entry _main VentWN1.obj VentWN1.res kernel32.dll user32.dll<br />del *.obj<br />del *.bak<br /></code></pre><br /><br />ambU.ico --&gt; I couldn&#039;t upload it, I&#039;m sorry</div>
    <div class="meta">Posted on 2010-05-07 03:15:42 by avcaballero</div>
   </div>
   <div class="post" id="post-211632">
    <div class="subject"><a href="#post-211632">Re: icons in buttons</a></div>
    <div class="body">this is what i did to create a icon on a button.<br /><br /><pre><code>@invoke CreateWindowEx, NULL, &quot;button&quot;, &quot;Volgend&quot;, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  			 WS_CHILD or WS_VISIBLE or BS_DEFPUSHBUTTON or BS_ICON, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  			 125,315,40,25, .hWnd, IDC_BUTTON_NEXT, hInstance, NULL<br />mov .hWnd_BUTTON_NEXT, eax<br />@invoke LoadImage, hInstance, &quot;ICON_NEXT&quot;, IMAGE_ICON, 0, 0, 0<br />mov Icon_next, eax<br />invoke SendMessage, .hWnd_BUTTON_NEXT, BM_SETIMAGE, IMAGE_ICON, Icon_next</code></pre></div>
    <div class="meta">Posted on 2010-05-09 05:01:39 by jpam</div>
   </div>
   <div class="post" id="post-211649">
    <div class="subject"><a href="#post-211649">Re: icons in buttons</a></div>
    <div class="body">Hello, jpam, thanks por your replay.<br /><br />What compiler did you have used?. It doesn&#039;t appear to be nasmx. I have used the same code in masm and fasm and works fine, not in nasmx. I&#039;m considering using nagoa.inc instead of nasmx ....<br /><br />Regards</div>
    <div class="meta">Posted on 2010-05-10 08:15:28 by avcaballero</div>
   </div>
   <div class="post" id="post-211657">
    <div class="subject"><a href="#post-211657">Re: icons in buttons</a></div>
    <div class="body">i only use masm and ObjAsm32 from biterider</div>
    <div class="meta">Posted on 2010-05-11 09:57:36 by jpam</div>
   </div>
   <div class="post" id="post-211659">
    <div class="subject"><a href="#post-211659">Re: icons in buttons</a></div>
    <div class="body">Same thing in NASMX<br /><pre><code>invoke CreateWindowEx, NULL, &quot;button&quot;, &quot;Volgend&quot;, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  			 WS_CHILD | WS_VISIBLE | BS_DEFPUSHBUTTON | BS_ICON, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  			 125,315,40,25, \<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  			 , IDC_BUTTON_NEXT, , NULL<br />mov , eax&nbsp; &nbsp;  ; Add a hButton DD 0 in the SECTION .data to store our button handle<br />invoke LoadImage, , &quot;ICON_NEXT&quot;, IMAGE_ICON, 0, 0, 0<br />mov , eax ; Same here, store a handle to our icon handle in the .data section<br />invoke SendMessage, , BM_SETIMAGE, IMAGE_ICON, </code></pre><br /><br />I haven&#039;t done windows assembly in a while, but this should work as a decent port. NASMX&#039;s invoke macro handles strings internally so there is no need for @invoke vs invoke and types default to the current word size (qword in in 64-bit mode and dword in 32-bit mode). Other than that you are mostly dealing with NASM&#039;s language constructs.</div>
    <div class="meta">Posted on 2010-05-11 10:34:17 by Synfire</div>
   </div>
   <div class="post" id="post-211676">
    <div class="subject"><a href="#post-211676">Re: icons in buttons</a></div>
    <div class="body">Thanks, Synfire, but It doesn&#039;t work. This is what I did. Commented lines are substituted. But now it even doesn&#039;t create any button. Surely I did something wrong.<br /><br />invoke CreateWindowExA, NULL, ClaseBoton, blnk1, \<br />WS_CHILD | WS_VISIBLE | BS_DEFPUSHBUTTON | BS_ICON, \<br />125,315,40,25, \<br />dword argv(uhwnd), 400, , NULL<br />mov , eax&nbsp; &nbsp;  ; Add a hButton DD 0 in the SECTION .data to store our button handle<br />invoke LoadImageA, , &quot;ICON_NEXT&quot;, 101, 0, 0, 0<br />invoke SendMessageA, , BM_SETIMAGE, IMAGE_ICON,eax;<br /><br />;&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  CreateWindowExA,dword cdVBarTipo,ClaseBoton,blnk1,WS_CHILD + WS_VISIBLE + BS_ICON+ BS_DEFPUSHBUTTON,dword 20,dword 20,dword 36,dword 36,dword argv(uhwnd),400,dword ,NULL<br />;&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; , eax<br />;&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  LoadIconA,dword ,101<br />;&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp;  SendMessageA,,BM_SETIMAGE,1,eax<br /><br />[...]<br /><br /><br />&nbsp; CommandLine&nbsp; resd 1<br />&nbsp; hWnd&nbsp; &nbsp; &nbsp; &nbsp;  resd 1<br />&nbsp; wHandle&nbsp; &nbsp; &nbsp; resd 1<br />&nbsp; hBtn1&nbsp; &nbsp; &nbsp; &nbsp; resd 1<br /></div>
    <div class="meta">Posted on 2010-05-12 04:40:29 by avcaballero</div>
   </div>
   <div class="post" id="post-211678">
    <div class="subject"><a href="#post-211678">Re: icons in buttons</a></div>
    <div class="body">I don&#039;t really see much of a reason this shouldn&#039;t work, I&#039;ve tried cleaning it up and reducing invokes to one line, try it out and see if it works. I don&#039;t have a windows machine to test this out on so I can&#039;t see first hand what works and what doesn&#039;t. :(<br /><br /><pre><code><br />	BIMG_STYLE equ (WS_CHILD + WS_VISIBLE + BS_DEFPUSHBUTTON + BS_ICON)<br /><br />	invoke CreateWindowExA, NULL, ClaseBoton, blnk1, BIMG_STYLE, 125, 315, 40, 25, dword argv(uhwnd), 400, , NULL<br />	mov , eax&nbsp; &nbsp; &nbsp;; Add a hButton DD 0 in the SECTION .data to store our button handle<br />	invoke LoadImageA, , &quot;ICON_NEXT&quot;, 101, 0, 0, 0<br />	invoke SendMessageA, , BM_SETIMAGE, IMAGE_ICON, eax<br /><br />[...]<br /><br /><br />	CommandLine	resd 1<br />	hWnd		resd 1<br />	wHandle		resd 1<br />	hBtn1		resd 1<br /></code></pre><br /></div>
    <div class="meta">Posted on 2010-05-12 12:14:58 by Synfire</div>
   </div>
   <div class="post" id="post-211679">
    <div class="subject"><a href="#post-211679">Re: icons in buttons</a></div>
    <div class="body">NaN once wrote a very fancy Icon Button Custom Control - Check our CC section and see if it&#039;s still there.</div>
    <div class="meta">Posted on 2010-05-12 12:21:40 by JimmyClif</div>
   </div>
   <div class="post" id="post-215050">
    <div class="subject"><a href="#post-215050">Re: icons in buttons</a></div>
    <div class="body">Guys, only joined recently,&nbsp; looking through old posts and came across this unresolved one!<br /><br />After using BS_ICON in your window creation, use:<br /><br />invoke LoadIcon,hInstance,IconName<br />invoke SendMessage,hwndButton1,BM_SETIMAGE,1,eax<br /><br /><br /><br /></div>
    <div class="meta">Posted on 2011-09-21 12:49:22 by MACH4</div>
   </div>
   <div class="post" id="post-215055">
    <div class="subject"><a href="#post-215055">Re: icons in buttons</a></div>
    <div class="body">I also wrote one and posted it here, mine does &#039;button skinning&#039;, so you can make the buttons (and even the app window itself) any shape you like based on bitmap images.</div>
    <div class="meta">Posted on 2011-09-21 18:02:17 by Homer</div>
   </div>
  </div>
 </body>
</html>