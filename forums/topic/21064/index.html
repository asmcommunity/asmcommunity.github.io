<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Help needed on saving message to file - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21064" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21064">Help needed on saving message to file</a></p>
   <div class="post" id="post-159602">
    <div class="subject"><a href="#post-159602">Help needed on saving message to file</a></div>
    <div class="body">Hi, help needed urgently :)<br /><br />What I want to try and do is make some sort of chat logger in masm32 which saves messages for instance from while online gaming, it would save all the text I recieve from other players to a folder where a bunch of .txt file&#39;s will be saved. Or maybe from the main MIRC client, i can save the chat conversation to a folder too. I also wanted to try and add a date and time to the log followed by the message which I recieved in-game. Im sure i know how to do everything else here it&#39;s just getting the date/time and saving the message to a .txt file in some folder called LOGS or something like that. I will use wsprintf() to set up the string with date/time message and anything else which I may want to add later. <br /><br />Can someone give me a detailed idea how to do this please making use of win32 api calls.<br /><br /><br /></div>
    <div class="meta">Posted on 2005-05-05 20:48:43 by Randomizer</div>
   </div>
   <div class="post" id="post-159605">
    <div class="subject"><a href="#post-159605">Re: Help needed on saving message to file</a></div>
    <div class="body">Well, for mIRC you just go to File/Options/IRC/Logging and enable it. And it even saves every line with accurate time &amp; date. ;)<br /><br /><div class="quote"><br />Im sure i know how to do everything else here it&#39;s just getting the date/time and saving the message to a .txt file in some folder called LOGS or something like that. I will use wsprintf() to set up the string with date/time message and anything else which I may want to add later.<br /></div><br /><br />GetSystemTime, CreateDirectory,CreateFile, WriteFile, CloseHandle<br /><br />I guess the hardest part will be figuring out how to log the data.. Guess a couple more tuts wouldn&#39;t hurt.<br /><br />Wonder how urgently you need it...</div>
    <div class="meta">Posted on 2005-05-05 21:07:50 by JimmyClif</div>
   </div>
   <div class="post" id="post-159613">
    <div class="subject"><a href="#post-159613">Re: Help needed on saving message to file</a></div>
    <div class="body"><div class="quote"><br />Well, for mIRC you just go to File/Options/IRC/Logging and enable it. And it even saves every line with accurate time &amp; date. ;)<br /><br /><div class="quote"><br />Im sure i know how to do everything else here it&#39;s just getting the date/time and saving the message to a .txt file in some folder called LOGS or something like that. I will use wsprintf() to set up the string with date/time message and anything else which I may want to add later.<br /></div><br /><br />GetSystemTime, CreateDirectory,CreateFile, WriteFile, CloseHandle<br /><br />I guess the hardest part will be figuring out how to log the data.. Guess a couple more tuts wouldn&#39;t hurt.<br /><br />Wonder how urgently you need it...<br /></div><br /><br />Thanks for the reply. But the MIRC thing was only an example. For instance if i need to write my own bot that can save logs to a folder, i need to know how.<br /><br />So using GetSystemTime, CreateDirector, CreateFile etc will do all that?</div>
    <div class="meta">Posted on 2005-05-05 22:23:25 by Randomizer</div>
   </div>
   <div class="post" id="post-159805">
    <div class="subject"><a href="#post-159805">Re: Help needed on saving message to file</a></div>
    <div class="body">You have to be specific about your request and yet obscure about your intent if you want help around here with things like this.<br />You should have asked &quot;how can I read the text from an arbitrary subwindow of another process&quot;.<br />Basically you will need to get the window handle of the target application&#39;s main window, and also the window handle of the control (child window) on that application containing the text you want.<br />Now you can use standard methods to retrieve the text content.<br /><br /></div>
    <div class="meta">Posted on 2005-05-07 12:01:48 by Homer</div>
   </div>
  </div>
 </body>
</html>