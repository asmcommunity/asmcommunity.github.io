<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How to create toolbar with 16bit color bitmap - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5519" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5519">How to create toolbar with 16bit color bitmap</a></p>
   <div class="post" id="post-39206">
    <div class="subject"><a href="#post-39206">How to create toolbar with 16bit color bitmap</a></div>
    <div class="body">I want to create toolbar with 16bit color bitmap bar, I use toolbar MACRO in MASM32 toolkit, but I can't  get the result I want, and I don't know how the backgrond color of bmp bar affect the outlook of toolbar?</div>
    <div class="meta">Posted on 2002-05-21 10:57:02 by dREAMtHEATER</div>
   </div>
   <div class="post" id="post-39211">
    <div class="subject"><a href="#post-39211">How to create toolbar with 16bit color bitmap</a></div>
    <div class="body">the real style of toolbar, the above toolbar bmp was exacted from  shell32.dll resource of winxp, test only!</div>
    <div class="meta">Posted on 2002-05-21 11:08:32 by dREAMtHEATER</div>
   </div>
   <div class="post" id="post-39225">
    <div class="subject"><a href="#post-39225">How to create toolbar with 16bit color bitmap</a></div>
    <div class="body">This thead might contain some useful info:<br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=183">http://www.asmcommunity.net/board/index.php?topic=183</a><br /><br />Thomas</div>
    <div class="meta">Posted on 2002-05-21 12:18:17 by Thomas</div>
   </div>
   <div class="post" id="post-39228">
    <div class="subject"><a href="#post-39228">How to create toolbar with 16bit color bitmap</a></div>
    <div class="body">Here's some code as well, straight from my PNGview program (see my website), in plain C.<br /><br /><pre><code><br /><br />tempBmp = LoadInternalPNG&#40;hWnd, IDR_TOOLBAR&#41;;<br />hToolImageList = <br />    ImageList_Create&#40;24,24,ILC_COLOR32|ILC_MASK,TOOLBAR_IMAGES,0&#41;;<br /><br />ImageList_AddMasked&#40;hToolImageList, tempBmp, RGB&#40;255,0,255&#41;&#41;;<br /><br />DeleteObject&#40;tempBmp&#41;;<br /><br />hToolbar = CreateWindowEx&#40;NULL,<br />               TOOLBARCLASSNAME, NULL, <br />               TBSTYLE_FLAT|WS_CHILD|WS_VISIBLE|<br />               WS_CLIPSIBLINGS|WS_CLIPCHILDREN,<br />               0,0,100,14,hWnd,&#40;HMENU&#41;ID_TOOLBAR,hInstance,0&#41;;<br /><br />SendMessage&#40;hToolbar,TB_BUTTONSTRUCTSIZE,sizeof&#40;TBBUTTON&#41;,0&#41;;<br />SendMessage&#40;hToolbar,TB_SETBITMAPSIZE,0,MAKELONG&#40;24,24&#41;&#41;;<br />SendMessage&#40;hToolbar,TB_SETIMAGELIST,0,&#40;LPARAM&#41;hToolImageList&#41;;<br />SendMessage&#40;hToolbar,TB_ADDBUTTONS,TOOLBAR_BUTTONS,&#40;LPARAM&#41;tbarButtons&#41;;<br />SendMessage&#40;hToolbar,TB_AUTOSIZE,0,0&#41;;<br /></code></pre></div>
    <div class="meta">Posted on 2002-05-21 12:30:07 by Thomas</div>
   </div>
  </div>
 </body>
</html>