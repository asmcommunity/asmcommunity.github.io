<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Getting a .lib of an existing .dll - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16950" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16950">Getting a .lib of an existing .dll</a></p>
   <div class="post" id="post-131486">
    <div class="subject"><a href="#post-131486">Getting a .lib of an existing .dll</a></div>
    <div class="body">I currently have a .dll, one of whose functions I need.  While I could LoadLibrary the thing, I somehow prefer having it linked directly (since I have to show my code..... hehehe I'm using ASM where most of my batchmates are using VB or C....).  However I believe MASM cannot link directly to a dll, it needs a .lib file to link to the .dll.  I guess I could rewrite the dll so that I can make the lib (all I really need is to access an I/O port in WinME or lower.... so I just need to write mov edx,dword ptr  mov eax,dword ptr out dx,al in a dll routine.... or do I need to do something else in addition to that?).<br /><br />I think I once read somewhere right on these boards about someone complaining about masm being unable to link .dll without their associated .lib, then someone showed how to get a .lib from an existing .dll..... but I can't remember it! &gt;.&lt;<br /><br />And yeah it's been a long time since I've actually posted here, or even (gasp!) programmed wafuuuuuuuuuuuuu!!!</div>
    <div class="meta">Posted on 2004-01-24 09:17:17 by AmkG</div>
   </div>
   <div class="post" id="post-131493">
    <div class="subject"><a href="#post-131493">Getting a .lib of an existing .dll</a></div>
    <div class="body">AmkG,<br /><br />i dont know if i got the question right, but seens to me you can use IMPLIB.EXE tool.<br /><br />ancev</div>
    <div class="meta">Posted on 2004-01-24 09:43:57 by ancev</div>
   </div>
   <div class="post" id="post-131496">
    <div class="subject"><a href="#post-131496">Getting a .lib of an existing .dll</a></div>
    <div class="body">Yeah, I *think* that's what I was looking for.............<br /><br />I forgot that the .lib of a .dll is called an IMPORT LIBRARY AAARG........... thx.<br /><br />Obviously I haven't been programming in a LOONG WHILE.  Thanks again.</div>
    <div class="meta">Posted on 2004-01-24 09:48:32 by AmkG</div>
   </div>
   <div class="post" id="post-131520">
    <div class="subject"><a href="#post-131520">Getting a .lib of an existing .dll</a></div>
    <div class="body">Hi AmkG,<br /><br />If you want an import library with decorated names,here is the solution:<br />-Create an include file full with the function prototypes coming from your DLL.<br /><pre><code><br />myfunc1 PROTO &#58;DWORD,&#58;DWORD,&#58;DWORD<br />func2   PROTO &#58;DWORD,&#58;DWORD<br />etc...<br /></code></pre><br /><br />-After,run Hutch's include to library tool (inc2l) to get an import library for your DLL<br />inc2l comes with the Masm32 package.<br /><br />Second,if you would like to use import libraries with non-decorated names, you can try my <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=13805">dll2lib</a></div>
    <div class="meta">Posted on 2004-01-24 14:12:12 by Vortex</div>
   </div>
   <div class="post" id="post-131555">
    <div class="subject"><a href="#post-131555">Getting a .lib of an existing .dll</a></div>
    <div class="body">Thanks vortex!  Anyway it seems I have a really OLD copy of MASM32...... I don't have inc2l in the bin directory (I think the MASM32 I have is v7 or v6...)</div>
    <div class="meta">Posted on 2004-01-24 19:18:13 by AmkG</div>
   </div>
   <div class="post" id="post-131558">
    <div class="subject"><a href="#post-131558">Getting a .lib of an existing .dll</a></div>
    <div class="body">l2inc says the library has no imports........ just how is dll2lib used?</div>
    <div class="meta">Posted on 2004-01-24 19:54:09 by AmkG</div>
   </div>
   <div class="post" id="post-131599">
    <div class="subject"><a href="#post-131599">Getting a .lib of an existing .dll</a></div>
    <div class="body">AmkG,<br /><br />There is a MASM32 tool where you write the include file yourself and run it and it will produce a library from that include file. It works fine when you have a DLL from another language or don't have the normal library built with a DLL using MASM.<br /><br />Regards,<br />http://www.asmcommunity.net/board/cryptmail.php?tauntspiders=in.your.face@nomail.for.you&amp;id=2f46ed9f24413347f14439b64bdc03fd</div>
    <div class="meta">Posted on 2004-01-25 06:21:36 by hutch--</div>
   </div>
   <div class="post" id="post-131608">
    <div class="subject"><a href="#post-131608">Getting a .lib of an existing .dll</a></div>
    <div class="body">Yep!  My old MASM32 package doesn't have it, but I found it pretty quick.  It APPEARS to work, but since I'm doing hardware interfacing without the hardware (hehehe) I can't check if I'm doing it right.  But I AM pretty sure it works.<br /><br />Many thanks!</div>
    <div class="meta">Posted on 2004-01-25 06:57:56 by AmkG</div>
   </div>
   <div class="post" id="post-131609">
    <div class="subject"><a href="#post-131609">Re: Getting a .lib of an existing .dll</a></div>
    <div class="body"><div class="quote"><br />I guess I could rewrite the dll so that I can make the lib (all I really need is to access an I/O port in WinME or lower.... so I just need to write mov edx,dword ptr  mov eax,dword ptr out dx,al in a dll routine.... or do I need to do something else in addition to that?).<br /></div><br /><br />Corect me if I'm wrong but I don't think it is possible to access I/O ports from win9x.</div>
    <div class="meta">Posted on 2004-01-25 07:05:45 by ENF</div>
   </div>
   <div class="post" id="post-131610">
    <div class="subject"><a href="#post-131610">Getting a .lib of an existing .dll</a></div>
    <div class="body">From a DLL it is ;)  I think :rolleyes:</div>
    <div class="meta">Posted on 2004-01-25 07:07:28 by AmkG</div>
   </div>
   <div class="post" id="post-131619">
    <div class="subject"><a href="#post-131619">Getting a .lib of an existing .dll</a></div>
    <div class="body"><div class="quote"><br />l2inc says the library has no imports........ just how is dll2lib used? </div><br /><br />You just specify the name of the DLL:<br /><pre><code><br />dll2lib kernel32.dll<br /></code></pre></div>
    <div class="meta">Posted on 2004-01-25 09:00:00 by Vortex</div>
   </div>
  </div>
 </body>
</html>