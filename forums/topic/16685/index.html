<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Mixing FPU and MMX - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16685" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16685">Mixing FPU and MMX</a></p>
   <div class="post" id="post-129660">
    <div class="subject"><a href="#post-129660">Mixing FPU and MMX</a></div>
    <div class="body">In my program I have two MMX registers that are constantly used. I'd like to use the FPU without saving the MMX registers and calling emms. The FPU operation is simple and only needs two free registers. This method works if the two MMX registers are MM0 and MM1 :<br /><br /><pre><code><br />; MMX code<br />; ...<br />; FPU needed<br />finit<br />pxor MM2, MM2 ; set all the tags word to valid<br />ffree st&#40;7&#41;<br />ffree st&#40;6&#41;<br />; fpu code<br />fldpi<br />fldpi<br />fstp<br />fstp<br />; MMX code continues<br /></code></pre><br /><br />Has anybody used this method ? Is it reliable ? Thanks in advance for the answers.</div>
    <div class="meta">Posted on 2004-01-03 11:33:24 by Dr. Manhattan</div>
   </div>
  </div>
 </body>
</html>