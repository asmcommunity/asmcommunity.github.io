<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>TAB CONTROLS - something strange... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18862" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18862">TAB CONTROLS - something strange...</a></p>
   <div class="post" id="post-146012">
    <div class="subject"><a href="#post-146012">TAB CONTROLS - something strange...</a></div>
    <div class="body">i want to code my first tab controls. but i am very frustrated cause the child windows isnt shown correctly in the SysTabControl32.<br /><br />it looks like its shown in the frame dialog. see picture in attachment<br /><br />here is some code i used:<br /><br /><pre><code><br />DialogFrame proc hwnd&#58;HWND,message&#58;UINT,wParam&#58;WPARAM,lParam&#58;LPARAM<br />	pushad<br />	<br />	mov eax,message<br />	.if eax==WM_INITDIALOG<br />		<br />		push hwnd		;save handle of this dialog<br />		pop handle<br />		<br />		;-----------------------------------------------------------------------------------<br />      		;-- Insert the tabs in the tab control.<br />      		invoke GetDlgItem, handle, 2050		<br />     		mov    hTabControl, eax<br />		<br />		MOV TCI.iImage,0				; index to tab control's image <br /> 		MOV TCI.lParam,0				; Extra info<br />		<br />      		mov    TCI.imask, TCIF_TEXT<br />      		mov    TCI.pszText,CTXT &#40;&quot;Tab 1&quot;&#41;<br />      		MOV    TCI.cchTextMax,14<br />     		invoke SendMessage, hTabControl, TCM_INSERTITEM, 0, OFFSET TCI	;Search and Replace TAB<br />		<br />		;-----------------------------------------------------------------------------------<br />      		;-- Create the dialogs for both tabs.<br />      <br />      		invoke CreateDialogParam, hInstance, 55, hTabControl, addr ChildDlgProc, NULL	<br />		<br />		;-----------------------------------------------------------------------------------<br />      		;-- Show the dialog with the tabular representation.<br />      		mov    hCurrentDialog, eax<br />      		invoke ShowWindow, eax, SW_SHOW<br />		<br />      		;-----------------------------------------------------------------------------------<br />      		;-- Let Windows assign the default keyboard focus.<br />      		popad<br />      		mov    eax, TRUE<br />      		ret<br />	<br />	.ELSEIF eax == WM_NOTIFY<br />		mov    eax, lParam<br />		mov    ecx, &#40;NMHDR ptr &#91;eax&#93;&#41;.code<br />		.IF ecx == TCN_SELCHANGE<br />			; Hide the currently shown dialog.<br />         		invoke ShowWindow, hCurrentDialog, SW_HIDE<br /><br />          		;-------------------------------------------------------------------------------<br />          		;-- Show the other dialog.<br />          		mov    eax, hCurrentDialog<br /><br />          		.IF eax == hDialogTab2<br />              			mov    eax, hDialogTab1<br />          		.ELSE<br />              			mov    eax, hDialogTab2	<br />          		.ENDIF<br /><br />          		;-------------------------------------------------------------------------------<br />          		;-- Show the dialog.<br />          		mov    hCurrentDialog, eax<br />          		invoke ShowWindow, eax, SW_SHOW<br />      		.ENDIF<br />      		<br />  	.ELSEIF eax == WM_NCACTIVATE<br />      		cmp    wParam, FALSE<br />      		je     @Return<br /><br />      		invoke UpdateWindow, handle<br /><br />  	.ELSEIF eax == WM_CLOSE<br />  		@Exit&#58;<br />      		invoke EndDialog, handle, 0<br />  	.ENDIF<br /><br />	@Return&#58;<br /><br />	popad<br />	xor eax,eax<br />	ret<br />DialogFrame endp<br /><br /><br />ChildDlgProc  PROC SmallhWnd&#58;HWND, uMsg&#58;UINT, wParam&#58;WPARAM, lParam&#58;LPARAM<br />	XOR EAX,EAX<br />	RET<br />ChildDlgProc	ENDP<br /><br /><br />;/// RESOURCE INFO OF THE CHILD DIALOG///<br />55 DIALOG 0, 0, 200, 160<br />STYLE WS_CHILD<br />EXSTYLE WS_EX_CONTROLPARENT<br />CAPTION &quot;&quot;<br />LANGUAGE LANG_NEUTRAL, SUBLANG_NEUTRAL<br />FONT 8, &quot;MS SANS SERIF&quot;<br />&#123;<br />   CONTROL &quot;OK&quot;, 400, BUTTON, BS_PUSHBUTTON | WS_CHILD | WS_VISIBLE | WS_TABSTOP, 138, 143, 60, 14 , 0x00020000<br />   CONTROL &quot;Cancel&quot;, 401, BUTTON, BS_PUSHBUTTON | WS_CHILD | WS_VISIBLE | WS_TABSTOP, 76, 142, 60, 14 , 0x00020000<br />&#125;<br /><br /><br />;/// RESOURCE INFO OF THE FRAME DIALOG///<br />4 DIALOG 40, 70, 329, 268<br />STYLE DS_MODALFRAME | WS_POPUP | WS_CAPTION | WS_SYSMENU<br />CAPTION &quot;i want tabs&quot;<br />LANGUAGE LANG_SPANISH, 0xB<br />FONT 8, &quot;MS Sans Serif&quot;<br />&#123;<br />   CONTROL &quot;Tab1&quot;, 2050, &quot;SysTabControl32&quot;, TCS_TABS | WS_CHILD | WS_VISIBLE, 0, 0, 328, 266 <br />&#125;<br /></code></pre><br /><br /><strong>or maybe anybody has a short masm example for tab controls (not the one from latigo)?</strong></div>
    <div class="meta">Posted on 2004-07-13 12:52:18 by diablo2oo2</div>
   </div>
   <div class="post" id="post-146014">
    <div class="subject"><a href="#post-146014">TAB CONTROLS - something strange...</a></div>
    <div class="body">Hi....<br /><br /><br />If you want a good example go to this link...<br /><br /><a target="_blank" href="http://pageperso.aol.fr/GerardChap/Start.html">http://pageperso.aol.fr/GerardChap/Start.html</a> <br /><br />and downlaod the following example...<br /><br /><a target="_blank" href="http://pageperso.aol.fr/gerardchap/TaskVersion1.zip">http://pageperso.aol.fr/gerardchap/TaskVersion1.zip</a> <br /><br />Good enjoy...<br /><br />Gerard...<br />----</div>
    <div class="meta">Posted on 2004-07-13 13:09:46 by gerard</div>
   </div>
   <div class="post" id="post-146026">
    <div class="subject"><a href="#post-146026">TAB CONTROLS - something strange...</a></div>
    <div class="body"><a target="_blank" href="http://radasm.visualassembler.com/projects/Demo.zip">http://radasm.visualassembler.com/projects/Demo.zip</a></div>
    <div class="meta">Posted on 2004-07-13 16:51:08 by cakmak</div>
   </div>
   <div class="post" id="post-146258">
    <div class="subject"><a href="#post-146258">TAB CONTROLS - something strange...</a></div>
    <div class="body">ok i got the error. it was in the resource:<br />the x,y position of the child dialog was 0,0.<br /><br />he is it right:<br />;/// RESOURCE INFO OF THE CHILD DIALOG///<br />55 DIALOG 20,20 , 200, 160<br />STYLE WS_CHILD<br />EXSTYLE WS_EX_CONTROLPARENT<br />CAPTION &quot;&quot;<br />LANGUAGE LANG_NEUTRAL, SUBLANG_NEUTRAL<br />FONT 8, &quot;MS SANS SERIF&quot;<br />{<br />   CONTROL &quot;OK&quot;, 400, BUTTON, BS_PUSHBUTTON | WS_CHILD | WS_VISIBLE | WS_TABSTOP, 138, 143, 60, 14 , 0x00020000<br />   CONTROL &quot;Cancel&quot;, 401, BUTTON, BS_PUSHBUTTON | WS_CHILD | WS_VISIBLE | WS_TABSTOP, 76, 142, 60, 14 , 0x00020000<br />}</div>
    <div class="meta">Posted on 2004-07-17 11:51:35 by diablo2oo2</div>
   </div>
   <div class="post" id="post-146262">
    <div class="subject"><a href="#post-146262">TAB CONTROLS - something strange...</a></div>
    <div class="body">Hi...<br /><br />Yes...you have made an error in ressource file...you have forgotten the size of the &quot;tab&quot;...<br /><br />For that it exists message   TCM_GETITEMRECT  and by using SendMessage one can retrieve the exact size then change the dimension of &quot;DialogBox&quot;...after its creation...<br /><br /><a target="_blank" href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/tab/messages/tcm_getitemrect.asp">SendMessage</a> <br /><br />I am happy that you found your error...<br /><br />For a full utilization of all possibilities of <strong>TabControl</strong> go to  <a target="_blank" href="http://msdn.microsoft.com/library/en-us/shellcc/platform/commctls/tab/reflist.asp">TabControl</a> ....<br /><br />Good enjoy...<br /><br />Gerard...<br />-----</div>
    <div class="meta">Posted on 2004-07-17 12:07:28 by gerard</div>
   </div>
  </div>
 </body>
</html>