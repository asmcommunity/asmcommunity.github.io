<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>GetModule Handle on a suspended process.. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20323" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20323">GetModule Handle on a suspended process..</a></p>
   <div class="post" id="post-155485">
    <div class="subject"><a href="#post-155485">GetModule Handle on a suspended process..</a></div>
    <div class="body">I created a injector program for one of my porjects and right now I have 00400000h which not all exes have the same base as that.. i know i could open the exe and read it but i was hoping to load it in suspended mode and then get its module handle which is also base address..<br /><br />i tryed toolhelp and psapi both dont seem to work on suspended processes<br /><br />either that or i dont know how to make them work on them..<br /><br />i know i coudl go GetModuleHandle but that would not support multiple instances of the same program..</div>
    <div class="meta">Posted on 2005-01-10 07:26:40 by devilsclaw</div>
   </div>
   <div class="post" id="post-155672">
    <div class="subject"><a href="#post-155672">GetModule Handle on a suspended process..</a></div>
    <div class="body">hmmm well i figured out what i wanted but its not exactly the way i wanted to do it..<br /><br /><br />yes i know this is C/C++ but is about the same syntax if you use MASM which im also used to<br /><br /><pre><code><br />		DEBUG_EVENT pDebugEvent;<br />		DebugActiveProcess&#40;ProcessInfo.dwProcessId&#41;;<br />		WaitForDebugEvent&#40;&amp;pDebugEvent,INFINITE&#41;; <br /><br />		BaseMemory = &#40;DWORD&#41;pDebugEvent.u.CreateProcessInfo.lpBaseOfImage;<br /><br />		DebugSetProcessKillOnExit&#40;FALSE&#41;;<br />		DebugActiveProcessStop&#40;pDebugEvent.dwProcessId&#41;;<br /></code></pre><br /><br />was wondering if there is any other way to get base with the process in suspended state and with out opening the exe its self..</div>
    <div class="meta">Posted on 2005-01-12 20:28:32 by devilsclaw</div>
   </div>
   <div class="post" id="post-155682">
    <div class="subject"><a href="#post-155682">GetModule Handle on a suspended process..</a></div>
    <div class="body">couldnt you use NtQueryInformationProcess?<br /><br /><br />packetvb</div>
    <div class="meta">Posted on 2005-01-12 21:27:31 by packetvb</div>
   </div>
   <div class="post" id="post-155699">
    <div class="subject"><a href="#post-155699">GetModule Handle on a suspended process..</a></div>
    <div class="body">it looks like i could but its not win9x compatible and i like to keep backwards compatibility up..</div>
    <div class="meta">Posted on 2005-01-13 00:17:28 by devilsclaw</div>
   </div>
   <div class="post" id="post-155700">
    <div class="subject"><a href="#post-155700">GetModule Handle on a suspended process..</a></div>
    <div class="body"><div class="quote">it looks like i could but its not win9x compatible and i like to keep backwards compatibility up..</div><br /><br />win9x whats that?<br /><br />hehe<br /></div></div>
    <div class="meta">Posted on 2005-01-13 00:26:31 by packetvb</div>
   </div>
  </div>
 </body>
</html>