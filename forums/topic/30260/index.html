<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>You hear that?  Microsoft Speech API 5.3 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30260" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=30260">You hear that?  Microsoft Speech API 5.3</a></p>
   <div class="post" id="post-213261">
    <div class="subject"><a href="#post-213261">You hear that?  Microsoft Speech API 5.3</a></div>
    <div class="body">You hear that? I&#039;m just guessing that ISpVoice structure.&nbsp; &nbsp; Refer to&nbsp; http://msdn.microsoft.com/en-us/library/ms719576(VS.85).aspx <br /><br />Save as&nbsp; function_SpVoice.inc<br />;------------------------------------------------------------------------------------<br />.const<br /><br />CLSID_SpVoice GUID &lt;096749377h, 03391h, 011D2h, &lt;09Eh, 0E3h, 000h, 0C0h, 04Fh, 079h, 073h, 096h&gt;&gt;<br />IID_ISpVoice&nbsp; GUID &lt;06C44DF74h, 072B9h, 04992h, &lt;0A1h, 0ECh, 0EFh, 099h, 06Eh, 004h, 022h, 0D4h&gt;&gt;<br /><br /><br />ISpNotifySource&nbsp; STRUCT<br />SetNotifySink		&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />SetNotifyWindowMessage		DWORD&nbsp;  ?<br />SetNotifyCallbackFunction	DWORD&nbsp;  ?<br />SetNotifyCallbackInterface	DWORD&nbsp;  ?<br />SetNotifyWin32Event		DWORD&nbsp;  ?<br />WaitForNotifyEvent		DWORD&nbsp;  ?<br />GetNotifyEventHandle 		DWORD&nbsp;  ?<br /><br /><br />ISpNotifySource&nbsp; ENDS<br /><br />ISpEventSource&nbsp; STRUCT<br />SpNotifySource		ISpNotifySource&nbsp;  &lt;&gt;<br />SetInterest		DWORD&nbsp;  ?<br />GetEvents		DWORD&nbsp;  ?<br />GetInfo 		DWORD&nbsp;  ?<br />ISpEventSource&nbsp; ENDS<br /><br /><br />ISpVoiceVtbl&nbsp; &nbsp; &nbsp; &nbsp; STRUCT<br />; IUnknown methods<br />QueryInterface	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />AddRef		&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />Release		&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />; IDispatch methods<br />;GetTypeInfoCount	DWORD&nbsp;  ?<br />;GetTypeInfo		DWORD&nbsp;  ?<br />;GetIDsOfNames		DWORD&nbsp;  ?<br />;_Invoke			DWORD&nbsp;  ?<br />; SpVoice methods<br />SpEventSource	&nbsp; &nbsp; &nbsp; &nbsp; ISpEventSource&nbsp;  &lt;&gt;&nbsp; <br />SetOutput	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />GetOutputObjectToken	DWORD&nbsp;  ?<br />GetOutputStream	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />_Pause	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />Resume	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />SetVoice	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />GetVoice	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />Speak	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />SpeakStream	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />GetStatus	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />Skip	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />SetPriority	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />GetPriority	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />SetAlertBoundary	DWORD&nbsp;  ?<br />GetAlertBoundary	DWORD&nbsp;  ?<br />SetRate	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />GetRate	&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />SetVolume	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />GetVolume	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />WaitUntilDone	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />SetSyncSpeakTimeout	DWORD&nbsp;  ?<br />GetSyncSpeakTimeout	DWORD&nbsp;  ?<br />SpeakCompleteEvent	DWORD&nbsp;  ?<br />IsUISupported	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />DisplayUI 	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />ISpVoiceVtbl ENDS<br /><br /><br />ISpVoice 	STRUCT<br />&nbsp;  lpVtbl 	&nbsp; &nbsp; &nbsp; &nbsp; DWORD&nbsp;  ?<br />ISpVoice	ENDS<br />;---------------------------------------------------------------------------<br /><br /> </div>
    <div class="meta">Posted on 2010-10-03 03:36:05 by G-Spider</div>
   </div>
   <div class="post" id="post-213262">
    <div class="subject"><a href="#post-213262">Re: You hear that?  Microsoft Speech API 5.3</a></div>
    <div class="body">;********************************************<br />;SpVoice Simple example&nbsp; By G-Spider 2010<br />;ml&nbsp; /c /coff Speeker.asm&nbsp; <br />;link /subsystem:console Speeker.obj <br />;*******************************************<br />.586<br />.model flat,stdcall<br />option casemap:none<br />&nbsp; include windows.inc<br />&nbsp; include kernel32.inc<br />&nbsp; include user32.inc<br />&nbsp; include ole32.inc<br /><br />&nbsp; includelib kernel32.lib<br />&nbsp; includelib user32.lib<br />&nbsp; includelib ole32.lib<br />&nbsp; <br />.data<br />TEXT&nbsp; &nbsp; dw &#039;G&#039;,&#039;o&#039;,&#039;l&#039;,&#039;d&#039;,&#039;e&#039;,&#039;n&#039;,&#039; &#039;,&#039;S&#039;,&#039;p&#039;,&#039;i&#039; ,&#039;d&#039;,&#039;e&#039;,&#039;r&#039;,0<br />.data?<br />lpSpVoiceCOM&nbsp; &nbsp; dd ?<br />include function_SpVoice.inc&nbsp; &nbsp; ;&lt;=====The above file<br />.code<br />; ---------------------------------------------------------------------------<br />start:<br />&nbsp;  invoke CoInitialize,0<br />&nbsp;  invoke CoCreateInstance,offset CLSID_SpVoice, 0,CLSCTX_INPROC_SERVER, offset IID_ISpVoice,offset lpSpVoiceCOM<br />&nbsp;  .if eax == 0&nbsp; &nbsp; <br /><br />&nbsp; &nbsp; &nbsp;  push 100&nbsp;  ;USHORT Volume0~100<br />&nbsp; &nbsp; &nbsp;  mov eax,lpSpVoiceCOM<br />&nbsp; &nbsp; &nbsp;  push eax&nbsp;  ;&lt;===Note!<br />&nbsp; &nbsp; &nbsp;  mov eax,<br />&nbsp; &nbsp; &nbsp;  call .ISpVoiceVtbl.SetVolume<br />&nbsp; &nbsp; &nbsp;  ;-----------------------------------------------------<br />&nbsp; &nbsp; &nbsp;  ;lpSpVoiceCOM-&gt;Speak(L&quot;Golden Spider&quot;, 0, 0)//; c++<br />&nbsp; &nbsp; &nbsp;  ;lpSpVoiceCOM-&gt;lpVtbl-&gt;Speak(lpSpVoiceCOM,L&quot;I LOVE YOU!&quot;, 0, 0)//; pure c<br />&nbsp; &nbsp; &nbsp;  push 0<br />&nbsp; &nbsp; &nbsp;  push 0<br />&nbsp; &nbsp; &nbsp;  push offset TEXT<br />&nbsp; &nbsp; &nbsp;  mov eax,lpSpVoiceCOM<br />&nbsp; &nbsp; &nbsp;  push eax&nbsp;  <br />&nbsp; &nbsp; &nbsp;  mov eax,.ISpVoice.lpVtbl&nbsp; ;equ&nbsp; mov eax,&nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp;  call .ISpVoiceVtbl.Speak&nbsp; ;call DWORD PTR <br />&nbsp; &nbsp; &nbsp;  ;-------------------------------------------------------<br /><br />&nbsp; &nbsp; &nbsp;  mov eax,lpSpVoiceCOM<br />&nbsp; &nbsp; &nbsp;  push eax<br />&nbsp; &nbsp; &nbsp;  mov eax,<br />&nbsp; &nbsp; &nbsp;  call .ISpVoiceVtbl.SpEventSource.SpNotifySource.SetNotifyWin32Event<br />&nbsp; &nbsp; &nbsp;  ;.if eax==0&nbsp;  ;//Test<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;invoke MessageBox,0,0,0,0&nbsp; ;///Success!!!Good Job!!<br />&nbsp; &nbsp; &nbsp;  ;.endif<br />&nbsp; &nbsp; &nbsp;  ;-------------------------------------------------------<br />&nbsp; &nbsp; &nbsp;  ;// release ISpVoice COM interfaces <br />&nbsp; &nbsp; &nbsp;  ;lpSpVoiceCOM-&gt;lpVtbl-&gt;Release(lpSpVoiceCOM)<br />&nbsp; &nbsp; &nbsp;  mov eax,lpSpVoiceCOM<br />&nbsp; &nbsp; &nbsp;  push eax<br />&nbsp; &nbsp; &nbsp;  mov eax,<br />&nbsp; &nbsp; &nbsp;  call .ISpVoiceVtbl.Release<br />&nbsp; &nbsp; &nbsp;  ;--------------------------------------------------------<br />&nbsp; &nbsp; &nbsp;  mov&nbsp; lpSpVoiceCOM,0<br />&nbsp;  .endif<br />&nbsp;  ;///&nbsp; &nbsp; CoUninitialize(); <br />	 invoke	CoUninitialize<br />&nbsp;  ret<br />end start</div>
    <div class="meta">Posted on 2010-10-03 03:45:02 by G-Spider</div>
   </div>
   <div class="post" id="post-213265">
    <div class="subject"><a href="#post-213265">Re: You hear that?  Microsoft Speech API 5.3</a></div>
    <div class="body">Nice job.<br /><br />Thanks for the code.<br /><br />The voice is the same as used by some software that old Sound Blasters came with.<br /><br />Andy<br /><br /></div>
    <div class="meta">Posted on 2010-10-03 07:12:15 by skywalker</div>
   </div>
  </div>
 </body>
</html>