<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>UCASE MACRO Anyone? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18288" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=18288">UCASE MACRO Anyone?</a></p>
   <div class="post" id="post-141521">
    <div class="subject"><a href="#post-141521">UCASE MACRO Anyone?</a></div>
    <div class="body">Does anyone have a MACRO to convert and return a string in Uppercase or Lowercase? I've searched!</div>
    <div class="meta">Posted on 2004-05-20 02:46:34 by SubEvil</div>
   </div>
   <div class="post" id="post-141532">
    <div class="subject"><a href="#post-141532">UCASE MACRO Anyone?</a></div>
    <div class="body">Since I don't think there is an example, and I can't wait ... here's my inital (currently working) attempt:<br /><br /><pre><code><br /><br />UCASE MACRO String &#58;REQ<br />  LOCAL NewString<br />  NewString EQU &lt;&gt;<br />  FORC Char, &lt;String&gt;<br />    IFIDNI &lt;Char&gt;, &lt;a&gt;<br />      NewString CATSTR NewString, &lt;A&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;b&gt;<br />      NewString CATSTR NewString, &lt;B&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;c&gt;<br />      NewString CATSTR NewString, &lt;C&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;d&gt;<br />      NewString CATSTR NewString, &lt;D&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;e&gt;<br />      NewString CATSTR NewString, &lt;E&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;f&gt;<br />      NewString CATSTR NewString, &lt;F&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;g&gt;<br />      NewString CATSTR NewString, &lt;G&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;h&gt;<br />      NewString CATSTR NewString, &lt;H&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;i&gt;<br />      NewString CATSTR NewString, &lt;I&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;j&gt;<br />      NewString CATSTR NewString, &lt;J&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;k&gt;<br />      NewString CATSTR NewString, &lt;K&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;l&gt;<br />      NewString CATSTR NewString, &lt;L&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;m&gt;<br />      NewString CATSTR NewString, &lt;M&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;n&gt;<br />      NewString CATSTR NewString, &lt;N&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;o&gt;<br />      NewString CATSTR NewString, &lt;O&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;p&gt;<br />      NewString CATSTR NewString, &lt;P&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;q&gt;<br />      NewString CATSTR NewString, &lt;Q&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;r&gt;<br />      NewString CATSTR NewString, &lt;R&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;s&gt;<br />      NewString CATSTR NewString, &lt;S&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;t&gt;<br />      NewString CATSTR NewString, &lt;T&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;u&gt;<br />      NewString CATSTR NewString, &lt;U&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;v&gt;<br />      NewString CATSTR NewString, &lt;V&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;w&gt;<br />      NewString CATSTR NewString, &lt;W&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;x&gt;<br />      NewString CATSTR NewString, &lt;X&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;y&gt;<br />      NewString CATSTR NewString, &lt;Y&gt;<br />    ELSEIFIDNI &lt;Char&gt;, &lt;z&gt;<br />      NewString CATSTR NewString, &lt;Z&gt;<br />    ELSE<br />      NewString CATSTR NewString, &lt;Char&gt;<br />    ENDIF<br />  ENDM<br />  EXITM &lt;NewString&gt;<br />ENDM<br /></code></pre></div>
    <div class="meta">Posted on 2004-05-20 06:04:03 by SubEvil</div>
   </div>
   <div class="post" id="post-141533">
    <div class="subject"><a href="#post-141533">UCASE MACRO Anyone?</a></div>
    <div class="body">Can't you write it more simply, by doing a range-check on the chars ('a'-'z') and then offsetting those to become uppercase ('A'-'Z'). Should be much more compact and faster.<br /><br />Something like:<br /><pre><code><br />IF i GE 'a'<br />    IF i LE 'z'<br />        newstring CATSTR &lt;i-32&gt;<br />    ENDIF<br />ELSE<br />    newstring CATSTR &lt;i&gt;<br />ENDIF<br /></code></pre><br /><br />Haven't tested it though, modified a macro of mine that made a text all uppercase and offsetted it, so it could be used in a lookuptable.</div>
    <div class="meta">Posted on 2004-05-20 06:18:33 by Scali</div>
   </div>
   <div class="post" id="post-141543">
    <div class="subject"><a href="#post-141543">UCASE MACRO Anyone?</a></div>
    <div class="body">Can you post a copy of your MACRO?<br /><br />I'm having big problems with this 'type' of MACRO!<br /><br />I understand the theory. But having implementation problems!<br /><br />For one thing, in the &quot;newstring CATSTR &lt;i-32&gt;&quot; line (Sould be newstring CATSTR newstring, &lt;i-32&gt;), the result for hello is<br /><br />h - 32e - 32l - 32l - 32o - 32<br /><br />As you can see, there is no 'ASCII value' substitution for i.</div>
    <div class="meta">Posted on 2004-05-20 07:33:43 by SubEvil</div>
   </div>
   <div class="post" id="post-141544">
    <div class="subject"><a href="#post-141544">UCASE MACRO Anyone?</a></div>
    <div class="body">My macro was different, it used db i-32 or db i-64 to dump each byte directly into the sourcecode.<br />Perhaps it should be &lt;i&gt;-32... Or something else. Not sure.<br />Perhaps it's not possible at all. But I would find that rather disappointing then.</div>
    <div class="meta">Posted on 2004-05-20 07:44:34 by Scali</div>
   </div>
   <div class="post" id="post-141547">
    <div class="subject"><a href="#post-141547">UCASE MACRO Anyone?</a></div>
    <div class="body">I've tried &lt;i&gt; - 32 already :( Gives me a:<br /><div class="quote">error A2051: text item required</div> <br />message. :( Any other suggestions<br />:stupid:</div>
    <div class="meta">Posted on 2004-05-20 08:10:29 by SubEvil</div>
   </div>
   <div class="post" id="post-141548">
    <div class="subject"><a href="#post-141548">UCASE MACRO Anyone?</a></div>
    <div class="body">&lt;i&gt;-('a'-'A') perhaps?<br />No idea :)</div>
    <div class="meta">Posted on 2004-05-20 08:15:58 by Scali</div>
   </div>
   <div class="post" id="post-141550">
    <div class="subject"><a href="#post-141550">UCASE MACRO Anyone?</a></div>
    <div class="body">Tried that :(<br />Also:<br /><pre><code>  FORC Char, &lt;String&gt;<br />    IF &lt;Char&gt; GE 'a'<br />Echo Char<br />    ENDIF<br />  ENDM</code></pre><br />Generates errors :( <div class="quote">error A2009: syntax error in expression</div> <br />Tried:<pre><code>  FORC Char, &lt;String&gt;<br />    IF Char GE 'a'<br />Echo Char<br />    ENDIF<br />  ENDM</code></pre><br />Gives: <div class="quote">error A2006: undefined symbol : h</div></div>
    <div class="meta">Posted on 2004-05-20 08:36:16 by SubEvil</div>
   </div>
   <div class="post" id="post-141551">
    <div class="subject"><a href="#post-141551">UCASE MACRO Anyone?</a></div>
    <div class="body">Well, my entire macro was:<br /><br /><pre><code><br />SCROLLTEXT	MACRO string<br />	LOCAL i<br /><br />	; Convert ASCII to font indices<br />	FORC char, &lt;string&gt;<br />		i CATSTR &lt;'&gt;, &lt;char&gt;, &lt;'&gt;<br /><br />		IF i GE 'a'<br />			IF i LE 'z'<br />				db i-64<br />			ENDIF<br />		ELSE<br />			db	i-32<br />		ENDIF<br />	ENDM<br />ENDM<br /></code></pre><br /><br />Perhaps it may be of some use... but I dunno.<br />It's been too long since I've done macros. I'd have to study the manual.</div>
    <div class="meta">Posted on 2004-05-20 08:42:20 by Scali</div>
   </div>
   <div class="post" id="post-141560">
    <div class="subject"><a href="#post-141560">UCASE MACRO Anyone?</a></div>
    <div class="body">One way to do it would be using a lookup table.  Use INSTR to find out if the character is a lowercase letter - if so the result will be an index into that string.  Use the index with SUBSTR to place a uppercase character into the string.</div>
    <div class="meta">Posted on 2004-05-20 10:15:56 by bitRAKE</div>
   </div>
   <div class="post" id="post-141563">
    <div class="subject"><a href="#post-141563">UCASE MACRO Anyone?</a></div>
    <div class="body">I use these macros<br /><br /><pre><code><br />; ????????????????????????????????????????<br />; Macro&#58;     @Lower<br />; Purpose&#58;   Converts a symbol string to lowercase.<br />; Arguments&#58; Symbol string.<br /><br />@Lower macro String&#58;req<br />    local LowerStr, Letter, Pos, Character<br /><br />    LowerStr textequ &lt;&gt;<br />    % forc Letter, &lt;String&gt;<br />      Pos InStr &lt;ABCDEFGHIJKLMNOPQRSTUVWXYZ&gt;, &lt;Letter&gt;<br />      if Pos gt 0<br />        Character SubStr &lt;abcdefghijklmnopqrstuvwxyz&gt;, Pos, 1<br />      else<br />        Character textequ &lt;Letter&gt;<br />      endif<br />      LowerStr CatStr LowerStr, Character<br />    endm<br />    exitm LowerStr<br />endm<br /><br />; ????????????????????????????????????????<br />; Macro&#58;     @Upper<br />; Purpose&#58;   Converts a symbol string to uppercase.<br />; Arguments&#58; Symbol string.<br /><br />@Upper macro String&#58;req<br />    local UpperStr, Letter, Pos, Character<br /><br />    UpperStr textequ &lt;&gt;<br />    % forc Letter, &lt;String&gt;<br />      Pos InStr &lt;abcdefghijklmnopqrstuvwxyz&gt;, &lt;Letter&gt;<br />      if Pos gt 0<br />        Character SubStr &lt;ABCDEFGHIJKLMNOPQRSTUVWXYZ&gt;, Pos, 1<br />      else<br />        Character textequ &lt;Letter&gt;<br />      endif<br />      UpperStr CatStr LowerStr, Character<br />    endm<br />    exitm UpperStr<br />endm<br /><br /></code></pre> <br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-05-20 11:02:41 by Biterider</div>
   </div>
   <div class="post" id="post-141565">
    <div class="subject"><a href="#post-141565">LOL</a></div>
    <div class="body">Biterider, I forgot about those :)  <br /><br />I just finished drafting up the same macros from scratch, but you beat me to the punch &lt;LoL&gt;<br /><pre><code>;########################Test.asm###########################<br />.486<br />.model flat, STDCALL<br />option casemap &#58;none ; case sensitive<br /><br />include \Masm32\include\windows.inc <br />include \Masm32\include\kernel32.inc<br />include \Masm32\include\user32.inc<br />include \Masm32\include\Masm32.inc<br />includelib \Masm32\lib\Masm32.lib<br />includelib \masm32\lib\kernel32.lib<br />includelib \masm32\lib\user32.lib<br /><br /><br />UPPER MACRO szTxt&#58;REQ<br />    LOCAL val1, sz1, sz2<br />    sz2 TEXTEQU &lt;&gt;<br />    forc arg, &lt;szTxt&gt;<br />        val1 INSTR &lt;abcdefghijklmnopqrstuvwxyz&gt;, &lt;arg&gt;<br />        if val1 ne 0<br />            sz1 SUBSTR &lt;ABCDEFGHIJKLMNOPQRSTUVWXYZ&gt;, val1, 1<br />        else<br />            sz1 TEXTEQU &lt;arg&gt;<br />        endif<br />        sz2 CATSTR sz2, sz1    <br />    ENDM<br />    sz2 CATSTR &lt;'&gt;, sz2, &lt;'&gt;<br />    exitm &lt;sz2&gt;<br />ENDM<br /><br /><br />LOWER MACRO szTxt&#58;REQ<br />    LOCAL val1, sz1, sz2<br />    sz2 TEXTEQU &lt;&gt;<br />    forc arg, &lt;szTxt&gt;<br />        val1 INSTR &lt;ABCDEFGHIJKLMNOPQRSTUVWXYZ&gt;, &lt;arg&gt;<br />        if val1 ne 0<br />            sz1 SUBSTR &lt;abcdefghijklmnopqrstuvwxyz&gt;, val1, 1<br />        else<br />            sz1 TEXTEQU &lt;arg&gt;<br />        endif<br />        sz2 CATSTR sz2, sz1    <br />    ENDM<br />    sz2 CATSTR &lt;'&gt;, sz2, &lt;'&gt;<br />    exitm &lt;sz2&gt;<br />ENDM<br /><br /><br />.data<br /><br />TstTxt db UPPER&#40;&lt;Test String 32&gt;&#41;, 0<br /><br />TstTxt2 db LOWER &#40;&lt;Test STring 32&gt;&#41;,0<br /><br /><br />.code<br />start&#58;<br /><br /><br />invoke MessageBox, 0, addr TstTxt, addr TstTxt2, MB_OK<br />invoke ExitProcess,0<br /><br /><br /><br />end start<br /><br />end<br /><br />;#################################################</code></pre><br /><br />Ah well, if it has any value there it is :alright:<br />:NaN:</div>
    <div class="meta">Posted on 2004-05-20 11:59:15 by NaN</div>
   </div>
   <div class="post" id="post-141659">
    <div class="subject"><a href="#post-141659">UCASE MACRO Anyone?</a></div>
    <div class="body">Biterider,<br /><br />Minor error in your @Upper implementation, should be:<pre><code>; ????????????????????????????????????????<br />; Macro&#58;     @Upper<br />; Purpose&#58;   Converts a symbol string to uppercase.<br />; Arguments&#58; Symbol string.<br /><br />@Upper macro String&#58;req<br />    local UpperStr, Letter, Pos, Character<br /><br />    UpperStr textequ &lt;&gt;<br />    % forc Letter, &lt;String&gt;<br />      Pos InStr &lt;abcdefghijklmnopqrstuvwxyz&gt;, &lt;Letter&gt;<br />      if Pos gt 0<br />        Character SubStr &lt;ABCDEFGHIJKLMNOPQRSTUVWXYZ&gt;, Pos, 1<br />      else<br />        Character textequ &lt;Letter&gt;<br />      endif<br />      UpperStr CatStr UpperStr, Character<br />    endm<br />    exitm UpperStr<br />endm</code></pre><br />You forgot to change the:<pre><code>UpperStr CatStr LowerStr, Character<br />to<br />UpperStr CatStr UpperStr, Character<br /></code></pre><br />NaN,<br /><br />Yours adds ' ' to the string, this may be problematic!?!? in some situations ... in other situations I'm sure it had it's uses. Depends on the use I guess! ... for future reference to anyone copying these!<br /><br />Anyway, Thanx Guys!</div>
    <div class="meta">Posted on 2004-05-21 03:52:34 by SubEvil</div>
   </div>
  </div>
 </body>
</html>