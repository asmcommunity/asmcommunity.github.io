<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Regestry - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=769" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=769">Regestry</a></p>
   <div class="post" id="post-4673">
    <div class="subject"><a href="#post-4673">Regestry</a></div>
    <div class="body">Hi, everybody! One problem:<br />;------------<br />regpath db 'SOFTWARE',0<br />key_cm  dd 0<br />;------------<br />     Invoke RegOpenKeyEx, HKEY_CURRENT_USER, addr regpath, \<br />                 null, KEY_ALL_ACCESS, addr key_cm<br /> eax = 998: Invalid access to memory location.<br />;------------<br />Hope you help!</div>
    <div class="meta">Posted on 2001-08-24 02:21:06 by Alexey</div>
   </div>
   <div class="post" id="post-4690">
    <div class="subject"><a href="#post-4690">Regestry</a></div>
    <div class="body">I think i have read somewhere that KEY_ALL_ACCESS does not work under NT<br />family. Try setting the Flags you need. <br /><br />(I suppose your data are in .Data...)<br /><br /><br />betov.</div>
    <div class="meta">Posted on 2001-08-24 04:12:57 by Betov</div>
   </div>
   <div class="post" id="post-4695">
    <div class="subject"><a href="#post-4695">Answer</a></div>
    <div class="body">Sure in .data<br /><br />i try KEY_READ - all the same!<br />Plz, example!</div>
    <div class="meta">Posted on 2001-08-24 04:58:35 by Alexey</div>
   </div>
   <div class="post" id="post-4701">
    <div class="subject"><a href="#post-4701">Regestry</a></div>
    <div class="body">Does the Key exist?<br /><br />betov</div>
    <div class="meta">Posted on 2001-08-24 06:05:15 by Betov</div>
   </div>
   <div class="post" id="post-4717">
    <div class="subject"><a href="#post-4717">Regestry</a></div>
    <div class="body"><div class="quote"> I think i have read somewhere that KEY_ALL_ACCESS does not work under NT</div> <br /><br />oh !! <br />Is it true ???<br />can someone check ?<br />thanx<br /><br />(s)</div>
    <div class="meta">Posted on 2001-08-24 08:16:05 by (scalp)</div>
   </div>
   <div class="post" id="post-4719">
    <div class="subject"><a href="#post-4719">Regestry</a></div>
    <div class="body">It depends on your access rights. Administrator accounts can probably<br />do what they want, regular accounts can't. Depending on how the<br />system is set up.</div>
    <div class="meta">Posted on 2001-08-24 08:31:13 by f0dder</div>
   </div>
   <div class="post" id="post-4732">
    <div class="subject"><a href="#post-4732">Regestry</a></div>
    <div class="body">I have found where i have read this, Scalp: This was a the time i was working<br />with Ron Thomas on the Screen Saver Demos. We have had a lot of problems<br />to make these Demos run under all Win versions. At that time i had no<br />test Computer with 2000 in the box, so, i didn't test by myself, but<br />here are some line relating a mail exchange between Iczelion and Ron:<br /><br />&quot;... I then realized that these two savers actually write to registry <br />keys and asked Iczelion if this could be the problem. The answer was yes, <br />Win2000 is paranoid about security and he changed the KEY_ALL_ACCESS to<br />KEY_READ or KEY_WRITE or KEY_QUERY_VALUE for the RegCreateKeyEx API...<br />It worked and I've now updated Balls in the same way.... &quot;.<br /><br /><br />Betov.</div>
    <div class="meta">Posted on 2001-08-24 10:05:26 by Betov</div>
   </div>
   <div class="post" id="post-4734">
    <div class="subject"><a href="#post-4734">Regestry</a></div>
    <div class="body">thanx<br />good to know !<br /><br />(s)</div>
    <div class="meta">Posted on 2001-08-24 10:13:53 by (scalp)</div>
   </div>
   <div class="post" id="post-5017">
    <div class="subject"><a href="#post-5017">New bug?</a></div>
    <div class="body">Test code:<br />regpath dw 'SOFTWARE\key',0<br />Invoke RegCreateKeyExW, HKEY_LOCAL_MACHINE, \<br />addr regpath, null, null, null, KEY_ALL_ACCESS, null, \<br />addr key_1, addr lc1<br />return error with &quot;Invalid access to memory location&quot; - 998<br /><br />In the same program on the same machine:<br />regpathA db 'SOFTWARE\key',0<br />Invoke RegCreateKeyExA, HKEY_LOCAL_MACHINE, \<br />addr regpathA, null, null, null, KEY_ALL_ACCESS, null, \<br />addr key_1, addr lc1<br />return OK!</div>
    <div class="meta">Posted on 2001-08-27 00:01:29 by Alexey</div>
   </div>
   <div class="post" id="post-5064">
    <div class="subject"><a href="#post-5064">Regestry</a></div>
    <div class="body">So does MASM really create Unicode with DW ?<br /><br />If so, there's an ambiguity with<br /><br />DW '12',0<br /><br />To be compatible with previous assemblers, and be consistent with uses of 'xx' in machine instructions like<br /><br />mov eax,'0123'   ; load eax with 30313233h<br /><br />then MASM must produce the equivalent of<br /><br />DW 3132h,0000h<br /><br />which is the same as<br /><br />DB 32h, 31h, 00h, 00h<br /><br />====<br /><br />Unicode should produce code equivalent to:<br /><br />DB 31h, 0, 32h, 0, 0, 0</div>
    <div class="meta">Posted on 2001-08-27 14:38:28 by tank</div>
   </div>
   <div class="post" id="post-5166">
    <div class="subject"><a href="#post-5166">sorry</a></div>
    <div class="body">Of course you right! My mistake!<br />In reality i use macro:<br />;------------------------------------------------<br />    WSTRING macro name,_STRING_<br />            Local k<br />            k = 0<br />            ifnb &lt;name&gt;<br />              name label WORD<br />            endif<br />            _ESC_ = 0<br />            forc _CHAR_,&lt;_STRING_&gt;<br />              if _ESC_<br />                _ESC_ = 0<br />                if &quot;&amp;_CHAR_&quot; eq &quot;/&quot;<br />                  WORD &quot;/&quot;<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;n&quot;<br />                  WORD 0Dh, 0Ah<br />                  k = k+2<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;t&quot;<br />                  WORD 09h<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;:&quot;<br />                  WORD &quot;!&quot;<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;-&quot;<br />                  WORD &quot;'&quot;<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;=&quot;<br />                  WORD '&quot;'<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;|&quot;<br />                  WORD &quot;\&quot;<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;#&quot;<br />                  WORD &quot;%&quot;<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;+&quot;<br />                  WORD &quot;&amp;&quot;<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;(&quot;<br />                  WORD &quot;&lt;&quot;<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;)&quot;<br />                  WORD &quot;&gt;&quot;<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;0&quot;<br />                  WORD 0<br />                  k = k+1<br />                elseif &quot;&amp;_CHAR_&quot; eq &quot;1&quot;<br />                  WORD 1<br />                  k = k+1<br />                else<br />                  WORD &quot;/&quot;, &quot;&amp;_CHAR_&quot;<br />                  k = k+2<br />                endif             ;if &quot;&amp;_CHAR_&quot;<br />              else                ;if _ESC_<br />                if &quot;&amp;_CHAR_&quot; eq &quot;/&quot;<br />                  _ESC_ = 1<br />                else<br />                  _ESC_ = 0<br />                  if &quot;&amp;_CHAR_&quot; ne &quot;'&quot;<br />                  if &quot;&amp;_CHAR_&quot; ge 80h<br />                    WORD &quot;&amp;_CHAR_&quot;+400h-176<br />                  else  <br />                    WORD &quot;&amp;_CHAR_&quot;<br />                  endif<br />                  k = k+1<br />                  endif<br />                endif<br />              endif               ;if _ESC_<br />            endm                  ;forc _CHAR_,&lt;_STRING_&gt;<br />            ifnb &lt;name&gt;<br />              sizeof_&amp;name EQU 2*k<br />            endif<br />     endm<br />It generates unicode strings and in program i write:<br />WSTRING regpath,'SOFTWARE\KEY1/0'<br />--------------------------<br />All unicode Reg*ExW functions with second parameter <br />LPCTSTR subKey return error 998 if this par not null!<br />But functions Reg*ExA works fine!</div>
    <div class="meta">Posted on 2001-08-28 10:05:04 by Alexey</div>
   </div>
  </div>
 </body>
</html>