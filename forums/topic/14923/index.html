<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>linking a masm obj to delphi 6 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14923" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14923">linking a masm obj to delphi 6</a></p>
   <div class="post" id="post-115814">
    <div class="subject"><a href="#post-115814">linking a masm obj to delphi 6</a></div>
    <div class="body">Hello,<br />I am trying to link a masm obj to delphi 6.<br />This is my first time.<br />I have this piece of code,<br />is it good ?<br /><br /><br /><pre><code><br />.386<br />.model flat, stdcall<br />option casemap&#58;none<br /><br />include user32.inc<br />includelib user32.lib<br /><br />.data<br />	Msg	db &quot;Msg&quot; ,0<br />	Title	db &quot;Title&quot;  ,0<br />	<br />.code<br /><br />MsgBox proc<br />	invoke	MessageBox, 0, offset Msg, offset Title, 0<br />	ret<br />MsgBox endp<br /><br />end<br /></code></pre> <br /><br />or do I have to write the code like writting a complete masm program using Start:<br />end Start, ExitProcess and those kind of stuff ?<br /><br />because I get errors.<br />I have converted the coff obj to omf, but still delphi compiler gives me errors.<br /><br />Thanks</div>
    <div class="meta">Posted on 2003-08-27 14:48:54 by Jnrz</div>
   </div>
   <div class="post" id="post-128555">
    <div class="subject"><a href="#post-128555">linking a masm obj to delphi 6</a></div>
    <div class="body">How to include a masm object file in a Delphi project:<br /><br />1. Use pascal calling convention: .model flat, PASCAL<br />2. Do not use any other section than .code (no .data at all!)<br />3. You can only have <strong>one</strong> procedure i an object file. Use local procs or several files if you need more than one.<br />4. Assemble using the /Fo switch. Change in your radasm project file (*.rap) to 2=3,O,$B\ML.EXE /I&quot;$I&quot; /c /Fo ,3,2<br /><br />Here is an example:</div>
    <div class="meta">Posted on 2003-12-21 10:34:24 by Delight</div>
   </div>
   <div class="post" id="post-128557">
    <div class="subject"><a href="#post-128557">linking a masm obj to delphi 6</a></div>
    <div class="body">Thanks  Delight,<br /><br />I will take a look at it :)</div>
    <div class="meta">Posted on 2003-12-21 10:42:09 by Jnrz</div>
   </div>
   <div class="post" id="post-128666">
    <div class="subject"><a href="#post-128666">linking a masm obj to delphi 6</a></div>
    <div class="body">And, as far as I remember, the .obj cannot have any external .lib dependencies.</div>
    <div class="meta">Posted on 2003-12-22 15:34:27 by Morris</div>
   </div>
  </div>
 </body>
</html>