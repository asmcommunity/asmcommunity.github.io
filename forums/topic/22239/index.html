<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>I have a question about the tutorials of ODBCtest, please help me - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22239" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=17">Iczelion's Tutorials</a> &raquo; <a href="../?id=22239">I have a question about the tutorials of ODBCtest, please help me</a></p>
   <div class="post" id="post-167172">
    <div class="subject"><a href="#post-167172">I have a question about the tutorials of ODBCtest, please help me</a></div>
    <div class="body">hello everyone, I have a question about ODBCtest.<br />In this tutorial, I add some code like the following , But it cannot work. the question is about &quot;INSERT walues to a table&quot;.<br /><br /><br /><br /><pre><code><br />sqlstring db &quot;insert main (Name) values (?)&quot;,0<br />sample1 db &quot;bob&quot;,0<br />sample2 db &quot;mary&quot;,0<br />success db &quot;congratulation&quot;,0<br /><br />.data?<br />buffer db 256 dup (?)<br />strlen dd ?<br />.code <br />......<br />.elseif ax==IDM_CUSTOMQUERY<br />			&nbsp; &nbsp; <br />&nbsp;  invoke SQLAllocHandle, SQL_HANDLE_STMT, hConn, addr hStmt<br />&nbsp;  .if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />&nbsp; &nbsp; &nbsp; invoke SQLPrepare,hStmt,addr sqlstring,sizeof sqlstring<br />&nbsp; &nbsp;  invoke SQLBindParameter,hStmt,1,SQL_PARAM_INPUT,SQL_C_CHAR,SQL_CHAR,25,0,addr buffer,sizeof buffer,addr strlen<br />&nbsp; &nbsp;  invoke lstrcpy,addr buffer,addr sample1<br />&nbsp; &nbsp; &nbsp; mov strlen,sizeof sample1<br />&nbsp; &nbsp;  invoke SQLExecute,hStmt&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;here It cannot work correctlly,why?<br />&nbsp; &nbsp; &nbsp; &nbsp;  .if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  invoke MessageBox,hDlg,addr success,addr success,MB_OK<br />&nbsp; &nbsp; &nbsp; &nbsp;  .else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  invoke MessageBox,hDlg,addr ExecuteFail, addr AppName, MB_OK+MB_ICONERROR<br />&nbsp; &nbsp; &nbsp; &nbsp;  .endif<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke SQLCloseCursor, hStmt<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  invoke SQLFreeHandle, SQL_HANDLE_STMT, hStmt<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  .else<br />..........................<br /><br /><br /></code></pre><br /><br />The above is the code I had added into the code, But it does not word, Why?<br />anyone can help me ? Thank you!<br /></div>
    <div class="meta">Posted on 2005-10-24 05:30:47 by miaomiao</div>
   </div>
   <div class="post" id="post-167176">
    <div class="subject"><a href="#post-167176">Re: I have a question about the tutorials of ODBCtest, please help me</a></div>
    <div class="body">The original tutorial is in the following URL:&nbsp;  <a target="_blank" href="http://spiff.tripnet.se/~iczelion/files/odbc5.zip">http://spiff.tripnet.se/~iczelion/files/odbc5.zip</a></div>
    <div class="meta">Posted on 2005-10-24 09:13:38 by miaomiao</div>
   </div>
   <div class="post" id="post-167189">
    <div class="subject"><a href="#post-167189">Re: I have a question about the tutorials of ODBCtest, please help me</a></div>
    <div class="body">I dont think the syntax of the sql statement is correct.<br /><br />Have a look here:<br /><a target="_blank" href="http://www.w3schools.com/sql/sql_insert.asp">http://www.w3schools.com/sql/sql_insert.asp</a><br /><br />KetilO</div>
    <div class="meta">Posted on 2005-10-24 16:07:22 by KetilO</div>
   </div>
   <div class="post" id="post-167193">
    <div class="subject"><a href="#post-167193">Re: I have a question about the tutorials of ODBCtest, please help me</a></div>
    <div class="body">Thanks a lot, KetilO, I have got it.&nbsp; :P</div>
    <div class="meta">Posted on 2005-10-24 19:12:04 by miaomiao</div>
   </div>
  </div>
 </body>
</html>