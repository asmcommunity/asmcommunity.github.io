<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>help with a code - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30320" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=30320">help with a code</a></p>
   <div class="post" id="post-213512">
    <div class="subject"><a href="#post-213512">help with a code</a></div>
    <div class="body">hi&nbsp; :),<br />i&#039;m trying to write an assembly code to find the character that the maximum occurence in a string but i have some problems.can anybody help me please :sad:<br />here is my code<br /><pre><code>model small<br />.stack 100h<br />.data<br />chaine db &quot;i want to test$&quot;<br />char db &#039;$&#039;<br />nr dw ?<br />tch dw ? <br />entre dw 10,13,&#039;$&#039;<br />msg4 dw &quot;the character with a maximum occurence is:$&quot;&nbsp; <br />.code<br />mov tch,14 <br />mov si,offset chaine <br />mov nr,0 <br />mov cx,tch <br />dec cx <br />mov dx,si <br />add dx,tch <br />repete14: <br />mov bx,0 <br />mov al, <br />mov char,al&nbsp; <br />repete24: <br />mov al,<br />cmp al,char <br />je meme <br />jmp different <br />meme: <br />inc bx <br />different: <br />inc al <br />cmp al,dx <br />jg repete24 <br />inc si <br />cmp dx,nr <br />jg affecter <br />loop repete14 <br />affecter: <br />mov nr,bx <br />loop repete14 <br />mov dx,offset msg4 <br />mov ah,9<br />int 21h<br />mov ax,nr <br />mov ah,2<br />int 21h<br />mov dx,offset entre <br />mov ah,9<br />int 21h</code></pre></div>
    <div class="meta">Posted on 2010-11-23 16:43:17 by marooh</div>
   </div>
   <div class="post" id="post-213522">
    <div class="subject"><a href="#post-213522">Re: help with a code</a></div>
    <div class="body">Well, I&#039;m Nasmist, and we do things slightly different than Masm. I&#039;m not sure exactly what you&#039;re trying to do here. Some comments might help - help others reading your code, and maybe help you, too! I can still make some suggestions...<br /><br /><pre><code><br />chaine db &quot;i want to test$&quot;<br /></code></pre><br /><br />You&#039;ve got a $-terminated string. Good for printing with int 21h/9, but outside of int 21h/9, &#039;$&#039; is a perfectly legitimate character to appear in a string. You might want to use a zero-terminated string instead. It is possible to do both. You don&#039;t currently print this string, but you might want to - just to let the user know what string we&#039;re working with...<br /><br /><pre><code><br />entre dw 10,13,&#039;$&#039;<br />msg4 dw &quot;the character with a maximum occurence is:$&quot;&nbsp; <br /></code></pre><br /><br />13, 10 is &quot;canonical&quot;, not 10, 13. Probably won&#039;t hurt. Both of these should be &quot;db&quot;, not &quot;dw&quot;.<br /><br /><pre><code><br />.code<br />mov tch,14&nbsp; ; length of string?<br />mov si,offset chaine<br />...<br /></code></pre><br /><br />You don&#039;t seem to indicate an entrypoint here (unless the &quot;simplified segment directive&quot; does it - I don&#039;t think so). AIUI, Masm indicates that &quot;foo:&quot; is the entrypoint with &quot;end foo&quot; at the end of the code. If this is going to be a .com file, that isn&#039;t necessary, but I think &quot;model small&quot; indicates an .exe. If so, you also need to initialize ds!!!<br /><br /><pre><code><br />mov ax, @data<br />mov ds, ax<br /></code></pre><br /><br /><pre><code><br />...<br />mov al,<br /></code></pre><br /><br />Unless you&#039;re looking for double characters, I&#039;m not sure what this is going to do...<br /><br /><pre><code><br />different: <br />inc al <br />cmp al,dx<br /></code></pre><br /><br />This is just plain wrong. I don&#039;t think it&#039;ll even assemble - you can&#039;t compare an 8-bit register to a 16-bit register! Maybe you intended si here, not al?<br /><br />You seem to be looping over the string several times. Perhaps you can get that to work, but I&#039;d take a slightly different approach. I&#039;d walk down the string just once, and keep track of the &quot;count&quot; in an array of character counts. Ummm...<br /><br /><pre><code><br />char_counts 256 dup dw 0<br /></code></pre><br /><br />(not sure of the syntax for &quot;dup&quot;) Some &quot;wasted&quot; space there, but I think it&#039;ll simplify(?) the code a little. Then, as I get each character, I&#039;d convert it into an index into the array, and increment the count for that character...<br /><br /><pre><code><br />next_char:<br />mov al, &nbsp; ; get a character<br />inc si&nbsp; ; get ready for the next one (also see &quot;lodsb&quot;)<br /><br />; have we reached the end of the string?<br />cmp al, &#039;$&#039;&nbsp; ; or preferably(?) zero<br />jz finished<br /><br />; now convert the character into an index into the array<br />mov bl, al<br />mov bh, 0&nbsp; ; make sure upper bits of bx are clear<br />add bx, bx&nbsp; ; or otherwise double it - we have a word (16-bit) array!<br />mov cx, <br />inc cx<br />mov , cx<br />; could have just &quot;inc word ptr &quot;, but...<br /><br />; see if it&#039;s our new champion<br />cmp , cx<br />jb skip ; if not, do nothing<br /><br />; update the scoreboard<br />mov , cx<br />mov , al<br /><br />skip:<br />jmp next_char<br /><br />finished:<br />; print the result<br />; don&#039;t forget to exit back to dos!<br /></code></pre><br /><br />I don&#039;t know if that idea will help you or not, but I don&#039;t see how it&#039;s going to work the way you&#039;re trying to do it. Courage! :)<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="meta">Posted on 2010-11-25 21:27:28 by fbkotler</div>
   </div>
  </div>
 </body>
</html>