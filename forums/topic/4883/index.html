<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>count [sections] in .ini files - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4883" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4883">count [sections] in .ini files</a></p>
   <div class="post" id="post-34214">
    <div class="subject"><a href="#post-34214">count [sections] in .ini files</a></div>
    <div class="body">DoLoop:<br />invoke GetPrivateProfileSectionNames,addr returnbuff,addr szbuff,addr aimini<br />dec szbuff<br />mov counter,0<br /><br />invoke MessageBox,0,addr returnbuff,addr szbuff,MB_OK<br />                mov eax,counter    ;| move value of MyCounter to EAX<br />                cmp eax,szbuff     ;| compare eax(counter) to keysize <br />                jge AllDone	     ;| jump to alldone if compared values are greater or equal<br />                inc counter        ;| increments '1' to the 'counter&quot; buffer<br />		jmp DoLoop           ;| jump back up to get next name<br />AllDone:<br /><br />trying to make this loop until all the  names  pop in the message box one by one<br />its for a program that already uses ini files i know the registry is much better to use :grin:</div>
    <div class="meta">Posted on 2002-04-21 00:48:14 by illwill</div>
   </div>
   <div class="post" id="post-34246">
    <div class="subject"><a href="#post-34246">count [sections] in .ini files</a></div>
    <div class="body">illwill,<br /><br />Here is a suggestion, load the complete INI file into memory then use a function in the MASM32 library called &quot;WordCount&quot; to count the number of &quot;[&quot; in the file. As long as no sections are comented out like,<br /><br />; <br /><br />it will be correct and much faster than the method you are testing.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-04-21 07:09:48 by hutch--</div>
   </div>
   <div class="post" id="post-34248">
    <div class="subject"><a href="#post-34248">count [sections] in .ini files</a></div>
    <div class="body"><strong>Hutch</strong>: what if one of the values contains a bracket?<br /><br /><pre><code><br />&#91;section&#93;<br />value=&quot;blah blah &#91;brackets&#93; blah&quot;<br /></code></pre><br /><br />You can probably count lines starting with [ though..<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-04-21 07:13:38 by Thomas</div>
   </div>
   <div class="post" id="post-34258">
    <div class="subject"><a href="#post-34258">count [sections] in .ini files</a></div>
    <div class="body">Just count the 0's in the buffer and substract one. Then you have the count of sections. Quote from MSDN:<br /><br /><div class="quote"><br />lpszReturnBuffer <br />Pointer to a buffer that receives the section names associated with the named file. The buffer is filled with one or more null-terminated strings; the last string is followed by a second null character. <br /></div><br /><br />If you can't get it work, I can post you the way, I use in one of my programms.</div>
    <div class="meta">Posted on 2002-04-21 08:44:06 by bazik</div>
   </div>
   <div class="post" id="post-34369">
    <div class="subject"><a href="#post-34369">count [sections] in .ini files</a></div>
    <div class="body">well maybe just a sample of it i havnet had much with msdn tehyre considor ini files outdated and dont have much on them so if you could post and example to go by id appreciate</div>
    <div class="meta">Posted on 2002-04-21 21:20:47 by illwill</div>
   </div>
  </div>
 </body>
</html>