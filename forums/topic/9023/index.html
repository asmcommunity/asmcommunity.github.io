<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Centering The Window - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9023" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9023">Centering The Window</a></p>
   <div class="post" id="post-66312">
    <div class="subject"><a href="#post-66312">Centering The Window</a></div>
    <div class="body">Hi,<br />     Can somebody show me how to center a window onto the screen? I would like to know how to get the correct x and y if given the window height and width to place that window onto the center of the screen.<br />Thanks,<br />Barry</div>
    <div class="meta">Posted on 2002-11-18 16:26:40 by bgong68</div>
   </div>
   <div class="post" id="post-66319">
    <div class="subject"><a href="#post-66319">Centering The Window</a></div>
    <div class="body">Do you know the meaning of &quot;search&quot;? <br />Search for &quot;center window&quot;:<br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=5437&amp;highlight=center+window">http://www.asmcommunity.net/board/index.php?topic=5437&amp;highlight=center+window</a></div>
    <div class="meta">Posted on 2002-11-18 17:02:28 by bazik</div>
   </div>
   <div class="post" id="post-66390">
    <div class="subject"><a href="#post-66390">Centering The Window</a></div>
    <div class="body">Taken from <a target="_blank" href="www.madwizard.org">www.madwizard.org</a><br /><pre><code><br />CenterScreen proc hwnd&#58;HWND <br />LOCAL DlgHeight&#58;DWORD <br />LOCAL DlgWidth&#58;DWORD <br />LOCAL DlgRect&#58;RECT <br />LOCAL DesktopRect&#58;RECT <br />     <br />     invoke GetWindowRect,hwnd,ADDR DlgRect <br />     invoke GetDesktopWindow <br />     mov ecx,eax <br />     invoke GetWindowRect,ecx,addr DesktopRect <br />     push 0 <br />     mov eax,DlgRect.bottom <br />     sub eax,DlgRect.top <br />     mov DlgHeight,eax <br />     push eax <br />     mov eax,DlgRect.right <br />     sub eax,DlgRect.left <br />     mov DlgWidth,eax <br />     push eax <br />     mov eax,DesktopRect.bottom <br />     sub eax,DlgHeight <br />     shr eax,1 <br />     push eax <br />     mov eax,DesktopRect.right <br />     sub eax,DlgWidth <br />     shr eax,1 <br />     push eax <br />     push hwnd <br />     call MoveWindow <br />     ret <br />CenterScreen endp <br /></code></pre><br /><br />My code<br /><pre><code>	invoke 	GetSystemMetrics, SM_CXSCREEN<br />	sub	eax,800<br />	shr	eax,1<br />	xchg 	eax,ebx<br />	invoke 	GetSystemMetrics, SM_CYSCREEN<br />	sub	eax,600<br />	shr	eax,1<br />	invoke 	CreateWindowEx, NULL,ADDR ClassName, ADDR AppName, WS_BORDER or WS_VISIBLE or WS_OVERLAPPEDWINDOW,\<br />				ebx,eax,800,600, 0, 0, hinst, 0<br /></code></pre></div>
    <div class="meta">Posted on 2002-11-19 06:33:45 by roticv</div>
   </div>
   <div class="post" id="post-66391">
    <div class="subject"><a href="#post-66391">Thanks</a></div>
    <div class="body">Hi  roticv,<br />     Thanks for the code and showing me where you got it from. I will check out that website as well.<br />Barry ^_^</div>
    <div class="meta">Posted on 2002-11-19 06:46:53 by bgong68</div>
   </div>
   <div class="post" id="post-66411">
    <div class="subject"><a href="#post-66411">&quot;Psst, wanna hear a secret ?&quot;</a></div>
    <div class="body">If you look in the MASM32 subfolders, your will discover many useful functions, the onr roticv posted, for example. :)</div>
    <div class="meta">Posted on 2002-11-19 08:50:56 by JCP</div>
   </div>
  </div>
 </body>
</html>