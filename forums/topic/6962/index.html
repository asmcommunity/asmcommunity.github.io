<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>note.szTip problems - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6962" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6962">note.szTip problems</a></p>
   <div class="post" id="post-50311">
    <div class="subject"><a href="#post-50311">note.szTip problems</a></div>
    <div class="body">I have an app which is minimized to a tray icon.  With mouse over icon a message giving the name of app is displayed.  I want to display amount of physical memory available to windows instead.  This is no problem either.  The problem starts when I update the message.  After I start a new app, say notepad,  then put mouse over tray icon the memory available display should be updated but it is not.  I try putting the call  <em>invoke lstrcpy,ADDR note.szTip,ADDR szTempBuf</em> in different places like in the call back message <strong>WM_SHELLNOTIFY</strong> but nothing seems to work.  The value in the szTempBuf is being updated each time mouse is passed over icon but the message is not getting through to the <strong>NOTIFYICONDATA</strong>  structure.<br /><br />Any help or suggestions much appreciated.<br /><br />Best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-07-26 15:32:45 by czDrillard</div>
   </div>
   <div class="post" id="post-50315">
    <div class="subject"><a href="#post-50315">note.szTip problems</a></div>
    <div class="body">Try..<br /><br />invoke lstrcpy,ADDR note.szTip,ADDR szTempBuf<br />invoke Shell_NotifyIcon,NIM_MODIFY,ADDR note</div>
    <div class="meta">Posted on 2002-07-26 17:12:36 by WillASM</div>
   </div>
   <div class="post" id="post-50349">
    <div class="subject"><a href="#post-50349">note.szTip problems</a></div>
    <div class="body">Thanks WillASM,<br /><em>NIM_MODIFY </em> was what I needed.  Funny thing is I was looking at this earlier in the SDK and skipped over it because it says:  <strong>NIM_MODIFY  Modifies an icon in the status area.</strong> I assumed, wrongly, that this applied to changing the tray icon only and would have no effect on the szTip member.<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-07-26 21:14:18 by czDrillard</div>
   </div>
  </div>
 </body>
</html>