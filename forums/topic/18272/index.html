<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Serial Port IO in Windows XP - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18272" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18272">Serial Port IO in Windows XP</a></p>
   <div class="post" id="post-141393">
    <div class="subject"><a href="#post-141393">Serial Port IO in Windows XP</a></div>
    <div class="body">Hi,<br /><br />Can someone point me to examples of doing IO to Serial Ports in a Windows XP environment?<br /><br />Thanks,<br /><br />Firmo</div>
    <div class="meta">Posted on 2004-05-18 14:38:34 by firmo</div>
   </div>
   <div class="post" id="post-141400">
    <div class="subject"><a href="#post-141400">Serial Port IO in Windows XP</a></div>
    <div class="body">From the FAQ: <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=3927">http://www.asmcommunity.net/board/index.php?topic=3927</a> :-)</div>
    <div class="meta">Posted on 2004-05-18 15:16:25 by f0dder</div>
   </div>
   <div class="post" id="post-141405">
    <div class="subject"><a href="#post-141405">Serial Port IO in Windows XP</a></div>
    <div class="body">Hi FOdder,<br /><br />I did read that FAQ and went to Thomas website. However he has a lib for an old version of WinIo that does not work for WinXP.<br /><br />I sent him an e-mail and am hopping he will reply&gt; I dont know f his e-mail address is istill valid.<br /><br />But thanks for the reply.<br /><br />Best,<br /><br />Firmo</div>
    <div class="meta">Posted on 2004-05-18 15:28:48 by firmo</div>
   </div>
   <div class="post" id="post-141406">
    <div class="subject"><a href="#post-141406">Serial Port IO in Windows XP</a></div>
    <div class="body">Hi,<br /><br />Try Porttalk v2.0 from beyondlogics</div>
    <div class="meta">Posted on 2004-05-18 15:36:19 by KSA</div>
   </div>
   <div class="post" id="post-141426">
    <div class="subject"><a href="#post-141426">Serial Port IO in Windows XP</a></div>
    <div class="body">Here's the XP-compatible WinIO files which I have used and can confirm there is no problem..</div>
    <div class="meta">Posted on 2004-05-19 03:03:45 by Homer</div>
   </div>
   <div class="post" id="post-141450">
    <div class="subject"><a href="#post-141450">Serial Port IO in Windows XP</a></div>
    <div class="body">Thanks KSA and EvilHomer2k,<br /><br />Will look at both.<br /><br />Best,<br /><br />Firmo</div>
    <div class="meta">Posted on 2004-05-19 10:25:52 by firmo</div>
   </div>
   <div class="post" id="post-141572">
    <div class="subject"><a href="#post-141572">Serial Port IO in Windows XP</a></div>
    <div class="body">Hi EvilHomer2k,<br /><br />Could you inform the version of WinIo that the file you sent me are from?<br /><br />Best,<br /><br />Firmo</div>
    <div class="meta">Posted on 2004-05-20 14:40:25 by firmo</div>
   </div>
   <div class="post" id="post-141952">
    <div class="subject"><a href="#post-141952">Serial Port IO in Windows XP</a></div>
    <div class="body">According to the DLL information, it's 2.0</div>
    <div class="meta">Posted on 2004-05-24 01:10:09 by Homer</div>
   </div>
   <div class="post" id="post-141986">
    <div class="subject"><a href="#post-141986">Serial Port IO in Windows XP</a></div>
    <div class="body">Hi  EvilHomer2k,<br /><br />Thanks again.<br /><br />However I have another question regarding the PROTOS you sent me for the WinIo routines.<br /><br />The PROTOS define all the parameters as DWORD and looking at the defined parameters in WinIo documentation some of them are not.<br /><br />For example:<br /><br />bool _stdcall GetPortVal(<br />   WORD wPortAddr,       <br />   PDWORD pdwPortVal,    <br />   BYTE bSize            <br />);        <br /><br />GetPortVal               PROTO STDCALL :DWORD, :DWORD, :DWORD<br /><br />Forgive the beginner question but I thoght the parameter types had to match. If they dont how does the calling routine unstack them if it is expecting different size types?<br /><br /><br />Best,<br /><br />Firmo</div>
    <div class="meta">Posted on 2004-05-24 11:39:38 by firmo</div>
   </div>
   <div class="post" id="post-142009">
    <div class="subject"><a href="#post-142009">Serial Port IO in Windows XP</a></div>
    <div class="body">I only whant to add other resource, finded by other person here (@ this computer), but that need access the serial port <a target="_blank" href="http://www.logix4u.net/">http://www.logix4u.net/</a><br /><br />Have a nice day or night</div>
    <div class="meta">Posted on 2004-05-24 13:16:39 by rea</div>
   </div>
   <div class="post" id="post-142010">
    <div class="subject"><a href="#post-142010">Serial Port IO in Windows XP</a></div>
    <div class="body">Thanks hgb.<br /><br />Firmo</div>
    <div class="meta">Posted on 2004-05-24 13:37:44 by firmo</div>
   </div>
   <div class="post" id="post-142043">
    <div class="subject"><a href="#post-142043">Serial Port IO in Windows XP</a></div>
    <div class="body">Of course you are correct about the Params of functions, but are you sure the documentation matches the version I provided? Attached is a working example for a machine automation application (robotics) which I wrote a while ago with the WinIO files I provided (source provided is not my final version).. you can mess with the pins on the printer port in realtime and see the bits changing in one part of the application (press escape and find Expert Mode)<br /><br />Don't expect too much from the source I provided, I just wanted to prove beyond doubt that the WinIO files provided are ok, and that the params specified for this version are correct.</div>
    <div class="meta">Posted on 2004-05-25 00:51:02 by Homer</div>
   </div>
   <div class="post" id="post-142086">
    <div class="subject"><a href="#post-142086">Serial Port IO in Windows XP</a></div>
    <div class="body">Hi EvilHomer2k,<br /><br />Thanks for the files. I will study them with care.<br /><br />Thomas Bleeker &lt;Thomas@MadWizard.org&gt; provided me with a very nice explanation on how the PROTOS are the way they are. I reproduce his explanation below since it will benifit a lot of us:<br /><br />&quot;In high level languages like C++ parameters always have to have the right types because the compiler enforces the use of the right type with type checks. However, in assembly there are almost no types, only the processor's types (DWORD, WORD, BYTE, etc). A pointer is just a DWORD, and so is an integer.<br /><br /><br />Then there's something else that confuses things, namely that in windows, all function paramters are passed as DWORDs or multiples of that. You will never see a 16-bit register or something pushed onto the stack as a parameter to an API call or C function. This is because the stack needs to be aligned to 4 byte boundaries and because it's far more efficient to use DWORDs.<br /><br /><br />In this paricular case it means that WORD, PDWORD and BYTE are all passed as DWORDs in the end anyway. If the size of the type is smaller (like WORD and BYTE) it is stored in the lowest bits of DWORD and only part of it is used (for example only the lowest 16-bits in the case of a WORD). Sometimes it is also assumed the unused bits are zero but this might be a wrong assumption in some cases.<br /><br /><br />Some people define typedef's for other types (like PDWORD typedef DWORD), but since most prototypes are generated automatically usually just DWORD is used.<br /><br /><br />Thomas&quot;</div>
    <div class="meta">Posted on 2004-05-25 09:43:06 by firmo</div>
   </div>
  </div>
 </body>
</html>