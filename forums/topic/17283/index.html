<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Whats the Difference??? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17283" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=17283">Whats the Difference???</a></p>
   <div class="post" id="post-133946">
    <div class="subject"><a href="#post-133946">Whats the Difference???</a></div>
    <div class="body">I was just wondering, whats the difference between,<br /><br />invoke MessageBox,NULL,addr MESSAGETEXT,addr MESSAGECAP,MB_OK<br /><br />and<br /><br />push 10h<br />push offset MESSAGECAP<br />push offset MESSAGETEXT<br />push 0<br />Call MessageBoxA<br /><br />Just wondering which one is more common/preferred. Yes I'm a newbie to Assembly programming but have some good XP with softice and Dasm</div>
    <div class="meta">Posted on 2004-02-17 18:09:20 by akuma6099</div>
   </div>
   <div class="post" id="post-133948">
    <div class="subject"><a href="#post-133948">Whats the Difference???</a></div>
    <div class="body">ADDR generally translates to :<br /><br />lea eax, MESSAGETEXT<br />push eax<br /><br />The invoke macro just makes your code a little bit more lisible.. which comes in handy.. especially after seeing some API's like CreateFont :)<br /><br />Generally the rule is.. that if your strings , buffers, etc are declared in .data or .data? you should use Offset which translates to:<br /><br />push MESSAGETEXT<br /><br />ADDR should only be used for local variables which you declare upon entry on your proc using the LOCAL statement<br /><br />Hope this helps,<br />J</div>
    <div class="meta">Posted on 2004-02-17 18:35:22 by JimmyClif</div>
   </div>
   <div class="post" id="post-133952">
    <div class="subject"><a href="#post-133952">Whats the Difference???</a></div>
    <div class="body">You can use the /Sg switch on the MASM command line to see (in the .LST file) the code generated by INVOKE .IF etc. :)</div>
    <div class="meta">Posted on 2004-02-17 18:53:46 by S/390</div>
   </div>
   <div class="post" id="post-133957">
    <div class="subject"><a href="#post-133957">Whats the Difference???</a></div>
    <div class="body"><div class="quote">ADDR generally translates to :<br /><br />lea eax, MESSAGETEXT<br />push eax</div><br /><br />Last time I looked, it only did that for local vars, and used offset for globals.</div>
    <div class="meta">Posted on 2004-02-17 19:35:05 by Henk-Jan</div>
   </div>
   <div class="post" id="post-133960">
    <div class="subject"><a href="#post-133960">Whats the Difference???</a></div>
    <div class="body"><div class="quote"><br /><br /><br />Last time I looked, it only did that for local vars, and used offset for globals. </div><br /><br />to be honest i never looked  :tongue: <br /><br />now you're forcing me to look... if that is so then addr is smarter than i expected<br /><br />cheers,<br />jimmy :alright:</div>
    <div class="meta">Posted on 2004-02-17 19:55:45 by JimmyClif</div>
   </div>
   <div class="post" id="post-133967">
    <div class="subject"><a href="#post-133967">Cool</a></div>
    <div class="body">Thanks for the insight everybody. I've managed to figure out how to use API's in VB.NET which is the reason why I switched to Assembly(more than that). but I know I could do more with Assembly just by reading a few tutorials. It lets me get down to the nitty-gritty. I only used VB.NET due to college courses and that was a breeze so I'm up for another challenge.:alright:</div>
    <div class="meta">Posted on 2004-02-17 21:35:26 by akuma6099</div>
   </div>
   <div class="post" id="post-133978">
    <div class="subject"><a href="#post-133978">Whats the Difference???</a></div>
    <div class="body">Yes ADDR is replaced by OFFSET when the variable is not local but that is the only good thing about it. ADDR is dumb and should be considered a bug in MASM when used in an invoke, there are places for LEA, for example when moving a local address into a register but in invoke it screws with eax and that is just wrong. You can always use :<br /><br /><pre><code>Values&#58;<br />PUSH &#91;EBP-4&#93; ; Local DWORD 1<br />PUSH &#91;EBP-8&#93; ; Local DWORD 2<br />etc...<br /><br />Offsets&#58;<br />PUSH EBP<br />ADD &#91;ESP&#93;,-4 ; Offset local DWORD 1<br />PUSH EBP<br />ADD &#91;ESP&#93;,-8 ; Offset local DWORD 2 </code></pre><br /><br />There is no need to flub around with LEA and trash EAX for no good reason at all. Just try this:<br /><br /><pre><code>invoke GetDlgItem,&#91;hwnd&#93;,1001<br />invoke SendMessage,eax,WM_GETTEXT,256,ADDR buffer</code></pre><br /><br />and you'll see what I mean, it's just plain dumb.</div>
    <div class="meta">Posted on 2004-02-18 01:03:21 by donkey</div>
   </div>
  </div>
 </body>
</html>