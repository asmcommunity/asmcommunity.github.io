<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>String Library - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14344" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14344">String Library</a></p>
   <div class="post" id="post-110969">
    <div class="subject"><a href="#post-110969">String Library</a></div>
    <div class="body">I have put considerable work over the last week to develop a new OOP library structure, and here is the first Class library I have finished to make life with MASM simpler.<br /><br />Not only have i provided the Class file (CString.asm), but I have also provided a simple example showing 98% of the methods it offers.  I hope you can appreciate the simplicity it offers for programming in MASM.  As well there is full documentation of the library in HTML format.<br /><br />Check it out and give me you your thoughts, concerns, or ideas for other Classes like this.<br /><br />Enjoy!<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2003-07-17 23:57:09 by NaN</div>
   </div>
   <div class="post" id="post-110972">
    <div class="subject"><a href="#post-110972">String Library</a></div>
    <div class="body">Looks great at a first glance NaN, one extremely minor point (hardly worth mentioning), the CString.asm file has only line feeds no &lt;CR&gt;, makes for a single very long line in most editors. You can use wordpad to resave it with &lt;CR&gt;'s inserted.</div>
    <div class="meta">Posted on 2003-07-18 00:16:08 by donkey</div>
   </div>
   <div class="post" id="post-110973">
    <div class="subject"><a href="#post-110973">String Library</a></div>
    <div class="body">Dah!  I thought i was past that problem..  Its like a virus, and UltraEdit preserves it, silently behind the scenes.  I will convert them to standard DOS line feeds.<br /><br />Thanks for pointing this out!<br />:NaN:<br /><br /> <strong>Its fixed now...</strong> </div>
    <div class="meta">Posted on 2003-07-18 00:18:50 by NaN</div>
   </div>
   <div class="post" id="post-111004">
    <div class="subject"><a href="#post-111004">String Library</a></div>
    <div class="body">Great NAN!<br /><br />This helps out alot. <br />Look forward to your next projects!<br /><br /><br />:)</div>
    <div class="meta">Posted on 2003-07-18 06:19:15 by packetvb</div>
   </div>
   <div class="post" id="post-111083">
    <div class="subject"><a href="#post-111083">String Library</a></div>
    <div class="body">I dont really know what will be next.  I was kinda hoping people would have ideas to discuss...</div>
    <div class="meta">Posted on 2003-07-18 17:05:44 by NaN</div>
   </div>
   <div class="post" id="post-111182">
    <div class="subject"><a href="#post-111182">String Library</a></div>
    <div class="body">Hehe, prolly because it's so close to perfection.<br />Thanks for sharing, this makes things a lot easier :)</div>
    <div class="meta">Posted on 2003-07-19 12:09:07 by Ghirai</div>
   </div>
   <div class="post" id="post-111196">
    <div class="subject"><a href="#post-111196">String Library</a></div>
    <div class="body">No problem, i will be releasing another 'version' of the CString class.  I discovered out of necessity that it would be great to also have a method that will allow programmers create dynamicly sized buffers out of it.  <br /><br />API's like GetWindowText require a length and a string pointer.  It would be good to do something like &quot;CString.MakeBuffer, UserInputedLenght&quot; and have it return in eax the address to a buffer of what ever the length is at run time.<br /><br />Currently you probably most often use the stack for buffers, which require you to know ahead of time the maximum size of the buffer.  But for things like strings, you may not know the length until run time.  This is where such a method would be better tailored, since you dont have to impose restrictions on the program's use.. (ie. dont exceed 256 chars in the edit field of this dialog box).<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-07-19 16:13:27 by NaN</div>
   </div>
   <div class="post" id="post-111258">
    <div class="subject"><a href="#post-111258">String Library</a></div>
    <div class="body">I really like to have Insert,Delete,PatternMatch(like PathMatchSpec functio?n in shlwapi.dll) function in this class.Keep up the good work:alright:</div>
    <div class="meta">Posted on 2003-07-20 06:45:05 by LaptoniC</div>
   </div>
   <div class="post" id="post-111295">
    <div class="subject"><a href="#post-111295">String Library</a></div>
    <div class="body">You really need an insert function? You can do it like so...:<br /><pre><code><br />mov hNew, $EAX&#40; hString. CString.Left, InsertPoint &#41;<br />MEHTOD hNew, CString.CatString, szInsertStringPointer<br />mov hRight, $EAX&#40; hString. CString.Right, InsertPoint &#41;<br />METHOD hNew, CString.CatString, $EAX&#40;hRight, CString.GetAddr &#41;<br />METHOD hString, CString.UpdateString, $EAX&#40; hNew, CString.GetAddr &#41;<br />DESTROY hRight<br />DESTROY hNew<br /></code></pre><br /><br />Likewise to delete a section can be done:<pre><code><br />mov hNew, $EAX&#40; hString. CString.Left, DelStart &#41;<br />mov hRight, $EAX&#40; hString. CString.Right, DelEnd &#41;<br />METHOD hNew, CString.CatString, $EAX&#40;hRight, CString.GetAddr &#41;<br />METHOD hString, CString.UpdateString, $EAX&#40; hNew, CString.GetAddr &#41;<br />DESTROY hRight<br />DESTROY hNew<br /></code></pre><br /><br />I think your Path concern might be valid tho....  What are your thoughts?  Is this too much source to do on your own with the class??  Maybe im wrong here?<br /><br />At anyrate thanks for the suggestion! :alright:<br />:NaN</div>
    <div class="meta">Posted on 2003-07-20 13:27:28 by NaN</div>
   </div>
   <div class="post" id="post-112017">
    <div class="subject"><a href="#post-112017">String Library</a></div>
    <div class="body">Hi NaN,<br /><br />the first example I executed was CatString.exe and ........ it didn't work! Isn't this lib supposed to make our life easier? :) <br /><br />I built a debug version of this example and ... it worked! Very strange.<br /><br />Looking at the source:<br /><br /><pre><code><br />CStr_CatString_Funct  PROC uses edi esi ebx lpTHIS&#58;DWORD, lpsz&#58;DWORD<br />   SetObject edi, CString<br />   <br />   mov ebx, &#91;edi&#93;.szLength<br />   .if&#40; ebx &#41;<br />      .if&#40; lpsz &#41;<br />         xor esi, esi<br />         mov esi, $invoke&#40; StrLen, lpsz &#41;<br />         .if&#40; esi &#41;<br />            add ebx, esi<br />            add ebx, 4<br />            invoke GetProcessHeap<br />            invoke HeapReAlloc, eax, HEAP_ZERO_MEMORY, &#91;edi&#93;.pStrMem, ebx<br />            .if&#40; eax &#41;<br />               invoke szCatStr, eax, lpsz<br />               invoke StrLen, &#91;edi&#93;.pStrMem<br />               mov &#91;edi&#93;.szLength, eax<br />            .else<br />               xor eax, eax<br />            .endif<br />         .else<br />            xor eax, eax<br />         .endif<br />      .else<br /></code></pre><br /><br />My guess is that you  expect the memory pointer returned by HeapReAlloc to be the same as the one you supplied as parameter. Thats not true.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-07-27 08:17:34 by japheth</div>
   </div>
   <div class="post" id="post-112030">
    <div class="subject"><a href="#post-112030">String Library</a></div>
    <div class="body">Yes. This exactly what i expect.  And is what happens on my OS Win98SE.<br /><br />I f'n hate M$ and their vague a$$ B.S. when i comes to describing certain api's.  I specifically checked for this before i used the API and it gave me nothing to work with.  So i did tests and found it *did* return the same pointer on my machine.  Every time!.  This is all the API had to say<div class="quote">The HeapReAlloc function reallocates a block of memory from a heap. This function enables you to resize a memory block and change other memory block properties. The allocated memory is not movable. <br /><br />Return Value<br /><br />If the function succeeds, the return value is a pointer to the reallocated memory block. <br />If the function fails and you have not specified HEAP_GENERATE_EXCEPTIONS, the return value is NULL. <br />If the function fails and you have specified HEAP_GENERATE_EXCEPTIONS, the function may generate the following exceptions: <br /><br />Remarks<br /><br />If HeapReAlloc succeeds, it allocates at least the amount of memory requested. If the actual amount allocated is greater than the amount requested, the process can use the entire amount. To determine the actual size of the reallocated block, use the HeapSize function. <br />To free a block of memory allocated by HeapReAlloc, use the HeapFree function.</div><br /><br />Can others Test this example on your machines and tell me what your machine is, and what the result was (worked or didnt).  Thanks!<br /><br />As well i will redesign this section to avoid using M$'s api in this case.  And post it soon.<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-07-27 11:23:16 by NaN</div>
   </div>
   <div class="post" id="post-112064">
    <div class="subject"><a href="#post-112064">String Library</a></div>
    <div class="body">Hi NaN<br /><br />&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />As well i will redesign this section to avoid using M$'s api in this case. And post it soon.<br />&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br /><br />Dont exaggerate it. I would suggest just to save the new pointer in .pStrMem. <br /><br />If you think about the structure of a heap you may recognize that it is impossible to enlarge a memory block and keep its address in all cases. So it is quite normal in my eyes that address may change. You can avoid this change by setting flag HEAP_REALLOC_IN_PLACE_ONLY, but this surely wouldnt improve things.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-07-27 15:43:35 by japheth</div>
   </div>
  </div>
 </body>
</html>