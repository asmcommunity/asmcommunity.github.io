<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>display buffer in to a file using hex - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30607" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=30607">display buffer in to a file using hex</a></p>
   <div class="post" id="post-214709">
    <div class="subject"><a href="#post-214709">display buffer in to a file using hex</a></div>
    <div class="body">im using nasm.<br />if you see anything i can improve on ,please tell me im just learning assembly.<br /><br />i was told ; this won&#039;t be too useful... hex display better?<br />is it better and how do i display using hex instead?<br /><br />and is &quot;the art of assembly language&quot; the best book to use?<br />i cant find anything on whats the best way to copy the mbr to file <br />thanks all<br /><br /><pre><code><br />org 100h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; <br /><br />Start:<br /><br /><br /><br /><br /><br />;read mbr<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  dx,00h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;DX Data register&nbsp; ; read MBR of target drive<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;drive a=ooh,b=01h,80h=first hard drive.81h=second <br /><br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  cx,1h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;CX count register for string operations ; it&#039;s always the first sector<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  bx, buffer&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;BX index register for MOVE ; point to our buffer<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  ax, 0201h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;AX Accumulator/multiply/divide ; read one sector<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; int&nbsp; &nbsp;  13h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;13h is Drive Table<br />;file stuff<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  ah, 3Ch&nbsp; &nbsp; &nbsp; &nbsp;  ;create&nbsp; the file<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  cx, 0&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; lea&nbsp; &nbsp;  dx, &nbsp; ;Presume DS points at filename<br />&nbsp; &nbsp; &nbsp; &nbsp; int&nbsp; &nbsp;  21h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; segment.<br />&nbsp; &nbsp; &nbsp; &nbsp; jc stop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; don&#039;t continue if create failed!<br />&nbsp; &nbsp; &nbsp;  mov , ax<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />;put read from buffer here<br />; &quot;read from&quot;? you mean display it?<br />; this won&#039;t be too useful... hex display better?<br />&nbsp; &nbsp; &nbsp;  mov dx, buffer<br />&nbsp; &nbsp; &nbsp;  mov cx, 512<br />&nbsp; &nbsp; &nbsp;  mov bx, 1 ; stdout<br />&nbsp; &nbsp; &nbsp;  mov ah, 40h<br />&nbsp; &nbsp; &nbsp;  int 21h<br /><br /><br />;put write to file here<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; mov dx , buffer<br />&nbsp; &nbsp; &nbsp; &nbsp; mov cx, 512<br />&nbsp; &nbsp; &nbsp; &nbsp; mov bx, <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ah, 40h<br />&nbsp; &nbsp; &nbsp; &nbsp; int 21h<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  ah, 3eh&nbsp; &nbsp; &nbsp; &nbsp;  ;Close file<br />&nbsp; &nbsp; &nbsp; &nbsp; int&nbsp; &nbsp;  21h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp;  stop <br /><br />stop:<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  ax, 0x4C00&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; Terminate program<br />&nbsp; &nbsp; &nbsp; &nbsp; int&nbsp; &nbsp;  21h <br /><br />buffer times 512 db 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br /><br />Filename&nbsp; &nbsp; &nbsp; &nbsp;  db &#039;test.txt&#039;,0<br />handle&nbsp; &nbsp; &nbsp;  db&nbsp; 0<br /><br /><br /></code></pre></div>
    <div class="meta">Posted on 2011-07-25 11:01:26 by flyhigh427</div>
   </div>
  </div>
 </body>
</html>