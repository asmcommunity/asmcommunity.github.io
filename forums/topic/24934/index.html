<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>written a 32-byte hashing function. opinion wanted - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24934" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24934">written a 32-byte hashing function. opinion wanted</a></p>
   <div class="post" id="post-182354">
    <div class="subject"><a href="#post-182354">written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">Hi guys,<br /><br />I&#39;ve written a hashfunction which creates a 32-byte hash out of a password.<br />Are there any ways i can test it for collisions etc?<br />I want to implement this function in an encryption program i am writing, so all ideas are welcome!<br /><br />here&#39;s the function:<br /><pre><code><br />HashPassword proc inputpassword:DWORD, outputbuffer:DWORD<br />&nbsp; &nbsp; LOCAL pwsize:DWORD<br /><br />&nbsp; &nbsp; invoke lstrlen,inputpassword<br />&nbsp; &nbsp; .if eax==0<br />&nbsp; &nbsp; &nbsp; &nbsp; dec eax<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; .endif<br />&nbsp; &nbsp; mov pwsize,eax<br />&nbsp; &nbsp; xor eax,eax<br />&nbsp; &nbsp; push inputpassword<br />&nbsp; &nbsp; pop esi<br />&nbsp; &nbsp; mov al,byte ptr <br />&nbsp; &nbsp; mov ah,byte ptr <br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; mov al,byte ptr <br />&nbsp; &nbsp; mov ah,byte ptr <br />&nbsp; &nbsp; mov ecx,78277783<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; xor eax,2742303<br />&nbsp; &nbsp; mov ecx,20743729<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ecx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; mul edx<br />&nbsp; &nbsp; push outputbuffer<br />&nbsp; &nbsp; pop edi<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,10757<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ecx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; mul edx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,77392473<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; mov cx,word ptr <br />&nbsp; &nbsp; xor eax,ecx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; mov ecx,3297329<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; shl eax,3<br />&nbsp; &nbsp; mov ecx,579362<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ecx<br />&nbsp; &nbsp; xor ecx,ecx<br />&nbsp; &nbsp; mov cl,byte ptr <br />&nbsp; &nbsp; add eax,ecx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; add eax,edx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; xor eax,24704739<br />&nbsp; &nbsp; mov ecx,137<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; div ecx<br />&nbsp; &nbsp; add eax,edx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,13362972<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ecx<br />&nbsp; &nbsp; add eax,2739384<br />&nbsp; &nbsp; xor eax,edx<br />&nbsp; &nbsp; rol eax,3<br />&nbsp; &nbsp; sub eax,ecx<br />&nbsp; &nbsp; mov ecx,dword ptr <br />&nbsp; &nbsp; bswap ecx<br />&nbsp; &nbsp; xor eax,ecx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,dword ptr <br />&nbsp; &nbsp; sub eax,ecx<br />&nbsp; &nbsp; mov byte ptr ,al<br />&nbsp; &nbsp; xor byte ptr ,ah<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; mov ecx,1337927<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; xchg eax,ecx<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div cx<br />&nbsp; &nbsp; add eax,ecx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,dword ptr <br />&nbsp; &nbsp; xor eax,ecx<br />&nbsp; &nbsp; mul edx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; and eax,208343<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,dword ptr <br />&nbsp; &nbsp; xor eax,ecx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,dword ptr <br />&nbsp; &nbsp; xor ecx,12237492<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,dword ptr <br />&nbsp; &nbsp; xchg eax,ecx<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; mov ebx,231773<br />&nbsp; &nbsp; div ebx<br />&nbsp; &nbsp; shl edx,4<br />&nbsp; &nbsp; add eax,edx<br />&nbsp; &nbsp; xor eax,ecx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,dword ptr <br />&nbsp; &nbsp; bswap ecx<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; shr ecx,8<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ecx<br />&nbsp; &nbsp; xor ah,dl<br />&nbsp; &nbsp; xor al,dh<br />&nbsp; &nbsp; mov ecx,379<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; add eax,dword ptr <br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; mul ebx<br />&nbsp; &nbsp; add dword ptr ,eax<br />&nbsp; &nbsp; xor dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,2023855<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; xor dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,dword ptr <br />&nbsp; &nbsp; shl ecx,2<br />&nbsp; &nbsp; xor eax,ecx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ecx,pwsize<br />&nbsp; &nbsp; .if ecx&lt;2<br />&nbsp; &nbsp; &nbsp; &nbsp; xor eax,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; .endif<br />&nbsp; &nbsp; inc esi<br />&nbsp; &nbsp; dec ecx<br /><br />hashloop:<br />&nbsp; &nbsp; xor ebx,ebx<br />&nbsp; &nbsp; mov bl,byte ptr <br />&nbsp; &nbsp; mul ebx<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; push eax<br />&nbsp; &nbsp; mov eax,dword ptr <br />&nbsp; &nbsp; mov ebx,3027347<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ebx<br />&nbsp; &nbsp; pop ebx<br />&nbsp; &nbsp; add ebx,edx<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; add dword ptr ,eax<br />&nbsp; &nbsp; sub eax,27239<br />&nbsp; &nbsp; mov edx,dword ptr <br />&nbsp; &nbsp; bswap edx<br />&nbsp; &nbsp; mul edx<br />&nbsp; &nbsp; xor eax,edx<br />&nbsp; &nbsp; mov edx,dword ptr <br />&nbsp; &nbsp; xor eax,edx<br />&nbsp; &nbsp; mov dword ptr,eax<br />&nbsp; &nbsp; mov edx,dword ptr <br />&nbsp; &nbsp; xor eax,edx<br />&nbsp; &nbsp; mov ebx,2037275<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ebx<br />&nbsp; &nbsp; xor edx,dword ptr <br />&nbsp; &nbsp; xor eax,edx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; shr edx,4<br />&nbsp; &nbsp; mul edx<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; bswap ebx<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; mov ebx,984379<br />&nbsp; &nbsp; div ebx<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; add ebx,edx<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; sub eax,ecx<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword&nbsp; ptr ,eax<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; push ebx<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; xor ebx,ebx<br />&nbsp; &nbsp; mov bx,word ptr <br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ebx<br />&nbsp; &nbsp; pop ebx<br />&nbsp; &nbsp; xor ebx,edx<br />&nbsp; &nbsp; bswap ebx<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; add ebx,dword ptr <br />&nbsp; &nbsp; xchg ebx,eax<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; bswap ebx<br />&nbsp; &nbsp; mul ecx<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; sub ebx,dword ptr <br />&nbsp; &nbsp; add ebx,edx<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; mov dx,word ptr <br />&nbsp; &nbsp; mul edx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword ptr ,eax&nbsp;  <br />&nbsp; &nbsp; inc esi<br />&nbsp; &nbsp; dec ecx<br />&nbsp; &nbsp; jnz hashloop<br />&nbsp; &nbsp; xor eax,eax<br />&nbsp; &nbsp; ret<br />HashPassword endp</code></pre><br />I know it&#39;s a bit long, but i think it is could work.<br />I&#39;ve written a program around it which generates a hash + password to a file like:<br /><div class="quote"><br />a-&lt;hash&gt;<br />b-&lt;hash&gt;<br />...<br />aa-&lt;hash&gt;<br />ab-&lt;hash&gt;<br />...<br />aaa-&lt;hash&gt;<br />...<br />zzzz-&lt;hash&gt;<br /></div><br />I&#39;ve did this until <strong>zzzz</strong>. Then i&#39;ve imported the complete textfile (part by part) into an excel file with 1 DWORD value per cel. <br />Then i sorted all hashes per dword and checked if in any place there were 2 and the same dword values. in 65535 different hashes no one dword value in one row is the same.<br />So this should be promising.<br /><br />Attached you will find the source for a file which prints the hash to StdOut and takes a password as commandline parameter.<br />Any ideas, comments on the alghoritm are highly appreciated since i&#39;m still pretty new to cryptography.<br /><br />Thanks in advance.<br /><br />Kind regards,<br /><br />Mark</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1731" target="_blank">hashpassword.asm</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-06-22 11:21:14 by white scorpion</div>
   </div>
   <div class="post" id="post-182355">
    <div class="subject"><a href="#post-182355">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">It would appear, then, that you do not need to worry about collisions.<br /><br />Paul</div>
    <div class="meta">Posted on 2006-06-22 11:27:12 by PBrennick</div>
   </div>
   <div class="post" id="post-182360">
    <div class="subject"><a href="#post-182360">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">Hey,<br /><br />how is it going?<br />How did the surgery went? I hope you are fine!<br /><br />As for the algo, i&#39;ve tested it with 65535 different hashes at a time. However, i am unable to test all the hashes that can be created and therefore unable to know what the collision rate would be.<br />I know that for every hash in md5 you should have 3-4 different passwords (if i remember correctly).<br />I&#39;m wondering what that would be in this case and how one would calculate that.<br /></div>
    <div class="meta">Posted on 2006-06-22 13:48:33 by white scorpion</div>
   </div>
   <div class="post" id="post-182363">
    <div class="subject"><a href="#post-182363">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">There is a great page (got this from Mark Larson over at the other place a few years back) about hash functions... take a look at:<br /><br /><a target="_blank" href="http://burtleburtle.net/bob/hash/doobs.html">http://burtleburtle.net/bob/hash/doobs.html</a><br /><br />Not sure it will help you here, but for furture reference, it might help.<br /><br />Ossa</div>
    <div class="meta">Posted on 2006-06-22 14:40:08 by Ossa</div>
   </div>
   <div class="post" id="post-182378">
    <div class="subject"><a href="#post-182378">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">Thanks, it&#39;s an interesting read indeed. But like you said, i haven&#39;t got a clue how to apply it here.<br />I don&#39;t really care about speed since it only has to hash once for every password / file that is encrypted.<br />So if the hash would take 0.2 or 0.9 seconds to complete isn&#39;t really important.<br /><br />The first function i created for this wasn&#39;t a hash function and made the same output for &#39;a&#39; as for &#39;aa&#39; as for &#39;aaa&#39; etc.<br />This one doesn&#39;t.<br />The result of a-z is this:<br /><div class="quote"><br />a-4476e474:05da931d:28dabc1e:d3f962f9:af94fb7f:d7d2ade8:7495cd20:1c5c539b<br />b-d3b976b6:59a80a92:d8a82389:47a5d2e6:33f2459a:de88be46:05068d0a:5be1d559<br />c-aa44b116:e8f0464d:66f07402:bf9167ef:f8e45263:665edb6e:db31ce46:807e97d9<br />d-aff47384:744bcfe3:fb4bd081:8af8b2ba:3b695720:f8f96321:2f9c3b67:baea0fb8<br />e-ccb4f218:245c8825:175cad64:7d6704b3:f3ba7214:11f90f8c:2155161a:759a8257<br />f-45a453b1:a317b596:0517b0ce:ffa48ff4:a7053225:faf79e04:36300e37:78c6885c<br />g-85cfc506:aa0a951f:5c0a9d5c:b155e0ea:2575d59b:5ccc75be:620e9722:8f686559<br />h-b566f49c:ebd831fc:7bd8117b:b7e23169:c426935a:7b040f13:f6f18ace:12eecb21<br />i-a9b463d1:e7e863af:d4e86870:602ac62a:0a93c89d:d57cae6a:bb9fda67:419c99fa<br />j-5e3bf9b0:966d7cb7:776d7ada:4087d43b:bbc14888:74ad08bd:bd5f1eb9:bd93c79f<br />k-fb22139e:d315425a:a3154eb2:a8b871ad:93b888be:5ca1af73:75f59f12:bb20dca0<br />l-b43d63d4:03304ed1:dc3060c1:111cce64:9743175b:d8399ca9:8bbf2f0b:dfe142de<br />m-0d5ef6e0:a7775863:75776eaa:5044ec79:4b0229e6:73bf77f6:a11018a5:2dbc6f2b<br />n-42d4dc50:460293de:7402a589:a173422b:60bce9ae:74333246:2361f44e:5c5348bf<br />o-ee13a0f8:aab6a839:b3b690bf:6fdce2ea:ab54ecf5:b61d2570:a5b8b249:b54a6af1<br />p-0644b1f8:b1be9edc:b9beae5a:b4da3fac:6c93284b:bbdc6101:13f37487:c64aeeb3<br />q-72ecf3e4:03677b09:76677405:c78b2f54:fa50f7df:749918ed:edb4c67c:d9ed056b<br />r-ac180a78:2eebf354:87ebd5de:299bb2eb:a6bd7039:862dfcaa:b063c94a:dad04887<br />s-80752c52:64d5d7f8:6cd5ffb3:93e339b7:bd2e9aef:6da172cf:ef5826fb:e9c1da2d<br />t-6758a266:e5210867:11211af9:52405578:4eb03490:11a6f1d5:0c3bafc9:bb843b9a<br />u-3de9dc43:52f856df:29f87b12:be64ce37:369c88ad:d694e08b:c326dbd3:0ec353d8<br />v-f5d474b0:cf6fa883:af6fbd60:0fcafc47:f4c89680:accf7585:23976332:1da041d7<br />w-6d648ba0:a15135f2:17513808:8175e3f9:b4359647:16bed0be:aca665cf:8041d52f<br />x-ea946baa:775f3ba1:705f32f9:2dc0f2b9:6ab4f2f3:74272e4f:45ee2083:403428f0<br />y-7d03f6c8:5ae70b5b:e0e7236e:d8c00be3:a0ff570d:e040f044:ee74f91d:c9d676ba<br />z-cccbacc8:2be707ce:66e71762:aab4e850:5fed60e2:678702df:47aec6ff:d68732c8</div><br /><br />The result of a string of the same characters (a - aaaaaaaaaa) is also quite nice:<br /><div class="quote"><br />a-4476e474:05da931d:28dabc1e:d3f962f9:af94fb7f:d7d2ade8:7495cd20:1c5c539b<br />aa-0f19b52d:cfefc12c:db8108f8:25e44704:c76e1a2f:9726c3ef:c870a0d5:74baf800<br />aaa-4b0164ca:c603d377:20e56799:45c1dd5c:a1e6f32c:0cd47a46:c723b2fd:663143f2<br />aaaa-2a4e51be:8456ee1a:d1b2b3dc:e29e488a:37e43f93:db155800:c96c7f6b:05113a7e<br />aaaaa-0b2c2074:2ce44ec0:a376d69b:4f1ddd2c:fa92edeb:5358ddbb:f4762eb6:4b1bf436<br />aaaaaa-7eae3c89:b30529c1:e2fd5063:fc4bcd88:e3f8cb46:a83c75ef:81cc1f8f:4ea344b7<br />aaaaaaa-61725811:d4666307:59b4ee4e:dc922c9f:3ad23a99:21c1fda0:8344c6c2:4e053da9<br />aaaaaaaa-0ea590e0:2112b794:c710033d:64ef7ebf:2202702a:13200547:bb384220:59be6b51<br />aaaaaaaaa-905edc08:b9df2837:8abbf100:27acffe4:4864a2d4:73d86205:aa8acf08:d8e1d60c<br />aaaaaaaaaa-c90c4863:4a06ef6e:4ae9ec07:2ca30e86:a6efa5eb:f351c386:89f60d1e:fa58e138<br /></div><br /><br />I&#39;ve added the : sign between every dword so it is more easy to import them to excel or compare them one dword at a time.<br />As you can see the result looks promising (IMO), but i&#39;m still not sure how to test it to be absolutely sure.<br />The biggest thing i&#39;m worried about is that this hash is going to be the input of a function which generates a double byte stream to pick bytes out of a table file which are used to XOR the bytes in a plaintext file.<br />It would be useless if there are too many passwords generating the same hash, since it would weaken the complete program.<br /></div>
    <div class="meta">Posted on 2006-06-23 00:19:59 by white scorpion</div>
   </div>
   <div class="post" id="post-182393">
    <div class="subject"><a href="#post-182393">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">Remember that there&#39;s two categories of hashes. One is used for hash table lookups etc., and the main focus on those is speed, while having a fairly low amount of collisions.<br /><br />The other category is cryptographically secure hashes, where you need to have as few collisions as possible, and avoid a number of other problems. Speed doesn&#39;t matter nearly as much as security.<br /><br />It sounds like you&#39;re trying to construct a secure hash. My advice would be: don&#39;t, and use one of the existing algorithms that have been attacked to death by everybody and their dog.<br /><br />Also for collision testing, it&#39;s sortof useless to test on strings like that. Google and download some dictionaries for various languages and see what happens on those.<br /></div>
    <div class="meta">Posted on 2006-06-23 06:50:16 by f0dder</div>
   </div>
   <div class="post" id="post-182408">
    <div class="subject"><a href="#post-182408">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">I&#39;m indeed writing a secure hash, and i already was advised not to write one on my own, but i still want to write one on my own.<br />The complete program will be fully written in my code, no code is borrowed from anyone (except the GUI part).<br />I know i will probably end up spending a whole lot of time optimizing the alghoritms, but&nbsp; IMO it&#39;s worth the result.<br />I will use some dictionary files to run through the program, that&#39;s no problem, but when i do have the hashes in a file, how do i compare so many hashes?<br />Excel is worthless, i already noticed that. <br />Do you have any ideas for this?<br /><br /> </div>
    <div class="meta">Posted on 2006-06-23 11:53:49 by white scorpion</div>
   </div>
   <div class="post" id="post-182409">
    <div class="subject"><a href="#post-182409">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body"><div class="quote"><br />I&#39;m indeed writing a secure hash, and i already was advised not to write one on my own, but i still want to write one on my own.<br /></div><br />:) - it&#39;s an interesting project, but I wouldn&#39;t trust myself to write a secure hash before doing a LOT of research.<br /><br /><div class="quote"><br />I will use some dictionary files to run through the program, that&#39;s no problem, but when i do have the hashes in a file, how do i compare so many hashes?<br />Excel is worthless, i already noticed that. <br />Do you have any ideas for this?<br /></div><br />Good question, really.<br /><br />Perhaps looking at the entropy of the output list of hashes is a good idea? Also, try sorting the {input,hash} pairs by {hash} - if it looks like some items are sorted by {input}, then the hash isn&#39;t good.<br /><br />Hm.<br /></div>
    <div class="meta">Posted on 2006-06-23 12:04:18 by f0dder</div>
   </div>
   <div class="post" id="post-182503">
    <div class="subject"><a href="#post-182503">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">That&#39;s the idea behind it, but how would i write a program that can handle that many items to sort?<br />excel can handle 65535 different items and thats not sufficient.<br />I think i would need a whole lot of memory, or an (almost) endless loop to sort such a thing.<br />Any ideas?<br /></div>
    <div class="meta">Posted on 2006-06-26 00:33:46 by white scorpion</div>
   </div>
   <div class="post" id="post-182510">
    <div class="subject"><a href="#post-182510">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">It takes about 50 seconds to sort 10^7 dwords using Shellsort on 933mhz PIII. With a faster algo and cpu it would be possible to sort in a reasonable time pretty larger number of hashes. The problem will be checking all those values visually afterwards.&nbsp; :shock:<br /><br />As for writing the program.. Here is one solution: <br />Allocate two blocks of memory. Put all the string you want to hash in the first block. Hash a string and put the hash value along with a pointer to the original string in the second block. Sort the hashes while moving the pointer accordingly. Obviously you&#39;ll need to implement some progie to display the result (breaking the second block into smaller parts could help). </div>
    <div class="meta">Posted on 2006-06-26 08:45:26 by arafel</div>
   </div>
   <div class="post" id="post-182512">
    <div class="subject"><a href="#post-182512">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">Thanks for the explanation, but i just realized that the windows sort program should be able to help me sort them.<br />Indeed, the manual checking will be a pain in the butt, but it&#39;s worth it...<br />I&#39;ll let you know the results.<br /><br /></div>
    <div class="meta">Posted on 2006-06-26 12:28:53 by white scorpion</div>
   </div>
   <div class="post" id="post-182516">
    <div class="subject"><a href="#post-182516">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">There&#39;s a really good website for sorting algorithms, they&#39;re in java, but that&#39;s an easy enough syntax to grasp, even if you don&#39;t know the language itself.<br />http://www.cs.ubc.ca/~harrison/Java/sorting-demo.html<br /><br />This details many different sorting algorithms, and even gives a visual representation of them, and their comperative speeds, also note that these speeds are much slower than they would be without any visual representation. The Fast Quick Sort on that page is the fastest sort algo they have there, and it&#39;s pretty damned fast, so if you want to speed up the sorting thyere, you should definately look into using that algo.<br /><br />http://en.wikipedia.org/wiki/Sort_algorithm#Quicksort gives some nice information regarding what exactly you&#39;re doing, and what the ideal speed of a quicksort is.<br /><br />http://en.wikipedia.org/wiki/Big_O_notation explains the notation of O(log n) and the other efficiancy info there.</div>
    <div class="meta">Posted on 2006-06-26 13:59:29 by Bobbias</div>
   </div>
   <div class="post" id="post-182520">
    <div class="subject"><a href="#post-182520">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">Thanks, i will check them some other time.<br />I&#39;ve used the windows sort function which took about 15 minutes to sort a 3.4GB file, so that&#39;s sufficient for now.<br /><br />I just tested the hash extensively with a lot of words.<br /><br />Here&#39;s what i did:<br /><br />i&#39;ve downloaded every dictionary from http://www.picozip.com/prt/index.html<br />I&#39;ve added all the dictionaries together to one big dictionary. Total size: 49MB<br /><br />I have to say i had to build on extra check into the hash because with 1 inputted word the result was a devide by 0 which crashed the program.<br />After the updated code i ran the following tests:<br /><br />I wrote a program which would hash every word in that dictfile and outputted it to <br />another file in the format &lt;hash&gt;-&lt;word&gt;<br /><br />a total of 4,485,600 words (3.4GB file!)<br />Then i sorted the complete file using the windows sort.exe tool by hash.<br /><br />After this i wrote another program which compared every line to the next.<br />-if they are the same then skip the line.<br />-if they are not the same, then compare only the hash.<br />-if hashes match then print them to stdout.<br /><br />This resulted in 0 double hashes.<br /><br />So in this case you would say that with 4,5 million tested passwords the hash is quite nice ;)<br /></div>
    <div class="meta">Posted on 2006-06-26 16:14:50 by white scorpion</div>
   </div>
   <div class="post" id="post-182521">
    <div class="subject"><a href="#post-182521">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">Wow, sounds like your hash is shaping up quite nicely.</div>
    <div class="meta">Posted on 2006-06-26 17:14:14 by Bobbias</div>
   </div>
   <div class="post" id="post-182547">
    <div class="subject"><a href="#post-182547">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">Yes indeed.<br />I needed a way to use the inputted password for generating a stream of pseudo random dwords to pick bytes from the table file.<br />The first one i wrote was a simple additional function:<br />&#39;passwordpasswordpasswordpass&#39; etc...<br />of course this wasn&#39;t sufficient so i decided to write something else, which is this function.<br />I never tried to make it this efficient, but as time progresses it might be worth doing so. :D</div>
    <div class="meta">Posted on 2006-06-27 02:01:13 by white scorpion</div>
   </div>
   <div class="post" id="post-182593">
    <div class="subject"><a href="#post-182593">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">Anyone has any other ideas to test the alghoritm?<br />Any input is welcome since i&#39;m fresh out of ideas...<br /></div>
    <div class="meta">Posted on 2006-06-28 10:03:39 by white scorpion</div>
   </div>
   <div class="post" id="post-182637">
    <div class="subject"><a href="#post-182637">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">What about &quot;reversing&quot; the hash? </div>
    <div class="meta">Posted on 2006-06-29 02:47:48 by roticv</div>
   </div>
   <div class="post" id="post-182642">
    <div class="subject"><a href="#post-182642">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">IMO that&#39;s not possible, at least not completely since some bytes are dropped during the calculations which makes you miss some parts.<br /><br />But even if it would be possible, for the use of the hash in my program that doesn&#39;t matter since the hash will never be known.<br /></div>
    <div class="meta">Posted on 2006-06-29 10:28:10 by white scorpion</div>
   </div>
   <div class="post" id="post-184135">
    <div class="subject"><a href="#post-184135">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">little late on the reply, but ...<br /><br />couple of things i&#39;d do:<br /><br />1. give c/pseudo code for the hash function<br />2. track byte changes through the algorithm<br />3. try all common attack vectors on your algorithm (google for them)<br />4. post your algorithm for public review<br />5. prepare submission for NIST hashing comp: http://www.csrc.nist.gov/pki/HashWorkshop/index.html<br />6. profit :)<br /><br />i think the most intersting steps will be to publish the algorithm in c form and let others consider the possibility of reveresing it.</div>
    <div class="meta">Posted on 2006-07-30 20:18:52 by abc123</div>
   </div>
   <div class="post" id="post-184140">
    <div class="subject"><a href="#post-184140">Re: written a 32-byte hashing function. opinion wanted</a></div>
    <div class="body">There is a div by zero exception if i try to hash the password &quot;aaaapjyd&quot;<br /><br /><pre><code>hashloop:<br />&nbsp; &nbsp; xor ebx,ebx<br />&nbsp; &nbsp; mov bl,byte ptr <br />&nbsp; &nbsp; mul ebx<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; push eax<br />&nbsp; &nbsp; mov eax,dword ptr <br />&nbsp; &nbsp; mov ebx,3027347<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ebx<br />&nbsp; &nbsp; pop ebx<br />&nbsp; &nbsp; add ebx,edx<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; add dword ptr ,eax<br />&nbsp; &nbsp; sub eax,27239<br />&nbsp; &nbsp; mov edx,dword ptr <br />&nbsp; &nbsp; bswap edx<br />&nbsp; &nbsp; mul edx<br />&nbsp; &nbsp; xor eax,edx<br />&nbsp; &nbsp; mov edx,dword ptr <br />&nbsp; &nbsp; xor eax,edx<br />&nbsp; &nbsp; mov dword ptr,eax<br />&nbsp; &nbsp; mov edx,dword ptr <br />&nbsp; &nbsp; xor eax,edx<br />&nbsp; &nbsp; mov ebx,2037275<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ebx<br />&nbsp; &nbsp; xor edx,dword ptr <br />&nbsp; &nbsp; xor eax,edx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; shr edx,4<br />&nbsp; &nbsp; mul edx<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; bswap ebx<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword ptr ,eax<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; mov ebx,984379<br />&nbsp; &nbsp; div ebx<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; add ebx,edx<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; bswap eax<br />&nbsp; &nbsp; sub eax,ecx<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; mov dword&nbsp; ptr ,eax<br />&nbsp; &nbsp; mov ebx,dword ptr <br />&nbsp; &nbsp; push ebx<br />&nbsp; &nbsp; xor eax,ebx<br />&nbsp; &nbsp; xor ebx,ebx<br />&nbsp; &nbsp; mov bx,word ptr <br />&nbsp; &nbsp; xor edx,edx<br />&nbsp; &nbsp; div ebx	&nbsp; &nbsp; &lt;-- exception occures here</code></pre></div>
    <div class="meta">Posted on 2006-07-31 03:32:28 by mr.schyte</div>
   </div>
  </div>
 </body>
</html>