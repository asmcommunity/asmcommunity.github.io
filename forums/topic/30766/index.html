<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>32 and 16 bit 400 character File to Picture program - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30766" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=30766">32 and 16 bit 400 character File to Picture program</a></p>
   <div class="post" id="post-215423">
    <div class="subject"><a href="#post-215423">32 and 16 bit 400 character File to Picture program</a></div>
    <div class="body">Hey,<br /><br />This program takes a 400 character, one per line, file and converts it to a color coded picture. Is there any way. Is there anything I can do to tidy this up?<br /><br /><pre><code><br />TITLE MASM Template						(main.asm)<br /><br />; Description:<br />; <br />; Revision date:<br /><br />INCLUDE Irvine32.inc<br />.data<br />num DWORD ?<br />;;;;;;;;;;;;;;;;;;;;;;;INSTRUCTIONS;;;;;;;;;;;;;;;;;;;;;;;<br />; Input: File - 400 numbers, one per line from&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;<br />;&nbsp; &nbsp; &nbsp; &nbsp; the following list (0, 1, 2, 4, 6, 7)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;<br />; NOTE: In the line below (filename BYTE &quot;pix.txt&quot;,0)&nbsp; &nbsp; ;<br />;&nbsp; &nbsp; &nbsp;  edit pix.txt to the filename you want to input.&nbsp; ;<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;<br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br /><br /><br />filename BYTE &quot;pix.txt&quot;,0<br /><br /><br /><br /><br /><br />fileHandle DWORD ?<br />col BYTE 1<br />row BYTE 1<br />counter DWORD 0<br /><br />.code<br />main PROC<br /><br /><br />;Open the file<br />&nbsp; mov edx,OFFSET filename<br />&nbsp; call OpenInputFile<br />&nbsp; mov fileHandle,eax<br /><br />&nbsp; ;call writewindowsmsg<br /><br /><br />top:<br /><br />mov eax,counter<br />cmp eax,400<br />je finish<br /><br />mov eax,0<br />mov al,col<br />cmp al,21<br />je newrow<br /><br />back:<br /><br />;Read a character<br />&nbsp; mov edx,offset num<br />&nbsp; mov ecx,1<br />&nbsp; mov eax,fileHandle<br />&nbsp; call readfromfile<br />&nbsp; mov eax,num<br />&nbsp; <br />&nbsp; cmp eax,48<br />&nbsp; je blackc<br /><br />&nbsp; cmp eax,49<br />&nbsp; je bluec<br /><br />&nbsp; cmp eax,50<br />&nbsp; je greenc<br /><br />&nbsp; cmp eax,52<br />&nbsp; je redc<br /><br />&nbsp; cmp eax,54<br />&nbsp; je yellowc<br /><br />&nbsp; cmp eax,55<br />&nbsp; je whitec<br />&nbsp; <br />&nbsp; here:<br /><br />;Read a character<br />&nbsp; mov eax,fileHandle<br />&nbsp; mov edx,offset num<br />&nbsp; mov ecx,1<br />&nbsp; call readfromfile<br /><br /><br />&nbsp; ;Read a character<br />&nbsp; mov eax,fileHandle<br />&nbsp; mov edx,offset num<br />&nbsp; mov ecx,1<br />&nbsp; call readfromfile<br /><br />inc counter<br /><br />jmp top<br /><br />blackc:<br /> mov dh,row<br /> mov dl,col<br /> call gotoxy<br /> inc col<br /> mov ax,00000000b<br /> call settextcolor<br /> mov al,&#039; &#039;<br /> call writechar<br /> jmp here<br /><br /> bluec:<br /> mov dh,row<br /> mov dl,col<br /> call gotoxy<br /> inc col<br /> mov ax,00010001b<br /> call settextcolor<br /> mov al,&#039; &#039;<br /> call writechar<br /> jmp here<br /><br /> greenc:<br /> mov dh,row<br /> mov dl,col<br /> call gotoxy<br /> inc col<br /> mov ax,10101010b<br /> call settextcolor<br /> mov al,&#039; &#039;<br /> call writechar<br /> jmp here<br /><br /> redc:<br /> mov dh,row<br /> mov dl,col<br /> call gotoxy<br /> inc col<br /> mov ax,11001100b<br /> call settextcolor<br /> mov al,&#039; &#039;<br /> call writechar<br /> jmp here<br /><br /> yellowc:<br /> mov dh,row<br /> mov dl,col<br /> call gotoxy<br /> inc col<br /> mov ax,11101110b<br /> call settextcolor<br /> mov al,&#039; &#039;<br /> call writechar<br /> jmp here<br /><br /> whitec:<br /> mov dh,row<br /> mov dl,col<br /> call gotoxy<br /> inc col<br /> mov ax,11111111b<br /> call settextcolor<br /> mov al,&#039; &#039;<br /> call writechar<br /> jmp here<br /><br />newrow:<br /> inc row<br /> mov col,1<br /> jmp back<br /><br /><br />finish:<br /><br />	mov eax,fileHandle<br />		call CloseFile<br /><br />	exit<br />main ENDP<br /><br />END main<br /></code></pre><br /><br /><pre><code><br />TITLE First 16-bit Program					(main.asm)<br /><br />; Description:<br />; <br />; Revision date:<br /><br />INCLUDE Irvine16.inc<br /><br />.data<br />infile BYTE &quot;pix.txt&quot;,0<br />infp WORD ?<br />num BYTE 0<br />counter WORD ?<br />col BYTE 1<br />row BYTE 1<br /><br />.code<br />main PROC<br />	mov ax,@data<br />	mov ds,ax&nbsp; &nbsp; &nbsp; ;these two lines required for 16-bit programs<br /><br />	; open an input file for reading<br />	mov ah,3dh<br />	mov al,0<br />	mov dx,offset infile<br />	int 21h<br />	jc quit<br />	mov infp,ax<br /><br />top:<br /> mov ah,02h<br /> mov bh,0<br /> mov dh,row<br /> mov dl,col<br /> int 10h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /><br /> mov ax,0<br /><br /> mov al,col<br /> cmp al,20<br /> je newrow<br /><br /> back:<br /><br /> mov ax,0<br /> mov al,num<br /><br /> cmp al,48<br /> je blackc<br /><br /> cmp al,49<br /> je bluec<br /><br /> cmp al,50<br /> je greenc<br /><br /> cmp al,52<br /> je redc<br /><br /> cmp al,54<br /> je yellowc<br /><br /> cmp al,55<br /> je whitec<br /> <br />blackc:<br /> mov ah,09h<br /> mov al,&#039; &#039;<br /> mov bh,0<br /> mov bl,00000000b<br /> mov cx,1<br /> int 10h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> inc col<br /> mov ax,counter<br /> inc counter<br /> cmp ax,399<br /> jne top<br /> jmp done<br /><br />bluec:<br /> mov ah,09h<br /> mov al,&#039; &#039;<br /> mov bh,0<br /> mov bl,00010001b<br /> mov cx,1<br /> int 10h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> inc col<br /> mov ax,counter<br /> inc counter<br /> cmp ax,399<br /> jne top<br /> jmp done<br /><br />greenc:<br /> mov ah,09h<br /> mov al,&#039; &#039;<br /> mov bh,0<br /> mov bl,10101010b<br /> mov cx,1<br /> int 10h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> inc col<br /> mov ax,counter<br /> inc counter<br /> cmp ax,399<br /> jne top<br /> jmp done<br /><br />redc:<br /> mov ah,09h<br /> mov al,&#039; &#039;<br /> mov bh,0<br /> mov bl,11001100b<br /> mov cx,1<br /> int 10h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> inc col<br /> mov ax,counter<br /> inc counter<br /> cmp ax,399<br /> jne top<br /> jmp done<br /><br />yellowc:<br /> mov ah,09h<br /> mov al,&#039; &#039;<br /> mov bh,0<br /> mov bl,11101110b<br /> mov cx,1<br /> int 10h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> inc col<br /> mov ax,counter<br /> inc counter<br /> cmp ax,399<br /> jne top<br /> jmp done<br /><br />whitec:<br /> mov ah,09h<br /> mov al,&#039; &#039;<br /> mov bh,0<br /> mov bl,11111111b<br /> mov cx,1<br /> int 10h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> ; read one byte from the file<br /> mov ah,3fh<br /> mov bx,infp<br /> mov cx,1<br /> mov dx,offset num<br /> int 21h<br /> inc col<br /> mov ax,counter<br /> inc counter<br /> cmp ax,399<br /> jne top<br /> jmp done<br /><br />;makes new row, sets col to 0<br />newrow:<br />inc row<br />mov col,0<br />jmp back<br /><br /><br /><br /> done:<br /><br />	;close the file<br />	;mov ah,3eh<br />	;mov bx,infp<br />	;int 21h<br />	;jc quit<br /><br /><br />quit:<br />	mov ah,2<br />		mov dl,&#039;-&#039;<br />		;int 21h<br /><br />		call crlf<br /><br />		mov ah,4ch&nbsp; ; terminate process<br />		mov al,0&nbsp; &nbsp; ; return code<br />		int 21h<br />main ENDP<br /><br /><br />END main<br /></code></pre><br /><br />Thanks in advance...<br /><br />-mallard</div>
    <div class="meta">Posted on 2011-11-27 20:05:15 by msmallard</div>
   </div>
  </div>
 </body>
</html>