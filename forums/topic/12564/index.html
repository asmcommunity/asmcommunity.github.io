<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Iczelion tutorial conversion problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12564" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=12564">Iczelion tutorial conversion problem</a></p>
   <div class="post" id="post-97235">
    <div class="subject"><a href="#post-97235">Iczelion tutorial conversion problem</a></div>
    <div class="body">I am trying to convert the text output tutorial but I am having trouble. I believe it has something to do with the macro that is used in the source. I am not to familiar with HLA macros. <br /><br /><pre><code> <br />program Textdemo; <br /><br />#include &#40;&quot;..\include\win.inc&quot;&#41; <br />#include &#40;&quot;..\include\kernel32.hhf&quot;&#41;<br />#include &#40;&quot;..\include\user32.hhf&quot;&#41;<br />#include &#40;&quot;..\include\gdi32.hhf&quot;&#41;<br /><br />#asm<br />	<br />	includelib \masm32\lib\kernel32.lib <br />	includelib \masm32\lib\user32.lib 			<br />	<br />#endasm<br /><br />readonly <br /><br />	ClassName 	&#58; string &#58;= &quot;SimpleWinClass&quot;;<br />	AppName   	&#58; string &#58;= &quot;Our First Window&quot;; 	<br />	TestString  &#58; string &#58;=  &quot;Win32 assembly is great and easy!&quot;;<br />	FontName 	&#58; string &#58;= &quot;script&quot;; <br />	<br />static <br /><br />	hInstance &#58; dword &#58;= 0; 	<br />	CommandLine &#58; string; <br /><br /><br /><br />macro RGB&#40; red, green, blue &#41;;<br /><br />	xor&#40; eax, eax &#41;;<br />	mov&#40; blue, ah &#41;;<br />	shl&#40; 8, eax &#41;;<br />	mov&#40; green, ah &#41;;<br />	mov&#40; red, al &#41;;<br />	<br />endmacro;	<br /><br />procedure WinMain &#40; hInst &#58; dword; hPrevInst &#58; dword; CmdLine &#58; dword; CmdShow &#58; dword &#41;; @forward; <br />procedure WndProc &#40; lParam&#58;dword; wParam&#58;dword; uMsg&#58;dword; hwnd&#58;dword &#41;;@forward; <br /><br />procedure WinMain &#40; hInst &#58; dword; hPrevInst &#58; dword; CmdLine &#58; dword; CmdShow &#58; dword &#41;; <br /><br />var <br /><br />	wc &#58; WNDCLASSEX; <br />	msg &#58; MSG; <br />	hwnd &#58; dword;<br /><br />begin WinMain; 	<br /> 	<br /> 	pushad&#40;&#41;; <br />	mov &#40; @size&#40; WNDCLASSEX &#41;, wc.cbSize &#41;; <br />	mov &#40; CS_HREDRAW | CS_VREDRAW , wc.style &#41;; <br />	mov &#40; &amp;WndProc, wc.lpfnWndProc &#41;; <br />	mov &#40; 0, wc.cbClsExtra &#41;; <br />	mov &#40; 0, wc.cbWndExtra &#41;; <br />	mov &#40; hInstance, wc.hInstance &#41;; <br />	LoadIcon &#40; 0, IDI_APPLICATION &#41;; <br />	mov &#40; eax, wc.hIconSm &#41;; <br />	mov &#40; eax, wc.hIcon &#41;; <br />	LoadCursor &#40; 0, IDC_ARROW &#41;; <br />	mov &#40; eax, wc.hCursor &#41;; <br />	mov &#40; COLOR_WINDOW + 1  , wc.hbrBackground &#41;; <br />	mov &#40; ClassName, wc.lpszClassName &#41;; <br />	mov &#40; 0, wc.lpszMenuName &#41;; <br />	<br />	RegisterClassEx &#40; lea &#40; wc, eax &#41;&#41;; <br />	<br />	CreateWindowEx<br />	&#40;<br />		0, <br />		ClassName, <br />		AppName, <br />		WS_OVERLAPPEDWINDOW, <br />		CW_USEDEFAULT, <br />		CW_USEDEFAULT,<br />		CW_USEDEFAULT,<br />		CW_USEDEFAULT,<br />		0,<br />		0,<br />		hInstance, <br />		0<br />	&#41;; 			<br />	<br />	mov &#40; eax, hwnd &#41;; <br />	<br />	ShowWindow &#40; hwnd, SW_SHOWNORMAL &#41;; <br />	UpdateWindow &#40; hwnd &#41;; <br />	<br />	lea &#40; msg, edi &#41;; <br />	<br />	while &#40; GetMessage &#40; edi , 0, 0, 0 &#41; &lt;&gt; 0 &#41; do <br />	<br />		TranslateMessage &#40; edi &#41; ; <br />		DispatchMessage &#40; edi &#41;; <br />	<br />	endwhile; 			<br />	<br />	mov &#40; msg.wParam, eax &#41;; <br />	popad&#40;&#41;;<br />	<br />end WinMain;<br /><br />procedure WndProc &#40; lParam&#58;dword; wParam&#58;dword; uMsg&#58;dword; hwnd&#58;dword &#41;;<br />	@nodisplay;<br />var <br />	hdc  &#58; dword; <br />	ps 	 &#58; PAINTSTRUCT; 	<br />	hfont &#58; dword;  <br /><br />begin WndProc; <br /><br />	if &#40; uMsg = WM_DESTROY &#41; then<br /><br />		PostQuitMessage &#40; NULL &#41;; <br />	<br />	elseif &#40; uMsg = WM_PAINT &#41; then <br />	<br />		pushad&#40;&#41;; <br />		<br />		lea &#40; rect, edi &#41;; <br />		lea &#40; ps, esi &#41;; <br />		<br />		BeginPaint&#40; hwnd, esi &#41;; <br />		mov &#40; eax, hdc &#41;; <br />		<br />		CreateFont &#40; 24,16,0,0,400,0,0,0,OEM_CHARSET,<br />                            OUT_DEFAULT_PRECIS,CLIP_DEFAULT_PRECIS,<br />                            DEFAULT_QUALITY,DEFAULT_PITCH | FF_SCRIPT,<br />                            FontName &#41;; <br />                            <br />		SelectObject &#40; hdc, eax &#41;; <br />			 <br />		mov    &#40; eax, hfont &#41;; 			 <br />		<br />		RGB    &#40; 200,200,50 &#41;;<br />		<br />		SetTextColor &#40; hdc ,eax &#41;; 		<br />		 <br />		RGB    &#40; 0,0,255 &#41;; 		<br />		<br />		SetBkColor &#40; hdc,eax &#41;; <br />		TextOut &#40; hdc,0,0,TestString,@size&#40;TestString&#41;&#41;; <br />		SelectObject&#40; hdc, hfont &#41;; <br />		EndPaint &#40; hWnd, esi &#41;; <br />		<br />		popad&#40;&#41;; 	<br />	<br />	else<br /><br />		DefWindowProc &#40; hwnd, uMsg, wParam, lParam &#41;; <br />		exit WndProc ; <br /><br />	endif;<br />	<br />	xor &#40; eax, eax &#41;; 	<br /><br />end WndProc; <br /><br />begin Textdemo; <br />	<br />	GetModuleHandle &#40; 0 &#41;; <br />	mov &#40; eax, hInstance &#41;; <br />	GetCommandLine&#40;&#41;; <br />	mov &#40; eax, CommandLine &#41;; 	 <br />	WinMain &#40; hInstance, 0, CommandLine, SW_SHOWNORMAL &#41;; 	<br />	ExitProcess &#40; NULL &#41;; 	<br /><br />end Textdemo;<br /><br /></code></pre> <br /><br />When I compile these are the errors I get <br /><br />Error in file &quot;text.hla&quot; at line 29 :<br />Expected ':', encountered 'RGB'<br />(Possible undefined ID).<br />Near: &lt;&lt; RGB &gt;&gt;<br /><br />Error in file &quot;text.hla&quot; at line 29 :<br />Undefined symbol.<br />Near: &lt;&lt; RGB &gt;&gt;<br /><br />Error in file &quot;text.hla&quot; at line 39 :<br />Expected ';', encountered ')'.<br />Near: &lt;&lt; ) &gt;&gt;<br /><br />Error in file &quot;text.hla&quot; at line 137 :<br />Expected ':', encountered '('<br />(Possible undefined ID 'RGB').<br />Near: &lt;&lt; ( &gt;&gt;</div>
    <div class="meta">Posted on 2003-04-16 07:21:14 by Odyssey</div>
   </div>
   <div class="post" id="post-97339">
    <div class="subject"><a href="#post-97339">Iczelion tutorial conversion problem</a></div>
    <div class="body">Hi Odyssey,<br /><br />just try this macro with &quot;#&quot; signs:<br /><br /><br />#macro RGB( red, green, blue );<br /><br />	xor( eax, eax );<br />	mov( blue, ah );<br />	shl( 8, eax );<br />	mov( green, ah );<br />	mov( red, al );<br />	<br />#endmacro;</div>
    <div class="meta">Posted on 2003-04-16 16:05:33 by Green Joe</div>
   </div>
   <div class="post" id="post-97374">
    <div class="subject"><a href="#post-97374">Iczelion tutorial conversion problem</a></div>
    <div class="body">Hi Odyssey,<br /><br />There were several minor errors in your translation of Itz tutorial that prevent it compile successfully.<br />I did some small revisions and now it's OK.</div>
    <div class="meta">Posted on 2003-04-16 20:22:44 by Green Joe</div>
   </div>
   <div class="post" id="post-97402">
    <div class="subject"><a href="#post-97402">Iczelion tutorial conversion problem</a></div>
    <div class="body">Thanks Green Joe. i appreciate the help. Only problem is I don't get to terminate the other bugs myself.</div>
    <div class="meta">Posted on 2003-04-16 23:02:26 by Odyssey</div>
   </div>
  </div>
 </body>
</html>