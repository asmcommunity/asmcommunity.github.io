<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>how to enable progress bar in ftp transmission? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20216" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20216">how to enable progress bar in ftp transmission?</a></p>
   <div class="post" id="post-154827">
    <div class="subject"><a href="#post-154827">how to enable progress bar in ftp transmission?</a></div>
    <div class="body">How would you enable a progress bar in an ftp transmission?  Would it be via InternetRead()... so many bytes to a buffer and write, or get the disk size, calculate and run a side thread counting down as the file comes or goes across?</div>
    <div class="meta">Posted on 2004-12-26 22:32:06 by drarem</div>
   </div>
   <div class="post" id="post-154829">
    <div class="subject"><a href="#post-154829">how to enable progress bar in ftp transmission?</a></div>
    <div class="body">There is a callback that allows you to set a progress bar, you can use the <a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wininet/wininet/internetsetstatuscallback.asp">InternetSetStatusCallback</a> and have the callback increment the progress bar as the file is being transferred.</div>
    <div class="meta">Posted on 2004-12-26 22:44:53 by donkey</div>
   </div>
   <div class="post" id="post-154854">
    <div class="subject"><a href="#post-154854">how to enable progress bar in ftp transmission?</a></div>
    <div class="body">thanks</div>
    <div class="meta">Posted on 2004-12-27 08:37:46 by drarem</div>
   </div>
   <div class="post" id="post-154868">
    <div class="subject"><a href="#post-154868">how to enable progress bar in ftp transmission?</a></div>
    <div class="body">This is another part to this question:<br /><br />what about keeping the GUI responsive? All I need is to let the user know the app is still alive and display progress bar - do I repaint the screen?<br /><br />Thanks.</div>
    <div class="meta">Posted on 2004-12-27 14:27:15 by drarem</div>
   </div>
   <div class="post" id="post-154869">
    <div class="subject"><a href="#post-154869">how to enable progress bar in ftp transmission?</a></div>
    <div class="body">Not sure how your app is structured, generally when I find that the GUI is unresponsive I run the intensive part in a thread if I think it's going to take a while. Not sure if that would be a good idea for ftp transfers though.</div>
    <div class="meta">Posted on 2004-12-27 15:00:48 by donkey</div>
   </div>
   <div class="post" id="post-154990">
    <div class="subject"><a href="#post-154990">how to enable progress bar in ftp transmission?</a></div>
    <div class="body">thanks for your help, I have the progress bar going - if I don't do anything the progress displays fine, but if I overlay the dialog with another window, eg force a WM_PAINT message in the app, there is a rectangle of white across the face of the dialogbox until the ftp send/receive is done and the progress is no longer displayed (updated).<br /><br /><br />How can I refresh the views/windows when it gets to the WM_PAINT point?  I am using InternetReadFile/WriteFile, sending and receiving chunks of data at a time in a buffer and using the SB_SETPOS for the progress bar.<br /><br />I tried the other way - using internetsetstatuscallback - can't seem to update the dialog either using it during the transmission. I think it's more of a window repainting issue I need to deal with.<br /><br />Any suggestions?</div>
    <div class="meta">Posted on 2004-12-29 16:12:43 by drarem</div>
   </div>
   <div class="post" id="post-154999">
    <div class="subject"><a href="#post-154999">how to enable progress bar in ftp transmission?</a></div>
    <div class="body">It sounds like you need a DoEvents type pause that can allow you window to process any messages that might be pending. You might try to PeekMessage when you enter the callback to see if there are any pending WM_PAINT messages then if there are allow the Window to do it's job and wait till it's done.</div>
    <div class="meta">Posted on 2004-12-29 20:24:35 by donkey</div>
   </div>
  </div>
 </body>
</html>