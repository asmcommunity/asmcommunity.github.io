<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>code for refreshing windows desktop - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=11029" />
  <link rel="prev" href="../?id=11029&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=11029">code for refreshing windows desktop</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=11029&amp;page=1" style="">&laquo;</a><a href="../?id=11029&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="11029" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-83234">
    <div class="subject"><a href="#post-83234">Main::How to refresh the windows desktop</a></div>
    <div class="body">Of course I did a WM_KEYUP too. I've even set the other bits in lParam according to what<br />the API reference tells me. Does not work.<br /><br />Other things I've tried that didn't work:<br /><br /><ul><br />[*]SystemParametersInfo() with SPI_SETDESKPATTERN (causing Windows read the <strong>Pattern=</strong> line of WIN.INI)<br />[*]SystemParametersInfo() with SPI_SETSCREENSAVEACTIVE with TRUE, and then called again with FALSE (I thought it will activate the screensaver for some milliseconds, but it doesn't ... Also, WM_SYSCOMMAND with SC_SCREENSAVE can only activate it)<br />[*]SendMessage() with WM_SYSCOMMAND and SC_MAXIMIZE<br />[*]SendMessage() with WM_SYSCOMMAND and SC_RESTORE (Note: use SC_MINIMIZE on the Desktop and you will crash in kernel32 :grin: )<br />[*]SendMessage() with WM_COMMAND and WM_REFRESH_DESKTOP (EQU 0A065h)<br />[*]www.google.com :grin: ... gave me a few links to experts-exchange.com but nothing helpful<br /><br /><br />Houston, we have ... :grin:<br /><br />&lt;EDIT&gt;<br />Ah, finally I found it:<br /><br /><pre><code>invoke SHChangeNotify, SHCNE_ASSOCCHANGED, SHCNF_FLUSH, NULL, NULL</code></pre><br /><br />Updates all desktop items immediately.<br />&lt;/EDIT&gt;<br /><br /><br />aweX &lt;-</div>
    <div class="meta">Posted on 2003-02-23 01:44:57 by aweX</div>
   </div>
   <div class="post" id="post-83236">
    <div class="subject"><a href="#post-83236">Main::How to refresh the windows desktop</a></div>
    <div class="body">Thanks, <strong>aweX</strong> - added to snippet collection! :alright:<br /><br /><a target="_blank" href="http://www.madwizard.org/snippets/index.php">http://www.madwizard.org/snippets/index.php</a></div>
    <div class="meta">Posted on 2003-02-23 02:15:28 by bitRAKE</div>
   </div>
   <div class="post" id="post-83241">
    <div class="subject"><a href="#post-83241">Main::How to refresh the windows desktop</a></div>
    <div class="body">Hmm, why is my name aweX aweX in the archive?<br /><br />Also, I think this thread is a candidate for the FAQ section list of this board.</div>
    <div class="meta">Posted on 2003-02-23 02:57:24 by aweX</div>
   </div>
   <div class="post" id="post-83293">
    <div class="subject"><a href="#post-83293">Main::How to refresh the windows desktop</a></div>
    <div class="body"><div class="quote"><br />Hmm, why is my name aweX aweX in the archive?</div><strong>Thomas</strong> designed the snippet library so it requires a first and last name.  If you register then I can change it to your handle, or I could change it to your full name right now.</div>
    <div class="meta">Posted on 2003-02-23 11:23:37 by bitRAKE</div>
   </div>
   <div class="post" id="post-83309">
    <div class="subject"><a href="#post-83309">Main::How to refresh the windows desktop</a></div>
    <div class="body">I fixed your name on the snippet, it's aweX only once now :)<br /><br />Thomas</div>
    <div class="meta">Posted on 2003-02-23 12:49:19 by Thomas</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=11029&amp;page=1" style="">&laquo;</a><a href="../?id=11029&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="11029" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>