<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>how do most encription algos work??? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7039" />
  <link rel="prev" href="../?id=7039&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=7039">how do most encription algos work???</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=7039&amp;page=1" style="">&laquo;</a><a href="../?id=7039&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="7039" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-51102">
    <div class="subject"><a href="#post-51102">how do most encription algos work???</a></div>
    <div class="body">Your experience with the older machine is probably because RC6 uses<br />MULtiplication...</div>
    <div class="meta">Posted on 2002-07-31 16:33:50 by f0dder</div>
   </div>
   <div class="post" id="post-51103">
    <div class="subject"><a href="#post-51103">how do most encription algos work???</a></div>
    <div class="body"><div class="quote"><br />Your experience with the older machine is probably because RC6 uses<br />MULtiplication... </div><br />yep, that's what i thought, too. there are a few imul instructions in my code ;)</div>
    <div class="meta">Posted on 2002-07-31 16:39:52 by Tola</div>
   </div>
   <div class="post" id="post-51512">
    <div class="subject"><a href="#post-51512">how do most encription algos work???</a></div>
    <div class="body">Here I made a little  test with a simple algorithm, that you can change. As the program is now, it is not very secure for encryption, although it can protect your text messages from your little sister. :grin:</div>
    <div class="meta">Posted on 2002-08-03 12:58:25 by CodeLover</div>
   </div>
   <div class="post" id="post-159138">
    <div class="subject"><a href="#post-159138">Re: how do most encription algos work???</a></div>
    <div class="body">I wrote rc4 wrapper code (uses microsofts implementation) and it&#39;s just for strings.<br /><br /><pre><code>;==============================================================================<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Rc4.asm&nbsp; -&nbsp; description<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  -------------------<br />;&nbsp; &nbsp; begin&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :Mon October 20 14:26:03 IDT 2004<br />;&nbsp; &nbsp; copyright&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :Webring (C) 2004<br />;&nbsp; &nbsp; email&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :Webring@email.com<br />;	 website&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :http://Webring.funpic.de<br />;&nbsp; &nbsp; about&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; :Rc4 wrapper code based off Microsofts implementation;<br />;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  :currently only string example<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;FIXED by upb,thanks alot man<br />;==============================================================================<br /><br />.386<br />.model flat, stdcall<br />option casemap:none<br />include \Masm32\include\windows.inc<br />include \Masm32\include\kernel32.inc<br />include&nbsp; \Masm32\include\user32.inc<br />include&nbsp; \Masm32\include\advapi32.inc<br />includelib \Masm32\lib\kernel32.lib<br />includelib&nbsp; \Masm32\lib\user32.lib<br />includelib&nbsp; \Masm32\lib\advapi32.lib<br /><br /><br />Rc4 proto :DWORD,:DWORD,:DWORD,:DWORD<br />HandleError proto :DWORD <br /><br />ZeroTerm MACRO cSize:REQ<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .code<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov ecx,cSize<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov byte ptr , 0<br />&nbsp; &nbsp;  ENDM<br />&nbsp; &nbsp;  <br />.const <br />;All const&#39;s have been takin out of wincrypt.h<br />ALG_CLASS_DATA_ENCRYPT&nbsp;  equ 24576<br />ALG_CLASS_HASH&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  equ 32768<br />ALG_TYPE_ANY&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  equ 0<br />ALG_TYPE_BLOCK&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  equ 1536<br />ALG_TYPE_STREAM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equ 2048<br />ALG_SID_RC2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equ 2<br />ALG_SID_RC4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equ 1<br />ALG_SID_MD5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equ 3<br />CALG_MD5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  equ ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_MD5<br />CALG_RC4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  equ ALG_CLASS_DATA_ENCRYPT Or ALG_TYPE_STREAM Or ALG_SID_RC4<br />PROV_RSA_FULL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equ 1<br />CRYPT_NEWKEYSET&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equ 8h<br /> <br />.data<br />MS_PROV&nbsp; &nbsp; db &quot;Microsoft Base Cryptographic Provider v1.0&quot;,0 ;my box not support enhanced =\<br />Cryptkey&nbsp;  db &quot;Joshua&quot;,0 ; fyi is #1 most used backdoor pass of *all time ;)<br />mydata&nbsp; &nbsp;  db &quot;UbEr 133Ness&quot;,0<br />dTitle&nbsp; &nbsp;  db &quot;After Decrypted&quot;,0<br />eTitle&nbsp; &nbsp;  db &quot;After Encrypted&quot;,0<br />rTitle&nbsp; &nbsp;  db &quot;Before Encrypted&quot;,0<br /><br />;error handling<br />CACHerror&nbsp; &nbsp;  db &quot;CryptAcquireContext&quot;,0<br />CCHerror&nbsp; &nbsp; &nbsp; db &quot;CryptCreateHash&quot;,0<br />CHDHerror&nbsp; &nbsp;  db &quot;CryptHashData&quot;,0<br />CDKHerror&nbsp; &nbsp;  db &quot;CryptDeriveKey&quot;,0<br />CDHHerror&nbsp; &nbsp;  db &quot;CryptDestroyHash&quot;,0<br />GAHerror&nbsp; &nbsp; &nbsp; db &quot;GlobalAlloc&quot;,0<br />GLHHerror&nbsp; &nbsp;  db &quot;GlobalLock&quot;,0<br />CEHHerror&nbsp; &nbsp;  db &quot;CryptEncrypt&quot;,0<br />CDEHHerror&nbsp; &nbsp; db &quot;CryptDecrypt&quot;,0<br />GUHHerror&nbsp; &nbsp;  db &quot;GlobalUnlock&quot;,0<br />CDEKHHerror&nbsp;  db &quot;CryptDestroyKey&quot;,0<br />GFHHerror&nbsp; &nbsp;  db &quot;GlobalFree&quot;,0<br />KeyContainerName db &quot;leetcrypt&quot;, 0<br /><br /><br />.data?<br />lKey&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd ?<br />lHash&nbsp; &nbsp; &nbsp; &nbsp;  dd ?<br />bufL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd ?<br />dataL		&nbsp; dd ?<br />crypted		&nbsp; dd ?<br />decrypted	&nbsp; dd ?<br />OldKeyL&nbsp; &nbsp; &nbsp;  dd ?<br />NewBuf&nbsp; &nbsp; &nbsp; &nbsp; dd ?<br />NewBuf2&nbsp; &nbsp; &nbsp;  dd ?<br />cspHAND&nbsp; &nbsp; &nbsp;  dd ?<br />contain&nbsp; &nbsp; &nbsp;  db ?<br />cryptedSize	&nbsp; dd ?<br />decryptedSize dd ?<br />tight db 512 dup(?)<br /><br /><br />.code<br />start:<br />invoke MessageBox, NULL,addr mydata, addr rTitle,MB_ICONINFORMATION<br /><br />invoke lstrlen, addr mydata<br />mov	cryptedSize, eax<br /><br />invoke Rc4, addr Cryptkey, addr mydata, 1, addr cryptedSize ;encrypt<br />mov	crypted, eax<br />ZeroTerm(cryptedSize)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; zero terminate for MessageBox&nbsp; &nbsp; 	<br /><br />invoke MessageBox, NULL, crypted, addr eTitle, MB_ICONINFORMATION<br />push	cryptedSize<br />pop		decryptedSize<br /><br />; [====================================]<br />invoke Rc4,addr Cryptkey, crypted, 0, addr decryptedSize ;decrypt<br />mov		decrypted, eax<br />ZeroTerm(decryptedSize)&nbsp; &nbsp; &nbsp; &nbsp;  ; zero terminate for MessageBox		<br /><br />invoke MessageBox, NULL, decrypted, addr dTitle, MB_ICONINFORMATION<br />invoke ExitProcess,0<br /><br /><br />;if an error occures a MessageBox with the api function name as the title and an description will appear<br />Rc4 proc lpKey, lpSource, lpType, lpSize<br />invoke CryptAcquireContext, addr cspHAND, NULL, NULL, PROV_RSA_FULL, 0 ;Get handle to the default provider. <br />.if eax!=TRUE<br />invoke HandleError,addr CACHerror<br />.endif<br /><br />invoke CryptCreateHash,cspHAND,CALG_MD5,0,0,addr lHash ;Create a hash object<br />.if eax!=TRUE<br />invoke HandleError,addr CCHerror<br />.endif<br /><br />invoke lstrlen,lpKey<br />mov OldKeyL,eax	<br /><br />invoke CryptHashData,lHash, lpKey,OldKeyL, 0<br />.if eax!=TRUE<br />invoke HandleError,addr CHDHerror<br />.endif<br /><br /><br />invoke CryptDeriveKey,cspHAND,CALG_RC4, lHash, 0 ,addr lKey <br />.if eax!=TRUE<br />invoke HandleError,addr CDKHerror<br />.endif<br /><br />invoke CryptDestroyHash,lHash <br />.if eax!=TRUE<br />invoke HandleError,addr CDHHerror<br />.endif<br /><br />;invoke	lstrlen, lpSource<br />mov	&nbsp; &nbsp; esi, lpSize<br />mov		eax, dword ptr <br />mov		bufL, eax<br />add		bufL, 129			; just to be sure<br /><br />invoke GlobalAlloc,GMEM_MOVEABLE,bufL<br />.if eax==NULL<br />invoke HandleError,addr GAHerror<br />.endif<br /><br />mov NewBuf,eax<br /><br />invoke GlobalLock,NewBuf<br />.if eax==NULL<br />invoke HandleError,addr GLHHerror<br />.endif<br />mov NewBuf2,eax<br /><br />; copy data to be encrypted<br />mov		esi, lpSource<br />mov		edi, NewBuf2<br />mov		ecx, lpSize<br />mov		ecx, dword ptr <br />rep	movsb<br /><br /><br />cmp lpType,0&nbsp; ;Check whether to en/decrypt<br />je @F<br /><br />	invoke CryptEncrypt,lKey, 0, 1, 0, NewBuf2, lpSize, bufL<br />	.if eax!=TRUE<br />	invoke HandleError,addr CEHHerror<br />	.endif<br />	jmp cleanup<br /><br />@@:<br /><br />	invoke CryptDecrypt,lKey, 0, 1, 0, NewBuf2, lpSize<br />	.if eax!=TRUE<br />	invoke HandleError,addr CDEHHerror<br />	.endif<br /><br />cleanup:<br /><br />invoke CryptDestroyKey,lKey<br />.if eax!=TRUE<br />invoke HandleError,addr CDEKHHerror<br />.endif<br /><br />; write other cleanup stuff urself<br /><br />mov		eax, NewBuf2<br />ret<br />Rc4 endp<br /><br /><br /><br /><br />;Handle error<br />HandleError proc lpTitle:DWORD <br />LOCAL MsgBuf:LPVOID<br />mov cx,SUBLANG_DEFAULT <br />shl ecx,10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />lea edx, MsgBuf&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />invoke GetLastError&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />invoke FormatMessage,FORMAT_MESSAGE_ALLOCATE_BUFFER or FORMAT_MESSAGE_FROM_SYSTEM,NULL,eax,ecx,edx,0,NULL&nbsp; &nbsp; &nbsp; &nbsp; <br />invoke MessageBox, NULL, MsgBuf,lpTitle,MB_OK or MB_ICONSTOP <br />invoke LocalFree,MsgBuf<br />invoke ExitProcess,0<br />ret <br />HandleError endp <br /><br />end start</code></pre><br /><br /><br />I&#39;ve tried <strong>comrads</strong> pure code rc4 example on various versions of windows, but couldn&#39;t get it to work. Btw <strong>f0dder</strong> why don&#39;t you lay off the constant follow up attacks at <strong>hutch</strong> everytime the man posts somthing. </div>
    <div class="meta">Posted on 2005-04-18 11:23:58 by Webring</div>
   </div>
   <div class="post" id="post-159206">
    <div class="subject"><a href="#post-159206">Re: how do most encription algos work???</a></div>
    <div class="body">I don&#39;t know a great deal about encryption, but it&#39;s a lot of math.<br /><br />Essentially, encryption algorithms work on computationally hard problems.&nbsp; I&#39;m not familiar with elliptic curves, so I don&#39;t know the math behind those (though I do want to learn!).&nbsp; RSA, for example, is strong because the only way to break it (as far as anyone knows) is to factor a very large integer, which is no easy task.&nbsp; Others use the difficulty of finding discrete logarithms, etc.<br /><br />That doesn&#39;t always mean basing an encryption scheme on computationally hard problem will work.&nbsp; For instance, there was an encryption algorithm based on the knapsack problem, which is NP complete in the general case.&nbsp; However the encryption was found to be breakable (if I recall, due to the fact it used a superincreasing set of weights, so it wasn&#39;t a general case).</div>
    <div class="meta">Posted on 2005-04-21 11:52:57 by Miko</div>
   </div>
   <div class="post" id="post-159211">
    <div class="subject"><a href="#post-159211">Re: how do most encription algos work???</a></div>
    <div class="body">Encryption (including cryptographic hashes) is fascinating, and the attacks invented to break algorithms are done by some very clever heads.<br /><br />I hope the following isn&#39;t in contradiction with the board rules. It&#39;s meant as some things to consider when implementing encryption algorithms, so you don&#39;t get the stuff wrong.<br /><br />MD5, a widely used secure hash algorithm, has received a lot of analysis because the use is so widespread - including guarding unix passwords on a lot of systems. There were some attacks, mostly theoretic though... and then came the rainbow tables (google around) - these make attacks *practical*, although they require a lot of memory and disk space for the tables.<br /><br />The TEA encryption algorithm had a number of weak implementations - I think it wasn&#39;t until the 3rd try they &quot;got it right&quot;. It&#39;s still not the most secure algorithm, but it&#39;s small and simple. The SafeDisc protection system used TEA encryption - but it had a <strong>number</strong> of flaws in the way it used it. Iirc, it only used half the possible keysize, and that fact combined with the knowledge that PE sections aligned to peheader.filealign (and padded with zero-bytes), it was possible to quickly bruteforce the key and remove the encryption (there were other methods as well, but the interesting one in this context is of course the cryptographic attack).<br /><br />RSA is generally pretty annoying to factor, because of the use of big primes. There are a number of ways to break it, though... there&#39;s been a lof of problems with weak generation algorithms used - basically if a software user has seeded the random number generator with time(NULL) (ie, the system time), and the RNG being used is known (like, if a well-known cryptographic library has been used), the attacker has some idea which time range the key has been generated in, and can use this information to attack only a subset of the possible keys. This way RSA-1024 (iirc) has been broken, I believe the private keys for signing asprotect programs was found for some version? The method used when a key can&#39;t be factored within reasonable time, is to patch the key in the executable, and write a new key generator using this set of {private, public} key.<br /><br />RC4 has had some attacks too. The algorithm has been used in things like SSL, and has been broken.<br /><br />The latest appliance of breaking hashes, will be used to pollute the edonkey2000 network. Rather than foiling pirates by movie/game companies releasing a lot of fake releases (which can be identified on &quot;release verifier&quot; sites, and waste a lot of bandwidth), they can upload bogus chunks *with matching hashes* - this way the fake releases are very hard to detect, and you will end up with a corrupted download without really being able to tell what parts are wrong. This is of course fixable by the p2p community by moving to stronger hashes, which will enevitably happen.<br /><br />By the way, have a look at this URL: http://www.asiertech.com/secondary/cracked.htm<br /></div>
    <div class="meta">Posted on 2005-04-21 15:38:14 by f0dder</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=7039&amp;page=1" style="">&laquo;</a><a href="../?id=7039&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="7039" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>