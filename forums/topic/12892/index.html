<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>weird COM structure definition (part 2) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12892" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=12892">weird COM structure definition (part 2)</a></p>
   <div class="post" id="post-100061">
    <div class="subject"><a href="#post-100061">weird COM structure definition (part 2)</a></div>
    <div class="body">Hi all COM guru's ;)<br /><br />Does someone have the asm version of the &quot;PROPSPEC&quot; &amp; &quot;PROPVARIANT&quot; structures ???<br />I've just read random thread but......... ;)<br /><br />tx for your help....</div>
    <div class="meta">Posted on 2003-04-29 09:17:49 by PhoBos</div>
   </div>
   <div class="post" id="post-100238">
    <div class="subject"><a href="#post-100238">weird COM structure definition (part 2)</a></div>
    <div class="body">I'm not a COM guru but I'll try<pre><code>PROPSPEC STRUCT<br />    ulKind      DD ?<br />    UNION<br />        propid  DD ?<br />        lpwstr  DD ?<br />    ENDS<br />PROPSPEC ENDS</code></pre>PROPVARIANT is rather big to convert :rolleyes: so... :)<br /><br />I suggest you play this on C using<pre><code>printf&#40;&quot;%d&quot;, sizeof&#40;X&#41;&#41;;</code></pre>where X is the data type. And don't forget pointers(*) are always DD, Float is REAL4 or DD, Double is Real8 or DQ....<pre><code>PROPVARIANT STRUCT<br />    vt                  DW ?<br />    wReserved1          DW ?<br />    wReserved2          DW ?<br />    wReserved3          DW ?<br />    UNION<br />        cVal            DB ?<br />        bVal            DB ?<br />        iVal            DW ?<br />        uiVal           DW ?<br />        lVal            DD ?<br />        intVal          DW ?<br />        ulVal           DW ?<br />        uintVal         DW ?<br />        hVal            LARGE_INTEGER&lt;&gt;<br />        ;uhVal           ULARGE_INTEGER&lt;&gt;<br />        fltVal          REAL4 ?<br />        dblVal          REAL8 ?<br />        ;cyVal           CY&lt;&gt;<br />        ;date            DATE&lt;&gt;<br />        bstrVal         DD ?<br />        boolVal         DW ?<br />        scode           DD ?<br />        filetime        FILETIME&lt;&gt;<br />        pszVal          DD ?<br />        pwszVal         DD ?<br />        <br />    ENDS<br />PROPVARIANT ENDS</code></pre>here's my incomplete version, it's rather long but I have other things to do. :)</div>
    <div class="meta">Posted on 2003-04-29 22:49:38 by arkane</div>
   </div>
   <div class="post" id="post-100295">
    <div class="subject"><a href="#post-100295">Thanks!!!!!</a></div>
    <div class="body">a big thank you tu you arkane !!  :alright: <br />i will end this up !</div>
    <div class="meta">Posted on 2003-04-30 07:10:14 by PhoBos</div>
   </div>
  </div>
 </body>
</html>