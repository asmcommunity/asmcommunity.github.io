<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>System Resources - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4804" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4804">System Resources</a></p>
   <div class="post" id="post-33678">
    <div class="subject"><a href="#post-33678">System Resources</a></div>
    <div class="body">How do you get System/User/GDI resource values?<br /><br />I've used the GlobalMemoryStatus function to retrieve the MemoryStatus structure, and it gives the dwMemoryLoad percentage (subtracted from 100 gives the resource available)..but it differs from the other resource monitors I have (Windows and Norton..which always agree). <br /><br />And besides, this method doesn't give seperate values for User or GDI resources.</div>
    <div class="meta">Posted on 2002-04-16 06:42:04 by gscundiff</div>
   </div>
   <div class="post" id="post-33703">
    <div class="subject"><a href="#post-33703">System Resources</a></div>
    <div class="body">Found this in one of my helper apps (kinda like an archiver).<br /><br /><pre><code><br />Const GFSR_SYSTEMRESOURCES = 0<br />Const GFSR_GDIRESOURCES = 1<br />Const GFSR_USERRESOURCES = 2<br />Private Declare Function GetFreeResources Lib &quot;RSRC32&quot; Alias &quot;_MyGetFreeSystemResources32@4&quot; &#40;ByVal lWhat As Long&#41; As Long<br />Private Sub Form_Load&#40;&#41;<br />    Me.AutoRedraw = True<br />    'get resource information<br />    Me.Print &quot;Free System Resources&#58; &quot; + CStr&#40;GetFreeResources&#40;GFSR_SYSTEMRESOURCES&#41;&#41; + &quot;%&quot;<br />    Me.Print &quot;Free GDI Resources&#58; &quot; + CStr&#40;GetFreeResources&#40;GFSR_GDIRESOURCES&#41;&#41; + &quot;%&quot;<br />    Me.Print &quot;Free User Resources&#58; &quot; + CStr&#40;GetFreeResources&#40;GFSR_USERRESOURCES&#41;&#41; + &quot;%&quot;<br />End Sub<br /></code></pre><br /><br />GL<ul><br /></div>
    <div class="meta">Posted on 2002-04-16 12:02:22 by Graebel</div>
   </div>
   <div class="post" id="post-33731">
    <div class="subject"><a href="#post-33731">System Resources</a></div>
    <div class="body">Hi Graebel,<br /><br />I've seen a similar scheme on a couple of listings in Delphi and VB while Googling. I guess I just don't understand how to go about implementing/translating any of it into Masm.<br /><br />I was hoping to find an API or some structure that would give me something to work with but haven't run across any yet.</div>
    <div class="meta">Posted on 2002-04-16 16:52:32 by gscundiff</div>
   </div>
   <div class="post" id="post-33841">
    <div class="subject"><a href="#post-33841">System Resources</a></div>
    <div class="body">OK (after a WILD night at work..and thinking a little clearer)..<br /><br />Thanks to Graebel, I looked into RSRC32.DLL and see the function _MyGetFreeSystemResources32@4. I'll play with that for awhile now !</div>
    <div class="meta">Posted on 2002-04-17 09:13:48 by gscundiff</div>
   </div>
   <div class="post" id="post-33960">
    <div class="subject"><a href="#post-33960">System Resources</a></div>
    <div class="body">Can anyone offer some clues on how to access the function _MyGetFreeSystemResources32@4 in RSRC32.DLL ?</div>
    <div class="meta">Posted on 2002-04-18 13:59:10 by gscundiff</div>
   </div>
   <div class="post" id="post-33980">
    <div class="subject"><a href="#post-33980">System Resources</a></div>
    <div class="body">Yeah, I would like to see that as well hehe.  I was always a little in the dark on how Masm32 was including system DLLs.  In other languages I can explicitly see the calls to some load function.  Here its just a mystery so far.<br /><br />Wish I could give you the answer gscundiff (beyond what API they used)... :rolleyes:</div>
    <div class="meta">Posted on 2002-04-18 17:12:57 by Graebel</div>
   </div>
   <div class="post" id="post-34032">
    <div class="subject"><a href="#post-34032">System Resources</a></div>
    <div class="body">Hi Graebel,<br /><br />Guess I opened up a can o worms...after looking at this:<br /><br /><a target="_blank" href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q190217">http://support.microsoft.com/default.aspx?scid=kb;EN-US;q190217</a><br /><br />there's got to be a better way than thunking down to 16bit code from 32...</div>
    <div class="meta">Posted on 2002-04-19 07:51:24 by gscundiff</div>
   </div>
   <div class="post" id="post-34076">
    <div class="subject"><a href="#post-34076">System Resources</a></div>
    <div class="body">It's already been done.<br /><br /><a target="_blank" href="http://betrayed.virtualave.net/cgi-bin/load.cgi?asm/meter.zip">http://betrayed.virtualave.net/cgi-bin/load.cgi?asm/meter.zip</a></div>
    <div class="meta">Posted on 2002-04-19 19:49:15 by grv575</div>
   </div>
   <div class="post" id="post-34106">
    <div class="subject"><a href="#post-34106">System Resources</a></div>
    <div class="body">You're going to have to find another way if you want it to work on XP.</div>
    <div class="meta">Posted on 2002-04-20 05:33:52 by iblis</div>
   </div>
   <div class="post" id="post-34253">
    <div class="subject"><a href="#post-34253">System Resources</a></div>
    <div class="body">Thanks grv575,<br /><br />That gives us something to play with !!</div>
    <div class="meta">Posted on 2002-04-21 07:49:39 by gscundiff</div>
   </div>
  </div>
 </body>
</html>