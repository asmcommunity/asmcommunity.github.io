<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Self modifing code. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27939" />
  <link rel="prev" href="../?id=27939&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27939">Self modifing code.</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=27939&amp;page=1" style="">&laquo;</a><a href="../?id=27939&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="27939" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-198733">
    <div class="subject"><a href="#post-198733">Self modifing code.</a></div>
    <div class="body">i never had problem in using VirtualProtect() and WriteProcessMemory() to write into my own code section, but, if you cant, why dont use the stack? it can have executable code</div>
    <div class="meta">Posted on 2001-05-11 18:08:00 by vecna</div>
   </div>
   <div class="post" id="post-198734">
    <div class="subject"><a href="#post-198734">Self modifing code.</a></div>
    <div class="body">You use selectors by moveing them into CS, DS, ES.FS and GS ..evantually SS ;) just like in 16 bits...only they are not "segments" they are "selectors" that is: a index into the GDT or LDT (Win95->LDT)...
dont forget they are 16 bits values...

However this is NOT recomended to be done on Win32 (any version)...use it ONLY is you know exactly what are you doing....

for example on your OWN OS Code ;)</div>
    <div class="meta">Posted on 2001-05-12 20:52:00 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-198735">
    <div class="subject"><a href="#post-198735">Self modifing code.</a></div>
    <div class="body">MikeW, what's your problem with VirtualProtect and WriteProcessMemory?
If you only need to change your code "every once in a while", or
perhaps even only at program start, they are (imho) both good
choices, since you can turn protection back on, and thus still
catch any other (invalid) attempt to write in the code section.
That is, after all, the idea of protection the code section.

Using the data section is a choice as well, but...if you're only
going to modify a few values (opposed to generating code runtime),
code section is logically prettier.

Also, you could use VirtualAlloc if you're going to "generate" code,
or using "template code" to generate optimized encryptors,
decryptors, linefillers or whatever.</div>
    <div class="meta">Posted on 2001-05-14 03:31:00 by f0dder</div>
   </div>
   <div class="post" id="post-198736">
    <div class="subject"><a href="#post-198736">Self modifing code.</a></div>
    <div class="body">Bogdan, could you clarify about selectors 30 and 31?
Would this do it:

mov ax,30      ;decimal or hex?
mov ds,ax

or is 30 an index, so we need

mov ax,30*8    ;or similar
mov ds,ax

Thx,
Larry</div>
    <div class="meta">Posted on 2001-05-14 15:02:00 by Larry Hammick</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=27939&amp;page=1" style="">&laquo;</a><a href="../?id=27939&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="27939" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>