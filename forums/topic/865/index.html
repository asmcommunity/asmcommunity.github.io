<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Is file attribute readonly set? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=865" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=865">Is file attribute readonly set?</a></p>
   <div class="post" id="post-5534">
    <div class="subject"><a href="#post-5534">Is file attribute readonly set?</a></div>
    <div class="body">I have used GetFileAttributes to recieve the attributes of a certain file, but how can I detect if readonly (1h) is set to true?<br /><br /><br />/Delight</div>
    <div class="meta">Posted on 2001-08-31 06:56:48 by Delight</div>
   </div>
   <div class="post" id="post-5551">
    <div class="subject"><a href="#post-5551">Algorithms::Get attributes of a file</a></div>
    <div class="body">All u have to do is<br />OR return_value, FILE_ATTRIBUTE_READONLY<br /><br />here is a proc that checks a file attrib of a file:<br /><pre><code><br />		Invoke GetFileAttributes, ADDR FileName<br />		Mov FileAttrib, Eax<br /><br />		Or Eax, FILE_ATTRIBUTE_READONLY<br />		.If Eax == FileAttrib<br />			Invoke MessageBox, 0, ADDR ReadOnlyAttrIsSet, ADDR cap, 0<br /><br />		.EndIf<br /><br />		Mov Eax, FileAttrib<br />		Or Eax, FILE_ATTRIBUTE_HIDDEN<br />		.If Eax == FileAttrib<br />			Invoke MessageBox, 0, ADDR HiddenAttrIsSet, ADDR cap, 0<br />			<br />		.EndIf<br /><br />		Mov Eax, FileAttrib<br />		Or Eax, FILE_ATTRIBUTE_SYSTEM<br />		.If Eax == FileAttrib<br />			Invoke MessageBox, 0, ADDR SystemAttrIsSet, ADDR cap, 0<br />			<br />		.EndIf<br /><br />		Mov Eax, FileAttrib<br />		Or Eax, FILE_ATTRIBUTE_ARCHIVE<br />		.If Eax == FileAttrib<br />			Invoke MessageBox, 0, ADDR ArchivedAttrIsSet, ADDR cap, 0<br />			<br />		.EndIf<br /></code></pre> <br />Hope it will help:alright:</div>
    <div class="meta">Posted on 2001-08-31 09:26:52 by NEMO</div>
   </div>
   <div class="post" id="post-5555">
    <div class="subject"><a href="#post-5555">Algorithms::Get attributes of a file</a></div>
    <div class="body">Or more simple:<br /><pre><code><br />Invoke GetFileAttributes, ADDR FileName<br />.IF &#40;eax &amp; FILE_ATTRIBUTE_READONLY&#41;<br />   ; file is read only<br />.ENDIF<br /></code></pre><br /><br />Thomas</div>
    <div class="meta">Posted on 2001-08-31 10:08:43 by Thomas</div>
   </div>
  </div>
 </body>
</html>