<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>dll start-up  problem. need help! - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6967" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6967">dll start-up  problem. need help!</a></p>
   <div class="post" id="post-50381">
    <div class="subject"><a href="#post-50381">dll start-up  problem. need help!</a></div>
    <div class="body">Hi ppl!<br />i assembled a dll basically following tut #17 (with masm32). it works ok, but i got problem when linking it to C code (lcc): although the proc i wrote is recognized as external reference but the dll name is missing from imports section of the resulting exe file, so the loader tries to link proc to crt.dll and obviously fails. looks smthng is wrong with the lib file, but what?<br /><br />the API way (LoadLibrary, GetProcAddress) works perfectly.<br /><br />give me some idea what can be wrong, please!<br /><br />fresher</div>
    <div class="meta">Posted on 2002-07-27 06:00:37 by TheFresher</div>
   </div>
   <div class="post" id="post-50389">
    <div class="subject"><a href="#post-50389">dll start-up  problem. need help!</a></div>
    <div class="body">LCC uses its own .lib format, so MASM-produced .libs will not work with it. You need to use implib.exe from LCC\bin directory. I have tried, and it still failed to produce a valid LCC linkalble .lib (maybe future versions fixed it?) so I had to use buildexp.bat in the \include folder and build from there until I finally succeeded.</div>
    <div class="meta">Posted on 2002-07-27 07:09:14 by comrade</div>
   </div>
  </div>
 </body>
</html>