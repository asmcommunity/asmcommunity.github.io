<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ProcessId from hModule - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25855" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25855">ProcessId from hModule</a></p>
   <div class="post" id="post-188567">
    <div class="subject"><a href="#post-188567">ProcessId from hModule</a></div>
    <div class="body">I only have an hModule handle (from GetModuleHandle) and want to get the ProcessId (OpenProcess) from. Is there a way to do that?<br /><br />Beste regards,<br />Nordwind</div>
    <div class="meta">Posted on 2007-03-23 14:45:25 by Nordwind64</div>
   </div>
   <div class="post" id="post-188568">
    <div class="subject"><a href="#post-188568">Re: ProcessId from hModule</a></div>
    <div class="body">did you read remarks section for GetModuleHandle help? hModule is only valid for your process<br />you want your process handle? use &quot;GetCurrentProcess()&quot; or &quot;GetCurrentProcessId()&quot; for pid<br /></div>
    <div class="meta">Posted on 2007-03-23 14:52:54 by drizz</div>
   </div>
   <div class="post" id="post-188575">
    <div class="subject"><a href="#post-188575">Re: ProcessId from hModule</a></div>
    <div class="body">Thank you! But I use the API in my injected dll (no virus!!!). Could found another solution.<br /><br />Best regards,<br />Nordwind</div>
    <div class="meta">Posted on 2007-03-24 11:50:01 by Nordwind64</div>
   </div>
   <div class="post" id="post-188582">
    <div class="subject"><a href="#post-188582">Re: ProcessId from hModule</a></div>
    <div class="body">Hi Nordwind64<br />calling those functions from the remote dll will give you handles of the process that loaded that dll.<br />can you be more descriptive about what are you trying to do...<br /><br /></div>
    <div class="meta">Posted on 2007-03-24 19:31:00 by drizz</div>
   </div>
   <div class="post" id="post-188695">
    <div class="subject"><a href="#post-188695">Re: ProcessId from hModule</a></div>
    <div class="body">Hi.<br /><br />Drizz, you&#39;re right. Now I use...<br /><br /><pre><code>invoke CreateToolhelp32Snapshot,TH32CS_SNAPMODULE,0<br />push eax<br />mov hmodul.dwSize, sizeof MODULEENTRY32<br />invoke Module32First,eax,addr hmodul<br />pop eax&nbsp; &nbsp; &nbsp; <br />invoke CloseHandle,eax</code></pre><br /><br />...to get some infos (exepath) about the process.<br /><br />I&#39;m about to write some little hackertools (which dlls/file are using by a prog, e.g.). A filemon like util. Nothing destructive!</div>
    <div class="meta">Posted on 2007-04-01 06:06:59 by Nordwind64</div>
   </div>
   <div class="post" id="post-188697">
    <div class="subject"><a href="#post-188697">Re: ProcessId from hModule</a></div>
    <div class="body">You might want to say &quot;process tools&quot; instead of &quot;hacker tools&quot;, to avoid confusion. Sounds useful enough though, the sysinternals tools certainly make life easier...<br /></div>
    <div class="meta">Posted on 2007-04-01 09:21:52 by f0dder</div>
   </div>
  </div>
 </body>
</html>