<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Static text background - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20665" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20665">Static text background</a></p>
   <div class="post" id="post-157490">
    <div class="subject"><a href="#post-157490">Static text background</a></div>
    <div class="body">I want to know how to make to transparent the static text background.<br />I have an image backgrounded dialog and the text background rectangle doesn't looks like good.<br /><br />This code doesn't works for me:<br /><pre><code>WM_CTLCOLORSTATIC&#58;<br />  invoke SetTextColor, wParam, #RGB_COLOR#<br />  invoke SetBkMode, wParam, TRANSPARENT<br />  invoke GetStockObject, BLACK_BRUSH<br />  ret</code></pre></div>
    <div class="meta">Posted on 2005-02-26 09:12:28 by Zord</div>
   </div>
   <div class="post" id="post-157491">
    <div class="subject"><a href="#post-157491">Static text background</a></div>
    <div class="body"><pre><code><br />;@echo off<br />;goto make<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />.386<br />.model flat, stdcall<br />option casemap&#58;none<br />title Dialog Colour<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />include		\masm32\include\windows.inc<br />include		\masm32\include\kernel32.inc<br />include		\masm32\include\user32.inc<br />include		\masm32\include\gdi32.inc<br /><br />includelib	\masm32\lib\kernel32.lib<br />includelib	\masm32\lib\user32.lib<br />includelib	\masm32\lib\gdi32.lib<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />m2m MACRO M1, M2<br />	push	M2<br />	pop	M1<br />ENDM<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />	CurDate		TEXTEQU	&lt;&quot;&gt;, @Date, &lt;&quot;&gt;<br />	CurTime		TEXTEQU	&lt;&quot;&gt;, @Time, &lt;&quot;&gt;<br />	CurFileName	TEXTEQU	&lt;&quot;&gt;, @FileCur, &lt;&quot;&gt;<br /><br />	clrBack		equ	00000000h	; black<br />	clrFore		equ	00888888h	; white<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />DlgProc		PROTO	&#58;DWORD,&#58;DWORD,&#58;DWORD,&#58;DWORD<br />FreeRes		PROTO<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />.const<br />	szAppTitle	db		&quot;Dialog Colour&quot;, 0<br />	szMsgAbout	db		&quot;Dialog Colour&quot;, 13, 10<br />			db		&quot;Built on &quot;, CurDate, &quot; &quot;, CurTime, 13, 10<br />			db		&quot;Version 1.0&quot;, 13, 10<br />			db		&quot;Coded by comrade &lt;comrade2k@hotmail.com&gt;&quot;, 13, 10<br />			db		&quot;Web&#58; http&#58;//www.comrade64.com/&quot;, 13, 10<br />			db		&quot;http&#58;//comrade.ownz.com/&quot;, 13, 10<br />			db		&quot;http&#58;//comrade.win32asm.com/&quot;, 13, 10<br />			db		&quot;http&#58;//comrade64.cjb.net/&quot;, 13, 10<br />			db		&quot;IRC&#58; #asm, #coders, #win32asm on EFnet&quot;, 0<br />	szMenuAbout	db		&quot;&amp;About Dialog Colour...&quot;, 0<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />.data<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />.data?<br />	hIcon		dd		?<br />	hBrushBack	dd		?<br />	szUsername	db		256 dup &#40;?&#41;<br />	mbp		MSGBOXPARAMS	&lt;&gt;<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />.code<br />start&#58;	invoke	GetModuleHandle, 0<br />	mov	&#91;mbp.hInstance&#93;, eax<br />	invoke	DialogBoxParam, eax, 100, 0, ADDR DlgProc, eax<br />	invoke	ExitProcess, eax<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />DlgProc proc hWnd&#58;DWORD, uMsg&#58;DWORD, wParam&#58;DWORD, lParam&#58;DWORD<br />	.if &#91;uMsg&#93;==WM_INITDIALOG<br />		mov	eax, &#91;hWnd&#93;<br />		mov	&#91;mbp.hwndOwner&#93;, eax<br />		invoke	GetSystemMenu, eax, 0<br />		push	OFFSET szMenuAbout<br />		push	10<br />		push	MFT_STRING<br />		push	eax<br />		invoke	AppendMenu, eax, MFT_SEPARATOR, 0, 0<br />		call	AppendMenu<br />		invoke	LoadIcon, &#91;lParam&#93;, 2<br />		mov	&#91;hIcon&#93;, eax<br />		invoke	SendMessage, &#91;hWnd&#93;, WM_SETICON, 1, eax<br />		invoke	CreateSolidBrush, &#91;hBrushBack&#93;<br />		mov	&#91;hBrushBack&#93;, eax<br />	.elseif &#91;uMsg&#93;==WM_SYSCOMMAND<br />		cmp	&#91;wParam&#93;, 10<br />		je	@@msga<br />	.elseif &#91;uMsg&#93;==WM_COMMAND<br />		mov	eax, &#91;wParam&#93;<br />		.if ax==104<br />			invoke	GetDlgItemText, &#91;hWnd&#93;, 102, ADDR szUsername, sizeof szUsername<br />			invoke	MessageBox, &#91;hWnd&#93;, ADDR szUsername, ADDR szAppTitle, MB_OK OR MB_ICONASTERISK OR MB_APPLMODAL<br />		.elseif ax==105<br />		@@msga&#58;	mov	&#91;mbp.cbSize&#93;, sizeof mbp<br />			mov	&#91;mbp.lpszText&#93;, OFFSET szMsgAbout<br />			mov	&#91;mbp.lpszCaption&#93;, OFFSET szAppTitle<br />			mov	&#91;mbp.dwStyle&#93;, MB_OK OR MB_APPLMODAL OR MB_USERICON<br />			mov	&#91;mbp.lpszIcon&#93;, 2<br />			invoke	MessageBoxIndirect, ADDR mbp<br />		.elseif ax==106<br />			invoke	PostMessage, &#91;hWnd&#93;, WM_CLOSE, 0, 0<br />		.endif<br />	.elseif &#91;uMsg&#93;==WM_CTLCOLORDLG || &#91;uMsg&#93;==WM_CTLCOLORBTN || &#91;uMsg&#93;==WM_CTLCOLOREDIT || &#91;uMsg&#93;==WM_CTLCOLORSTATIC<br />		invoke	SetTextColor, &#91;wParam&#93;, clrFore<br />		invoke	SetBkColor, &#91;wParam&#93;, clrBack<br />		invoke	SetBkMode, &#91;wParam&#93;, OPAQUE<br />		mov	eax, &#91;hBrushBack&#93;<br />		ret<br />	.elseif &#91;uMsg&#93;==WM_CLOSE<br />		invoke	EndDialog, &#91;hWnd&#93;, 0<br />		invoke	MessageBoxIndirect, ADDR mbp<br />		;invoke  MessageBox, NULL, addr CurTime, addr CurDate, MB_OK<br />		call	FreeRes<br />	.endif<br />@@quit&#58;	xor	eax, eax<br />	ret<br />DlgProc endp<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />FreeRes proc<br />	invoke	DestroyIcon, &#91;hIcon&#93;<br />	invoke	DeleteObject, &#91;hBrushBack&#93;<br />	ret<br />FreeRes endp<br />;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />end start<br /><br />&#58;make<br />set name=dlgcolor1<br /><br />    \masm32\bin\ml /c /coff %name%.bat<br />    \masm32\bin\rc %name%.rc<br />    \masm32\bin\Link /subsystem&#58;windows /merge&#58;.text=.code %name%.obj %name%.res<br />    del *.obj<br />    del *.bak<br />    del *.res<br />    echo.<br /></code></pre></div>
    <div class="meta">Posted on 2005-02-26 09:53:17 by dcskm4200</div>
   </div>
   <div class="post" id="post-157526">
    <div class="subject"><a href="#post-157526">Static text background</a></div>
    <div class="body">I founded the answer. If i return GetStockObject, NULL_BRUSH it's works correctly.</div>
    <div class="meta">Posted on 2005-02-27 14:10:24 by Zord</div>
   </div>
  </div>
 </body>
</html>