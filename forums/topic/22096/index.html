<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>OOPSkinMesh question - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22096" />
    <link rel="next" href="../?id=22096&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=22096">OOPSkinMesh question</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=22096&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=22096&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="22096" /><input type="number" name="page" min="1" max="4" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=22096&amp;page=2">&gt;</a><a href="../?id=22096&amp;page=4">&raquo;</a></form>   <div class="post" id="post-166343">
    <div class="subject"><a href="#post-166343">OOPSkinMesh question</a></div>
    <div class="body">Hi all you lovers of Homer&#39;s splendid work on the OOPSkinMesh project ,<br /><br />Maybe for you it is a long time ago that you got interested in Homers work on animated skinmeshes.<br />And maybe you are already focusing on something else. But for me this is a start.<br />Maybe you could help me.<br /><br />I am using DirectX 8.1b on a Windows98 system.<br />When I tried to assemble and link the OOPSkinMesh project, it wouldn&#39;t build at first.<br />According to some comments in the Win32AsmCommunity board, I had to correct some<br />minor things in Scronty&#39;s includes, and in Calebs d3dx8math_fkt.def.<br />For example: I had to add 2 parameters to the ConvertToBlendedMesh proto in Scronty&#39;s d3dx8mesh.inc,<br />because in DirectX8.0 the function had 6 parameters, and in DirectX 8.1 it had 8 parameters.<br />In Homers OOPSkinMesh example there were 8 parameters already.<br /><br />After making these changes, I was able to assemble and link the project, but the application crashed.<br />It crashed on the <strong>ConvertToBlendedMesh</strong> line in the GenerateMesh function of the CMeshNode object.<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; <pre><code>mov ecx,me<br />&nbsp; &nbsp; &nbsp; &nbsp; mcall .CMeshNode.pD3DXSkinMesh,ID3DXSkinMesh_ConvertToBlendedMesh, D3DXMESH_WRITEONLY, \<br />		padjacencyin, .CMeshNode.rgiAdjacency, addr .CMeshNode.dwAttrCount, \<br />		addr .CMeshNode.pBoneCombinationBuf, 0,0, addr .CMeshNode.pD3DXBlendedMesh</code></pre><br /><br />The last information in the DEBUG_LOGFILE.TXT file before the crash was:<br /><br />	<pre><code>*** CMESHNODE_CREATE (RE)_ENTERED WITH THESE PARAMS ***<br />	THIS = 0x1A61F4C<br />	pxofobj = 0x15110E8<br />	pd3ddevice = 0x5D5680<br />	D3DXLoadSkinMeshFromXof returned success = 0xB32340<br />	4427 Faces, 5642362 Materials.<br />	Here we go...<br />	AdjacencyIn&nbsp; &nbsp;  = 0x1A61FAC<br />	AdjacencyOut&nbsp;  = 0x623210<br />	AttributeCount&nbsp; = 0x0<br />	pBoneCombinationBuf = 0x0<br />	pD3DXSkinMesh= 0xB32340</code></pre><br /><br />Can anyone of you, maybe Homer or someone else who is interested in this matter, tell me what could be<br />the problem?<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2005-09-27 14:05:29 by mdevries</div>
   </div>
   <div class="post" id="post-166348">
    <div class="subject"><a href="#post-166348">Re: OOPSkinMesh question</a></div>
    <div class="body">A bit more info on the exception could help - register values and code around the crashpoint</div>
    <div class="meta">Posted on 2005-09-27 15:37:42 by Ultrano</div>
   </div>
   <div class="post" id="post-166359">
    <div class="subject"><a href="#post-166359">Re: OOPSkinMesh question</a></div>
    <div class="body">Homer is rather busy I guess. I would direct him to this thread.</div>
    <div class="meta">Posted on 2005-09-27 22:49:36 by roticv</div>
   </div>
   <div class="post" id="post-166364">
    <div class="subject"><a href="#post-166364">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi Ultrano and roticv,<br /><br />Thanks for your replies.<br /><br />Ultrano,<br />Do you mean the registers before the call, or the registers at the moment of the exception?<br /><br />Friendly regards,<br />mdevries<br /></div>
    <div class="meta">Posted on 2005-09-28 01:09:22 by mdevries</div>
   </div>
   <div class="post" id="post-166379">
    <div class="subject"><a href="#post-166379">Re: OOPSkinMesh question</a></div>
    <div class="body">I need to see the code that the macro generated. While I don&#39;t know much about D3D, I could help with macros.<br />Also, I need the values of EIP, EAX and ECX - to see if the crash is really caused by the macro. <br />Btw, I checked the DX8.1 reference, there the 6th and 7th parameter weren&#39;t marked as optional (having value of 0). </div>
    <div class="meta">Posted on 2005-09-28 06:10:54 by Ultrano</div>
   </div>
   <div class="post" id="post-166410">
    <div class="subject"><a href="#post-166410">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi Ultrano,<br /><br />I don&#39;t think the macro is wrong, because it was right for Homer, so it should be right for me too, isn&#39;t it. But maybe I am mistaken.<br />Couldn&#39;t it be a hardware problem? I tested it on the before mentioned Win98 system, on a pentium II, without a 3D card, but also on WinXP system, having a 3D card.<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2005-09-28 16:30:11 by mdevries</div>
   </div>
   <div class="post" id="post-166477">
    <div class="subject"><a href="#post-166477">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi Ultrano,<br /><br />Homer uses your ATC to do his OOP-stuff. And when I read his comments on ATC, he is rather lyric about it.<br />So I downloaded his tutorial on it, and also the 10 tutorials you wrote on it. I became rather enthousiastic about it. So I was wondering: Have you written any more tutorials, because the version of ATC has fairly increased in the meantime. I want to know it&#39;s new features. But I couldn&#39;t find them. However in one of the threads on this board you wrote:<br /><br /><div class="quote">A brief tute to the newest features in ATC can be found here:<br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=17987.0">http://www.asmcommunity.net/board/index.php?topic=17987.0</a></div><br /><br />This link isn&#39;t working. Can you direct me to it?<br />Or do you have any more tutorials ready?<br /><br />I am also curious: What does ATC mean? Does it have something to do with Air Traffic Control? Or am I totally wrong?<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2005-09-29 17:51:52 by mdevries</div>
   </div>
   <div class="post" id="post-166488">
    <div class="subject"><a href="#post-166488">Re: OOPSkinMesh question</a></div>
    <div class="body">I had described the new features of ATC in topics here. But later I deleted them while being upset that ATC&#39;s users count became 0 ^^&quot;. <br />ATC stands for &quot;A touch of class&quot;, like the once-famous music band (kind of a tribute :) ).<br /><br />What&#39;s new in the last, final and rewritten version:<br />- removed &quot;hardcode&quot; listing, to improve compilation speed<br />- classes can be 4 types: normal, C++ compatible, COM compatible and non-virtual (without destructor). Their usage is absolutely identical<br />- set/pcall macro &lt;- important improvement<br />- some unimportant tools for COM host development<br /><br />Below&#39;s maybe a complete tute on the newest features in ATC. The new features are easy to use, and backwards-compatible. <br /><br />To define a COM compatible class:<br /><pre><code><br />class ClassName,,COM compatible<br /><br />or <br /><br />class ClassName,ParentClass,COM compatible<br /></code></pre><br /><br />to use set/pcall macros:<br />Let&#39;s assume we&#39;re making a DirectSound app:<br /><pre><code><br />.data?<br />DSOUND dd ?<br />Primary&nbsp;  dd ?<br />Secondary dd ?<br />.code<br /><br />set DSOUND as IDirectSound ; does not generate any code or data.<br />set Primary,Secondary as IDirectSoundBuffer<br />...<br />pcall DSOUND.CreateSoundBuffer,addr RenderedDesc,addr Secondary,0<br />...<br />pcall Primary.Play,0,0,1<br />pcall Secondary.Play,0,0,1<br />...<br />pcall DSOUND.Release<br /><br /></code></pre><br /><br />That&#39;s all :)<br /><br /><br />iirc, the &quot;foreach&quot; macro was present in some older versions of ATC. But I moved it to a more apropriate file. This macro&#39;s usage is like:<br /><pre><code><br />foreach vectorAllWindows,invoke CloseWindow,edx<br /></code></pre><br />It&#39;s tightly connected with some separately defined classes ObjVector,VarVector and HookVector. </div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1011" target="_blank">ATC2.inc</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-09-29 20:24:11 by Ultrano</div>
   </div>
   <div class="post" id="post-166512">
    <div class="subject"><a href="#post-166512">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi Ultrano,<br /><br />Thanks for your explanation. When I see your macros: They look nice to me.<br />Don&#39;t be disappointed because it seems people don&#39;t use your product.<br />Maybe more people do, than you think. So, keep up your chin.<br />And as you can see: It&#39;s not only me who downloaded your ATC.INC file!!<br />Atleast I will definitely use it, because it looks like a good product to me.<br /><br />Friendly regards,<br />mdevries</div>
    <div class="meta">Posted on 2005-09-30 12:36:28 by mdevries</div>
   </div>
   <div class="post" id="post-166574">
    <div class="subject"><a href="#post-166574">Re: OOPSkinMesh question</a></div>
    <div class="body"><br />Victor got in touch with me, et voila - here I am :)<br /><br />I&#39;ve sent you a PM via this board regarding your queries.<br />I will help in any way I can.<br />I&#39;ve been coding under the OA32 model for some time now.<br />It&#39;s got a lot of user-friendly features, and a fair bit of useless overhead too.<br />I was not aware that Ultrano was going public with the rebirthed ATC..<br />Yes I was always happy with ATC even though it was difficult at first for me to understand well.<br />It was never meant to be used as a teething ring, and I owe Ultrano a lot for throwing me in at the deep end, so to speak. Had I begun with OA32, I am not sure I would have had the same feelings toward oopasm as I do today.. I am not implying that OA32 is inferior, I believe that both models are complementary - ATC has a lighter framework with less overhead and faster execution/smaller size as a result, whereas OA32 has taught me to better understand the tricks and traps, the potential and the limitations of the macro language that is hidden within masm.<br />I say hidden because an absolute minority of programmers appreciate it, fewer see its true potential, and fewer still understand it well enough to take advantage of it.<br />Ultrano has a nasty habit of writing uncommented and obfuscated macros which nonetheless are elegant in their simplicity... Biterider&#39;s macros are often far easier to read due to his taking the longer approach to certain situations with little obvious benefit at the binary level.<br />I&#39;m never bloody satisfied, am I? :P<br /><br />In any event, I found I never used most of the classes which Biterider put so much work into.. I tended to treat OA32 as ATC on rollerskates, writing my own classes while observing the minimum requirements under that model, and taking full advantage of his generous macro set (in particular the debug support has been invaluable).<br /><br />Biterider and Ultrano, you have done all of us a service, by making it clearer than ever before that the old arguments against asmcoding just don&#39;t stack up - whether you realize it or not, the two of you have breathed new life into a dying art, and for that I thank you.<br />I know that neither of you invented anything here, and we all stand on the shoulders of giants and stuff, but I mean it guys, well done.<br /><br />I&#39;m willing to rework SkinMesh related code from the ground up, under whichever model you prefer. For me it&#39;ll be I think the fourth time around the park in regards to SkinMesh.<br />A lot of stuff has changed since I wrote that, with new graphic cards on the market and new vendor extensions in the drivers. A lot of water under my bridge too, as I&#39;ve totally done the OpenGL thing ever since I quit messing with DX stuff..<br /><br />Hope you all enjoyed my rant lol, have a nice day :)<br /><br /></div>
    <div class="meta">Posted on 2005-10-02 07:43:04 by Homer</div>
   </div>
   <div class="post" id="post-166878">
    <div class="subject"><a href="#post-166878">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi Homer,<br /><br />I appreciate your offer of rewriting the SkinMesh code from the ground up. Last time you did it using ATC. I guess, it had a good reason that you changed to OA32. Can you share your reasons with us on the board? If you prefer it over ATC, I would suggest you do it using OA32.<br />Personally I have begun to like ATC. It looks fast to me.<br /><br />I am very interested in your work, and can&#39;t wait to see the first results of your fourth try!!<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2005-10-13 14:33:24 by mdevries</div>
   </div>
   <div class="post" id="post-167008">
    <div class="subject"><a href="#post-167008">Re: OOPSkinMesh question</a></div>
    <div class="body">The reason I suggest writing it under OA32 is mostly for the debug support.<br />ATC basically contains zero debugging support. Unless you like spending lots of time in a debugger/disassembler, you really want to build using OA32. <br />Once we have the thing working and stable, its a trivial job to switch it back to ATC which will make it smaller and faster.<br />My debug support for ATC consisted (as you saw) of some wrappers to write junk strings to a textfile. This is fine until you consider the following:<br />1) theres only one stream of debug output, and no synchronising of multithreaded debug output<br />2) we can&#39;t view the debug stream efficiently during runtime<br />OA32&#39;s debug support consists of a bunch of macros for sending strings to a debug window, which happens to be MDI, so has N child windows = N debug streams, visible during runtime.<br />You&#39;ll need the &quot;DebugCenter&quot; package from Biterider.<br />Just place the exe someplace permanent and run it once to register its filepath, then you can see the debug output of any application which uses this debugging method.<br /></div>
    <div class="meta">Posted on 2005-10-17 23:27:30 by Homer</div>
   </div>
   <div class="post" id="post-167033">
    <div class="subject"><a href="#post-167033">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi Homer,<br /><br />It&#39;s a great idea, using OA32 to get the product running, and after that translating it using ATC. In this way we can benefit from the best of both models.<br /><br />I think Utrano will we glad to be hearing that his product isn&#39;t dead. In fact, it will outrun OA32 when it comes to size and speed. In what way can we honor him more than by using his model, and by sharing our experiences with it on this board.<br /><br />Please Homer, when you have something to say, share it with us on this board, because maybe there are only a few people who listen, but in the future many more can benefit from it. At least, if you hadn&#39;t published your masm OOPSkinMesh example, I wouldn&#39;t be here talking to you, because I wouldn&#39;t have known that someone did this excellent job.<br /><br />As I said earlier, I can&#39;t wait to see the first results of your efforts.<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2005-10-18 12:05:15 by mdevries</div>
   </div>
   <div class="post" id="post-167069">
    <div class="subject"><a href="#post-167069">Re: OOPSkinMesh question</a></div>
    <div class="body">We have a fair bit of work to do, but most of it is relatively painless.<br />Our first mission is to build a DX9/OA32 Skeleton application.<br />That&#39;s not such a big task, except that we&#39;re going to have to write OA32 classes for D3D9.<br />We can either take my existing classes for ATC or obtain the DX ones, and convert them to OA32 format.<br />But before even that, let&#39;s decide on an existing demo to translate for our Skeleton.<br />I suggest we base our skeleton on http://www.riaz.de/download/d3d02.zip<br />If there&#39;s another demo you feel more comfortable about using as the base for this project, let me know.<br /><br />I&#39;m suggesting this because if we use OA32&#39;s fledgling 3D engine we&#39;ll probably lock ourselves into staying with OA32, and the whole point of the exercise is to move this back to ATC as soon as its stable, purely for speed and size.<br />That being said, we should attempt to optimize any support code (such as math functions) as much as we can along the way.<br /><br />I&#39;m not going to take this project and run with it, I want you to carry some of the load too. If we build this from the ground up and comment the progress in this thread, others can benefit from it as well.<br /></div>
    <div class="meta">Posted on 2005-10-20 05:55:28 by Homer</div>
   </div>
   <div class="post" id="post-167096">
    <div class="subject"><a href="#post-167096">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi Homer,<br /><br />You are so much more experienced than me.<br />But ofcourse I will try to carry some of the workload to.<br /><br />We could use the skeleton in your previous post.<br />However the skeleton is using D3D9 and I want to use DirectX 8.1,<br />but if that were the biggest problem to solve, we had only small problems.<br />In reality our challenges are a lot bigger.<br /><br />We surely want to be able to switch back from OA32 to ATC without difficulties,<br />so let&#39;s translate the classes you already have. Not only because we can switch<br />back to ATC, but also because we needn&#39;t reinvent the wheel where not necessary.<br /><br />It always helps to have an example that has been proven to be working.<br />As I can see your classes are based on Sarmad Kh Abdullah&#39;s SkinMesh example,<br />which he described in the document &quot;Implementing Skin Meshes with DirectX 8&quot;.<br />We could keep doing that. Isn&#39;t it?<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2005-10-21 17:07:26 by mdevries</div>
   </div>
   <div class="post" id="post-167632">
    <div class="subject"><a href="#post-167632">Re: OOPSkinMesh question</a></div>
    <div class="body">I know I&#39;ve been conspicuously absent recently.<br />Time has not been on my side.<br />Rest assured, I&#39;m working on this project.<br />I will have something for you shortly.<br /></div>
    <div class="meta">Posted on 2005-11-07 17:18:48 by Homer</div>
   </div>
   <div class="post" id="post-167636">
    <div class="subject"><a href="#post-167636">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi Homer,<br /><br />Isn&#39;t time something we would all like to have more than we really do?<br />But don&#39;t worry. I&#39;m patient.<br /><br />In the meantime I tried to use OA32 on my Pentium II notebook (Win98). But it doesn&#39;t work. It crashes on using DebugCenter.<br />When I try it on my Pentium IV (WinXP), it doesn&#39;t crash. So, isn&#39;t DebugCenter meant for a Pentium II?<br />I hope it is something else. Is this a known problem that can be fixed?<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2005-11-07 17:37:44 by mdevries</div>
   </div>
   <div class="post" id="post-167644">
    <div class="subject"><a href="#post-167644">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi<br />DebugCenter is compiled by default for an Intel Pentium III or above. If you want to use an older processor, compile the ObjMem32 library for 386 and the objects in the objects folder. Finally rebuild the DebugCenter.exe<br /><br />Regards</div>
    <div class="meta">Posted on 2005-11-08 01:15:06 by Biterider</div>
   </div>
   <div class="post" id="post-167647">
    <div class="subject"><a href="#post-167647">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi<br />I certainly found a bug in one of the string handling routines for the 386 target. <br />I also added the DebugCenter.exe compiled for 386.<br /><br />Regards<br /><br />Biterider<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1166" target="_blank">DebugCenter.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-11-08 04:07:27 by Biterider</div>
   </div>
   <div class="post" id="post-167663">
    <div class="subject"><a href="#post-167663">Re: OOPSkinMesh question</a></div>
    <div class="body">Hi Biterider,<br /><br />Thanks for your response.<br />I&#39;ll try it.<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2005-11-08 15:18:14 by mdevries</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=22096&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=22096&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="22096" /><input type="number" name="page" min="1" max="4" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=22096&amp;page=2">&gt;</a><a href="../?id=22096&amp;page=4">&raquo;</a></form>  </div>
 </body>
</html>