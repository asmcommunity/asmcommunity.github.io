<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>hiding a process - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19574" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19574">hiding a process</a></p>
   <div class="post" id="post-150797">
    <div class="subject"><a href="#post-150797">hiding a process</a></div>
    <div class="body">Hi coders <br />I had a querry in my mind. Please help me with the soln. I thank you to all in advance.<br />The problem is I can hide any process in win 9x. with the undocumented RegisterServiceProcess  api from kernel32.dll like this.<br /><br />invoke GetModuleHandle, addr kernel <br />invoke GetProcAddress, eax, addr rsp                <br />mov    ebx, eax                                      <br />push   1<br />push   0                                             <br />call   ebx<br /><br />where <br />kernel db &quot;kernel32.dll&quot;,0<br />rsp db &quot;RegisterServiceprocess&quot;,0<br /><br />but when it comes to win nt or win xp it does'nt work since it doesn?t have those api in kernel32.dll<br /><br />My question is that how can we hide a process in win nt or win xp ???<br />Is there some other api or some other soln. Please explain.</div>
    <div class="meta">Posted on 2004-10-02 05:55:34 by nickdigital</div>
   </div>
   <div class="post" id="post-150811">
    <div class="subject"><a href="#post-150811">hiding a process</a></div>
    <div class="body">Get 29a magazine issue 7. There is an article by Yoda showing the way of hiding process on NT.</div>
    <div class="meta">Posted on 2004-10-02 11:23:11 by arafel</div>
   </div>
   <div class="post" id="post-150845">
    <div class="subject"><a href="#post-150845">hiding a process</a></div>
    <div class="body">A better way than y0da :)<br />Create a RemoteThread in another process, then execute the remote thread and then kill the parent process - NO PROCESS TO FIND :)<br /><br />Microsoft used this method in a trojan/rat that uses the name logagent.exe, lives in system32 folder, purports to be a mediaplayer component.<br /><br />Have a nice day :)</div>
    <div class="meta">Posted on 2004-10-03 08:34:55 by Homer</div>
   </div>
   <div class="post" id="post-150847">
    <div class="subject"><a href="#post-150847">hiding a process</a></div>
    <div class="body">Evilhomer<br />thank you so much..but can u please show me an example,how to do that<br /> i mean createremotethread and then kill main process.will it not show in taskmanager and does it work on all os??? win nt or win xp???<br />thank you for ur inputs<br />nickdigital</div>
    <div class="meta">Posted on 2004-10-03 08:53:25 by nickdigital</div>
   </div>
   <div class="post" id="post-150851">
    <div class="subject"><a href="#post-150851">hiding a process</a></div>
    <div class="body">no - it's against the rules of this forum :)</div>
    <div class="meta">Posted on 2004-10-03 09:14:26 by Homer</div>
   </div>
   <div class="post" id="post-150853">
    <div class="subject"><a href="#post-150853">hiding a process</a></div>
    <div class="body">Evilhomer2k<br /> thank you for ur help, i ll  try to do it myself.<br />anyway, ur input was very good.<br />thanks once again<br />nickdigital</div>
    <div class="meta">Posted on 2004-10-03 09:25:44 by nickdigital</div>
   </div>
   <div class="post" id="post-150854">
    <div class="subject"><a href="#post-150854">hiding a process</a></div>
    <div class="body">This sounds evil.  Anyone know how to find hidden processes that are running on your machine?</div>
    <div class="meta">Posted on 2004-10-03 09:41:50 by JimG</div>
   </div>
   <div class="post" id="post-150867">
    <div class="subject"><a href="#post-150867">hiding a process</a></div>
    <div class="body"><div class="quote">This sounds evil.  Anyone know how to find hidden processes that are running on your machine?</div><br /><br />In 9x just above the shared memory (VA_SHARED by Matt P.) like it's 0x80000000+0x200000 is the start of process blocks.  If you index 0x100 in your capable of finding every process name, you dont' need ring0 code to do this.<br /><br />btw, as matt p. documents in his book calling GetProcessId and then unofsucating it will give you the address here.</div>
    <div class="meta">Posted on 2004-10-03 16:00:52 by archphase</div>
   </div>
   <div class="post" id="post-150869">
    <div class="subject"><a href="#post-150869">hiding a process</a></div>
    <div class="body"><div class="quote">A better way than y0da :)<br />Create a RemoteThread in another process, then execute the remote thread and then kill the parent process - NO PROCESS TO FIND :)<br /><br />Microsoft used this method in a trojan/rat that uses the name logagent.exe, lives in system32 folder, purports to be a mediaplayer component.<br /><br />Have a nice day :)</div><br />There is more more better solution :)<br />Unlink process from EPROCESS chain NO hooking NO Problem<br />http://www.rootkit.com/project.php?id=12</div>
    <div class="meta">Posted on 2004-10-03 16:36:24 by Criminal2</div>
   </div>
   <div class="post" id="post-150885">
    <div class="subject"><a href="#post-150885">hiding a process</a></div>
    <div class="body">NT-only though. IMO a ring3 win32 solution is much more elegant. hook Process32First/Next as well as NtQuerySystemInformation for output from  SystemInformation. as for hooking the api, use IAT or overwriting method.</div>
    <div class="meta">Posted on 2004-10-04 00:38:53 by Drocon</div>
   </div>
  </div>
 </body>
</html>