<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Saving resource icons - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16784" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=16784">Saving resource icons</a></p>
   <div class="post" id="post-130314">
    <div class="subject"><a href="#post-130314">Saving resource icons</a></div>
    <div class="body">I was playing around with saving icons from a resource file and thought I would post a little demo of how to do it. This demo will save the icon found at index 10 in the shell32.dll file for the purposes of demonstrating how it is done. It will scan a file and index all of the resource names of the icon group resources and then you can specify an index and save it to an ico file. All icons in the group are saved in a single icon file so you get a real representation of the actual icon file and not a single icon. It can be used in conjunction with PickIconDlg to build an icon extraction utility if you like. All code is public domain, except dwordtoascii that is the GoAsm translation of Tim Roberts dwtoa.<br /><br />The demo is written in GoAsm (easy to translate to MASM) and requires my include files, available at my website.</div>
    <div class="meta">Posted on 2004-01-10 20:53:14 by donkey</div>
   </div>
   <div class="post" id="post-130580">
    <div class="subject"><a href="#post-130580">Make a proc</a></div>
    <div class="body">Hi donkey,<br />  Can't you make a SaveIcon proc which takes the DllName, Index, SaveName etc. Then ask Hutch to put it in the MASM32 lib:cool: ;) :tongue: :) <br /><br />Thomas Antony</div>
    <div class="meta">Posted on 2004-01-14 04:52:32 by thomasantony</div>
   </div>
   <div class="post" id="post-130616">
    <div class="subject"><a href="#post-130616">Saving resource icons</a></div>
    <div class="body">Hi Thomas,<br /><br />Use the code if you want, you can easily convert it to a one-shot routine but that would be incredibly inefficient, loading the library and indexing the icon groups then extracting and saving the icon every time. It is in it's essence a nearly complete icon extraction utility, I am just not that interested in making that application so you are free to use my code to complete it if you want to. This is not a function for a lib based routine as it is made to be adapted to a specific application.</div>
    <div class="meta">Posted on 2004-01-14 10:35:50 by donkey</div>
   </div>
   <div class="post" id="post-130633">
    <div class="subject"><a href="#post-130633">Saving resource icons</a></div>
    <div class="body">It's possible also to extract icons from .res files as <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=16671">binary data</a></div>
    <div class="meta">Posted on 2004-01-14 13:33:51 by Vortex</div>
   </div>
  </div>
 </body>
</html>