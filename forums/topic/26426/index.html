<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Shell32 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26426" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26426">Shell32</a></p>
   <div class="post" id="post-191504">
    <div class="subject"><a href="#post-191504">Shell32</a></div>
    <div class="body">hm probably a stupid question but anyway ;)
whenever i must use the shlobj.h i never can compile anything so for example the example on Iczelions HP (browseforfolder).
Must i define there something else ?
For the Bff how must i define the malloc since itÂ´s only declared in the snippet as  LOCAL ppMalloc :LPMALLOC and  LPMALLOC is nowhere defined.
Same problem with for ex. SHGetSpecialFolderPath that sounded kinda easy from msdn
BOOL SHGetSpecialFolderPath(
    HWND hwndOwner,
    LPTSTR lpszPath,
    int nFolder,
    BOOL fCreate
);

i tried an simple  invoke with SHGetSpecialFolderPath,0,szPath,CSIDL_PRINTERS ,0
but failed :/
any idea ?</div>
    <div class="meta">Posted on 2000-12-23 12:01:00 by newbie</div>
   </div>
   <div class="post" id="post-191505">
    <div class="subject"><a href="#post-191505">Shell32</a></div>
    <div class="body">Change:

SHGetSpecialFolderPath,0,szPath,CSIDL_PRINTERS ,0


to:

SHGetSpecialFolderPath,0,ADDR szPath,CSIDL_PRINTERS ,0

(lp is long pointer, ie, addres of)</div>
    <div class="meta">Posted on 2000-12-23 22:02:00 by Ernie</div>
   </div>
   <div class="post" id="post-191506">
    <div class="subject"><a href="#post-191506">Shell32</a></div>
    <div class="body">thanx ernie
hm still not working but anyways i hope i find the problem :/</div>
    <div class="meta">Posted on 2000-12-24 04:48:00 by newbie </div>
   </div>
  </div>
 </body>
</html>