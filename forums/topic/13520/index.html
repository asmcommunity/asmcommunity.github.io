<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>LB_GETCOUNT Problem? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13520" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=13520">LB_GETCOUNT Problem?</a></p>
   <div class="post" id="post-104767">
    <div class="subject"><a href="#post-104767">LB_GETCOUNT Problem?</a></div>
    <div class="body">Ok, I'm trying to return the number of items in a listbox using the LB_GETCOUNT message, when I do that it returns as a funky square charactor.<br /><br /><br />Here's a bit of the code:<br /><br />.data<br />intItemCount    dd 0       ;Listbox item count.    <br /><br />.code<br />invoke SendMessage,hListbox,LB_GETCOUNT,0,0  ;Get Item Count.<br />mov intItemCount,eax<br /><br />push 0<br />push 0<br />push offset intItemCount<br />push 0 <br />call MessageBox    ;Display Result.</div>
    <div class="meta">Posted on 2003-05-25 18:41:49 by Knight Chat X</div>
   </div>
   <div class="post" id="post-104768">
    <div class="subject"><a href="#post-104768">LB_GETCOUNT Problem?</a></div>
    <div class="body">You have to convert the number to ascii text first. Use dw2a to do that:<pre><code>.data<br />intItemCount dd 0 ;Listbox item count. <br />buffer BYTE 16 DUP&#40;0&#41;<br /><br />.code<br />invoke SendMessage,hListbox,LB_GETCOUNT,0,0 ;Get Item Count.<br />mov intItemCount,eax<br /><br />invoke dw2a,intItemCount,offset buffer<br /><br />push 0<br />push 0<br />push offset buffer<br />push 0<br />call MessageBox ;Display Result.</code></pre></div>
    <div class="meta">Posted on 2003-05-25 18:48:02 by donkey</div>
   </div>
   <div class="post" id="post-104772">
    <div class="subject"><a href="#post-104772">LB_GETCOUNT Problem?</a></div>
    <div class="body">Ok, got it now, works like a charm that was fast...<br /><br />:grin:</div>
    <div class="meta">Posted on 2003-05-25 19:51:19 by Knight Chat X</div>
   </div>
  </div>
 </body>
</html>