<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>What am I doing wrong? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29111" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=29111">What am I doing wrong?</a></p>
   <div class="post" id="post-205647">
    <div class="subject"><a href="#post-205647">What am I doing wrong?</a></div>
    <div class="body">I have to... Once the user has entered a valid number (0-20), the menu procedure should call a third procedure that causes the first N Fibonacci numbers to be displayed on the console. Each number should be displayed with a single space between them. This procedure will need to loop over the numbers from 0 to the user input number. The display procedure will call a fourth procedure to compute the Fibonacci number for each specific number in the loop. (This is the scary recursive procedure!) <br /><br />The fourth procedure is to evaluate the Fibonacci number for an input value of N. This procedure must be recursive as described above. The input parameter must be passed to the routine on the stack before the procedure is called. The return value should be left on the stack as well. The calling procedure (which can be this procedure as well, remember it is recursive) will need to set up the stack and clean up after it is done. <br /><br />This is what I have...but it hangs<br /><br />file 1<br /><pre><code>Start:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; menu<br /></code></pre><br /><br />file2<br /><pre><code> enter&nbsp; &nbsp; &nbsp;  0,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pushad<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  ebx,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,0<br />menu:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,instruction<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_string<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,list_1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_string<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,list_2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_string<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,list_3<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_string<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,list_4<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_string<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />Loop_1:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; get_kb<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  al,49h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; menu_I<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  al,69h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; menu_I<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  al,4Eh<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; menu_N<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  al,6Eh<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; menu_N<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  al,46h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; menu_F<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  al,66h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; menu_F<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  al,58h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; menu_X<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  al,78h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; menu_X<br />menu_X:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; &nbsp;  exit<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br /><br />menu_I:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,inst_I<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_string<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; &nbsp;  menu<br />menu_N:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,inst_N<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_string<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; read_int&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;get int from caller<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  al,0h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; compare AL to 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jl&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; error2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; no match do second else<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  al,14h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;compare AL to 20<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; error2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;no match do second else<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  ,al<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  ebx,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_int<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; &nbsp;  menu<br />menu_F:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;N is in ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  ebx,0h<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jb&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; error<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp; &nbsp;  ebx,14h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;check to see if there is a number between 0-20 in ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ja&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; error<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_int<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; &nbsp; eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; Fib_Driver<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop&nbsp; &nbsp; &nbsp; &nbsp;  eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; &nbsp;  menu<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;call recursive driver procedure<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;<br />error:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,error_msg1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_string<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; &nbsp;  menu<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />error2:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  eax,error_msg2<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_string<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; &nbsp;  menu<br />exit:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; popad<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; leave<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret</code></pre><br />file3<br /><br /><pre><code><br />Fib_Driver: ;N is in eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enter&nbsp; &nbsp; &nbsp;  0,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; &nbsp; &nbsp; ecx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;save callers ecx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp; &nbsp;  ecx,0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;move 0 into ecx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />L1:&nbsp; &nbsp; &nbsp; &nbsp;  cmp&nbsp; &nbsp; &nbsp; &nbsp;  ecx,eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;compare eax to 0(ecx)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Finally&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;if eax is 0 jump to finally<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />Next:&nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; math&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;call math<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_int&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;print answer from math<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; &nbsp; &nbsp; print_nl<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc&nbsp; &nbsp; &nbsp; &nbsp;  ecx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;increase ecx by 1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp; &nbsp;  L1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;jump to L1<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />Finally:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop&nbsp; &nbsp; &nbsp; &nbsp;  ecx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; leave<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </code></pre><br /><br />file 4<br /><pre><code>&nbsp; &nbsp; &nbsp; <br />math:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enter&nbsp;  0,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; ebx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ; save caller&#039;s ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; ecx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  ecx, eax&nbsp; &nbsp; ; loop count<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  eax, 1&nbsp; &nbsp; &nbsp; ; first value<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  ebx, 1&nbsp; &nbsp; &nbsp; ; second value<br /><br />loopie:<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; print_int<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; print_nl<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; lea&nbsp; &nbsp;  edx,  ; number = first + second<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  eax, ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  ebx, edx<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; loop&nbsp; &nbsp; loopie<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />end:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop&nbsp; &nbsp;  ecx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop&nbsp; &nbsp;  ebx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;clean up<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; leave<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret</code></pre></div>
    <div class="meta">Posted on 2008-07-16 17:53:03 by cannsyl</div>
   </div>
   <div class="post" id="post-205649">
    <div class="subject"><a href="#post-205649">Re: What am I doing wrong?</a></div>
    <div class="body">call&nbsp; &nbsp; print_int<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; print_nl<br /><br />chances are they destroy the eax / ebx registers... so do something like<br /><br />push eax<br />push ebx<br /><br />call&nbsp; &nbsp; print_int<br />call&nbsp; &nbsp; print_nl<br /><br />pop ebx<br />pop eax<br /><br />you could have found that out by a bit of debugging...</div>
    <div class="meta">Posted on 2008-07-17 01:51:25 by evlncrn8</div>
   </div>
  </div>
 </body>
</html>