<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>.SWITCH Macro Help ?? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15683" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15683">.SWITCH Macro Help ??</a></p>
   <div class="post" id="post-121517">
    <div class="subject"><a href="#post-121517">.SWITCH Macro Help ??</a></div>
    <div class="body">I've download .SWITCH macros of QvasiModo and bitRAKE from madwizard.org and included it to my source but it didn't run and lead me to a 'Syntax error' at .SWITCH in macro . Certainly I don't include two macro , just tried to include of QvasiModo first and after it fail I deleted it and inserted the one of bitRAKE.<br />It seems MASM don't accept macro start with the dot '.'  :confused: :confused: :confused: :confused: :confused: <br />I used MASM 8.</div>
    <div class="meta">Posted on 2003-10-17 00:00:28 by dreamweaver</div>
   </div>
   <div class="post" id="post-121558">
    <div class="subject"><a href="#post-121558">.SWITCH Macro Help ??</a></div>
    <div class="body">Hi, dreamweaver.<br />I wouldn't know about BitRAKE's (they're much more complicated, and I didn't get the hang of the macro language enough to understand them), but I can tell you about my macros.<br />This is a sample of their usage:<br /><pre><code><br />WindowProc proc hWnd,uMsg,wParam,lParam<br /><br />    mov eax,uMsg<br />    .switch eax<br />    .case WM_COMMAND<br />        ;process WM_COMMAND here...<br />        .break<br />    .case WM_CREATE<br />        ;window initialization...<br />        .break<br />    .case WM_DESTROY<br />        ;note that .break is not necessary here, as the .switch is over<br />    .endswitch<br />    ret<br /><br />WindowProc endp<br /></code></pre><br />Also you probably need to include this line before the macro definitions:<br /><pre><code>option dotname</code></pre><br />Regards, :)<br />QvasiModo</div>
    <div class="meta">Posted on 2003-10-17 12:19:38 by QvasiModo</div>
   </div>
   <div class="post" id="post-121610">
    <div class="subject"><a href="#post-121610">.SWITCH Macro Help ??</a></div>
    <div class="body">Oh QvasiModi , thanks so much .<br />BTW , please you or anyone give me a detailed macro creating tutorial in MASM . <br />I really want learning macro because I don't understand anything when look into MASM macro ;)<br />Really hesitating but true. Perhap I'm too lazy .<br />Hope it will have a series of creating macro like Iczelion tutorials.<br /><br />Edited :<br />QvasiModo , did you test it on MASM 8 and RadASM ???<br />It still not run ..<br />Error Code :<br /><pre><code><br />Assembling&#58; bt11.asm<br />bt11.asm&#40;42&#41; &#58; error A2044&#58; invalid character in file<br /> .case&#40;27&#41;&#58; Macro Called From<br />  bt11.asm&#40;42&#41;&#58; Main Line Code<br />bt11.asm&#40;46&#41; &#58; fatal error A1011&#58; directive must be in control block<br /> .case&#40;13&#41;&#58; Macro Called From<br />  bt11.asm&#40;46&#41;&#58; Main Line Code<br />Make error&#40;s&#41; occured.<br /></code></pre><br /><br />And MySource :<br /><pre><code><br /> mov eax,uMsg<br />    .switch eax<br />    .case WM_INITDIALOG<br />    		invoke GetDlgItem,hWnd,IDC_EDIT<br />    		invoke SetFocus,eax<br />    		.break<br />    .case WM_CLOSE<br />    		invoke SendMessage,hWnd,WM_COMMAND,IDM_EXIT,0<br />    		.break<br />    .case WM_COMMAND<br />    		mov eax,wParam<br />    		.IF lParam==0<br />    			.IF ax==IDM_EXIT<br />    				invoke EndDialog,hWnd,NULL<br />    			.endif<br />    		.endif<br />    		.break 	<br />    .default<br />    		mov eax,FALSE<br />    		ret<br />    .endswitch<br />    mov eax,TRUE<br />    ret<br /></code></pre><br />It generate error on &quot;.CASE&quot; ...</div>
    <div class="meta">Posted on 2003-10-17 22:17:12 by dreamweaver</div>
   </div>
   <div class="post" id="post-121679">
    <div class="subject"><a href="#post-121679">.SWITCH Macro Help ??</a></div>
    <div class="body">This is really weird. There is nothing wrong with your code, and the macros should work fine (I use them in most of my sources). I think the only real error is the &quot;invalid character in file&quot;, and the others are caused by the first (as the .case macro did not work correctly, causing the &quot;directive must be in control block&quot; errors when .if statements get screwed up). Just in case, here's a copy of the macros file I include in my projects. Try this one instead, and tell me how it worked.<br /><br />Also, if the dot at the beggining of the macro name is the cause, try removing it...<br /><br />As for the macros tutorial, I have never seen one (but I'de like to :grin: ). However there are the MASM manuals in PDF format somewhere, they contain the full macro reference (I'll google for a while and see what I can get). Also MASM32.HLP is helpful.</div>
    <div class="meta">Posted on 2003-10-18 15:32:38 by QvasiModo</div>
   </div>
   <div class="post" id="post-121743">
    <div class="subject"><a href="#post-121743">.SWITCH Macro Help ??</a></div>
    <div class="body">I really don't know what happen but your attachment macros works .<br />But the &quot;switch macro&quot; I have before and the &quot;switch&quot; from the attachment are the same ???  :stupid: <br />Though , final it works , and I'm happy :grin: :grin: :grin: Thanks so much :alright:</div>
    <div class="meta">Posted on 2003-10-19 07:53:25 by dreamweaver</div>
   </div>
   <div class="post" id="post-121880">
    <div class="subject"><a href="#post-121880">Re: .SWITCH Macro Help ??</a></div>
    <div class="body"><div class="quote"><br />.SWITCH macros of QvasiModo and bitRAKE from madwizard.org</div><br />I get it now...<br />No, the macros are different. The file I've uploaded are my own version (much simpler), the one from madwizard.org is BitRAKE's original version (much more efficient, but more complicated).<br />Anyway, I'm glad your problem is solved. :)<br /><br />BTW, this link could be useful:<br /><a target="_blank" href="">http://webster.cs.ucr.edu/Page_TechDocs/MASMDoc/</a> <br />:alright:</div>
    <div class="meta">Posted on 2003-10-20 16:37:30 by QvasiModo</div>
   </div>
  </div>
 </body>
</html>