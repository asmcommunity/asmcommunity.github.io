<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Get Explorer's drop destination directory - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2949" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=2949">Get Explorer's drop destination directory</a></p>
   <div class="post" id="post-19114">
    <div class="subject"><a href="#post-19114">Get Explorer's drop destination directory</a></div>
    <div class="body">Hi all<br /><br /><br /><br />I'm back with some more OLE DragDrop.<br /><br />In this case it's a concept I've been developing for the last couple of days (please see my older post on OLE DragDrop for some more info on the subject):<br /><br />I was really pissed by the fact that there is no way for the IDataSource to know where the CF_HDROP files are going to be copied/moved in the shell (i.e. I drop a file from my program in Explorer but I've no clue where it goes).<br />Being able to get the destination directory is a great way to easily implement drag-drop with the Explorer without having to handle all the data &quot;stuff&quot; in the IDataObject interface.<br /><br />My solution might not be the most elegant but apparently it works.<br />For the moment suffice to know that it's based on the undocumented API  SHChangeNotifyRegister<br /><br />Before giving the source to the masses I'd like some of you to test the proggie on your machines (I only have W2K PCs).<br /><br />Just run it ... drag and drop the list item in any of your directories and you should get a MessageBox showing you where the file has been dropped (note that no real file will be created in your HD ... it's just a dummy)<br /><br />Grateful to all those that will try it and will let me know the result<br /><br /><br /><br />ciao<br />Random<br />ps:sorry, but my English is not in tip-top conditions today</div>
    <div class="meta">Posted on 2002-01-14 11:59:11 by random</div>
   </div>
   <div class="post" id="post-19209">
    <div class="subject"><a href="#post-19209">Get Explorer's drop destination directory</a></div>
    <div class="body">On a Win98 orgional recipy machine:<br /><br />I tried dropping on a number of targets, I got a correct responce every time. I tried to fool it by dropping into the 'root' image of MyDocuments, it correctly got that folder was actually under C:\<br /><br />Next I tried dropping into a folder on the desktop. BINGO! It got that right too.<br /><br />Hey!  It works!<br /><br /><br /><br />PS  My english is rairly in tip top condinion even on a good day.</div>
    <div class="meta">Posted on 2002-01-14 21:52:52 by Ernie</div>
   </div>
   <div class="post" id="post-19216">
    <div class="subject"><a href="#post-19216">Get Explorer's drop destination directory</a></div>
    <div class="body">win2K pro here<br />works perfectly :)</div>
    <div class="meta">Posted on 2002-01-14 22:24:30 by Hiroshimator</div>
   </div>
   <div class="post" id="post-19248">
    <div class="subject"><a href="#post-19248">Get Explorer's drop destination directory</a></div>
    <div class="body">works on WinNT<br /><br />strangely enough if I select a .ZIP file as a drop Target, its &quot;hilighted&quot; and if I drop it, the messagebox displays &quot;C:\WINNT\Administrator\Recent&quot;, although the zip file is in C:\TEMP<br /><br />japheth</div>
    <div class="meta">Posted on 2002-01-15 03:07:51 by japheth</div>
   </div>
   <div class="post" id="post-19249">
    <div class="subject"><a href="#post-19249">Get Explorer's drop destination directory</a></div>
    <div class="body">random,<br /><br />Works as advertised on WinME.<br /><br />gscundiff</div>
    <div class="meta">Posted on 2002-01-15 03:08:16 by gscundiff</div>
   </div>
   <div class="post" id="post-19385">
    <div class="subject"><a href="#post-19385">Get Explorer's drop destination directory</a></div>
    <div class="body">Ok ... here's the code. Have fun and let me know what you think<br /><br /><br /><br />Japhet: I'm relying on you for the debugging :-) As for winzip, the way its context handler works is pretty weird.<br /><br /><br />ciao<br />Random</div>
    <div class="meta">Posted on 2002-01-15 17:48:04 by random</div>
   </div>
   <div class="post" id="post-19715">
    <div class="subject"><a href="#post-19715">Get Explorer's drop destination directory</a></div>
    <div class="body">There is a small delay between the drag &amp; drop and the displaying of the MessageBox... is it normal ?<br /><br />(Win98 IE 6.0) It is my office box, I will try tonight with my Win2k one at home...<br /><br />Good work ;)</div>
    <div class="meta">Posted on 2002-01-17 10:59:44 by JCP</div>
   </div>
   <div class="post" id="post-19804">
    <div class="subject"><a href="#post-19804">Get Explorer's drop destination directory</a></div>
    <div class="body">Readiosys, <br />the delay is normal, as it is the time to go through the OLE overhead + the windows' notification delay.<br />It's the same delay you get when you drop a file in a directory and wait for the explorer's folder to refresh in order to display the new file.<br /><br />Random<br /><br />ps: I'm really getting hooked with NAN's and Thomas's OOP model. GREAT WORK guys. I'm creating some CClasses as CTreeView and CListView (hopefully not as bloated as the MFC) for a start and the resulting source code, when using them, looks neat. Might be a big work to create the classes at the beginning but should be great for reusability in the future. Sweet.</div>
    <div class="meta">Posted on 2002-01-18 04:36:54 by random</div>
   </div>
   <div class="post" id="post-19858">
    <div class="subject"><a href="#post-19858">Get Explorer's drop destination directory</a></div>
    <div class="body">Thats the idea... :)<br /><br />I'm thinking of makin a separate download page on my home page for &quot;sharing&quot; classes (with proper credit to the authors).  As well Thomas may add some &quot;extra&quot; features to the new Creator Tool to driectly Access pages like this, to hopefully get a code-bank going  (in time).<br /><br />Anywho, if your ok with it, E-mail me what you would like posted.<br /><br />Have fun!, and glad you like it!<br />PS:  If you find any drawbacks or issues you think should change please feel free to post/email us so we can check it out :) Thanx<br /><br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-01-18 11:37:50 by NaN</div>
   </div>
   <div class="post" id="post-155543">
    <div class="subject"><a href="#post-155543">Get Explorer's drop destination directory</a></div>
    <div class="body">Hi,<br /><br />for my application, i search to find the file name which is modified in a directory. I use FindNextChangeNotification but that does not enable me to find the name. The example of ramdom with &quot;SHChangeNotifyRegister&quot; seems the solution. Does somebody have this example, or a example of code?<br /><br />Thanks for your help,<br /><br />faiseur</div>
    <div class="meta">Posted on 2005-01-10 21:11:51 by Faiseur</div>
   </div>
   <div class="post" id="post-155569">
    <div class="subject"><a href="#post-155569">Get Explorer's drop destination directory</a></div>
    <div class="body">You may find a - slightly modified - version of Random's sample at this link : <a target="_blank" href="http://www.japheth.de/download/dragdrop.zip">http://www.japheth.de/download/dragdrop.zip</a><br /><br />view the MASM32 page on my site - includes a version of windows.inc which should work - in case you get assembler errors</div>
    <div class="meta">Posted on 2005-01-11 04:40:14 by japheth</div>
   </div>
   <div class="post" id="post-155573">
    <div class="subject"><a href="#post-155573">Get Explorer's drop destination directory</a></div>
    <div class="body">Hi japhet,<br /><br />Many thanks ! I will look at this version attentively.</div>
    <div class="meta">Posted on 2005-01-11 05:28:38 by Faiseur</div>
   </div>
  </div>
 </body>
</html>