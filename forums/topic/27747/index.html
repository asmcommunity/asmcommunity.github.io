<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Calling the Windows API from a VxD - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27747" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27747">Calling the Windows API from a VxD</a></p>
   <div class="post" id="post-197797">
    <div class="subject"><a href="#post-197797">Calling the Windows API from a VxD</a></div>
    <div class="body">I have reverse-engineered the General Midi driver from an
old DOS game, to the point where I've been able to write
a program that can play the game's music files (no, the
game does not use the standard Midi format).
I've also read that you can use VxD's to let DOS programs
(which are running in a DOS-Box) call the Windows API.
Here's a link to commercial software that does this:

http://www.wintunnel.com/wingate/wgdev.htm

Because the game I mentioned runs fine in a DOS-Box, I've
been wondering if it's possible to write a VxD that lets
the game's DOS music driver call the Windows multimedia
API.
Walter Oney's "Systems Programming for Windows 95" has a
section on asynchronous procedure calls, but that doesn't
seem like a good approach to this problem, because it
requires a Windows application to process the VxD's
messages.</div>
    <div class="meta">Posted on 2001-04-22 12:17:00 by Limpf</div>
   </div>
  </div>
 </body>
</html>