<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>API func &quot;GetOpenFileName&quot; and it's toolbar - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14790" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14790">API func &quot;GetOpenFileName&quot; and it's toolbar</a></p>
   <div class="post" id="post-114729">
    <div class="subject"><a href="#post-114729">API func &quot;GetOpenFileName&quot; and it's toolbar</a></div>
    <div class="body">There are 2 API funcs GetOpenFileName\GetSaveFileName which produce identical dialog box. In this dialog users can select files/folders. Either of the two has toolbar in upper-right part of dialog box. This toolbar include 4 buttons:<br /><br />Go to previous folder,Go to level-up folder,Create new folder and View select.<br /><br />So I wonder how appearance of this toolbar can be controlled? Can I remove this toolbar from dialog box? Or can I replace picture on button's face with my own?<br /><br />THX for reply in advance!</div>
    <div class="meta">Posted on 2003-08-21 04:59:16 by Smarty</div>
   </div>
   <div class="post" id="post-114731">
    <div class="subject"><a href="#post-114731">API func &quot;GetOpenFileName&quot; and it's toolbar</a></div>
    <div class="body">You can use a hook procedure for the SaveAs or Open dialogs and change the toolbar however you like. I think it is ID # 1088. Remember that that is the OFN_EXPLORER type dialog and the handle that is passed to the hook proc is not the parent of the toolbar but a sibling so in your WM_INITDIALOG you would do a GetParent to find the toolbars parent. At that point you can GetDlgItem to get the handle of the toolbar and add items, changes images or anything you want. If you use a hook proc you will loose the encasing window with the large buttons down the side. Of course you will have to find a way to get info from the toolbar as the WM_COMMAND messages are not sent to the hook, you must find them in the WM_NOTIFY handler.</div>
    <div class="meta">Posted on 2003-08-21 05:10:25 by donkey</div>
   </div>
   <div class="post" id="post-115014">
    <div class="subject"><a href="#post-115014">API func &quot;GetOpenFileName&quot; and it's toolbar</a></div>
    <div class="body">Thank for explanation, donkey! It's all work just as you write! And yes, ID of this toolbar is 440h = 1088d</div>
    <div class="meta">Posted on 2003-08-22 11:07:45 by Smarty</div>
   </div>
  </div>
 </body>
</html>