<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>I don't know where to look - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3412" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=3412">I don't know where to look</a></p>
   <div class="post" id="post-22610">
    <div class="subject"><a href="#post-22610">I don't know where to look</a></div>
    <div class="body"><pre><code>HRESULT load&#40;<br />    VARIANT xmlSource,<br />    VARIANT_BOOL *isSuccessful&#41;;</code></pre><br /><br />this is the call I wish to use on IXMLDOMDocument.<br /><br />I call it as coinvoke psl, IXMLDOMDocument,load,pwsz,addr bla<br /><br />where bla is just a DWORD.<br /><br />yet it gives me this error<br /><div class="quote">xml.asm(58) : error A2114: INVOKE argument type mismatch : argument : 2<br /> coinvoke(16): Macro Called From<br />  xml.asm(58): Main Line Code</div><br /><br />I checked the definition and it's defined as IXMLDOMDocument_loadProto typedef proto IXMLDOMDocument_loadProto :DWORD,:VARIANT,:DWORD (generated by tlb2inc)<br /><br />How come it expects 3? And why am I not getting 'too few arguments' errors?<br /><br />it's probably something I'm not doing correctly with Ernie's CoLib package :-/<br /><br />Any help is appreciated :)<br /><br />thx<br /><br />-H-</div>
    <div class="meta">Posted on 2002-02-03 06:44:52 by Hiroshimator</div>
   </div>
   <div class="post" id="post-22611">
    <div class="subject"><a href="#post-22611">I don't know where to look</a></div>
    <div class="body">maybe this can be of some help</div>
    <div class="meta">Posted on 2002-02-03 07:19:35 by Hiroshimator</div>
   </div>
   <div class="post" id="post-22620">
    <div class="subject"><a href="#post-22620">I don't know where to look</a></div>
    <div class="body">First off, I've never used this stuff, so I can only comment generally.<br /><br /><br />2nd, IXMLDOMDocument_loadProto doesn't appear in my MSDN, so thats two strikes.<br /><br />That being said from your post:<br /><br />HRESULT load(<br />    VARIANT xmlSource,<br />    VARIANT_BOOL *isSuccessful);<br /><br />is completely compatable with:<br /><br />IXMLDOMDocument_loadProto :DWORD,:VARIANT,:DWORD <br /><br />Here is why: <br /><br />The first dword is the THIS pointer, which is assumed and left out of interface documentation.<br /><br />The next one is a VARIANT structure, not a string. A variant might contain a string (actually it contains a bstr, which is a pointer to a lenght prefixed unicode string). That must be exactly that.<br /><br />The third param is a pointer to a variant, thus typed DWORD. But make sure it IS a pointer to such, cause the routine will treat it as such, and step on the following bytes when returning even a zero.<br /><br />So you have exactly the correct count of params, just a typedef error. You need to make a couple variants to keep it completely happy.<br /><br />Somewhere in CoLib variants are defined, so you can just do:<br /><br />MyVariant           VARIANT    {}<br /><br />then use the variant API to fill in the structure. DO FILL IT IN, even for the return value pointer (I'd first make it a BOOL with a value of FALSE).</div>
    <div class="meta">Posted on 2002-02-03 08:14:23 by Ernie</div>
   </div>
   <div class="post" id="post-23222">
    <div class="subject"><a href="#post-23222">I don't know where to look</a></div>
    <div class="body">I've been looking at it more and BSTR handling is really hard it seems (at least it is for me right now :grin: )<br /><br />thx for your explanation, it helped a lot</div>
    <div class="meta">Posted on 2002-02-07 08:18:18 by Hiroshimator</div>
   </div>
   <div class="post" id="post-23231">
    <div class="subject"><a href="#post-23231">I don't know where to look</a></div>
    <div class="body">Hiro, I find them more annoying than hard to handle. But Agreed they are not fun!  I spent a good deal of my time a year ago over this issue (and with Ernie' guidence) and i can't say i have em mastered as of yet... I just try to avoid them when i can..<br /><br />I feel your pain :)<br /><br />BTW:  Ernie released a BSTR lib around the same time, it may be of some use to you (not sure if its in the masm v7 tho?).<br /><br />NaN</div>
    <div class="meta">Posted on 2002-02-07 09:10:40 by NaN</div>
   </div>
   <div class="post" id="post-23473">
    <div class="subject"><a href="#post-23473">I don't know where to look</a></div>
    <div class="body">No, it's not in MASM32, CoLib wasn't upgraded in the new release, you have to pull it off my site.<br /><br />BSTR's are more of a hassle then a problem. If there was an API for &quot;take this ascii string and give me a BSTR&quot; it would be lots easier.<br /><br />But that's not so hard to do, so just bang one out. It's not difficult, and it is gopod practice.<br /><br />Just remember a BSTR is not a string, it is a POINTER to a string.</div>
    <div class="meta">Posted on 2002-02-08 18:33:12 by Ernie</div>
   </div>
   <div class="post" id="post-142079">
    <div class="subject"><a href="#post-142079">I don't know where to look</a></div>
    <div class="body">Afternoon, All.<br /><br />Please excuse the resurrection of this thread (which is over two years old :tongue: ).<br /><br />I was looking into how to use XML DOM object for loading/ reading xml documents and stumbled across this thread where harold had already built the msxml.inc file.<br /><br />After a bit more searching/ reading/ etc I've been able to adjust Harold's code so that it works.<br /><br />Note that there's practically no comments (if any ;) ) so you might find it easier to have a look at the &quot;\Program Files\Microsoft Platform SDK\Samples\Web\xml\c++_samples&quot; example if you've got it.<br /><br />I'm working on something a little bit clearer however I thought I'd chuck what I've done up here for any comments.<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2004-05-25 08:08:04 by Scronty</div>
   </div>
   <div class="post" id="post-142280">
    <div class="subject"><a href="#post-142280">I don't know where to look</a></div>
    <div class="body">Greetings All, <br />VARIANT_BOOLs are WORDS not DWORDs, so the original code fragment would have compiled if you were to have instantiated <strong>bla</strong> as a WORD.  <br /><br />I also developed some XSL/XML code awhile ago, hopefully this will serve <br />as useful example code:</div>
    <div class="meta">Posted on 2004-05-27 21:57:04 by Poimander</div>
   </div>
   <div class="post" id="post-142735">
    <div class="subject"><a href="#post-142735">I don't know where to look</a></div>
    <div class="body">I'm presenting an updated version of <strong>tlixml</strong>. The code now employs <strong>UrlCreateFromPath</strong> removing the dependence upon the particular <strong>UNC</strong> path of the generated HTML file. The ShowHTML routine is also improved.</div>
    <div class="meta">Posted on 2004-06-02 19:08:08 by Poimander</div>
   </div>
  </div>
 </body>
</html>