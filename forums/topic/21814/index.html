<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>inline asm - storing/returning value of eax - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21814" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21814">inline asm - storing/returning value of eax</a></p>
   <div class="post" id="post-164569">
    <div class="subject"><a href="#post-164569">inline asm - storing/returning value of eax</a></div>
    <div class="body">well firstly sorry i am still just learning, and i know almost nothing about asm<br /><br />here is my code:<br /><br /><pre><code>DWORD dwGetPeb()<br />{	<br />	unsigned long pPeb = NULL;<br /><br />	__asm {<br />		mov eax,fs:[00000018h] <br />		mov eax,dword ptr //TEB base addr+Peb pointer offset<br />		ret<br />	}<br />}</code></pre><br /><br />atm nothing is returned to dwGetPeb function<br /><br />i need to:<br />- store address of eax<br />- return it to the function<br /><br />thanks a lot for any help</div>
    <div class="meta">Posted on 2005-09-15 14:09:34 by raz_1</div>
   </div>
   <div class="post" id="post-164571">
    <div class="subject"><a href="#post-164571">Re: inline asm - storing/returning value of eax</a></div>
    <div class="body"><pre><code>DWORD dwGetPeb()<br />{&nbsp;  <br />&nbsp;  unsigned long pPeb = NULL;<br /><br />&nbsp;  __asm {<br />&nbsp; &nbsp; &nbsp; mov eax,fs:[00000018h] <br />&nbsp; &nbsp; &nbsp; mov eax,dword ptr //TEB base addr+Peb pointer offset<br />&nbsp; &nbsp; &nbsp; mov , eax<br />&nbsp;  }<br />&nbsp;  return pPeb;<br />}</code></pre></div>
    <div class="meta">Posted on 2005-09-15 16:47:36 by ti_mo_n</div>
   </div>
  </div>
 </body>
</html>