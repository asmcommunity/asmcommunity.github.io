<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Using the SendTo folder - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18567" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18567">Using the SendTo folder</a></p>
   <div class="post" id="post-143720">
    <div class="subject"><a href="#post-143720">Using the SendTo folder</a></div>
    <div class="body">Hello everybody,<br /><br />I need to know your opinions of this:  usually the SendTo folder has shortcuts that can be executed when you right click an object in the explorer window.  Shortcuts are a lot of trouble and though I downloaded Donkey's example I still don't understand them so I just copied my executable to the SendTo folder and it now appears on the SendTo menu.  Is anything wrong with doing this?  or is there some reason I don't know about that restricts the SendTo folder to shortcuts only?<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2004-06-14 00:32:25 by czDrillard</div>
   </div>
   <div class="post" id="post-143722">
    <div class="subject"><a href="#post-143722">Using the SendTo folder</a></div>
    <div class="body">Hi czDrillard,<br /><br />Was there a problem with the shortcut library I posted ? It was originally written for GoAsm and so there may be a problem with MASM I am unaware of but it should work fine with it. I you would like I can do a special function to add a shortcut to the SendTo folder, it isn't a problem at all.</div>
    <div class="meta">Posted on 2004-06-14 00:41:27 by donkey</div>
   </div>
   <div class="post" id="post-143737">
    <div class="subject"><a href="#post-143737">Using the SendTo folder</a></div>
    <div class="body">Donkey, there was no problem with the shortcut lib.  the problem is maybe with me.  I'm not sure how to use this library.  In particular I'm interested in the MakeLink proc.  I should be able to substitute the path for the SendTo directory in it and build the program.  I haven't tried this yet as I thought copying my exe to the SendTo folder looked simpler.  But I will try it and let you know how I make out.<br /><br />best regards and thanks for your reply,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2004-06-14 08:27:02 by czDrillard</div>
   </div>
   <div class="post" id="post-143747">
    <div class="subject"><a href="#post-143747">Using the SendTo folder</a></div>
    <div class="body">There shouldn't be anything wrong with copying your EXE to the sendto folder, at least not as long as you copy it to the per-user folder (same goes for shortcuts though, I believe). It just feels somewhat &quot;dirty&quot; to do this rather than creating a link :)</div>
    <div class="meta">Posted on 2004-06-14 09:08:42 by f0dder</div>
   </div>
   <div class="post" id="post-143748">
    <div class="subject"><a href="#post-143748">Using the SendTo folder</a></div>
    <div class="body">Hi,<br /><br />If you look at this thread<br /><br /><a target="_blank" href="http://masmforum.com/viewtopic.php?t=3144">http://masmforum.com/viewtopic.php?t=3144</a><br /><br />I posted a &quot;work in progress&quot; files library in the GoAsm forum, it has a more complete set of link functions including ...<br /><br /><pre><code>CreateSpecialFolderLink&#58;<br />	This is a wrapper function for CreateLink that creates a link in a special folder<br />	It works the same as CreateLink except that the path is not supplied with lpLinkName<br />	Parameters&#58;<br />		lpLinkTarget = Pointer to the fully qualified path of the link target<br />		lpLinkName = Pointer to a name for the link file<br />		lpDescription = A description to add to the link, can be NULL<br />		csidl = The class ID of the special folder<br />			see the following url for a list of possible values &#58;<br />			&#91;url&#93;http&#58;//msdn.microsoft.com/library/default.asp?url=/library/en-us/shellcc/platform/shell/reference/enums/csidl.asp&#91;/url&#93;<br />	The first icon in the file is used for the link icon<br />	The extension .LNK is added to lpLinkName automatically<br />	If lpDescription is NULL, no description will be added<br />	CoInitialize must be called at some point in your program before this function<br />	Returns 0 if successful</code></pre><br /><br />This library has been tested under GoAsm only, though it should work fine with MASM. Source is included in the zip so if you have to you can translate it easily.</div>
    <div class="meta">Posted on 2004-06-14 09:11:34 by donkey</div>
   </div>
   <div class="post" id="post-143866">
    <div class="subject"><a href="#post-143866">Using the SendTo folder</a></div>
    <div class="body">I'm still trying to build the sample asm files but get missing filename everytime.  If I can't get this thing working I'm going to have to play in the dirt like f0dder says :) <br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2004-06-15 08:36:41 by czDrillard</div>
   </div>
   <div class="post" id="post-143877">
    <div class="subject"><a href="#post-143877">Using the SendTo folder</a></div>
    <div class="body">Mmmm,<br /><br />I still do not see the difficulty here. I have attached a demonstration of creating a link in the sendto folder that works here just fine. It is exactly the same as the one to create a desktop one but with the CLSID changed. I also added one undocumented function (ILFree) to free the id list returned by SHGetSpecialFolderLocation.<br /><br />The demo just uses the GetOpenFileName dialog, you select any file and it will create a link in the SendTo folder of the current user.<br /><br /> I had a little time so I tested the demo under Win95, Win98SE, Win2K and WinNT4 and it worked perfectly in all cases. I checked the link by double clicking it and the link was always good. I don't have ME or XP so I can't check those</div>
    <div class="meta">Posted on 2004-06-15 12:42:42 by donkey</div>
   </div>
   <div class="post" id="post-143887">
    <div class="subject"><a href="#post-143887">Using the SendTo folder</a></div>
    <div class="body">Works perfectly here, donkey - WinXP SP1a, running with admin privileges. As expected, it creates the shortcut correctly, for the current user.</div>
    <div class="meta">Posted on 2004-06-15 13:43:58 by f0dder</div>
   </div>
   <div class="post" id="post-143948">
    <div class="subject"><a href="#post-143948">Using the SendTo folder</a></div>
    <div class="body">Thanks donkey, I can't find much documentation on this subject, at least documentation that I can understand so I appreciate your help. Got everything working great now other than the description.  <br /><br />I changed <em>invoke MakeSendToLink,offset FilePath,offset FileTitle,<strong>NULL</strong> </em> to <em>invoke MakeSendToLink,offset FilePath,offset FileTitle, <strong>ADDR szDescription</strong></em> where szDescription is the name I want to show up in the SendTo menu.  It compiled and ran properly but the name stayed the same.  Have you got any suggestions on this?<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2004-06-15 23:21:23 by czDrillard</div>
   </div>
   <div class="post" id="post-143949">
    <div class="subject"><a href="#post-143949">Using the SendTo folder</a></div>
    <div class="body">The description is the description of the file that pops up when you hover the mouse over it in XP or in the quicklaunch bar, to change the name of the link file just put whatever you want it to be called in place of <strong>FileTitle</strong></div>
    <div class="meta">Posted on 2004-06-15 23:30:41 by donkey</div>
   </div>
   <div class="post" id="post-144075">
    <div class="subject"><a href="#post-144075">Using the SendTo folder</a></div>
    <div class="body">Using shortcuts in the SendTo folder is mainly a matter of program file management.  Seeing that Windows offer 6 ways to do things.  The executable should be centrally located in Program Files.  Then using shortcuts to give access in different spot around Windows.  Desktop, SendTo, StartMenu, etc.<br /><br />So you have only one spot to update the executable.<br /><br />Regards,  P1 :cool:</div>
    <div class="meta">Posted on 2004-06-16 22:42:37 by Pone</div>
   </div>
  </div>
 </body>
</html>