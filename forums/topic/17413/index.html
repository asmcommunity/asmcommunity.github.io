<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>DirectDraw Screen Capture - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17413" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=17413">DirectDraw Screen Capture</a></p>
   <div class="post" id="post-134820">
    <div class="subject"><a href="#post-134820">DirectDraw Screen Capture</a></div>
    <div class="body">Some media players use hardware acceleration for output (for example Windows Media Player and vlc). It is impossible to take a screenshot with Print Screen, the video will show up black on the captured bitmap. I have tried to capture via DirectDraw - create primary interface, lock it, copy data, and write to bitmap. Capture still turned out to be black :(<br />Shouldn't locking primary surface give me access to actual video memory?</div>
    <div class="meta">Posted on 2004-02-25 22:08:04 by comrade</div>
   </div>
   <div class="post" id="post-134823">
    <div class="subject"><a href="#post-134823">DirectDraw Screen Capture</a></div>
    <div class="body"><div class="quote">In previous versions of DirectX, we might have locked the primary surface and read the pixel data from the frame buffer.  However, as of the release of DirectX 8, direct access to the primary surface memory is no longer available.  Instead, the GetFrontBuffer() provides a facility to retrieve the contents of the frame buffer to an image surface in system memory.  Format conversion is automatically performed, converting from the current display format to a fixed format of A8R8G8B8.</div><br /><a target="_blank" href="http://www.mvps.org/directx/articles/screengrab.htm">http://www.mvps.org/directx/articles/screengrab.htm</a><br /><br />Have a nice day :)<br /><br />Say, it just occurred to me that I can use this myself to &quot;render to a surface&quot; without the associated specialized render code - this would allow me to (for example) copy the &quot;Pause Menu&quot; to a surface, and then apply it to a textured quad, then when the user unpauses / returns to game, &quot;throw&quot; the quad in Z as a cute transition/wipe effect :)</div>
    <div class="meta">Posted on 2004-02-25 22:41:44 by Homer</div>
   </div>
   <div class="post" id="post-134843">
    <div class="subject"><a href="#post-134843">DirectDraw Screen Capture</a></div>
    <div class="body">i think media player and vlc use overlay surface, you cannot capture overlay screen from primary surface...</div>
    <div class="meta">Posted on 2004-02-26 06:28:09 by kamilh</div>
   </div>
   <div class="post" id="post-134846">
    <div class="subject"><a href="#post-134846">DirectDraw Screen Capture</a></div>
    <div class="body">Yes, they do use overlay surface. What can I do?</div>
    <div class="meta">Posted on 2004-02-26 07:16:56 by comrade</div>
   </div>
   <div class="post" id="post-134848">
    <div class="subject"><a href="#post-134848">DirectDraw Screen Capture</a></div>
    <div class="body"><strong>EvilHomer2k</strong>, that does not help. I am not using new DirectX, but rather old ddraw interface. This same idea, but different implementation.</div>
    <div class="meta">Posted on 2004-02-26 07:25:57 by comrade</div>
   </div>
   <div class="post" id="post-134854">
    <div class="subject"><a href="#post-134854">DirectDraw Screen Capture</a></div>
    <div class="body">I figured if you are instancing DX7 from &gt;DX8 runtimes that the issue would be relevant to you, although m$ claim backward compatibility, we all know what they say and what they mean can be mutually exclusive :tongue:</div>
    <div class="meta">Posted on 2004-02-26 09:03:56 by Homer</div>
   </div>
   <div class="post" id="post-134857">
    <div class="subject"><a href="#post-134857">DirectDraw Screen Capture</a></div>
    <div class="body">Howdy, comrade! I googled around a bit, and it seems that even screen grabber software writers have problems with grabbing overlay images :)<br /><br />At least two different programs mentioned similar methods: &quot;turn on DirectX screen grabbing and be sure the window you want to grab from is foreground&quot; - so it would seem that you need the HWND of the app to grab. Perhaps this means you have to do code injection, perhaps there's some DX/Overlay stuff you can call with the HWND. Does seem like there's some work to this...<br /><br />If you just need some application to do this, <a target="_blank" href="http://www.creativesoftworx.com/">http://www.creativesoftworx.com/</a> might work. Or you might have a look at the imports of the program to see if there's any hints.<br /><br />The search terms I was using didn't give anything more substantial in the first four pages or so.<br /><br />Homer, isn't this problem only relevant if you use DX interfaces &gt; 7? Using DX7 interface with DX8 installed should still allow you to lock the primary surface, shouldn't it? (And this still wouldn't give access to overlays anyway).</div>
    <div class="meta">Posted on 2004-02-26 09:16:28 by f0dder</div>
   </div>
   <div class="post" id="post-134888">
    <div class="subject"><a href="#post-134888">DirectDraw Screen Capture</a></div>
    <div class="body">Thanks</div>
    <div class="meta">Posted on 2004-02-26 17:27:41 by comrade</div>
   </div>
   <div class="post" id="post-134904">
    <div class="subject"><a href="#post-134904">DirectDraw Screen Capture</a></div>
    <div class="body"><a target="_blank" href="http://www.hallogram.com/snagit/">This</a> tool claims to do what you want, so atleast it is possible.:)</div>
    <div class="meta">Posted on 2004-02-26 23:22:10 by bitRAKE</div>
   </div>
  </div>
 </body>
</html>