<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Scrollbars again - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13657" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=13657">Scrollbars again</a></p>
   <div class="post" id="post-105807">
    <div class="subject"><a href="#post-105807">Scrollbars again</a></div>
    <div class="body">To my real surprise if you load a menu with LoadMenu and then use SetMenu, the menu is a part of the client area and its size should be substracted from the size of vertical scrolbar at WM_SIZE in order to reposition the scrollbar corectly... at runtime. <br /><br />It hought that window menus are non-client areas...i was wrong<br /><br /><br />This issue is for scrolbars created with CreatWindowEx not the default window scrollbars...<br /><br />So i was wondering:<br />1) how do i get all those little bits needed to resize/reposition controls at runtime use MoveWIndow like: scrolbars size, menu size, toolbar sizes etc etc?<br />2)Is there an easyer way than to use MoveWindow for all childs in WM_SIZE message processing?</div>
    <div class="meta">Posted on 2003-06-02 20:36:49 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-105810">
    <div class="subject"><a href="#post-105810">Scrollbars again</a></div>
    <div class="body">I suppose that all of that information is in the system metrics. Try GetSystemMetrics it should have a flag for the menu height etc...</div>
    <div class="meta">Posted on 2003-06-02 21:28:39 by donkey</div>
   </div>
   <div class="post" id="post-105815">
    <div class="subject"><a href="#post-105815">Scrollbars again</a></div>
    <div class="body">Apparently, the client area is set by responding to WM_NCCALCSIZE. This message is supposed to be sent when the window is resized or moved. Not sure what happens when menus and scrollbars are drawn in the nonclient area.</div>
    <div class="meta">Posted on 2003-06-02 23:04:42 by tenkey</div>
   </div>
  </div>
 </body>
</html>