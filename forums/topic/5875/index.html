<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>OpenGL light problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5875" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=5875">OpenGL light problem</a></p>
   <div class="post" id="post-42078">
    <div class="subject"><a href="#post-42078">OpenGL light problem</a></div>
    <div class="body">In my opengl program, all i have is a single quad with a light above it. When i call the code to set the information for the light before i call gluLookAt, the light shows, but not in the right place. When i call the code after i call gluLookAt, the light doesnt show up at all. I would like to know why it doesnt work the way i want it to.<br /><br />Here are the source files. The code is in c, but thats ok because this isnt a langauge problem.<br /><br />main.c<br /><pre><code>#include &lt;stdlib.h&gt;<br />#include &lt;GL/glut.h&gt;<br />#include &quot;main.h&quot;<br /><br />/* app settings */<br />int	appPaused		= 0;<br />void	&#40;*appPolygonMode&#41;&#40;&#41;	= 0;<br /><br />/* light 0 */<br />GLfloat light0Ambient		&#91;4&#93; = &#123;   0.0f, 0.0f, 0.0f, 1.0f &#125;;<br />GLfloat light0Diffuse		&#91;4&#93; = &#123;   1.0f, 1.0f, 1.0f, 1.0f &#125;;<br />GLfloat light0Position		&#91;4&#93; = &#123;   0.0f, 1.0f, 0.0f, 1.0f &#125;;<br />GLfloat light0Specular		&#91;4&#93; = &#123;   1.0f, 1.0f, 1.0f, 1.0f &#125;;<br />GLfloat light0SpotCutOff	&#91;1&#93; = &#123; 180.0f                   &#125;;<br />GLfloat light0SpotDirection	&#91;3&#93; = &#123;   0.0f, 1.0f, 0.0f       &#125;;<br />GLfloat light0SpotExponent	&#91;1&#93; = &#123;   0.0f                   &#125;;<br /><br />/* floor */<br />GLuint	floorList;<br />GLfloat floorAmbient		&#91;4&#93; = &#123;   0.0f, 0.0f, 0.0f, 1.0f &#125;;<br />GLfloat floorDiffuse		&#91;4&#93; = &#123;   1.0f, 0.0f, 0.0f, 1.0f &#125;;<br />GLfloat floorEmission		&#91;4&#93; = &#123;   0.0f, 0.0f, 0.0f, 1.0f &#125;;<br />GLfloat floorShininess		&#91;1&#93; = &#123; 128.0f                   &#125;;<br />GLfloat floorSpecular		&#91;4&#93; = &#123;   1.0f, 0.0f, 0.0f, 1.0f &#125;;<br /><br />int main&#40;int argc, char* argv&#91;&#93;&#41;<br />&#123;<br />	glutInit&#40;&amp;argc, argv&#41;;<br />	glutInitDisplayMode&#40;GLUT_DEPTH | GLUT_DOUBLE | GLUT_RGBA&#41;;<br />	glutInitWindowPosition&#40;0, 0&#41;;<br />	glutInitWindowSize&#40;320, 200&#41;;<br />	glutCreateWindow&#40;argv&#91;0&#93;&#41;;<br />	init&#40;&#41;;<br />	glutMainLoop&#40;&#41;;<br />	return&#40;0&#41;;<br />&#125;<br /><br />void display&#40;void&#41;<br />&#123;<br />	glClear&#40;GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT&#41;;<br />	glLoadIdentity&#40;&#41;;<br />	/* with setLight0 here, the light shows, but in the wrong place */<br />	gluLookAt&#40;0.0f, 5.0f, 15.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.0f, 0.0f&#41;;<br />	/* here, the light just doesnt show */<br />	setLight0&#40;&#41;;<br /><br />	glCallList&#40;floorList&#41;;<br /><br />	glutSwapBuffers&#40;&#41;;<br />&#125;<br /><br />void idle&#40;void&#41;<br />&#123;<br />	if&#40;!appPaused&#41;<br />	&#123;<br />		glutPostRedisplay&#40;&#41;;<br />	&#125;<br />&#125;<br /><br />void init&#40;void&#41;<br />&#123;<br />	/* color */<br />	glClearColor&#40;0.0f, 0.0f, 0.0f, 0.0f&#41;;<br />	glShadeModel&#40;GL_SMOOTH&#41;;<br /><br />	/* depth testing */<br />	glEnable&#40;GL_DEPTH_TEST&#41;;<br /><br />	/* culling */<br />	glFrontFace&#40;GL_CW&#41;;<br />	glCullFace&#40;GL_BACK&#41;;<br />	glEnable&#40;GL_CULL_FACE&#41;;<br /><br />	/* lighting */<br />	glEnable&#40;GL_LIGHT0&#41;;<br />	glEnable&#40;GL_LIGHTING&#41;;<br /><br />	/* glut */<br />	atexit&#40;quit&#41;;<br />	glutDisplayFunc&#40;display&#41;;<br />	glutIdleFunc&#40;idle&#41;;<br />	glutKeyboardFunc&#40;keyboard&#41;;<br />	glutReshapeFunc&#40;reshape&#41;;<br /><br />	/* defaults */<br />	setPolygonModeFill&#40;&#41;;<br /><br />	/* floor */<br />	floorList = glGenLists&#40;1&#41;;<br />	glNewList&#40;floorList, GL_COMPILE&#41;;<br />		glMaterialfv&#40;GL_FRONT, GL_AMBIENT, floorAmbient&#41;;<br />		glMaterialfv&#40;GL_FRONT, GL_DIFFUSE, floorDiffuse&#41;;<br />		glMaterialfv&#40;GL_FRONT, GL_EMISSION, floorEmission&#41;;<br />		glMaterialfv&#40;GL_FRONT, GL_SHININESS, floorShininess&#41;;<br />		glMaterialfv&#40;GL_FRONT, GL_SPECULAR, floorSpecular&#41;;<br />		glBegin&#40;GL_TRIANGLE_STRIP&#41;;<br />			glNormal3f&#40;  0.0f, 1.0f,   0.0f&#41;;<br />			glVertex3f&#40;-10.0f, 0.0f, -10.0f&#41;;<br />			glVertex3f&#40; 10.0f, 0.0f, -10.0f&#41;;<br />			glVertex3f&#40;-10.0f, 0.0f,  10.0f&#41;;<br />			glVertex3f&#40; 10.0f, 0.0f,  10.0f&#41;;<br />		glEnd&#40;&#41;;<br />	glEndList&#40;&#41;;<br />&#125;<br /><br />void keyboard&#40;unsigned char key, int x, int y&#41;<br />&#123;<br />	switch&#40;key&#41;<br />	&#123;<br />	case 'q'&#58; exit&#40;0&#41;;			break;<br />	case 'p'&#58; appPaused = appPaused ^ 1;	break;<br />	case 'm'&#58; appPolygonMode&#40;&#41;;		break;<br />	&#125;<br /><br />	glutPostRedisplay&#40;&#41;;<br />&#125;<br /><br />void quit&#40;void&#41;<br />&#123;<br />	glDeleteLists&#40;floorList, 1&#41;;<br />&#125;<br /><br />void reshape&#40;int w, int h&#41;<br />&#123;<br />	if&#40;h == 0&#41;<br />	&#123;<br />		h = 1;<br />	&#125;<br /><br />	glViewport&#40;0, 0, w, h&#41;;<br /><br />	glMatrixMode&#40;GL_PROJECTION&#41;;<br />	glLoadIdentity&#40;&#41;;<br />	gluPerspective&#40;60.0f, &#40;GLfloat&#41;w/&#40;GLfloat&#41;h, 0.1f, 100.0f&#41;;<br /><br />	glMatrixMode&#40;GL_MODELVIEW&#41;;<br />&#125;<br /><br />void setLight0&#40;void&#41;<br />&#123;<br />	glLightfv&#40;GL_LIGHT0, GL_AMBIENT, light0Ambient&#41;;<br />	glLightfv&#40;GL_LIGHT0, GL_DIFFUSE, light0Diffuse&#41;;<br />	glLightfv&#40;GL_LIGHT0, GL_POSITION, light0Position&#41;;<br />	glLightfv&#40;GL_LIGHT0, GL_SPECULAR, light0Specular&#41;;<br />	glLightfv&#40;GL_LIGHT0, GL_SPOT_CUTOFF, light0SpotCutOff&#41;;<br />	glLightfv&#40;GL_LIGHT0, GL_SPOT_DIRECTION, light0SpotDirection&#41;;<br />	glLightfv&#40;GL_LIGHT0, GL_SPOT_EXPONENT, light0SpotExponent&#41;;<br />&#125;<br /><br />void setPolygonModeFill&#40;void&#41;<br />&#123;<br />	glPolygonMode&#40;GL_FRONT, GL_FILL&#41;;<br />	appPolygonMode = setPolygonModeLine;<br />&#125;<br /><br />void setPolygonModeLine&#40;void&#41;<br />&#123;<br />	glPolygonMode&#40;GL_FRONT, GL_LINE&#41;;<br />	appPolygonMode = setPolygonModePoint;<br />&#125;<br /><br />void setPolygonModePoint&#40;void&#41;<br />&#123;<br />	glPolygonMode&#40;GL_FRONT, GL_POINT&#41;;<br />	appPolygonMode = setPolygonModeFill;<br />&#125;</code></pre><br /><br />main.h<br /><pre><code>#ifndef _MAIN_H<br />#define _MAIN_H<br /><br />void	display&#40;void&#41;;<br />void	idle&#40;void&#41;;<br />void	init&#40;void&#41;;<br />void	keyboard&#40;unsigned char, int, int&#41;;<br />void	quit&#40;void&#41;;<br />void	reshape&#40;int, int&#41;;<br />void	setLight0&#40;void&#41;;<br />void	setPolygonModeFill&#40;void&#41;;<br />void	setPolygonModeLine&#40;void&#41;;<br />void	setPolygonModePoint&#40;void&#41;;<br /><br />#endif /* _MAIN_H */</code></pre><br /><br />And just in case, heres the Makefile<br /><pre><code>APP		&#58;= plane<br />OBJS		&#58;= main.o<br />DEPS		&#58;= $&#40;OBJS&#58;.o=.d&#41;<br /><br />CC		&#58;= gcc<br />CFLAGS		&#58;= -pipe<br />CPPFLAGS	&#58;= -Wall<br />TARGET_ARCH	&#58;=<br />RM		&#58;= rm -f<br /><br />ifdef RELEASE<br />	CFLAGS		+= -s -O3 -ffast-math<br />	TARGET_ARCH	+= -march=i686<br />else<br />	CFLAGS		+= -g<br />endif<br /><br />LD		&#58;= $&#40;CC&#41;<br />LDFLAGS		&#58;= $&#40;CFLAGS&#41;<br />LDLIBS		&#58;= -lGL -lGLU -lglut<br /><br />%.d &#58; %.c<br />	$&#40;CC&#41; $&#40;CFLAGS&#41; $&#40;CPPFLAGS&#41; -MM -o $@ $&lt;<br /><br />$&#40;APP&#41;	&#58; $&#40;OBJS&#41;<br />	$&#40;LD&#41; $&#40;LDFLAGS&#41; -o $@ $^ $&#40;LDLIBS&#41;<br />-include $&#40;DEPS&#41;<br /><br />clean&#58;<br />	$&#40;RM&#41; $&#40;APP&#41;<br />	$&#40;RM&#41; $&#40;OBJS&#41;<br />	$&#40;RM&#41; $&#40;DEPS&#41;</code></pre></div>
    <div class="meta">Posted on 2002-06-08 23:55:08 by ChimpFace9000</div>
   </div>
   <div class="post" id="post-42658">
    <div class="subject"><a href="#post-42658">OpenGL light problem</a></div>
    <div class="body">Might it be in the spot light direction, should it be 0.0f, -1.0f, 0.0f instead.<br /><br />Or perhaps the position should have a negative Y component</div>
    <div class="meta">Posted on 2002-06-11 12:45:10 by EÃ³in</div>
   </div>
   <div class="post" id="post-42805">
    <div class="subject"><a href="#post-42805">OpenGL light problem</a></div>
    <div class="body">I'm not sure, but perhaps if you set the normal for the polygon, the light would display correctly?<br /><br />Dig</div>
    <div class="meta">Posted on 2002-06-12 03:17:47 by dig</div>
   </div>
   <div class="post" id="post-45158">
    <div class="subject"><a href="#post-45158">LIGHT PROBLEM</a></div>
    <div class="body">i have a problem with lights in opengl.<br /><br />1. i set the light position, type, materials, etc<br />2. i render object<br /><br />as for now - everything is ok, but:<br /><br />3. i use glRotatef()<br />4. ...render object..<br /><br />and here's my problem<br /><br />light moves along with the object!!!<br /><br />when object rotates, light does so.<br /><br />what do i need to do if i want my object to rotate and light to stay in position?<br /><br />ps:  current matrix is modelview when i use glRotatef on this object, if i use projection matrix, my whole scene moves (but it's normal).<br /><br />any ideas?</div>
    <div class="meta">Posted on 2002-06-25 13:02:35 by ti_mo_n</div>
   </div>
   <div class="post" id="post-45181">
    <div class="subject"><a href="#post-45181">OpenGL light problem</a></div>
    <div class="body">Light position is transformed with the current modelview matrix. So:<br /><br />1.Set light position<br />2.glRotate, glTranslate<br />3.Draw <br /><br />is different from<br /><br />1.glRotate, glTranslate<br />2.Set light position<br />3.Draw<br /><br />In first case, light position is fixed, in the second case light will rotate (translate)...</div>
    <div class="meta">Posted on 2002-06-25 17:32:53 by minimoog</div>
   </div>
   <div class="post" id="post-45735">
    <div class="subject"><a href="#post-45735">thanx...</a></div>
    <div class="body">thanx, it really works!</div>
    <div class="meta">Posted on 2002-06-29 12:22:33 by ti_mo_n</div>
   </div>
  </div>
 </body>
</html>