<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Favourites Menu - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17683" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=42">RadASM</a> &raquo; <a href="../?id=17683">Favourites Menu</a></p>
   <div class="post" id="post-136625">
    <div class="subject"><a href="#post-136625">Favourites Menu</a></div>
    <div class="body">I have made an addin to add a favourites menu to RadASM.<br /><br />This addin will add a menu to the main menu bar that will let you add the current project to your favourites. The fav list is not affected by the MRU so it allows you to keep your main projects available as a menu item without having them knocked off the MRU every time you open 4 other projects. The main advantage is to be able to have quick access to critical projects but still have the MRU for what it is meant to do.<br /><br />The favourites list is fully manageable and uses a separate INI file so that upgrades to RadASM will not overwrite it. You can specify a menu label for each project or use the description you entered when it was created as a default. To move items up or down in the menu order simply drag them where they should go in the Manager dialog. Right click on an item in the Manager dialog to delete it. No changes that you make in the Manager dialog are saved until you press OK.<br /><br />This is a first test, please report any bugz.</div>
    <div class="meta">Posted on 2004-03-21 21:07:43 by donkey</div>
   </div>
   <div class="post" id="post-136629">
    <div class="subject"><a href="#post-136629">Favourites Menu</a></div>
    <div class="body">Works great! And is just what I needed.<br /><br />Cheers,<br />JC</div>
    <div class="meta">Posted on 2004-03-21 21:42:56 by JimmyClif</div>
   </div>
   <div class="post" id="post-136631">
    <div class="subject"><a href="#post-136631">Favourites Menu</a></div>
    <div class="body">Thanks JimmyClif,<br /><br />I have wanted to do this one for a while and finally got around to finishing it this weekend. There was a problem with the stupid LB_ITEMFROMPOINT message, I should have read the API ref on it. I assumed that it returned LB_ERR if the cursor was not on an item, like every other LB_ message. But it reports a no-hit in the high-order word and passes the lo-order normally, schitzo-API as usual :mad: <br /><br />Anyway, the end result was that the context menu in the manager would open anywhere, it has been fixed.<br /><br />Converted UTC file times to local times.</div>
    <div class="meta">Posted on 2004-03-21 21:59:52 by donkey</div>
   </div>
   <div class="post" id="post-136683">
    <div class="subject"><a href="#post-136683">Favourites Menu</a></div>
    <div class="body">Just a minor cosmetic update. When you right clicked an item in the Favourites Manager the project details would not be updated. I have corrected this and uploaded a new version.</div>
    <div class="meta">Posted on 2004-03-22 12:01:45 by donkey</div>
   </div>
   <div class="post" id="post-136752">
    <div class="subject"><a href="#post-136752">Favourites Menu</a></div>
    <div class="body">Hello Donky<br />This Addin is a very practical idea.  :alright: <br /><br />I tested it and found that when I want to delete all Fav-Items using the Fav-Manager, I can't delete the last one. It simply remains one.<br /><br />Regards,<br /><br />Biterider</div>
    <div class="meta">Posted on 2004-03-23 01:38:38 by Biterider</div>
   </div>
   <div class="post" id="post-136754">
    <div class="subject"><a href="#post-136754">Favourites Menu</a></div>
    <div class="body">Hi Biterider,<br /><br />Yes, I had missed that one. I checked to make sure that there was data to be processed in the listbox and cleared the INI and exited if there was none. The routine would properly update the INI file but the menu was not being emptied, I have fixed it to free the memory and remove the items from the menu. New upload at the top.</div>
    <div class="meta">Posted on 2004-03-23 01:52:05 by donkey</div>
   </div>
   <div class="post" id="post-136760">
    <div class="subject"><a href="#post-136760">Favourites Menu</a></div>
    <div class="body">Redoing the delete function has revealed a problem with the memory deallocation scheme that I was using. There was a problem with the handle values passed because the values in the MENUITEMINFO structure were being overwritten by the GetMenuItemInfo function, I had assumed that I only had to set cbSize once and it would remain static, this does not appear to be true. This seems only to be the case in Win2K but it would result in the global blocks not being freed and memory accumulating until RadASM exited. The amount of memory was trivial and inconsequential if you did not edit the menu often but could conceivably add up with over 10 or 20 edits with 50 or more favourites. It has been corrected and a new upload is available.</div>
    <div class="meta">Posted on 2004-03-23 03:01:34 by donkey</div>
   </div>
   <div class="post" id="post-136803">
    <div class="subject"><a href="#post-136803">Favourites Menu</a></div>
    <div class="body">For those people who still use NT4 or Win95 the addin could GPF if you loaded it. The Get/SetMenuInfo functions are not available in those OS versions. I have loaded them manually so that the favourites will still be fully functional under those OS versions but the custom colors won't be added to the menu. Since this addin is now added to RadASM 2042, I have begun incrementing the version numbers, the NT4/95 compatible version is 1.0.0.1, it will still work the same as before in all other OS versions.</div>
    <div class="meta">Posted on 2004-03-23 12:16:44 by donkey</div>
   </div>
  </div>
 </body>
</html>