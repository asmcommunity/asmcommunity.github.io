<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Windows 7 and Mouse Hooks outside of main window - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30935" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=30935">Windows 7 and Mouse Hooks outside of main window</a></p>
   <div class="post" id="post-216370">
    <div class="subject"><a href="#post-216370">Windows 7 and Mouse Hooks outside of main window</a></div>
    <div class="body">Hello,<br /><br />It has been a long time since I was last here.<br /><br />Anyways there is a program from a long time ago that is called The Customiser.<br />It is a cool little program that allows you to capture windows elements under the<br />mouse pointer eg. class name, id , color, size, really just about everything.<br /><br />For the most part it still works in windows 7 64 bit, except after about half a inch<br />out side of its main window. It will grab windows details that are not its own so I<br />know it can.<br /><br />So plan on making my own program the does the same thing as the The Customiser.<br />Since its a fun little program that I rarely need but fun to play with.<br /><br />This question I have is, is there something up with Windows 7 that prevents a program<br />from doing global mouse hooks that does not use a dll that injects its self into every<br />running program. and is there any way to do this with out doing the dll injection route.<br />I can do it but I rather not have to.<br /></div>
    <div class="meta">Posted on 2012-10-22 00:07:48 by devilsclaw</div>
   </div>
   <div class="post" id="post-216381">
    <div class="subject"><a href="#post-216381">Re: Windows 7 and Mouse Hooks outside of main window</a></div>
    <div class="body">You do not need to worry about global mouse hooks, I will try to explain.<br /><br />Most windows (especially c/c++) programs are based on Windows Messages , which we get a lot of those.<br />But if the mouse leaves the window, we stop getting the mouse messages.<br />However, this does not prevent us from querying the absolute coordinates (desktop window) of the mouse position if our application queries it a lot.<br />We can do more inside our Windows MessagePump Loop than to just service windows messages, we usually at least, drive our other main application or game code from that point.<br /><br />I hope you get the idea!</div>
    <div class="meta">Posted on 2012-10-23 05:17:29 by Homer</div>
   </div>
  </div>
 </body>
</html>