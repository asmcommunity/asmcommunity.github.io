<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Ensuring registration of COM objects? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9214" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=9214">Ensuring registration of COM objects?</a></p>
   <div class="post" id="post-67774">
    <div class="subject"><a href="#post-67774">Ensuring registration of COM objects?</a></div>
    <div class="body">I'm thinking of checking the registry to see if a COM object is registered when my app is executed. This way I'm not reliant on my install app to do the job correctly and a registry goof, etc. becomes moot. Is it ok to just look under &quot;HKEY_CLASSES_ROOT\CLSID\&quot; for the ClassID and if I don't find it to call regsvr32 before creating the object?<br /><br />I'm thinking of it like this:<br /><br />1. look under &quot;HKEY_CLASSES_ROOT\CLSID\&quot; for &quot;{BBCE2B80-FE99-11D5-A324-0050BA5A9F26}&quot;.<br />2. If found create the object, etc.<br />3. If not found call regsvr32 in silent mode. Then create the object.<br /><br />Is there a better way?</div>
    <div class="meta">Posted on 2002-11-27 09:21:45 by Xtreme</div>
   </div>
   <div class="post" id="post-67864">
    <div class="subject"><a href="#post-67864">Ensuring registration of COM objects?</a></div>
    <div class="body">The link i gave in <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=9144">This Thread</a>, or *if* geocities will let you download the .chm, offers a section as follows:<br /><br /><div class="quote"><strong>Registering COM Servers</strong><br /><br />After you have defined a class in code (ensuring that it implements IClassFactory or IClassFactory2) and assigned it a CLSID, you need to put information in the registry that will allow OLE, on request of a client with the CLSID, to create instances of its objects. This information tells the system, for a given CLSID, where the DLL or EXE code for that class is located, and how it is to be launched. There is more than one way of registering a class in the registry. In addition, there are other ways of ?registering? a class with the system when it is running, so the system is aware that a running object is currently in the system. These topics are described in the following sections: <br /><br />Registering a Class at Installation <br /><br />Registering a Running EXE Server <br /><br />Registering Objects in the ROT <br /><br />Self-registration <br /><br />Installing as a Win32 Service or User Account </div><br /><br />:nAn:</div>
    <div class="meta">Posted on 2002-11-27 20:34:28 by NaN</div>
   </div>
   <div class="post" id="post-67935">
    <div class="subject"><a href="#post-67935">Ensuring registration of COM objects?</a></div>
    <div class="body">Excellent! Thanks NaN. I visited the original web site and got a lot of good info...</div>
    <div class="meta">Posted on 2002-11-28 10:16:55 by Xtreme</div>
   </div>
  </div>
 </body>
</html>