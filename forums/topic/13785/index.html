<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>SEH - MASM and FS - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13785" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=13785">SEH - MASM and FS</a></p>
   <div class="post" id="post-106716">
    <div class="subject"><a href="#post-106716">SEH - MASM and FS</a></div>
    <div class="body">What's the issue with MASM and the FS register?<br />mov eax,FS:[0] is not valid?</div>
    <div class="meta">Posted on 2003-06-11 00:49:19 by Homer</div>
   </div>
   <div class="post" id="post-106719">
    <div class="subject"><a href="#post-106719">SEH - MASM and FS</a></div>
    <div class="body"><strong>error A2108</strong><br /><br />An attempt was made to use a register that had been assumed to ERROR with the ASSUME directive.<br /><br />assume FS:nothing<br />mov eax,FS:[0]<br />assume FS:error<br /><br />assume GS:nothing<br />mov eax,GS:[0]<br />assume GS:error</div>
    <div class="meta">Posted on 2003-06-11 01:02:48 by donkey</div>
   </div>
   <div class="post" id="post-106731">
    <div class="subject"><a href="#post-106731">SEH - MASM and FS</a></div>
    <div class="body">Shouldn't it be<br /><pre><code><br />mov eax,dword ptr FS&#58;&#91;0&#93; <br /></code></pre><br />?</div>
    <div class="meta">Posted on 2003-06-11 03:06:42 by roticv</div>
   </div>
   <div class="post" id="post-106815">
    <div class="subject"><a href="#post-106815">SEH - MASM and FS</a></div>
    <div class="body"><strong>In MASM</strong>, &quot;mov eax,FS:[0]&quot; would automaticaly imply the move of a DWORD into a 32-bit register. There is no need to re-specify it for the memory address. Similarly, &quot;mov ax,FS:[0]&quot; would automaticaly imply the move of a WORD into a 16-bit register. <br />Specifying the size of the memory operand is necessary only when the instruction is unclear about the required size, such as:<br /><br />movzx eax,byte ptr FS:[0], movzx eax,word ptr FS:[0]<br />imul word ptr FS:[0], imul dword ptr FS:[0]<br /><br />The above may be different for other assemblers/compilers.<br /><br />Raymond</div>
    <div class="meta">Posted on 2003-06-11 23:18:17 by Raymond</div>
   </div>
   <div class="post" id="post-106821">
    <div class="subject"><a href="#post-106821">SEH - MASM and FS</a></div>
    <div class="body">ASSUME FS:FLAT also works</div>
    <div class="meta">Posted on 2003-06-11 23:58:25 by bitRAKE</div>
   </div>
   <div class="post" id="post-106897">
    <div class="subject"><a href="#post-106897">SEH - MASM and FS</a></div>
    <div class="body">From MASM32 Help:<br /><br /> Flat memory model<br /> <br />     ...<br />     The FS and GS segment registers are not needed for flat-model<br />     programs. The .MODEL FLAT statement automatically generates this<br />     assumption:<br /> <br />       ASSUME  cs:FLAT, ds:FLAT, ss:FLAT, es:FLAT, fs:ERROR, gs:ERROR<br /> <br />     ...</div>
    <div class="meta">Posted on 2003-06-12 12:54:22 by MazeGen</div>
   </div>
  </div>
 </body>
</html>