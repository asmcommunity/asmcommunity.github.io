<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>C++ CGI showing how to use Hutch's Quick Sorts in Visual C++ - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2541" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=2541">C++ CGI showing how to use Hutch's Quick Sorts in Visual C++</a></p>
   <div class="post" id="post-16034">
    <div class="subject"><a href="#post-16034">C++ CGI showing how to use Hutch's Quick Sorts in Visual C++</a></div>
    <div class="body">These Quicksorts functions in this C++ CGI<br />are modified Versions of Hutch' Quicksorts <br />nrQsortA and nrQsortD in the folder M32LIB <br />from his Masm32 Assembler available from his site at <br /><a target="_blank" href="http://www.movsd.com">http://www.movsd.com</a> <br /><br />I modified these to  work in a Visual C++ ASM procedures<br />I hope although as look back now was simple to modify will help others<br /><br />What I did was use C runtime functions for memory management<br />first adding<br />EXTERN malloc:NEAR<br />EXTERN free:NEAR<br />I replaced <br />invoke SysAllocStringByteLen,0,bLen<br />with<br />push bLen<br />call malloc<br /><br />and<br />I replaced invoke SysFreeString,hMem<br />with<br /><br />push hMem<br />call free<br /><br />And after I did that, to my amazement it ran!<br /><br /><br />See it run<br /><a target="_blank" href="http://busybeesolutions.com/cgi-bin/c_asm/Qsortnumbers.exe">http://busybeesolutions.com/cgi-bin/c_asm/Qsortnumbers.exe</a><br /><br />See the ASM files<br /><a target="_blank" href="http://busybeesolutions.com/sourcefiles/c_asm/qsortnumsA.txt">http://busybeesolutions.com/sourcefiles/c_asm/qsortnumsA.txt</a><br /><a target="_blank" href="http://busybeesolutions.com/sourcefiles/c_asm/qsortnumsD.txt">http://busybeesolutions.com/sourcefiles/c_asm/qsortnumsD.txt</a><br /><a target="_blank" href="http://busybeesolutions.com/sourcefiles/c_asm/displaynums.txt">http://busybeesolutions.com/sourcefiles/c_asm/displaynums.txt</a><br /><br />See the C file that calls the ASM procedures<br /><br /><a target="_blank" href="http://busybeesolutions.com/sourcefiles/c_asm/qnums.txt">http://busybeesolutions.com/sourcefiles/c_asm/qnums.txt</a><br /><br />How to create a C++ or C to call assembly procedures in Visual C++ <br />note: this project was a console project <br /><br /><br /><br /><a target="_blank" href="http://support.microsoft.com/default.aspx?scid=kb;EN-US;q106399">http://support.microsoft.com/default.aspx?scid=kb;EN-US;q106399</a><br />:)</div>
    <div class="meta">Posted on 2001-12-24 22:54:17 by andy981</div>
   </div>
  </div>
 </body>
</html>