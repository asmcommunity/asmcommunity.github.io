<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ImpersonateSelf API - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3768" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3768">ImpersonateSelf API</a></p>
   <div class="post" id="post-25344">
    <div class="subject"><a href="#post-25344">ImpersonateSelf API</a></div>
    <div class="body">Hi,<br /><br />Anybody has any clue about how to use ImpersonateSelf API?<br /><br />In C the API call that I want to convert to asm looks like following:<br /><br />ImpersonateSelf(SecurityImpersonation);<br /><br />What is the value to use for SecurityImpersonation? In MSDN it says it is a enumeration type. But I have the problem that I even cannot understand what that means :(<br /><br />Sami</div>
    <div class="meta">Posted on 2002-02-21 13:31:10 by SamiP</div>
   </div>
   <div class="post" id="post-25346">
    <div class="subject"><a href="#post-25346">ImpersonateSelf API</a></div>
    <div class="body">An enum is basically an integer that takes symbolic names...<br />the enum you want is defined as<br /><pre><code><br />typedef enum _SECURITY_IMPERSONATION_LEVEL &#123; <br />  SecurityAnonymous, <br />  SecurityIdentification, <br />  SecurityImpersonation, <br />  SecurityDelegation <br />&#125; SECURITY_IMPERSONATION_LEVEL; <br /></code></pre><br /><br />this should be translateable to asm as<br /><pre><code><br />SecurityAnonymous equ 0<br />SecurityIdentification equ 1<br />SecurityImpersonation equ 2<br />SecurityDelegation equ 3<br /></code></pre></div>
    <div class="meta">Posted on 2002-02-21 13:47:16 by f0dder</div>
   </div>
   <div class="post" id="post-25347">
    <div class="subject"><a href="#post-25347">ImpersonateSelf API</a></div>
    <div class="body">Thank you Fodder!<br /><br />Next question is where did you get those values?<br /><br />I tried searching through C header files, but I failed to find the place where those values are.<br /><br />Sami</div>
    <div class="meta">Posted on 2002-02-21 13:50:23 by SamiP</div>
   </div>
   <div class="post" id="post-25351">
    <div class="subject"><a href="#post-25351">ImpersonateSelf API</a></div>
    <div class="body">Looked up ImpersonateSelf in the PlatformSDK (part of MSDN, or<br />you can download it separately from microsoft - it's quite a whopping<br />download, but there's a lot of goof information in it).</div>
    <div class="meta">Posted on 2002-02-21 14:04:40 by f0dder</div>
   </div>
   <div class="post" id="post-25355">
    <div class="subject"><a href="#post-25355">ImpersonateSelf API</a></div>
    <div class="body">In my copy of Platform SDK it only says that SecurityAnonymous is defined with no value given and thus defaults to 0.<br /><br />Is it because SecurityAnonymous is 0 and thats the first one defined that the next one SecurityIdentification is 1 and the one I needed is the third then its 3?<br /><br />I really don't get this thing :( and whats really sad is that I can't find those values, exept if it is going like I said above.<br /><br />Sami</div>
    <div class="meta">Posted on 2002-02-21 14:31:13 by SamiP</div>
   </div>
   <div class="post" id="post-25356">
    <div class="subject"><a href="#post-25356">ImpersonateSelf API</a></div>
    <div class="body">Yes, the first value of an enumeration defaults to 0, and increase<br />in value unless there's assignments in the middle... easy peasy stuff,<br />once you realize this.</div>
    <div class="meta">Posted on 2002-02-21 14:34:37 by f0dder</div>
   </div>
   <div class="post" id="post-25357">
    <div class="subject"><a href="#post-25357">ImpersonateSelf API</a></div>
    <div class="body">Thank you! You really saved my day! :alright:</div>
    <div class="meta">Posted on 2002-02-21 14:37:22 by SamiP</div>
   </div>
  </div>
 </body>
</html>