<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Shell extension: Context Menu Handler sample - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3101" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=3101">Shell extension: Context Menu Handler sample</a></p>
   <div class="post" id="post-20373">
    <div class="subject"><a href="#post-20373">Shell extension: Context Menu Handler sample</a></div>
    <div class="body">I have written a small shell extension. Its a context menu handler sample. To be a bit more &quot;useful&quot; than just displaying &quot;I'm here&quot; some functionality has been added. I decided to show the registry entries related to the type of the selected file. Some<br />restricted edit capabilities are implemented too.<br /><br />Actually I want to know if this tool works as supposed with Win2k, Win98, WinME and WinXP. <br /><br />To test it there is to do:<br /><br />1. download it :)  and unzip<br />2. register the extension with &quot;regsvr32 shellext.dll&quot;<br /><br />Now for files with an extension registered in HKEY_CLASSES_ROOT there should be a new context menu entry &quot;Edit registry&quot; when right clicking that file. In the dialog box that should popup there should be shown some entries of the registry in a treeview, below that a edit control in which the selected value can be changed (be very careful here. The changes in the registry are made when selecting another item or pressing OK!!!)<br /><br />3. unregister the dll with &quot;regsvr32 /u shellext.dll&quot;<br /><br />Source code is included and it is free.<br /><br />japheth</div>
    <div class="meta">Posted on 2002-01-22 04:33:42 by japheth</div>
   </div>
   <div class="post" id="post-20415">
    <div class="subject"><a href="#post-20415">Shell extension: Context Menu Handler sample</a></div>
    <div class="body">works as supposed to with Win98.<br /><br />Nice example, thanks</div>
    <div class="meta">Posted on 2002-01-22 10:14:06 by Wayne</div>
   </div>
   <div class="post" id="post-20433">
    <div class="subject"><a href="#post-20433">Shell extension: Context Menu Handler sample</a></div>
    <div class="body">tried in W2k, but got this message when registering<br /><br />DllRegisterServer in NamSpExt.dll failed.<br />Return code was: 0xc0000005<br /><br /><br />Random<br />ps: maybe it's because I'm not logged in on this PC as an admin</div>
    <div class="meta">Posted on 2002-01-22 11:32:15 by random</div>
   </div>
   <div class="post" id="post-20442">
    <div class="subject"><a href="#post-20442">Shell extension: Context Menu Handler sample</a></div>
    <div class="body">wtf!!!!!<br />now for some reason I have the namespace extention appering correctly under Explorer ... but I can't unregister (&quot;Entry point was not found&quot; error message)<br />HOW THE HELL CAN I GET RID OF IT NOW??<br /><br />any help will be VERY appreciated<br /><br />Random</div>
    <div class="meta">Posted on 2002-01-22 12:10:45 by random</div>
   </div>
   <div class="post" id="post-20593">
    <div class="subject"><a href="#post-20593">Shell extension: Context Menu Handler sample</a></div>
    <div class="body">random, <br /><br />may be you are a bit confused? The name of the dll was ShellExt.Dll, not NamSpExt.dll. Are you sure you have registered the right dll? The namespace extension stuff was in another thread.<br /><br />japheth</div>
    <div class="meta">Posted on 2002-01-23 03:39:08 by japheth</div>
   </div>
   <div class="post" id="post-20597">
    <div class="subject"><a href="#post-20597">Shell extension: Context Menu Handler sample</a></div>
    <div class="body">Ops ... you're right. Go figure :)<br /><br />ehehe<br /><br />the &quot;context menu handler&quot; works just fine on Win2K!! :)<br /><br /><br />Random</div>
    <div class="meta">Posted on 2002-01-23 03:51:55 by random</div>
   </div>
   <div class="post" id="post-21209">
    <div class="subject"><a href="#post-21209">Shell extension: Context Menu Handler sample</a></div>
    <div class="body">j,<br /><br /> I rebuilt the project and the Release dll was 15k, compared to the 25k dll in your zip file. ( Debug build was 17k).<br />I was wondering why the size differance. Any thoughts, anyone?</div>
    <div class="meta">Posted on 2002-01-25 21:20:02 by Wayne</div>
   </div>
   <div class="post" id="post-21228">
    <div class="subject"><a href="#post-21228">Shell extension: Context Menu Handler sample</a></div>
    <div class="body">Its mostly due to the linker settings...<br /><br />This is what i most often link with (and i often find &quot;savings&quot; from other's source)<br /><br /><pre><code><br />\masm32\bin\link /SUBSYSTEM&#58;WINDOWS /RELEASE /MERGE&#58;.rdata=.text /SECTION&#58;.text,EWR /IGNORE&#58;4078 %1.obj rsrc.obj</code></pre><br /><br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-01-26 02:30:42 by NaN</div>
   </div>
   <div class="post" id="post-21230">
    <div class="subject"><a href="#post-21230">Shell extension: Context Menu Handler sample</a></div>
    <div class="body">NaN, you shouldn't generally make your code section writable.<br />It's okay for smallish applications, but bad on larger apps (which is<br />why UPXing a delphi/bcb/vb app is braindead). It's not too bad to<br />*just* have codesection writeable, as we have Copy-On-Write, and<br />the stuff is handled on a page level...<br /><br />but once you start compressing executables, something bad happens.<br />All sections are suddenly marked dirty, and if the app needs to be<br />paged out, the code section can't just be discarded and paged in<br />from the executable file again - it has to be paged to disk. As if the<br />bloat of delphi/bcb apps wasn't bad enough already :P.</div>
    <div class="meta">Posted on 2002-01-26 03:25:46 by f0dder</div>
   </div>
   <div class="post" id="post-21596">
    <div class="subject"><a href="#post-21596">Shell extension: Context Menu Handler sample</a></div>
    <div class="body">Thanks for the replies so far. Has anyone tested it with WinXP? With shell extensions you can never be sure!</div>
    <div class="meta">Posted on 2002-01-28 11:12:58 by japheth</div>
   </div>
  </div>
 </body>
</html>