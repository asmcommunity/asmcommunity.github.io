<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Getting Windows contents - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21660" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21660">Getting Windows contents</a></p>
   <div class="post" id="post-163439">
    <div class="subject"><a href="#post-163439">Getting Windows contents</a></div>
    <div class="body">Hi.<br /><br />I want to copy the contents of Windows window. I get the DC and copy it. But I want the contents only with icons and backgroundimage, but without any other tool window. Is it possible?<br /><br />Greetings,<br />Nordwind64</div>
    <div class="meta">Posted on 2005-08-18 14:15:41 by Nordwind64</div>
   </div>
   <div class="post" id="post-163492">
    <div class="subject"><a href="#post-163492">Re: Getting Windows contents</a></div>
    <div class="body">Isn&#39;t it possible?<br /><br />Nordwind64</div>
    <div class="meta">Posted on 2005-08-19 12:14:37 by Nordwind64</div>
   </div>
   <div class="post" id="post-163504">
    <div class="subject"><a href="#post-163504">Re: Getting Windows contents</a></div>
    <div class="body">I trie again.<br /><br />I need a snapshot of the desktop, but without any other window in it...<br />Hope, you can help now. Sorry for my bad english...<br /><br />Greetings, Nordwind</div>
    <div class="meta">Posted on 2005-08-19 15:53:00 by Nordwind64</div>
   </div>
   <div class="post" id="post-163507">
    <div class="subject"><a href="#post-163507">Re: Getting Windows contents</a></div>
    <div class="body">just tell us what you want to do exactly and why you need that?</div>
    <div class="meta">Posted on 2005-08-19 16:25:00 by soorena</div>
   </div>
   <div class="post" id="post-163510">
    <div class="subject"><a href="#post-163510">Re: Getting Windows contents</a></div>
    <div class="body">Hi,<br /><br />I need it for a little tool I want to write in future. Effects on desktop.<br />I don&#39;t want to work with regions.<br /><br />Nordwind64</div>
    <div class="meta">Posted on 2005-08-19 17:22:07 by Nordwind64</div>
   </div>
   <div class="post" id="post-163603">
    <div class="subject"><a href="#post-163603">Re: Getting Windows contents</a></div>
    <div class="body">Hi,<br /><br />is there any solution?<br /><br />Nordwind64</div>
    <div class="meta">Posted on 2005-08-22 10:40:17 by Nordwind64</div>
   </div>
   <div class="post" id="post-163611">
    <div class="subject"><a href="#post-163611">Re: Getting Windows contents</a></div>
    <div class="body">Hi Nordwind,<br /><br />Yes, it is possible but I am not sure how easy it would be. When Windows draws a window on the desktop the area underneath it is saved as a bitmap. How to get the handle is beyond me, never looked at the problem before. But it is possible to grab the visible area of the desktop and paste the obscured portions into the DC. Though any program that did this would probably be very specific to a single OS version and need different versions for each one.<br /><br />Another possibility is just to minimize all the open windows and grab the DC of the desktop. you might even be able make the taskbar disappear if you want to using the ITaskBar interface, though I&#39;m not sure about this.<br /><br />Yet another way to do it is to get the wallpaper from the registry (HKEY_CURRENT_USER\Control Panel\Desktop\Wallpaper), enumerate the desktop and draw the icons onto the bitmap, it will essentially be a copy of the desktop. For an example of enumerating the desktop icons see my LVDesktop9xNT example on my website...<br /><br />http://donkey.visualassembler.com/</div>
    <div class="meta">Posted on 2005-08-22 17:47:02 by donkey</div>
   </div>
   <div class="post" id="post-163705">
    <div class="subject"><a href="#post-163705">Re: Getting Windows contents</a></div>
    <div class="body">Hi donkey!<br /><br />Thanks for replying.<br />I tested your code. Is it right, that it shows only the same one icon in all listview lines? And all have position 0/0? I tested twice, and now it worked right. I tested again and again. But most time, it showed only the one-icon-listview.<br /><br />Ok, getting the background image is easy: invoke PaintDesktop,hdc<br /><br />In my opinion the API GetDCEx with Flag DCX_CLIPSIBLINGS | DCX_CLIPCHILDREN should make what I won&#39;t. But it don&#39;t work...<br /><br />Best regards,<br />Nordwind64	</div>
    <div class="meta">Posted on 2005-08-24 14:09:13 by Nordwind64</div>
   </div>
  </div>
 </body>
</html>