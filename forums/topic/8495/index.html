<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Help on Selfmodifying code - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8495" />
    <link rel="next" href="../?id=8495&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=8495">Help on Selfmodifying code</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=8495&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=8495&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="8495" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=8495&amp;page=2">&gt;</a><a href="../?id=8495&amp;page=2">&raquo;</a></form>   <div class="post" id="post-62186">
    <div class="subject"><a href="#post-62186">Help on Selfmodifying code</a></div>
    <div class="body">can any body tell me  how to write self modifying codes?<br />At least a reference would do.<br />Thankz in adv<br />bye</div>
    <div class="meta">Posted on 2002-10-17 09:25:58 by ajith</div>
   </div>
   <div class="post" id="post-62191">
    <div class="subject"><a href="#post-62191">Help on Selfmodifying code</a></div>
    <div class="body">Hi,<br />a simple search on the forum will help you ;)<br />anyway, there's an example in the masm pack<br /><br />regards,<br />ZaiRoN</div>
    <div class="meta">Posted on 2002-10-17 09:57:37 by ZaiRoN</div>
   </div>
   <div class="post" id="post-62217">
    <div class="subject"><a href="#post-62217">Help on Selfmodifying code</a></div>
    <div class="body">Self-modifying code is Evil. The CPU will stall for a long time if you modify some code and soon after execute it. It's also a big mess if you want to change instructions because they can be of different length. I've found a cleaner solution: run-time conditional compilation: <a target="_blank" href="softwire.sourceforge.net">softwire.sourceforge.net</a></div>
    <div class="meta">Posted on 2002-10-17 14:36:43 by C0D1F1ED</div>
   </div>
   <div class="post" id="post-62219">
    <div class="subject"><a href="#post-62219">Help on Selfmodifying code</a></div>
    <div class="body">run-time conditional compilation <strong>IS</strong> SMC. ;)</div>
    <div class="meta">Posted on 2002-10-17 15:11:34 by Maverick</div>
   </div>
   <div class="post" id="post-62236">
    <div class="subject"><a href="#post-62236">Help on Selfmodifying code</a></div>
    <div class="body">In a certain way, that's true, but if you think that far then you could also say all code is self-modifying code (running in a kernel) which is a bit absurd :rolleyes:</div>
    <div class="meta">Posted on 2002-10-17 17:12:41 by C0D1F1ED</div>
   </div>
   <div class="post" id="post-62237">
    <div class="subject"><a href="#post-62237">Help on Selfmodifying code</a></div>
    <div class="body">It depends at which level the code modifies itself... :)<br /><br />An old friend of mine told me one day: &quot;nothing ever get created... all get transformed&quot;, is the whole World absurd then ? :rolleyes:</div>
    <div class="meta">Posted on 2002-10-17 17:21:15 by JCP</div>
   </div>
   <div class="post" id="post-62239">
    <div class="subject"><a href="#post-62239">Help on Selfmodifying code</a></div>
    <div class="body"><div class="quote"><br />It depends at which level the code modifies itself...</div><br /><br />Well if you look at the same level, a run-time assembler does not modify it's own code. A new memory buffer is allocated, instead of overwriting existing code. Ok it owns this code because it created it itself, so in a way it's at the same level, but let's not start nitpicking ;)</div>
    <div class="meta">Posted on 2002-10-17 17:30:58 by C0D1F1ED</div>
   </div>
   <div class="post" id="post-62314">
    <div class="subject"><a href="#post-62314">Help on Selfmodifying code</a></div>
    <div class="body">I meant, since <em>you</em> wrote ;)<br /><div class="quote">Self-modifying code is Evil. The CPU will stall for a long time if you modify some code and soon after execute it. It's also a big mess if you want to change instructions because they can be of different length. I've found a cleaner solution: run-time conditional compilation: softwire.sourceforge.net</div><br />Then penalization-wise (which is not a sharp word :grin: ) assembling and executing code on the fly, again in this &quot;CPU flushes pipelines and all&quot; context, is just like SMC (actually, it's worse, because all the instructions will be &quot;flushed&quot; if you reassemble all, while in classic SMC you modify just one or two).<br /><br />This is an important consideration, and is not splitting the hair. ;)</div>
    <div class="meta">Posted on 2002-10-18 03:19:13 by Maverick</div>
   </div>
   <div class="post" id="post-62346">
    <div class="subject"><a href="#post-62346">Help on Selfmodifying code</a></div>
    <div class="body">Ajith,<br /><br />Why are  you interested in self-modifying code? Maybe some evil purpose... Such as coding virii...? ;) <br /><br />Regards,<br /><br />Vortex</div>
    <div class="meta">Posted on 2002-10-18 04:43:39 by Vortex</div>
   </div>
   <div class="post" id="post-62365">
    <div class="subject"><a href="#post-62365">Help on Selfmodifying code</a></div>
    <div class="body"><div class="quote"><br />Ajith,<br /><br />Why are  you interested in self-modifying code? Maybe some evil purpose... Such as coding virii...? ;) <br /><br />Regards,<br /><br />Vortex </div><br /><br />Or perhaps he's trying to make a PE-crypter/packer wich protects itself, well makes it harder to <br />to disassemble and whatnot... The uses of SMC are not really eandless but many... Never assume<br />anything... :)</div>
    <div class="meta">Posted on 2002-10-18 05:14:32 by NervGaz</div>
   </div>
   <div class="post" id="post-62380">
    <div class="subject"><a href="#post-62380">Help on Selfmodifying code</a></div>
    <div class="body">You can quote myself on &quot;SMC rocks&quot;. :)<br />..but, like any other thing, it must be used only when it's really useful (and in those cases it can be VERY useful, also given the lack of registers in the x86 architecture.. but not only for performance purposes, also for protections and such).</div>
    <div class="meta">Posted on 2002-10-18 05:39:19 by Maverick</div>
   </div>
   <div class="post" id="post-62415">
    <div class="subject"><a href="#post-62415">Re: Help on Selfmodifying code</a></div>
    <div class="body"><div class="quote"><br />can any body tell me  how to write self modifying codes?<br />At least a reference would do.<br /></div><br /><br />You will need: IA-32 Intel? Architecture Software Developer?s Manual Volume 2: Instruction Set Reference<br /><br />Also you can download some good ezines (like XXXXXXXX :( ), where you can find a lot of good tutorials about polymorphism and self-modifing. I could give you a link, but Bazik will be crazy about it.<br /><br />Sorry but we cannot have reference to that type of data here. :)</div>
    <div class="meta">Posted on 2002-10-18 07:27:04 by Aquila</div>
   </div>
   <div class="post" id="post-62417">
    <div class="subject"><a href="#post-62417">Help on Selfmodifying code</a></div>
    <div class="body"><div class="quote"><em>Originally posted by Vortex </em><br />Why are  you interested in self-modifying code? Maybe some evil purpose... Such as coding virii...? ;) <br /></div><br /><br />Don't you know in our days all virii are coded in Delphi and VB? :)</div>
    <div class="meta">Posted on 2002-10-18 07:29:12 by Aquila</div>
   </div>
   <div class="post" id="post-62418">
    <div class="subject"><a href="#post-62418">Help on Selfmodifying code</a></div>
    <div class="body"><div class="quote">Don't you know in our days all virii are coded in Delphi and VB? </div> <br /><br />lol.. that must be why the virii keep floodin my limited mailbox. Couldn't they keep the size of the exe down? Damm them :grin:</div>
    <div class="meta">Posted on 2002-10-18 07:31:54 by roticv</div>
   </div>
   <div class="post" id="post-62419">
    <div class="subject"><a href="#post-62419">Help on Selfmodifying code</a></div>
    <div class="body">SMC is neither good or bad, just know what you are doing with it and why you are doing it. If you are worried about the stall from messing up the code cache, modify it first, do something else THEN run the modified code. Usually this means doing it at startup where a stall just does not matter and when everything is up and running, then run the modified code.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-10-18 07:35:56 by hutch--</div>
   </div>
   <div class="post" id="post-62420">
    <div class="subject"><a href="#post-62420">Help on Selfmodifying code</a></div>
    <div class="body">I just experimented a bit with SoftWire and found it to be extremely easy to write self-modifying code since labels in code and data are treated equally and can be used anywhere. Now how will we call this, self-modifying conditional run-time assembly? :cool:<br /><br />If you only need to change some constants, I have to agree that SMC is very usefull. But it's totally useless if you need to change more than a few opcodes like with run-time compilation for scripts or shaders. So let's just conclude it depends on the situation :grin:</div>
    <div class="meta">Posted on 2002-10-18 07:37:23 by C0D1F1ED</div>
   </div>
   <div class="post" id="post-62421">
    <div class="subject"><a href="#post-62421">Help on Selfmodifying code</a></div>
    <div class="body">Oh, it's weird nobody has mentioned  <a target="_blank" href="www.sandpile.org">sandpile</a> yet. This is where I got most of my x86 resources to write SoftWire. It's the same info as in the Intel docs, but handier for browsing.</div>
    <div class="meta">Posted on 2002-10-18 07:43:41 by C0D1F1ED</div>
   </div>
   <div class="post" id="post-62439">
    <div class="subject"><a href="#post-62439">Help on Selfmodifying code</a></div>
    <div class="body"><div class="quote"><br />the lack of registers in the x86 architecture.. </div><br />...but no for long, the x86<strong>-64</strong> is comming. rax-&gt;r15, xmm1-&gt;xmm15, mmx1(/fpr0)-&gt;mmx7(/fpr7), I'm already dreaming happy dreams... :grin: :grin: :grin:</div>
    <div class="meta">Posted on 2002-10-18 08:26:55 by scientica</div>
   </div>
   <div class="post" id="post-62444">
    <div class="subject"><a href="#post-62444">Help on Selfmodifying code</a></div>
    <div class="body">Run-time compilation???<br /><br />Sounds rigmarolish to me.  Why not just compile all possible versions at development time, have several versions in a handy-dandy file, and load the version you need at init/run time??  Why make the user wait for you to compile while he's trying to run your program, when you can do all the compiling on YOUR  computer and let the user run as soon as you select which version to use?  That way you skip the overhead of compiling at init/run.  Also... that way a crax0r will need a disassembler and a patcher, if you use run-time compilation all he'll need is a text editor.</div>
    <div class="meta">Posted on 2002-10-18 08:49:27 by AmkG</div>
   </div>
   <div class="post" id="post-62454">
    <div class="subject"><a href="#post-62454">Help on Selfmodifying code</a></div>
    <div class="body"><div class="quote"><br />Run-time compilation???<br /><br />Sounds rigmarolish to me.  Why not just compile all possible versions at development time, have several versions in a handy-dandy file, and load the version you need at init/run time??  Why make the user wait for you to compile while he's trying to run your program, when you can do all the compiling on YOUR  computer and let the user run as soon as you select which version to use?  That way you skip the overhead of compiling at init/run.  Also... that way a crax0r will need a disassembler and a patcher, if you use run-time compilation all he'll need is a text editor. </div><br /><br />I can't compile all possible versions at development time because of space and time limitations. Space because I currently have 12960 combinations. Suppose they all had a constant length of 1 KB, then I had almost 13 MB of code. If that doesn't sound much to you, then you should know that every new setting I add multiplies this by the number of options. So obviously time is also a limitation because I don't want to wait till all combinations are compiled until I can test them all. Besides, compiling one shader happens in a praction of a second, so simply caching the last couple of shaders is much more economical.<br /><br />Disassembling a library is a lot easier than reading an encrypted file with a run-time assembled decryptor...</div>
    <div class="meta">Posted on 2002-10-18 10:23:18 by C0D1F1ED</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=8495&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=8495&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="8495" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=8495&amp;page=2">&gt;</a><a href="../?id=8495&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>