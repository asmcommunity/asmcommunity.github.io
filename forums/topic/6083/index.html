<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Compact database - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6083" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6083">Compact database</a></p>
   <div class="post" id="post-43582">
    <div class="subject"><a href="#post-43582">Compact database</a></div>
    <div class="body">I'm writing an application that reads and writes on a database using ODBC 3 and the Access Driver.<br />How can I compact this database ? I think I should use DAO but i don't know what it is.</div>
    <div class="meta">Posted on 2002-06-16 11:03:43 by greenant</div>
   </div>
   <div class="post" id="post-43641">
    <div class="subject"><a href="#post-43641">Compact database</a></div>
    <div class="body">For ODBC. (ODBC Drivers Help)<br /><br />Using SQLConfigDataSource<br /><br />To perform data compaction on a database file programmatically, include &quot;COMPACT_DB=&lt;path_name&gt;&lt;optional_sort_order&gt;&lt;optional ENCRYPT keyword&gt;&quot; in the list of attributes (lpszAttributes) of the SQLConfigDataSource function. In this function, &lt;path_name&gt; is the full path to the Microsoft Access database to be compacted.<br />When compacting a password-protected file, a password and user id must be entered in the advanced options dialog box (or in the list of attributes for SQLConfigDataSource, if compacting programmatically). The password and user id should be removed after the compaction. Compacting password-protected files may have unpredicted results.<br /><br />Using SQLConfigDriver<br /><br />To perform data compaction on a database file programmatically using SQLConfigDriver, include &quot;COMPACT_DB=&lt;path_name&gt;&lt;optionaL_sort_order&gt;&lt;optional ENCRYPT keyword&gt;&quot; in the list of arguments (lpszArgs) of the SQLConfigDriver function. In this function, &lt;path_name&gt; is the full path to the Microsoft Access database to be compacted.</div>
    <div class="meta">Posted on 2002-06-16 19:04:29 by Wayne</div>
   </div>
   <div class="post" id="post-44682">
    <div class="subject"><a href="#post-44682">Compact database</a></div>
    <div class="body">It doesn't work. Maybe I have done a mistake<br />I used this code. It returned false and SQLInstallerError returned ODBC_ERROR_REQUEST_FAILED.<br />Can you help me ???. You can download the code from <a target="_blank" href="http://greenant.cjb.net">http://greenant.cjb.net</a>  --&gt;&gt; gremaf<br /><br />.data<br />    driverr db &quot;Microsoft Access Driver (*.mdb)&quot;,0<br />    attri   db &quot;COMPACT_DB=C:\masm32\bin\gremaf\gamelist.mdb&quot;,0,0<br /><br />.code<br />    invoke SQLConfigDataSource, hWnd, ODBC_CONFIG_DSN, addr driverr, addr attri</div>
    <div class="meta">Posted on 2002-06-22 08:18:38 by greenant</div>
   </div>
   <div class="post" id="post-44692">
    <div class="subject"><a href="#post-44692">Compact database</a></div>
    <div class="body">greenant,<br /> try using <br />attri db &quot;COMPACT_DB=C:\masm32\bin\gremaf\gamelist.mdb C:\masm32\bin\gremaf\gamelist.mdb General&quot;,0,0<br /><br />The first C:\masm32\bin\gremaf\gamelist.mdb is the source.<br />The second is the destination.<br />If you feel brave you can compact to the same name, otherwise you will have to set a different destination and do delete on source and rename on destination. Hope that made sense.<br /><br />I have not tried this yet in assembler. I will try it when I have some time. I getting the link error as you.<br /><br />The help file snippet I posted above really leaves a lot out.</div>
    <div class="meta">Posted on 2002-06-22 10:24:55 by Wayne</div>
   </div>
   <div class="post" id="post-44757">
    <div class="subject"><a href="#post-44757">Compact database</a></div>
    <div class="body">good news and bad news.<br /><br />good news - the above form for attributes does work.<br />bad news - had to includelib MSVCRT.LIB to get it to link.</div>
    <div class="meta">Posted on 2002-06-22 20:52:13 by Wayne</div>
   </div>
  </div>
 </body>
</html>