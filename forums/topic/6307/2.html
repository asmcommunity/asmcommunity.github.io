<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>can you eliminate the IAT? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6307" />
  <link rel="prev" href="../?id=6307&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6307">can you eliminate the IAT?</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=6307&amp;page=1" style="">&laquo;</a><a href="../?id=6307&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="6307" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-45833">
    <div class="subject"><a href="#post-45833">can you eliminate the IAT?</a></div>
    <div class="body">A lot of my code has raised warnings in various anti-viral software.<br />No, not &quot;malware&quot;, but various test pieces (manual importing,<br />tricks with SEH, import wrappers, exe compression, . . .)<br />And with good reason, as the code can be rather &quot;suspicious&quot; and<br />ought not be in normal programs :).<br /><br />As for ordinals... be careful. The only benefit it has is that your<br />executables will be a tad smaller - and for me &quot;a tad smaller&quot; when<br />combined with &quot;might break if a new version of the DLL is released&quot;<br />isn't really worth the trouble :). It's not much faster to do ordinal<br />importing, and it doesn't add any 'security' to the program either.</div>
    <div class="meta">Posted on 2002-06-30 09:37:38 by f0dder</div>
   </div>
   <div class="post" id="post-45848">
    <div class="subject"><a href="#post-45848">can you eliminate the IAT?</a></div>
    <div class="body">ThoughtCriminal and bAZiK, what I have typed before in absolutely no way defies the rules of this message board.</div>
    <div class="meta">Posted on 2002-06-30 12:12:50 by comrade</div>
   </div>
   <div class="post" id="post-45874">
    <div class="subject"><a href="#post-45874">can you eliminate the IAT?</a></div>
    <div class="body">hrm he just means that he's written a program, any program, that AVP mistakingly identifies as a trojan due to beforementioned reasons. That's what I make of it. Much fuss about nothing.</div>
    <div class="meta">Posted on 2002-06-30 16:19:06 by Hiroshimator</div>
   </div>
   <div class="post" id="post-46244">
    <div class="subject"><a href="#post-46244">can you eliminate the IAT?</a></div>
    <div class="body">The absence of IAT may not force KAV/AVP to detect programs as malware. There's something wrong with the code (it may look like a startup code of some virus).<br /><br />Most of Win32 viruses use API scanning/searching algos for getting all functions they need, while they do not import anything directly. As I checked, WinXP easily loads and executes programs that import nothing.</div>
    <div class="meta">Posted on 2002-07-04 06:51:31 by IIS</div>
   </div>
   <div class="post" id="post-46251">
    <div class="subject"><a href="#post-46251">can you eliminate the IAT?</a></div>
    <div class="body">check the attached sample... will probably work on 9x, XP, and<br />some other flavors of NT... but definitely not on my win2k. So,<br />don't try to avoid including an IAT, at least include kernel32!exitprocess.</div>
    <div class="meta">Posted on 2002-07-04 07:38:24 by f0dder</div>
   </div>
   <div class="post" id="post-46252">
    <div class="subject"><a href="#post-46252">can you eliminate the IAT?</a></div>
    <div class="body">always helps to actually attach the file ;)</div>
    <div class="meta">Posted on 2002-07-04 07:40:08 by f0dder</div>
   </div>
   <div class="post" id="post-46554">
    <div class="subject"><a href="#post-46554">can you eliminate the IAT?</a></div>
    <div class="body">I've checked this prog under W2kSp0.. It didn't launch at all, as you've said.. :(</div>
    <div class="meta">Posted on 2002-07-07 05:12:53 by IIS</div>
   </div>
   <div class="post" id="post-46565">
    <div class="subject"><a href="#post-46565">can you eliminate the IAT?</a></div>
    <div class="body"><div class="quote"><br />I've checked this prog under W2kSp0.. It didn't launch at all, as you've said.. :( </div><br /><br />If prog has no import table the w2k's loader will not run it.<br />So, at least one DLL/Proc should be imported.</div>
    <div class="meta">Posted on 2002-07-07 09:08:27 by Four-F</div>
   </div>
   <div class="post" id="post-46567">
    <div class="subject"><a href="#post-46567">can you eliminate the IAT?</a></div>
    <div class="body">Quoting myself:<br /><div class="quote"><br />Masquer, you're wrong. You can *not* totally remove the import table,<br />there's at least one (and probably more) windows versions where the<br />PE loader will (silently) refuse to load your EXE if you don't import<br />from kernel32.<br /></div><br />And yes, it's not just &quot;any import&quot;, it's &quot;end up importing from kernel32&quot;,<br />either directly (like importing Kernel32!ExitProcess), or indirectly<br />(importing a DLL that ends up importing kernel32). If you don't<br />believe me, make a dummy DLL and import from it - the app still wont launch.</div>
    <div class="meta">Posted on 2002-07-07 09:14:43 by f0dder</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=6307&amp;page=1" style="">&laquo;</a><a href="../?id=6307&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="6307" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>