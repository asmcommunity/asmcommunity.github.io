<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Report_Event partial sucess - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30469" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=30469">Report_Event partial sucess</a></p>
   <div class="post" id="post-214027">
    <div class="subject"><a href="#post-214027">Report_Event partial sucess</a></div>
    <div class="body">This is putting an event in the application log file.<br /><br />But I don&#039;t think it&#039;s supposed to bring out Dr. Watson when it&#039;s run?<br /><br />P.S. I thought it was &quot;chicken lips&quot; of M.S. to not properly return the good &quot;Dr.&quot; in place of vsjitdebugger.exe when I&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; un-installed Visual Basic C++.&nbsp; :)<br /><br /><br /><pre><code>; Report_Event.asm <br />;<br /><br />INCLUDE&nbsp; &nbsp; \masm32\include\masm32rt.inc<br />include&nbsp; &nbsp; \masm32\include\advapi32.inc<br />includelib \masm32\lib\advapi32.lib&nbsp;  <br /><br />.data<br /><br />Provider_Name&nbsp;  db&nbsp; &quot;MyEventProvider&quot;,0 <br />Failed&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &quot;RegisterEventSource failed.&quot;,0<br />AppName&nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &quot;SiegeWorks&quot;,0<br />string1&nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &quot;This is a test.&quot;,0 <br />string2&nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &quot; &quot;<br />string3&nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &quot; &quot;<br /><br />.DATA?<br /><br />hEventLog&nbsp; &nbsp; &nbsp;  HWND&nbsp; ?<br />dwEventDataSize dw&nbsp; &nbsp; ?<br /><br />.code<br /><br />start:<br /><br />stringpointers label dword<br />DWORD offset string1<br />DWORD offset string2<br />DWORD offset string3<br /><br />&nbsp; &nbsp; ;mov , NULL<br />&nbsp; &nbsp; push 	offset Provider_Name<br />&nbsp; &nbsp; push 	NULL<br />&nbsp; &nbsp; Call 	RegisterEventSource<br />&nbsp; &nbsp; mov , eax ; copy handle for storage<br />&nbsp; &nbsp; <br />.IF eax == NULL<br />&nbsp;  ;invoke GetLastError<br />&nbsp;  ;invoke wsprintf, addr OutputBuffer, addr Failed, eax<br />&nbsp;  invoke&nbsp; MessageBox, NULL, addr Failed, addr AppName, MB_OK<br />.ENDIF<br /><br />mov , (sizeof stringpointers)<br /><br />invoke ReportEvent,hEventLog,EVENTLOG_INFORMATION_TYPE,0,0,NULL,3,dwEventDataSize,addr stringpointers,NULL<br /><br />invoke DeregisterEventSource,hEventLog<br /><br />invoke ExitProcess, NULL<br /><br />end start<br /></code></pre></div>
    <div class="meta">Posted on 2011-02-06 20:38:01 by skywalker</div>
   </div>
   <div class="post" id="post-214181">
    <div class="subject"><a href="#post-214181">Re: Report_Event partial sucess</a></div>
    <div class="body">This attachment is not word for word developer studio.&nbsp; There are many ways to do the same thing.</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=3302" target="_blank">v.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2011-03-16 17:31:56 by roaknog</div>
   </div>
   <div class="post" id="post-214187">
    <div class="subject"><a href="#post-214187">Re: Report_Event partial sucess</a></div>
    <div class="body">Thanks so much.<br /><br /></div>
    <div class="meta">Posted on 2011-03-17 18:36:44 by skywalker</div>
   </div>
  </div>
 </body>
</html>