<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>old, old dos question - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4081" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4081">old, old dos question</a></p>
   <div class="post" id="post-27877">
    <div class="subject"><a href="#post-27877">old, old dos question</a></div>
    <div class="body">hi all,<br /><br />i know it's a non 32-bit related question, but who know 32 bit asm probably have clear ideas about old dos asm programming...<br /><br /><br /><br />i was wandering if someone could explain some things about PSP:<br /><br />In a com file, PSP is included in the file until 100h or it is written by the dos on opening the com file ?<br /><br />I mean, the PSP is the first part of the .com file or it's just written in memory before 100h by the dos?<br /><br />thanks B7</div>
    <div class="meta">Posted on 2002-03-08 14:08:55 by Bit7</div>
   </div>
   <div class="post" id="post-27880">
    <div class="subject"><a href="#post-27880">old, old dos question</a></div>
    <div class="body">The DOS loader creates it.<br />Byte 1 of the COM file is byte 100h in memory.</div>
    <div class="meta">Posted on 2002-03-08 14:23:57 by bitRAKE</div>
   </div>
   <div class="post" id="post-27890">
    <div class="subject"><a href="#post-27890">old, old dos question</a></div>
    <div class="body">Yep,<br /><br />The PSP is written in memory before the com file is loaded so the COM code is loaded at 100 hex. You can do some interesting stuff like use the PSP as extra memory if you choose the right part of it. Command line storage is one area that you can safely overwrite with your own data.<br /><br />You should be able to find a PSP map somewhere so that you know what you can do with it after the COM file is loaded.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-03-08 15:10:51 by hutch--</div>
   </div>
   <div class="post" id="post-27953">
    <div class="subject"><a href="#post-27953">old, old dos question</a></div>
    <div class="body">What's more, you can use the PSP to find the PSP of the program that spawned your program.  Years ago, I used this method to write a stub that would determine if the program had been started from the command prompt, and if so, it would manipulate the keyboard buffer to force command.com to start windows with my program.  'course Chicago kind of rendered that useless.</div>
    <div class="meta">Posted on 2002-03-08 23:09:25 by Canite</div>
   </div>
   <div class="post" id="post-27990">
    <div class="subject"><a href="#post-27990">old, old dos question</a></div>
    <div class="body">Another nice trick was to overwrite PSP at position 5Ch by shifting back your code, so that you could make your TSRs really tiny :-)</div>
    <div class="meta">Posted on 2002-03-09 03:38:10 by micmic</div>
   </div>
   <div class="post" id="post-28000">
    <div class="subject"><a href="#post-28000">old, old dos question</a></div>
    <div class="body">thanks all,<br /><br />now i've the ideas more clear.<br /><br />B7</div>
    <div class="meta">Posted on 2002-03-09 05:42:19 by Bit7</div>
   </div>
  </div>
 </body>
</html>