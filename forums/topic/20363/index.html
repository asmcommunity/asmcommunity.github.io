<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>problem about Listview Control - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20363" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20363">problem about Listview Control</a></p>
   <div class="post" id="post-155841">
    <div class="subject"><a href="#post-155841">problem about Listview Control</a></div>
    <div class="body">Hi KetilO,there is a strange problem about Listview Control in my program.<br />  <br />  That is when double click on one item, the item should be deleted from Listview. It works OK on WindowsXP, but always wrong under Windows2000. The Listview control is report style. And use <br />	<pre><code>invoke SendMessage,hIDC_LSV_LOCATE,LVM_SETEXTENDEDLISTVIEWSTYLE,LVS_EX_FULLROWSELECT or LVS_EX_GRIDLINES,LVS_EX_FULLROWSELECT or LVS_EX_GRIDLINES</code></pre><br />to set extended styles.<br /><br />I used OllyDbg to track, the problem is on<br /><pre><code>invoke	SendMessage,hIDC_LSV_LOCATE,LVM_GETHOTITEM,0,0</code></pre><br />In Xp, it runs OK and returns the index of the item I selected (by dbclick).<br />But in 2000, it returns FALSE (0FFFFFFFFh)</div>
    <div class="meta">Posted on 2005-01-16 01:55:29 by dyna</div>
   </div>
   <div class="post" id="post-155844">
    <div class="subject"><a href="#post-155844">problem about Listview Control</a></div>
    <div class="body">Hi dyna<br /><br />I dont have any clue.<br />Moved it to main.<br /><br />KetilO</div>
    <div class="meta">Posted on 2005-01-16 05:17:28 by KetilO</div>
   </div>
   <div class="post" id="post-155852">
    <div class="subject"><a href="#post-155852">problem about Listview Control</a></div>
    <div class="body">You haven't enabled hot tracking. Use the value at 12 added to the address in lParam instead, which is the item you double clicked.</div>
    <div class="meta">Posted on 2005-01-16 09:28:23 by Sephiroth3</div>
   </div>
   <div class="post" id="post-155877">
    <div class="subject"><a href="#post-155877">ok</a></div>
    <div class="body">thank u 4 ur help, Sehiroth3<br />i add LVS_EX_TWOCLICKACTIVATE, and it works OK.</div>
    <div class="meta">Posted on 2005-01-16 21:36:14 by dyna</div>
   </div>
   <div class="post" id="post-155887">
    <div class="subject"><a href="#post-155887">problem about Listview Control</a></div>
    <div class="body">you should use<br /><pre><code>call	SendMessage, &#91;hwndlist&#93;, LVM_GETNEXTITEM, -1, LVNI_SELECTED</code></pre><br />to get SELECTED item's index. otherwise you get HOT item's index (which may not be teh same).</div>
    <div class="meta">Posted on 2005-01-17 01:52:08 by ti_mo_n</div>
   </div>
   <div class="post" id="post-155889">
    <div class="subject"><a href="#post-155889">re</a></div>
    <div class="body">thx ti_mo_n, i'll try<br />i think maybe there is not only one way to do that.<br /><br />using MASM in GDI programming is too unefficient :cry:</div>
    <div class="meta">Posted on 2005-01-17 02:22:26 by dyna</div>
   </div>
  </div>
 </body>
</html>