<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>A little convertion proc - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=11622" />
    <link rel="next" href="../?id=11622&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=11622">A little convertion proc</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=11622&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=11622&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="11622" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=11622&amp;page=2">&gt;</a><a href="../?id=11622&amp;page=2">&raquo;</a></form>   <div class="post" id="post-88005">
    <div class="subject"><a href="#post-88005">A little convertion proc</a></div>
    <div class="body">Writing some demo apps I needed numerously<br />decode bit fields of different size in ASCII Binary <br />representation and display them in different Dlg controls.<br />So I finaly came up to a proc that convert specified<br />number of bits (from 1 to 32) of specified value and display them<br />in given control. Upper then specified bits must be zeroed.<br /><br />It's not about speed, it's about size and flexibility.<br />The thing is that it creates local strings.<br />Might be it could be of some use to someone.<br />Suggestions to make it shorter are wellcome<br />as long as conditions met:<br />1. It must create local strings (no pointers to<br />some buffers allowed)<br />2. It must display it itself, no just create strings.<br /><pre><code><br /><br />StackBinAscii proc uses edi bits,bsize,hWnd,CtlID<br />;enter frame 4 bytes &#40;push ebp\mov ebp,esp\push edi&#41;<br />	mov al,30h<br />	mov ecx,bsize<br />	sub esp,ecx<br />	dec esp<br />	mov edi,esp<br />	rep stosb<br />	mov byte ptr &#91;edi&#93;,0<br />	inc al<br />@@&#58;<br />	dec edi<br />	shr bits,1<br />	jnc @not1<br />	mov &#91;edi&#93;,al<br />@not1&#58;<br />	jne @B<br />	invoke SetDlgItemText,hWnd,CtlID,esp<br />;exit frame 4 bytes &#40;pop edi,leave,ret n&#41;<br />	ret<br />StackBinAscii endp<br /><br /></code></pre></div>
    <div class="meta">Posted on 2003-03-18 19:25:00 by The Svin</div>
   </div>
   <div class="post" id="post-88022">
    <div class="subject"><a href="#post-88022">A little convertion proc</a></div>
    <div class="body"><pre><code>	OPTION PROLOGUE&#58;NONE<br />	OPTION EPILOGUE&#58;NONE<br /><br />StackBinAscii proc bits, bsize, hWnd, CtlID<br />	mov	ecx, &#91;esp + 4&#93; ; bits<br />	push	0<br />	stc<br />	mov	edx, esp<br />@@&#58;	dec	esp<br />	mov	al, &#91;esp&#93;<br />	rcr	ecx, 1<br />	sbb	al, 30h<br />	sub	&#91;esp&#93;, al<br />	test	ecx, -2<br />	jne	@B<br /><br />	sub	edx, &#91;esp + 36 + 8&#93; ; bsize<br /><br />;	invoke SetDlgItemText, hWnd, CtlID, edx<br />	invoke SetDlgItemText, DWORD PTR &#91;esp&#93;&#91;36&#93;&#91;12&#93;&#91;8&#93;, DWORD PTR &#91;esp&#93;&#91;36&#93;&#91;16&#93;&#91;4&#93;, edx<br /><br />	add	esp, 32 + 4<br />	ret	16<br />StackBinAscii endp<br /><br />	OPTION PROLOGUE&#58;PROLOGUEDEF<br />	OPTION EPILOGUE&#58;EPILOGUEDEF</code></pre>Works with all bit sizes and stack remains aligned.<br /><br />Here, this one is a little better:<pre><code>	OPTION PROLOGUE&#58;NONE<br />	OPTION EPILOGUE&#58;NONE<br /><br />StackBinAscii proc bits,bsize,hWnd,CtlID<br />	mov	ecx, &#91;esp + 4&#93; ; bits<br />	push	0<br />	stc<br />	mov	edx, esp<br />	rcr	ecx, 1<br />	inc	edx<br /><br />@@&#58;	adc	BYTE PTR &#91;esp&#93;, 30h<br />	dec	esp<br />	shr	ecx, 1<br />	mov	BYTE PTR &#91;esp&#93;, 0<br />	jne	@B<br /><br />	sub	edx, &#91;edx&#93;&#91;4&#93;&#91;8&#93; ; bsize<br />;	invoke SetDlgItemText, hWnd, CtlID, edx<br />	invoke SetDlgItemText, DWORD PTR &#91;esp&#93;&#91;36&#93;&#91;12&#93;&#91;8&#93;, DWORD PTR &#91;esp&#93;&#91;36&#93;&#91;16&#93;&#91;4&#93;, edx<br /><br />	add	esp, 32 + 4<br />	ret	16<br />StackBinAscii endp<br /><br />	OPTION PROLOGUE&#58;PROLOGUEDEF<br />	OPTION EPILOGUE&#58;EPILOGUEDEF</code></pre>Anyone see something I'm missing?</div>
    <div class="meta">Posted on 2003-03-18 22:49:44 by bitRAKE</div>
   </div>
   <div class="post" id="post-88054">
    <div class="subject"><a href="#post-88054">A little convertion proc</a></div>
    <div class="body">Maybe something like this:<br /><pre><code>StackBinAscii proc bits, bsize, hWnd, CtlID<br />	local String&#91;36&#93; &#58;BYTE<br />	mov esi, ebp<br />	xor edx, edx<br />	dec edx<br />	mov ecx, bsize<br />	mov eax, bits<br />	shr edx, cl<br />	and eax, edx<br />	xor edx, edx<br />	mov byte ptr &#91;esi&#93;, dl<br />	dec esi<br />	mov ebx, 30h<br />	mov ecx, 32<br />@@&#58;	shr eax, 1<br />	adc edx, ebx<br />	mov byte ptr &#91;esi&#93;, dl<br />	xor edx, edx<br />	dec esi<br />	dec ecx<br />	jnz @B<br />	inc esi<br />	invoke SetDlgItemText,hWnd,CtlID, esi<br />	ret<br />StackBinAscii endp</code></pre><br /><br />Let the compiler worry about stack :)</div>
    <div class="meta">Posted on 2003-03-19 03:20:08 by masquer</div>
   </div>
   <div class="post" id="post-88174">
    <div class="subject"><a href="#post-88174">A little convertion proc</a></div>
    <div class="body"><div class="quote"><br />Anyone see something I'm missing?<br /></div><br />At least I see you specifyed args in a funny way<br /><pre><code><br />DWORD PTR &#91;esp&#93;&#91;36&#93;&#91;12&#93;&#91;8&#93;, DWORD PTR &#91;esp&#93;&#91;36&#93;&#91;16&#93;&#91;4&#93;<br /></code></pre><br />:)<br />36+12+8=36+16+4<br /><br />Yet Rickey, even if it could have worked it still takes the same 48 bytes<br />as my first proc so I didn't check your proc further, may be later.<br /><br />masquer,<br />As I said it's about size.<br />Your proc is much bigger than original to discuss it<br />(note such code as mov ebx,30h is just unacceptable while optimizing<br />for size, not mentioned that such regs as ebx,esi needed to be preserved<br />and it would add some more size to the proc)<br />But you right about stack reservation, I noted it after the first post so<br />I've changed a couple of funny lines:<br /><pre><code><br />StackBinAscii proc uses edi bits,bsize,hWnd,CtlID<br /><br />	mov al,30h<br />	sub esp,40<br />	mov ecx,bsize<br />	mov edi,esp<br />	rep stosb<br />	mov byte ptr &#91;edi&#93;,0<br />	inc eax<br />@@&#58;<br />	dec edi<br />	shr bits,1<br />	jnc @not1<br />	mov &#91;edi&#93;,al<br />@not1&#58;<br />	jne @B<br />	invoke SetDlgItemText,hWnd,CtlID,esp<br />	ret<br /><br />StackBinAscii endp<br /></code></pre></div>
    <div class="meta">Posted on 2003-03-19 14:11:10 by The Svin</div>
   </div>
   <div class="post" id="post-88181">
    <div class="subject"><a href="#post-88181">A little convertion proc</a></div>
    <div class="body"><div class="quote"><br />Anyone see something I'm missing?<br /></div><br /><br />Note, that after loop value of esp may differ from case to<br />case, yet you address args and adjust esp at the end as<br />if you know it would be shifted to - 36.<br /><br />Aside from other things your last proc doesn't work 'cause of<br />incorrect esp adjusment handling.</div>
    <div class="meta">Posted on 2003-03-19 14:52:19 by The Svin</div>
   </div>
   <div class="post" id="post-88200">
    <div class="subject"><a href="#post-88200">A little convertion proc</a></div>
    <div class="body">Stupid me :)<br />Wrote a several tuts, but didn't note obvious <br />inefficient 2 bytes &quot;inc al&quot; :)<br />Fixed, now it is 47 bytes.</div>
    <div class="meta">Posted on 2003-03-19 16:14:32 by The Svin</div>
   </div>
   <div class="post" id="post-88211">
    <div class="subject"><a href="#post-88211">A little convertion proc</a></div>
    <div class="body">i think this is shoter<br />however , i dont have the time to check if it is  . and if it works .<br /><br />; but it doesnt use bsize . <br /><pre><code><br />StackBinAscii proc uses edi bits,bsize,hWnd,CtlID<br />;enter frame 4 bytes &#40;push ebp\mov ebp,esp&#41;<br />        push 0<br /><br />@@&#58;<br />	dec ebp<br />	shl bits,1<br />	mov &#91;ebp&#93;,30h<br />	jnc @not1<br />	inc byte ptr &#91;ebp&#93;<br />@not1&#58;<br />	jne @B<br />	invoke SetDlgItemText,hWnd,CtlID,ebp<br />;exit frame 4 bytes &#40;pop ebp,leave,ret n&#41;<br />	ret<br />StackBinAscii endp<br /></code></pre></div>
    <div class="meta">Posted on 2003-03-19 16:46:24 by eko</div>
   </div>
   <div class="post" id="post-88215">
    <div class="subject"><a href="#post-88215">A little convertion proc</a></div>
    <div class="body">Hmm. This is a few bytes smaller.<br /><pre><code><br />push edi<br />enter 33,0<br />mov edx,&#91;ebp+4&#93;<br />mov edi,esp<br />mov cl,&#91;ebp+8&#93;<br />ror edx,cl<br />blah&#58; mov al,48<br />shl edx,1<br />adc al,0<br />stosb<br />loop blah<br />mov byte &#91;edi&#93;,0<br />push esp<br />push dword &#91;ebp+16&#93;<br />push dword &#91;ebp+12&#93;<br />call SetDlgItemTextA<br />leave<br />pop edi<br />ret 16<br /></code></pre></div>
    <div class="meta">Posted on 2003-03-19 17:07:14 by Sephiroth3</div>
   </div>
   <div class="post" id="post-88230">
    <div class="subject"><a href="#post-88230">A little convertion proc</a></div>
    <div class="body"><div class="quote"><br /> but it doesnt use bsize<br /></div><br />That means that your proc doesn't meet conditions:<br />Ascii string must be of specified size, otherwize it's useless.<br />If I need to display 5 bits field it should look like:<br />00001 not like 1.<br />00000 not like 0.<br />00101 not like 101.</div>
    <div class="meta">Posted on 2003-03-19 18:27:39 by The Svin</div>
   </div>
   <div class="post" id="post-88256">
    <div class="subject"><a href="#post-88256">A little convertion proc</a></div>
    <div class="body"><strong>The Svin</strong>, does stack need to be aligned on Win9x?<br />I remember hearing something a time ago.</div>
    <div class="meta">Posted on 2003-03-19 20:10:31 by bitRAKE</div>
   </div>
   <div class="post" id="post-88261">
    <div class="subject"><a href="#post-88261">A little convertion proc</a></div>
    <div class="body">I tried the first version in 98, it worked OK.<br />I tried among other size with 5 and 6 bitsize - that means<br />as you understand unaligned stack result.<br />I'm talking of the first version, 'cause there was my stupid decision decrease esp exactly to needed string size.<br />In next version I just sub esp for 40 bytes buffer, so it's aligned.<br />As to your proc I doesn't work not because of unalignment. Just 'cause in a loop it's diviated esp to varaible = index of msb and at the end restored to constant,<br />if they not equal GPF will happen even before return - on<br />API call. And even if by some miracle it won't happen yet<br />wrong esp will point to wrong ret address and GPF will be unavoidable at the return pointing to accedent value as return address.</div>
    <div class="meta">Posted on 2003-03-19 20:30:36 by The Svin</div>
   </div>
   <div class="post" id="post-88391">
    <div class="subject"><a href="#post-88391">A little convertion proc</a></div>
    <div class="body">what about this one ......<br /><br /><pre><code><br /><br />StackBinAscii proc uses edi bits,bsize,hWnd,CtlID<br />;enter frame 4 bytes &#40;push ebp\mov ebp,esp&#41;<br />               push 0<br /><br />	mov ecx,bsize<br />	neg ecx<br />@@&#58;<br />	mov byte ptr &#91;ebp+ecx&#93;,30h<br />	shr bits,1<br />	adc byte ptr &#91;ebp+ecx&#93;,0<br />                inc ecx<br />	jnz @B<br />	invoke SetDlgItemText,hWnd,CtlID,ebp<br />;exit frame 4 bytes &#40;pop ebp,leave,ret n&#41;<br />	ret<br />StackBinAscii endp<br /><br /></code></pre><br /><br /><br /><br />EDIT: new version <br />but i havnt check it nor finish it .( i'm sure it can be better) <br />i 'm  hury so i dont have the time right now <br /><br /><pre><code><br />OPTION PROLOGUE&#58;NONE<br />OPTION EPILOGUE&#58;NONE<br />	<br />StackBinAscii proc uses edi bits,bsize<br /><br />        push 0 <br />        mov ecx,&#91;esp+0ch&#93;<br />        neg ecx<br />        lea eax,&#91;esp+ecx&#93;<br />@@&#58;<br />	mov byte ptr &#91;esp+ecx&#93;,30h<br />	shr dword ptr  &#91;esp+08h&#93;,1<br />	adc byte ptr &#91;esp+ecx&#93;,0<br />        inc ecx<br />	jnz @B<br /> 		<br />	invoke SetDlgItemText,hWnd,CtlID,eax<br />	add esp,4 ; can do pop eax or something else to save some bytes<br />	ret<br />StackBinAscii endp<br />OPTION PROLOGUE&#58;PROLOGUEDEF<br />OPTION EPILOGUE&#58;EPILOGUEDEF<br /></code></pre></div>
    <div class="meta">Posted on 2003-03-20 06:23:22 by eko</div>
   </div>
   <div class="post" id="post-88399">
    <div class="subject"><a href="#post-88399">A little convertion proc</a></div>
    <div class="body">eko,<br /><br />Very nice idea but what about 0-terminating the string?<br /><br />edit: Also, that invoke overwrites the string.</div>
    <div class="meta">Posted on 2003-03-20 06:56:14 by iblis</div>
   </div>
   <div class="post" id="post-88499">
    <div class="subject"><a href="#post-88499">A little convertion proc</a></div>
    <div class="body">Sephiroth3,<br />1. Please note that you loading value into cl (not in ecx!)<br />and then using loop instruction.<br />What would happen if upper 24 bits in ecx has some garbage?<br />Change the line to mov ecx,...<br />2. Your addressing of agruments is incorrect.<br /> Adjust them by + 8 to your current displacements.<br /><br />Apart from that your code has some interesting ideas,<br />I'm going to steal :)<br />Thanx for your code.</div>
    <div class="meta">Posted on 2003-03-20 13:57:01 by The Svin</div>
   </div>
   <div class="post" id="post-88558">
    <div class="subject"><a href="#post-88558">A little convertion proc</a></div>
    <div class="body">eko, you have good ideas, but NUMEROUS<br />mistakes it every of your proc.<br />Mistakes could be seen at first carefull glance.<br />Please, check and test your code before sending.<br />What is in ebp in the first proc? Value of esp.<br />I.e - return address. Not a string address.<br />More to that, even if wasn't return address (that <br />you actually ovewriting by your proc) you yet<br />sending end of the string not a start.<br />I'm not talking about the last proc.<br />Giving you a chance to correct it by yourself.</div>
    <div class="meta">Posted on 2003-03-20 17:52:31 by The Svin</div>
   </div>
   <div class="post" id="post-88709">
    <div class="subject"><a href="#post-88709">A little convertion proc</a></div>
    <div class="body">you are right . in my first proc <br />there are alot of mistake . too many<br /><br />it will not exit becuase of inc byte ptr <br />the push 0 needs to be before mov ebp,esp<br />and more &quot;stupid&quot; mistakes . this proc needs to be rewrite <br /><br /><br /><br />the 3rd proc is a fix to the 2nd   - I dont know why I left the 2nd proc <br /><br />by the way the proc[3] can be write with the same number of bytes <br />like this <br /><br /><pre><code><br /><br />OPTION PROLOGUE&#58;NONE<br />OPTION EPILOGUE&#58;NONE<br />	<br />StackBinAscii proc uses edi bits,bsize<br /><br />        push 0 <br />        mov ecx,&#91;esp+0ch&#93;<br />        neg ecx<br />        lea eax,&#91;esp+ecx&#93;<br />@@&#58;<br />                                                  ;	mov byte ptr &#91;esp+ecx&#93;,30h<br />	shr dword ptr  &#91;esp+08h&#93;,1<br />	setc byte ptr &#91;esp+ecx&#93;,0   ;adc byte ptr &#91;esp+ecx&#93;,0<br />        add byte ptr &#91;esp+ecx&#93;,30h<br />        inc ecx<br />	jnz @B<br /> 		<br />	invoke SetDlgItemText,hWnd,CtlID,eax<br />	add esp,4 ; can do pop eax or something else to save some bytes<br />	ret<br />StackBinAscii endp<br />OPTION PROLOGUE&#58;PROLOGUEDEF<br />OPTION EPILOGUE&#58;EPILOGUEDEF<br /></code></pre></div>
    <div class="meta">Posted on 2003-03-21 08:48:09 by eko</div>
   </div>
   <div class="post" id="post-88794">
    <div class="subject"><a href="#post-88794">A little convertion proc</a></div>
    <div class="body">I had an idea to change meaning of bsize value<br />to most significant bit index value a limit, that<br />allowed to create 41 bytes solution:<br /><pre><code><br />OPTION PROLOGUE&#58;NONE<br />OPTION EPILOGUE&#58;NONE<br /><br />StackBinAscii proc bits,bsize,hWnd,CtlID<br /><br />	push edi<br />	enter 40,0<br />	mov ecx,&#91;ebp+16&#93;<br />	mov edi,esp<br />@@&#58;<br />	mov al,18h<br />	bt dword ptr &#91;ebp+12&#93;,ecx<br />	adc al,al<br />	stosb<br />	dec ecx<br />	jns @B<br />	mov byte ptr &#91;edi&#93;,0<br />	invoke SetDlgItemText,&#91;ebp+20&#93;,&#91;ebp+24&#93;,esp<br />	leave<br />	pop edi<br />	ret 16<br /><br />StackBinAscii endp<br />OPTION PROLOGUE&#58;PROLOGUEDEF<br />OPTION EPILOGUE&#58;EPILOGUEDEF<br /></code></pre><br /><br />More important that the logic may be used in a task<br />to extract particular field of given value.<br />For example display bits from bit to bit<br />mlbits here is value of most and least significant bit set of <br />the field that need to be extracted and displayed:<br /><pre><code><br />OPTION PROLOGUE&#58;NONE<br />OPTION EPILOGUE&#58;NONE<br /><br />StackBitFldAscii proc bits,mlbits,hWnd,CtlID<br />	push edi<br />	enter 40,0<br />	bsr ecx,&#91;ebp+16&#93;;mlbits most sign. bit<br />	bsf edx,&#91;ebp+16&#93;;least sign. bit<br />	mov edi,esp<br />@@&#58;	mov al,24<br />	bt dword ptr &#91;ebp+12&#93;,ecx<br />	adc al,al<br />	stosb<br />	dec ecx<br />	cmp ecx,edx<br />	jnl @B	<br />	mov byte ptr &#91;edi&#93;,0<br />	invoke SetDlgItemText,&#91;ebp+20&#93;,&#91;ebp+24&#93;,esp<br />	leave<br />	pop edi<br />	ret 16<br />	<br />	ret<br /><br />StackBitFldAscii endp<br /><br />OPTION PROLOGUE&#58;PROLOGUEDEF<br />OPTION EPILOGUE&#58;EPILOGUEDEF<br /></code></pre><br /><br />Example of usage.<br />If we need to display &quot;code or reg&quot; field in modr/m byte:<br /><pre><code><br />;show bits 3..5 in given value<br />	invoke StackBitFldAscii,valueofmodrm,mlb&#40;5,3&#41;,hWnd,15<br />;.......<br />mlb macro msb,lsb<br /> exitm % &#40;&#40;1 shl msb&#41; or &#40;1 shl lsb&#41;&#41;<br />	<br />endm<br />;......<br /></code></pre></div>
    <div class="meta">Posted on 2003-03-21 13:47:50 by The Svin</div>
   </div>
   <div class="post" id="post-88803">
    <div class="subject"><a href="#post-88803">A little convertion proc</a></div>
    <div class="body"><div class="quote"><br /><pre><code><br />add esp,4 ; can do pop eax or something else to save some bytes<br /></code></pre><br /></div><br /><br />You know eko, it looks wierd, especially comments.<br />1. If you know how to write more effective code, why do<br />you write uneffective, mentioning about effective code in comments?<br />Strange style indeed.<br />2. Why use such slappy words as &quot;some bytes&quot; while talking of optimization<br />in wich fundamentals is ability to compare precise values?<br />Are you unable to calculate precise difference between add esp,4 and pop eax?<br />Accuracy is wellcome here.<br />Next time write &quot;save two bytes&quot;<br />3. Why you write &quot;use edi&quot; if your proc doesn't use edi?<br />4. What is <br />setc byte ptr ,0   ?<br />setc recives 1 argument - operand.<br />if you want to set it 0 if CF then write<br />setnc byte ptr  ; no more arg needed.<br /><br />eko, I'm asking you for a second time:<br />could you test your code before sending it, please?</div>
    <div class="meta">Posted on 2003-03-21 14:49:18 by The Svin</div>
   </div>
   <div class="post" id="post-88846">
    <div class="subject"><a href="#post-88846">A little convertion proc</a></div>
    <div class="body">Eeeh...<br />eko, I've read your proc to an end.<br />I think, you need study stack operations in regard of addressing.<br />Any push operation decrease address of stack pointer,<br />that means in your procs you put string to a place where<br />the string is overwritten by following API call after string formation. Cause you place it in esp and lower addresses<br />Thus local string need to be placed in addresses = and upper esp not lower.<br />But in upper addresses there are return and args placed<br />Thus<br />1. You must decrease esp by locals value<br />2. Placed locals in addresses esp and +<br />3. restore esp at the end to make successfull return.</div>
    <div class="meta">Posted on 2003-03-21 16:08:05 by The Svin</div>
   </div>
   <div class="post" id="post-88905">
    <div class="subject"><a href="#post-88905">A little convertion proc</a></div>
    <div class="body"><div class="quote"><br />You know eko, it looks wierd, especially comments.<br />1. If you know how to write more effective code, why do<br />you write uneffective, mentioning about effective code in comments?<br />Strange style indeed.<br />2. Why use such slappy words as &quot;some bytes&quot; while talking of optimization<br />in wich fundamentals is ability to compare precise values?<br />Are you unable to calculate precise difference between add esp,4 and pop eax?<br />Accuracy is wellcome here.<br />Next time write &quot;save two bytes&quot;<br /></div><br /><br />am.. yeah you are right . i should just write pop eax and comment the esp,4<br />i left the add esp,4 just to show my thoughts - next time i'll be accuracy as well<br /><br /><div class="quote"><br />3. Why you write &quot;use edi&quot; if your proc doesn't use edi?<br />4. What is <br />setc byte ptr ,0 ?<br />setc recives 1 argument - operand.<br />if you want to set it 0 if CF then write<br />setnc byte ptr  ; no more arg needed.<br /><br />eko, I'm asking you for a second time:<br />could you test your code before sending it, please?<br /></div><br />use edi left from your proc.  i didnt notice it was there . ;[ <br />the zero of setc [2nd parameter] , left from the old line adc ...,0<br /><br />you are right I need to check my codes . i had few mistakes on the stack I forgot to change esp as well . I was in a hurry when i posted these procs ;[ .<br /><br /><br />here it is . fixed version of my proc - it based zero  <br /><br /><pre><code><br />OPTION PROLOGUE&#58;NONE<br />OPTION EPILOGUE&#58;NONE<br />StackBinAscii proc bits,bsize,hWnd,hCtl<br />       mov ecx,&#91;esp+8&#93;<br />       sub esp,33<br />       and byte ptr &#91;esp+ecx+1&#93;,0<br />@@&#58;<br />	shr dword ptr  &#91;esp+4+33&#93;,1<br />	setc byte ptr &#91;esp+ecx&#93;<br />	add  byte ptr &#91;esp+ecx&#93;,30h<br />                dec ecx<br />	jns @B<br /><br />	push esp<br />   	push &#91;esp+20+33&#93;<br />   	push &#91;esp+20+33&#93;<br />	call SetDlgItemText<br /><br />	<br />	add esp,33<br />	ret<br />StackBinAscii endp<br />OPTION PROLOGUE&#58;PROLOGUEDEF<br />OPTION EPILOGUE&#58;EPILOGUEDEF<br /></code></pre><br /><br />bye<br /><br />eko</div>
    <div class="meta">Posted on 2003-03-21 21:07:54 by eko</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=11622&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=11622&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="11622" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=11622&amp;page=2">&gt;</a><a href="../?id=11622&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>