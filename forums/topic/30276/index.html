<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>PCRE 8.1 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30276" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=30276">PCRE 8.1</a></p>
   <div class="post" id="post-213352">
    <div class="subject"><a href="#post-213352">PCRE 8.1</a></div>
    <div class="body">Hi<br />For a project Iâ€™m working on I needed the PCRE library. I looked on the official site and quickly found out that there is no updated static library around to download. After spending some hours with VS9 I noticed that VS6 was a much better choice because of header dependencies. Finally I got a compiled static library that works fine with masm.<br /><br />Biterider</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=3263" target="_blank">PCRE81S.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2010-10-15 09:50:59 by Biterider</div>
   </div>
   <div class="post" id="post-213387">
    <div class="subject"><a href="#post-213387">Re: PCRE 8.1</a></div>
    <div class="body"><div class="quote">After spending some hours with VS9 I noticed that VS6 was a much better choice because of header dependencies.</div>Hm? Haven&#039;t built a PCRE with VC16 (aka VS2010 release) yet, but for VS2003/2005/2008 it didn&#039;t take long to set up solutions for spitting out static libraries?</div>
    <div class="meta">Posted on 2010-10-24 11:23:54 by f0dder</div>
   </div>
   <div class="post" id="post-213536">
    <div class="subject"><a href="#post-213536">Re: PCRE 8.1</a></div>
    <div class="body">&quot;Finally I got a compiled static library that works fine with masm.&quot; Yes ,I love it.haha..... Thanks!!:P<br /><pre><code>;************************************************************<br />;*--==--* Simple asm program to call pcre 8.1 lib.<br />;*--==--* By G-Spider 2010.11.28<br />;*--==--* Web:http://blog.csdn.net/G_Spider<br />;*--==--* ---------------------------------------------------<br />;*--==--* ml&nbsp; /c /coff asmpcre.asm&nbsp; <br />;*--==--* link /subsystem:console asmpcre.obj<br />;************************************************************<br /><br /> .386<br /> .model flat,stdcall<br /> option casemap:none<br /> <br /> include windows.inc<br /> include user32.inc<br /> include kernel32.inc<br /> include msvcrt.inc<br /> include PCRE81S.inc&nbsp; &nbsp; ;&lt;-------<br /> <br /> includelib user32.lib<br /> includelib kernel32.lib<br /> includelib msvcrt.lib<br /> includelib PCRE81S.lib ;&lt;-------&nbsp; &nbsp; &nbsp; &nbsp; <br /> <br />OVECCOUNT&nbsp; &nbsp; &nbsp;  equ&nbsp; &nbsp;  30 ;/* should be a multiple of 3 */<br />EBUFLEN&nbsp; &nbsp; &nbsp; &nbsp;  equ&nbsp; &nbsp;  128<br />BUFLEN&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equ&nbsp; &nbsp;  1024<br />;***********************************************************;<br />.data<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; szSrc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &nbsp; &#039; href=http://blog.csdn.net/G_Spider+c%2B%2B+&#039;,0<br />&nbsp; &nbsp; &nbsp; &nbsp; szPattern&nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &nbsp; &#039;http://(.*)(..Spider)&#039;,0 <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; szovector&nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &nbsp; &#039;szovector&#91;]= &#039;,0dh,0ah,0<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; fmt1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &nbsp; &nbsp; &#039;String : %s&#039;,0dh,0ah,0<br />&nbsp; &nbsp; &nbsp; &nbsp; fmt2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &nbsp; &nbsp; &#039;Pattern: %s&#039;,0dh,0ah,0dh,0ah,0<br />&nbsp; &nbsp; &nbsp; &nbsp; fmt3&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &nbsp; &nbsp; &#039;%d &#039;,0<br />&nbsp; &nbsp; &nbsp; &nbsp; fmt4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &nbsp; &nbsp; &#039;Return pattern string:&#039;,0dh,0ah,0<br />&nbsp; &nbsp; &nbsp; &nbsp; fmt5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &nbsp; &nbsp; &#039;%s&#039;,0dh,0ah,0<br />&nbsp; &nbsp; &nbsp; &nbsp; szPause&nbsp; &nbsp; &nbsp; &nbsp;  db&nbsp; &nbsp; &nbsp; &#039;Pause&#039;,0<br />&nbsp; &nbsp; &nbsp;  <br /><br />.data?<br />&nbsp; &nbsp; &nbsp; &nbsp; _error&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; &nbsp; &nbsp; ?<br />&nbsp; &nbsp; &nbsp; &nbsp; erroffset&nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; &nbsp; ?<br />&nbsp; &nbsp; &nbsp; &nbsp; ovector&nbsp; &nbsp; &nbsp; &nbsp;  dd&nbsp; &nbsp; &nbsp; OVECCOUNT&nbsp;  dup(?)<br />&nbsp; &nbsp; &nbsp; &nbsp; rc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; &nbsp; &nbsp; ?<br />&nbsp; &nbsp; &nbsp; &nbsp; result&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; &nbsp; &nbsp; ?&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />	<br /><br />;***********************************************************<br />.code<br />;-----------------------------------------------------------<br />start:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; crt_printf,offset fmt1,offset szSrc<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; crt_printf,offset fmt2,offset szPattern<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; pcre_compile,offset szPattern,0,offset _error,offset erroffset,0<br />&nbsp; &nbsp; &nbsp; &nbsp; .if&nbsp; &nbsp;  eax==NULL<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke MessageBox,NULL,0,0,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; pcre_exec,eax,0,offset szSrc,sizeof szSrc,0,0,offset ovector,OVECCOUNT<br />&nbsp; &nbsp; &nbsp; &nbsp; ;????????????????-1<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  rc,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp;  edx,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; and&nbsp; &nbsp;  edx,80000000h<br />&nbsp; &nbsp; &nbsp; &nbsp; .if&nbsp; &nbsp;  edx!=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; crt_printf,offset fmt3,eax <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; MessageBox,NULL,0,0,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke	ExitProcess,0<br />&nbsp; &nbsp; &nbsp; &nbsp; .endif<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; crt_printf,offset fmt4<br />&nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp;  eax,eax ;eax=1?&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; .while&nbsp; eax&lt;rc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; pcre_get_substring,offset szSrc,offset ovector,rc,eax,offset result<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; crt_printf,offset fmt5,result<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop&nbsp; &nbsp;  eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc&nbsp; &nbsp;  eax<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; .endw&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;int pcre_get_substring(const char *subject, int *ovector,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;int stringcount, int stringnumber,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;const char **stringptr)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; crt_printf,offset szovector<br />&nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp;  eax,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; .while&nbsp; eax&lt;OVECCOUNT<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; crt_printf,offset fmt3,ovector[4*eax]<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pop&nbsp; &nbsp;  eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; inc&nbsp; &nbsp;  eax <br />&nbsp; &nbsp; &nbsp; &nbsp; .endw<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; pcre_free,rc<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; crt_system,offset szPause<br />	invoke	ExitProcess,0<br />end start<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></code></pre><br /><br /><br /><br /></div>
    <div class="meta">Posted on 2010-11-28 06:15:55 by G-Spider</div>
   </div>
  </div>
 </body>
</html>