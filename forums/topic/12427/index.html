<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>align macro help please - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12427" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12427">align macro help please</a></p>
   <div class="post" id="post-95924">
    <div class="subject"><a href="#post-95924">align macro help please</a></div>
    <div class="body">I ran into these two c macros and don't know how to convert them to masm.  they are supposed to word align a pointer.  Can someone with macro knowledge convert these for me?<br /><br /><pre><code><br />#define Packet_ALIGNMENT sizeof&#40;int&#41;<br />#define Packet_WORDALIGN&#40;x&#41; &#40;&#40;&#40;x&#41;+&#40;Packet_ALIGNMENT-1&#41;&#41;&amp;~&#40;Packet_ALIGNMENT-1&#41;&#41;<br /></code></pre><br /><br />TIA!</div>
    <div class="meta">Posted on 2003-04-12 13:36:09 by rdaneel</div>
   </div>
   <div class="post" id="post-95930">
    <div class="subject"><a href="#post-95930">align macro help please</a></div>
    <div class="body">for the Packet_ALIGNMENT:<br />masm32 provides SIZEOF too.<br /><br />and the Packet_WORDALIGN:<br />x is the variable for the macro, packetalignment is already defined. the &amp; is a binary and, the ~ is a binary negation. you can use the instruction <strong>not</strong> to do this binary negation. <strong>and</strong> for the binary and</div>
    <div class="meta">Posted on 2003-04-12 13:43:56 by hartyl</div>
   </div>
   <div class="post" id="post-95932">
    <div class="subject"><a href="#post-95932">align macro help please</a></div>
    <div class="body">does C define an int as a word?</div>
    <div class="meta">Posted on 2003-04-12 13:48:10 by rdaneel</div>
   </div>
   <div class="post" id="post-95953">
    <div class="subject"><a href="#post-95953">align macro help please</a></div>
    <div class="body">DWORD Signed integer I think.<br /><br />PS: is the R.Daneel from R.Daneel Olivaw (Asimov) ?</div>
    <div class="meta">Posted on 2003-04-12 15:53:11 by donkey</div>
   </div>
   <div class="post" id="post-95992">
    <div class="subject"><a href="#post-95992">align macro help please</a></div>
    <div class="body">The size of an int in C is not standard. In old compilers like borland c (and other dos compilers) it's 16 bits long, in compilers for newer operating systems it's usually 32 bits. It's always a signed data type, though.</div>
    <div class="meta">Posted on 2003-04-12 19:05:36 by Knightmare</div>
   </div>
   <div class="post" id="post-96064">
    <div class="subject"><a href="#post-96064">align macro help please</a></div>
    <div class="body"><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=6187&amp;perpage=15&amp;pagenumber=2">http://www.asmcommunity.net/board/index.php?topic=6187&amp;perpage=15&amp;pagenumber=2</a></div>
    <div class="meta">Posted on 2003-04-12 23:51:36 by roticv</div>
   </div>
   <div class="post" id="post-96130">
    <div class="subject"><a href="#post-96130">align macro help please</a></div>
    <div class="body">rdaneel,<br /><br />Have a look in the DIALOGS.INC file in the current version of MASM32 for a pair of macros that control alignment of memory.<br /><br />They are very easy to modify to whatever alignment you require with the shift amount with SHR/SHL.<br /><pre><code><br />      align_4 MACRO reg<br />        add reg, 3<br />        shr reg, 2<br />        shl reg, 2<br />      ENDM<br /></code></pre><br />All you do is add the shift amount minus one and shift both ways the corect amount.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2003-04-13 08:19:24 by hutch--</div>
   </div>
   <div class="post" id="post-96156">
    <div class="subject"><a href="#post-96156">align macro help please</a></div>
    <div class="body">thanks guys.  i still don't understand alignment very well but hutches suggestion seems to be working like it should.<br /><br />donkey, Yes it is from Asimov.  He is simply the <strong>god</strong> of sci-fi.</div>
    <div class="meta">Posted on 2003-04-13 09:24:35 by rdaneel</div>
   </div>
  </div>
 </body>
</html>