<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Help Me Test? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27479" />
    <link rel="next" href="../?id=27479&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27479">Help Me Test?</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=27479&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=27479&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="27479" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=27479&amp;page=2">&gt;</a><a href="../?id=27479&amp;page=2">&raquo;</a></form>   <div class="post" id="post-196464">
    <div class="subject"><a href="#post-196464">Help Me Test?</a></div>
    <div class="body">I made a program that is going to
be a Demo with source code.
But before I let the demo and the
source code out, I need to make sure
it runs on other systems. please
test this for me and tell me what
OS you was running and if there was
any problems. Please test it and try
to find any errors. This example shows
how to makes skins,fake Title bars,
recource thru directorys,moving your
window with mouse traping. You can get
the program at 
FindallFiles.exe
Thank you...</div>
    <div class="meta">Posted on 2001-03-31 11:59:00 by Zcoder</div>
   </div>
   <div class="post" id="post-196465">
    <div class="subject"><a href="#post-196465">Help Me Test?</a></div>
    <div class="body">very cool program and fast. might i suggest a clear button.
worked great on my p3 500 running windows 2000sp1. utilized 80-94 percent of cpu with 14,928k of memory while searching my c: partition. on first startup cpu usage is 0 and memory is 1,916k.
after search is completed cpu is back to 0 percent and memory is still at 14,928k.


keep up the work
smurf

oh ya i tested it for about 5 min not too long but checked my cd, a:, c: drives without any difficulty. when drive a: had no disk in the drive the a message poped up. but when i tryed to search my cd drive without a cd there was no indication that i had no cd in the drive other than the fact in the set path.... it showed there wasnt a cd in the drive. *shrug*


I verified the vertical movement bug on win2k. it appeared to minimize to the system taskbar but from there i could never get the window to reappear... i would have to close out the program. rinsed and repeated many times and the bug was consistent.

This message was edited by smurf, on 3/31/2001 2:28:03 PM

This message was edited by smurf, on 3/31/2001 2:31:57 PM

This message was edited by smurf, on 3/31/2001 7:59:18 PM</div>
    <div class="meta">Posted on 2001-03-31 13:27:00 by smurf</div>
   </div>
   <div class="post" id="post-196466">
    <div class="subject"><a href="#post-196466">Help Me Test?</a></div>
    <div class="body">Hi,

I checked your proggy on my AMD K5 PR-150 with 48MB Ram running Win98SE and I have had no problems with it. I used it on my small HD (1.7GB) and it was really fast and stable and didn't take my system down that much. Afterwards I checked it on my newer HD (10GB Partition of 20.2 GB) with 15,405 files on it and I had still been able to browse through the I-Net, receive my mails and do some small games. I am really looking forward for getting the source as there are several aspects I like to see.

For now I can only say that there are no problems and the program runs stable.

Stefan

P.S. I am interested what The Svin will say to your proggy Ã¡s he is nearly always the one finding mistakes!</div>
    <div class="meta">Posted on 2001-03-31 15:59:00 by Stefan Krause</div>
   </div>
   <div class="post" id="post-196467">
    <div class="subject"><a href="#post-196467">Help Me Test?</a></div>
    <div class="body">I moved it fast verticaly and it disapired from the screen.
It was on task bar though.
But clicking it on the task bar did help to bring it to the
screen.
I closed it with right click menu.
Repeated several times the same action - effect always the same.
Win NT 4.0 WS. SP 4.
The Svin.</div>
    <div class="meta">Posted on 2001-03-31 16:40:00 by The Svin</div>
   </div>
   <div class="post" id="post-196468">
    <div class="subject"><a href="#post-196468">Help Me Test?</a></div>
    <div class="body">Windows 2000, dual 800Mhz, 384MB PC133

I tried it on my small drive 72,205 files. Same problem as Svin - when the window is moved vertically.  Also, the title bar redraw isn't right when another window overlapse.  Cool colors :D</div>
    <div class="meta">Posted on 2001-03-31 17:04:00 by bitRAKE</div>
   </div>
   <div class="post" id="post-196469">
    <div class="subject"><a href="#post-196469">Help Me Test?</a></div>
    <div class="body">I have two OS's on my computer now
win98 and windows ME, I have found
no problems with them. I do have
windows 2000 I might have to install
it so I can find out why it seems to
have that problem. And thanks to everyone
that has tried it and I really like the
way everyone really tested it out. 
I will be fixing the problems and will
put the source out as soon, as I get the
problems figured out. I know there are alot
of vertions of each windows OS's so I still
need it tested on afew of those as well..</div>
    <div class="meta">Posted on 2001-03-31 17:56:00 by Zcoder</div>
   </div>
   <div class="post" id="post-196470">
    <div class="subject"><a href="#post-196470">Help Me Test?</a></div>
    <div class="body">i think its time for Svinn to upgrade. im pretty sure service pack 23 is out.

smurf</div>
    <div class="meta">Posted on 2001-03-31 19:03:00 by smurf</div>
   </div>
   <div class="post" id="post-196471">
    <div class="subject"><a href="#post-196471">Help Me Test?</a></div>
    <div class="body">win2000 here
if it's moved too fast in any direction then it will hide in the taskbar and won't come out again. The process also keeps running for a while.

I use this to move custom windows:
<pre><code>
    .ELSEIF uMsg==WM_LBUTTONDOWN
	call ReleaseCapture
	invoke SendMessage,hWnd,WM_NCLBUTTONDOWN, HTCAPTION,0</code></pre>

since it is actually the behaviour what you'd get in normal windows. It can be modified so that it only responds to mouse downs in certain regions. (with a rectangle shaped bar it's not hard I imagine :) )

The only 'problem' I have with it is that it shows the 'original' shape of your window. Which is less pretty with a fancy bitmap based window. Can't have it all I guess :)</div>
    <div class="meta">Posted on 2001-03-31 19:10:00 by Hiroshimator</div>
   </div>
   <div class="post" id="post-196472">
    <div class="subject"><a href="#post-196472">Help Me Test?</a></div>
    <div class="body">I grabbed the title bar and moved it quickly, the Window disappeared, and I couldn't get it back.  I closed it by right clicking on the Start bar.

Running it multiple times on one or more drives consumes memory, there is a leak. :(

Window is too small to see full paths, horizontal scroll doesn't work.

Grab vertical scroll bar and slide it down after a few hundred files, get chattering scroll as list gets longer.

I would suggest after the visible portion of the display list is filled, that you disable writing to the screen, except every so many files.

If I change the path without using the Set Path button, the path searched doesn't change. I can also change the Searching...Finished line, or the number in the Files display line.

NT4 sp6 dual 667 PIII 1GB, Matrox G400 dualhead, UWFast SCSI hardware raid. <g>
NTs Find Files is faster by orders of magntude.

Win98 P100 64mb, Cirrus logic video, mixed SCSI and IDE drives.
98s Find Files aborted with too many files.</div>
    <div class="meta">Posted on 2001-03-31 19:15:00 by SFinegan</div>
   </div>
   <div class="post" id="post-196473">
    <div class="subject"><a href="#post-196473">Help Me Test?</a></div>
    <div class="body">I have a similar program I wrote recently, so I had something to benchmark yours with. To make the benchmarking "fair", I set my listbox to LBS_SORT and added a file counter. My computer is a 500mHz P3 with 64M ram and a 6 gig HD (29,251 files) running Win98 SE.
Results:
your prog -> approx 46 sec.
my prog -> approx 12 sec.
my prog -> approx 2 sec. (without the overhead of displaying to the screen)
I don't know if you saw it but my search alog. was posted awhile back and then optimized by The Svin.
Then I tried running them both at the same time. This was educational(?). Your program slows to a crawl until mine finishes. This happens no matter which one starts first. I'm not using threads or priority boosting of any sort so this kind of suprised me.
Other comments,
My program -> Fast,Ugly,8k
Your program -> Could be faster,Very pretty,669k
Also, there has to be a way to have a title on the toolbar button without having a window title. I don't know how yet but its easy to do with delphi.


This message was edited by anon, on 3/31/2001 9:21:49 PM</div>
    <div class="meta">Posted on 2001-03-31 20:17:00 by anon</div>
   </div>
   <div class="post" id="post-196474">
    <div class="subject"><a href="#post-196474">Help Me Test?</a></div>
    <div class="body">anon,
My Sub rutine does it in 1.7 sec.
thats with 84,712 files and God knows
how many folders. maybe I should make it
count the folders as well.
The sub is only 59 bytes, without
the extra stuff to display the file
count and the file names. Anyway
I have it doing other stuff such as
calling Iczelion's DWORD to Ascii
then I wanted comma's in my value's
so I had to reformat it with comma's
The whole program was not written as a
life saver, critical time was not on
my list for this Demo. If it was I would not
have had all the makeup on the app to make it
look so bretty. I was showing how others that
don't know much about making windows look different
also the search algo can be used in other stuff.
I just put alot of stuff together that I learned
to kinda make a program that serves no perpose but
to show some example coding, I plan on fixing the problems
and then put out the source. By the way, if speed is so
important you should find or write a windows in asm
couse when you run in a OS that is slow all you can make
faster is what goes on in your app, it slows down when you
call into windows, sooooo. I do code with speed in mind
it is just what comes natural to a 20 year assembler
programmer. But when it comes to some app's it is not
important. I have done stuff in just 64k of ram that most
people would find hard like editing an unlimited file size.
I already know about coding small and fast.
Assembly is the only language I know, I have written in
it for over 20 years, I have been in most of the older
systems, programed for alot of CPU's written compilers
decompilers, ZRUN was one I wrote for the Z80, I found out
not that long ago that I had the tools to program in
windows, so I come here to help get good with windows
and to help people here. fast coding should not be important
to a beginner he will get that into his blood as he gains
more ground, same as it came to me. crawl before you walk.
I guess I am here to help others. If someone ask's me how
I can speed up something, then I will show them some fast
code. Also by no means was I tring to out do your file
search algo. and I still have no desire to do so.
maybe when I get that big job working for NASNA and writting
time cridical code for there space shuttle then I guess
I would. Like I said I am here to learn and to help others.

   

This message was edited by Zcoder, on 3/31/2001 11:20:44 PM</div>
    <div class="meta">Posted on 2001-03-31 22:04:00 by Zcoder</div>
   </div>
   <div class="post" id="post-196475">
    <div class="subject"><a href="#post-196475">Help Me Test?</a></div>
    <div class="body">My puter: Win98 500Mhz 64Megs Ram

Not to bad, my only advice is:
-In the taskbar, your app has the default windows icon (patch up the small icon in the WNDCLASSEX structure) and as somebody said before, when your app is searching, stick the mouse cursor over the listbox and you will notice it flickering, that means, say for when searching my C Drive, the listbox is trying to redraw itself about 25,780 times :(. 

-Unless you use the select path button, it automacticly starts searching c:\.

-If you are searching you can continue to click Find All multible times 


Stats:

Cdrive: 25,780 files: 55 secs
Ddrive (CD-Rom): 3,192 files: 3 secs (includes diskbuffer mechanism)</div>
    <div class="meta">Posted on 2001-03-31 22:46:00 by George</div>
   </div>
   <div class="post" id="post-196476">
    <div class="subject"><a href="#post-196476">Help Me Test?</a></div>
    <div class="body">Zcoder,
I wasn't criticizing (or bragging). Was just making some observations. I will certainly study your code when it is released.

I think most of us are here to learn and share.</div>
    <div class="meta">Posted on 2001-03-31 23:12:00 by anon</div>
   </div>
   <div class="post" id="post-196477">
    <div class="subject"><a href="#post-196477">Help Me Test?</a></div>
    <div class="body">Zcoder,
on my win95, PII 300Mhz, 50M ram your program work well and fast.

I've seen that your windows move very fast when you drag it on the screen. That's what i was trying to do without success. I've done a little program with a custom round bitmap window but it's not so fast. When i move it there is some delay about pixels refresh, expecially if there is another app. open as background.
I mean that after dragging, for a moment i see old window again on the screen.
Have you some suggestion to make my window fast as your is when i drag it with the mouse ?

thanks angelo</div>
    <div class="meta">Posted on 2001-04-02 15:41:00 by angelo</div>
   </div>
   <div class="post" id="post-196478">
    <div class="subject"><a href="#post-196478">Help Me Test?</a></div>
    <div class="body">angelo,
I can give you the bare bones of this
program. I am working on it still But
I can give you the bare bones version
where you can see how I am draging the window
ect. I won't resease this yet as I hate to
release junk out there is still problems with
it. I once posted some source to  Iczelion
there was some small bugs I forgot. He never
posted them so, I don't release code anymore
untill I have tested it.
If your interested just post a reply on
this site and I will send you the code for
the draging part ect... 



This message was edited by Zcoder, on 4/2/2001 11:09:21 PM</div>
    <div class="meta">Posted on 2001-04-02 23:04:00 by Zcoder</div>
   </div>
   <div class="post" id="post-196479">
    <div class="subject"><a href="#post-196479">Help Me Test?</a></div>
    <div class="body">Zcoder,
thanks in advice for your answer.
Yes, i'm very interested in your code, also only for creating windows and dragging.
But i've not hurry ! I can also wait the final release.

Thanks again</div>
    <div class="meta">Posted on 2001-04-03 01:59:00 by angelo</div>
   </div>
   <div class="post" id="post-196480">
    <div class="subject"><a href="#post-196480">Help Me Test?</a></div>
    <div class="body">zcoder i would like to take a look at your code if you dont mind.

thanks
smurf</div>
    <div class="meta">Posted on 2001-04-03 02:27:00 by smurf</div>
   </div>
   <div class="post" id="post-196481">
    <div class="subject"><a href="#post-196481">Help Me Test?</a></div>
    <div class="body">Zcoder, can you tell us how you coded the QuitAll part of your program? :rolleyes:</div>
    <div class="meta">Posted on 2001-04-03 06:59:00 by wolfao</div>
   </div>
   <div class="post" id="post-196482">
    <div class="subject"><a href="#post-196482">Help Me Test?</a></div>
    <div class="body">wolfao,
I am not sure what you mean by "QuitAll part of your program? "
Could you explain what you mean by that? maybe it's just
going over my head.... Anyway I will be glade to offer
any part of the program that is working correctly so please
be more clear on what you mean...</div>
    <div class="meta">Posted on 2001-04-03 08:04:00 by Zcoder</div>
   </div>
   <div class="post" id="post-196483">
    <div class="subject"><a href="#post-196483">Help Me Test?</a></div>
    <div class="body">Very impressive,

It worked great on my celeron 400 running windows 98se

I think that "wolfao" mean that when you quit the program
that you run 1410048 bytes of .AVI.


I grabbed the title bar and moved it quickly,
the Window did not disappear,
and all of it behaved quite well.

What surprise me, is that you have nearly
everything as dialogs in .rc file
and only 3 static windows as buttons.

Also your background bitmap is 157462 bytes
- really large while your code
is only 6862 bytes including data.

Well it could be easily compressed and it
would become 6 times smaller.

Good work

forge</div>
    <div class="meta">Posted on 2001-04-03 08:15:00 by forge</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=27479&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=27479&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="27479" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=27479&amp;page=2">&gt;</a><a href="../?id=27479&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>