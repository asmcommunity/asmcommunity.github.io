<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>PE password? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14718" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14718">PE password?</a></p>
   <div class="post" id="post-114051">
    <div class="subject"><a href="#post-114051">PE password?</a></div>
    <div class="body">I have a curious about protecting an win32 application from unauthorized people by injecting a password into PE header.<br />so, when anybody running such a potected application, windows displays a dialog box to get the password required to run it.<br /><br />How can i do that? Where is the place the password can be aside?<br /><br />Thankyou for reading..<br />Regards..</div>
    <div class="meta">Posted on 2003-08-16 07:28:37 by Yeori</div>
   </div>
   <div class="post" id="post-114054">
    <div class="subject"><a href="#post-114054">PE password?</a></div>
    <div class="body">example + source (asm)</div>
    <div class="meta">Posted on 2003-08-16 07:59:14 by wizzra</div>
   </div>
   <div class="post" id="post-114059">
    <div class="subject"><a href="#post-114059">thank you</a></div>
    <div class="body">thank you @wizzra.<br /><br /><br />But,,,, it doesnt work on my XP system. After setting up a password an win32 program, i cant run the protected program any more.<br />System shows an error message to me..<br /><br />anyway.. can i get docs describing THESE ALGORITM somewhere?<br />i just want to know the its algoritm than real source files...<br /><br />thankyou.</div>
    <div class="meta">Posted on 2003-08-16 10:00:50 by Yeori</div>
   </div>
   <div class="post" id="post-114066">
    <div class="subject"><a href="#post-114066">PE password?</a></div>
    <div class="body">Yeori, check out <a target="_blank" href="http://www.programmingjournal.com/">http://www.programmingjournal.com/</a> and specifically Programming Journal #3 has a tutorial called &quot;Coding a small PE wrapper.&quot;<br /><br />I don't know if it works on XP, but it's more than just a source code.</div>
    <div class="meta">Posted on 2003-08-16 12:37:56 by SamiP</div>
   </div>
   <div class="post" id="post-114102">
    <div class="subject"><a href="#post-114102">PE password?</a></div>
    <div class="body"><a target="_blank" href="http://www.programmingjournal.com/">http://www.programmingjournal.com/</a> <br /><br />&quot;Locating API functions in memory (MASM)&quot;  ... the ZIP<br /><br />Why is this the only thing being blocked...<br /><br />Do you have a copy SamiP.  Everything else but this will not download to my machine.  Is anyone else seeing this problem.  <br /><br />Must be something <strong>DECENT !!!</strong></div>
    <div class="meta">Posted on 2003-08-16 22:30:14 by cmax</div>
   </div>
   <div class="post" id="post-114105">
    <div class="subject"><a href="#post-114105">PE password?</a></div>
    <div class="body">Forget it, I think the site new set-up and ideas are not completed just yet.  He got enough information right under the header.<br /><br />I really like his improvements. He is getting down to the nity gritty of API in ASM instead of C++ for every dame thing.  I am more interested in the (ASM) (API) subject than anything else these days.  Maybe thats why MS want to release the source in a cracker jack box because of those great coders who doing it ALL ON THERE OWN like the man from the Journal.  Who need faults favors after all of these years of hiding it for the Programmer themself then turn around and screw it all up with some unknown new style programming scripts and sh*t making all of this for nothing like what happened to Dos programming....   SAVE IT... Those goofy greedy Boys are the people that is going to bring a great company down and many other with it.<br /><br />Who ever got the API hook in pure assemblers must be a happy KING ... Who cares about Ring0 and sh*tty bounce back to Ring3 protections scheems.  Just show me that hidden pure ASM api hook and MS themself will NEVER crack any thing i write and no one else for that matter.  Yes this my THREAT, DARE, B E T ... ..BET<br /><br />Not looking for a responce.  Just blowing off a little steam after my visit.  It gave me a lot of (ON THE MAP) ideas .  And Me King i will match you SHORTLY... :) I release the floor and let Yeori get back to business... <br /><br />Thank you<br /><br />What a Great Old awaking Link<br /><br /><br /><span style="font-size:9px>PS:  I am acually kind of piss off because like fl00der told us over and over again.... See the Anti debugger thread... and S.T.A.S. seems to proved a few things about the subject....</span> So im tryyyyyyinggggg to face reallity.</div>
    <div class="meta">Posted on 2003-08-17 01:11:54 by cmax</div>
   </div>
   <div class="post" id="post-114110">
    <div class="subject"><a href="#post-114110">ohhh...</a></div>
    <div class="body">Thank you all guys.. i think i got a clue! :) <br /><br />Listen.. and check up my clue whether or not it's right.<br />The Encryption of win32 apps isn't a something special feature supported by MS or PE header.<br />Because, to encrypt an win32 program, we must inject some codes into a target program in order to show a dialog box where a user can type a password.<br />In addition, to complete, PE header table also must be updated with a new list of imported funtions,  and the entry point of PE header should be redirected to codes that shows a dialog box.<br /><br />This is the true story of encrypting PE header i think... is it right????? :grin:</div>
    <div class="meta">Posted on 2003-08-17 02:24:05 by Yeori</div>
   </div>
   <div class="post" id="post-114193">
    <div class="subject"><a href="#post-114193">PE password?</a></div>
    <div class="body">Evudently you do, :)<br /><br />I don't know but the word inject makes many run for cover.</div>
    <div class="meta">Posted on 2003-08-18 01:18:30 by cmax</div>
   </div>
   <div class="post" id="post-114239">
    <div class="subject"><a href="#post-114239">PE password?</a></div>
    <div class="body"><div class="quote">In addition, to complete, PE header table also must be updated with a new list of imported funtions</div> <br /><br />That's not neccessary, you can use LoadLibrary + GetProcAddress APIs in your injected code. You can even search DLLs for wanted exports by their hints/names instead of using GetProcAddress :)</div>
    <div class="meta">Posted on 2003-08-18 12:00:53 by Sorthalan</div>
   </div>
   <div class="post" id="post-114244">
    <div class="subject"><a href="#post-114244">yes</a></div>
    <div class="body">yes, @Sorthalan. You're right! ;) <br />Thank you for checking up!<br /><br />and, Have a good day all guys ~ :)</div>
    <div class="meta">Posted on 2003-08-18 13:25:54 by Yeori</div>
   </div>
  </div>
 </body>
</html>