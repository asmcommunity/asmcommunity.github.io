<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>detect a mic on a system - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24880" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24880">detect a mic on a system</a></p>
   <div class="post" id="post-181754">
    <div class="subject"><a href="#post-181754">detect a mic on a system</a></div>
    <div class="body">how i detect mic is pluuged or unplugged to a system port<br />any api or any port for detection<br />if yes then plz explain with sort of brief example.</div>
    <div class="meta">Posted on 2006-06-14 08:16:38 by sihotaamarpal</div>
   </div>
   <div class="post" id="post-181762">
    <div class="subject"><a href="#post-181762">Re: detect a mic on a system</a></div>
    <div class="body">I don&#39;t know if there&#39;s a &#39;correct&#39; way to do this, but I&#39;ll explain how I achieved something very close to it.<br />Create a small application which uses either DSound or the wav api to capture a small 8-bit audio sample, then examine the data.<br />If there&#39;s no microphone plugged in, or if the device is muted, your audio buffer will be full of bytes that contain 80h... why?<br />If we consider that an 8 bit wav data can only range between 00h and FFh, and that audio waves can go above and below the &#39;zero line&#39;, then it becomes clear that 80h is the &#39;zero line&#39;, and that lots of 80h means &#39;silence&#39; :)<br /><br />Note that the bytes in the buffer can contain a little &#39;jitter&#39; ie perhaps some bytes will be 7Fh or 81h or similar - this is due to the imperfect nature of analog to digital converters as well as many other technical contributing factors (electromagnetic hum, crappy soundcard, etc) but compared to an ACTUAL audio recording, it&#39;s &#39;damn close to silence&#39;.<br /></div>
    <div class="meta">Posted on 2006-06-14 09:30:17 by Homer</div>
   </div>
   <div class="post" id="post-181766">
    <div class="subject"><a href="#post-181766">Re: detect a mic on a system</a></div>
    <div class="body">hi homer<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if in this case if mic if attached and in mute mode then again the same result what u think of 80H,my main aim to acheive&nbsp; mic is attached to port or not.<br />can i send some data to mic port and if working after some polling period i got a response and if not in working stage then no data comes or data comes in both cases but different.but how i acheive this all any idea.app like yahoo msg how detects mic availabilty. </div>
    <div class="meta">Posted on 2006-06-14 09:46:16 by sihotaamarpal</div>
   </div>
   <div class="post" id="post-181848">
    <div class="subject"><a href="#post-181848">Re: detect a mic on a system</a></div>
    <div class="body">As far as I know, Yahoo Messenger simply *does not* detect the microphone - it *does* detect the presence of audio capture hardware (ie a soundcard).. when using that client, when joining a room I automatically join Voice regardless of whether a mic is plugged into my soundcard or not.<br /><br />Try it for yourself :)<br /></div>
    <div class="meta">Posted on 2006-06-15 00:43:35 by Homer</div>
   </div>
   <div class="post" id="post-181854">
    <div class="subject"><a href="#post-181854">Re: detect a mic on a system</a></div>
    <div class="body">Simply: there is no ability to detect if a microphone is physically plugged in to the jack or not.</div>
    <div class="meta">Posted on 2006-06-15 03:32:59 by comrade</div>
   </div>
  </div>
 </body>
</html>