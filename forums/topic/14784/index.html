<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>A small RadASM addin - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14784" />
    <link rel="next" href="../?id=14784&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=42">RadASM</a> &raquo; <a href="../?id=14784">A small RadASM addin</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=14784&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=14784&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="14784" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=14784&amp;page=2">&gt;</a><a href="../?id=14784&amp;page=2">&raquo;</a></form>   <div class="post" id="post-114635">
    <div class="subject"><a href="#post-114635">A small RadASM addin</a></div>
    <div class="body">I had some dead hours this morning so I whipped up this, it's a program that allows you to lookup system errors and see their description (FormatMessage API). You can enter both the equate name and the number itself, in decimal or hexadecimal (preceded by &quot;0x&quot;). There's an EXE version (for any IDE) and a RadASM specific DLL version.<br />If you found it useful please let me know, it's my first attempt at a RadASM addin. :)</div>
    <div class="meta">Posted on 2003-08-20 16:58:26 by QvasiModo</div>
   </div>
   <div class="post" id="post-114739">
    <div class="subject"><a href="#post-114739">A small RadASM addin</a></div>
    <div class="body">QvasiModo,<br /><br />I like your idea and I would be very happy to have such an Add-In for WinAsm. If you are kind enough to implement it (I mean a true Add-In, not a dll that will call your EXE) I would highly appreciate it.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-21 05:38:54 by akyprian</div>
   </div>
   <div class="post" id="post-114742">
    <div class="subject"><a href="#post-114742">A small RadASM addin</a></div>
    <div class="body">Hi QvasiModo<br /><br />Nice addin. Should be very useful.<br />One thing. OS'es with other nationalities has different text formatting. Maybe make the edit box a little wider.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-08-21 06:09:34 by KetilO</div>
   </div>
   <div class="post" id="post-114833">
    <div class="subject"><a href="#post-114833">A small RadASM addin</a></div>
    <div class="body">Before You create font for the error message field, You should do something like this:<br /><br /><br />.data?<br />  tm TEXTMETRIC &lt;&gt;<br />  hDC dd ?<br />  hWnd dd ?<br /><br />.code<br />  invoke GetDesktopWindow<br />  mov hWnd,eax<br />  invoke GetDC,eax<br />  mov hDC,eax<br />  invoke GetTextMetrics,eax,offset tm<br />  invoke ReleaseDC,hWnd,hDC<br /><br /><br />and then copy tm.tmCharSet to the appropriate field in your LOGFONT structure. This will <strong>hopefully</strong> fix the problem with national characters in error messages. Well, at least it helped me when I manually edited WinErr.exe entering 0xEE as the charset (I'm using Polish Win98 now, so EASTEUROPE_CHARSET is my local preference :) )</div>
    <div class="meta">Posted on 2003-08-21 15:18:53 by Morris</div>
   </div>
   <div class="post" id="post-114847">
    <div class="subject"><a href="#post-114847">A small RadASM addin</a></div>
    <div class="body">Glad you guys liked it :)<br /><br /><strong>akyprian:</strong>  It is a real add-in... I made the EXE version first, then the DLL once I found out how to make an addin. I kept the EXE in case you wanted to use it in a different IDE, but it is not necessary for Radasm. Just install the DLL as a regular addin (option 0 for disabled, 1 for enabled).<br /><br /><strong>KetilO:/B] Good suggestion, in fact it is a little small for any language... so next version will be resizable, and will save the last used position.<br /><br /><strong>Morris:</strong> Noted, will do in next version too.<br /><br />Thank you all for your support :alright:</div>
    <div class="meta">Posted on 2003-08-21 17:42:49 by QvasiModo</div>
   </div>
   <div class="post" id="post-114919">
    <div class="subject"><a href="#post-114919">A small RadASM addin</a></div>
    <div class="body">Hi,<br /><br />I am not sure whether You understood very well what I meant. I would like to have a TRUE Add-In for the WinAsm IDE, if you want to do it of course.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-22 00:00:48 by akyprian</div>
   </div>
   <div class="post" id="post-114992">
    <div class="subject"><a href="#post-114992">A small RadASM addin</a></div>
    <div class="body">Sorry, silly me, I didn't catch the &quot;WinAsm&quot; part :o :grin:<br />Sure, will do. Do I need something else apart from WinAsm help files?</div>
    <div class="meta">Posted on 2003-08-22 09:41:38 by QvasiModo</div>
   </div>
   <div class="post" id="post-115020">
    <div class="subject"><a href="#post-115020">A small RadASM addin</a></div>
    <div class="body">Hi,<br /><br />I am glad you will do! If you start with sample &quot;Add-In One&quot; as your basis, you will find no difficulties(I hope!). You can ask for any information or halp you might need.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-22 11:33:29 by akyprian</div>
   </div>
   <div class="post" id="post-115056">
    <div class="subject"><a href="#post-115056">A small RadASM addin</a></div>
    <div class="body">Fresh from the oven, the updated version :).<br />Now the dialog is resizable, and the charset problem should be solved (thanks, Morris!). Still needs some work, though... the error messages are still formatted to 30 chars wide, and it doesn't save the last position and size.</div>
    <div class="meta">Posted on 2003-08-22 19:11:42 by QvasiModo</div>
   </div>
   <div class="post" id="post-115057">
    <div class="subject"><a href="#post-115057">A small RadASM addin</a></div>
    <div class="body">akyprian, I could not manage to make it work for WinAsm... I'm posting part of the code here, tell me what I'm doing wrong.<br />I tried placing the compiled version in the addins folder, but it doesn't show up in the addin maganer. Editing the ini file did not help either. :confused:</div>
    <div class="meta">Posted on 2003-08-22 19:13:30 by QvasiModo</div>
   </div>
   <div class="post" id="post-115077">
    <div class="subject"><a href="#post-115077">A small RadASM addin</a></div>
    <div class="body">Hi,<br /><br />I do not see anything wrong with the code. Is everything the way it should be in your *.def file ?<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-22 23:15:51 by akyprian</div>
   </div>
   <div class="post" id="post-116155">
    <div class="subject"><a href="#post-116155">A small RadASM addin</a></div>
    <div class="body">Sorry I didn't reply before, I was at home with the flu until today... :P<br />Anyway, you are right, the problem was in the .def file. I had accidentally replaced donkey's MakeDef addin with an old version (the one with that infamous bug that silently deleted the contents of the def file).<br />So, here's the final version. They are 3 files, each one is independent from the others: the RadAsm version, the WinAsm version, and a standalone version to integrate into anything else.</div>
    <div class="meta">Posted on 2003-08-29 14:54:33 by QvasiModo</div>
   </div>
   <div class="post" id="post-116162">
    <div class="subject"><a href="#post-116162">A small RadASM addin</a></div>
    <div class="body">Thanks QvasiModo,<br /><br />Small suggestion,<br /><br />When you append your menu item, could you please use MF_OWNERDRAW instead of MF_STRING ?<br /><br />Can you please upload WinAsm Add-In to the WinAsm subforum so that we may get some feedback? If not, we can upload to the WinAsm site immediately (depends on Masmer ...) after you do the small change I requested.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-29 15:19:33 by akyprian</div>
   </div>
   <div class="post" id="post-116171">
    <div class="subject"><a href="#post-116171">A small RadASM addin</a></div>
    <div class="body"><div class="quote"><br />Thanks QvasiModo,<br /><br />Small suggestion,<br /><br />When you append your menu item, could you please use MF_OWNERDRAW instead of MF_STRING ?<br /></div><br />Sure. :) <div class="quote"><strong><br />Can you please upload WinAsm Add-In to the WinAsm subforum so that we may get some feedback? If not, we can upload to the WinAsm site immediately (depends on Masmer ...) after you do the small change I requested.<br /></div><br />No problem, I'll update it and post it there. You can also upload it to the WinAsm site.</div>
    <div class="meta">Posted on 2003-08-29 15:41:44 by QvasiModo</div>
   </div>
   <div class="post" id="post-116173">
    <div class="subject"><a href="#post-116173">A small RadASM addin</a></div>
    <div class="body">Thanks,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-08-29 15:46:56 by akyprian</div>
   </div>
   <div class="post" id="post-116497">
    <div class="subject"><a href="#post-116497">A small RadASM addin</a></div>
    <div class="body">New upload. All ready but the MF_OWNERDRAW style. Also RadAsm version now fully supports Addin Manager.<br /><br />EDIT: Added the MF_OWNERDRAW. All ready now :)</div>
    <div class="meta">Posted on 2003-09-01 14:16:15 by QvasiModo</div>
   </div>
   <div class="post" id="post-116508">
    <div class="subject"><a href="#post-116508">A small RadASM addin</a></div>
    <div class="body">Hi,<br /><br />MF_OWNERDRAW ok now.<br /><br />We have a couple of problems:<br /><br />From the Add-Ins manager load the Add-In. Press Ok.<br /><br />Use the new menuitem to show your dialog. Close the dialog. Try to use the menuitem to see the dialog again. You will not see it.<br /><br />Now go to Add-Ins Manager and unload the add-in. Go to Add-Ins menu. Select Add-Ins manager. WinAsm GPF's. To help a little here, I would suggest you preserve EBX, ESI and EDI in any of your Add-Ins procedures you use them. (Required by WinAsm)<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2003-09-01 14:57:16 by akyprian</div>
   </div>
   <div class="post" id="post-116636">
    <div class="subject"><a href="#post-116636">A small RadASM addin</a></div>
    <div class="body">Hi QvasiModo,<br /><br />I'm running W2k and I've some problem with the &quot;Error Code&quot; font of your plugin (all versions).<br /><br />See attachment...</div>
    <div class="meta">Posted on 2003-09-02 17:15:57 by Cip</div>
   </div>
   <div class="post" id="post-116828">
    <div class="subject"><a href="#post-116828">A small RadASM addin</a></div>
    <div class="body">akyprian: I'll look into this problem back home... it's strange because I usually don't forget to do something like preserving registers... (perhaps the problem is somewhere else?)<br /><br />Cip: Mhm... weird... seems like the font isn't being set correctly (although the dialog template specifies MS Sans Serif). Maybe I should set it &quot;by hand&quot;...<br /><br />I actually had made a new version that uses a rich edit control instead... but I forgot to copy it in a diskette :o so it will have to wait until tomorrow :( . Sorry!</div>
    <div class="meta">Posted on 2003-09-03 20:31:02 by QvasiModo</div>
   </div>
   <div class="post" id="post-116900">
    <div class="subject"><a href="#post-116900">A small RadASM addin</a></div>
    <div class="body">I'll wait to see the new version ;) <br /><br />Except for the font issue, I've found it really nice and usefull!<br /><br />:alright: Great job...</div>
    <div class="meta">Posted on 2003-09-04 08:04:01 by Cip</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=14784&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=14784&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="14784" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=14784&amp;page=2">&gt;</a><a href="../?id=14784&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>