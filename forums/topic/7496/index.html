<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Interrupt hooking in ring0 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7496" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7496">Interrupt hooking in ring0</a></p>
   <div class="post" id="post-54500">
    <div class="subject"><a href="#post-54500">Interrupt hooking in ring0</a></div>
    <div class="body">Hi, ppl!  I want to hook int 2e (KeSystemService() or whatever) on Windows NT.  I have read several tutorials on this and they say that u simply find where int 2e is on the IDT and put the address to your hooking code (in your Kernel Mode Driver) there.  Is it as simple as this?  Does this mean that the KMD is in the same context as the kernel and all its memory is relative to the kernel?  With my knowledge (or rather, lack of), the only way I can think of doing this is to allocate some kind of global memory (possible?), copy my code there, then patch the int 2e offset on the IDT to point there :P.  Can someone please tell me the way to go about doing this?  Thx!</div>
    <div class="meta">Posted on 2002-08-22 13:54:27 by Rama</div>
   </div>
   <div class="post" id="post-54695">
    <div class="subject"><a href="#post-54695">Interrupt hooking in ring0</a></div>
    <div class="body">I asked a similar question the other day, and later  I found some usefull information.  <a target="_blank" href="http://www.codeproject.com/system/hooksys.asp">http://www.codeproject.com/system/hooksys.asp</a><br />I hope this will help you</div>
    <div class="meta">Posted on 2002-08-23 21:22:11 by dionysus</div>
   </div>
  </div>
 </body>
</html>