<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>how to catch messages from other windows? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=964" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=964">how to catch messages from other windows?</a></p>
   <div class="post" id="post-6242">
    <div class="subject"><a href="#post-6242">how to catch messages from other windows?</a></div>
    <div class="body">Hi.<br />Another quick question:<br />I need to catch several messages from windows that do not belong to my app. i tried to do this with subclassing but didn't work. will i have to use windows hooks? or is there another possibility? a small program (Spy++) that comes with vc++ does not seem to use any windows hooks. at least my debugger did never break at SetWindowsHookEx. any suggestions?<br /><br /><br />thanks in advance.</div>
    <div class="meta">Posted on 2001-09-05 06:36:51 by darester</div>
   </div>
   <div class="post" id="post-6250">
    <div class="subject"><a href="#post-6250">how to catch messages from other windows?</a></div>
    <div class="body">This is a just an idea: I'm not sure it will works but...<br /><br />You can use the 'SetWindowLong' procedure with GWL_WNDPROC to set a new window procedure to one of yours. Your window procedure will receive every message (this is what you want) of the application you are interested in.<br />Remember to call the original Window Procedure (got with 'GetWindowLong')  passing it all the parameters you have received.<br /><br />You can use 'FindWindow' to get the handle of the window.<br /><br />Hope it's useful.<br /><br />Sincerely,<br /><br />Daniel<br /><br />P.S.<br />Good Luck ;)</div>
    <div class="meta">Posted on 2001-09-05 07:42:55 by dguzz</div>
   </div>
   <div class="post" id="post-6252">
    <div class="subject"><a href="#post-6252">how to catch messages from other windows?</a></div>
    <div class="body">dguzz: you can't do that because your code address is only valid and only exists in it's own process space..<br />darester: The only thing I can think of are hooks...<br /><br />Thomas</div>
    <div class="meta">Posted on 2001-09-05 07:57:35 by Thomas</div>
   </div>
   <div class="post" id="post-6254">
    <div class="subject"><a href="#post-6254">how to catch messages from other windows?</a></div>
    <div class="body">Ok... sorry...<br /><br />It seemed TOO SIMPLE really... and I didn't think about address space...<br /><br />Sorry again, :(<br /><br />Daniel</div>
    <div class="meta">Posted on 2001-09-05 08:36:19 by dguzz</div>
   </div>
   <div class="post" id="post-6257">
    <div class="subject"><a href="#post-6257">how to catch messages from other windows?</a></div>
    <div class="body">your hook proc must be localized in a dll since your dll will be copies in all processes with hooked windows (this cant be done with a exe).<br /><br />japheth</div>
    <div class="meta">Posted on 2001-09-05 09:11:38 by japheth</div>
   </div>
   <div class="post" id="post-6345">
    <div class="subject"><a href="#post-6345">???</a></div>
    <div class="body">so, does it have to be a hook or not? can't just the window procedure be in the dll? please try to explain more in detail.....<br /><br />thanks in advance.<br /><br />bye</div>
    <div class="meta">Posted on 2001-09-06 09:20:38 by NOP-erator</div>
   </div>
  </div>
 </body>
</html>