<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>VARARG in TASM 3.2 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25217" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25217">VARARG in TASM 3.2</a></p>
   <div class="post" id="post-184549">
    <div class="subject"><a href="#post-184549">VARARG in TASM 3.2</a></div>
    <div class="body">I am trying to use a VARARG argument for a macro in TASM 3.2 but i don&#39;t seem to be able to get it to work. I need to define a macro identical to that of MASM&#39;s INVOKE which accepts a variable number of argument but TASM always complains even when i am using the &quot;FOR&quot; keyword.<br /><br />Can anybody help me?</div>
    <div class="meta">Posted on 2006-08-18 02:23:38 by XCHG</div>
   </div>
   <div class="post" id="post-184645">
    <div class="subject"><a href="#post-184645">Re: VARARG in TASM 3.2</a></div>
    <div class="body">Okay i just figured it out. TASM seems to be having some issues with the &quot;FOR&quot; directive so we have to use the rather-obsolete version of &quot;FOR&quot; called &quot;IRP&quot;; Now i coded this macro which pushes a variable lengthed parameter onto the stack.<br /><br /><pre><span style="font-size:2>PUSHREGS MACRO Params:VARARG<br />&nbsp; IRP Param, &lt;Params&gt;<br />&nbsp; &nbsp; IFNB &lt;Param&gt;<br />&nbsp; &nbsp; &nbsp; PUSH&nbsp; Param<br />&nbsp; &nbsp; &nbsp; &nbsp; ELSE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EXITM<br />&nbsp; &nbsp; ENDIF<br />&nbsp; ENDM<br />ENDM</span></pre><br /><br />And you can use it like this:<br /><br />PUSHREGS&nbsp; &nbsp; AX, BX, CX, DX ; Or any other registers or variables</div>
    <div class="meta">Posted on 2006-08-21 02:26:43 by XCHG</div>
   </div>
  </div>
 </body>
</html>