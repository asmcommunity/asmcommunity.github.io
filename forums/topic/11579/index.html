<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Wm_keydown ?? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=11579" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=11579">Wm_keydown ??</a></p>
   <div class="post" id="post-87625">
    <div class="subject"><a href="#post-87625">Wm_keydown ??</a></div>
    <div class="body">I don't know why this code doesn't work ...<br /><br /><pre><code><br />invoke SendMessage, handle, WM_KEYDOWN, VK_SPACE,2<br /></code></pre><br /><br />while, this code works ....<br /><br /><pre><code><br />invoke SendMessage, handle, WM_CHAR, VK_SPACE,2<br /></code></pre><br /><br />handle is the handle of edit window ....<br /><br />Actually, primarily what I want to do is that send keydown message of space bar for given time... such as 5 secs or 10 secs ....<br /><br />And how can I set &quot;lParam&quot; data of &quot;WM_KEYDOWN&quot; .... can I just do just like:<br /><br /><pre><code><br />invoke SendMessage, handle, WM_KEYDOWN, wParam, somenumber?<br /></code></pre><br /><br /><pre><code><br />lKeyData<br /><br />Value of lParam. Specifies the repeat count, scan code, extended-key flag, context code, previous key-state flag, and transition-state flag, as shown in the following table&#58; <br /><br />Value	Description<br />0-15	Specifies the repeat count. The value is the number of times the keystroke is repeated as a result of the user holding down the key.<br />16-23	Specifies the scan code. The value depends on the original equipment manufacturer &#40;OEM&#41;.<br />24	Specifies whether the key is an extended key, such as the right-hand ALT and CTRL keys that appear on an enhanced 101- or 102-key keyboard. The value is 1 if it is an extended key; otherwise, it is 0.<br />25-28	Reserved; do not use.<br />29	Specifies the context code. The value is always 0 for a WM_KEYDOWN message.<br />30	Specifies the previous key state. The value is 1 if the key is down before the message is sent, or it is 0 if the key is up.<br />31	Specifies the transition state. The value is always 0 for a WM_KEYDOWN message.<br /></code></pre><br /><br />I could find these from help file, but I am not sure how to set these values or how<br /> to combine them.<br /><br />Thanks :grin:</div>
    <div class="meta">Posted on 2003-03-17 14:05:43 by Gandalf</div>
   </div>
   <div class="post" id="post-87642">
    <div class="subject"><a href="#post-87642">Wm_keydown ??</a></div>
    <div class="body">When you SendMessage, the (control) window procedure gets directly invoked.  This means that the TranslateMessage routine (which uses WM_KEYDOWN and WM_KEYUP to generate WM_CHAR messages) is not invoked. The EDIT control expects most, if not all, of its keyboard input to be WM_CHAR messages.</div>
    <div class="meta">Posted on 2003-03-17 14:35:09 by tenkey</div>
   </div>
   <div class="post" id="post-87677">
    <div class="subject"><a href="#post-87677">Wm_keydown ??</a></div>
    <div class="body">Good info. Then else we may use PostMessage while WM_KEYDOWN is it? If so which one and when we needs?</div>
    <div class="meta">Posted on 2003-03-17 18:44:04 by cakmak</div>
   </div>
  </div>
 </body>
</html>