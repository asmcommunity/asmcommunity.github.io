<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>WM_COMPAREITEM is not working ??? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12064" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12064">WM_COMPAREITEM is not working ???</a></p>
   <div class="post" id="post-92601">
    <div class="subject"><a href="#post-92601">WM_COMPAREITEM is not working ???</a></div>
    <div class="body">WM_CREATE<br />invoke CreateWindowEx,WS_EX_CLIENTEDGE,ADDR ListClassName,0,WS_VSCROLL or WS_VISIBLE or WS_BORDER or WS_CHILD or \<br />      LBS_HASSTRINGS or LBS_NOINTEGRALHEIGHT or LBS_SORT,120,50,200,310,hWnd,ListID,hInstance,NULL<br />	  mov hListBox,eax<br /><br /><br />.ELSEIF uMsg==WM_CHAR<br />		 invoke SendMessage,hListBox,LB_ADDSTRING,0,ADDR text<br />	.ELSEIF uMsg==WM_COMPAREITEM<br />	PrintDec eax<br />	.ELSE<br /><br /><br />When i press the button strink is send to ListBox  but  WM_COMPAREITEM is not working.<br /><br />could it be becouse im adding the same string ???<br /><br />btw how can i know if new item was added without LBS_SORT and WM_COMPAREITEM<br /><br />:confused:</div>
    <div class="meta">Posted on 2003-04-02 11:08:52 by AceEmbler</div>
   </div>
   <div class="post" id="post-92628">
    <div class="subject"><a href="#post-92628">WM_COMPAREITEM is not working ???</a></div>
    <div class="body">As i see in search a lot of ppl used this message before :tongue:</div>
    <div class="meta">Posted on 2003-04-02 12:43:58 by AceEmbler</div>
   </div>
   <div class="post" id="post-92632">
    <div class="subject"><a href="#post-92632">WM_COMPAREITEM is not working ???</a></div>
    <div class="body">I think that the Listbox has to have the LBS_OWNERDRAWFIXED or LBS_OWNERDRAWVARIABLE flag set to send the WM_COMPAREITEM message. You can use the LB_GETCOUNT message to check for changes in the number of items in the listbox, afaik there is no notification message for listbox changes.</div>
    <div class="meta">Posted on 2003-04-02 12:54:22 by donkey</div>
   </div>
   <div class="post" id="post-92643">
    <div class="subject"><a href="#post-92643">WM_COMPAREITEM is not working ???</a></div>
    <div class="body">When i use LBS_OWNERDRAWFIXED  i can add strings with LB_ADDSTRING. And why WM_VSCROL is not working with ListBox WS_VSCROLL ???<br />And why when i add string to ListBox whole background sets to invisible :) &quot;0&quot; and only the first one have proper bitmap background !!!!!!</div>
    <div class="meta">Posted on 2003-04-02 13:33:03 by AceEmbler</div>
   </div>
  </div>
 </body>
</html>