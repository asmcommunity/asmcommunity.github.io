<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How do you use Masm32 functions in Visual C++ programs - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2891" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2891">How do you use Masm32 functions in Visual C++ programs</a></p>
   <div class="post" id="post-18685">
    <div class="subject"><a href="#post-18685">How do you use Masm32 functions in Visual C++ programs</a></div>
    <div class="body">Hi Everyone<br /><br />Yesterday I tried out the post that Sluggy posted on using<br />Visual C++ as a debugger, Well it worked Great for making pure assembly programs, But I'd like to be able use Masm functions like <br />invoke StdOut, ADDR variable<br /> in ASM procedures for Visual C++ programs, at the moment I only know how to use<br />C functions like call printf , etc in my external asm procedures<br /><br />I think I'm getting closer to this goal with the info Sluggy posted<br />because it showed how to add Masm32 to my directory paths<br /><br /><br />Is there another command like this but different<br />ml /c /Cx /coff /Cp /Zi /Zd $(InputPath) <br /><br />that will enable certain asm files to access the Masm32 directories<br />and let the C++ files access the directories they need<br /><br />instead of this<br />error<br />unresolved external symbol _qsortnumsD<br /><br />Thanks Andy<br /><br /><br /><br />Here is what Sluggy posted<br /><br />Here you go... i have cut and pasted this from a newsgroup posting, and it works great. Once you have the project set up, you can do all the usual dragging &amp; dropping of files between the folders in the file explorer pane, add new files to it, etc. <br /><br /><br /><br />quote:<br />--------------------------------------------------------------------------------<br /> <br />Procedure for creating a new MASM project in Visual Studio 6.0: <br /><br />1. Put your MASM files (e.g., ml.exe) in any directory <br />you want. In Visual Studio, include that directory in Tools ? Options ? <br />Directories. When you assemble, Visual Studio will search for the MASM <br />files there. Also include the directories where you have your include <br />files. This process only needs to be done once; it remains a ?global? <br />setting for all MASM projects you subsequently create. <br /><br />2. Create a new project (as a Win32 application) with <br />the same name as your ASM file. It should create a blank Win32 workspace by <br />the same name. <br /><br />3. Copy your ASM and resource file(s) into the project <br />directory. Then Click ?Project? at the top of the window, then choose ?Add <br />to Project? and choose ?Files.? Add in your ASM file and your resource file <br />(.RC file). The RC file must also have the same name as the ASM file. <br /><br />4. Select (click on) the name of your ASM file or files, <br />then either right click or click ?Project? at the top of the window, and <br />choose ?Settings.? Under the ?Custom Build? tab, insert the following in <br />the box headed ?Commands.? <br /><br />ml /c /Cx /coff /Cp /Zi /Zd $(InputPath) <br /><br />Put in the $(InputPath) by clicking on the ?Files? <br />button at the bottom and choosing Input Path. Do not put in the name of <br />your ASM file; Visual Studio will do it for you. <br /><br />Then insert the following in the box headed <br />?Outputs.? <br /><br />$(InputName).obj <br /><br />Again, put in the $(InputName) by clicking on the <br />?Files? button at the bottom and choosing Input Name, and append .obj to the <br />end. Do not put in the name or your OBJ file; Visual Studio will do it for <br />you. The ASM, RC and OBJ files all have the same name by default. <br /><br />DO NOT REPEAT THIS FOR THE GLOBAL PROJECT SETTINGS. <br />DO IT ONLY FOR THE ASM FILE OR FILES, BY RIGHT-CLICKING ON THE FILE NAME(S). <br /><br />It should not be necessary to put in include library <br />paths in the Link tab as they have been globally set in the <br />tools/options/directories/executables path. <br /><br />Procedure to set up new installation of Visual Studio for MASM <br /><br />1. Close all open workspaces in Visual Studio. <br /><br />2. Click Tools . . . Options, on the top toolbar. <br /><br />3. On the Directories tab, use the drop-down window <br />labelled ?show directories for.? <br /><br />4. Select ?Executables? and add c:\MASM32\BIN. <br /><br />5. Select ?Include files? and add c:\MASM32\INCLUDE. <br /><br />6. Select ?Library files? and add: <br /><br />c:\MASM32\LIB <br /><br />c:\MASM32\M32LIB <br /><br />7. For each project, if it was copied in from another <br />PC, the Custom Build settings should already be set. If not, use the <br />instructions above to set the custom build settings for each ASM file.</div>
    <div class="meta">Posted on 2002-01-11 10:17:34 by andy981</div>
   </div>
   <div class="post" id="post-18773">
    <div class="subject"><a href="#post-18773">There is very little info on the net about this subject</a></div>
    <div class="body">There seem to be very little info on the net about mixing masm with Visual C++, has anyone out there sucessfully added an ASM procedure that had Masm32 functions in it<br />like<br /> invoke StdOut,Addr variable<br /><br />to<br />a visual C++ program<br /><br />Andy<br /><br />:stupid:</div>
    <div class="meta">Posted on 2002-01-11 22:08:57 by andy981</div>
   </div>
   <div class="post" id="post-18819">
    <div class="subject"><a href="#post-18819">How do you use Masm32 functions in Visual C++ programs</a></div>
    <div class="body">In a C or C++ program ? In a C program, declare your function with the __stdcall keyword. In a C++, use extern &quot;C&quot;. For example if you have a function Init in an asm file :<br /><br />Init PROTO<br /><br />Init PROC<br />Init ENDP<br /><br />In a .c, use :<br /><br />void __stdcall Init();<br /><br />In a C++ file use :<br /><br />extern &quot;C&quot;<br />{<br />  void __stdcall Init();<br />}</div>
    <div class="meta">Posted on 2002-01-12 09:30:43 by Dr. Manhattan</div>
   </div>
   <div class="post" id="post-18837">
    <div class="subject"><a href="#post-18837">Thanks Dr. Manhattan  For showing me how use Masm32 function</a></div>
    <div class="body">Thanks Dr. Manhattan<br />For showing me how use Masm32 functions with C and C++<br /><br />And to show others here is the info<br /><br />Use the info in my first post from Sluggy<br />Tose up everything<br />Procedure for creating a new MASM project in Visual Studio 6.0: <br /><br /><br /><br />In a .c, use : <br /><br />void __stdcall qsortnumsD(int, int); <br /><br /><br /><br />for C++ file<br /><br />extern &quot;C&quot; <br />{ <br />void __stdcall qsortnumsD(int, int); <br />} <br /><br />ASM file<br /><br />#########################################################################<br />    ; 32 bit memory model<br /><br />.386<br /><br /><br /><br />.MODEL flat,  stdcall <br /><br />       option casemap :none      ; case sensitive<br /><br />      include \masm32\include\oleaut32.inc<br />.data<br />.code<br /><br />; #########################################################################<br /><br />qsortnumsD proc Arr:DWORD,count:DWORD<br /><br />rest of code<br /><br />  ret<br /><br />qsortnumsD endp<br /><br />; #########################################################################<br /><br />end</div>
    <div class="meta">Posted on 2002-01-12 12:17:30 by andy981</div>
   </div>
   <div class="post" id="post-18866">
    <div class="subject"><a href="#post-18866">How do you use Masm32 functions in Visual C++ programs</a></div>
    <div class="body">For making something that works both on C and C++<br /><br /><pre><code><br />#ifdef _cplusplus<br />extern &quot;C&quot; &#123;<br />#endif<br /><br />void __stdcall qsortnumsD&#40;int, int&#41;;<br /><br />#ifdef _cplusplus<br />&#125;<br />#endif<br /></code></pre><br /><br />That way it will have the extern &quot;C&quot; only on C++<br /><br />even better you can do:<br /><br /><pre><code><br />;/* Assembler<br /><br />qsortnumsD proto &#58;dword, &#58;dword<br /><br />comment `<br />*/<br /><br />// C/C++<br /><br />#ifdef _cplusplus<br />extern &quot;C&quot; &#123;<br />#endif<br /><br />void __stdcall qsortnumsD&#40;int, int&#41;;<br /><br />#ifdef _cplusplus<br />&#125;<br />#endif<br /><br />//`<br /></code></pre><br /><br />and have a header that will work on asm, C and C++, notice the Grave accent (`) after the keyword <strong>comment</strong>. This will make the assembler ignore everything until it finds the (`) again.</div>
    <div class="meta">Posted on 2002-01-12 17:42:08 by dxantos</div>
   </div>
   <div class="post" id="post-18889">
    <div class="subject"><a href="#post-18889">Thanks Dxantos</a></div>
    <div class="body">comment `<br />*/<br /><br />Thanks for tip about<br /><br />#ifdef __cplusplus<br />extern &quot;C&quot; {<br />#endif<br />void __stdcall qsortnumsD(int, int); //&lt;- prototype<br />#ifdef __cplusplus<br />}<br />#endif<br /><br />Also I was'nt aware of the required word   comment`<br />to comment stuff out so you've saved me millions of semi colons in the future.<br /><br />Yes I'm sure glad I found how to use masm functions with C<br />I've been wanting to know how to do that for a while.<br />I need to do a tutorial on this. Because it's not readily found on the web<br /><br /><br /><br /><br /><br />*\<br />`</div>
    <div class="meta">Posted on 2002-01-12 22:06:13 by andy981</div>
   </div>
  </div>
 </body>
</html>