<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Deleting Items from a treeview control - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16336" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16336">Deleting Items from a treeview control</a></p>
   <div class="post" id="post-126891">
    <div class="subject"><a href="#post-126891">Deleting Items from a treeview control</a></div>
    <div class="body">I need to delete all items from a treeview control. I've tried the TVM_DELETEITEM <br />message but thats too slow. Is there a better or faster way to do this?</div>
    <div class="meta">Posted on 2003-12-07 09:16:48 by Odyssey</div>
   </div>
   <div class="post" id="post-126897">
    <div class="subject"><a href="#post-126897">Deleting Items from a treeview control</a></div>
    <div class="body">Maybe you could delete the old TreeView and create a new empty one ?</div>
    <div class="meta">Posted on 2003-12-07 10:09:09 by anon</div>
   </div>
   <div class="post" id="post-126898">
    <div class="subject"><a href="#post-126898">Deleting Items from a treeview control</a></div>
    <div class="body"><pre><code>Invoke SendMessage, hTreeview, TVM_EXPAND, TVE_COLLAPSERESET, hRoot<br /><br />or<br /><br />Invoke SendMessage, hTreeview, TVM_DELETEITEM, 0, hRoot</code></pre></div>
    <div class="meta">Posted on 2003-12-07 10:15:58 by donkey</div>
   </div>
   <div class="post" id="post-126921">
    <div class="subject"><a href="#post-126921">Deleting Items from a treeview control</a></div>
    <div class="body">Donkey, <br /><br />I tried your code but it doesn't seem to be helping could it be that I have multiple roots instead of a single one?</div>
    <div class="meta">Posted on 2003-12-07 13:36:08 by Odyssey</div>
   </div>
   <div class="post" id="post-126924">
    <div class="subject"><a href="#post-126924">Deleting Items from a treeview control</a></div>
    <div class="body">Hi  Odyssey,<br /><br />Multiple roots is perfectly possible. Just use NULL for the TVM_DELETEITEM message instead of hRoot, it will clear the Treeview even if it has multiple roots. You might also try to set hRoot to the TVI_ROOT constant instead.</div>
    <div class="meta">Posted on 2003-12-07 13:54:45 by donkey</div>
   </div>
   <div class="post" id="post-126931">
    <div class="subject"><a href="#post-126931">Deleting Items from a treeview control</a></div>
    <div class="body">It works but it doesn't seem to delete the items any faster.</div>
    <div class="meta">Posted on 2003-12-07 14:46:39 by Odyssey</div>
   </div>
   <div class="post" id="post-126933">
    <div class="subject"><a href="#post-126933">Deleting Items from a treeview control</a></div>
    <div class="body">The time it takes is the time it takes. Overlay one Treeview on top of the other and swap places when you want to erase one. Then delete the items in the background treeview in a separate thread while continuing to work in the new treeview.</div>
    <div class="meta">Posted on 2003-12-07 15:22:40 by donkey</div>
   </div>
   <div class="post" id="post-126935">
    <div class="subject"><a href="#post-126935">Deleting Items from a treeview control</a></div>
    <div class="body">I tried anon's idea and it worked :) I destroyed the control the created it again :)</div>
    <div class="meta">Posted on 2003-12-07 15:27:30 by Odyssey</div>
   </div>
  </div>
 </body>
</html>