<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>DebugBlocker : Help plz - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25767" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=22">Recruitment</a> &raquo; <a href="../?id=25767">DebugBlocker : Help plz</a></p>
   <div class="post" id="post-187974">
    <div class="subject"><a href="#post-187974">DebugBlocker : Help plz</a></div>
    <div class="body">Hi I&#39;m trying to code a DebugBlocker, an application that monitors if its being debugged. But the code starts making many instances of itself. So you help needed, thnx in advance!<br /><pre><code><br />.386<br />.model flat, stdcall<br />option casemap:none<br /><br />;---------------------------------------------------------------------------]<br />&nbsp; &nbsp; &nbsp; &nbsp; include&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\masm32\include\windows.inc<br />&nbsp; &nbsp; &nbsp; &nbsp; include&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\masm32\include\user32.inc<br />&nbsp; &nbsp; &nbsp; &nbsp; include&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\masm32\include\kernel32.inc<br />&nbsp; &nbsp; &nbsp; &nbsp; include&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\masm32\include\gdi32.inc<br />&nbsp; &nbsp; &nbsp; &nbsp; include&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\masm32\include\masm32.inc<br />&nbsp; &nbsp; &nbsp; &nbsp; includelib&nbsp; &nbsp; &nbsp; \masm32\lib\user32.lib<br />&nbsp; &nbsp; &nbsp; &nbsp; includelib&nbsp; &nbsp; &nbsp; \masm32\lib\kernel32.lib<br />&nbsp; &nbsp; &nbsp; &nbsp; includelib&nbsp; &nbsp; &nbsp; \masm32\lib\gdi32.lib<br />&nbsp; &nbsp; &nbsp; &nbsp; includelib&nbsp; &nbsp; &nbsp; \masm32\lib\masm32.lib<br />;---------------------------------------------------------------------------]<br /><br /><br />;---------------------------------------------------------------------------]<br />&nbsp; &nbsp; &nbsp; &nbsp; WndProc&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PROTO&nbsp; &nbsp;: DWORD, : DWORD, : DWORD, : DWORD<br />&nbsp; &nbsp; &nbsp; &nbsp; KeygenProc&nbsp; &nbsp; &nbsp; PROTO&nbsp; &nbsp;: DWORD<br />;--<br />&nbsp; &nbsp; &nbsp; &nbsp; DebugThread&nbsp; &nbsp; &nbsp;PROTO<br />;---------------------------------------------------------------------------]<br /><br /><br />.DATA<br />;---------------------------------------------------------------------------]<br />szWinCap&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;DebugBlocker&quot;, 0<br />szMsgCap&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;DebugBlocker&quot;, 0<br />szAbout&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;DebugBlocker&quot;, 13, 10<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;by, Prof. DrAcULA&quot;, 0<br />font&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LOGFONT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;15,6,0,0,FW_BOLD&gt;<br />szDefaultUser&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;Prof. DrAcULA&quot;, 0<br />szSerial&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;ALUcArD .forP&quot;, 0<br />szSpace&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot; &quot;, 0<br />szShit&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;&quot;&quot;&quot;, 0<br />;---------------------------------------------------------------------------]<br /><br /><br />.DATA?<br />;---------------------------------------------------------------------------]<br />hInstance&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?<br />hDlg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?<br />;--<br />pId&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?<br />hdbgThread&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?<br />threadId&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DD&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ?<br />cpid1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16 DUP(?)<br />cpid2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 16 DUP(?)<br />szTemp&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 255 DUP(?)<br />szAppLong&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 255 DUP(?)<br />szAppShort&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 266 DUP(?) <br />pif&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;PROCESS_INFORMATION&nbsp; &nbsp; &nbsp;&lt;?&gt;<br />sif&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;STARTUPINFO&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;?&gt;<br />dbgr&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DEBUG_EVENT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;?&gt;<br />;---------------------------------------------------------------------------]<br /><br /><br />.CONST<br />;---------------------------------------------------------------------------]<br />&nbsp; &nbsp; &nbsp; &nbsp; ID_DIALOG&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;EQU&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;100<br />&nbsp; &nbsp; &nbsp; &nbsp; ID_NAME&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;EQU&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;105<br />&nbsp; &nbsp; &nbsp; &nbsp; ID_SERIAL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;EQU&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;106<br />&nbsp; &nbsp; &nbsp; &nbsp; ID_AUTHOR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;EQU&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;102<br />&nbsp; &nbsp; &nbsp; &nbsp; ID_GENERATE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;EQU&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;107<br />&nbsp; &nbsp; &nbsp; &nbsp; ID_ABOUT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EQU&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;108<br />;---------------------------------------------------------------------------]<br /><br /><br />.CODE<br />;---------------------------------------------------------------------------]<br />START:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; GetModuleHandle, 0<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;hInstance, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; GetModuleFileName, hInstance, offset szAppLong, sizeof szAppLong<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; GetShortPathName, offset szAppLong, offset szAppShort, sizeof szAppShort<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; szCopy, offset szAppLong, offset szTemp<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; GetCommandLine<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; szRemove, eax, offset szTemp, offset szAppLong<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; szRemove, offset szTemp, offset szTemp, offset szSpace<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; szRemove, offset szTemp, offset szTemp, offset szShit<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; szLen, offset szTemp<br />&nbsp; &nbsp; &nbsp; &nbsp; .IF eax!=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; atol, offset szTemp<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;pId, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; CreateThread, NULL, 0, addr DebugThread, 0, 0, addr threadId<br />&nbsp; &nbsp; &nbsp; &nbsp; .ENDIF<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; GetCurrentProcessId<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;pId, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; ltoa, pId, offset cpid1<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; szCopy, offset szSpace, offset cpid2<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; szCatStr, offset cpid2, offset cpid1<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; CreateProcess, addr szAppShort, addr cpid2, NULL, NULL, FALSE, CREATE_DEFAULT_ERROR_MODE, NULL, NULL, addr sif, addr pif<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; DialogBoxParam, hInstance, ID_DIALOG, 0, offset WndProc, 0<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; ExitProcess, eax<br />;---------------------------------------------------------------------------]<br /><br /><br />;---------------------------------------------------------------------------]<br />WndProc PROC hWnd: DWORD, uMsg: DWORD, wParam: DWORD, lParam: DWORD<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;eax, uMsg<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;eax, WM_COMMAND<br />&nbsp; &nbsp; &nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp; _COMMAND<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;eax, WM_INITDIALOG<br />&nbsp; &nbsp; &nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp; _INITDIALOG<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;eax, WM_CLOSE<br />&nbsp; &nbsp; &nbsp; &nbsp; jz&nbsp; &nbsp; &nbsp; _CLOSE<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;_DEFAULT:<br />&nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;eax, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;_CLOSE:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; EndDialog, hWnd, 0<br />&nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;eax, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;_INITDIALOG:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; CreateFontIndirect,addr font<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; xchg&nbsp; &nbsp; eax,ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; SendDlgItemMessage,hWnd,ID_AUTHOR,WM_SETFONT,ebx,1<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; SendDlgItemMessage,hWnd,ID_NAME,WM_SETFONT,ebx,1<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; SendDlgItemMessage,hWnd,ID_SERIAL,WM_SETFONT,ebx,1<br />&nbsp; &nbsp; &nbsp; &nbsp; pop&nbsp; &nbsp; &nbsp;ebx<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; SetWindowText,hWnd,addr szWinCap<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; hWnd<br />&nbsp; &nbsp; &nbsp; &nbsp; pop&nbsp; &nbsp; &nbsp;hDlg<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; SetDlgItemText, hWnd, ID_NAME, offset szDefaultUser<br />&nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;eax, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;_COMMAND:<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;eax,wParam<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;edx,wParam<br />&nbsp; &nbsp; &nbsp; &nbsp; shr&nbsp; &nbsp; &nbsp;edx,16<br />&nbsp; &nbsp; &nbsp; &nbsp; .IF wParam==ID_GENERATE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp;_COMMAND_GENERATE<br />&nbsp; &nbsp; &nbsp; &nbsp; .ELSEIF wParam==ID_ABOUT<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp;_COMMAND_ABOUT<br />&nbsp; &nbsp; &nbsp; &nbsp; .ELSE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp;_DEFAULT<br />&nbsp; &nbsp; &nbsp; &nbsp; .ENDIF<br />&nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;eax, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;_COMMAND_GENERATE:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; KeygenProc, hWnd<br />&nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;eax, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;_COMMAND_ABOUT:<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; MessageBox, hWnd, offset szAbout, offset szMsgCap, MB_OK<br />&nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;eax, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />WndProc ENDP <br />;---------------------------------------------------------------------------]<br /><br /><br />;---------------------------------------------------------------------------]<br />KeygenProc&nbsp; &nbsp; &nbsp; PROC&nbsp; &nbsp; hWnd: DWORD<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; SetDlgItemText, hWnd, ID_SERIAL, offset szSerial<br />&nbsp; &nbsp; &nbsp; &nbsp; ret<br />KeygenProc&nbsp; &nbsp; &nbsp; ENDP<br />;---------------------------------------------------------------------------]<br /><br /><br />;---------------------------------------------------------------------------]<br />DebugThread&nbsp; &nbsp; &nbsp;PROC<br />&nbsp; &nbsp; &nbsp; &nbsp; LOCAL&nbsp; &nbsp;MainApp:DWORD<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; OpenProcess, PROCESS_ALL_ACCESS, FALSE, pId<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;MainApp, eax<br />&nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; DebugActiveProcess, pId<br />&nbsp; &nbsp; &nbsp; &nbsp; .IF eax!=0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; TerminateProcess, MainApp, 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; ExitProcess, 0<br />&nbsp; &nbsp; &nbsp; &nbsp;.ENDIF<br />&nbsp; &nbsp; &nbsp; &nbsp; .WHILE TRUE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; WaitForDebugEvent, addr dbgr, INFINITE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .IF dbgr.dwDebugEventCode==EXIT_PROCESS_DEBUG_EVENT<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; ExitProcess, 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .ELSE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; invoke&nbsp; ContinueDebugEvent, dbgr.dwProcessId, dbgr.dwThreadId, DBG_CONTINUE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .ENDIF<br />&nbsp; &nbsp; &nbsp; &nbsp; .ENDW<br />&nbsp; &nbsp; &nbsp; &nbsp; ret 0<br />DebugThread&nbsp; &nbsp; &nbsp;ENDP<br />;---------------------------------------------------------------------------]<br /><br />END START<br /></code></pre></div>
    <div class="meta">Posted on 2007-02-04 06:58:47 by profdracula</div>
   </div>
   <div class="post" id="post-187989">
    <div class="subject"><a href="#post-187989">Re: DebugBlocker : Help plz</a></div>
    <div class="body">A quick look at your code..<br />it obtains the pathname from which it is currently executing, and then creates a process using that name .. of COURSE it starts many instances, since each instance spawns a child process, which spawns a child process, which spawns a child process... d&#39;0h !!<br /><br />I have to warn you about using Win32 debug api to monitor processes... there&#39;s no way I know of to &#39;detach&#39; a debugged process from a debugger process without killing the debugged process.<br />The win32debug api is not the only way to monitor other processes.<br /></div>
    <div class="meta">Posted on 2007-02-04 23:16:39 by Homer</div>
   </div>
   <div class="post" id="post-187996">
    <div class="subject"><a href="#post-187996">Re: DebugBlocker : Help plz</a></div>
    <div class="body">Thnx, but I myself managed to do it successfully&nbsp; ;)<br />An app that can monitor/debug itself without making a zillion of self-instances.</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=2252" target="_blank">DebugBlocker.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2007-02-05 04:41:21 by profdracula</div>
   </div>
   <div class="post" id="post-188000">
    <div class="subject"><a href="#post-188000">Re: DebugBlocker : Help plz</a></div>
    <div class="body">and also you are not checking errors. After every call that can return error, you should check it.</div>
    <div class="meta">Posted on 2007-02-05 11:24:45 by vid</div>
   </div>
   <div class="post" id="post-188015">
    <div class="subject"><a href="#post-188015">Re: DebugBlocker : Help plz</a></div>
    <div class="body">detaching without exiting...<br /><br />api :&nbsp; DebugActiveProcessStop<br /><br />only available in xp or higher...<br /><br />takes 1 param.. the processid i think..<br /><br /><br /></div>
    <div class="meta">Posted on 2007-02-06 09:56:26 by evlncrn8</div>
   </div>
   <div class="post" id="post-188026">
    <div class="subject"><a href="#post-188026">Re: DebugBlocker : Help plz</a></div>
    <div class="body">or DebugSetProcessKillOnExit. Also WIN XP and higher.</div>
    <div class="meta">Posted on 2007-02-07 09:41:29 by ti_mo_n</div>
   </div>
  </div>
 </body>
</html>