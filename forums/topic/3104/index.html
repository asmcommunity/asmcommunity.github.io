<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>SHBrowseForFolder... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3104" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3104">SHBrowseForFolder...</a></p>
   <div class="post" id="post-20382">
    <div class="subject"><a href="#post-20382">SHBrowseForFolder...</a></div>
    <div class="body">hi.<br />i have noticed, that SHBrowseForFolder creates a thread but doesn't end it after the dialog closes. so when i let a user browse for a folder via SHBrowseForFolder, there'll be an &quot;unnessecary&quot; thread till the program terminates. is that normal, that SHBrowseForFolder does not end its thread after the dialog closes (the user presses ok or cancel), or is that another strange thing that happens only in my program?<br /><br />if it is normal, are you allowed to terminate that thread after the dialog closes, or will you have to live with it?</div>
    <div class="meta">Posted on 2002-01-22 05:58:58 by darester</div>
   </div>
   <div class="post" id="post-20394">
    <div class="subject"><a href="#post-20394">SHBrowseForFolder...</a></div>
    <div class="body">This sounds like a weird little bug... where do you see the extra<br />thread? In the general machine-wide amount of threads, or in the<br />amount of threads in your process? Also, will *each* call to SHBlah<br />create a new thread, or only the first?</div>
    <div class="meta">Posted on 2002-01-22 08:03:59 by f0dder</div>
   </div>
   <div class="post" id="post-20418">
    <div class="subject"><a href="#post-20418">SHBrowseForFolder...</a></div>
    <div class="body">SHBrowseForFolder will create a thread when it's called the first time. this thread will remain till the main program terminates. Further calls to SHBrowseForFolder won't create additional threads.<br />if you call SHBrowseForFolder 1+ times, you'll have exactly 1 additional thread till the program terminates.<br /><br />I see this additional thread in a spy program (spy++ which is shipped with vc++).</div>
    <div class="meta">Posted on 2002-01-22 10:23:00 by darester</div>
   </div>
   <div class="post" id="post-20419">
    <div class="subject"><a href="#post-20419">SHBrowseForFolder...</a></div>
    <div class="body">Okay. Sounds a bit weird, dunno why SHBlah needs the extra thread.<br />But since it's only one extra thread in total, I guess it's not too bad?</div>
    <div class="meta">Posted on 2002-01-22 10:27:03 by f0dder</div>
   </div>
   <div class="post" id="post-20420">
    <div class="subject"><a href="#post-20420">SHBrowseForFolder...</a></div>
    <div class="body">I think the same thing happens when calling the htmlhelp functions. First my program takes 1.9MB of memory, when it opens it's helpfile and closes it again, it takes 5.7MB.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-01-22 10:27:36 by Thomas</div>
   </div>
   <div class="post" id="post-20421">
    <div class="subject"><a href="#post-20421">SHBrowseForFolder...</a></div>
    <div class="body">HtmlHelp pulls in a lot of COM stuff iirc. SHBrowseForFolder might<br />do the same. But still, creation of an extra thread? I've gotten quite<br />curious as to what this thread is created for :).</div>
    <div class="meta">Posted on 2002-01-22 10:31:23 by f0dder</div>
   </div>
  </div>
 </body>
</html>