<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>data in .code section - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18370" />
  <link rel="prev" href="../?id=18370&amp;page=1" />  <link rel="next" href="../?id=18370&amp;page=3" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18370">data in .code section</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=18370&amp;page=1" style="">&laquo;</a><a href="../?id=18370&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="18370" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=18370&amp;page=3">&gt;</a><a href="../?id=18370&amp;page=3">&raquo;</a></form>   <div class="post" id="post-142379">
    <div class="subject"><a href="#post-142379">Thank You</a></div>
    <div class="body">Thankx for helping :grin: <br /><br />Will check out GoAsm :cool:</div>
    <div class="meta">Posted on 2004-05-28 23:12:35 by telophase</div>
   </div>
   <div class="post" id="post-142380">
    <div class="subject"><a href="#post-142380">.data in .code section</a></div>
    <div class="body">Hi telophase,<br /><br />Though I certainly recomend GoAsm, especially for non-English users it is not for everyone. For example there are no .IF/.ENDIF or .REPEAT .WHILE etc macros, it is for assembly language as assembly not diguised as a high level language. But if you use a non-western character set you can use your own language for labels, for example this is just fine in GoAsm...<br /><br />??:<br /><br />cmp edx,20<br />jl ??<br /><br />or<br /><br />invoke ?????????, 123<br /><br />????????? FRAME ????????<br /><br />ret<br />endf</div>
    <div class="meta">Posted on 2004-05-28 23:18:29 by donkey</div>
   </div>
   <div class="post" id="post-142382">
    <div class="subject"><a href="#post-142382">.data in .code section</a></div>
    <div class="body">i know about the proc syntax but i remember i had read somewhere in ur posts only<br />some thing like :<br /><br /><br />FindItem FRAME hlv,iStart,pLVFINDINFO<br /><br />	pop eax<br />	RET<br />ENDF<br /><br />What is this frame stuff :confused:</div>
    <div class="meta">Posted on 2004-05-28 23:39:52 by telophase</div>
   </div>
   <div class="post" id="post-142384">
    <div class="subject"><a href="#post-142384">.data in .code section</a></div>
    <div class="body">The PROC statement in MASM just sets up a stack frame, in GoAsm it is more aptly named FRAME. They are the equivalent of PROC/ENDP.<br /><br /><a target="_blank" href="http://www.jorgon.freeserve.co.uk/GoasmHelp/GoAsm.htm#frame">FRAME/ENDF</a></div>
    <div class="meta">Posted on 2004-05-28 23:45:54 by donkey</div>
   </div>
   <div class="post" id="post-142385">
    <div class="subject"><a href="#post-142385">.data in .code section</a></div>
    <div class="body">Oh!!!! Got it :grin:</div>
    <div class="meta">Posted on 2004-05-28 23:53:46 by telophase</div>
   </div>
   <div class="post" id="post-142386">
    <div class="subject"><a href="#post-142386">One more thing</a></div>
    <div class="body">What if i still wann use MASM and use delta method for referencing for eg:<br /><br />.code<br /><br />myvar  dd   0<br /><br />start:<br /><br />call delta<br /><br />delta:<br />            pop ebp<br />            sub ebp,OFFSET delta<br /><br />mov ,'$'<br /><br />end start<br /><br />Is the above gonna be possible? :notsure:</div>
    <div class="meta">Posted on 2004-05-28 23:57:11 by telophase</div>
   </div>
   <div class="post" id="post-142388">
    <div class="subject"><a href="#post-142388">.data in .code section</a></div>
    <div class="body">I still thinking.. masm can not resolve forward references....<br /><br />That is very ... very interesting :D<br /><br />I cant believe it :)<br /><br />very very ....<br /><br /><br />Have a nice day or night.</div>
    <div class="meta">Posted on 2004-05-29 00:01:45 by rea</div>
   </div>
   <div class="post" id="post-142389">
    <div class="subject"><a href="#post-142389">.data in .code section</a></div>
    <div class="body"><div class="quote">What if i still wann use MASM and use delta method for referencing for eg:<br /><br />.code<br /><br />myvar dd 0<br /><br />start:<br /><br />call delta<br /><br />delta:<br />pop ebp<br />sub ebp,OFFSET delta<br /><br />mov ,'$'<br /><br />end start<br /><br />Is the above gonna be possible?</div><br /><br />Shouldn't take longer than 50 milliseconds to compile, why not just try it ?</div>
    <div class="meta">Posted on 2004-05-29 00:03:10 by donkey</div>
   </div>
   <div class="post" id="post-142390">
    <div class="subject"><a href="#post-142390">.data in .code section</a></div>
    <div class="body"><div class="quote"><br />I still thinking.. masm can not resolve forward references....<br /><br />That is very ... very interesting :D<br /><br />I cant believe it :)<br /><br />very very ....<br /><br /><br />Have a nice day or night. </div><br /><br />MASM can resolve forward references, the problem is that the INVOKE pseudo macro in MASM is crap and chokes on all forward references. It also uses LEA to calculate the address of local variables, another thing GoAsm doesn't do.</div>
    <div class="meta">Posted on 2004-05-29 00:04:54 by donkey</div>
   </div>
   <div class="post" id="post-142391">
    <div class="subject"><a href="#post-142391">.data in .code section</a></div>
    <div class="body">aaa, then I understand a little best , thx<br /><br /><br />Have a nice day or night.</div>
    <div class="meta">Posted on 2004-05-29 00:06:12 by rea</div>
   </div>
   <div class="post" id="post-142392">
    <div class="subject"><a href="#post-142392">.data in .code section</a></div>
    <div class="body">Yesss!!!! <br /><br />Thankyou People!!<br /><br />I worked out smooth :grin:</div>
    <div class="meta">Posted on 2004-05-29 00:09:05 by telophase</div>
   </div>
   <div class="post" id="post-142394">
    <div class="subject"><a href="#post-142394">.data in .code section</a></div>
    <div class="body">I will have to make the text section writable before i proceed right?<br /><br />Or the program will crash !:sweat:</div>
    <div class="meta">Posted on 2004-05-29 00:10:45 by telophase</div>
   </div>
   <div class="post" id="post-142398">
    <div class="subject"><a href="#post-142398">.data in .code section</a></div>
    <div class="body">Hi telophase<br /><br /><br />Here is the assembled version by donkey (attached).<br /><br /><br />Regards,</div>
    <div class="meta">Posted on 2004-05-29 02:23:36 by The SharK</div>
   </div>
   <div class="post" id="post-142448">
    <div class="subject"><a href="#post-142448">.data in .code section</a></div>
    <div class="body">Hey I tried to put data in a code section but whenever I wrote to it , I got an exception! My guess is that you may have to keep constants only.</div>
    <div class="meta">Posted on 2004-05-29 14:50:02 by x86asm</div>
   </div>
   <div class="post" id="post-142449">
    <div class="subject"><a href="#post-142449">.data in .code section</a></div>
    <div class="body">Use the linker switch /SECTION ... /SECTION:.text,rwe (read+write+executable)</div>
    <div class="meta">Posted on 2004-05-29 14:57:27 by f0dder</div>
   </div>
   <div class="post" id="post-142465">
    <div class="subject"><a href="#post-142465">.data in .code section</a></div>
    <div class="body"><div class="quote"><br />Use the linker switch /SECTION ... /SECTION:.text,rwe (read+write+executable) </div><br />ohh, thanks f0dder! now I can :D</div>
    <div class="meta">Posted on 2004-05-29 19:54:53 by x86asm</div>
   </div>
   <div class="post" id="post-142466">
    <div class="subject"><a href="#post-142466">.data in .code section</a></div>
    <div class="body">Here is a little trick I use if I'm inserting text to be displayed on the fly. Rather simple, just make sure the label is not on the same line as the BYTE definition.<br /><br /><pre><code><br />.386<br />.model flat,stdcall<br />option casemap&#58;none<br /><br />include windows.inc<br />include user32.inc<br />include kernel32.inc<br />includelib user32.lib<br />includelib kernel32.lib<br /><br />.code<br />start&#58;      push MB_OK<br />            push _title<br />            push _message<br />            push 0<br />            call MessageBox<br />            jmp @f<br />_title&#58;<br />            BYTE &quot;It Worked!&quot;,0<br />_message&#58;<br />            BYTE &quot;~!w00t!~ I LOVE ASSEMBLY PROGRAMMING ~!w00t!~&quot;,0<br />@@&#58;         push 0<br />            call ExitProcess<br />end start<br /></code></pre><br />By doing that I don't have to deal with OFFSET or ADDR, but personally I rather keep data out of the code section, I just use this if I'm doing &quot;Printf Debugging&quot; and I'm going to strip it out later anyways.</div>
    <div class="meta">Posted on 2004-05-29 20:14:02 by Synfire</div>
   </div>
   <div class="post" id="post-142470">
    <div class="subject"><a href="#post-142470">.data in .code section</a></div>
    <div class="body">synfire, try &quot;iamteh0wnz0r label byte db 090h,042h&quot;</div>
    <div class="meta">Posted on 2004-05-29 22:28:53 by f0dder</div>
   </div>
   <div class="post" id="post-151334">
    <div class="subject"><a href="#post-151334">.data in .code section</a></div>
    <div class="body"><div class="quote"><br />MASM can resolve forward references, the problem is that the INVOKE pseudo macro in MASM is crap and chokes on all forward references. It also uses LEA to calculate the address of local variables, another thing GoAsm doesn't do.</div><br /><br />The forwarded reference problem can be solved with a simulation of invoke macro:<br /><pre><code><br />.386<br />.model flat, stdcall<br />option casemap&#58;none<br />include \masm32\include\windows.inc<br />include \masm32\include\kernel32.inc<br />include \masm32\include\user32.inc<br />includelib \masm32\lib\user32.lib<br />includelib \masm32\lib\kernel32.lib<br /><br />include invoke.inc<br /><br />.code<br />start&#58;<br />	_invoke	MessageBox, NULL,addr MsgBoxText, addr MsgCaption, MB_OK<br />	_invoke	ExitProcess,NULL<br /><br />MsgCaption	db &quot;Iczelion's tutorial no.2&quot;,0<br />MsgBoxText	db &quot;Win32 Assembly is Great!&quot;,0<br /><br />END start<br /></code></pre></div>
    <div class="meta">Posted on 2004-10-16 06:37:48 by Vortex</div>
   </div>
   <div class="post" id="post-151353">
    <div class="subject"><a href="#post-151353">.data in .code section</a></div>
    <div class="body">In my Testbug demonstration program, available from <a target="_blank" href="http://www.GoDevTool.com">www.GoDevTool.com</a> I experiment with how placing data in the code section affects <em>speed of execution</em>.  <br /><br />Here is an excerpt from Testbug's help file about this:-<br /><br />Data in the code section <br />I was in a rebellious mood, but got my knuckles wrapped over this one (until the AMD64 came along!). Since we have been using Win32, assembler programmers feel much more relaxed about regarding the whole virtual memory area as available for our program's data and code. However, programs are still divided into data and code - but why should they be? We dutifully declare a data section and put all data in there, and then we declare a code section and put all the code in there. Writers and teachers tell us it is &quot;bad programming practice&quot; to do otherwise. But how do they know? We know that when we look at an executable file with a file viewer or with a debugger, the only difference between the sections appears to be the names. Why are we being such good boys and girls? Why not abolish the difference and just put everything in the code section? This test shows why, on processors below the P4 at least. On those processors access to data in the code section is much slower than access to data in the data section. Why? The answer must be that the processor and its cache are optimised to execute reading and writing instructions from the data section rather than the code section. Of course the processor knows which is which from the information fed to its descriptor registers and the segment registers by the operating system. Note the Windows operating system will not permit a &quot;write&quot; to the code section anyway, without a call to the API VirtualProtect to change the section's attributes. This is so even if the code section is marked &quot;writeable&quot; in the executable. On the P4, it seems it makes no difference to speed whether data is held in the data section or in the code section. Now that could transform the way assembler programmers write their code! <br />This test searches a table and returns when the correct value in the table has been found. The only difference between the &quot;code&quot; and the &quot;data&quot; tests is that in the code tests the table is declared in the code section and in the data tests the table is declared in its rightful place, the data section. The test is carried out 5000 times and the time taken for completion is tested using the api QueryPerformanceCounter. The table has 60 entries. The &quot;early&quot; find stops at the 5th entry, the &quot;middle&quot; find stops at the 30th entry and the &quot;late&quot; find stops at the 56th entry. <br />I don't give the code here because it is basically the same as the sample code I wrote for a standardised callback procedure in Windows. This code gets rid of all those long chains and conditional jumps in a window procedure. Instead it uses a table of procedures and message values. When the correct message value in the table is found the correct procedure is called to carry out the required action. <br /><br />Note on AMD64<br />The AMD64 makes use of RIP-Relative addressing. RIP is the new 64-bit instruction pointer (it replaces EIP). The AMD64 processor can read data at an address relative to the RIP at any one time using an 32-bit offset value. Up to now relative addressing was only used for jumps to a new instruction place. For this to work, it probably makes no difference to the processor whether the data is in executable or non-executable areas and the processor may in fact be blind to this. Using RIP-relative addressing can shorten code considerably (no need for large displacement values to be included in the instruction) so development tools should endeavour to use it as much as possible.</div>
    <div class="meta">Posted on 2004-10-17 02:57:16 by jorgon</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=18370&amp;page=1" style="">&laquo;</a><a href="../?id=18370&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="18370" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=18370&amp;page=3">&gt;</a><a href="../?id=18370&amp;page=3">&raquo;</a></form>  </div>
 </body>
</html>