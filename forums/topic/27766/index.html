<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>stay in memory - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27766" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27766">stay in memory</a></p>
   <div class="post" id="post-197921">
    <div class="subject"><a href="#post-197921">stay in memory</a></div>
    <div class="body">I have a console app that when started check for internet  connection availability and than download someting from the web and close it self. But I need to implement two new features to it and  don't know how. It should stay in memory even if conn is not available and check for it periodicaly and than download the file.
And the socond one is to implement download resume function.
I would send my 3 KB app to anyone who is able to append these features to it and send it  back to me. with a bit of comment. 

Thank you very much.

i am absolute beginner in MASM.
Thank you.
Radim.</div>
    <div class="meta">Posted on 2001-04-23 15:19:00 by raguru</div>
   </div>
   <div class="post" id="post-197922">
    <div class="subject"><a href="#post-197922">stay in memory</a></div>
    <div class="body">raguru,

  If you want your program to "stay in memory", you could write to the registry or modify the WIN.INI file.  These techniques will just make your program run when Windows starts.  If you want it to check for an internet connection just call your function and if it returns "bad", then invoke Sleep for a while and just loop it 'til it returns "good".  About the resume broken downloads........I have no clue ;-)

Good luck,
*unknown*</div>
    <div class="meta">Posted on 2001-04-23 16:13:00 by *unknown*</div>
   </div>
   <div class="post" id="post-197923">
    <div class="subject"><a href="#post-197923">stay in memory</a></div>
    <div class="body">if you call the API, and wait for error if not connected, win32 will only return the error after showing a connect dialog...

better use InternetGetConnectionState(), from wininet.dll

there, in wininet, you will find other APIs that maybe can help you with the resume thingie</div>
    <div class="meta">Posted on 2001-04-23 21:25:00 by Kala-Marai</div>
   </div>
   <div class="post" id="post-197924">
    <div class="subject"><a href="#post-197924">stay in memory</a></div>
    <div class="body">I haven't reviewed this source, but it's description seemed to be what you were looking for.  I think it's just a way to go Ring0, but I'm not sure.  You can download it here.

*unknown*</div>
    <div class="meta">Posted on 2001-04-24 11:03:00 by *unknown*</div>
   </div>
  </div>
 </body>
</html>