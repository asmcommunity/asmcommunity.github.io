<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>infant Hybrid Engine gasps for life - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17351" />
  <link rel="prev" href="../?id=17351&amp;page=1" />  <link rel="next" href="../?id=17351&amp;page=3" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=17351">infant Hybrid Engine gasps for life</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=17351&amp;page=1" style="">&laquo;</a><a href="../?id=17351&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="17351" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=17351&amp;page=3">&gt;</a><a href="../?id=17351&amp;page=3">&raquo;</a></form>   <div class="post" id="post-134893">
    <div class="subject"><a href="#post-134893">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Later today I'm going to begin implementing the 'Opposing Face Geometry' algorithm for collision detection, which is geared towards tests between dynamic convex objects.<br />OFG is outlined @ <a target="_blank" href="http://gamedev.net/columns/hardcore/ofg/">http://gamedev.net/columns/hardcore/ofg/</a><br /><br />This will almost certainly form a class just below CCullableThing, called something like CRigidBody, for it will comprise around 50% of the code involved in implementing simulation of rigid body dynamics.<br /><br />For the those too lazy to read the article, this is nothing more than a set of optimisations applied to the &quot;brute force&quot; method of geometric intersection testing - instead of simply testing for collisions between all faces of objects A and B, we apply an initial boundingsphere check, and then we attempt to find the faces of A which are closest to the center of B, and vice versa... if the boundingspheres intersect, theres a POSSIBLE intersection of geometry, and the faces of each object closest to the other object are obviously the ones we should concentrate on :)</div>
    <div class="meta">Posted on 2004-02-26 19:58:13 by Homer</div>
   </div>
   <div class="post" id="post-135183">
    <div class="subject"><a href="#post-135183">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Heya all :) More work was done on this fledgling :)<br />Objects which are part of a group selection are now rendered in wireframe.<br />A new class called CTerrainPatch was implemented.<br />A TerrainPatch is a textured flat surface which is a lot like a chessboard, and which can be HeightMapped.<br />We create an array of 16x16 of these.<br />Since rendering all of these dropped my framerate from a nominal 160 (yeah, need to work on that too) down to 47 fps, some light culling code was implemented, based on the distance from the center of each Patch of terrain to the camera position. This resulted in a framerate of around 120 fps. Optimizing the terrain cull code a little and adding an early-out check for objects whose Z coordinate relative to the camera is negative (is behind the camera) brought the fps back up to around 136. Not too shabby :)<br />Rather than get the object dynamics code up and running, I have decided to implement some surfaces to hit against first :)<br />I'm tempted to add client/server code already so that I can implement an online editor such that N developers can work on a level together :) I am forcing myself to be patient lol.</div>
    <div class="meta">Posted on 2004-03-03 03:14:23 by Homer</div>
   </div>
   <div class="post" id="post-135255">
    <div class="subject"><a href="#post-135255">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Ok kids, public beta posting is @ <a target="_blank" href="http://homer.ultrano.com">http://homer.ultrano.com</a> - the source is not posted but the exe and resources are - I hear theres an issue in the zip I uploaded, ignore the paths in it, make a folder called Maps where ur exe lives and put the HeightMap jpg in it :)</div>
    <div class="meta">Posted on 2004-03-05 11:28:37 by Homer</div>
   </div>
   <div class="post" id="post-135271">
    <div class="subject"><a href="#post-135271">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Here's a screenshot which shows the Terrain HeightMap engine in action.<br />As you can see, the texture applied to the terrain is algorithmically generated by blending several textures based on the height of the terrain. It works, and it looks great as far as I am concerned - a more careful choice of blend textures would yield a more pleasing effect. This is still by no means complete or perfect.<br />At the moment it takes about 20 seconds to zoom from one end of the world to the other, which means I really should make the world larger - but I'm already generating 256 textures just for the terrain, and there's going to be resource issues if I push much harder :)</div>
    <div class="meta">Posted on 2004-03-05 22:00:10 by Homer</div>
   </div>
   <div class="post" id="post-135338">
    <div class="subject"><a href="#post-135338">infant Hybrid Engine gasps for life</a></div>
    <div class="body">The TerrainEngine has been improved, and the &quot;line artifact&quot; at the edges of neighbouring terrain patches has been eliminated.<br />Also, the code for creating terrainpatches has been implemented in its own thread. This causes some minor memory issues when creating the vb's which doesnt otherwise occur, I'll look into it.</div>
    <div class="meta">Posted on 2004-03-08 01:30:24 by Homer</div>
   </div>
   <div class="post" id="post-135418">
    <div class="subject"><a href="#post-135418">E_OUTOFMEMORY during CreateVertexBuffer</a></div>
    <div class="body">The problem with creation of VB's has been eliminated, but it wasn't pretty.The way I repaired it was pretty pathetic, but nonetheless it did the job.Let me outline what the problem was and how I fixed it, since I'm sure others will encounter this problem. I had moved my code to create N instances of CTerrainPatch into its own thread, so that the application would not &quot;freeze&quot; due to the heavy-duty work of calculating the terrainpatch textures, and so I could start rendering as soon as the application started up, even though loading was still completing.<br />The Object Constructor method of the CTerrainPatch Class contains a call to create a vertexbuffer for that terrainpatch. It was sometimes failing, with the error E_OUTOFMEMORY. I knew I had plenty of memory, so I simply added code to jump backwards and try infinitely until we succeeded - the &quot;just keep a'knockin&quot; approach. The error was resolved completely :)<br /><br />NOTE: Something else I changed in the CTexture class, in particular the CTexture_BeginDrawing function, remove the call to RtlZeroMemory.</div>
    <div class="meta">Posted on 2004-03-08 22:34:47 by Homer</div>
   </div>
   <div class="post" id="post-135449">
    <div class="subject"><a href="#post-135449">infant Hybrid Engine gasps for life</a></div>
    <div class="body">I think most of my problems have been resolved, I'd really appreciate some beta testing here - please, what nasty messageboxen, if any, do you see? :)<br />Try the latest Beta.zip at <a target="_blank" href="http://homer.ultrano.com">http://homer.ultrano.com</a><br />If your zip appears to be empy, try using the Save As option. (you know, right click menu)</div>
    <div class="meta">Posted on 2004-03-09 07:27:50 by Homer</div>
   </div>
   <div class="post" id="post-135451">
    <div class="subject"><a href="#post-135451">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Hi Homer,<br /><br />I got the error <br /><br />---------------------------<br />Error - INVALIDDATA<br />---------------------------<br />Failed to load texture C:/masm32/NewD3D/Textures/RockTest.jpg<br />---------------------------<br />OK   <br />---------------------------<br /><br />Personally I do not think it is good to hardcode the paths to the images..<br /><br />After moving it to C:/masm32/NewD3D, it works alright but kind of too cpu intensive.</div>
    <div class="meta">Posted on 2004-03-09 07:38:58 by roticv</div>
   </div>
   <div class="post" id="post-135455">
    <div class="subject"><a href="#post-135455">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Thats interesting, there shouldnt be any hardcoded paths - I'll sort it out :) Thanks :)</div>
    <div class="meta">Posted on 2004-03-09 08:07:38 by Homer</div>
   </div>
   <div class="post" id="post-135458">
    <div class="subject"><a href="#post-135458">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Try again a little later, I believe you have received the old copy of this, you can confirm this easily: if theres only one object in the Objects folder and its name is NewCube, you have the new one.<br />If so, NewCube is a text file, check the paths of its two textures are not fully qualified like that - only the very old version of this demo had hardcoded paths :(<br />The correct file is called Beta.zip, and is 775457 bytes in size.<br />The application contains filepaths, but they are relative to the location of the exe.<br />It requires folders called Textures, Maps and Objects, and all paths are included in the zip to make life easy if u want.</div>
    <div class="meta">Posted on 2004-03-09 08:28:48 by Homer</div>
   </div>
   <div class="post" id="post-135460">
    <div class="subject"><a href="#post-135460">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Hi Homer,<br /><br />I downloaded beta.zip and got the following error when I ran it (Files extracted properly).<br /><br />---------------------------<br />ERROR<br />---------------------------<br />Failed to create  texture<br />---------------------------<br />OK   <br />---------------------------<br /><br />Then <br /><br />---------------------------<br />ERROR<br />---------------------------<br />CTexture_BeginDrawing for  : Invalid pTexture (it was NULL!)<br />---------------------------<br />OK   <br />---------------------------<br /><br />---------------------------<br />ERROR<br />---------------------------<br />CTexture_PutPixel : Cannot draw pixel before calling BeginDrawing<br />---------------------------<br />OK   <br />---------------------------</div>
    <div class="meta">Posted on 2004-03-09 08:50:51 by roticv</div>
   </div>
   <div class="post" id="post-135485">
    <div class="subject"><a href="#post-135485">infant Hybrid Engine gasps for life</a></div>
    <div class="body">You have to combine the package with the the old versions package - extract it over the old folder. I just wonder if you had the old code :notsure:</div>
    <div class="meta">Posted on 2004-03-09 11:37:40 by Ultrano</div>
   </div>
   <div class="post" id="post-135523">
    <div class="subject"><a href="#post-135523">infant Hybrid Engine gasps for life</a></div>
    <div class="body">No, sounds like he has the right version now, judging by the error messages (I've recently added extra error checking to CTexture)  - the Failed To Create Texture (without giving a texture name) is interesting... only the terrain textures are ever &quot;created&quot;.. this sounds like another resource allocation failure to me, is the error intermittent or happens every time?<br /><br />The errors which follow are caused by that failure to create a texture.<br /><br />I can't make that error occur on my system, so this is great feedback , thanks, I'll try to harden the texture creation function..</div>
    <div class="meta">Posted on 2004-03-09 21:57:34 by Homer</div>
   </div>
   <div class="post" id="post-135524">
    <div class="subject"><a href="#post-135524">infant Hybrid Engine gasps for life</a></div>
    <div class="body">An update was published, @ 775540 bytes...<br />the Texture Creation function was harded a little, let me know how that works out.<br />More importantly, code was added to detect which patch of terrain the player is standing over.<br />At the moment, I implemented it inside CTerrainPatch_Cull.<br />If we decide that a patch of terrain is close enough to the player to not be culled, we also test if the player stands above it.<br />The result is reported in text on the screen (=address of CTerrainPatch Instance we standing over)<br />I realized later that I can implement this much more cheaply by calculating the exact patch we are standing over in Demo_Render rather than seeking it among unculled CTerrainPatch instances during culling.Nonetheless, it's the first step towards object/terrain hit detection. It also leads me to think about making a terrainpatch the &quot;owner&quot; of a list of objects whose origins are within its XZ boundaries. This way, a terrainpatch would only have to test for intersections with &quot;the objects it owns&quot;, which in turn means that by culling a terrainpatch we also cull its contents.</div>
    <div class="meta">Posted on 2004-03-09 22:14:31 by Homer</div>
   </div>
   <div class="post" id="post-135525">
    <div class="subject"><a href="#post-135525">infant Hybrid Engine gasps for life</a></div>
    <div class="body">As I said earlier, the zip contains relative paths already - rather than just extracting all the files to a folder, let Zip create a folder of your choosing and unzip them all for you, it will create the folders/paths needed and save you messing around.<br />The actual extraction path should be irrelevant - extracting to a folder on desktop should be fine. That just means you can &quot;install&quot; this anywhere you like.</div>
    <div class="meta">Posted on 2004-03-09 22:18:11 by Homer</div>
   </div>
   <div class="post" id="post-135559">
    <div class="subject"><a href="#post-135559">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Hi Homer,<br /><br />It works alright now. The only complain I have is that your program takes 36000+ (which I presume to be in milliseconds...) to load the textures.</div>
    <div class="meta">Posted on 2004-03-10 06:59:31 by roticv</div>
   </div>
   <div class="post" id="post-135609">
    <div class="subject"><a href="#post-135609">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Yes well, be aware of the workload : we create 256 textures (for the 16x16 terrainpatches), each texture is 256x256 pixels, and is generated by reading from two of four textures based on Height, which is yet ANOTHER pixel read (Terrain HeightMap is a 512x512 jpeg, same as the terrain source textures).<br />Therefore, we are calculating 256x256x256 pixels based on the pixel colours from three OTHER textures, splitting each pixel into its rgb components, blending them, and recombining them... the workload is horrendous - but thanks to current implementation, we are still free to do other things - at the moment, I simply render a variation on the scene, without the terrain, until its &quot;loaded&quot;... theres no reason we couldn't be for example displaying a logo while the terrain &quot;loading&quot; completes :)<br />Yes, those are milliseconds :) This application currently has no throttle on its framerate, I am keeping an eye on the fps as I add / modify code. At the moment, theres a couple of major optimisations to be made to the object rendering code, namely that at the moment I render all materials per object, for all objects... I should be rendering all objects by material, for all materials of a reference object.<br />This would also eliminate the need for object instances to keep any materials or textures :)<br />By the way, as a benchmark, my 2100 Mhz AMD based machine performs the texture generation in 6500 , aka  6.5 seconds... quite bearable - 36 seconds would be painful to me - what framerate do you achieve? I get 80 to 120 fps on my geforce 4, usually floating around the 100 mark.</div>
    <div class="meta">Posted on 2004-03-10 23:48:09 by Homer</div>
   </div>
   <div class="post" id="post-135628">
    <div class="subject"><a href="#post-135628">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Hey Homer<br /><br />I downloaded the latest beta zip but it crashes the computer when I run it.<br /><br />It starts up and displays the texture creation progress in a window, it finishes that after approx 24500+ms, then I'm assuming it tries to switch to full screen mode at which time the computer reboots and windows informs me that 'The system has recovered from a serious error'.<br /><br />NO dialog boxes are displayed!!!<br /><br />I'm using XPPro SP1, DX9.0b, GeForce4 Ti4200, Detonator 45.23, 512MB memory, and an Intel P4 2400MHz 800MHz FSB.<br /><br />It's interesting that your AMD calculates the textures in 6500ms, my P4 should be at least that fast :confused:</div>
    <div class="meta">Posted on 2004-03-11 05:46:55 by Maelstrom</div>
   </div>
   <div class="post" id="post-135630">
    <div class="subject"><a href="#post-135630">infant Hybrid Engine gasps for life</a></div>
    <div class="body">All very interesting, since I don't use any &quot;high-end&quot; dx api calls that require special hardware functionality at all - for example, the terrain textureblending is 100% software. Do you see two crates during texture processing, sitting on a flat panel with a nuclear symbol texture on the floor?<br />I run XP sp3 here... no issues at all. I'm curious what could be failing so hard as to not even return with an errorcode :( No fullscreen, this is currently a Windows app, should work fine at any resolution including fullscreen, but fullscreen currently isnt implemented so that aint it :(<br /><br />Could the problem be the &quot;infinite loop&quot; hotfix I made? IE, have you got a decent amount of system ram? (not video ram)</div>
    <div class="meta">Posted on 2004-03-11 06:06:40 by Homer</div>
   </div>
   <div class="post" id="post-135658">
    <div class="subject"><a href="#post-135658">infant Hybrid Engine gasps for life</a></div>
    <div class="body">Hey Homer<br /><br />Ignore the above prob, I didn't realize you also needed the original download as well.<br />The proggy should have complained about missing resources tho.</div>
    <div class="meta">Posted on 2004-03-11 15:29:02 by Maelstrom</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=17351&amp;page=1" style="">&laquo;</a><a href="../?id=17351&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="17351" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=17351&amp;page=3">&gt;</a><a href="../?id=17351&amp;page=3">&raquo;</a></form>  </div>
 </body>
</html>