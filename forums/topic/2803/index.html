<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Scan String - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2803" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2803">Scan String</a></p>
   <div class="post" id="post-18004">
    <div class="subject"><a href="#post-18004">Scan String</a></div>
    <div class="body">Im looking for a simple Way to look what Files on my System are able to connect to the Internet ,so i want to Scan all Files for &quot;WM_SOCKET&quot; !<br /><br />If i open Exefiles with Notepad i see the content but if i open Exefiles with my Program i see only MZ as Text.<br />When i open a Textfiles i see all Text in my Program so there is no Bug while reading the Buffer.<br /><br />Do i have to program a Hex Reader before i can scan for a String or are im missing something ?</div>
    <div class="meta">Posted on 2002-01-07 08:32:07 by Cervesia</div>
   </div>
   <div class="post" id="post-18005">
    <div class="subject"><a href="#post-18005">Scan String</a></div>
    <div class="body">Hi !<br />WM_SOCKET (and the others WM_ as well) is an integer value and not coded as a string in the compiled exe.<br /><br />To know if a program is able to connect to the Internet, I think it is more simple, precise and fast to analyse his import table to look for specifical internet related API (winsock's ones, in exemple).<br /><br />Some tuts about the PE (Windows executable format) are available at Iczelion's.<br /><br />Regards,</div>
    <div class="meta">Posted on 2002-01-07 08:38:14 by JCP</div>
   </div>
   <div class="post" id="post-18008">
    <div class="subject"><a href="#post-18008">Scan String</a></div>
    <div class="body">hm yeah, like readiosys said, it would be better to scan<br />the import table for winsock/capi/... but this requires your<br />knowledge of the pe-header... i assume you do not have<br />a clue what the pe-hdr is so you could just open the <br />executable of your desire and do a plain text search for<br />all the i-net libs available (wsock32/capi32/...) coz the<br />import-table is'nt encrypted in any form... but beware...<br />this would be 100% lame :)<br /><br />btw most api's require strings in ASCIIZ form, the &quot;Z&quot;<br />is for ZERO -&gt; NULLTERMINATED strings... so the pe-hdr<br />begins with MZ followed by unprintable chars and finially<br />by zero (somewhere) thats why notepad is dumb and<br />you only see &quot;MZ&quot; :)</div>
    <div class="meta">Posted on 2002-01-07 08:54:19 by mob</div>
   </div>
   <div class="post" id="post-18009">
    <div class="subject"><a href="#post-18009">Scan String</a></div>
    <div class="body">I also forgot to say that some programs load functions using LoadLibrary + GetProcAddress...<br /><br />They can do that at ANY moment...<br />Look at <a target="_blank" href="www.dependencywalker.com">www.dependencywalker.com</a> for concrete examples about that was said here. ;)<br /><br />Regards,</div>
    <div class="meta">Posted on 2002-01-07 09:07:11 by JCP</div>
   </div>
   <div class="post" id="post-18013">
    <div class="subject"><a href="#post-18013">Scan String</a></div>
    <div class="body">yup but loadlib and getprocadr need plain-text strings<br />anyhow so this doesn't matter if you use booyer-moore<br />or whatever... we're speaking about &quot;normal&quot; programms<br />are we? so no invidious encrypting and stuff :)</div>
    <div class="meta">Posted on 2002-01-07 09:25:47 by mob</div>
   </div>
  </div>
 </body>
</html>