<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>FPU Emulator in ntdll.dll - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14956" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14956">FPU Emulator in ntdll.dll</a></p>
   <div class="post" id="post-116055">
    <div class="subject"><a href="#post-116055">FPU Emulator in ntdll.dll</a></div>
    <div class="body">Greetings,<br /><br />I was poking around the ntdll.dll with Dependancy Walker 2.1 and noticed a serious of API's (or exported functions) that directly match each of the FPU assembly instructions and was wondering why is it there, does Windows use it internally instead of the direct ASM instruction?  Or for compatibility on older hardware (perhaps when NT was new)?<br /><br />In the MASM Programmers Guide there is a section on the FPU and it made slight illusion to a command for MASM that compiles with FP emulation.  Would that cause it to link to these emulated instructions or does MS have another FPU emulator included with MASM?<br /><br /><br />Thanks,<br />_Shawn</div>
    <div class="meta">Posted on 2003-08-29 00:37:28 by _Shawn</div>
   </div>
   <div class="post" id="post-116058">
    <div class="subject"><a href="#post-116058">FPU Emulator in ntdll.dll</a></div>
    <div class="body">Could have been added for the FPU with the flaw. I remember that in early Pentiums there was a serious flaw in the FPU and I think you could just check a box that would emulate it.</div>
    <div class="meta">Posted on 2003-08-29 01:06:08 by donkey</div>
   </div>
   <div class="post" id="post-116072">
    <div class="subject"><a href="#post-116072">FPU Emulator in ntdll.dll</a></div>
    <div class="body">ahh yes it had something to do with deviding 0 with 0 would lock up and reboot the system lol... im sure there were others also..</div>
    <div class="meta">Posted on 2003-08-29 03:17:14 by devilsclaw</div>
   </div>
   <div class="post" id="post-116079">
    <div class="subject"><a href="#post-116079">FPU Emulator in ntdll.dll</a></div>
    <div class="body">Wasn't it a precision bug -- the result was incorrect. The F00F bug howerver lock the CPU (due to two locks -- locks the CPU in it's attempt to recover from the first error (the f00f-bug is two errors in one)).<br />haven't hear of the 0/0 bug though.</div>
    <div class="meta">Posted on 2003-08-29 04:29:30 by scientica</div>
   </div>
  </div>
 </body>
</html>