<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>RC6 encryption - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21136" />
    <link rel="next" href="../?id=21136&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=21136">RC6 encryption</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=21136&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=21136&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="21136" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=21136&amp;page=2">&gt;</a><a href="../?id=21136&amp;page=2">&raquo;</a></form>   <div class="post" id="post-160057">
    <div class="subject"><a href="#post-160057">RC6 encryption</a></div>
    <div class="body">Since somebody asked me via PM for my implementation of the RC6 algorithm, I figured I might as well post it here...<br />The attached archive includes the source code (TASM ideal mode, should be easy to convert to MASM syntax) as well as a minimalistic example program illustrating its usage.<br />I&#39;m getting a throughput of around 57MB/sec on my machine, so this code should be fast enough for most applications ;)</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=626" target="_blank">rc6.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-05-13 11:34:45 by Tola</div>
   </div>
   <div class="post" id="post-160059">
    <div class="subject"><a href="#post-160059">Re: RC6 encryption</a></div>
    <div class="body">RC6 is a nice algorithm, since it&#39;s relatively fast and small (lack of s-boxes).<br /><br />How are the current patent/licensing issues with RC6? When I looked a couple of years ago, it seemed RSA wanted royalties if you used the algorithm commercially (probably because they were annoyed Rijndael was chosen for AES, instead of RC6).<br /></div>
    <div class="meta">Posted on 2005-05-13 11:59:11 by f0dder</div>
   </div>
   <div class="post" id="post-160242">
    <div class="subject"><a href="#post-160242">Re: RC6 encryption</a></div>
    <div class="body">Hey tola, sorry I didn&#39;t respond to your pm sooner, I didn&#39;t see it. Here&#39;s your code rewritten in masm, as requested. Great implementation btw, I really appreciated it sir.</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=634" target="_blank">rc6.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-05-19 08:32:59 by Webring</div>
   </div>
   <div class="post" id="post-160657">
    <div class="subject"><a href="#post-160657">Re: RC6 encryption</a></div>
    <div class="body">Hello, all about interesting rc6.<br /><br />here is a test code about rc6.<br />when rc6 encrypt or decrypt a disk file. it can&#39;t work fine. That&#39;s why?<br /><br />please modify output file name when you are testing. <br /><br /> <br />regards<br /><br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=651" target="_blank">rc6_test.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-06-01 01:40:16 by dcskm4200</div>
   </div>
   <div class="post" id="post-160658">
    <div class="subject"><a href="#post-160658">Re: RC6 encryption</a></div>
    <div class="body"><div class="quote"><br />when rc6 encrypt or decrypt a disk file. it can&#39;t work fine. That&#39;s why?<br /></div><br />That&#39;s <em>somewhat</em> vague - what goes wrong? Is it a GPF, or do you get garbage when decrypting, or... what?<br /></div>
    <div class="meta">Posted on 2005-06-01 04:25:41 by f0dder</div>
   </div>
   <div class="post" id="post-160659">
    <div class="subject"><a href="#post-160659">Re: RC6 encryption</a></div>
    <div class="body">Hello, f0dder.<br /><br />I explain more clear about it can&#39;t work fine.<br />the tested file is 10.txt.<br />the encrypted file is 11.txt.<br />the decrypted file is 12.txt.<br /><br />here is testing result:<br />;===========<br />10.txt<br />this is rc6 tested.<br />;===========<br />11.txt<br />??<br />;===========<br />12.txt<br />? (it should be &quot;this is rc6 tested.&quot;)<br />;===========<br /><br /><br />regards<br /></div>
    <div class="meta">Posted on 2005-06-01 04:43:27 by dcskm4200</div>
   </div>
   <div class="post" id="post-160662">
    <div class="subject"><a href="#post-160662">Re: RC6 encryption</a></div>
    <div class="body">Hey dcskm4200, the problem with your code is Rc6 only encrypts data that&#39;s up to the length of the key. Meaning if your key is 16 bytes long, 16 bytes of plain data is encrypted, and anything left over is untouched... So for files since they&#39;re usually alot larger than 16 bytes you need to read and encrypt in 16 byte increments, or really anything 16 and below. You could read 8 bytes at a time for instance. And you can also change the key length to say 32 bytes. I would have responded sooner but I was put on a very reasonable 5 day posting ban by SpooK because of my attitude problem. I have openly broken the rules of this community and I don't know how to act. I believe these forums are here for my personal use and I don't care if I undermind the moderators/admins or the rules. I do not wish to be be perm banned, but it will happen eventually because I don't know how to follow the rules or keep my mouth shut when it would best serve me. So if you need help fixing your code dcskm4200, email me. ;)</div>
    <div class="meta">Posted on 2005-06-01 05:19:41 by Webring</div>
   </div>
   <div class="post" id="post-160668">
    <div class="subject"><a href="#post-160668">Re: RC6 encryption</a></div>
    <div class="body">Hello, Code Warrior Webring <br /><br />Thanks you for reply.<br />before you guided me, I didn&#39;t actually understand the rc6. I&#39;ll try to fix the tested code. if I can&#39;t figure out, I&#39;ll ask for you with a email.<br />;==================================<br />I always appreciated the following words.<br /><br /><strong>the other viewpoint is as a landscape. if you like it , then stay there for sightseeing; if you disgust it, then depart from it. and the landscape is staying there, could not track you.<br /><br />life is bitter and short. enjoy everyday.</strong><br />;================================== <br /><br />regards.</div>
    <div class="meta">Posted on 2005-06-01 06:47:41 by dcskm4200</div>
   </div>
   <div class="post" id="post-160673">
    <div class="subject"><a href="#post-160673">Re: RC6 encryption</a></div>
    <div class="body">Sounds like a blocksize problem, then.<br /><br />First of all, the RC6_encrypt primitive works on a &#39;block&#39; of data, like all block ciphers. Iirc the RC6 blocksize is 128bit/16byte. So, you have to process files in blocks.<br /><br />Also, files with a final block of less than blockfile size needs to be padded, otherwise the final block will be decrypted wrong! You should pad the buffer with random data, not zeroes.<br /><br />And finally, you should use a chaining method between the blocks, to a void encrypting, say, multiple 16-byte blocks of zeroes to the same encrypted value. The simplest chaining method is probably CBC: http://en.wikipedia.org/wiki/Cipher_Block_Chaining<br /></div>
    <div class="meta">Posted on 2005-06-01 08:22:34 by f0dder</div>
   </div>
   <div class="post" id="post-160677">
    <div class="subject"><a href="#post-160677">Re: RC6 encryption</a></div>
    <div class="body">Hello,F0dder.<br /><br />Thanks you for help.<br /><br />it is very important that you guided me. after i read Webring&#39;s post. I try to modify the code. but I didn&#39;t wake up to that:<br />1. fill lack bytes with random char.<br />2. better method is the CBC or CFB or OFB or CTR, not ECB.<br /><br />thanks again.&nbsp; &nbsp; <br /></div>
    <div class="meta">Posted on 2005-06-01 09:32:43 by dcskm4200</div>
   </div>
   <div class="post" id="post-160682">
    <div class="subject"><a href="#post-160682">Re: RC6 encryption</a></div>
    <div class="body">dcskm4200,<br /><pre><code>invoke WriteFile,hFile,lpBufferSource,Sizeof lpBufferSource,ADDR dwBytesTouched,0</code></pre><br />find the mistake ;)</div>
    <div class="meta">Posted on 2005-06-01 10:12:29 by Tola</div>
   </div>
   <div class="post" id="post-160710">
    <div class="subject"><a href="#post-160710">Re: RC6 encryption</a></div>
    <div class="body">Hey,Tola<br />there is no mistake. attachment include the front code which i modified a little for testing.<br />the 11.txt and 12.txt which created by rc6_7.exe are fine.<br /><br /><br /><strong>error is where f0dder and Webring told me.</strong><br /><br />regards.<br /><br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=657" target="_blank">rc6_7.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-06-02 08:06:34 by dcskm4200</div>
   </div>
   <div class="post" id="post-160711">
    <div class="subject"><a href="#post-160711">Re: RC6 encryption</a></div>
    <div class="body">I don&#39;t have masm installed so I cannot test this. Still, the test program you posted before always creates &#39;encrypted&#39; files that are only 4 bytes in length, regardless of the size of the target file.</div>
    <div class="meta">Posted on 2005-06-02 10:06:49 by Tola</div>
   </div>
   <div class="post" id="post-160718">
    <div class="subject"><a href="#post-160718">Re: RC6 encryption</a></div>
    <div class="body">Also, stop the .bat == .asm madness... it breaks syntax highlighting and double-click == open...<br /></div>
    <div class="meta">Posted on 2005-06-02 18:10:50 by f0dder</div>
   </div>
   <div class="post" id="post-161431">
    <div class="subject"><a href="#post-161431">Re: RC6 encryption</a></div>
    <div class="body">hey,f0dder<br />;===============================================<br />yes, I&#39;m madness. This is the reality which I must accept. But if you said the source code style is madness, Most of famous coder <br />like EliCZ,y0da,Four-F....will chide you.<br />;===============================================<br />you may config your setFile of .bat as same as setFile of .asm in your IDE. for making syntax highlighting .<br />double-click == make exe<br />open== right-click,open with... <br />;===============================================<br />the source code written by ECB may work, but it is ugly.<br />do you want to know the content of &lt;&lt; The Frist Dialogue of New World&gt;&gt; ?<br /><br />let&#39;s go...<br /><br />Key=passme<br /><br />regards</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=720" target="_blank">11.txt</a></li>
      <li><a href="../../attachments/?id=719" target="_blank">rc6_test.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-06-23 02:26:00 by dcskm4200</div>
   </div>
   <div class="post" id="post-161449">
    <div class="subject"><a href="#post-161449">Re: RC6 encryption</a></div>
    <div class="body">HAHAHA<br />jokes<br />u are most famous MAD insane coder</div>
    <div class="meta">Posted on 2005-06-24 07:31:00 by comrade</div>
   </div>
   <div class="post" id="post-161450">
    <div class="subject"><a href="#post-161450">Re: RC6 encryption</a></div>
    <div class="body">LOOKLY VERY NICE.<br />if I was a coder, I must ask for MARRY with you.</div>
    <div class="meta">Posted on 2005-06-24 08:37:35 by dcskm4200</div>
   </div>
   <div class="post" id="post-161454">
    <div class="subject"><a href="#post-161454">Re: RC6 encryption</a></div>
    <div class="body">Now now, children ^_^</div>
    <div class="meta">Posted on 2005-06-24 12:06:42 by f0dder</div>
   </div>
   <div class="post" id="post-161493">
    <div class="subject"><a href="#post-161493">Re: RC6 encryption</a></div>
    <div class="body">hey,Tola <br /><br />Your implementation of the RC6 algorithm runs faster.<br />in Intel(R) Pentium(r) 1.4GHz, 25.3M encrypted file has been finished less 3s.<br /><br />regards<br /></div>
    <div class="meta">Posted on 2005-06-26 10:52:34 by dcskm4200</div>
   </div>
   <div class="post" id="post-161514">
    <div class="subject"><a href="#post-161514">Re: RC6 encryption</a></div>
    <div class="body"><div class="quote"><br />hey,Tola <br /><br />Your implementation of the RC6 algorithm runs faster.<br />in Intel(R) Pentium(r) 1.4GHz, 25.3M encrypted file has been finished less 3s.<br /></div><br />it runs faster than what? :mrgreen:</div>
    <div class="meta">Posted on 2005-06-27 06:04:50 by Tola</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=21136&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=21136&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="21136" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=21136&amp;page=2">&gt;</a><a href="../?id=21136&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>