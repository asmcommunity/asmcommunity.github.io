<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Rebar problems - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26690" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26690">Rebar problems</a></p>
   <div class="post" id="post-192623">
    <div class="subject"><a href="#post-192623">Rebar problems</a></div>
    <div class="body">I've had two (well, more then THAT, but I worked around the others) problems using rebar controls.

1) Occasionally, they don't repaint their child controls, mostly after a resize event (where I knudge em all around)

2) I would like to delete the children in a rebar. No problem as long as I leave one behind, but the LAST one out always leaves the bar the same saze, and I would like it to size to zero (well, leave it's one border as a freesh-no controls added one will do)

Anyone know or have a good reference?</div>
    <div class="meta">Posted on 2001-01-27 19:21:00 by Ernie</div>
   </div>
   <div class="post" id="post-192624">
    <div class="subject"><a href="#post-192624">Rebar problems</a></div>
    <div class="body">Hey Ernie,
In my use of the ReBar control I was painting many things manually on my window. The reason the rebar control won't update is when it's been erased (WM_ERASEBKG I think) but is still considered valid. I used an API called InvalidateRect which will force a window to completely repaint. Now after doing this is usually works, however I also had some custom stuff going on in my toolbars and such, so I had to do something funny in the repaint of the main window.

On WM_PAINT I retrieve the rect of the window, subtract the status bar from the bottom of the rect, subtract the rebar control from the top of the rect and then invalidate that rect. This way the window only repainted the inside client area of the window.

Anyhow that's what I did, might not be totally professional, but it worked. The other option is to subclass the ReBar control and then on WM_PAINT for it, you would have to enumerate all child windows and force them all to repaint. But that sounded harder for me at the time.

Hope this helps some!
See ya,
Ben</div>
    <div class="meta">Posted on 2001-01-27 22:04:00 by cyberben</div>
   </div>
  </div>
 </body>
</html>