<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Edit Control Text - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5028" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5028">Edit Control Text</a></p>
   <div class="post" id="post-35326">
    <div class="subject"><a href="#post-35326">Edit Control Text</a></div>
    <div class="body">Hey everybody!<br /><br /> Awhile ago I was asking about a problem with setting the text buffer of an edit control through EM_SETHANDLE. Well, it never really worked out for me and one of the reasons is that the message is apparently unsupported on win9x! only on NT platforms... but even on NT it never really worked :P<br /><br />So I was wondering if anybody knew more about the edit control, such as where it stored it's pointer to the text buffer (GetWindowLong maybe?) and if I can set it 'manually' instead of through SendMessage or similar. <br /><br />Right now, to access the text from an edit control I'm using GetWindowText and reading it into a buffer for another window. But I'd rather have the buffer shared directly between the edit control and the other window.<br /><br />Thanks in advance<br />--Chorus</div>
    <div class="meta">Posted on 2002-04-27 18:23:27 by chorus</div>
   </div>
   <div class="post" id="post-35556">
    <div class="subject"><a href="#post-35556">Edit Control Text</a></div>
    <div class="body">according to microsoft, there is no way to share the text buffer between the control and the application, at least under Win9x.<br /><br />So the main question is, do you really think, that GetWindowText and SetWindowText is too slow for your task? Maybe there are some other bottlenecks?</div>
    <div class="meta">Posted on 2002-04-29 07:05:28 by beaster</div>
   </div>
   <div class="post" id="post-35567">
    <div class="subject"><a href="#post-35567">Edit Control Text</a></div>
    <div class="body">not slow... just unnecessary...<br /><br />I figure if the information is already in memory once, why allocate more memory and copy the exact same thing if I could just reference it? I only need to read it anyways (no writing).<br /><br />And actually, GetWindowText works very quickly so I'm pretty happy with it, and I have sort-of fixed things so I only call it when necessary. Of course,  a pointer *would* be quicker :) But now that you mention it, my program does have some other bottlenecks which probably need more attention....<br /><br />I guess the only solution is programming my own edit control... but I hear that's kinda involved ;)<br /><br />It's too bad that it can't be done (sharing the memory), thanks anyways though!<br /><br />Until next time<br />--Chorus</div>
    <div class="meta">Posted on 2002-04-29 08:24:44 by chorus</div>
   </div>
   <div class="post" id="post-35592">
    <div class="subject"><a href="#post-35592">Edit Control Text</a></div>
    <div class="body">chorus,<br />On NT use EM_GETHANDLE for reading text.<br />It works on all NT family including 2000.<br />And of course it's faster than GetWindowText, especially when<br />the buffer is large.<br />Method tested and havily used.</div>
    <div class="meta">Posted on 2002-04-29 12:37:48 by The Svin</div>
   </div>
   <div class="post" id="post-35699">
    <div class="subject"><a href="#post-35699">Edit Control Text</a></div>
    <div class="body">Thanks Svin!<br />  That's actually a lot better than what I was trying to do :) I was trying to allocate the memory myself and call EM_SETHANDLE... but I guess it's easier to get the Edit control do all the work! Completely missed that :)<br /><br />--Chorus</div>
    <div class="meta">Posted on 2002-04-29 23:54:49 by chorus</div>
   </div>
  </div>
 </body>
</html>