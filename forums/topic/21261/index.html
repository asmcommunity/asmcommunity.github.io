<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>a problem of Rebar, and the source. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21261" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21261">a problem of Rebar, and the source.</a></p>
   <div class="post" id="post-160875">
    <div class="subject"><a href="#post-160875">a problem of Rebar, and the source.</a></div>
    <div class="body">a problem of Rebar, and the source.<br /><br />&nbsp; As you know, there is a sample of the rebar program. It works very well, but when I added an EDIT control to the client arrea, some problems occured. When you resize the appliction window, then you try to click and pull the Rebar band a few of times, try to resize the Rebar control, you will find that some invalid place was left in the client area. <br /><br />&nbsp; I dealed with the WM_NOTIFY message ,InvalidateRect when RBN_HEIGHTCHANGE, but it didn&#39;t work.<br /><br />&nbsp; So, what is the error ?<br /><br />---------------------------------<br />I attached the screen and the project<br /><br /><br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=672" target="_blank">Rebar.JPG</a></li>
      <li><a href="../../attachments/?id=673" target="_blank">Rebar.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2005-06-07 09:00:08 by seasea</div>
   </div>
   <div class="post" id="post-160876">
    <div class="subject"><a href="#post-160876">And, here is the C file</a></div>
    <div class="body"><pre><code>/**************************************************************************<br />&nbsp;  THIS CODE AND INFORMATION IS PROVIDED &quot;AS IS&quot; WITHOUT WARRANTY OF<br />&nbsp;  ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO<br />&nbsp;  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A<br />&nbsp;  PARTICULAR PURPOSE.<br /><br />&nbsp;  Copyright 2000 Microsoft Corporation.&nbsp; All Rights Reserved.<br />**************************************************************************/<br /><br />/**************************************************************************<br /><br />&nbsp;  File:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ReBar.c<br />&nbsp;  <br />&nbsp;  Description:&nbsp;  ReBar sample implementation.<br /><br />**************************************************************************/<br /><br />#define STRICT<br /><br />/**************************************************************************<br />&nbsp;  Include Files<br />**************************************************************************/<br /><br />#include &lt;windows.h&gt;<br />#include &lt;windowsx.h&gt;<br />#include &lt;commctrl.h&gt;<br />#include &quot;resource.h&quot;<br /><br />/**************************************************************************<br />&nbsp;  Local Function Prototypes<br />**************************************************************************/<br /><br />int PASCAL WinMain(HINSTANCE, HINSTANCE, LPSTR, int);<br />BOOL InitApplication(HINSTANCE);<br />BOOL InitInstance(HINSTANCE, int);<br />LRESULT CALLBACK MainWndProc(HWND, UINT, WPARAM, LPARAM);<br />BOOL CALLBACK About(HWND, UINT, WPARAM, LPARAM);<br />HWND BuildRebar(HWND);<br />LRESULT DoNotify(HWND, WPARAM, LPARAM);<br />void MoveRebar(HWND);<br />LRESULT HandleMenuPopup(HMENU);<br />LRESULT HandleCommand(HWND, WPARAM, LPARAM);<br /><br />/**************************************************************************<br />&nbsp;  Global Variables<br />**************************************************************************/<br /><br />#define ID_REBAR&nbsp; &nbsp;  1000<br />#define ID_BUTTON&nbsp; &nbsp; 2000<br />#define ID_COMBOBOX&nbsp; 2001<br />#define ID_EDIT		 2002<br /><br />#define TOP&nbsp; &nbsp; 0x00<br />#define LEFT&nbsp;  0x01<br />#define BOTTOM 0x02<br />#define RIGHT&nbsp; 0x03<br /><br />HINSTANCE&nbsp;  g_hInst;<br />WORD&nbsp; &nbsp; &nbsp; &nbsp; g_wSide;<br />HWND&nbsp; hWndEdit;<br /><br />/******************************************************************************<br /><br />&nbsp;  WinMain<br /><br />&nbsp;  Parameters:<br /><br />&nbsp;  Description:<br /><br />&nbsp;  Returns:<br /><br />******************************************************************************/<br /><br />int PASCAL WinMain(&nbsp; HINSTANCE hInstance,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  HINSTANCE hPrevInstance,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  LPSTR lpCmdLine,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  int nCmdShow)<br />{<br />MSG&nbsp; &nbsp; &nbsp; msg;<br />INITCOMMONCONTROLSEX iccex;<br /><br />iccex.dwSize = sizeof(INITCOMMONCONTROLSEX);<br />iccex.dwICC = ICC_COOL_CLASSES;<br />InitCommonControlsEx(&amp;iccex);<br /><br />if(!hPrevInstance)<br />&nbsp;  if(!InitApplication(hInstance))<br />&nbsp; &nbsp; &nbsp; return FALSE;<br /><br />if (!InitInstance(hInstance, nCmdShow))<br />&nbsp;  return FALSE;<br /><br />while(GetMessage( &amp;msg, NULL, 0x00, 0x00))<br />&nbsp;  {<br />&nbsp;  TranslateMessage(&amp;msg);<br />&nbsp;  DispatchMessage(&amp;msg);<br />&nbsp;  }<br /><br />return msg.wParam;<br />}<br /><br />/*****************************************************************************<br /><br />&nbsp;  InitApplication<br /><br />&nbsp;  Parameters:<br /><br />&nbsp;  Description:<br />&nbsp;  <br />&nbsp;  Returns:<br /><br />*****************************************************************************/<br /><br />BOOL InitApplication(HINSTANCE hInstance)<br />{<br />WNDCLASS&nbsp; wc;<br /><br />wc.style&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 0;<br />wc.lpfnWndProc&nbsp; &nbsp; = (WNDPROC)MainWndProc;<br />wc.cbClsExtra&nbsp; &nbsp;  = 0;<br />wc.cbWndExtra&nbsp; &nbsp;  = 0;<br />wc.hInstance&nbsp; &nbsp; &nbsp; = hInstance;<br />wc.hIcon&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = LoadIcon(NULL, IDI_APPLICATION);<br />wc.hCursor&nbsp; &nbsp; &nbsp; &nbsp; = LoadCursor(NULL, IDC_ARROW);<br />wc.hbrBackground&nbsp; = (HBRUSH)(COLOR_WINDOW+1);<br />wc.lpszMenuName&nbsp;  = MAKEINTRESOURCE(IDM_GENERICMENU);<br />wc.lpszClassName&nbsp; = &quot;GenericClass&quot;;<br /><br />return RegisterClass(&amp;wc);<br />}<br /><br />/*****************************************************************************<br /><br />&nbsp;  InitInstance<br /><br />&nbsp;  Parameters:<br /><br />&nbsp;  Description:<br />&nbsp;  <br />&nbsp;  Returns:<br /><br />*****************************************************************************/<br /><br />BOOL InitInstance(&nbsp;  HINSTANCE hInstance,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  int nCmdShow)<br />{<br />HWND&nbsp; hWnd;<br /><br />g_hInst = hInstance;<br /><br />hWnd = CreateWindowEx(&nbsp; 0,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;GenericClass&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;Generic Application&quot;,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_OVERLAPPEDWINDOW,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CW_USEDEFAULT,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CW_USEDEFAULT,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CW_USEDEFAULT,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CW_USEDEFAULT,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hInstance,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL);<br /><br />if (!hWnd)<br />&nbsp;  return FALSE;<br /><br />ShowWindow(hWnd, nCmdShow);<br />UpdateWindow(hWnd);<br /><br />return TRUE;<br /><br />}<br /><br />/*****************************************************************************<br /><br />&nbsp;  MainWndProc<br /><br />&nbsp;  Parameters:<br /><br />&nbsp;  Description:<br />&nbsp;  <br />&nbsp;  Returns:<br /><br />*****************************************************************************/<br /><br />LRESULT CALLBACK MainWndProc( HWND hWnd,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UINT uMessage,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WPARAM wParam,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; LPARAM lParam)<br />{<br />switch (uMessage)<br />&nbsp;  {<br />&nbsp;  case WM_CREATE:<br />&nbsp; &nbsp; &nbsp; g_wSide = TOP;<br /><br />&nbsp; &nbsp; &nbsp; BuildRebar(hWnd);<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case WM_NOTIFY:<br />&nbsp; &nbsp; &nbsp; return DoNotify(hWnd, wParam, lParam);<br />&nbsp;  <br />&nbsp;  case WM_SIZE:<br />&nbsp; &nbsp; &nbsp; MoveRebar(hWnd);<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case WM_DESTROY:<br />&nbsp; &nbsp; &nbsp; PostQuitMessage(0);<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case WM_INITMENUPOPUP:<br />&nbsp; &nbsp; &nbsp; return HandleMenuPopup((HMENU)wParam);<br />&nbsp;  <br />&nbsp;  case WM_COMMAND:<br />&nbsp; &nbsp; &nbsp; return HandleCommand(hWnd, wParam, lParam);<br />&nbsp; &nbsp; &nbsp; <br />&nbsp;  default:<br />&nbsp; &nbsp; &nbsp; break;<br />&nbsp;  }<br />return DefWindowProc(hWnd, uMessage, wParam, lParam);<br />}<br /><br />/*****************************************************************************<br /><br />&nbsp;  About<br /><br />&nbsp;  Parameters:<br /><br />&nbsp;  Description:<br />&nbsp;  <br />&nbsp;  Returns:<br /><br />*****************************************************************************/<br /><br />BOOL CALLBACK About( HWND hDlg, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  UINT uMessage, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  WPARAM wParam, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  LPARAM lParam)<br />{<br />switch (uMessage)<br />&nbsp;  {<br />&nbsp;  case WM_INITDIALOG:<br />&nbsp; &nbsp; &nbsp; return TRUE;<br />&nbsp; &nbsp; &nbsp; <br />&nbsp;  case WM_COMMAND:<br />&nbsp; &nbsp; &nbsp; switch(wParam)<br />&nbsp; &nbsp; &nbsp; &nbsp;  {<br />&nbsp; &nbsp; &nbsp; &nbsp;  case IDOK:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EndDialog(hDlg, IDOK);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return TRUE;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;  case IDCANCEL:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; EndDialog(hDlg, IDCANCEL);<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return TRUE;<br />&nbsp; &nbsp; &nbsp; &nbsp;  }<br />&nbsp; &nbsp; &nbsp; break;<br />&nbsp; &nbsp; } <br />&nbsp; &nbsp; <br />return FALSE;<br />}<br /><br />/*****************************************************************************<br /><br />&nbsp;  BuildRebar<br /><br />*****************************************************************************/<br /><br />HWND BuildRebar(HWND hwndParent)<br />{<br />HWND&nbsp; &nbsp;  hwndRebar = NULL;<br />LRESULT&nbsp; lResult;<br /><br />hWndEdit=	CreateWindowEx(WS_EX_CLIENTEDGE, &quot;EDIT&quot;, &quot;Hello&quot;, <br />						&nbsp;  WS_VISIBLE | WS_CHILD | ES_MULTILINE,<br />					&nbsp;  CW_USEDEFAULT, 0, CW_USEDEFAULT, 0, <br />					&nbsp;  hwndParent, (HMENU)ID_EDIT, g_hInst, NULL);<br /><br />hwndRebar = CreateWindowEx(&nbsp;  WS_EX_TOOLWINDOW, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; REBARCLASSNAME, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_VISIBLE |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  WS_BORDER | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  WS_CHILD | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  WS_CLIPCHILDREN | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  WS_CLIPSIBLINGS | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  RBS_VARHEIGHT | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  RBS_BANDBORDERS | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CCS_NODIVIDER | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CCS_NOPARENTALIGN |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ((g_wSide &amp; 0x01) ? CCS_VERT : 0) | //g_wSide is odd if this is a vertical bar<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  0,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 200, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 100, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hwndParent, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (HMENU)ID_REBAR, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; g_hInst, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NULL);<br /><br />if(hwndRebar)<br />&nbsp;  {<br />&nbsp;  REBARINFO&nbsp; &nbsp; &nbsp; rbi;<br />&nbsp;  HIMAGELIST&nbsp; &nbsp;  himlRebar;<br />&nbsp;  HICON&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; hIcon;<br />&nbsp;  REBARBANDINFO&nbsp; rbbi;<br />&nbsp;  HWND&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  hwndChild;<br />&nbsp;  RECT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  rc;<br />&nbsp;  TCHAR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; szString[64];<br /><br />&nbsp;  //set up the ReBar<br />&nbsp;  himlRebar = ImageList_Create(32, 32, ILC_COLORDDB | ILC_MASK, 1, 0);<br />&nbsp;  hIcon = LoadIcon(g_hInst, MAKEINTRESOURCE(IDI_ICON1));<br /><br />&nbsp;  ImageList_AddIcon(himlRebar, hIcon);<br /><br />&nbsp;  rbi.cbSize&nbsp; = sizeof(rbi);<br />&nbsp;  rbi.fMask&nbsp;  = RBIM_IMAGELIST;<br />&nbsp;  rbi.himl&nbsp; &nbsp; = himlRebar;<br />&nbsp;  lResult = SendMessage(hwndRebar, RB_SETBARINFO, 0, (LPARAM)&amp;rbi);<br /><br />&nbsp;  //add a band that contains a combobox<br />&nbsp;  hwndChild = CreateWindowEx(&nbsp;  0, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  TEXT(&quot;combobox&quot;), <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  NULL,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  WS_VISIBLE |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_CHILD | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_TABSTOP |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_VSCROLL |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_CLIPCHILDREN | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WS_CLIPSIBLINGS | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CBS_AUTOHSCROLL | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CBS_DROPDOWN | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  0, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  0, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  100, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  200, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  hwndRebar, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  (HMENU)ID_COMBOBOX, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  g_hInst, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  NULL);<br /><br />&nbsp;  //add some stuff to the combobox<br />&nbsp;  {<br />&nbsp;  int&nbsp;  i;<br /><br />&nbsp;  SendMessage(hwndChild, WM_SETFONT, (WPARAM)GetStockObject(DEFAULT_GUI_FONT), MAKELPARAM(TRUE, 0));<br />&nbsp;  <br />&nbsp;  for(i = 0; i &lt; 25; i++)<br />&nbsp; &nbsp; &nbsp; {<br />&nbsp; &nbsp; &nbsp; wsprintf(szString, TEXT(&quot;Item %d&quot;), i + 1);<br />&nbsp; &nbsp; &nbsp; SendMessage(hwndChild, CB_ADDSTRING, 0, (LPARAM)szString);<br />&nbsp; &nbsp; &nbsp; }<br />&nbsp;  }<br />&nbsp;  <br />&nbsp;  GetWindowRect(hwndChild, &amp;rc);<br />&nbsp;  <br />&nbsp;  ZeroMemory(&amp;rbbi, sizeof(rbbi));<br />&nbsp;  rbbi.cbSize&nbsp; &nbsp; &nbsp;  = sizeof(REBARBANDINFO);<br />&nbsp;  rbbi.fMask&nbsp; &nbsp; &nbsp; &nbsp; = RBBIM_SIZE | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_CHILD | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_CHILDSIZE | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_ID | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_STYLE | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_TEXT |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_BACKGROUND |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_IMAGE |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0;<br />&nbsp;  <br />&nbsp;  rbbi.cxMinChild&nbsp;  = rc.right - rc.left;<br />&nbsp;  rbbi.cyMinChild&nbsp;  = rc.bottom - rc.top;<br />&nbsp;  rbbi.cx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  = 100;<br />&nbsp;  rbbi.fStyle&nbsp; &nbsp; &nbsp;  = RBBS_CHILDEDGE | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBS_FIXEDBMP |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBS_GRIPPERALWAYS |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0;<br />&nbsp;  rbbi.wID&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = ID_COMBOBOX;<br />&nbsp;  rbbi.hwndChild&nbsp; &nbsp; = hwndChild;<br />&nbsp;  rbbi.lpText&nbsp; &nbsp; &nbsp;  = TEXT(&quot;ComboBox&quot;);<br />&nbsp;  rbbi.cch&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = 2;<br />&nbsp;  rbbi.hbmBack&nbsp; &nbsp; &nbsp; = LoadBitmap(g_hInst, MAKEINTRESOURCE(IDB_BACKGROUND));<br />&nbsp;  rbbi.iImage&nbsp; &nbsp; &nbsp;  = 0;<br /><br />&nbsp;  lResult = SendMessage(hwndRebar, RB_INSERTBAND, (WPARAM)-1, (LPARAM)(LPREBARBANDINFO)&amp;rbbi);<br /><br />&nbsp;  //add a band that contains a button<br />&nbsp;  hwndChild = CreateWindowEx(&nbsp;  0, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  TEXT(&quot;button&quot;), <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  TEXT(&quot;Button&quot;),<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  WS_CHILD | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; BS_PUSHBUTTON | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  0, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  0, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  100, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  50, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  hwndRebar, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  (HMENU)ID_BUTTON, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  g_hInst, <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  NULL);<br />&nbsp;  <br />&nbsp;  GetWindowRect(hwndChild, &amp;rc);<br />&nbsp;  <br />&nbsp;  ZeroMemory(&amp;rbbi, sizeof(rbbi));<br />&nbsp;  rbbi.cbSize&nbsp; &nbsp; &nbsp;  = sizeof(REBARBANDINFO);<br />&nbsp;  rbbi.fMask&nbsp; &nbsp; &nbsp; &nbsp; = RBBIM_SIZE | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_CHILD | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_CHILDSIZE | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_ID | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_STYLE | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_TEXT |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBIM_BACKGROUND |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0;<br />&nbsp;  rbbi.cxMinChild&nbsp;  = rc.right - rc.left;<br />&nbsp;  rbbi.cyMinChild&nbsp;  = rc.bottom - rc.top;<br />&nbsp;  rbbi.cx&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  = 100;<br />&nbsp;  rbbi.fStyle&nbsp; &nbsp; &nbsp;  = RBBS_CHILDEDGE | <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBS_FIXEDBMP |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; RBBS_GRIPPERALWAYS |<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 0;<br />&nbsp;  rbbi.wID&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; = ID_BUTTON;<br />&nbsp;  rbbi.hwndChild&nbsp; &nbsp; = hwndChild;<br />&nbsp;  rbbi.lpText&nbsp; &nbsp; &nbsp;  = TEXT(&quot;Button&quot;);<br />&nbsp;  rbbi.hbmBack&nbsp; &nbsp; &nbsp; = LoadBitmap(g_hInst, MAKEINTRESOURCE(IDB_BACKGROUND));<br /><br /><br />&nbsp;  lResult = SendMessage(hwndRebar, RB_INSERTBAND, (WPARAM)-1, (LPARAM)(LPREBARBANDINFO)&amp;rbbi);<br />&nbsp;  }<br /><br />	MoveRebar(hwndParent);<br /><br />return hwndRebar;<br />}<br /><br />/*****************************************************************************<br /><br />&nbsp;  DoNotify<br /><br />*****************************************************************************/<br /><br />LRESULT DoNotify(HWND hWnd, WPARAM wParam, LPARAM lParam)<br />{<br />LPNMHDR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  lpNM = (LPNMHDR)lParam;<br /><br />switch(lpNM-&gt;code)<br />&nbsp;  {<br />	case RBN_HEIGHTCHANGE:<br />		InvalidateRect(hWnd, NULL, TRUE);<br />		break;<br />&nbsp;  default:<br />&nbsp; &nbsp; &nbsp; break;<br />&nbsp;  }<br /><br />return FALSE;<br />}<br /><br />/**************************************************************************<br /><br />&nbsp;  MoveRebar()<br />&nbsp;  <br />**************************************************************************/<br /><br />void MoveRebar(HWND hWnd)<br />{<br />	RECT&nbsp; rc, rcRebar;<br />	int&nbsp;  x, y, cx, cy;<br /><br />	GetClientRect(hWnd, &amp;rc);<br />	GetWindowRect(GetDlgItem(hWnd, ID_REBAR), &amp;rcRebar);<br /><br />&nbsp; &nbsp; &nbsp; //align the rebar along the top of the window<br />	x = 0;<br />	y = 0;<br />	cx = rc.right - rc.left;<br />	cy = rcRebar.bottom - rcRebar.top;<br /><br />	MoveWindow(GetDlgItem(hWnd, ID_REBAR), 0, 0, cx, cy, TRUE);<br /><br />	MoveWindow(hWndEdit, 0, cy, cx, rc.bottom-rc.top-cy, TRUE);<br />}<br /><br /><br />/**************************************************************************<br /><br />&nbsp;  HandleMenuPopup()<br />&nbsp;  <br />**************************************************************************/<br /><br />LRESULT HandleMenuPopup(HMENU hMenu)<br />{<br />UINT&nbsp; uSelect;<br /><br />switch(g_wSide)<br />&nbsp;  {<br />&nbsp;  default:<br />&nbsp;  case TOP:<br />&nbsp; &nbsp; &nbsp; uSelect = IDM_TOP;<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case LEFT:<br />&nbsp; &nbsp; &nbsp; uSelect = IDM_LEFT;<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case BOTTOM:<br />&nbsp; &nbsp; &nbsp; uSelect = IDM_BOTTOM;<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case RIGHT:<br />&nbsp; &nbsp; &nbsp; uSelect = IDM_RIGHT;<br />&nbsp; &nbsp; &nbsp; break;<br />&nbsp;  }<br /><br />CheckMenuRadioItem(hMenu, IDM_TOP, IDM_BOTTOM, uSelect, MF_BYCOMMAND);<br /><br />return 0;<br />}<br /><br />/**************************************************************************<br /><br />&nbsp;  HandleCommand()<br />&nbsp;  <br />**************************************************************************/<br /><br />LRESULT HandleCommand(HWND hWnd, WPARAM wParam, LPARAM lParam)<br />{<br />switch(GET_WM_COMMAND_ID(wParam, lParam))<br />&nbsp;  {<br />&nbsp;  case ID_BUTTON:<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case ID_COMBOBOX:<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case IDM_TOP:<br />&nbsp; &nbsp; &nbsp; if(g_wSide != TOP)<br />&nbsp; &nbsp; &nbsp; &nbsp;  {<br />&nbsp; &nbsp; &nbsp; &nbsp;  //destroy the existing Rebar<br />&nbsp; &nbsp; &nbsp; &nbsp;  DestroyWindow(GetDlgItem(hWnd, ID_REBAR));<br />&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp;  //change to the new side<br />&nbsp; &nbsp; &nbsp; &nbsp;  g_wSide = TOP;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;  //create the new Rebar<br />&nbsp; &nbsp; &nbsp; &nbsp;  BuildRebar(hWnd);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;  //we have to do this because the rebar will recalculate it&#39;s rectangle after the first time it is sized<br />&nbsp; &nbsp; &nbsp; &nbsp;  MoveRebar(hWnd);<br />&nbsp; &nbsp; &nbsp; &nbsp;  }<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case IDM_BOTTOM:<br />&nbsp; &nbsp; &nbsp; if(g_wSide != BOTTOM)<br />&nbsp; &nbsp; &nbsp; &nbsp;  {<br />&nbsp; &nbsp; &nbsp; &nbsp;  //destroy the existing Rebar<br />&nbsp; &nbsp; &nbsp; &nbsp;  DestroyWindow(GetDlgItem(hWnd, ID_REBAR));<br />&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp;  g_wSide = BOTTOM;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;  //create the new Rebar<br />&nbsp; &nbsp; &nbsp; &nbsp;  BuildRebar(hWnd);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;  //we have to do this because the rebar will recalculate it&#39;s rectangle after the first time it is sized<br />&nbsp; &nbsp; &nbsp; &nbsp;  MoveRebar(hWnd);<br />&nbsp; &nbsp; &nbsp; &nbsp;  }<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case IDM_LEFT:<br />&nbsp; &nbsp; &nbsp; if(g_wSide != LEFT)<br />&nbsp; &nbsp; &nbsp; &nbsp;  {<br />&nbsp; &nbsp; &nbsp; &nbsp;  //destroy the existing Rebar<br />&nbsp; &nbsp; &nbsp; &nbsp;  DestroyWindow(GetDlgItem(hWnd, ID_REBAR));<br />&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp;  g_wSide = LEFT;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;  //create the new Rebar<br />&nbsp; &nbsp; &nbsp; &nbsp;  BuildRebar(hWnd);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;  //we have to do this because the rebar will recalculate it&#39;s rectangle after the first time it is sized<br />&nbsp; &nbsp; &nbsp; &nbsp;  MoveRebar(hWnd);<br />&nbsp; &nbsp; &nbsp; &nbsp;  }<br />&nbsp; &nbsp; &nbsp; break;<br /><br />&nbsp;  case IDM_RIGHT:<br />&nbsp; &nbsp; &nbsp; if(g_wSide != RIGHT)<br />&nbsp; &nbsp; &nbsp; &nbsp;  {<br />&nbsp; &nbsp; &nbsp; &nbsp;  //destroy the existing Rebar<br />&nbsp; &nbsp; &nbsp; &nbsp;  DestroyWindow(GetDlgItem(hWnd, ID_REBAR));<br />&nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp;  g_wSide = RIGHT;<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;  //create the new Rebar<br />&nbsp; &nbsp; &nbsp; &nbsp;  BuildRebar(hWnd);<br /><br />&nbsp; &nbsp; &nbsp; &nbsp;  //we have to do this because the rebar will recalculate it&#39;s rectangle after the first time it is sized<br />&nbsp; &nbsp; &nbsp; &nbsp;  MoveRebar(hWnd);<br />&nbsp; &nbsp; &nbsp; &nbsp;  }<br />&nbsp; &nbsp; &nbsp; break;<br />&nbsp;  <br />&nbsp;  case IDM_EXIT:<br />&nbsp; &nbsp; &nbsp; DestroyWindow(hWnd);<br />&nbsp; &nbsp; &nbsp; break;<br />&nbsp;  <br />&nbsp;  case IDM_ABOUT:<br />&nbsp; &nbsp; &nbsp; DialogBox(g_hInst, MAKEINTRESOURCE(IDD_ABOUTBOX), hWnd, About);<br />&nbsp; &nbsp; &nbsp; break;&nbsp;  <br />&nbsp; &nbsp; &nbsp; <br />&nbsp;  }<br /><br />return TRUE;<br />}<br /></code></pre></div>
    <div class="meta">Posted on 2005-06-07 09:04:23 by seasea</div>
   </div>
  </div>
 </body>
</html>