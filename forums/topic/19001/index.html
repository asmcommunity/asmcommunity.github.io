<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>import - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19001" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19001">import</a></p>
   <div class="post" id="post-147001">
    <div class="subject"><a href="#post-147001">import</a></div>
    <div class="body">Does anybody know some functions (public, not undocumented) to enlarge the import table of in-memory module?<br /><br />And one more question - can anyone explain me what BindImage function do? In msdn i found that: &quot;The BindImage function computes the virtual address of each imported function.&quot;. But where can i find result? 8)</div>
    <div class="meta">Posted on 2004-07-28 07:14:10 by happyfly</div>
   </div>
   <div class="post" id="post-147003">
    <div class="subject"><a href="#post-147003">import</a></div>
    <div class="body">Suppose that it returns the value in eax.<br /><br /><br /><br />/siddhartha</div>
    <div class="meta">Posted on 2004-07-28 07:49:25 by siddhartha</div>
   </div>
   <div class="post" id="post-147005">
    <div class="subject"><a href="#post-147005">import</a></div>
    <div class="body">nop. the result is bool. i mean where can i find the result of compution &quot;the virtual address of each imported function&quot;?<br />BOOL BindImage(<br />    IN LPSTR ImageName,	<br />    IN LPSTR DllPath,	<br />    IN LPSTR SymbolPath	<br />   );</div>
    <div class="meta">Posted on 2004-07-28 08:19:52 by happyfly</div>
   </div>
   <div class="post" id="post-147006">
    <div class="subject"><a href="#post-147006">import</a></div>
    <div class="body">You can use BindImageEx to have the computed address sent to a callback routine.</div>
    <div class="meta">Posted on 2004-07-28 08:22:38 by donkey</div>
   </div>
   <div class="post" id="post-147013">
    <div class="subject"><a href="#post-147013">import</a></div>
    <div class="body"><div class="quote"><br />Does anybody know some functions (public, not undocumented) to enlarge the import table of in-memory module?<br /></div><br />Do you mean &quot;running process&quot; or &quot;manually loaded to memory&quot;? If you're working on a PE editing tool, you should have a look at SantMat's IIDKing. I think he's working on a new version of the tool that's going to be a lot better, btw.<br /><br /><div class="quote"><br />And one more question - can anyone explain me what BindImage function do? In msdn i found that: &quot;The BindImage function computes the virtual address of each imported function.&quot;. But where can i find result? 8)<br /></div><br />I would assume you find the result in the PE? =) As donkey says, you might want to check out BindImageEx... if you don't want to modify the exe file, specify BIND_NO_UPDATE as flag. You'll probably be interested in the StatusRoutine called with <em>Parameter</em> of <em>BindImportProcedure</em>.</div>
    <div class="meta">Posted on 2004-07-28 08:56:17 by f0dder</div>
   </div>
   <div class="post" id="post-147019">
    <div class="subject"><a href="#post-147019">import</a></div>
    <div class="body">f0dder, donkey thnx a lot :]<br />i understood it (i also found it in Richter's book =))... It shoud help me...<br />Im not working on new PE Tool, but i made some new injection method (multiplatform method which doesnt use any additional dll file) and when i tried to use it in delphi (i mean {$L obfile} ;)) i found out that delphi linker makes very specific import table, so standart code which works with VC and masm doesnt work :(<br />Im too lazy to rewrite my code :) so i began to search the easiest way 8)</div>
    <div class="meta">Posted on 2004-07-28 10:59:51 by happyfly</div>
   </div>
   <div class="post" id="post-147020">
    <div class="subject"><a href="#post-147020">import</a></div>
    <div class="body">Hm, what's with the delphi import tables?<br />I know that borland linkers have had a lot of bugs, like firstthunk/originalfirstthunk, messed-up section virtualsize, etc... but what's with the import tables?</div>
    <div class="meta">Posted on 2004-07-28 11:04:01 by f0dder</div>
   </div>
   <div class="post" id="post-147021">
    <div class="subject"><a href="#post-147021">import</a></div>
    <div class="body">for example (the worst problem) there is no function names in import table (i guess u meant that when u wrote about firstthunk/originalfirstthunk problem) of in-memory module so i have to work with 2 import tables: from disk and from memory.</div>
    <div class="meta">Posted on 2004-07-28 11:16:51 by happyfly</div>
   </div>
   <div class="post" id="post-147022">
    <div class="subject"><a href="#post-147022">import</a></div>
    <div class="body">yup, only having FirstThunk and no OFT...</div>
    <div class="meta">Posted on 2004-07-28 11:23:38 by f0dder</div>
   </div>
  </div>
 </body>
</html>