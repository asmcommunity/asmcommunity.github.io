<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>What is better to use MACRO or PROC ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9184" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9184">What is better to use MACRO or PROC ?</a></p>
   <div class="post" id="post-67571">
    <div class="subject"><a href="#post-67571">What is better to use MACRO or PROC ?</a></div>
    <div class="body">What is better to use MACRO or PROC ?<br /><br />what is faster or better.</div>
    <div class="meta">Posted on 2002-11-26 07:02:34 by drakoforma</div>
   </div>
   <div class="post" id="post-67579">
    <div class="subject"><a href="#post-67579">What is better to use MACRO or PROC ?</a></div>
    <div class="body">Its comparing apples to oranges...<br />They are similar, but not the same...<br /><br />A macro is expanded at assemble time, while a proc is jumpped to at run-time.<br />Macros will replicate the code each time they are called, but will avoid the calling overhead, procs will be a single body of code.<br /><br />Which you choose depends on your problem.<br /><br />Mirno</div>
    <div class="meta">Posted on 2002-11-26 07:19:04 by Mirno</div>
   </div>
   <div class="post" id="post-67581">
    <div class="subject"><a href="#post-67581">What is better to use MACRO or PROC ?</a></div>
    <div class="body">Macro repeats it's content whenever it gets called, proc doesn't. They are both completely different things, even tho you might be able to achieve the same using either one of them.<br /><br />Look as a Macro only as a helpful 'copy-paste' and a proc as a more evolved context-specific function.<br /><br /><br /><span style="font-size:9px></span></div>
    <div class="meta">Posted on 2002-11-26 07:21:34 by JimmyClif</div>
   </div>
   <div class="post" id="post-67590">
    <div class="subject"><a href="#post-67590">What is better to use MACRO or PROC ?</a></div>
    <div class="body">Use both together.  MACROs <strong>can</strong> create PROCs, but PROCs <strong>can't</strong> create MACROs. :)</div>
    <div class="meta">Posted on 2002-11-26 07:51:49 by bitRAKE</div>
   </div>
   <div class="post" id="post-67681">
    <div class="subject"><a href="#post-67681">What is better to use MACRO or PROC ?</a></div>
    <div class="body">Which is better?<br /><br />A brick layer, or a tool-shed..?<br /><br />Macro's and Proc's are fundementally different....<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-11-26 23:28:33 by NaN</div>
   </div>
   <div class="post" id="post-67697">
    <div class="subject"><a href="#post-67697">What is better to use MACRO or PROC ?</a></div>
    <div class="body">What is the speed of a text Marco size of under <strong>20 bytes</strong> and a max of <strong>128 bytes</strong> verses a PUSH / INVOKE  of the string from a buffer.... I am taking about Icz small text Marco used in most of the Tutes..<br /><br />I am sure that PUSH is faster but by HOW MUCH... 20% , 50% or 1000% difference.  Have someone actually clocked this type for small text strings. If so the information about this will prove very helpful.  If it not by Tooooooo much i may start back to using the Text marco for small strings more often. <br /><br />Maybe a Single Cut and Paste may beat a push for every SINGLE Byte with one per Clock per Byte.<br /><br />There is nothing like having a good a tool-shed i hear.... <span style="font-size:9px> Are you refering to Marcos in this case or is it the other way around.</span></div>
    <div class="meta">Posted on 2002-11-27 00:47:29 by cmax</div>
   </div>
   <div class="post" id="post-67878">
    <div class="subject"><a href="#post-67878">What is better to use MACRO or PROC ?</a></div>
    <div class="body">Eh, just wanted to point out that it should be &quot;macro&quot; not &quot;marco&quot; (I thought that was a typo but apparently not  :) Maybe it was a tripple typo .:eek: )<br /><br />Anyway, macros are almost always faster but less practical sometimes. If the macro is used many times in non-critical code you should change it to a proc to save space.</div>
    <div class="meta">Posted on 2002-11-28 00:44:16 by gliptic</div>
   </div>
   <div class="post" id="post-67972">
    <div class="subject"><a href="#post-67972">What is better to use MACRO or PROC ?</a></div>
    <div class="body">Thx:rolleyes:</div>
    <div class="meta">Posted on 2002-11-28 14:19:51 by drakoforma</div>
   </div>
   <div class="post" id="post-68014">
    <div class="subject"><a href="#post-68014">What is better to use MACRO or PROC ?</a></div>
    <div class="body"><div class="quote"><br />What is the speed of a text Marco size of under 20 bytes and a max of 128 bytes verses a PUSH / INVOKE of the string from a buffer.... I am taking about Icz small text Marco used in most of the Tutes..</div><br /><div class="quote"><br />Anyway, macros are almost always faster but less practical sometimes. If the macro is used many times in non-critical code you should change it to a proc to save space. </div><br />Ok, i admit, i havent looked at these tut's before this reply but:<br /><ul>[*]Macros are compile time tools (not run time).<br />[*]push/pop &amp; all other Intel Op-codes are run-time instructions.  (Not compile time).<br />[*]Macros are a first pass: compile-to-assembly.<br />[*]Assembly to binary is the next (multiple) passes.<br /><br /><br />Therefor:<ul><br />[*]You can't compare compile time Macro's to run time op-codes, and judge for efficiency.  They are Apples-to-Oranges.<br /><br />Glypic is also correct in his statement, but it is ill-qualified with regard to the question presented.  <br /><br />Macro's are like a rubber stamp, pounded into your code.  They are not like functions, even tho they may seem like it when you use them.  Funcitons exist in binary files only once, and all calls to them jump to its location, and jump back.  Macros translate into the code, as they are scriped to &quot;Stamp&quot; into your ASM file, every time it finds an indication to do so. <br /><br />So as glypic said, &quot;If the macro is used many times in your code you should change it to a proc to save space&quot;.  Quick accounting here:<ul><br />[*]Macro is defined with 20 lines of ASM code.<br />[*]The macro appears 80 times in your program.<br />[*]The first pass compile stamps in 1600 lines of ASM into your program.<br />[*]The next passes assemble the ASM into your final binary exe.<br />If the 20 lines of code was placed in a funciton: The final exe would only add approximately 20 lines of extra code for the calls to the funciton, and 20 lines for the function itself.<br /><br />40 vs. 1600<br /><br />I let you decide...<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-11-28 22:11:04 by NaN</div>
   </div>
   <div class="post" id="post-68018">
    <div class="subject"><a href="#post-68018">What is better to use MACRO or PROC ?</a></div>
    <div class="body"><div class="quote">If the 20 lines of code was placed in a funciton: The final exe would only add approximately 20 lines of extra code for the calls to the funciton, and 20 lines for the function itself.<br /><br />40 vs. 1600<br /><br />I let you decide...</div> <br /><br />If the macro appears 80 times in your program and you want to change it to a proc, it would take up more that 40 lines of code.<br /> You still need to use the instruction call to call the function which takes about 2 bytes(please correct me if I am wrong). Furthermore, call instruction is like any other instruction and will take up clock time.</div>
    <div class="meta">Posted on 2002-11-28 22:39:01 by roticv</div>
   </div>
   <div class="post" id="post-68023">
    <div class="subject"><a href="#post-68023">What is better to use MACRO or PROC ?</a></div>
    <div class="body"><div class="quote"><em>Originally posted by NaN </em><br />Quick accounting here:<ul><br />[*]Macro is defined with 20 lines of ASM code.<br />[*]The macro appears 80 times in your program.<br /><br />If the 20 lines of code was placed in a funciton: The final exe would only add approximately <strong>80</strong> lines of extra code for the calls to the funciton, and 20 lines for the function itself.<br /><br /><strong>100</strong> vs. 1600</div>If the MACRO appears 80 times, then it would need to be called 80 times if it was a PROC.  Also, speedwise, there would be the overhead of 80*(CALL + RET + (?)).  If a stack frame is created or parameters passed on the stack instead of by register then that (?) is going to be more. :)<br /><br />MACROs should not be used for everything - just where it adds features and eases programming.  This is usually small pieces of code - sizewise less than the bytes for a CALL/ENTER/LEAVE/RET.  MACROs also add complexity to the code - if a documented system isn't used expect your code to look like hieroglyphics to anyone trying to read it - the learning curve goes through the roof.</div>
    <div class="meta">Posted on 2002-11-29 00:01:33 by bitRAKE</div>
   </div>
   <div class="post" id="post-68216">
    <div class="subject"><a href="#post-68216">What is better to use MACRO or PROC ?</a></div>
    <div class="body">BitRAKE, thank you for catching this obvious mistake ;)<br /><br />As for the call/ret business, i too realized this but didnt want to bring the conversation necessarily to this level, which is why i had chosen the word 'approximately' to follow the mistaken 20 lines.... et. al.  ;)<br /><br />At any rate, i hope this business is clear for cmax, gliptic, and drakoforma...<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-11-29 23:48:19 by NaN</div>
   </div>
   <div class="post" id="post-68438">
    <div class="subject"><a href="#post-68438">What is better to use MACRO or PROC ?</a></div>
    <div class="body">Thanks NaN and bitRAKE for the detailed information about this.  OK let say i don't care about the bloat that a Marco my produce.  So with the Marco being set up in the execution-able at compile time this would mean that the macro has already done it job and now ALL code is SET, so when i click a button to a code that is using a marco it will run JUST as FAST as when i click a code that jump Procedure BUT the only advange here is that i will not be jumping to anything because the code is right there, there is no more CUT and PASTE because it was all done at compile time ... Is this right the marco would be fasters because the code is already there and don't have to call this again right<br /><br />      szText MACRO Name, Text:VARARG<br />        LOCAL lbl<br />          jmp lbl<br />            Name db Text,0<br />          lbl:<br />        ENDM<br /><br />So it don't have to jump to the above statement ever again because it has already been Stamped in-line with the code that i clicked the button for.  If so this only save the time of typing in code in-line as opose to using a procedure, all this to mean that using Marcos is faster only because i am not calling a procedure because the code is ALREADY there.  In-line code is all that is... If i got this right thanks extra, extra for the well explanation about Marco's.  Bottom line it's is not bloat if in-line programming is what a programmer  wanted to do in the first place, it's only a typing time saver as opose to using a procecdure :)<br /><br />No back to reality<br />I though it has to call the Marco everytime all over again just like it call a procudure... or is this wrong.<br />I always use message box to see what i have done and sometimes i do have seen that  LEFT-OVER  e : some where in esi reg indicating a cut and paste of the marco... What that all about, is it still cutting and pasting if so something is not right.  You can dump the code and you see this in the code section all bundled together but down deep in the page where the code is using that marco there is no ...e :<br /><br />So this lead me back to belever that there is no  extra line (code) per say that should be there because it  was suppose to be done at compile time.  This is what makes it all so confussing.  It seems like it is still cutting and pasting the SAME line just like you would push a line from the data section but it's only in the code section with the  e:  waiting to be used.  This is what make me confussed about marcos.  It may not be doing a full in-line, only a ref thing to force a call to the marco and if that is true i would rather type it in-line or use procedures.<br />This is why i alway ask about marco, so i can find the truth again what i see and thing that e: do.<br /><br />the marco symbol in mem is a e with 2 dots over it and in back of it</div>
    <div class="meta">Posted on 2002-12-01 09:52:07 by cmax</div>
   </div>
  </div>
 </body>
</html>