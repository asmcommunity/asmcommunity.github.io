<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>TrayIcon... - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3169" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3169">TrayIcon...</a></p>
   <div class="post" id="post-20902">
    <div class="subject"><a href="#post-20902">TrayIcon...</a></div>
    <div class="body">Hi All !!<br /><br />Does anybody know how to update the tooltip text of an icon in the traybar ?<br />I have a timer and every second, i need to update the text...<br />My line <em>invoke Shell_NotifyIcon,NIM_MODIFY,addr TrayStruct</em> produce no result.<br />The only solution is maybe to create manually the tooltip and attach it to the icon !!??<br /><br /><br /><br />:confused: HELP :confused:</div>
    <div class="meta">Posted on 2002-01-24 09:31:14 by PhoBos</div>
   </div>
   <div class="post" id="post-20930">
    <div class="subject"><a href="#post-20930">TrayIcon...</a></div>
    <div class="body">Hi,<br />I can't help you because I've never thought about it, but you should ask that at the main forum. Because I don't think that all the people go to all the forum. (I can say that because not to lose a lot of time, I just watch the main forum, and somtimes the others)<br /><br />D?sol? de pas t'avoir aid?, enfin, j'avais fait un prog qui faisait ?a, but I just changed the caption of the window, and that changed the tooltip sec per second, but it didn't refresh from its own.</div>
    <div class="meta">Posted on 2002-01-24 13:59:49 by Vom-bonjour:-()</div>
   </div>
   <div class="post" id="post-20936">
    <div class="subject"><a href="#post-20936">TrayIcon...</a></div>
    <div class="body">Sorry, I thought this message was on the Algo forum. Did a moderator move this message, or was I dreaming:rolleyes: .</div>
    <div class="meta">Posted on 2002-01-24 14:33:27 by Vom-bonjour:-()</div>
   </div>
   <div class="post" id="post-20937">
    <div class="subject"><a href="#post-20937">TrayIcon...</a></div>
    <div class="body">:grin: <strong>Vom-bonjour:-()</strong>, your not dreaming - I just followed your good advice and put the message here.  :grin:</div>
    <div class="meta">Posted on 2002-01-24 14:40:31 by bitRAKE</div>
   </div>
   <div class="post" id="post-20938">
    <div class="subject"><a href="#post-20938">TrayIcon...</a></div>
    <div class="body">PhoBos,<br /><br />If you mean the tooltip that shows up while <br />hovering over your programs button on the &quot;taskbar&quot;<br />you can use:<br /><br />invoke  SetWindowText, hWnd, ADDR jact<br /><br />to change the text in the title bar which will<br />also show up on the tooltip.  Is that what you<br />wanted?<br /><br />farrier</div>
    <div class="meta">Posted on 2002-01-24 14:49:17 by farrier</div>
   </div>
   <div class="post" id="post-20941">
    <div class="subject"><a href="#post-20941">TrayIcon...</a></div>
    <div class="body">Here is the code I usually use, it is in C, sorry :grin:.<br /><pre><code>/************************************<br />* TaskBarModifyIcon&#58; modify the icon in the TNA<br />* hwnd - handle of the window to receive callback messages<br />* uID - identifier of the icon<br />* hicon - handle of the icon<br />* lpszTip - tooltip text<br />*************************************/<br />BOOL TaskBarModifyIcon &#40;HWND hWnd, UINT uID, HICON hIcon, LPSTR lpszTip&#41;<br />&#123;<br />  NOTIFYICONDATA tnid ;<br /><br />  tnid.cbSize = sizeof&#40;NOTIFYICONDATA&#41; ;<br />  tnid.hWnd = hWnd ;<br />  tnid.uID = uID ;<br />  tnid.uFlags = 0 ;<br />  if &#40;hIcon&#41;<br />  &#123;<br />    tnid.uFlags |= NIF_ICON ;<br />    tnid.hIcon = hIcon ;<br />  &#125;<br />  if &#40;lpszTip&#41;<br />  &#123;<br />    tnid.uFlags |= NIF_TIP ;<br />    lstrcpyn &#40;tnid.szTip, lpszTip, sizeof&#40;tnid.szTip&#41;&#41; ;<br />  &#125;<br />  return Shell_NotifyIcon &#40;NIM_MODIFY, &amp;tnid&#41; ;<br />&#125;<br /></code></pre><br />The only error I can think about is that you didn't update the uFlags field with NIF_TIP value.</div>
    <div class="meta">Posted on 2002-01-24 15:01:43 by LuHa</div>
   </div>
   <div class="post" id="post-20942">
    <div class="subject"><a href="#post-20942">TrayIcon...</a></div>
    <div class="body">bitRAKE: I really thought I became mad:grin: <br />farrier: That was what I said when I said you can change the caption of the window (with SetWindowText as you said) but the problem with that is that when the tooltip is displayed, it is not refreshed itself, you've got to leave the tooltip and then display the tooltip again (with moving the cursor on the tray icon).<br />So maybe PhoBos should create it manually, I don't really know.<br /><br />Thanks bitRAKE, I'm not dreaming, so I can now do my homework. (it's 22h11 and it's for tomorrow) but you don't care:alright:</div>
    <div class="meta">Posted on 2002-01-24 15:02:17 by Vom-bonjour:-()</div>
   </div>
   <div class="post" id="post-20943">
    <div class="subject"><a href="#post-20943">TrayIcon...</a></div>
    <div class="body">Ah!, LuHa posted the message while I was writing the provious one :alright: :alright:</div>
    <div class="meta">Posted on 2002-01-24 15:03:22 by Vom-bonjour:-()</div>
   </div>
   <div class="post" id="post-20946">
    <div class="subject"><a href="#post-20946">TrayIcon...</a></div>
    <div class="body">Bonne chance a ta devoirs! :)</div>
    <div class="meta">Posted on 2002-01-24 15:12:22 by TCT</div>
   </div>
   <div class="post" id="post-20949">
    <div class="subject"><a href="#post-20949">TrayIcon...</a></div>
    <div class="body">Vom-bonjour:-(),<br /><br /><div class="quote"><br />but the problem with that is that when the tooltip is displayed, it is not refreshed itself, you've got to leave the tooltip and then display the tooltip again (with moving the cursor on the tray icon).</div><br /><br />In my alarm-clock/countdown-timer/stopwatch <br />program, jacts.asm, I use the SetWindowText to <br />update the title bar and tooltip.  The text is <br />updated by a 1 second timer and if I keep the <br />mouse on the taskbar button, the tooltip updates<br />every second, Win95.  But I think LuHa has the<br />better solution!  Thanks!<br /><br />farrier</div>
    <div class="meta">Posted on 2002-01-24 15:27:49 by farrier</div>
   </div>
   <div class="post" id="post-21046">
    <div class="subject"><a href="#post-21046">Tx !!</a></div>
    <div class="body">Hi all !<br /><br />Thank you for your replies.<br />As you can see, i used the same solution than LuHa...<br />Curretly i'm trying to create the tooltip manually to see if it works better... :rolleyes: <br /><br />Sending results later.<br />Tx again...</div>
    <div class="meta">Posted on 2002-01-25 03:42:48 by PhoBos</div>
   </div>
  </div>
 </body>
</html>