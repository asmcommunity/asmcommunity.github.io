<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Offsets &amp; Addresses - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6346" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6346">Offsets &amp; Addresses</a></p>
   <div class="post" id="post-45620">
    <div class="subject"><a href="#post-45620">Offsets &amp; Addresses</a></div>
    <div class="body">Just got into asm a week or 2 ago, straight from Visual Basic, so all this memory stuff is still kinda hazy. I need a little clarification on what the relationship between addresses and offsets are, in my mind, an offset would be the location of a byte at a specified address, but somehow this doesnt seem the case, and im pretty sure that im going to need a much firmer grasp on address and offset handling/manipulation to get anywhere in asm. so any kind of feedback would be apreciated.<br /><br />    thx,<br /><br />kenji<br /><br /><strong>footnote</strong>: feel free to confuse me with example code :grin:</div>
    <div class="meta">Posted on 2002-06-28 14:49:55 by kenji</div>
   </div>
   <div class="post" id="post-45622">
    <div class="subject"><a href="#post-45622">Offsets &amp; Addresses</a></div>
    <div class="body">If you're talking about MASM's <strong><u>ADDR</u></strong> and <strong><u>OFFSET</u></strong> directives, then the difference is clear: <strong><u>ADDR</u></strong> is a macro (used with invoke) which automatically decides whether to use a direct offset or <strong>lea</strong> instruction for local variables (like <strong></strong>), since you can't do <strong>push OFFSET </strong>. <strong><u>OFFSET</u></strong> is a directive which puts in the address of a GLOBAL symbol as an immediate value, and such so it will not work on local variables.</div>
    <div class="meta">Posted on 2002-06-28 15:12:01 by comrade</div>
   </div>
   <div class="post" id="post-45624">
    <div class="subject"><a href="#post-45624">Offsets &amp; Addresses</a></div>
    <div class="body">ok, so in a sense, an offset is an address, and the ADDR macro simply recognizes wether the variable specified is local or global and handles it accordingly.<br /><br />mk got it.<br /><br />but then, whats the difference, i mean, i know the difference between global and local variables, but are they stored in different places? locals in the stack or what? im going through the motions, but id rather not just.<br /><br />thx<br /><br />kenji</div>
    <div class="meta">Posted on 2002-06-28 15:37:02 by kenji</div>
   </div>
   <div class="post" id="post-45626">
    <div class="subject"><a href="#post-45626">Offsets &amp; Addresses</a></div>
    <div class="body">locals are stored on the stack and have to be accessed using .<br />Globals are stored in the data section of your program and can be accesed using a file offset.</div>
    <div class="meta">Posted on 2002-06-28 15:57:43 by Kudos</div>
   </div>
   <div class="post" id="post-45628">
    <div class="subject"><a href="#post-45628">Offsets &amp; Addresses</a></div>
    <div class="body">For global variables, MASM already knows where they are and can insert a direct address. Local variables are relative to the stack, and stack offset is different at run-time, so MASM has no way of knowing its position during assembly time. Therefore, it uses <strong>lea</strong> instruction to reference local variables and places direct offsets for global variables.</div>
    <div class="meta">Posted on 2002-06-28 16:11:42 by comrade</div>
   </div>
   <div class="post" id="post-45631">
    <div class="subject"><a href="#post-45631">Offsets &amp; Addresses</a></div>
    <div class="body">surprisingly i understood every word of that.<br /><br />thx a bunch guys</div>
    <div class="meta">Posted on 2002-06-28 16:18:31 by kenji</div>
   </div>
  </div>
 </body>
</html>