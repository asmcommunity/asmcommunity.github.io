<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Interfacing a VB like scripting language to external DLLs via x86-64 ASM - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29685" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=22">Recruitment</a> &raquo; <a href="../?id=29685">Interfacing a VB like scripting language to external DLLs via x86-64 ASM</a></p>
   <div class="post" id="post-209577">
    <div class="subject"><a href="#post-209577">Interfacing a VB like scripting language to external DLLs via x86-64 ASM</a></div>
    <div class="body">Hi All,<br />We have an in-built VB like scripting language embedded in our Windows app. Since the scripting language is a fairly complete VB clone, it supports the VB &quot;Declare&quot; statement to interface to external DLLs. Of course this requires some ASM language glue to push the VB parameters on the stack for the call into the DLL etc.<br /><br />We need to go Windows 64-bit. I have ported the scripting language source to 64-bit and everything works fine.... except the &quot;Declare&quot; statement of course since the 32-bit &#039;glue&#039; code that interfaces the runtime and the DLL uses some inline x86 assembly - can&#039;t do that&nbsp; with the 64-bit compilers and of course the calling conventions are a bit different.<br /><br />So basically I have to take a function of about 150 lines that is a mix of C and 32-bit ASM and turn it into a x86-64 .ASM equivalent ( Visual Studio 2008)<br /><br />I think this is really pretty trivial for someone who knows their way around x86-64 assembly on Windows/Visual Studio - but that&#039;s not me! <br />And I know there are plenty of helpful people here who could probably tutor me to the point I might get this done.. but.... for any consultants out there ...we are prepared to pay someone to do this - but unfortunately as this has to be done through our regular accounting processes ( and a hard nosed accountant!) so you would need to have a registered business name and some references to show you know what you are doing. PM me.<br /><br /></div>
    <div class="meta">Posted on 2009-11-11 14:01:32 by AndrewC</div>
   </div>
   <div class="post" id="post-209580">
    <div class="subject"><a href="#post-209580">Re: Interfacing a VB like scripting language to external DLLs via x86-64 ASM</a></div>
    <div class="body">Good Luck. I&#039;m sure you&#039;ll find someone for this task here.</div>
    <div class="meta">Posted on 2009-11-11 14:07:58 by JimmyClif</div>
   </div>
   <div class="post" id="post-209581">
    <div class="subject"><a href="#post-209581">Re: Interfacing a VB like scripting language to external DLLs via x86-64 ASM</a></div>
    <div class="body">Well, I think you should drop the requirement of x86-64 asm. You can most probably do this in vanilla C with some pointer arithmetic and function pointer magic. Will make future maintenance far easier aswell.</div>
    <div class="meta">Posted on 2009-11-11 14:56:35 by Scali</div>
   </div>
   <div class="post" id="post-209587">
    <div class="subject"><a href="#post-209587">Re: Interfacing a VB like scripting language to external DLLs via x86-64 ASM</a></div>
    <div class="body"><div class="quote">I&#039;m sure you&#039;ll find someone for this task here.</div><br />Yeah, the task is easy, but the &quot;you need to have your own buisness registered&quot; part may be a problem.</div>
    <div class="meta">Posted on 2009-11-11 21:03:28 by ti_mo_n</div>
   </div>
  </div>
 </body>
</html>