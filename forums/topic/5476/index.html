<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Topmost tool - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5476" />
    <link rel="next" href="../?id=5476&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5476">Topmost tool</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=5476&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=5476&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="5476" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=5476&amp;page=2">&gt;</a><a href="../?id=5476&amp;page=2">&raquo;</a></form>   <div class="post" id="post-38871">
    <div class="subject"><a href="#post-38871">Topmost tool</a></div>
    <div class="body">Here is a *very* little program i wipped up, cause its been buggin me for a while.<br /><br />I want a tool to quickly turn on and off the WS_EX_TOPMOST style on certain windows... Mainly so i can have certain text in veiw while writing asm in my IDE.<br /><br />So i wipped this up quickly to suit my need.<br /><br />To use it:<br /><br />In the client aread, click and drag to the window you wish to modify.  Then let go of the left click button.  Then the window style is toggled of the window you let go on.  (pretty simple).<br /><br />You can also toggle the 'tool' itself by doing a quick click on the client area itself.<br /><br />Hope you like, i know i do ;)<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-05-19 01:46:27 by NaN</div>
   </div>
   <div class="post" id="post-38874">
    <div class="subject"><a href="#post-38874">Topmost tool</a></div>
    <div class="body"><strong>NaN</strong>, your tool doesn't work on Win2000.<br />To have it work on both win98 and win2k, use global hooking with a dll.<br /><br />Good idea, though.:alright:</div>
    <div class="meta">Posted on 2002-05-19 02:12:24 by C.Z.</div>
   </div>
   <div class="post" id="post-38877">
    <div class="subject"><a href="#post-38877">Topmost tool</a></div>
    <div class="body">Thats bizarre..<br /><br />I looked up the API's used and they are all 95 or above..??<br /><br />I assume your getting at the SetCapture and ReleaseCaputure api's failing on the NT boxes, or does the window even appear???<br /><br />NaN</div>
    <div class="meta">Posted on 2002-05-19 03:16:41 by NaN</div>
   </div>
   <div class="post" id="post-38878">
    <div class="subject"><a href="#post-38878">Topmost tool</a></div>
    <div class="body">NaN: doesn't work here either (win2k). However the window handle is correct, it just doesn't bring it to top. <br />I tried with Get/SetWindowLong as well:<br /><br /><pre><code><br />invoke GetWindowLong, hWND, GWL_EXSTYLE<br />xor    eax, WS_EX_TOPMOST<br />invoke SetWindowLong, hWND, GWL_EXSTYLE, eax<br /></code></pre><br /><br />But that didn't work either as it doesn't support Get/SetWindowLong on windows that do not belong to your process..<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-05-19 03:41:51 by Thomas</div>
   </div>
   <div class="post" id="post-38880">
    <div class="subject"><a href="#post-38880">Topmost tool</a></div>
    <div class="body">Ya, i tried Get/SetWindowLong as my first idea to get the job done, but win9x doesnt save the update, even tho GetLastError says it was done successfully.<br /><br />I dunno why the MSDN likes to omit these short comming with their NT os's. <br /><br />I use the online MSDN as its the most up to date.  And every API im using is &quot;ok&quot; to use. (grrrrrrrr).<br /><br />Im getting sick and tired of NT boxes &quot;surprising you&quot; with their lack of documentation.<br /><br />However, thanx for the feedback!<br />:rolleyes: NaN :rolleyes:</div>
    <div class="meta">Posted on 2002-05-19 03:52:20 by NaN</div>
   </div>
   <div class="post" id="post-38886">
    <div class="subject"><a href="#post-38886">Topmost tool</a></div>
    <div class="body">NaN, as far as I know SetWindowPos doens't apply on windows belonging to other processes under NT for security reasons. The best way to solve this is to inject your DLL into the target process using the hook functions.<br /><br />Another solution is to use WriteProcessMemory but that will be pretty ugly and can't work on win98.:)</div>
    <div class="meta">Posted on 2002-05-19 04:40:17 by C.Z.</div>
   </div>
   <div class="post" id="post-38889">
    <div class="subject"><a href="#post-38889">Topmost tool</a></div>
    <div class="body">BTW: one of the many things I always loved of my Amiga (the way I set it up, at least) was how it handled focus:<br /><br />a click gave focus, but didn't put the window to front<br />double click gave both focus and put the window to front<br /><br />Now if the Windows GUI could be &quot;modified&quot; to behave like that... NAN, could you write a tool that features just that?<br /><br />---<br /><br />Perhaps it's not intuitive how handy the above is unless one has been using it for years.<br />I think it's an abyss above the normal Windows GUI's way.</div>
    <div class="meta">Posted on 2002-05-19 04:57:22 by Maverick</div>
   </div>
   <div class="post" id="post-38891">
    <div class="subject"><a href="#post-38891">Topmost tool</a></div>
    <div class="body"><strong>Maverick</strong>: I suppose WindowBlinds from Stardock can accomplish this; it does a quite complete system patching.</div>
    <div class="meta">Posted on 2002-05-19 05:21:26 by C.Z.</div>
   </div>
   <div class="post" id="post-38925">
    <div class="subject"><a href="#post-38925">Topmost tool</a></div>
    <div class="body">Maverick, i dont really know, off hand i would say yes, but i have a feeling there will be catches with the WM_SETFOCUS message.<br /><br />The other catch of course is the SetWindowPos api that is 'less than fully suported' on NT boxes.  If there is a clearner solution i will implement it for ya's, but as a (becoming and ever so faithful) win9x fan, i dont really want to get into DLL's and HOOK's just to do somthing simple.<br /><br />:NaN:</div>
    <div class="meta">Posted on 2002-05-19 15:00:27 by NaN</div>
   </div>
   <div class="post" id="post-38992">
    <div class="subject"><a href="#post-38992">Topmost tool</a></div>
    <div class="body"><div class="quote"><br /><strong>Maverick</strong>: I suppose WindowBlinds from Stardock can accomplish this; it does a quite complete system patching. </div>Thank you for your suggestion.. but after having veryfied, I saw it doesn't support this (nice prog anyway).<br /><br />NaN: Well, if you can I'd appreciate it much, otherwise.. neverminds. ;)</div>
    <div class="meta">Posted on 2002-05-20 07:07:50 by Maverick</div>
   </div>
   <div class="post" id="post-39017">
    <div class="subject"><a href="#post-39017">Topmost tool</a></div>
    <div class="body">Ya nice idea.  I tried this once but never followed up on it.  You could always use SetForegroundWindow cause it works no matter the thread, but you will run into focus problems I am sure.<br />:rolleyes:</div>
    <div class="meta">Posted on 2002-05-20 11:03:17 by Graebel</div>
   </div>
   <div class="post" id="post-39044">
    <div class="subject"><a href="#post-39044">Topmost tool</a></div>
    <div class="body">Well I've been running around like a madman all day and have just now been able to relax.  I just skimmed through this thread so maybe this won't help at all, but here goes anyways....  :)<br /><br />A while back I was doing something similar to this and I only tested it on a win2k box.  Iirc the prog in question was a macro program that I never did get around to finishing.  Anyways I switched from using the drag n drop cursor to select the right edit control and instead chose to use system wide hotkeys.  There was some problem using GetFocus (I think that was the one) on windows in other threads.  So I ended up using AttachThreadInput which worked.  I'm not sure how clean of a solution that is but....<br /><br />Anyways maybe this is of no use because I just skimmed through this thread, and maybe I completely misunderstood the problem.</div>
    <div class="meta">Posted on 2002-05-20 14:43:48 by Will</div>
   </div>
   <div class="post" id="post-39383">
    <div class="subject"><a href="#post-39383">Topmost tool</a></div>
    <div class="body">Works here on win2000, but only if the window is restored (not maximized).</div>
    <div class="meta">Posted on 2002-05-22 12:55:48 by grv575</div>
   </div>
   <div class="post" id="post-39386">
    <div class="subject"><a href="#post-39386">Topmost tool</a></div>
    <div class="body">Worx fine under my XP, regardless of window state (maximized or normal)<br />cool:)</div>
    <div class="meta">Posted on 2002-05-22 13:15:05 by drojid</div>
   </div>
   <div class="post" id="post-39391">
    <div class="subject"><a href="#post-39391">Topmost tool</a></div>
    <div class="body">Oh!  So its just win NT that has the problem... hmm.. Perhaps it was tested on a restored window as well??<br /><br />Oh well,  i never liked that os anyways ;)<br /><br />:NaN:</div>
    <div class="meta">Posted on 2002-05-22 13:30:52 by NaN</div>
   </div>
   <div class="post" id="post-39400">
    <div class="subject"><a href="#post-39400">Topmost tool</a></div>
    <div class="body">Works fine here on win2k, and quite as expected... the topmost<br />state can only be set if the window is foreground window. This<br />might seem a bit weird, but on NT systems (and iirc also 98 and up?)<br />you're not supposed to push yourself to the foreground unless<br />you're the active app the user is working with. There might be a<br />way to make a non-foreground window topmost, I'm currently<br />looking into it.</div>
    <div class="meta">Posted on 2002-05-22 14:58:21 by f0dder</div>
   </div>
   <div class="post" id="post-39401">
    <div class="subject"><a href="#post-39401">Topmost tool</a></div>
    <div class="body">Hm, seems that it even works for background windows, however<br />you have to be pretty careful when selecting the window - you<br />can't make a window topmost by dragging to the child of a window,<br />you have to end on the titlebar or menu bar. This could probably<br />be resolved by doing some GetParent calls...</div>
    <div class="meta">Posted on 2002-05-22 15:14:22 by f0dder</div>
   </div>
   <div class="post" id="post-39404">
    <div class="subject"><a href="#post-39404">Topmost tool</a></div>
    <div class="body">Give this version a go. So much for the &quot;shortcomings of NT&quot; :rolleyes:</div>
    <div class="meta">Posted on 2002-05-22 15:24:25 by f0dder</div>
   </div>
   <div class="post" id="post-39447">
    <div class="subject"><a href="#post-39447">Topmost tool</a></div>
    <div class="body">Thanx f0dder, always somthing to be learnt from you ;)<br /><br />I see you like labels over @@'s, as well ;)<br /><br />PS: I know you always recommending against merging sections, its just that it is set as a default to keep file size down.  I never really think about it to be honest ;)<br /><br />:NaN:</div>
    <div class="meta">Posted on 2002-05-23 00:15:42 by NaN</div>
   </div>
   <div class="post" id="post-39476">
    <div class="subject"><a href="#post-39476">Topmost tool</a></div>
    <div class="body"><strong>NaN</strong>, sorry for having reported the wrong info. It works pretty fine under win2k, very handy tool.<br /><br />One thing I don't understand is the windows of NetCaptor and Outlook, etc, can't become topmost with your tool, while others like Notepad and Winrar can. (that's where my previous wrong conclusion originated, forgive my being careless. :grin: )</div>
    <div class="meta">Posted on 2002-05-23 04:31:46 by C.Z.</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=5476&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=5476&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="5476" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=5476&amp;page=2">&gt;</a><a href="../?id=5476&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>