<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Combine dll and an exe - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22542" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22542">Combine dll and an exe</a></p>
   <div class="post" id="post-169097">
    <div class="subject"><a href="#post-169097">Combine dll and an exe</a></div>
    <div class="body">Does anyone know how to combine a dll and an exe and also how to access the procedures in the dll after doing so..</div>
    <div class="meta">Posted on 2005-12-23 11:06:19 by lone_samurai5</div>
   </div>
   <div class="post" id="post-169099">
    <div class="subject"><a href="#post-169099">Re: Combine dll and an exe</a></div>
    <div class="body">Quite strange idea, but...<br /><br />1) you can store the DLL inside the exe and extract it at runtime (save-&gt;load-&gt;use-&gt;uload-&gt;delete)<br />2) knowing the base of the data segment you can manually relocate the references inside the DLL, but that must be a nightmare to do :P<br /><br />BTW: what&#39;s the use of it?</div>
    <div class="meta">Posted on 2005-12-23 11:39:51 by ti_mo_n</div>
   </div>
   <div class="post" id="post-169100">
    <div class="subject"><a href="#post-169100">Re: Combine dll and an exe</a></div>
    <div class="body">What at just you want to do ?<br /><br />Because to use a dll with MASMv8.0 it is all simple...(one uses LoadLibrary...see <br />Folder EXAMPLE1\DLL of MASM8.zip)<br /><br />To put export function in an EXE it works well with <strong>GoAsm</strong>....<br /><br />With GoAsm in asm file it is sufficient to add a line <br />EXPORT NAmeOfFunct<br /><br />Then to compile like an EXE...<br /><br />----<br />Gerard</div>
    <div class="meta">Posted on 2005-12-23 11:42:16 by gerard</div>
   </div>
   <div class="post" id="post-169102">
    <div class="subject"><a href="#post-169102">Re: Combine dll and an exe</a></div>
    <div class="body">Yeah i guess its a strange thing to do, but i was jus wondering how i can do somethin like that.. To tell u the truth i really can&#39;t think of much use for it.. Guess i&#39;m jus a lil curious bout strange stuff.. :P<br /><br /><div class="quote"><br />1) you can store the DLL inside the exe and extract it at runtime (save-&gt;load-&gt;use-&gt;uload-&gt;delete)<br />2) knowing the base of the data segment you can manually relocate the references inside the DLL, but that must be a nightmare to do Tongue<br /></div><br />Thanx, I&#39;ll try doin that now.. bout the 2nd point :shock:, any chance that someone has some code showin how somethin like this can be done<br /><br />Gerard, I don&#39;t think u understood my question.. :|</div>
    <div class="meta">Posted on 2005-12-23 13:03:43 by lone_samurai5</div>
   </div>
   <div class="post" id="post-169103">
    <div class="subject"><a href="#post-169103">Re: Combine dll and an exe</a></div>
    <div class="body">I gonna to repeat me...<br /><br />With <strong>GoAsm</strong> one can export Function in an <strong>EXE</strong> file...<br /><br />It is sufficient to put this line ....at the beginning of asm file....<br /><br />and to complile this asm file like a normal EXE file...<br /><br />File.asm<br /><br /><div class="quote"><span style="font-size:10pt>EXPORTS NameOfFunction1,NameOfFunction2...</span></div><br /><br /><br />Thenb in a batch file<br /><br /><br /><div class="quote"><span style="font-size:10pt>GoAsm&nbsp; File.asm<br />GoLink File.obj&nbsp; &nbsp; kernel32.dll user32.dll</span></div><br /><br /><br />Good Enjoy...<br /><br />----<br />Gerard<br /> </div>
    <div class="meta">Posted on 2005-12-23 13:12:57 by gerard</div>
   </div>
   <div class="post" id="post-169104">
    <div class="subject"><a href="#post-169104">Re: Combine dll and an exe</a></div>
    <div class="body">Well this is what i first did, I added this to the rc file, <br />RCDATA DISCARDABLE &quot;hver.dll&quot;, the dll was part of the exe. But i don&#39;t know how to use the procedures from the dll in the exe.. Any ideas???</div>
    <div class="meta">Posted on 2005-12-23 13:32:46 by lone_samurai5</div>
   </div>
   <div class="post" id="post-169105">
    <div class="subject"><a href="#post-169105">Re: Combine dll and an exe</a></div>
    <div class="body">No you don&#39;t need to import the dll into resource file with <strong>GoAsm</strong>....<br /><br /><strong>WITH GOASM IT IS AL&nbsp; SIMPLE</strong><br /><br />When you have your Function in your EXE you have to use the following <strong>API</strong>...<br /><br /><em><strong>LoadLibrary</strong></em>....and <em><strong>GetPrpcAddress....</strong></em>like you will do with a <strong>DLL<strong>...<br /><br />-----<br />Gerard</div>
    <div class="meta">Posted on 2005-12-23 13:37:27 by gerard</div>
   </div>
   <div class="post" id="post-169106">
    <div class="subject"><a href="#post-169106">Re: Combine dll and an exe</a></div>
    <div class="body">Gerard i know i can do it that way, but i wanna try doin it this way, if its possible. Oh and don&#39;t ask me why..? :P</div>
    <div class="meta">Posted on 2005-12-23 13:52:34 by lone_samurai5</div>
   </div>
   <div class="post" id="post-169107">
    <div class="subject"><a href="#post-169107">Re: Combine dll and an exe</a></div>
    <div class="body">lone_samurai5,<br /><br />I guess you want to have your dll mapped and initialized in the context of other process?<br />If so there is one way more - use hooks. You can map not only a dll but an exe also!!! </div>
    <div class="meta">Posted on 2005-12-23 14:24:03 by k3Eahn</div>
   </div>
   <div class="post" id="post-169108">
    <div class="subject"><a href="#post-169108">Re: Combine dll and an exe</a></div>
    <div class="body">I guess it&#39;s called static linking, don&#39;t know much about it, but have one task for future: integrate SciLexer.dll (scintilla) into my exe file. Hope someone will be faster than me and figure this mystery out...(specifically how can this be done with masm32)...If static linking means integrate every library (including user..kernel..gdi..) into binary file, there have to be a way to integrate only one</div>
    <div class="meta">Posted on 2005-12-23 14:32:25 by ramguru</div>
   </div>
   <div class="post" id="post-169109">
    <div class="subject"><a href="#post-169109">Re: Combine dll and an exe</a></div>
    <div class="body">K3eahn, How do u use hooks to map dlls or exe&#39;s? Can u temme a lil bout it or if u have some code can u post it?</div>
    <div class="meta">Posted on 2005-12-23 14:42:45 by lone_samurai5</div>
   </div>
   <div class="post" id="post-169111">
    <div class="subject"><a href="#post-169111">Re: Combine dll and an exe</a></div>
    <div class="body">lone_samurai5,<br /><br />You can embed DLLs to your executables :<br /><br />http://www.asmcommunity.net/board/index.php?topic=22308.0<br /></div>
    <div class="meta">Posted on 2005-12-23 15:40:46 by Vortex</div>
   </div>
   <div class="post" id="post-169112">
    <div class="subject"><a href="#post-169112">Re: Combine dll and an exe</a></div>
    <div class="body">ramguru, k3Eahn, lone_samurai5:<br /><br />Static linking is something different from running a DLL from inside an EXE, and this is different from mapping something in the context of other processes :P So either I don&#39;t understand something, or you guys misunderstand each other :mrgreen:<br /><br />static linking is putting a binary code to an exe like an ordinary procedure. actually that&#39;s what linker does when it links different .obj files.<br /><br />dynamic linking is when a dll is loaded into process&#39; address space and its references are &#39;resolved&#39; so they point to proper places (in data, for example).<br /><br />if you have a binary dll inside your exe, you have to move it at some location and fix its references (a.k.a &#39;you have to relocate it&#39;). then, when you jump to 1 of its functions, it will behave as desired. it&#39;s a difficult thing to do, because you have to know DLL&#39;s structure and know how to fix the references inside it. Normally you do such things when you write OSes.<br /><br />Vortex: that&#39;s exactly what lone_samurai5 needs ;) (if I understood everything correctly that is :mrgreen: )</div>
    <div class="meta">Posted on 2005-12-23 15:46:09 by ti_mo_n</div>
   </div>
   <div class="post" id="post-169113">
    <div class="subject"><a href="#post-169113">Re: Combine dll and an exe</a></div>
    <div class="body">All I was saying is just that I don&#39;t know much about it and hope that someone will show us the right way. Thanks Vortex, I was playing with your code earlier but I didn&#39;t realized its main purpose. Now I certainly use it!</div>
    <div class="meta">Posted on 2005-12-23 16:16:49 by ramguru</div>
   </div>
   <div class="post" id="post-169114">
    <div class="subject"><a href="#post-169114">Re: Combine dll and an exe</a></div>
    <div class="body"><strong>ramguru</strong>, if there isn&#39;t a static version of scintilla, it shouldn&#39;t be too hard to recompile it for static linkage...<br /><br /><br /><div class="quote"><br />K3eahn, How do u use hooks to map dlls or exe&#39;s? Can u temme a lil bout it or if u have some code can u post it?<br /></div><br />So, why do you need it? :)<br /></div>
    <div class="meta">Posted on 2005-12-23 16:42:27 by f0dder</div>
   </div>
   <div class="post" id="post-169115">
    <div class="subject"><a href="#post-169115">Re: Combine dll and an exe</a></div>
    <div class="body">f0dder, please be nice and explain what should I do :)<br />from scintilla doc:<br />;--------<br />Static linking<br /><br />On Windows, Scintilla is normally used as a dynamic library as a .DLL file. If you want to link Scintilla directly into your application .EXE or .DLL file, then the STATIC_BUILD preprocessor symbol should be defined and Scintilla_RegisterClasses called. STATIC_BUILD prevents compiling the DllMain function which will conflict with any DllMain defined in your code. Scintilla_RegisterClasses takes the HINSTANCE of your application and ensures that the &quot;Scintilla&quot; window class is registered....blabla<br />;--------<br />I&#39;m able to recompile scintilla (have MinGW etc.), I&#39;ve even changed one lexer to suit my wishes. But the prob is what does it mean static linking, do I have to point an exe for dll to be linked into, or does it mean only that I&#39;m able to include scintilla.h in other C++ like project..I&#39;m totally new here</div>
    <div class="meta">Posted on 2005-12-23 16:56:38 by ramguru</div>
   </div>
   <div class="post" id="post-169128">
    <div class="subject"><a href="#post-169128">Re: Combine dll and an exe</a></div>
    <div class="body"><div class="quote"><br />lone_samurai5,<br /><br />You can embed DLLs to your executables :<br /><br />http://www.asmcommunity.net/board/index.php?topic=22308.0<br /></div><br />Thanx just what i was looking for... :D<br /><br /><div class="quote"><br />So, why do you need it? :)<br /></div><br />I&#39;d tell u, but then i would have to kill u :P</div>
    <div class="meta">Posted on 2005-12-24 00:24:31 by lone_samurai5</div>
   </div>
  </div>
 </body>
</html>