<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Browse For Folder Problem. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27020" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27020">Browse For Folder Problem.</a></p>
   <div class="post" id="post-194206">
    <div class="subject"><a href="#post-194206">Browse For Folder Problem.</a></div>
    <div class="body">I am using the Masm32.lib and trying to
use the BrowseForFolder Proc, on compiling
it comes up with an error, unresolved external
symbol CoTaskMemFree@4 why is this? I have included
all the INC's and LIB's that it says to in the
Example code given by Iczelion's dialogs demo.

I made a project from scratch using Prostart
then added the LIBs that it said was needed
then just put the one line:
 invoke BrowseForFolder,hWin, lpBuffer, lpTitle, lpString
and I get that error, when I take out this line the program
compiles correctly. I have masm32.lib included and the masm32.inc with shell32 and condlg32 stuff in it as well.

Can anyone shed anylight on what is wrong here?</div>
    <div class="meta">Posted on 2001-02-25 11:49:00 by Zcoder</div>
   </div>
   <div class="post" id="post-194207">
    <div class="subject"><a href="#post-194207">Browse For Folder Problem.</a></div>
    <div class="body">CoTaskMemFree is defined in ole32.inc. You need include that and it's library.</div>
    <div class="meta">Posted on 2001-02-25 12:24:00 by Ernie</div>
   </div>
   <div class="post" id="post-194208">
    <div class="subject"><a href="#post-194208">Browse For Folder Problem.</a></div>
    <div class="body">I have ole32.inc in my source
I forgot to mention that one.
also the error says masm32.obj as the
file that has the problem.</div>
    <div class="meta">Posted on 2001-02-25 13:08:00 by Zcoder</div>
   </div>
   <div class="post" id="post-194209">
    <div class="subject"><a href="#post-194209">Browse For Folder Problem.</a></div>
    <div class="body">I believe masm32.obj is the masm32 library. Try rebuilding it (just double click the make.bat file in MASM32\M32LIB)</div>
    <div class="meta">Posted on 2001-02-25 13:44:00 by Ernie</div>
   </div>
   <div class="post" id="post-194210">
    <div class="subject"><a href="#post-194210">Browse For Folder Problem.</a></div>
    <div class="body">ok I rebuilt Masm32 it went
smothly, but I still get the same error
on the Masm32.obj witch is the masm32.lib
I don't understand it, I cam compile the example
unsing this same lib, I have made sure I have
everything that the example has in it, almost
to the point where if I go any farther I will
have made the same example. LOL this is not adding up.
I also found a problem while trying to fix this
program and it is with the new windows.inc, other
programs I have written won't compile right with
the new windows.inc</div>
    <div class="meta">Posted on 2001-02-25 14:58:00 by Zcoder</div>
   </div>
   <div class="post" id="post-194211">
    <div class="subject"><a href="#post-194211">Browse For Folder Problem.</a></div>
    <div class="body">Zcoder,

The code in MASM32  v6 and the service pack were built around the
version of windows.inc that came with MASM32v6. Until the later
versions can be successfully debugged so they are compatible with
the code that people have built with the earlier versions, I would
recommend using the release version from MASM32v6.

The BrowseForFolder proc should be very reliable as it was tested
extensively before it was released.

Regards,

hutch@pbq.com.au</div>
    <div class="meta">Posted on 2001-02-25 15:08:00 by hutch--</div>
   </div>
  </div>
 </body>
</html>