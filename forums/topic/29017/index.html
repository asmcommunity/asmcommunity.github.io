<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>creating win32 api == ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29017" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=113">Low Level Concepts</a> &raquo; <a href="../?id=29017">creating win32 api == ?</a></p>
   <div class="post" id="post-205023">
    <div class="subject"><a href="#post-205023">creating win32 api == ?</a></div>
    <div class="body">How can I implement win32 functions of my own without using win32 or native api ? <br /><br />I want to do this because while researching on AVs and viruses I read about some viruses that emulate win32 api, that is, they implement win32 like functions on their own to evade AVs. Unfortunately, the book did&#039;nt mention the names of any such virus. Please answer to above question or give me the name of any viruses that do the same.<br /><br />Thanks.</div>
    <div class="meta">Posted on 2008-03-25 23:48:14 by shakuni</div>
   </div>
   <div class="post" id="post-205024">
    <div class="subject"><a href="#post-205024">Re: creating win32 api == ?</a></div>
    <div class="body">some are easily implimented (like lstrlen and so on), others are much harder (like hmm VirtualAlloc for example)<br />i seriously doubt a virus emulated all win32 api&#039;s.. others &#039;emulate&#039; by calling the ntdll variant of the api instead<br />of the kernel32 one etc..</div>
    <div class="meta">Posted on 2008-03-26 07:22:25 by evlncrn8</div>
   </div>
   <div class="post" id="post-205025">
    <div class="subject"><a href="#post-205025">Re: creating win32 api == ?</a></div>
    <div class="body">You don&#039;t get much lower than NTDLL or, alternatively (and even more problematic), syscalls.</div>
    <div class="meta">Posted on 2008-03-26 19:35:18 by f0dder</div>
   </div>
   <div class="post" id="post-205140">
    <div class="subject"><a href="#post-205140">Re: creating win32 api == ?</a></div>
    <div class="body">Well, more likely they are hooking the APIs and intercepting any threats to the virus before calling the actual API function. This is more impersonation than implementation.</div>
    <div class="meta">Posted on 2008-04-20 15:41:49 by donkey</div>
   </div>
   <div class="post" id="post-206706">
    <div class="subject"><a href="#post-206706">Re: creating win32 api == ?</a></div>
    <div class="body">U can modify or add SSDT(system service dispatch table), all system call address is here, this is real system service.<br /></div>
    <div class="meta">Posted on 2009-01-13 07:20:10 by mnzn2530</div>
   </div>
   <div class="post" id="post-206709">
    <div class="subject"><a href="#post-206709">Re: creating win32 api == ?</a></div>
    <div class="body">ssdt is ring 0 if i recall right, requiring you to write a driver...</div>
    <div class="meta">Posted on 2009-01-13 09:16:29 by evlncrn8</div>
   </div>
   <div class="post" id="post-208381">
    <div class="subject"><a href="#post-208381">Re: creating win32 api == ?</a></div>
    <div class="body">you might get the entry of a function and modify:<br />(the first line of an api function)<br />push ebp<br />mov ebp,esp<br />to:<br />jmp/call yourfunction<br /><br />!! you must jump back when your function is over....<br /></div>
    <div class="meta">Posted on 2009-08-07 10:50:04 by asmdna</div>
   </div>
  </div>
 </body>
</html>