<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Screenshot of invisible Window - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5978" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5978">Screenshot of invisible Window</a></p>
   <div class="post" id="post-42807">
    <div class="subject"><a href="#post-42807">Screenshot of invisible Window</a></div>
    <div class="body">Hi!<br /><br />I am not at my dev machine now, so I can't try it<br />myself. Is it possible to make a screenshot of a <br />invisible Window? I mean a Window wich is hide<br />via<br /><br /><pre><code><br />invoke ShowWindow, hWnd, SW_HIDE<br /></code></pre><br /><br />? If I remember correct, I just get the visible part<br />in the area of the invisible Window... (ex: the desktop) ?!<br /><br />Thanks in advance,<br />bAZiK</div>
    <div class="meta">Posted on 2002-06-12 03:24:51 by bazik</div>
   </div>
   <div class="post" id="post-42820">
    <div class="subject"><a href="#post-42820">...</a></div>
    <div class="body">Hi !<br /><br /> Did you try GetDCEx ???<br /><br />HDC GetDCEx(<br />  HWND hWnd,      // handle to window<br />  HRGN hrgnClip,  // handle to clipping region<br />  DWORD flags     // creation options<br />);<br /><br />with flags = DCX_WINDOW<br /><br />As far as I remember it works... :rolleyes: <br /><br />Hope it help !</div>
    <div class="meta">Posted on 2002-06-12 05:08:39 by PhoBos</div>
   </div>
   <div class="post" id="post-42830">
    <div class="subject"><a href="#post-42830">Screenshot of invisible Window</a></div>
    <div class="body">Hmmm... I think you got me wrong. Let me explain it in detail:<br /><br />My App shells a external App. This external App does some calculations and displays the result as a Graph on the Window. I take a screenshot of the Window, resize it and save it as JPEG.<br />Then I terminate the App again with WM_CLOSE.<br /><br />My target is, to create the screenshot WITHOUT showing the App I shell. That means, I execute it with SW_HIDE style, and do the rest as normal. <br /><br />As already said, I am not at home right now... but I want this finished today, so I would appreciate any answer.<br /><br />Showing the App only for the time I take the screenshot it NOT an option :(<br /><br />regards,<br />bAZiK</div>
    <div class="meta">Posted on 2002-06-12 06:15:51 by bazik</div>
   </div>
   <div class="post" id="post-42835">
    <div class="subject"><a href="#post-42835">Screenshot of invisible Window</a></div>
    <div class="body">I don't know if if it will work but why not resize your &quot;shell&quot; window to a 0*0 size ?<br /><br />It won't help much, if you don't want to have the program on the taskbar, though... (but I assume it can be disabled by an API... don't know which, though)</div>
    <div class="meta">Posted on 2002-06-12 07:07:03 by JCP</div>
   </div>
   <div class="post" id="post-42837">
    <div class="subject"><a href="#post-42837">Screenshot of invisible Window</a></div>
    <div class="body"><div class="quote"><br />I don't know if if it will work but why not resize your &quot;shell&quot; window to a 0*0 size ?<br /></div><br /><br />This would give me a 0*0 pixel screenshot.</div>
    <div class="meta">Posted on 2002-06-12 07:10:38 by bazik</div>
   </div>
   <div class="post" id="post-42839">
    <div class="subject"><a href="#post-42839">Screenshot of invisible Window</a></div>
    <div class="body">that was I was afraid of... :(<br />At this moment, I don't see any way of doing it...<br /><br />How long takes your screen capture ?<br /><br />If it is long or if we see the window for a small amount of time, you could mask it with a splashscreen saying something like : &quot;Generating Graph&quot;...<br />It is a bad way for sure, but right now, I don't have any other idea...</div>
    <div class="meta">Posted on 2002-06-12 07:17:26 by JCP</div>
   </div>
   <div class="post" id="post-42840">
    <div class="subject"><a href="#post-42840">But...</a></div>
    <div class="body">And what about put your window outside the visible desktop area and let it visible?<br />with MoveWindow hWnd,2000,2000,NULL,NULL,FALSE<br /><br /> ??? :confused: ???</div>
    <div class="meta">Posted on 2002-06-12 07:18:02 by PhoBos</div>
   </div>
   <div class="post" id="post-42841">
    <div class="subject"><a href="#post-42841">Screenshot of invisible Window</a></div>
    <div class="body">That is a better idea, it might work...<br /><br />I can't test it, as I'm not on my dev machine too... ;)</div>
    <div class="meta">Posted on 2002-06-12 07:19:57 by JCP</div>
   </div>
   <div class="post" id="post-42842">
    <div class="subject"><a href="#post-42842">Screenshot of invisible Window</a></div>
    <div class="body">PhoBos,<br />yes, this would work, but I want a *clean* way.<br />Seems like I must just try what GetDC and StrechBlt give me from a Window with SW_HIDE. Perhaps I did something wrong last time...<br /><br />Readiosys,<br />look the last sentance of my second reply:<br />&gt;Showing the App only for the time I take the screenshot it NOT an option   :(<br /><br /><br /><br />:(</div>
    <div class="meta">Posted on 2002-06-12 07:21:12 by bazik</div>
   </div>
   <div class="post" id="post-42844">
    <div class="subject"><a href="#post-42844">Screenshot of invisible Window</a></div>
    <div class="body"><div class="quote"><br />&gt;Showing the App only for the time I take the screenshot it NOT an option<br /></div><br /><br />Yes, but <strong>how long</strong> your screenshot function take or more exactly, how much time do you need the window to be displayed ?<br /><br />If showing the window is not an option, you are wanting something you say as impossible because you don't want to show it...<br />There's a conflict in the question.<br /><br />I'm not sure, but it might be a way to do it without showing the window...<br />Ask the GDI specialists (and I'm not one) :<br /><br />news:microsoft.public.win32.programmer.gdi</div>
    <div class="meta">Posted on 2002-06-12 07:25:51 by JCP</div>
   </div>
   <div class="post" id="post-58721">
    <div class="subject"><a href="#post-58721">Question to bazik</a></div>
    <div class="body">Bazik, did you managed to get it to work? <br /><br />I'm seeking to do the same thing. I tried to move the window at -2000, -2000, but it didn't work for me. <br /><br />I'm trying to fetch the rtf output and put it into a bmp for a dynamic wallpaper. I want to update it every x minutes with up to date info, but putting some window in front every count of timer isn't good...<br /><br />Thanks</div>
    <div class="meta">Posted on 2002-09-19 15:38:49 by Silas</div>
   </div>
   <div class="post" id="post-58722">
    <div class="subject"><a href="#post-58722">Screenshot of invisible Window</a></div>
    <div class="body">GDI will not draw outside the area coverted by the destop window (or virtual desktop window). Thus even if you move the window outside the desktop you will not get a screenshot.<br /><br />Since GDI only use 1 video page, i dont see how you could get a screenshot of the window without showing it.</div>
    <div class="meta">Posted on 2002-09-19 15:47:33 by dxantos</div>
   </div>
   <div class="post" id="post-58727">
    <div class="subject"><a href="#post-58727">Screenshot of invisible Window</a></div>
    <div class="body">I couldnt get it working and just blocked mouse and keyboard while the window showed up.</div>
    <div class="meta">Posted on 2002-09-19 16:11:45 by bazik</div>
   </div>
   <div class="post" id="post-58729">
    <div class="subject"><a href="#post-58729">Screenshot of invisible Window</a></div>
    <div class="body">Thanks, in that case, I'll have to forget about a few ideas I had. <br /><br />Perhaps I could display the rich text box directly on the desktop, but I fear that either the icons will come in conflict with the display, I won't be able to create the window directly on the desktop or it will show in front of other windows when I'll update it.<br /><br />Let's go back to the drawing board...</div>
    <div class="meta">Posted on 2002-09-19 16:19:16 by Silas</div>
   </div>
   <div class="post" id="post-58736">
    <div class="subject"><a href="#post-58736">Screenshot of invisible Window</a></div>
    <div class="body">bazik,<br />you obviously have a fair amount of control over the app you spawn, is it your app? If it is your app, why don't you modify it so you can supply a command line telling it to remain invisible, it can then draw its picture, and return a dc to the main app?</div>
    <div class="meta">Posted on 2002-09-19 17:14:04 by sluggy</div>
   </div>
   <div class="post" id="post-58790">
    <div class="subject"><a href="#post-58790">Screenshot of invisible Window</a></div>
    <div class="body">sluggy,<br />thanks for the input, but I already sold the app and don't care anymore about it ;)</div>
    <div class="meta">Posted on 2002-09-20 00:43:46 by bazik</div>
   </div>
  </div>
 </body>
</html>