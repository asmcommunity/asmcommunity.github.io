<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Manipulating Strings -=\ Still dont get it - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9673" />
    <link rel="next" href="../?id=9673&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9673">Manipulating Strings -=\ Still dont get it</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=9673&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=9673&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="9673" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=9673&amp;page=2">&gt;</a><a href="../?id=9673&amp;page=2">&raquo;</a></form>   <div class="post" id="post-71748">
    <div class="subject"><a href="#post-71748">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">ok, i have been trying to get down strings for a very long time. the other day i got a tutorial on strings from NOP-erator's Assembly World - great site.<br /><br />well, anyway i read it and thought i understood it apparently i didnt because usually when i try to manipulate strings. i usually crash the app,get output of strange characters that weren't in the string in the first place or recieve nothing at all. This is amazingly frustrating to me.<br /><br />if anyone knows of any good tutorials or maybe something graphical that would be good for teaching a complete moron. lol.  They would be greatly appreciated.<br /><br />Thank You,<br /><br />       HeXeN :confused:</div>
    <div class="meta">Posted on 2002-12-19 04:21:53 by HeXeN</div>
   </div>
   <div class="post" id="post-71754">
    <div class="subject"><a href="#post-71754">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">hmmm .... Post your Qn here then. Btw.. It crashs becoz of the pointer error or because you overwrite the allocated buffer.</div>
    <div class="meta">Posted on 2002-12-19 04:35:51 by roticv</div>
   </div>
   <div class="post" id="post-71758">
    <div class="subject"><a href="#post-71758">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">What kind of manipulation are you interested in?<br />How far have you got at the moment?<br /><br />There are two kinds of strings supported in windows, ASCII, and UNICODE.<br />ASCII supports 255 characters, and a terminator. Hence each element of the string is 1 byte in size (8 bits).<br />UNICODE supports 65535 characters + a terminator. Each character takes 2 bytes (1 word, or 16 bits), and is used in NT. It gives a much bigger range of characters, and so is useful when dealing with languages which do not use the standard &quot;western&quot; alphabet.<br /><br />You should try to work out which you are dealing with, obviously writing an ASCII string over a UNICODE string will cause problems (and similarly vice versa)!<br /><br />Mirno</div>
    <div class="meta">Posted on 2002-12-19 04:41:23 by Mirno</div>
   </div>
   <div class="post" id="post-71760">
    <div class="subject"><a href="#post-71760">....</a></div>
    <div class="body">why don't i recieve any out even remotely close to the string mostly is my question.<br /><br />im trying to do any string manipulation that will give me atleast part of the string atleast then ill know im on the right path.<br /><br />-HeXeN</div>
    <div class="meta">Posted on 2002-12-19 04:47:27 by HeXeN</div>
   </div>
   <div class="post" id="post-71762">
    <div class="subject"><a href="#post-71762">..</a></div>
    <div class="body">btw im one of those visual basic programmers most people don't like. im used to the high level languages.<br /><br />-HeXeN</div>
    <div class="meta">Posted on 2002-12-19 04:48:54 by HeXeN</div>
   </div>
   <div class="post" id="post-71768">
    <div class="subject"><a href="#post-71768">Re: ..</a></div>
    <div class="body"><div class="quote"><br />btw im one of those visual basic programmers most people don't like. im used to the high level languages.</div><strong><span style="font-size:120>You're being surrounded.. SURRENDER OR DIE!!!</span></strong><br /><br />:eek:  <img src="http://www.bhra.org.uk/graphics/smilies/gold_circular_bold_std/rifle.gif" /></div>
    <div class="meta">Posted on 2002-12-19 05:49:54 by Maverick</div>
   </div>
   <div class="post" id="post-71770">
    <div class="subject"><a href="#post-71770">Re: Re: ..</a></div>
    <div class="body"><div class="quote"><br /><strong>You're being surrounded.. SURRENDER OR DIE!!!</strong><br /><br />:eek:  <img src="http://www.bhra.org.uk/graphics/smilies/gold_circular_bold_std/rifle.gif" /> </div><br />lol... and the good thing is - those vb programmers can't even run away from us, cause they're so damn slow :grin: <br /><br />hexen, why don't you post some source of yours we'll have a look.</div>
    <div class="meta">Posted on 2002-12-19 06:05:33 by Tola</div>
   </div>
   <div class="post" id="post-71779">
    <div class="subject"><a href="#post-71779">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">HeXen strings aren't really anything special...they're just a sequence of bytes(words if unicode).<br /><br />All string functions will take a pointer to the string.<br />If you aren't getting what you expected then you should check  one of the following :<br /><br />1)you do not have a pointer to the string ...<br /><br />2)the string data isn't initialised...<br /><br /><strong>3)you're expecting the wrong thing! :grin: (all bugs WILL be solved):grin: </strong><br /><br />in most cases the problem is 1.<br />Anyway here's a small radasm project which should ge you going.  It doesn't use any exotic instructions just the basic mov.<br />It will  reverse and capatilise an input string.<br /><br />Hope it helps you.<br /><br /><br />Damn! I forgot to attached the file.  Check post below:rolleyes:</div>
    <div class="meta">Posted on 2002-12-19 07:25:21 by MArtial_Code</div>
   </div>
   <div class="post" id="post-71782">
    <div class="subject"><a href="#post-71782">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">Here it is..</div>
    <div class="meta">Posted on 2002-12-19 07:27:49 by MArtial_Code</div>
   </div>
   <div class="post" id="post-71793">
    <div class="subject"><a href="#post-71793">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">HeXeN,<br /><br />A bit of the difference is that in most languages, you pass the address of a string, not the string itself. In most dialects of basic, when you pass a string to a sub or function, the compiler actually passes the address of that string. In basic you call it passing by reference.<br /><br />In assembler, you can handle strings in various ways but at its simplest, you put a string in the .DATA section,<br /><pre><code><br />.DATA<br />MyString db &quot;This is my string&quot;,0  ; zero terminate it.<br /><br />Then in your code you can work on the string by using its address.<br />  LOCAL buffer&#91;128&#93;&#58;BYTE<br /><br />  mov esi, OFFSET MyString  ; put address in ESI<br />  lea edi, buffer  ; load local address into EDI<br />  mov ecx, LENGTHOF MyString  ; length in ECX<br />  add ecx, esi   ; calculate an exit condition<br /><br />lbl&#58;<br />  mov al, &#91;esi&#93;  ; get the BYTE at address in ESI<br />  inc esi        ; increment ESI<br />; -- -----------------------------<br />; do what you need to do with each<br />; byte in the AL register<br />; -------------------------------<br />  mov &#91;edi&#93;, al  ; write BYTE to address in EDI<br />  inc edi        ; increment EDI<br />  cmp esi, ecx   ; test if esi = ecx<br />  jne lbl        ; jump back if not<br /></code></pre><br />This loop can be made more efficient but the basics are there to read a string, modify it if you need to and copy it back to a buffer. All you need to remember is that you are working with the ADDRESS of a string and you access the content BYTE by BYTE in the AL register and write it back to the buffer.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-12-19 08:14:49 by hutch--</div>
   </div>
   <div class="post" id="post-71871">
    <div class="subject"><a href="#post-71871">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">HeXeN<br /><br />You should tell us which program you are using to assemble and compile your code. We would then be in a much better position to give you some basic real examples which you could try and build on.<br /><br />Raymond</div>
    <div class="meta">Posted on 2002-12-19 19:32:40 by Raymond</div>
   </div>
   <div class="post" id="post-71872">
    <div class="subject"><a href="#post-71872">...</a></div>
    <div class="body">quick editor with the syntax highlighting plugin.<br /><br />-HeXeN</div>
    <div class="meta">Posted on 2002-12-19 19:50:18 by HeXeN</div>
   </div>
   <div class="post" id="post-71878">
    <div class="subject"><a href="#post-71878">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">Quick editor is only a word processor. It could be used with any assembler. Must I assume that you are using MASM32 to assemble whatever you type with Qeditor?<br /><br />Raymond</div>
    <div class="meta">Posted on 2002-12-19 21:30:27 by Raymond</div>
   </div>
   <div class="post" id="post-71888">
    <div class="subject"><a href="#post-71888">..</a></div>
    <div class="body">Yes Raymond You Are Correct. Im using The Masm v7 Package.<br /><br />-HeXeN</div>
    <div class="meta">Posted on 2002-12-20 00:16:14 by HeXeN</div>
   </div>
   <div class="post" id="post-71940">
    <div class="subject"><a href="#post-71940">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">Now it will be easier to help you and get you started.<br /><br />Just copy and paste the following code in the Qeditor. If needed, modify the include directives to reflect your masm32 path.<br /><br />Save that as an .asm file (such as Trial1.asm), then under the 'Project' tab choose 'Console Assemble &amp; Link'. If no assembling error is reported, choose the 'Run Program' option under the 'Project' tab. You will see two of the many variations on how to display strings in Win32asm.<br /><br />;######################<br /><br />    .386<br />    .model flat, stdcall<br />    option casemap :none   ; case sensitive<br /><br />      include \masm32\include\windows.inc<br />      include \masm32\include\user32.inc<br />      include \masm32\include\kernel32.inc<br />      include \masm32\include\masm32.inc<br />      <br />      includelib \masm32\lib\user32.lib<br />      includelib \masm32\lib\kernel32.lib<br />      includelib \masm32\lib\masm32.lib<br /><br />    .data<br />      mystring    db    &quot;I am using MASM32&quot;,0<br /><br />    .code<br /><br />start:<br /><br />      invoke StdOut,ADDR mystring<br />      invoke MessageBox,0,ADDR mystring,0,MB_OK<br /><br />      invoke ExitProcess,0<br /><br />end start<br /><br />;###################<br /><br />The user32.lib is required for the MessageBox function.<br />The kernel32.lib is required for the ExitProcess function.<br />The masm32.lib is required for the StdOut function.<br /><br />If you do not already have the WIN32.HLP file, it is an absolute necessity if you intend to use and understand the Windows functions. <br /><br />Raymond</div>
    <div class="meta">Posted on 2002-12-20 11:04:18 by Raymond</div>
   </div>
   <div class="post" id="post-71998">
    <div class="subject"><a href="#post-71998">...</a></div>
    <div class="body">No Offense But I Knew That Already.  The Thing Im Having Problem With Is Since IM Used To Visual Basic.<br /><br />There Are String Functions.<br /><br />Like Mid<br />       Left<br />       Right<br />       Instr<br /><br /><br />I Know These Are Included In The Masm V7 Package.<br /><br />But Im Not Really Positive On How The Functions Are Really Working.<br /><br />I Apologize If &quot;No Offense But I Knew That Already.&quot; That Offended You.<br /><br />-HeXeN</div>
    <div class="meta">Posted on 2002-12-20 19:25:44 by HeXeN</div>
   </div>
   <div class="post" id="post-72006">
    <div class="subject"><a href="#post-72006">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">well the basics of it all are very simple.<br /><br />on this low level you must forget any encapsulation that you're used to and implement your own or at least understand how others implemented it for you.<br /><br /><br />A string is best compared to scrabble stones on a numbered board.<br /><br /><br />   1 2 3 4 5 6 7 8 9<br />1 <br />2<br />3 H a l  l  o  0<br />4<br />5<br />6<br /><br />So if you have the ASCIIZ (ASCII, zero-terminated. type of string windows usually wants) string &quot;Hallo&quot; then that means that your string takes up 6 bytes for the 5 letters and the 1 terminator (0). So on the scrabble board you can literally place 6 stones.<br /><br />Now because your memory is huge and filled with many data, it's impossible for your functions to 'guess' where the string is that you wish to use. HLL such as VB allow you to solve this via just the label but internally windows wants the address in memory of your string. So, our example string starts at address 31 and ends at address 36, 6 scrabble stones of 1 byte :)<br /><br />This starting address is where it's all at. If you do a mid in vb then you say from string &lt;label&gt; I want x chars, starting at position Y<br /><br />so actually you say to the VB compiler starting with the address of the string add Y bytes to determine the starting position and make me a new stringbuffer that contains the next x bytes starting from the newfound address (string + y)<br /><br />Left is just the same thing left(Hallostring,3) is just<br /><br />the address of Hallostring (31 for our fictional string), make a buffer of 4 bytes (3 chars + 1 terminator 0) and copy all chars from position Hallostring (31)  to position Hallostring + 2 ( 3 scrabblestones, 33) :)<br /><br />That's all there is to it. really.<br /><br />I hope this helped a bit. If you have trouble visualizing it, try real physical ways that you can rearrange (like scrabbleboards ;)  ) to show it to you.</div>
    <div class="meta">Posted on 2002-12-20 20:50:45 by Hiroshimator</div>
   </div>
   <div class="post" id="post-72012">
    <div class="subject"><a href="#post-72012">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">HeXeN<br /><br />You did not offend me at all. As my signature says, whenever you assume something, you risk being wrong.<br /><br />At least, now we know what you want.<br /><br />I do agree with you that the source code of the MASM32 library procedures related to strings could certainly be upgraded, at the very least to explain (i) the purpose of the procedure (which is not even mentioned in many cases) and (ii) what type of parameters are expected.<br /><br />I'll give you one example and you can probably figure out the others by analogy. All string procedures assume zero-termination and restore such in the destination string.<br /><br />szRight proc lpszSource:DWORD,lpszTarget:DWORD,ln:DWORD<br /><br />This procedure would take the right most number of characters specified by &quot;ln&quot; from the string which is located at the address specified by &quot;lpszSource&quot; and copy those characters starting at the address specified by lpszTarget, adding a terminating zero at the end.<br /><br />You would than call this procedure as follows, substituting the proper variable names for Source and Target, and specifying the correct number of characters instead of the 10.<br /><br />invoke szRight, ADDR Source, ADDR Target, 10<br /><br />Let us know if you need more.<br /><br />Raymond</div>
    <div class="meta">Posted on 2002-12-20 21:32:12 by Raymond</div>
   </div>
   <div class="post" id="post-72038">
    <div class="subject"><a href="#post-72038">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">HeXeN,<br /><br />I know its a bit of a pain when you first shift from a language structured like basic to assembler but at the most basic level, string data is not that different. Modern basic dialects use OLE string which is an allocated piece of memory for each string.<br /><pre><code><br />    a$ = &quot;This is a basic dynamic string&quot;<br /></code></pre><br />This is a string handle &quot;a$&quot; that has some literal text assigned to it. a$ is actually the address of the memory that the literal string data is stored in.<br /><br />With assembler at its most simple, the storage of string data is done a bit differently, the compiled file is broken up into what is called sections and one of them is called the &quot;initialised data&quot; section. This is where you can store string data. The notation is pretty simple,<br /><pre><code><br />.data<br />  MyString db &quot;This is a zero terminated string&quot;,0<br /></code></pre><br />This means that the string data is stored in the .DATA section and when you want to do something with the string, you refer to it by the NAME you selected when you stored the string data.<br /><br />Now what makes it a bit different is that when its in the .DATA section, its address is already known when the file is being assembled so it is referred to as an offset in the file.<br /><br />In MASM, you use the OFFSET keyword to refer to that string.<br /><pre><code><br />    mov eax, OFFSET MyString<br /></code></pre><br />This puts the address of the string from the .DATA section into the EAX register so you can do somewthing with it.<br /><br />Some string data is obtained at runtime so it is not contained within the file at all. Just for example, if you wanted to select a file name from a common dialog box, you have to allocate a buffer big enough first so that you can work on the file name after you have selected it.<br /><br />This is usually done within a procedure so you can allocate the buffer for the file name on the stack as a LOCAL variable.<br /><pre><code><br />    LOCAL buffer&#91;260&#93;&#58;BYTE<br /></code></pre><br />This gives you a 260 byte long buffer to load a file name into. Because it is a stack variable, you do not have to bother to deallocate it because that is automatically done when the procedure is finished.<br /><br />Now something worth noting, because it is created at runtime on the stack, it is not an OFFSET like string data in the .DATA section so you use a different instruction to place its address into a register.<br /><pre><code><br />    lea eax, buffer<br /></code></pre><br />LEA (load effective address) is the instruction to use rather than MOV with a LOCAL variable that is created on the stack.<br /><br />Don't worry about it being a bit different to basic string handling, once you get the swing of it, zero terminated strings are actually a bit simpler than basic dynamic strings and are often a bit faster.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-12-21 04:33:44 by hutch--</div>
   </div>
   <div class="post" id="post-72052">
    <div class="subject"><a href="#post-72052">Manipulating Strings -=\ Still dont get it</a></div>
    <div class="body">HeXeN:<br />VB is irrelevent. With Assembl? lanuage, you are no longer the conductor of an orchestra. You are now responsible for writting the music along with tuning the violens and drain the spit from the trumbones.<br /><br />Now for the 16 demo (ie Start-&gt;Run-&gt;debug){note ; comments are valid}<pre><code><br />e130 &quot;Good by Cruel World.&quot; 0<br />a100<br />mov   di, 130        ; PTR to string to search<br />mov   al, 0          ; Look for terminating Null<br />repne scasb          ; Do Search until Null is found<br />mov   cx, di         ; Calc Length of String<br />sub   cx, 130        ; by Subtracting Base PTR<br />mov   &#91;14e&#93;, cx      ; Save Length<br />mov   si, 130        ; Source<br />mov   di, 150        ; Destination<br />rep   movsb          ; Copy String to 0x140<br />mov   ah, 40         ; DOS WriteFile<br />mov   bx, 01         ; to StdOut<br />mov   cx, &#91;14e&#93;      ; Length<br />mov   dx, 150        ; Address<br />int   21             ; Print!<br />ret                  ; Done<br />; notice extra CRLF<br /></code></pre><br /><br />Somthing is FUBAR on my machine, but the above should work.<br /><br />Type ? and CR for help or refer to your MS-DOS 4.0 User's Guide</div>
    <div class="meta">Posted on 2002-12-21 05:39:36 by eet_1024</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=9673&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=9673&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="9673" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=9673&amp;page=2">&gt;</a><a href="../?id=9673&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>