<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ReadFile problem.. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19462" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19462">ReadFile problem..</a></p>
   <div class="post" id="post-150028">
    <div class="subject"><a href="#post-150028">ReadFile problem..</a></div>
    <div class="body">Hello,<br /><br />i have to open a exe..-file and printout with a MessageBox<br />the two first bytes (MZ or ZM)...<br /><br /><a target="_blank" href="http://eimer.ch/users/cre/win32asm/PrintFirstBytes.txt">http://eimer.ch/users/cre/win32asm/PrintFirstBytes.txt</a><br /><br /><br />the CreateFile works, i have debug it,<br />but the ReadFile doesn't write in the buffer the value,<br />why?<br /><br />thx, cre</div>
    <div class="meta">Posted on 2004-09-20 03:39:59 by cre</div>
   </div>
   <div class="post" id="post-150033">
    <div class="subject"><a href="#post-150033">ReadFile problem..</a></div>
    <div class="body">Hi, cre,<br /><br />the reason is that you are defining ReadByte (number of bytes read) as &quot;dw&quot; (two bytes), immediately followed by the buffer ReadBuffer.<br />The system will initally put &quot;MZ&quot; inside your buffer, and will return 1 in EAX, but will next overwrite &quot;MZ&quot; with the number of bytes read 02 00 00 00 (4 bytes long).<br />By the way, also FileHandle must be defined as a long, not a word...<br /><br />Regards, bilbo</div>
    <div class="meta">Posted on 2004-09-20 04:22:01 by bilbo</div>
   </div>
  </div>
 </body>
</html>