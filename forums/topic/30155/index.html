<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Shorter code to restart NT systems - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30155" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=30155">Shorter code to restart NT systems</a></p>
   <div class="post" id="post-212651">
    <div class="subject"><a href="#post-212651">Shorter code to restart NT systems</a></div>
    <div class="body">I found a shorter way to restart NT systems.<br />Of course, ExitProcess could be excised as well.<br /><br />; Fast_NT_Restart.asm&nbsp; Fastest way to Restart an NT System<br />;<br />&nbsp; &nbsp; .386&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; .model&nbsp; flat, stdcall&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br />&nbsp; &nbsp; option&nbsp; casemap:none&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br /><br />&nbsp; &nbsp; include&nbsp; &nbsp;  \masm32\include\windows.inc<br />&nbsp; &nbsp; include&nbsp; &nbsp;  \masm32\include\user32.inc<br />&nbsp; &nbsp; include&nbsp; &nbsp;  \masm32\include\kernel32.inc<br />&nbsp; &nbsp; include&nbsp; &nbsp;  \masm32\include\advapi32.inc<br />&nbsp; &nbsp; include&nbsp; &nbsp;  \masm32\include\ntdll.inc<br />&nbsp; &nbsp; include&nbsp; &nbsp;  \masm32\macros\macros.asm<br /><br />&nbsp; &nbsp; includelib&nbsp; \masm32\lib\kernel32.lib<br />&nbsp; &nbsp; includelib&nbsp; \masm32\lib\user32.lib<br />&nbsp; &nbsp; includelib&nbsp; \masm32\lib\advapi32.lib<br />&nbsp; &nbsp; includelib&nbsp; \masm32\lib\ntdll.lib<br /><br />.data<br /><br />.code<br /> <br />start:<br /><br />push esp<br />invoke RtlAdjustPrivilege,19,2,0,esp<br />invoke NtShutdownSystem,1 ; 2 = power off<br /><br />invoke&nbsp; ExitProcess,NULL<br /><br /><br />end&nbsp; &nbsp;  start<br /></div>
    <div class="meta">Posted on 2010-08-13 21:45:58 by skywalker</div>
   </div>
   <div class="post" id="post-212687">
    <div class="subject"><a href="#post-212687">Re: Shorter code to restart NT systems</a></div>
    <div class="body">iirc NtShutdownSystem doesn&#039;t notify running processes that the system is shutting down... this does mean the system will shut down faster, but also that running processes will have no chance to save configuration etc.</div>
    <div class="meta">Posted on 2010-08-15 08:51:39 by f0dder</div>
   </div>
   <div class="post" id="post-212702">
    <div class="subject"><a href="#post-212702">Re: Shorter code to restart NT systems</a></div>
    <div class="body"><div class="quote"><br />iirc NtShutdownSystem doesn&#039;t notify running processes that the system is shutting down... this does mean the system will shut down faster, but also that running processes will have no chance to save configuration etc.<br /></div><br /><br />I make sure nothing is open when I use it.</div>
    <div class="meta">Posted on 2010-08-15 11:18:53 by skywalker</div>
   </div>
  </div>
 </body>
</html>