<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Window automatically closes when I jump to any thing - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9050" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=9050">Window automatically closes when I jump to any thing</a></p>
   <div class="post" id="post-66462">
    <div class="subject"><a href="#post-66462">Window automatically closes when I jump to any thing</a></div>
    <div class="body">It always happens in my Win32 Programs....right after a Show a Window, and I want to jump to something, as soon as I jump , the window dissappears and the program closes....try it and you'll see....like for instance<br /><br />anything:<br />; Code<br />return<br /><br />if you jmp anything after you show the window the window closes, automatically....why is that?</div>
    <div class="meta">Posted on 2002-11-19 15:09:13 by CyberGuy</div>
   </div>
   <div class="post" id="post-66627">
    <div class="subject"><a href="#post-66627">Window automatically closes when I jump to any thing</a></div>
    <div class="body">Could you post a minimal example that demonstrates<br />the behaviour?<br /><br />I cant seem to duplicate it...</div>
    <div class="meta">Posted on 2002-11-20 11:58:02 by Graebel</div>
   </div>
   <div class="post" id="post-66646">
    <div class="subject"><a href="#post-66646">Window automatically closes when I jump to any thing</a></div>
    <div class="body">Ok here it is, all the code<br /><br /><pre><code><br />format PE GUI 4.0                                                                                              <br />entry start                                                                                                    <br />                                                                                                               <br />include 'include\kernel.inc'                                                                                   <br />include 'include\user.inc'                                                                                     <br />                                                                                                               <br />include 'include\macro\stdcall.inc'                                                                            <br />include 'include\macro\import.inc'                                                                             <br />                                                                                                               <br />section '.data' data readable writeable                                                                        <br />                                                                                                               <br />  mainhwnd dd 0                         ; handle of window                                                     <br />  hinstance dd 0                        ; handle of module                                                     <br />                                                                                                               <br />  msg MSG                                                                                                      <br />  wc WNDCLASS                                                                                                  <br />                                                                                                               <br />  _title db 'My Window',0                                                                                      <br />  _class db 'FASMWIN32',0                                                                                      <br />                                                                                                               <br />section '.code' code readable executable                                                                       <br />                                                                                                               <br />  start&#58;                                                                                                       <br />                                                                                                               <br />        invoke  GetModuleHandle,0                                                                              <br />        mov     &#91;hinstance&#93;,eax                                                                                <br />        invoke  LoadIcon,0,IDI_APPLICATION                                                                     <br />        mov     &#91;wc.hIcon&#93;,eax                                                                                 <br />        invoke  LoadCursor,0,IDC_ARROW                                                                         <br />        mov     &#91;wc.hCursor&#93;,eax                                                                               <br />        mov     &#91;wc.style&#93;,0                                                                                   <br />        mov     &#91;wc.lpfnWndProc&#93;,WindowProc                                                                    <br />        mov     &#91;wc.cbClsExtra&#93;,0                                                                              <br />        mov     &#91;wc.cbWndExtra&#93;,0                                                                              <br />        mov     eax,&#91;hinstance&#93;                                                                                <br />        mov     &#91;wc.hInstance&#93;,eax                                                                             <br />        mov     &#91;wc.hbrBackground&#93;,COLOR_BTNFACE+1                                                             <br />        mov     &#91;wc.lpszMenuName&#93;,0                                                                            <br />        mov     &#91;wc.lpszClassName&#93;,_class                                                                      <br />        invoke  RegisterClass,wc                                                                               <br />                                                                                                               <br />        invoke  CreateWindowEx,0,_class,_title,WS_VISIBLE+WS_MINIMIZEBOX+WS_MAXIMIZEBOX+WS_SYSMENU+WS_THICKFRAM<br />        mov     &#91;mainhwnd&#93;,eax                                                                                 <br />        jmp     anything                                                                                       <br />                                                                                                               <br />  msg_loop&#58;                                                                                                    <br />        invoke  GetMessage,msg,NULL,0,0                                                                        <br />        or      eax,eax                                                                                        <br />        jz      end_loop                                                                                       <br />        invoke  TranslateMessage,msg                                                                           <br />        invoke  DispatchMessage,msg                                                                            <br />        jmp     msg_loop                                                                                       <br />                                                                                                               <br />  end_loop&#58;                                                                                                    <br />        invoke  ExitProcess,&#91;msg.wParam&#93;                                                                       <br />  anything&#58;                                                                                                    <br />  ;doesn't matter what it is                                                                                   <br />  return                                                                                                       <br />                                                                                                               <br />proc WindowProc, hwnd,wmsg,wparam,lparam                                                                       <br />        enter                                                                                                  <br />        push    ebx esi edi                                                                                    <br />        cmp     &#91;wmsg&#93;,WM_DESTROY                                                                              <br />        je      wmdestroy                                                                                      <br />  defwndproc&#58;                                                                                                  <br />        invoke  DefWindowProc,&#91;hwnd&#93;,&#91;wmsg&#93;,&#91;wparam&#93;,&#91;lparam&#93;                                                  <br />        jmp     finish                                                                                         <br />  wmdestroy&#58;                                                                                                   <br />        invoke  PostQuitMessage,0                                                                              <br />        xor     eax,eax                                                                                        <br />  finish&#58;                                                                                                      <br />        pop     edi esi ebx                                                                                    <br />        return                                                                                                 <br />                                                                                                               <br />section '.idata' import data readable writeable                                                                <br />                                                                                                               <br />  library kernel,'KERNEL32.DLL',\                                                                              <br />          user,'USER32.DLL'                                                                                    <br />                                                                                                               <br />  kernel&#58;                                                                                                      <br />  import GetModuleHandle,'GetModuleHandleA',\                                                                  <br />         ExitProcess,'ExitProcess'                                                                             <br />                                                                                                               <br />  user&#58;                                                                                                        <br />  import RegisterClass,'RegisterClassA',\                                                                      <br />         CreateWindowEx,'CreateWindowExA',\                                                                    <br />         DefWindowProc,'DefWindowProcA',\                                                                      <br />         GetMessage,'GetMessageA',\                                                                            <br />         TranslateMessage,'TranslateMessage',\                                                                 <br />         DispatchMessage,'DispatchMessageA',\                                                                  <br />         LoadCursor,'LoadCursorA',\                                                                            <br />         LoadIcon,'LoadIconA',\                                                                                <br />         UpdateWindow,'UpdateWindow',\                                                                         <br />         SetParent,'SetParent',\                                                                               <br />         PostQuitMessage,'PostQuitMessage'                                                                     <br />                                                                                                               <br /></code></pre></div>
    <div class="meta">Posted on 2002-11-20 15:56:00 by CyberGuy</div>
   </div>
   <div class="post" id="post-66648">
    <div class="subject"><a href="#post-66648">Window automatically closes when I jump to any thing</a></div>
    <div class="body">This is because you are doing &quot;return&quot; after that jump, and this causes the program to exit. You should rather do &quot;call anything&quot; than &quot;jmp anything&quot;, and use plain &quot;ret&quot; instead of &quot;return&quot;, which is a macroinstruction that should be used only after the &quot;proc&quot; and &quot;enter&quot; macroinstructions.</div>
    <div class="meta">Posted on 2002-11-20 16:37:47 by Tomasz Grysztar</div>
   </div>
   <div class="post" id="post-66806">
    <div class="subject"><a href="#post-66806">Window automatically closes when I jump to any thing</a></div>
    <div class="body">Thanks Privalov!</div>
    <div class="meta">Posted on 2002-11-21 16:34:39 by CyberGuy</div>
   </div>
   <div class="post" id="post-66963">
    <div class="subject"><a href="#post-66963">Window automatically closes when I jump to any thing</a></div>
    <div class="body">I have another problem, call works but what if I want to compare something and make a jump like <br />cmp ,somevalue<br />je  anything<br /><br />it wouldn't work</div>
    <div class="meta">Posted on 2002-11-22 15:36:55 by CyberGuy</div>
   </div>
   <div class="post" id="post-66975">
    <div class="subject"><a href="#post-66975">Window automatically closes when I jump to any thing</a></div>
    <div class="body">If you want to call you procedure conditionally you can do it so:<br /><br /><pre><code><br />  cmp &#91;something&#93;, value<br />  jne .skip_call<br />  call some_proc<br />.skip_call&#58;<br /></code></pre></div>
    <div class="meta">Posted on 2002-11-22 17:40:33 by wanderer</div>
   </div>
   <div class="post" id="post-67068">
    <div class="subject"><a href="#post-67068">Window automatically closes when I jump to any thing</a></div>
    <div class="body">how would that work with jl, jle, jge and all the others?</div>
    <div class="meta">Posted on 2002-11-23 14:37:00 by CyberGuy</div>
   </div>
   <div class="post" id="post-67093">
    <div class="subject"><a href="#post-67093">Window automatically closes when I jump to any thing</a></div>
    <div class="body">jnl, jnle, jnge and so on :) - use your brain to generate the answer ;)</div>
    <div class="meta">Posted on 2002-11-23 18:50:46 by wanderer</div>
   </div>
   <div class="post" id="post-67107">
    <div class="subject"><a href="#post-67107">Window automatically closes when I jump to any thing</a></div>
    <div class="body">I don't have a good brain. So then to do jne you would je, its like reversed?</div>
    <div class="meta">Posted on 2002-11-23 20:34:09 by CyberGuy</div>
   </div>
   <div class="post" id="post-67110">
    <div class="subject"><a href="#post-67110">Window automatically closes when I jump to any thing</a></div>
    <div class="body">Right.</div>
    <div class="meta">Posted on 2002-11-23 20:56:35 by wanderer</div>
   </div>
  </div>
 </body>
</html>