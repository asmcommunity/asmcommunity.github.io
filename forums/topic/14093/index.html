<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ChangeDisplaySettings - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14093" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14093">ChangeDisplaySettings</a></p>
   <div class="post" id="post-108906">
    <div class="subject"><a href="#post-108906">ChangeDisplaySettings</a></div>
    <div class="body">I'm playing with the ChangeDisplaySettings api, trying to translate some vb code.  It's working, except that the display area moves in.  It's hard to explain (for me anyways), but there's a black strip along the bottom and right side of the screen after this code runs.  Maybe the equates are wrong?  Maybe I'm not setting all of the necessary members of the devmode struct?  Maybe I'm just a bad programmer?<br /><br />Anyways, here's the code.  Maybe someone can point out a glaring error?<br /><pre><code><br />DM_PELSWIDTH    equ 080000h<br />DM_PELSHEIGHT   equ 0100000h<br />DM_BITSPERPEL   equ 040000h<br /><br />.data<br />    myDevMode       DEVMODE &lt;&gt;<br /><br />.code<br />start&#58;<br />    mov myDevMode.dmPelsWidth,1152;1024<br />    mov myDevMode.dmPelsHeight,864;768<br />    mov myDevMode.dmBitsPerPel,32<br />    mov myDevMode.dmFields,DM_PELSWIDTH Or DM_PELSHEIGHT Or DM_BITSPERPEL<br />    mov myDevMode.dmSize,sizeof myDevMode<br />    invoke ChangeDisplaySettings,addr myDevMode,0<br /></code></pre> <br /><br />cheers,<br />will</div>
    <div class="meta">Posted on 2003-07-01 11:50:29 by Will</div>
   </div>
  </div>
 </body>
</html>