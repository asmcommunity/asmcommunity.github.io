<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>&quot;instance handle and module handle&quot; - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17534" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=17534">&quot;instance handle and module handle&quot;</a></p>
   <div class="post" id="post-135687">
    <div class="subject"><a href="#post-135687">&quot;instance handle and module handle&quot;</a></div>
    <div class="body">We know,Under Win32, instance handle and module handle are one and the same. <br />but who know what difference between them under Win16.</div>
    <div class="meta">Posted on 2004-03-12 01:24:24 by tomorrow</div>
   </div>
   <div class="post" id="post-135692">
    <div class="subject"><a href="#post-135692">&quot;instance handle and module handle&quot;</a></div>
    <div class="body"><div class="quote">Windows 3.1 knows instance handles, task handles, and module handles. Instance handles are, in fact, selectors of the default data segments of the application instance. (This fact is sometimes used to change the data segment so that an operation can work on the default data segment of a different application?an ugly practice, but it works.) The task handle is the selector of a global memory block that contains task-specific parameters (such as the input queue that is associated with the task). The module handle is the selector of a global memory block that contains a modified version of the executable header associated with the module. (This memory block is also known as the module database.)<br /><br />For applications in Windows 3.1, there is only one module database in the system for all instances of the application, whereas both the task database and the default data segment exist separately for each instance of the application. The GetModuleHandle API returns the handle (selector) of the module database, whereas a call to GetWindowWord with GWW_HINSTANCE passed as the second parameter returns the instance handle, and the GetCurrentTask API returns the task database handle. For other applications, the TaskFirst/TaskNext Toolhelp API functions can be employed to retrieve the task database handles.</div></div>
    <div class="meta">Posted on 2004-03-12 02:15:07 by donkey</div>
   </div>
   <div class="post" id="post-135726">
    <div class="subject"><a href="#post-135726">&quot;instance handle and module handle&quot;</a></div>
    <div class="body">Under Win32, instance/module handles are basically memory handles, and in the current implementations are (linear) memory addresses.<br /><br />Under Win16, instance and module handles represent memory segments. I don't remember if there was a &quot;real mode&quot; version of Win3.1. (3.0 supported real mode.) Under protected mode, the instance and module handles are segment selectors. Win16 was primarily targeted for 286 systems. 286s have protected mode but not paging. Instance handles were data selectors, and module handles were probably code selectors. At any rate, module handles represented individual EXE and DLL files.<br /><br />(Out of print) &quot;Undocumented Windows&quot; by Matt Pietrek has details on the different kinds of handles. For each module handle, there could be several instance handles (representing different &quot;launches&quot;). The instance handles were not shared, so Win16 could always convert instance handles to module handles whenever a module handle was needed (a hidden overhead in Win16).</div>
    <div class="meta">Posted on 2004-03-12 19:13:52 by tenkey</div>
   </div>
   <div class="post" id="post-135750">
    <div class="subject"><a href="#post-135750">&quot;instance handle and module handle&quot;</a></div>
    <div class="body">Thank YOu Two.<br />but i am so hard to understand yous because of my language and<br />knowledge.</div>
    <div class="meta">Posted on 2004-03-13 03:02:32 by tomorrow</div>
   </div>
   <div class="post" id="post-135805">
    <div class="subject"><a href="#post-135805">&quot;instance handle and module handle&quot;</a></div>
    <div class="body">Simply then :<br /><br />In Win16 there was only one module handle for all copies of an app that are running but there was a separate instance handle for each one. If you wanted to talk to all copies of the application you used the module handle if you only wanted to talk to a single running copy you used the instance handle.</div>
    <div class="meta">Posted on 2004-03-13 13:34:46 by donkey</div>
   </div>
   <div class="post" id="post-135851">
    <div class="subject"><a href="#post-135851">&quot;instance handle and module handle&quot;</a></div>
    <div class="body">Great!!</div>
    <div class="meta">Posted on 2004-03-14 04:30:54 by tomorrow</div>
   </div>
  </div>
 </body>
</html>