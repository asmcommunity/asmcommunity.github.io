<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Are there any descriptions or snippets about &quot;Printer&quot; ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=21514" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=21514">Are there any descriptions or snippets about &quot;Printer&quot; ?</a></p>
   <div class="post" id="post-162481">
    <div class="subject"><a href="#post-162481">Are there any descriptions or snippets about &quot;Printer&quot; ?</a></div>
    <div class="body">Hello, I want to do something about the issue Printer by Win32 API in MASM32. and try to output some text to a printer.<br /><br />I viewed the M$ MSDN, but there is only funtions detail.<br /><br />So, I want to know if there are some snippets or description about the issue Printer.<br /><br />Thank you . </div>
    <div class="meta">Posted on 2005-07-25 23:40:37 by seasea</div>
   </div>
   <div class="post" id="post-162485">
    <div class="subject"><a href="#post-162485">Re: Are there any descriptions or snippets about &quot;Printer&quot; ?</a></div>
    <div class="body">Are you asking: How do I Print?<br /><br />Following code written by NaN.<br /><pre><code><br />Do_Print PROTO :DWORD,:DWORD,:DWORD<br /><br /><br />PrintFloat MACRO Q1:REQ, string:REQ<br /> LOCAL szMessage<br /><br /> .data<br /> szMessage&nbsp; &nbsp; &nbsp;  BYTE string, &quot;:&quot;,0<br /> .code<br /> invoke FloatToStr2, Q1, addr POUT<br /> invoke lstrlen, addr szMessage<br /> invoke TextOut, PD.hDC, COLUMN_1, yP, addr szMessage, eax<br /><br /> invoke lstrlen, addr POUT<br /> invoke TextOut, PD.hDC, COLUMN_2, yP, addr POUT, eax<br /> <br /> mov eax, LINE_WIDTH<br /> add yP, eax<br /><br />ENDM<br /><br />PrintMemText MACRO Mem:REQ, string:REQ<br /> LOCAL szMessage<br /><br /> .data<br /> szMessage&nbsp; &nbsp; &nbsp;  BYTE string, &quot;:&quot;,0<br /> .code<br /><br /> invoke lstrlen, addr szMessage<br /> invoke TextOut, PD.hDC, COLUMN_1, yP, addr szMessage, eax<br /><br /> invoke lstrlen, addr Mem<br /> invoke TextOut, PD.hDC, COLUMN_2, yP, addr Mem, eax<br /> <br /> mov eax, LINE_WIDTH<br /> add yP, eax<br /><br /><br />ENDM<br /><br />PrintTitle MACRO string:REQ<br /> LOCAL szMessage<br /><br /> .data<br /> szMessage&nbsp; &nbsp; &nbsp;  BYTE string, 0<br /> .code<br /><br /> mov eax, LINE_WIDTH<br /> add yP, eax<br /><br /> invoke lstrlen, addr szMessage<br /> invoke TextOut, PD.hDC, COLUMN_1, yP, addr szMessage, eax<br /> <br /> mov eax, LINE_WIDTH<br /> add yP, eax<br /><br /><br />ENDM<br /><br /><br />.data?<br /> PD&nbsp; PRINTDLG&nbsp; &lt;&gt;<br /> DOC DOCINFO&nbsp;  &lt;&gt;<br /> LF&nbsp; LOGFONT&nbsp;  &lt;&gt;<br /> <br /> pFont&nbsp; &nbsp; &nbsp; &nbsp;  dd ?<br /> yP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd ?<br /> POUT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db 50 dup (?)<br /> <br /> COLUMN_1&nbsp; &nbsp; &nbsp; dd ?<br /> COLUMN_2&nbsp; &nbsp; &nbsp; dd ?<br /> LINE_WIDTH&nbsp; &nbsp; dd ?<br /><br /><br />.data<br /> DocTitle&nbsp; &nbsp; &nbsp; db &quot;Ground Grid Calculations&quot;,0<br /> <br /> FontMS&nbsp; &nbsp; &nbsp; &nbsp; db &quot;MS Sans Serif&quot;,0<br /> <br />.code<br />Do_Print PROC hWnd:DWORD, wParam:DWORD, lParam:DWORD<br /> LOCAL QTMP :QWORD<br /> LOCAL BUG[12] :BYTE<br /> LOCAL TEMP :DWORD<br /><br /> ; Initialize the Print Dialog<br /> ; --===============================================<br /> mov yP, 0 ; Start of page..<br /><br /> invoke SendMessage, h7001, CB_GETCURSEL, NULL, NULL<br /> mov TEMP, eax<br /> invoke SendMessage, h7001, CB_GETLBTEXT, TEMP, addr BUG<br /> <br /> ; Initialize the Print Dialog<br /> ; --===============================================<br /> mov PD.lStructSize, SIZEOF PD<br /> m2m PD.hwndOwner, hWnd<br /> m2m PD.hInstance, hInstance<br /> mov PD.Flags, PD_RETURNDC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Return Users DC choices<br /> <br /> ; Show the Print Dialog Box!<br /> ; --===============================================<br /> invoke PrintDlg, offset PD<br /> cmp eax, FALSE<br /> je @ExitPrint<br /> <br /> ; IF you specify the PD_RETURNDC value in the Flags member of the PRINTDLG structure and the user<br /> ; selects Print To File from the Print dialog box, you can use the DC returned in the hDC member<br /> ; of the structure to generate output, but only after you prepare the file for output by specifying<br /> ; the name of the file in the lpszOutput member of the DOCINFO structure and calling the StartDoc function.<br /><br /> ; Check Get the Printed X+Y extence..<br /> ; --===============================================<br /> invoke GetDeviceCaps, PD.hDC, HORZRES<br /> DPrintValD eax, &quot;Max X&quot;<br /> shr eax, 1<br /> mov COLUMN_2, eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 2 columns per page<br /> DPrintValD eax, &quot;Colum space&quot;<br /> invoke GetDeviceCaps, PD.hDC, VERTRES<br /> DPrintValD eax, &quot;Max Y&quot;<br /> shr eax, 6<br /> mov LINE_WIDTH, eax&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; 64 Lines / page<br /> DPrintValD eax, &quot;Line Width&quot;<br /> m2m COLUMN_1, LINE_WIDTH<br /> <br /> ; Create A Printer Font..<br /> ; --===============================================<br /> invoke lstrcpy, addr LF.lfFaceName, addr FontMS<br /> m2m LF.lfHeight, LINE_WIDTH<br /> mov LF.lfWeight, 600<br /> invoke CreateFontIndirect, ADDR LF<br /> mov pFont, eax<br /> <br /> ; Set up the Document Info Structure<br /> ; --===============================================<br /> mov DOC.cbSize, SIZEOF DOC<br /> mov DOC.lpszDocName, offset DocTitle<br /> mov DOC.lpszOutput, NULL<br /> mov DOC.fwType, NULL<br /> <br /> ; Start the Doc..<br /> ; Ensures proper print order of pages..<br /> ; --===============================================<br /> invoke StartDoc, PD.hDC, offset DOC<br /> <br /> ; Start the Page..<br /> ; Prepares the printer driver to accept data.<br /> ; --===============================================<br /> invoke StartPage, PD.hDC<br /> <br /> ; Load a Printer Font..<br /> ; --===============================================<br /> invoke SelectObject, PD.hDC, pFont<br /> <br /> <br /> ; Print The Needed Text...<br /> ; --===============================================<br /> PrintTitle &quot;Ground Grid Design Calculations&quot;<br /> PrintTitle &quot;Conductor Values&quot;<br /> PrintFloat OutsideDistance, &quot;Outside Ground Segment Length (m)&quot;<br /> PrintFloat InsideDistance,&nbsp; &quot;Inside Ground Segment Length (m)&quot;<br /> PrintFloat CondDistance,&nbsp; &nbsp; &quot;Inside Conductor Spacing (m)&quot;<br /> PrintFloat NumberOfRods,&nbsp; &nbsp; &quot;Number Of Ground Rods&quot;<br /> PrintFloat RodLength,&nbsp; &nbsp; &nbsp;  &quot;Ground Rod Length (m)&quot;<br /> PrintFloat ConductorSize,&nbsp;  &quot;Conductor Size (m)&quot;<br /> PrintMemText BUG,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &quot;Conductor Type (IEEE)&quot;<br /> <br /> PrintTitle &quot;Geometry Values&quot;<br /> PrintFloat Depth,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &quot;Ground Grid Burried Depth (m)&quot;<br /> PrintFloat Perimeter,&nbsp; &nbsp; &nbsp;  &quot;Ground Grid Perimeter (m)&quot;<br /> PrintFloat TotalArea,&nbsp; &nbsp; &nbsp;  &quot;Ground Grid Total Area (m*m)&quot;<br /> PrintFloat TotalCondLength, &quot;Ground Grid Total Conductor Length (m)&quot;<br /> PrintFloat TotalGroundRodLength, &quot;Ground Grid Total Ground Rod Length (m)&quot;<br /> PrintTitle &quot;Electrical Values&quot;<br /> PrintFloat VABase,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;VA Base (unused in Calculations)&quot;<br /> PrintFloat VoltBase,&nbsp; &nbsp; &nbsp; &nbsp; &quot;3P Voltage Value (V)&quot;<br /> PrintFloat MaxFaultTime,&nbsp; &nbsp; &quot;Max Fault Time (unused in Calculations)&quot;<br /> PrintFloat SurfaceResistivity, &quot;Surface Resistivity (unused) (Ohm-m)&quot;<br /> PrintFloat UpperSoilResistivity, &quot;Upper Soil Resistivity (Ohm-m)&quot;<br /> PrintFloat LowerSoilResistivity, &quot;Lower Soil Resistivity (Ohm-m)&quot;<br /> PrintFloat ZReal,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &quot;Summed Line Impedance&nbsp; (Ohm)&quot;<br /> PrintFloat ZImag,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &quot;Summed Line Impedance j(Ohm)&quot;<br /> PrintTitle &quot;Calculations Rendered&quot;<br /> PrintFloat LT_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;LT&#39; Calculated Value (m)&quot;<br /> PrintFloat RG_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;RG&#39; Calculated Value (Ohm)&quot;<br /> PrintFloat ZL_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;ZL&#39; Calculated Impedance (Ohm)&quot;<br /> PrintFloat ILG_Calc,&nbsp; &nbsp; &nbsp; &nbsp; &quot;Line-Ground Calculated Current (A)&quot;<br /> PrintFloat GPR_Calc,&nbsp; &nbsp; &nbsp; &nbsp; &quot;&#39;GPR&#39; Calculated Value (V)&quot;<br /> PrintFloat KM_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;KM&#39; Calculated Value&quot;<br /> PrintFloat KI_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;KI&#39; Calculated Value&quot;<br /> PrintFloat EM_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;E-Mesh&#39; Calculated Value (V)&quot;<br /> PrintFloat KS_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;KS&#39; Calculated Value&quot;<br /> PrintFloat LS_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;LS&#39; Calculated Value&quot;<br /> PrintFloat ES_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;ES&#39; Calculated Value (V)&quot;<br /> PrintFloat THE_N,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;N&#39; Value In Calculations&quot;<br /> PrintTitle &quot;Assigned Constraints&quot;<br /> WndTxt2Float h9001, QTMP<br /> PrintFloat QTMP,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;GPR Assigned Limit (V)&quot;<br /> WndTxt2Float h9002, QTMP<br /> PrintFloat QTMP,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;E-Mesh Assigned Limit (V)&quot;<br /> WndTxt2Float h9003, QTMP<br /> PrintFloat QTMP,&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &quot;E-Step Assigned Limit (V)&quot;<br /> PrintTitle &quot;Final Answer Calculations (Repeated from above)&quot;<br /> PrintFloat GPR_Calc,&nbsp; &nbsp; &nbsp; &nbsp; &quot;&#39;GPR&#39; Calculated Value (V)&quot;<br /> PrintFloat EM_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;E-Mesh&#39; Calculated Value (V)&quot;<br /> PrintFloat ES_Calc,&nbsp; &nbsp; &nbsp; &nbsp;  &quot;&#39;ES&#39; Calculated Value (V)&quot;<br /> <br /> ; Do the End of Page (feed out the paper)<br /> ; --===============================================<br /> invoke EndPage, PD.hDC<br /> invoke EndDoc, PD.hDC<br /> invoke DeleteDC, PD.hDC<br /> <br /> @ExitPrint:<br /> ret<br />Do_Print ENDP<br /></code></pre></div>
    <div class="meta">Posted on 2005-07-26 08:37:59 by JimmyClif</div>
   </div>
   <div class="post" id="post-162486">
    <div class="subject"><a href="#post-162486">Re: Are there any descriptions or snippets about &quot;Printer&quot; ?</a></div>
    <div class="body">JimmyClif:<br /><br />Oh, that&#39;s what I want!<br /><br />Thank you.</div>
    <div class="meta">Posted on 2005-07-26 08:42:43 by seasea</div>
   </div>
  </div>
 </body>
</html>