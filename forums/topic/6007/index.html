<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Include file additions - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6007" />
    <link rel="next" href="../?id=6007&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=6007">Include file additions</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=6007&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=6007&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="6007" /><input type="number" name="page" min="1" max="3" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=6007&amp;page=2">&gt;</a><a href="../?id=6007&amp;page=3">&raquo;</a></form>   <div class="post" id="post-43021">
    <div class="subject"><a href="#post-43021">Include file additions</a></div>
    <div class="body">I have started this thread to pick up any additions that need to made to the WINDOWS.INC file.<br /><br />What I am after is any corrections and additions up to and including win98se/winNT4 to try and get a stable WINDOWS.INC<br /><br />Material specific to win2k/XP needs to be added to a seperate INC file so that the current one can become stable.<br /><br />It is important that the material submitted is tested and reliable as there is no point adding it if its not. There are minor naming variations in the existing file that will not be changed as it would break a lot of existing code but omissions or errors in messages, structures and the like will be added to make the existing file more complete.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-06-13 02:50:36 by hutch--</div>
   </div>
   <div class="post" id="post-44319">
    <div class="subject"><a href="#post-44319">A minor detail in the Windows.inc</a></div>
    <div class="body">When i compiled a file I encountered an error, i had used the hDC member of the <em>DRAWITEMSTRUCT</em>. The compiler insisted on that there was no &quot;<strong>hDC</strong>&quot; member of the struct, but the Win32 Programmer's Reference version of the struct contains this var.<br />When I dug in the Windows.inc I found that the member were named &quot;<strong>hdc</strong>&quot; (small letters), where in the Win32 Programmer's Reference it was written &quot;<strong>hDC</strong>&quot;, i use (and prefer) the later one.<br />The verion of Windows.inc I use is 1.25a (dated 22 Oct. 2001), if there is a newer one please let me know.<br /><br />I haven't checked the rest of the stucts in the file, so there might be more of such details in the file.</div>
    <div class="meta">Posted on 2002-06-20 08:52:45 by scientica</div>
   </div>
   <div class="post" id="post-44323">
    <div class="subject"><a href="#post-44323">Include file additions</a></div>
    <div class="body">Yes you are right, the win32.hlp file has &quot;hDC&quot; instead of &quot;hdc&quot; but the problem is that to change it would break existing code for no purpose as it works correctly using &quot;hdc&quot;.<br /><br />This is not really a problem as there are numerous conflicts with MASM reserve words and registers so the WINDOWS.INC file cannot fully conform to the C++/C naming conventions.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-06-20 09:20:07 by hutch--</div>
   </div>
   <div class="post" id="post-44954">
    <div class="subject"><a href="#post-44954">Include file additions</a></div>
    <div class="body">Do you plan to release the version of windows.inc with <br />UNICODE macro support?</div>
    <div class="meta">Posted on 2002-06-24 13:36:22 by Sergo</div>
   </div>
   <div class="post" id="post-44956">
    <div class="subject"><a href="#post-44956">Include file additions</a></div>
    <div class="body">Maybe it's time to think how to make some sort of  precompiled headers for MASM?</div>
    <div class="meta">Posted on 2002-06-24 13:41:06 by Sergo</div>
   </div>
   <div class="post" id="post-46212">
    <div class="subject"><a href="#post-46212">Include file additions</a></div>
    <div class="body">Hutch,<br /><br />There are some undocumented features I know of in NT4, do you want the prototypes for them?<br /><br />umbongo</div>
    <div class="meta">Posted on 2002-07-03 16:43:02 by umbongo</div>
   </div>
   <div class="post" id="post-47705">
    <div class="subject"><a href="#post-47705">PE related structures &amp; Name keyword</a></div>
    <div class="body">There are some PE format related structures that use<br />&lt;Name1&gt; as field name.<br />Since the keyword &lt;Name&gt; is not used in MASM as it mentioned in its reference (6.15) maybe it's time to disable this keyword in widows.inc and use real &quot;Name&quot;s in structures!</div>
    <div class="meta">Posted on 2002-07-15 11:26:24 by Sergo</div>
   </div>
   <div class="post" id="post-49880">
    <div class="subject"><a href="#post-49880">Include file additions</a></div>
    <div class="body">All these difined:<br /><strong>EVENT_ALL_ACCESS</strong><br /><strong>SEMAPHORE_ALL_ACCESS</strong><br /><strong>TIMER_ALL_ACCESS</strong><br /><br />But what about <strong>MUTEX_ALL_ACCESS</strong> ?<br /><br /><strong>MUTEX_ALL_ACCESS	EQU	MUTANT_ALL_ACCESS</strong></div>
    <div class="meta">Posted on 2002-07-24 15:59:35 by Four-F</div>
   </div>
   <div class="post" id="post-50920">
    <div class="subject"><a href="#post-50920">Include file additions</a></div>
    <div class="body">In windows.inc 1.25a the ACCEL structure is wrong.<br /><br />It should be:<br /><pre><code>ACCEL STRUCT<br />  fVirt	BYTE ?<br />  dummy	BYTE ?	;&lt;--- add this line<br />  key	WORD ?<br />  cmd	WORD ?<br />ACCEL ENDS</code></pre> <br /><br />KetilO</div>
    <div class="meta">Posted on 2002-07-30 14:16:26 by KetilO</div>
   </div>
   <div class="post" id="post-51225">
    <div class="subject"><a href="#post-51225">Include file additions</a></div>
    <div class="body">Ketil,<br /><br />Thanks for the suggestion but the win32.hlp file documents it as,<br /><br />typedef struct tagACCEL { // accl  <br />    BYTE   fVirt; <br />    WORD   key; <br />    WORD   cmd; <br />} ACCEL; <br /><br />It was in windows.inc as,<br /><br />ACCEL STRUCT<br />  fVirt BYTE ?<br />  key   WORD ?<br />  cmd   WORD ?<br />ACCEL ENDS<br /><br />Now I wonder if it should be WORD aligned as you suggestion seems to be doing that anyway. I would be interested to see what the problems you had with it were.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-08-01 12:39:28 by hutch--</div>
   </div>
   <div class="post" id="post-51244">
    <div class="subject"><a href="#post-51244">Include file additions</a></div>
    <div class="body">Hi hutch--<br /><br />Look <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=2669&amp;highlight=accelerator">here</a> <br /><br />KetilO</div>
    <div class="meta">Posted on 2002-08-01 14:27:25 by KetilO</div>
   </div>
   <div class="post" id="post-51246">
    <div class="subject"><a href="#post-51246">Include file additions</a></div>
    <div class="body">MASM shouldn't word align unless you do:<pre><code>ACCEL STRUCT 2<br />fVirt BYTE ?<br />key WORD ?<br />cmd WORD ?<br />ACCEL ENDS</code></pre>IMHO, I don't think that the byte should be given a name - this would prevent future problems.  And you can defined the structure like:<pre><code>ACCEL STRUCT<br />fVirt BYTE ?<br /> BYTE ?<br />key WORD ?<br />cmd WORD ?<br />ACCEL ENDS</code></pre>If verbosity is preferred.</div>
    <div class="meta">Posted on 2002-08-01 14:33:28 by bitRAKE</div>
   </div>
   <div class="post" id="post-51317">
    <div class="subject"><a href="#post-51317">Include file additions</a></div>
    <div class="body">tagACCEL defined in Winuser.h like this:<br /><pre><code><br />typedef struct tagACCEL &#123;<br />#ifndef _MAC<br />    BYTE   fVirt;               /* Also called the flags field */<br />    WORD   key;<br />    WORD   cmd;<br />#else<br />    WORD   fVirt;               /* Also called the flags field */<br />    WORD   key;<br />    DWORD  cmd;<br />#endif<br />&#125; ACCEL, *LPACCEL;<br /></code></pre><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/fox7help/html/lng_mac.asp">_MAC System Variable</a> <br />Compiling this snippet with msvc6.0,<br /><pre><code><br />acl.fVirt = FVIRTKEY ;<br />acl.key = 'A' ;<br />acl.cmd = 0 ;<br /></code></pre><br />assembles to this:<br /><pre><code><br />.text&#58;004011B5   mov  byte ptr &#91;ebp-180&#93;, 1<br />.text&#58;004011BC   mov  word ptr &#91;ebp-178&#93;, 41h<br />.text&#58;004011C5   mov  word ptr &#91;ebp-176&#93;, 0<br /></code></pre><br /><br />So, it's byte padding.</div>
    <div class="meta">Posted on 2002-08-02 02:08:19 by Four-F</div>
   </div>
   <div class="post" id="post-52755">
    <div class="subject"><a href="#post-52755">Include file additions</a></div>
    <div class="body">I found WHEEL_PAGESCROLL definition in WINDOWS.INC:<br /><strong>WHEEL_PAGESCROLL	equ	UINT_MAX</strong><br /><br />But UINT_MAX is defined nowhere!<br /><br />Should be:<br /><strong>UINT_MAX	equ	MAXDWORD</strong>	; maximum unsigned int value<br />or<br /><strong>UINT_MAX	equ	0FFFFFFFFh</strong>	; maximum unsigned int value</div>
    <div class="meta">Posted on 2002-08-11 19:17:38 by Four-F</div>
   </div>
   <div class="post" id="post-52886">
    <div class="subject"><a href="#post-52886">Include file additions</a></div>
    <div class="body">I would like to see if there are more konstants included that are related too common controls. Maybe you've read the thread <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=7240">From where do I get these konstant values?</a> in Main forum.<br />For example such as Re-/ToolBar-notification-messages, structures, and more.<br /><br />      :rolleyes:  Marwin</div>
    <div class="meta">Posted on 2002-08-12 07:59:47 by Marwin</div>
   </div>
   <div class="post" id="post-52899">
    <div class="subject"><a href="#post-52899">Include file additions</a></div>
    <div class="body">Among EXCEPTION_ACCESS_VIOLATION, EXCEPTION_BREAKPOINT etc,<br />should also be:<br /><pre><code><br />EXCEPTION_STACK_OVERFLOW		&#91;B&#93;equ&#91;/B&#93;	STATUS_STACK_OVERFLOW<br />EXCEPTION_NONCONTINUABLE_EXCEPTION	&#91;B&#93;equ&#91;/B&#93;	STATUS_NONCONTINUABLE_EXCEPTION<br /></code></pre><br />And may be it's good idea to complite exception code list, but not sure.</div>
    <div class="meta">Posted on 2002-08-12 08:35:04 by Four-F</div>
   </div>
   <div class="post" id="post-53018">
    <div class="subject"><a href="#post-53018">Include file additions</a></div>
    <div class="body">There is no <strong>dw2ah</strong> func in masm32.lib<br />And proto in masm32.inc also not present.<br />But it's described in \MASM32\HELP\Masmlib.hlp:<br /><em>&quot;dw2ah converts DWORD size data to a hexadecimal ascii string.&quot;</em></div>
    <div class="meta">Posted on 2002-08-12 18:05:37 by Four-F</div>
   </div>
   <div class="post" id="post-53100">
    <div class="subject"><a href="#post-53100">masm32.lib dwtoa bug!</a></div>
    <div class="body">If dwValue == 0 proc exits without pop edi!<br /><br /><pre><code>&#91;size=12&#93;.text&#58;00000000        push    ebp<br />.text&#58;00000001        mov     ebp, esp<br />.text&#58;00000003        push    ebx<br />.text&#58;00000004        push    esi<br />.text&#58;00000005        push    edi<br />.text&#58;00000006        mov     eax, &#91;ebp+arg_0&#93;<br />.text&#58;00000009        &#91;COLOR=red&#93;&#91;B&#93;mov     edi, &#91;ebp+arg_4&#93;&#91;/B&#93;&#91;/COLOR&#93;<br />.text&#58;0000000C        or      eax, eax<br />.text&#58;0000000E        jnz     short loc_19<br />.text&#58;00000010        mov     word ptr &#91;edi&#93;, '0'<br />.text&#58;00000015        leave<br />.text&#58;00000016        retn    8		; &#91;COLOR=red&#93;&#91;B&#93;Exits without restoring edi!!!&#91;/B&#93;&#91;/COLOR&#93;<br />...................<br />.text&#58;00000055        pop     edi<br />.text&#58;00000056        pop     esi<br />.text&#58;00000057        pop     ebx<br />.text&#58;00000058        leave<br />.text&#58;00000059        retn    8&#91;/SIZE&#93;</code></pre></div>
    <div class="meta">Posted on 2002-08-13 05:55:19 by Four-F</div>
   </div>
   <div class="post" id="post-53674">
    <div class="subject"><a href="#post-53674">Include file additions</a></div>
    <div class="body">The listview NMITEMACTIVATE structure:<br /><br /><pre><code><br />typedef struct tagNMITEMACTIVATE&#123;<br />    NMHDR   hdr;<br />    int     iItem;<br />    int     iSubItem;<br />    UINT    uNewState;<br />    UINT    uOldState;<br />    UINT    uChanged;<br />    POINT   ptAction;<br />    LPARAM  lParam;<br />    UINT    uKeyFlags;<br />&#125; NMITEMACTIVATE, *LPNMITEMACTIVATE;<br /></code></pre><br /><br />This must be a recent addition from MS as it is stated <em>&quot;Version 4.71 and later of Comctl32.dll&quot;</em>.<br /><br />However this NM_LISTVIEW struct is already defined as follows:<br /><pre><code><br />NM_LISTVIEW STRUCT<br />  hdr           NMHDR      &lt;&gt;<br />  iItem         DWORD      ?<br />  iSubItem      DWORD      ?<br />  uNewState     DWORD      ?<br />  uOldState     DWORD      ?<br />  uChanged      DWORD      ?<br />  ptAction      POINT      &lt;&gt;<br />  lParam        DWORD      ?<br />NM_LISTVIEW ENDS<br /></code></pre><br /><br />So maybe to retain compatibility:<br /><pre><code><br />NM_LISTVIEW STRUCT<br />  hdr           NMHDR      &lt;&gt;<br />  iItem         DWORD      ?<br />  iSubItem      DWORD      ?<br />  uNewState     DWORD      ?<br />  uOldState     DWORD      ?<br />  uChanged      DWORD      ?<br />  ptAction      POINT      &lt;&gt;<br />  lParam        DWORD      ?<br /> uKeyFlags DWORD ?<br />NM_LISTVIEW ENDS<br /><br />NMLISTVIEW  equ  &lt;NM_LISTVIEW&gt;<br />NMITEMACTIVATE  equ  &lt;NM_LISTVIEW&gt; <br /></code></pre><br /><br />Cheers!</div>
    <div class="meta">Posted on 2002-08-16 16:31:37 by huh</div>
   </div>
   <div class="post" id="post-53675">
    <div class="subject"><a href="#post-53675">Include file additions</a></div>
    <div class="body"><div class="quote">If dwValue == 0 proc exits without pop edi!</div> <br /><br />One of the benifits of using USES ESI EDI EBX is that this will not happen :)</div>
    <div class="meta">Posted on 2002-08-16 16:33:01 by huh</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=6007&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=6007&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="6007" /><input type="number" name="page" min="1" max="3" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=6007&amp;page=2">&gt;</a><a href="../?id=6007&amp;page=3">&raquo;</a></form>  </div>
 </body>
</html>