<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>midi through MCI / alternatives - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2779" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2779">midi through MCI / alternatives</a></p>
   <div class="post" id="post-17825">
    <div class="subject"><a href="#post-17825">midi through MCI / alternatives</a></div>
    <div class="body">Huhu, the f0dder needs some help :/.<br /><br />Recently, while bugfixing a wonderful game (for those interested,<br />look at <a target="_blank" href="http://f0dder.has.it">http://f0dder.has.it</a> - essays/xcom pitchpatching), I noticed<br />that mci under NT based windowses is totally borked... from you<br />issue a <br /><pre><code><br />mciSendString&#40;&quot;open test.mid type sequencer alias MUSIC&quot;, NULL, 0, NULL&#41;;<br /></code></pre><br />it takes 1-5 seconds before the music starts playing. And what's<br />worse, the mciSendString doesn't return before music starts playing,<br />which means your thread freezes for some time. My solution to this<br />is a &quot;worker thread&quot; that issues mci command strings, and helper<br />functions that spawn temporary threads that pass on commands to<br />the helper threads. Did I mention that mci is not thread-safe? All<br />mci commands must be sent from the same thread. All this is pretty<br />darn dirty, but at least it works.<br /><br />I'm wondering whether there are any cleaner methods to solve this<br />problem? Perhaps by not using MCI (can't really say I like that API).<br />The music files are stored as 100% standard midi files, and my only<br />requirements are that the amount of code shouldn't be too overwhelming<br />(compared to my current fix, this shouldn't be too hard to achieve),<br />and that a change of music happens instantaneously (well, ok, a few<br />miliseconds pause is okay ;) ).<br /><br />Btw, if you look at the code in the xcom bugfix loaders, please<br />realize that I wanted to get the job done, not do anything optimized<br />or pretty&amp;clean ;).</div>
    <div class="meta">Posted on 2002-01-06 04:22:09 by f0dder</div>
   </div>
   <div class="post" id="post-18028">
    <div class="subject"><a href="#post-18028">midi through MCI / alternatives</a></div>
    <div class="body">there is an own midi API, all functions called midiXXX.<br /><br />There is also an example midi player<br />available at microsoft using this API.</div>
    <div class="meta">Posted on 2002-01-07 11:16:44 by beaster</div>
   </div>
  </div>
 </body>
</html>