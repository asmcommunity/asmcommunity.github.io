<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Accessing List Boxes and Combo Boxes - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29183" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=29183">Accessing List Boxes and Combo Boxes</a></p>
   <div class="post" id="post-206112">
    <div class="subject"><a href="#post-206112">Accessing List Boxes and Combo Boxes</a></div>
    <div class="body">I have created a Dialog box within a resource editor and here is the lines for the combo box and list box<br /><br /> CONTROL &quot;&quot;,IDC_LST1,&quot;ListBox&quot;,WS_CHILD|WS_VISIBLE|WS_VSCROLL|WS_TABSTOP|LBS_NOINTEGRALHEIGHT<br />|LBS_HASSTRINGS|LBS_NOTIFY,243,91,78,59,WS_EX_CLIENTEDGE<br />&nbsp; CONTROL &quot;&quot;,IDC_CBO1,&quot;ComboBox&quot;,WS_CHILD|WS_VISIBLE|WS_VSCROLL|WS_TABSTOP<br />|CBS_DROPDOWN,174,156,141,15<br /><br />Then within the WinProc(?) I call the following (INITDIALOG is WM_INIDIALOG i just changed it whilst messing around)<br /><br />.IF uMsg==INITDIALOG<br /><br />call SendDlgItemMessageA, hWnd, IDC_CBO1, CB_INSERTSTRING, -1, offset szSmall<br /><br />szSmall is defined as szSmall db &quot;abc&quot;,0<br /><br />But when the program runs nothing apears in the combo box, or if i modify it to use the list box again nada.<br /><br />I have tried:<br />1) calling InitCommonControls before the IF statement and after no joy. <br />2) I have tried getting the control ID by calling GetDlgItem, hWnd, IDC_CBO1 sticking 3) this into a variable and then calling SendDlgItemMessageA, variable, (as above) again fail<br />4) I have tried using SendMessage too all to no avail. <br /><br />Also the main procedure returns true at the end.<br /><br />I have had a google around and found an example of a combobox being used. Here is a snippet I found:<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; call SendDlgItemMessageA, handle, 1004, 143h, 00h, offset value11<br />	call SendDlgItemMessageA, handle, 1004, 143h, 00h, offset value12<br />	call SendDlgItemMessageA, handle, 1004, 143h, 00h, offset value13<br />	call SendDlgItemMessageA, handle, 1004, 143h, 00h, offset value14<br /><br />Nothing overly strange here compared to what I was calling. The guy that wrote above code has idc_cbo1 defined as 1004 (not sure what the 143h&#039;s are they dont appear to match any of the Combo box messages) therefore the only difference being I was setting wParam as -1 (append items to the end of the list) so I changed it to 0. stil no joy.<br /><br />I have also tried CB_ADDSTRING, CB_INSERTSTRING.<br /><br />I&#039;m sure its something simple I&#039;m missing or being over zealous, but again any help is thanked for in advance and most appreciated.<br /><br />I have also run this through olly, and see abc being passed around. and If i check the return of senddlgitemmessagea it comes back as 0 showing eveything is ok, so i&#039;m assuming I need to redraw the window? Owner redraw is set to no in the .rc file (well in the editor anyway) and I have tried calling update window, still no joy :(</div>
    <div class="meta">Posted on 2008-10-16 08:51:57 by sidey1234</div>
   </div>
   <div class="post" id="post-206114">
    <div class="subject"><a href="#post-206114">Re: Accessing List Boxes and Combo Boxes</a></div>
    <div class="body">Try using something like Microsoft&#039;s &quot;Spy++&quot; to make sure that all handles, IDs, etc. are the same as the ones you pass in your calls.</div>
    <div class="meta">Posted on 2008-10-16 15:03:50 by ti_mo_n</div>
   </div>
   <div class="post" id="post-206115">
    <div class="subject"><a href="#post-206115">Re: Accessing List Boxes and Combo Boxes</a></div>
    <div class="body">Hi, cheers, I havent tried Spy ++ (or used it before) ut i&#039;ll see if i can make it make any sense :D</div>
    <div class="meta">Posted on 2008-10-17 06:22:01 by sidey1234</div>
   </div>
   <div class="post" id="post-206117">
    <div class="subject"><a href="#post-206117">Re: Accessing List Boxes and Combo Boxes</a></div>
    <div class="body">Spy ++ didn&#039;t tell me too much just yet, but I did find a basic example that just puts a list box on the screen and when you click it it displays a messagebox on the screen saying which item you clicked.<br /><br />Good.<br /><br />I converted it from MASM32 to TASM changing invoke to to call and addr to offset etc, recompiled the resource file and run the proggie, again no win :(<br /><br />So it would appear that I am missing something within TASM, this morning I will install masm32 and try the code in there and see what happens :D</div>
    <div class="meta">Posted on 2008-10-18 04:11:24 by sidey1234</div>
   </div>
   <div class="post" id="post-206120">
    <div class="subject"><a href="#post-206120">Re: Accessing List Boxes and Combo Boxes</a></div>
    <div class="body">After going wtf as my lazy ass attempt to change call to invoke by using find/replace which also replaced stdcall to stdinvoke and spewed errors all over the place I can confirm all my listbox tests run fine within masm32, looks like i&#039;m missing something in tasm :/<br /><br />if/when i find the error i&#039;ll post it in here</div>
    <div class="meta">Posted on 2008-10-18 05:51:54 by sidey1234</div>
   </div>
   <div class="post" id="post-206123">
    <div class="subject"><a href="#post-206123">Re: Accessing List Boxes and Combo Boxes</a></div>
    <div class="body">The simplest way to add strings to a combo box is using SendMessage. <br /><br />push StringToSend<br />push 0<br />push CB_ADDSTRING<br />push ComboBoxHandle<br />call SendMessage<br /><br />I made an example in FASM which demonstrates how to add user-inputted strings, and hard-coded ones. It also shows how you (again using SendMessage), set the default item. <br /><br /><pre><code><br />format PE GUI<br />entry start<br />include &#039;..\INCLUDE\Win32a.inc&#039;<br /><br />section &#039;.data&#039; data readable writeable<br />&nbsp; &nbsp; wCls&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; WNDCLASS<br />&nbsp; &nbsp; wMsg&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MSG<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; cmbhWnd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; ?<br />&nbsp; &nbsp; cmbID&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;equ 100<br />&nbsp; &nbsp; cmbClass&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;combobox&#039;,0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; btnhWnd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; ?<br />&nbsp; &nbsp; btnID&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;equ 101<br />&nbsp; &nbsp; btnClass&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;button&#039;,0<br />&nbsp; &nbsp; btnText&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db&nbsp; &#039;Add Item&#039;,0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; edthWnd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; ?<br />&nbsp; &nbsp; edtID&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;equ 102<br />&nbsp; &nbsp; edtClass&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;edit&#039;,0<br />&nbsp; &nbsp; edtText&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db&nbsp; &#039;Item to add&#039;,0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; wndMain&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; ?<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; szClassName&nbsp; &nbsp; &nbsp;db&nbsp; &#039;comboexample&#039;,0<br />&nbsp; &nbsp; szTitle&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db&nbsp; &#039;Combo Box Example&#039;,0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; szItemA&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db&nbsp; &#039;Item A&#039;,0<br />&nbsp; &nbsp; szItemB&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db&nbsp; &#039;Item B&#039;,0<br />&nbsp; &nbsp; szBuffer&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; 512 dup 0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; szError&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;db&nbsp; 260 dup 0<br /><br />section &#039;.code&#039; code readable executable<br />&nbsp; &nbsp; start:<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;,szClassName<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;,WndProc<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 32512<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 32512<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; wCls<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;eax,0<br />&nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; errGetError<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 200<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 300<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 16<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 16<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; WS_OVERLAPPEDWINDOW<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; szTitle<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;eax,0<br />&nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; errGetError<br />&nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; SW_SHOW<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; eax<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; messageLoop:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; wMsg<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; or&nbsp; &nbsp; &nbsp; eax,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; codeEnd<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; wMsg<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; wMsg<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp;messageLoop<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; proc&nbsp; &nbsp; WndProc,hWnd,uMsg,wParam,lParam<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;,WM_DESTROY<br />&nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; wmDestroy<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;,WM_CREATE<br />&nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; wmCreate<br />&nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;,WM_COMMAND<br />&nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; wmCommand<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; wmDefault:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp;wmEnd<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; wmDestroy:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; xor&nbsp; &nbsp; &nbsp;eax,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp;wmEnd<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; wmCreate:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; cmbID<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 300<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 100<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 5<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 5<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; WS_CHILD or WS_VISIBLE or CBS_DROPDOWNLIST<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; cmbClass<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;eax,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; errGetError<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; edtID<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 25<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 135<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 30<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 5<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; WS_CHILD or WS_VISIBLE or WS_BORDER or ES_LEFT or ES_AUTOHSCROLL<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; edtClass<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; WS_EX_CLIENTEDGE<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;eax,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; errGetError<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; btnID<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 25<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 100<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 30<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 150<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; WS_CHILD or WS_VISIBLE or BS_DEFPUSHBUTTON<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; btnText<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; btnClass<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;eax,0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; errGetError<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;,eax<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Set edit box&#039;s text<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; edtText<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Add a string to combo box<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; szItemA<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; CB_ADDSTRING<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Add another string <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; szItemB<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; CB_ADDSTRING<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Set the default item<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; CB_SETCURSEL<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jmp&nbsp; &nbsp; &nbsp;wmEnd<br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; wmCommand:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; mov&nbsp; &nbsp; &nbsp;eax,<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;ax,btnID<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne&nbsp; &nbsp; &nbsp;wmEnd<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; shr&nbsp; &nbsp; &nbsp;ax,16<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;ax,BN_CLICKED<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; jne&nbsp; &nbsp; &nbsp;wmEnd<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; Get the edit box text<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 512<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; szBuffer<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cmp&nbsp; &nbsp; &nbsp;eax,0 ; Edit box empty?<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; je&nbsp; &nbsp; &nbsp; wmEnd<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; szBuffer<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; CB_ADDSTRING<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; wmEnd:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ret<br />&nbsp; &nbsp; endp<br /><br />&nbsp; &nbsp; errGetError:<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 260&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; szError&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; eax&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0x1000&nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; szError&nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br />&nbsp; &nbsp; <br />&nbsp; &nbsp; codeEnd:<br />&nbsp; &nbsp; &nbsp; &nbsp; push&nbsp; &nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; call&nbsp; &nbsp; <br /><br />section &#039;.idata&#039; import readable<br />&nbsp; &nbsp; dd&nbsp; 0,0,0,RVA user_name&nbsp; &nbsp; &nbsp;,RVA user_table<br />&nbsp; &nbsp; dd&nbsp; 0,0,0,RVA kernel_name&nbsp; &nbsp;,RVA kernel_table<br />&nbsp; &nbsp; dd&nbsp; 0,0,0,0,0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; kernel_table:<br />&nbsp; &nbsp; &nbsp; &nbsp; GetModuleHandle&nbsp; &nbsp; &nbsp;dd&nbsp; RVA _GetModuleHandle<br />&nbsp; &nbsp; &nbsp; &nbsp; FormatMessage&nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; RVA _FormatMessage<br />&nbsp; &nbsp; &nbsp; &nbsp; GetLastError&nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; RVA _GetLastError<br />&nbsp; &nbsp; &nbsp; &nbsp; ExitProcess&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; RVA _ExitProcess<br />&nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; 0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; user_table:<br />&nbsp; &nbsp; &nbsp; &nbsp; MessageBox&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; RVA _MessageBox<br />&nbsp; &nbsp; &nbsp; &nbsp; CreateWindowEx&nbsp; &nbsp; &nbsp; dd&nbsp; RVA _CreateWindowEx<br />&nbsp; &nbsp; &nbsp; &nbsp; RegisterClass&nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; RVA _RegisterClass<br />&nbsp; &nbsp; &nbsp; &nbsp; DispatchMessage&nbsp; &nbsp; &nbsp;dd&nbsp; RVA _DispatchMessage<br />&nbsp; &nbsp; &nbsp; &nbsp; TranslateMessage&nbsp; &nbsp; dd&nbsp; RVA _TranslateMessage<br />&nbsp; &nbsp; &nbsp; &nbsp; DefWindowProc&nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; RVA _DefWindowProc<br />&nbsp; &nbsp; &nbsp; &nbsp; GetMessage&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; RVA _GetMessage<br />&nbsp; &nbsp; &nbsp; &nbsp; LoadIcon&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; RVA _LoadIcon<br />&nbsp; &nbsp; &nbsp; &nbsp; LoadCursor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; RVA _LoadCursor<br />&nbsp; &nbsp; &nbsp; &nbsp; PostQuitMessage&nbsp; &nbsp; &nbsp;dd&nbsp; RVA _PostQuitMessage<br />&nbsp; &nbsp; &nbsp; &nbsp; ShowWindow&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; RVA _ShowWindow<br />&nbsp; &nbsp; &nbsp; &nbsp; SendMessage&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; RVA _SendMessage<br />&nbsp; &nbsp; &nbsp; &nbsp; SetWindowText&nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; RVA _SetWindowText<br />&nbsp; &nbsp; &nbsp; &nbsp; GetWindowText&nbsp; &nbsp; &nbsp; &nbsp;dd&nbsp; RVA _GetWindowText<br />&nbsp; &nbsp; &nbsp; &nbsp; dd&nbsp; 0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; user_name&nbsp; &nbsp;db&nbsp; &#039;USER32.DLL&#039;,0<br />&nbsp; &nbsp; kernel_name db&nbsp; &#039;KERNEL32.DLL&#039;,0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; _GetModuleHandle&nbsp; &nbsp; dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;GetModuleHandleA&#039;,0<br />&nbsp; &nbsp; _FormatMessage&nbsp; &nbsp; &nbsp; dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;FormatMessageA&#039;,0<br />&nbsp; &nbsp; _GetLastError&nbsp; &nbsp; &nbsp; &nbsp;dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;GetLastError&#039;,0<br />&nbsp; &nbsp; _ExitProcess&nbsp; &nbsp; &nbsp; &nbsp; dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;ExitProcess&#039;,0<br />&nbsp; &nbsp; <br />&nbsp; &nbsp; _MessageBox&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;MessageBoxA&#039;,0<br />&nbsp; &nbsp; _CreateWindowEx&nbsp; &nbsp; &nbsp;dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;CreateWindowExA&#039;,0<br />&nbsp; &nbsp; _RegisterClass&nbsp; &nbsp; &nbsp; dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;RegisterClassA&#039;,0<br />&nbsp; &nbsp; _DispatchMessage&nbsp; &nbsp; dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;DispatchMessageA&#039;,0<br />&nbsp; &nbsp; _TranslateMessage&nbsp; &nbsp;dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;TranslateMessage&#039;,0<br />&nbsp; &nbsp; _DefWindowProc&nbsp; &nbsp; &nbsp; dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;DefWindowProcA&#039;,0<br />&nbsp; &nbsp; _GetMessage&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;GetMessageA&#039;,0<br />&nbsp; &nbsp; _LoadIcon&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;LoadIconA&#039;,0<br />&nbsp; &nbsp; _LoadCursor&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;LoadCursorA&#039;,0<br />&nbsp; &nbsp; _PostQuitMessage&nbsp; &nbsp; dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;PostQuitMessage&#039;,0<br />&nbsp; &nbsp; _ShowWindow&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;ShowWindow&#039;,0<br />&nbsp; &nbsp; _SendMessage&nbsp; &nbsp; &nbsp; &nbsp; dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;SendMessageA&#039;,0<br />&nbsp; &nbsp; _SetWindowText&nbsp; &nbsp; &nbsp; dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;SetWindowTextA&#039;,0<br />&nbsp; &nbsp; _GetWindowText&nbsp; &nbsp; &nbsp; dw&nbsp; 0<br />&nbsp; &nbsp; &nbsp; &nbsp; db&nbsp; &#039;GetWindowTextA&#039;,0<br /></code></pre><br /><br />Note. To change the default combo box item its the third parameter of:<br /><br /><pre><code><br />push&nbsp; &nbsp; 0<br />push&nbsp; &nbsp; 0<br />push&nbsp; &nbsp; CB_SETCURSEL<br />push&nbsp; &nbsp; <br />call&nbsp; &nbsp; &nbsp; <br /></code></pre><br /><br />And is the index of the item (starting at zero)</div>
    <div class="meta">Posted on 2008-10-18 06:59:03 by Unknown</div>
   </div>
   <div class="post" id="post-206124">
    <div class="subject"><a href="#post-206124">Re: Accessing List Boxes and Combo Boxes</a></div>
    <div class="body">ugh - push push push push push push push push call looks so ugly and makes your code harder to read.<br />Sure there are times where we can shave a few cycles by doing it, but I think most asm programmers prefer to use a less machinecode syntax.<br /><br />Sorry for whining, I&#039;ll shut up now.<br /></div>
    <div class="meta">Posted on 2008-10-18 07:24:34 by Homer</div>
   </div>
   <div class="post" id="post-206125">
    <div class="subject"><a href="#post-206125">Re: Accessing List Boxes and Combo Boxes</a></div>
    <div class="body"> :D I like pushes over invoke. Its all personal preference ain&#039;t it. I find pushes and calls easier to read that invokes in some cases though... </div>
    <div class="meta">Posted on 2008-10-18 07:57:44 by Unknown</div>
   </div>
   <div class="post" id="post-206137">
    <div class="subject"><a href="#post-206137">Re: Accessing List Boxes and Combo Boxes</a></div>
    <div class="body">Problem Solved!!<br /><br />It turns out the windows.inc file I had with my TASM distribution is messed up. After copying the LB_ADDSTRING etc bits from the MASM32 version everything works.<br /><br />Sad Panda :(</div>
    <div class="meta">Posted on 2008-10-19 09:13:10 by sidey1234</div>
   </div>
  </div>
 </body>
</html>