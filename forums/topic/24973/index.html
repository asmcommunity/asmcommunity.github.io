<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How Can i hook an API function in Winnt - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24973" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24973">How Can i hook an API function in Winnt</a></p>
   <div class="post" id="post-182729">
    <div class="subject"><a href="#post-182729">How Can i hook an API function in Winnt</a></div>
    <div class="body">Basicly i want to write a little program that replaces the generic windows message box with my own that&#39;ll add &#39;dont show this again&#39; messagebox to all however ive encounted some problems<br /><br />My first method was VERY program specific:Replacing the calls/thunks inside the progam to a library I force loaded into the program <br />Problem: Since this modifies the programs code it is legally dubious and likley to fail on protected apps that dont like code tampering<br />Conclusion : not a good idea! I need to go higher up the pecking order.<br /><br />2nd Method:Replace the Api functions first code bytes to point to my own function loaded via a VXD.<br />Problem: ive been told this wont work in nt due to it not using a shared code section in the user32.dll.Therefore and hack like this would still be program specific in spite of the fact i&#39;ve modified a system dll (albiet in memory!)<br /><br />3 Tried using the windows Hook api funtions but they seem to only deal with message processing.Although i can use this method to ensure my dll is loaded into all progams (for messing with thunks etc). I still have the same problems exitibited in the 1st method! :sad:<br /><br />I know this questions prob. been asked a million times before but 3 days of banging my head on my desk has broken me just a little bit inside and i need your help to rebuild the shatted remains of my self-confidence!&nbsp; ;)<br /><br />Thx in advance........<br /></div>
    <div class="meta">Posted on 2006-07-01 19:20:20 by asmrixstar</div>
   </div>
   <div class="post" id="post-182743">
    <div class="subject"><a href="#post-182743">Re: How Can i hook an API function in Winnt</a></div>
    <div class="body">State whether the functions you wish to hook are within the context of the local process, a child process, or some remote process.. then explain why you want to hook functions, and depending apon your response, I&#39;ll help you to achieve your goals.<br /><br /><br /><br /></div>
    <div class="meta">Posted on 2006-07-02 02:09:28 by Homer</div>
   </div>
   <div class="post" id="post-182775">
    <div class="subject"><a href="#post-182775">Re: How Can i hook an API function in Winnt</a></div>
    <div class="body">Basiclly the idea of the program is to replace/redirect the standard MessageBox api function within windows to my own function that would ask the question AND remember the answer to the questions regardless of the original programs code.<br />AKA. (Badly drawn ascii messagebox :D)<br />------------------------------<br />Are you sure you want to Quit?<br />&nbsp; &nbsp; &nbsp; &nbsp;  -YES-&nbsp; &nbsp; &nbsp; -NO-<br /><br />v&quot;Dont ask this Question Again&quot;<br />------------------------------<br />This answer would be rembered on request and the user would not be asked again that question from that program.<br /><br />The hook should be system wide affecting any program that calls the MessageBoxA api. (I only mentioned other methods so that people dont suggest methods ive already tried,my bad!) <br /><br />I dont believe this thread breaks the rules of the forum but if it does please simply delete it. As with most of my projects not that bothered about this specific API/program, more learning the process behind doing something like this.<br /><br />Before anyone gets shirty about cracking and stuff i think i made it clear in my first post that im not interested in doing any thing that would damage peoples copyrights. Thats why i asked a about a system hook rather than redirecting their thunks.etc. <br /><br />Besides which any program protection that can be broken simply by redirecting its API functions would prolly be cracked by other means much easier so i dont think this can be veiwed as a crackers post. <br />(which is what i think your post hints at,i could be wrong)<br />thx.<br /></div>
    <div class="meta">Posted on 2006-07-02 07:08:28 by asmrixstar</div>
   </div>
   <div class="post" id="post-182792">
    <div class="subject"><a href="#post-182792">Re: How Can i hook an API function in Winnt</a></div>
    <div class="body">Despite that, you might find your answer at Woodmann&#39;s RCE Forum.</div>
    <div class="meta">Posted on 2006-07-02 12:00:36 by SpooK</div>
   </div>
   <div class="post" id="post-182804">
    <div class="subject"><a href="#post-182804">Re: How Can i hook an API function in Winnt</a></div>
    <div class="body">woop woop,spook! thx</div>
    <div class="meta">Posted on 2006-07-02 13:48:01 by asmrixstar</div>
   </div>
   <div class="post" id="post-182829">
    <div class="subject"><a href="#post-182829">Re: How Can i hook an API function in Winnt</a></div>
    <div class="body">A few hints:<br />Manipulating the Import Address Table of arbitrary processes, or manipulating the Export Address Table of a loaded DLL.. these are not suitable topics for discussion in *this* forum.. HOWEVER, if you have no luck, by all means email me for assistance, as these are certainly subjects which I&#39;ve explored in depth&nbsp; 8)<br /><br /><br /></div>
    <div class="meta">Posted on 2006-07-03 06:33:52 by Homer</div>
   </div>
   <div class="post" id="post-182831">
    <div class="subject"><a href="#post-182831">Re: How Can i hook an API function in Winnt</a></div>
    <div class="body">thanks homer<br />Im looking into that now..</div>
    <div class="meta">Posted on 2006-07-03 06:40:42 by asmrixstar</div>
   </div>
   <div class="post" id="post-182867">
    <div class="subject"><a href="#post-182867">Re: How Can i hook an API function in Winnt</a></div>
    <div class="body"><div class="quote"><br />thanks homer<br />Im looking into that now..<br /></div><br /><br />He stole one of my ideas for an avatar :&#39;(</div>
    <div class="meta">Posted on 2006-07-03 17:34:59 by SpooK</div>
   </div>
   <div class="post" id="post-182891">
    <div class="subject"><a href="#post-182891">Re: How Can i hook an API function in Winnt</a></div>
    <div class="body"> :D :mrgreen:&nbsp; LMAO&nbsp;  :D :mrgreen:<br /><br />You can have it m8 I intend to change at July 05, 2006, 01:56:22 pm<br />So grab it b4 then!</div>
    <div class="meta">Posted on 2006-07-04 07:57:54 by asmrixstar</div>
   </div>
   <div class="post" id="post-182893">
    <div class="subject"><a href="#post-182893">Re: How Can i hook an API function in Winnt</a></div>
    <div class="body"><div class="quote"><br /> :D :mrgreen:&nbsp; LMAO&nbsp;  :D :mrgreen:<br /><br />You can have it m8 I intend to change at July 05, 2006, 01:56:22 pm<br />So grab it b4 then!<br /></div><br /><br />I just might :P</div>
    <div class="meta">Posted on 2006-07-04 08:04:42 by SpooK</div>
   </div>
  </div>
 </body>
</html>