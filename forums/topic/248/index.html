<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Interface IEnumInterface available? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=248" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=248">Interface IEnumInterface available?</a></p>
   <div class="post" id="post-1290">
    <div class="subject"><a href="#post-1290">Interface IEnumInterface available?</a></div>
    <div class="body">I want to enumerate the interfaces an object supports. Is this to be done manualle (check all entries in HKEY_CLASSES_ROOT\Interface) or is there a better solution?</div>
    <div class="meta">Posted on 2001-07-19 09:02:52 by japheth</div>
   </div>
   <div class="post" id="post-1346">
    <div class="subject"><a href="#post-1346">Interface IEnumInterface available?</a></div>
    <div class="body">That's it. COM is built on the assumption a developer has all the info on the objects needed.<br /><br />That's why QueryInterface takes an IID but doesn't return one, ie, it doesn't enumerate it's interfaces for you.</div>
    <div class="meta">Posted on 2001-07-19 19:12:02 by Ernie</div>
   </div>
   <div class="post" id="post-1749">
    <div class="subject"><a href="#post-1749">Interface IEnumInterface available?</a></div>
    <div class="body">you can do it like the &quot;oleview&quot; toolfrom Microsoft, which enumerates the <br />interfaces by asking ALL available interface to the object, <br />and listing those, where the object returns ok :)</div>
    <div class="meta">Posted on 2001-07-23 03:53:31 by beaster</div>
   </div>
   <div class="post" id="post-1818">
    <div class="subject"><a href="#post-1818">Interface IEnumInterface available?</a></div>
    <div class="body">Nope, that's not what OleView is doing at all. It's actually reading the type librarys for registered objects.<br /><br />The COM contract only states one MAY post info in the type lib, not that one MUST, nor make it publish every interface.<br /><br />And reading typelibs in code is one sure path to madness.</div>
    <div class="meta">Posted on 2001-07-23 18:18:43 by Ernie</div>
   </div>
   <div class="post" id="post-1861">
    <div class="subject"><a href="#post-1861">Interface IEnumInterface available?</a></div>
    <div class="body">&gt; It's actually reading the type librarys for registered objects<br /><br />this seems to be for objects that provide typelibs.<br /><br />I tried to debug my own .ocx control and lauched oleview <br />and opened there my own activex object. I'd like to see, which <br />interfaces I correctly export to windows and which ones not.<br /><br />I made a MessageBox inside QueryInterface, that shows up, <br />if an interface is queried which I don't implement.<br /><br />Right after starting this, I got about 1000 MessageBoxes with<br />all available interfaces from the system. A look into a registry <br />monitor during this told me, that oleview really enumerates all<br />interface IDs from HKEY_CLASSES_ROOT.<br /><br />beaster.</div>
    <div class="meta">Posted on 2001-07-24 03:55:47 by beaster</div>
   </div>
   <div class="post" id="post-1895">
    <div class="subject"><a href="#post-1895">Interface IEnumInterface available?</a></div>
    <div class="body">I do like OLEVIEW does and it works without problem and sufficiently fast (read all IIDs in a memory buffer by scaning CLSID\Interface one time and then query the objects with all of them).</div>
    <div class="meta">Posted on 2001-07-24 10:14:37 by japheth</div>
   </div>
  </div>
 </body>
</html>