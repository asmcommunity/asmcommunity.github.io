<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Newbie hello world help. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1533" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1533">Newbie hello world help.</a></p>
   <div class="post" id="post-9845">
    <div class="subject"><a href="#post-9845">Newbie hello world help.</a></div>
    <div class="body">Hi all,<br /><br />I am trying to pick up some Win32asm. I am doing the &quot;hello world&quot; first program (plz don't laugh ;) ) from <a target="_blank" href="http://www.thomasbleeker.nl/exagone/WIN32ASM/tutor12.html">http://www.thomasbleeker.nl/exagone/WIN32ASM/tutor12.html</a><br />I have adjusted his code to reflect my 'MASM' directory rather than his 'MASM32' dir. I got the required .inc and .lib files from another PC which has MASM32 v6 SP2 installed, and added them to the appropriate MASM folders.<br /><br />When I follow his instructions I get the following error:<br /><br />&quot;first.obj : fatal error L1101: invalid object module&quot;<br /><br />Could anybody please tell me what's going wrong?<br /><br />Thanks,<br />Bill Miller<br /><br /><br /><br />Below are my program specs and complete console dump of command prompt error:<br /><br />WinXP; MASM 6.15 and Link 5.63<br /><br />My (User) Variables:<br />PATH=C:\MASM\BIN;C:\MASM\BINR;%PATH%<br />LIB=C:\MASM\LIB<br />INCLUDE=C:\MASM\INCLUDE<br />INIT=C:\MASM\INIT<br />HELPFILES=C:\MASM\HELP\*.HLP<br />ASMEX=C:\MASM\SAMPLES<br /><br />NOTE: I do *NOT* have MASM32 installed. I got the .lib and .inc files from another computer.<br /><br />kernel32.lib, user32.lib, kernel32.inc, user32.inc (MASM32 v6SP2)<br />windows.inc v1.25<br /><br />Here's my cmd-prompt dump:<br />ps. when I leave out the '/subsystem:windows' it won't complain about that but the 'invalid object module error' remains.<br />C:\MASM\BIN&gt;make<br />Microsoft (R) Macro Assembler Version 6.15.8803<br />Copyright (C) Microsoft Corp 1981-2000.  All rights reserved.<br /><br /> Assembling: first.asm<br /><br />Microsoft (R) Segmented Executable Linker  Version 5.60.339 Dec  5 1994<br />Copyright (C) Microsoft Corp 1984-1993.  All rights reserved.<br /><br />LINK : warning L4017: /subsystem : unrecognized option name; option ignored<br />Run File :<br />List File :<br />Libraries [.lib]:<br />Definitions File :<br />first.obj : fatal error L1101: invalid object module<br />Object file offset: 1 Record type: 4c<br /><br />C:\MASM\BIN&gt;<br /><br />---end of message---</div>
    <div class="meta">Posted on 2001-10-20 20:45:30 by Nuffsaid</div>
   </div>
   <div class="post" id="post-9848">
    <div class="subject"><a href="#post-9848">Newbie hello world help.</a></div>
    <div class="body">Hi  Nuffsaid<br /><br />My Link.exe is version 5.012.8078.0<br /><br />Try getting this linker.<br /><br />KetilO</div>
    <div class="meta">Posted on 2001-10-20 21:07:17 by KetilO</div>
   </div>
   <div class="post" id="post-9852">
    <div class="subject"><a href="#post-9852">Newbie hello world help.</a></div>
    <div class="body">Hi KetilO,<br /><br />I tried it with the oldest version I could find for now (Masm 6.11):<br />Microsoft (R) Segmented Executable Linker  Version 5.31.009 Jul 13 1992<br /><br />Still same error. I should have a version 5.x of MASM archived somewhere.<br /><br />Did it work for you? Could it be because you have MASM32 installed?<br /><br />Thanks,<br /><br />Bill Miller</div>
    <div class="meta">Posted on 2001-10-20 21:37:24 by Nuffsaid</div>
   </div>
   <div class="post" id="post-9853">
    <div class="subject"><a href="#post-9853">Newbie hello world help.</a></div>
    <div class="body"><pre><code>Microsoft &#40;R&#41; Macro Assembler Version 7.00.9254<br />Copyright &#40;C&#41; Microsoft Corporation.  All rights reserved.<br /><br /> Assembling&#58; first.asm<br />Microsoft &#40;R&#41; Incremental Linker Version 7.00.9254<br />Copyright &#40;C&#41; Microsoft Corporation.  All rights reserved.<br /><br />Make finished.</code></pre>Sorry, I'm no help. :)<br />This is with:<br />ML /c /coff /Cp first.asm<br />LINK /SUBSYSTEM:WINDOWS /RELEASE /VERSION:4.0 first.obj</div>
    <div class="meta">Posted on 2001-10-20 22:02:48 by bitRAKE</div>
   </div>
   <div class="post" id="post-9854">
    <div class="subject"><a href="#post-9854">Newbie hello world help.</a></div>
    <div class="body">Hi Nuffsaid<br /><br />Works well.<br /><br />Microsoft (R) Macro Assembler Version 6.15.8803<br />Copyright (C) Microsoft Corp 1981-2000.  All rights reserved.<br /><br /> Assembling: first.asm<br />Microsoft (R) Incremental Linker Version 5.12.8078<br />Copyright (C) Microsoft Corp 1992-1998. All rights reserved.<br /><br />Make finished.<br /><br />I guess you should dl the masm32 pack.<br /><br />I have also included a RadASM project of first.asm.<br /><br />So bitRAKE, got hold of 7.0?<br /><br />KetilO</div>
    <div class="meta">Posted on 2001-10-20 22:46:48 by KetilO</div>
   </div>
   <div class="post" id="post-9856">
    <div class="subject"><a href="#post-9856">Newbie hello world help.</a></div>
    <div class="body"><strong>MovingFulcrum</strong> sent me 7.0 a couple of months ago, but it was from VS.NET beta 1.  I got beta 2 from the Dr. Dobbs mag.  I've been going through the tuts - like C# so far.  I'm kind of wondering how hard it'd be to create an custom MASM editor for VS.NET.  It would be hypocricy, but that's way I'd like it. :)</div>
    <div class="meta">Posted on 2001-10-20 23:35:02 by bitRAKE</div>
   </div>
   <div class="post" id="post-9870">
    <div class="subject"><a href="#post-9870">Newbie hello world help.</a></div>
    <div class="body">Nuffsaid: your problem is the linker. You have the same linker as the one in the download section of win32asm.cjb.net, but this linker can only be used for linking DOS programs (afaik). So unless you have a good reason to not install the masm32 package, I really advice you to install it. It ensures that all (well most..) programs created with masm32 assemble correctly and it has a bunch of nice programs and examples too..<br /><br />Thomas</div>
    <div class="meta">Posted on 2001-10-21 04:02:02 by Thomas</div>
   </div>
   <div class="post" id="post-9883">
    <div class="subject"><a href="#post-9883">It worked! :)</a></div>
    <div class="body">YES!<br />Thanks all for replying. Like Thomas suggested, installing MASM32 fixed it for me. Dank je, gozer. :)<br /><br />I'm happy. Regards,<br />Bill Miller</div>
    <div class="meta">Posted on 2001-10-21 07:00:12 by Nuffsaid</div>
   </div>
   <div class="post" id="post-9885">
    <div class="subject"><a href="#post-9885">for the record...</a></div>
    <div class="body">Oh, and for the record...<br />KetilO was indeed the first to suggest d/l'ing MASM32. Credit where credit is due; I just got up and my brains are still loading up. ;)<br /><br />Thnx,<br />Bill</div>
    <div class="meta">Posted on 2001-10-21 07:07:09 by Nuffsaid</div>
   </div>
  </div>
 </body>
</html>