<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>retrieving closest word from a point in richedit - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27592" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27592">retrieving closest word from a point in richedit</a></p>
   <div class="post" id="post-197035">
    <div class="subject"><a href="#post-197035">retrieving closest word from a point in richedit</a></div>
    <div class="body">hi
i want to retrieve the closest word when i right click in a richedit box (without using selection).
I've make SetWindowLong on richedit for right click :OK.
but i've some problem to retrieve char from pos :
i think i must use EM_CHARFROMPOS for first char pos and EM_FINDWORDBREAK for delimiting previous and next break of the whole word (WB_MOVEWORDLEFT and WB_MOVEWORDRIGHT).
but:
invoke SendMessageA, hRichEdit, EM_CHARFROMPOS, 0, MyCursorPos
crash all.
MyCursoPos is a dword with x in low-order word and y in high-order word.

hmm is this ? 
XXXXYYYYh (a dword with xxxx for low-order word and yyyy for high-order word, right?)

if someone have some tricks or code source :):)</div>
    <div class="meta">Posted on 2001-04-10 12:47:00 by gael</div>
   </div>
  </div>
 </body>
</html>