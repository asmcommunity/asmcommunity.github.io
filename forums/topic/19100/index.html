<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>special keys in a redirected console - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19100" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19100">special keys in a redirected console</a></p>
   <div class="post" id="post-147661">
    <div class="subject"><a href="#post-147661">special keys in a redirected console</a></div>
    <div class="body">Hi,<br /><br />I wrote a kind of program that creates a win32 console process (say cmd.exe) with std i/o handles redirected to my own made Pipes which I can read and write with ReadFile and WriteFile.  So I can manually send characters to the process like the user pressed the key, and I can receive the output from the process like if it was to be written to the screen. Sounds maye like a shellcode, except the network stuff, but it should become something totally different.<br /><br />Everything works fine, except this: in cmd.exe, if you press , you'll get a filename over your cursor that matches the wildcard you entered (if any). if you press up, you'll get your last command, etc.<br /><br />My question is: how can i fake these keys, like the user entered them? and how do programs like cmd.exe check for these keys?<br /><br />Thanks in advance.</div>
    <div class="meta">Posted on 2004-08-08 12:37:31 by Mbee</div>
   </div>
   <div class="post" id="post-147732">
    <div class="subject"><a href="#post-147732">special keys in a redirected console</a></div>
    <div class="body">The only option I can think of, short of writing a new console device driver, is creating a console and then giving the new process the input handle from your console. Then you should be able to write to it with WriteConsoleInput. A downside to this is that a blank console window will be shown.</div>
    <div class="meta">Posted on 2004-08-09 10:14:52 by Sephiroth3</div>
   </div>
   <div class="post" id="post-147745">
    <div class="subject"><a href="#post-147745">special keys in a redirected console</a></div>
    <div class="body">You want to generate these events without having a visible console screen?</div>
    <div class="meta">Posted on 2004-08-09 11:56:25 by f0dder</div>
   </div>
   <div class="post" id="post-147821">
    <div class="subject"><a href="#post-147821">special keys in a redirected console</a></div>
    <div class="body">f0dder: yes.<br />Sephiroth3: I don't think that way is worth all the work.</div>
    <div class="meta">Posted on 2004-08-10 04:39:51 by Mbee</div>
   </div>
   <div class="post" id="post-147829">
    <div class="subject"><a href="#post-147829">special keys in a redirected console</a></div>
    <div class="body">Hmmm... sounds tricky. A really crude workaround would be creating the child process, injecting code to get the window handle of the console, hiding this window with showwindow, and passing the console handles along to the parent process...<br /><br />I hope there's some nice and easy way I haven't thought of :)</div>
    <div class="meta">Posted on 2004-08-10 07:35:00 by f0dder</div>
   </div>
   <div class="post" id="post-147830">
    <div class="subject"><a href="#post-147830">special keys in a redirected console</a></div>
    <div class="body">hehehe, that is really a crude way indeed :) <br />btw, what i am coding is a kind of console to moviestyle-console modifier. the standard console/dosbox you are used to but then with a glow around the characters, funky backgrounds (3d stuff), etc. it was more a little project and i thought that it could have been done quite easily, but appearantly it isn't :(<br /><br />attached is a screenshot of the current layout.</div>
    <div class="meta">Posted on 2004-08-10 07:42:49 by Mbee</div>
   </div>
   <div class="post" id="post-147831">
    <div class="subject"><a href="#post-147831">special keys in a redirected console</a></div>
    <div class="body">attachment?</div>
    <div class="meta">Posted on 2004-08-10 07:43:37 by Mbee</div>
   </div>
  </div>
 </body>
</html>