<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Ctrl+V and Richedit - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4164" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4164">Ctrl+V and Richedit</a></p>
   <div class="post" id="post-28599">
    <div class="subject"><a href="#post-28599">Ctrl+V and Richedit</a></div>
    <div class="body">Hello!<br /><br />If there is formated text into the clipboard but I want to paste only plain text i have to use EM_PASTESPECIAL and set CF_TEXT as the format.<br /><br />Ok..all right so far, but i want to paste plain text also when pressing &quot;CTRL + V&quot; into a richedit. I've subclassed it already but now I don't know how to let the programm know that the user presses Ctrl+V .<br /><br />I've used WM_CHAR but it does not work.<br />Any ideas?<br /><br />Thx!</div>
    <div class="meta">Posted on 2002-03-12 12:02:47 by Rennsemmel</div>
   </div>
   <div class="post" id="post-28636">
    <div class="subject"><a href="#post-28636">Ctrl+V and Richedit</a></div>
    <div class="body">subclass<br /><br />then<br /><pre><code><br />.if uMsg == WM_KEYDOWN<br />   .if wParam == VK_CONTROL<br />      ;do whatever<br />   .elseif wParam == VK_V<br />      ;do whatever<br />   .endif</code></pre><br /><br />this will at least let you know when one or the other is pressed while your richedit has focus. the problem i have is how to recognize that both are pressed at the same time. i tried something like this:<br /><br />.if wParam == VK_CONTROL &amp;&amp; VK_V<br />;do whatever<br />.endif<br /><br />and this didnt work. so maybe this might get you going in the right dirrection.. *shrug*</div>
    <div class="meta">Posted on 2002-03-12 14:53:01 by smurf</div>
   </div>
   <div class="post" id="post-28642">
    <div class="subject"><a href="#post-28642">Ctrl+V and Richedit</a></div>
    <div class="body">GetAsyncKeyState - can handle 2 key down messages, the worst of all you have to recode your main loop, but that isn't a problem. :)</div>
    <div class="meta">Posted on 2002-03-12 15:13:06 by stryker</div>
   </div>
   <div class="post" id="post-28680">
    <div class="subject"><a href="#post-28680">Ctrl+V and Richedit</a></div>
    <div class="body">Yep,<br /><br />You must process what you are after in the main loop. Trap the WM_KEYUP/DOWN messages and bypass the original and substitute your own Ctl+V handling with the WM_PASTESPECIAL style.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-03-12 20:24:58 by hutch--</div>
   </div>
   <div class="post" id="post-28748">
    <div class="subject"><a href="#post-28748">Ctrl+V and Richedit</a></div>
    <div class="body">Depending on what else is happening in your program it may be worth considering defining Ctrl-V as an ACCELERATOR<br /><br />eGo</div>
    <div class="meta">Posted on 2002-03-13 05:18:21 by eGo</div>
   </div>
   <div class="post" id="post-29108">
    <div class="subject"><a href="#post-29108">Ctrl+V and Richedit</a></div>
    <div class="body">What about subclassing WM_PASTE?</div>
    <div class="meta">Posted on 2002-03-15 04:38:48 by bazik</div>
   </div>
  </div>
 </body>
</html>