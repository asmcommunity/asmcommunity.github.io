<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Question About SendInput - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19672" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19672">Question About SendInput</a></p>
   <div class="post" id="post-151304">
    <div class="subject"><a href="#post-151304">Question About SendInput</a></div>
    <div class="body">Hi <br />I use SendInput function to synthesizes keystrokes . and i can let the keyboard be Pressed . but i can't let the key be released after being pressed. <br /><br />the code below is the function i written: <br /><br />procedure RelKey(wVK : WORD; wSanCode :WORD); <br />var <br />aInput:array[0..3] of TINPUT ; <br />UpKey : TINPUT ; <br />begin // aInput[0] , aInput[1] press key, aInput[2] aInput[3] release key <br /><br />aInput[0].ki.wVk := wVK; <br />aInput[0].ki.wScan := wSanCode; <br />aInput[0].Itype:= INPUT_KEYBOARD; <br />aInput[0].ki.dwExtraInfo:=0; <br />aInput[0].ki.dwFlags:=KEYEVENTF_EXTENDEDKEY; <br />aInput[0].ki.time :=0; <br /><br />aInput[1].ki.wVk := wVK; <br />aInput[1].ki.wScan := wSanCode; <br />aInput[1].Itype:= INPUT_KEYBOARD; <br />aInput[1].ki.dwExtraInfo:=0; <br />aInput[1].ki.dwFlags:=KEYEVENTF_EXTENDEDKEY; <br />aInput[1].ki.time :=GetTickCount(); <br /><br />aInput[2].ki.wVk := wVK; <br />aInput[2].ki.wScan := wSanCode; <br />aInput[2].Itype:= INPUT_KEYBOARD; <br />aInput[2].ki.dwExtraInfo:=0; <br />aInput[2].ki.dwFlags:=KEYEVENTF_KEYUP; <br />aInput[2].ki.time :=GetTickCount(); <br /><br />aInput[3].ki.wVk := wVK; <br />aInput[3].ki.wScan := wSanCode; <br />aInput[3].Itype:= INPUT_KEYBOARD; <br />aInput[3].ki.dwExtraInfo:=0; <br />aInput[3].ki.dwFlags:=KEYEVENTF_KEYUP; <br />aInput[3].ki.time :=GetTickCount(); <br />asm <br />push $1c ; <br />lea eax, ; //here is a pointer to aInput <br />push eax ; <br />push 1 ; <br />call SendInput; <br />end; <br /><br /><br />end; <br /><br />i just want the key to be released after being pressed . <br /><br />PS: i have used keybd_event and postmessage .and can't do that yet <br /><br />Thanx for all .</div>
    <div class="meta">Posted on 2004-10-15 10:13:28 by nbw</div>
   </div>
   <div class="post" id="post-151305">
    <div class="subject"><a href="#post-151305">Question About SendInput</a></div>
    <div class="body">Because i was under direct entirment . so i can't use keybd_event .</div>
    <div class="meta">Posted on 2004-10-15 10:14:24 by nbw</div>
   </div>
   <div class="post" id="post-151307">
    <div class="subject"><a href="#post-151307">Question About SendInput</a></div>
    <div class="body">What is direct entirement?<br />Dominik</div>
    <div class="meta">Posted on 2004-10-15 10:29:16 by Dom</div>
   </div>
   <div class="post" id="post-151308">
    <div class="subject"><a href="#post-151308">Question About SendInput</a></div>
    <div class="body">like some famous games . such as Final Fanacy.....</div>
    <div class="meta">Posted on 2004-10-15 10:34:42 by nbw</div>
   </div>
   <div class="post" id="post-151312">
    <div class="subject"><a href="#post-151312">Question About SendInput</a></div>
    <div class="body">And that game cannot be controlled using keydb_event !? Strange things....</div>
    <div class="meta">Posted on 2004-10-15 13:53:19 by Dom</div>
   </div>
   <div class="post" id="post-151314">
    <div class="subject"><a href="#post-151314">Question About SendInput</a></div>
    <div class="body">yes , sir . many games cannot be controlled with Keybd_event .<br /><br />anyone help me ? <br /><br />thanx.</div>
    <div class="meta">Posted on 2004-10-15 15:22:44 by nbw</div>
   </div>
  </div>
 </body>
</html>