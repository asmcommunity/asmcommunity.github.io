<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>NAGOA+.INC     released - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17765" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=17765">NAGOA+.INC     released</a></p>
   <div class="post" id="post-137165">
    <div class="subject"><a href="#post-137165">NAGOA+.INC     released</a></div>
    <div class="body">get it here :<br /><br /><a target="_blank" href="http://visual-assembler.pt.vu">http://visual-assembler.pt.vu</a><br /><br /><br /><br />here an example based on WINENUM.ASM of masm HUTCH package<br />converted to NAGOA+.INC  ( nasm )<br /><br /><br /><br /><br /><pre><code><br />%include &quot;\lab\vasm\inc\nagoa+.inc&quot;<br /><br /><br /><br />; - - - - - - - - - - - - - - - - - - -<br />data use32        ; data that will  be in the exe file <br /><br />szClassName  db &quot;NaGoA&quot;<br /><br />; - - - - - - - - - - - - - - - - - - -<br />bss use32          ; data that will  not be in the exe file <br /><br />        CommandLine   dd 0<br />        hWnd             dd 0<br />        hInstance      dd 0<br />        hList             dd 0<br />        hStat1          dd 0<br />        hStat2          dd 0<br />        lpfnListProc    dd 0<br /><br />; - - - - - - - - - - - - - - - - - - -<br />code use32<br /><br />..start&#58;<br />        invoke GetModuleHandle, NULL<br />        mov &#91;hInstance&#93;, eax<br />        invoke GetCommandLine<br />        loccall WinMain,&#91;hInstance&#93;,NULL,eax,SW_SHOWDEFAULT<br />        invoke ExitProcess,eax<br /><br />; - - - - - - - - - - - - - - - - - - -<br />proc WinMain , hInst , hPrevInst , CmdLine , CmdShow<br /><br />        stack wc,WNDCLASSEX_size ,\<br />                 msg,MSG_size ,\<br />                 Wwd,4 ,\<br />                 Wht,4 ,\<br />                 Wtx,4 ,\<br />                 Wty,4<br /><br />        mov dword &#91;@wc+WNDCLASSEX.cbSize&#93;,  WNDCLASSEX_size<br />        mov dword &#91;@wc+WNDCLASSEX.style&#93;,   CS_BYTEALIGNWINDOW<br />        mov dword &#91;@wc+WNDCLASSEX.lpfnWndProc&#93;,  WndProc<br />        mov dword &#91;@wc+WNDCLASSEX.cbClsExtra&#93;,     NULL<br />        mov dword &#91;@wc+WNDCLASSEX.cbWndExtra&#93;,     NULL<br />        m2m &#91;@wc+WNDCLASSEX.hInstance&#93;,      &#91;@hInst&#93;   <br />        mov dword &#91;@wc+WNDCLASSEX.hbrBackground&#93;,  COLOR_BTNFACE+1<br />        mov dword &#91;@wc+WNDCLASSEX.lpszMenuName&#93;,   NULL<br />        mov dword &#91;@wc+WNDCLASSEX.lpszClassName&#93;,szClassName<br />        invoke LoadIcon,&#91;@hInst&#93;,500    ; icon ID<br />        movd &#91;@wc+WNDCLASSEX.hIcon&#93;,  eax<br />        invoke LoadCursor,NULL,IDC_ARROW<br />        mov dword &#91;@wc+WNDCLASSEX.hCursor&#93;, eax<br />        mov dword  &#91;@wc+WNDCLASSEX.hIconSm&#93;, 0<br /><br />        invoke RegisterClassEx, addr @wc<br />        mov dword &#91;@Wwd&#93;, 600<br />        mov dword &#91;@Wht&#93;, 350<br />        invoke GetSystemMetrics,SM_CXSCREEN<br />        loccall TopXY,&#91;@Wwd&#93;,eax<br />        mov &#91;@Wtx&#93;, eax<br />        invoke GetSystemMetrics,SM_CYSCREEN<br />        loccall TopXY,&#91;@Wht&#93;,eax<br />        mov &#91;@Wty&#93;, eax<br /><br />        invoke CreateWindowEx,WS_EX_OVERLAPPEDWINDOW,\<br />                              szClassName,\<br />                              &quot;Enumerate Windows&quot;,\<br />                              WS_OVERLAPPEDWINDOW,\<br />                              &#91;@Wtx&#93;,&#91;@Wty&#93;,&#91;@Wwd&#93;,&#91;@Wht&#93;,\<br />                              NULL,NULL,\<br />                              &#91;@hInst&#93;,NULL<br />        mov   &#91;hWnd&#93; , eax<br /><br />        invoke EnumWindows,EnmProc,0<br /><br />        invoke LoadMenu,&#91;@hInst&#93;,600  ; menu ID<br />        invoke SetMenu,&#91;hWnd&#93;,eax<br /><br />        invoke ShowWindow,&#91;hWnd&#93;,SW_SHOWNORMAL<br />        invoke UpdateWindow,&#91;hWnd&#93;<br /><br />    .Loop_msg&#58;<br />      invoke GetMessage,addr @msg,NULL,0,0<br />      test eax, eax<br />      jz .Exit_Loop<br />      invoke TranslateMessage, addr @msg<br />      invoke DispatchMessage,  addr @msg<br />      jmp .Loop_msg<br />    .Exit_Loop&#58;<br />      mov eax ,&#91;@msg+MSG.wParam&#93;<br /><br />endproc WinMain<br />; - - - - - - - - - - - - - - - - - - -<br />proc WndProc , hWin, uMsg , wParam , lParam<br /><br />    stack Rc      ,RECT_size ,\<br />            rLeft   ,4 ,\<br />            rTop   ,4 ,\<br />            rRight  ,4 ,\<br />            rBottom ,4<br /><br />     IF dword &#91;@uMsg&#93;,e, WM_COMMAND<br />   <br />        IF dword  &#91;@wParam&#93;,e, 1000<br />            invoke SendMessage,&#91;@hWin&#93;,WM_SYSCOMMAND,SC_CLOSE,NULL<br />         ENDIF        <br />        IF dword &#91;@wParam&#93;,e,1001<br />            invoke SendMessage,&#91;hList&#93;,LB_RESETCONTENT,0,0<br />            invoke EnumWindows,EnmProc,0<br />         ENDIF<br />        IF dword &#91;@wParam&#93;,e,1900<br />            invoke MessageBox,&#91;@hWin&#93;,&quot;Assembler, Pure &amp; Simple&quot;,\<br />                       &quot;Enumerate Windows&quot;,MB_OK<br />         ENDIF<br />        IF dword &#91;@wParam&#93;,e,502<br />            invoke SendMessage,&#91;hList&#93;,LB_RESETCONTENT,0,0<br />            invoke EnumWindows,EnmProc,0<br />         ENDIF<br /><br />   ENDIF<br />   <br />    IF dword &#91;@uMsg&#93;,e, WM_CREATE<br />      loccall ListBox,20,20,550,200,&#91;@hWin&#93;,600<br />      mov &#91;hList&#93;, eax<br />      invoke SetWindowLong,&#91;hList&#93;,GWL_WNDPROC,ListProc     ;  proc to controlate list messages<br />      mov &#91;lpfnListProc&#93;, eax<br />      loccall Static,&quot; hWnd&quot;,&#91;@hWin&#93;,20,5,52,18,500<br />      loccall Static,&quot; Window Class Name&quot;,&#91;@hWin&#93;,95,5,160,18,501<br />      loccall  PushButton,&quot;Refresh&quot;,&#91;@hWin&#93;,300,2,100,22,502<br />   ENDIF<br /><br />    IF dword  &#91;@uMsg&#93;,e,WM_SIZE<br />        invoke GetClientRect,&#91;@hWin&#93;, addr @Rc<br />        m2m &#91;@rLeft&#93;, &#91;@Rc+RECT.left&#93;<br />        add dword &#91;@rLeft&#93;, 20<br />        m2m &#91;@rTop&#93;, &#91;@Rc+RECT.top&#93;<br />        add dword &#91;@rTop&#93;, 25<br />        m2m &#91;@rRight&#93;, &#91;@Rc+RECT.right&#93;<br />        sub dword &#91;@rRight&#93;, 40<br />        m2m &#91;@rBottom&#93;, &#91;@Rc+RECT.bottom&#93;<br />        sub dword &#91;@rBottom&#93;, 45<br />        invoke MoveWindow,&#91;hList&#93;,&#91;@rLeft&#93;,&#91;@rTop&#93;,&#91;@rRight&#93;,&#91;@rBottom&#93;,TRUE<br />        return FALSE<br />    ENDIF<br />    IF dword  &#91;@uMsg&#93; ,e, WM_DESTROY<br />        invoke PostQuitMessage,NULL<br />    ENDIF<br /><br />    invoke DefWindowProc,&#91;@hWin&#93;,&#91;@uMsg&#93;,&#91;@wParam&#93;,&#91;@lParam&#93;<br /><br />endproc WndProc<br />; - - - - - - - - - - - - - - - - - - -<br />proc TopXY , wDim , sDim<br />    shr dword &#91;@sDim&#93;, 1         ; divide screen dimension by 2<br />    shr dword &#91;@wDim&#93;, 1        ; divide window dimension by 2<br />    mov eax, &#91;@wDim&#93;            ; copy window dimension into eax<br />    sub &#91;@sDim&#93;, eax             ; sub half win dimension from half screen dimension<br />    mov eax ,  &#91;@sDim&#93;<br />endproc TopXY<br />; - - - - - - - - - - - - - - - - - - -<br />proc ListBox , a,b,wd,ht,hParent,ID<br /><br />    stack hLst,4 , \<br />             hFont,4<br /><br />%assign .style  WS_VSCROLL | WS_VISIBLE | WS_BORDER | WS_CHILD | \<br />                     LBS_HASSTRINGS |LBS_NOINTEGRALHEIGHT | LBS_DISABLENOSCROLL<br /><br />    invoke CreateWindowEx,WS_EX_CLIENTEDGE,&quot;LISTBOX&quot;,0,\<br />             .style , &#91;@a&#93;,&#91;@b&#93;,&#91;@wd&#93;,&#91;@ht&#93;,&#91;@hParent&#93;,&#91;@ID&#93;,&#91;hInstance&#93;,NULL<br /><br />    mov &#91;@hLst&#93;, eax<br /><br />    invoke GetStockObject,SYSTEM_FIXED_FONT      ; ANSI_FIXED_FONT<br />    mov &#91;@hFont&#93;, eax<br />    invoke SendMessage,&#91;@hLst&#93;,WM_SETFONT,&#91;@hFont&#93;, 0<br /><br />    mov eax, &#91;@hLst&#93;<br />   <br />endproc ListBox<br />; - - - - - - - - - - - - - - - - - - -<br /><br />proc EnmProc , eHandle<br /><br />    stack Buffer,256 ,\<br />             clName,64<br /><br />    invoke GetClassName,&#91;@eHandle&#93;,addr @clName ,64<br />    invoke wsprintf,addr @Buffer,&quot;%-2.6lu   %s&quot;,&#91;@eHandle&#93;,addr @clName<br />    invoke SendMessage,&#91;hList&#93;,LB_ADDSTRING,0,addr @Buffer<br />    mov eax, &#91;@eHandle&#93;<br /><br />endproc EnmProc<br /><br />; - - - - - - - - - - - - - - - - - - -<br /><br />proc Static , lpText,hParent,a,b,wd,ht,ID<br /><br />    stack hStat,4  ,\<br />             hFont,4<br /><br />    invoke CreateWindowEx,WS_EX_STATICEDGE,&quot;STATIC&quot;,&#91;@lpText&#93;,\<br />               WS_CHILD | WS_VISIBLE | SS_LEFT,\<br />               &#91;@a&#93;,&#91;@b&#93;,&#91;@wd&#93;,&#91;@ht&#93;,&#91;@hParent&#93;,&#91;@ID&#93;,&#91;hInstance&#93;,NULL<br /><br />    mov &#91;@hStat&#93;, eax<br />    invoke GetStockObject,ANSI_FIXED_FONT<br />    mov &#91;@hFont&#93;, eax<br />    invoke SendMessage,&#91;@hStat&#93;,WM_SETFONT,&#91;@hFont&#93;, 0<br />   mov eax,  &#91;@hStat&#93;<br /><br />endproc Static<br />; - - - - - - - - - - - - - - - - - - -<br />proc ListProc , hCtl , uMsg , wParam , lParam<br /><br />    stack IndexItem,4 ,\<br />            Buffer,128<br /><br />    IF dword  &#91;@uMsg&#93;,e,WM_CHAR<br />      IF dword &#91;@wParam&#93;,e, 13<br />        loccall ShowItem<br />      ENDIF<br />   ENDIF<br /><br />    IF dword  &#91;@uMsg&#93;,e, WM_LBUTTONDBLCLK<br />        loccall ShowItem<br />    ENDIF<br /><br />    invoke CallWindowProc,&#91;lpfnListProc&#93;,&#91;@hCtl&#93;,&#91;@uMsg&#93;,&#91;@wParam&#93;,&#91;@lParam&#93;<br />    return<br /><br />    ShowItem&#58;<br />      invoke SendMessage,&#91;@hCtl&#93;,LB_GETCURSEL,0,0<br />      mov &#91;@IndexItem&#93;, eax<br />      invoke SendMessage,&#91;@hCtl&#93;,LB_GETTEXT,&#91;@IndexItem&#93;,addr @Buffer<br />      invoke MessageBox,&#91;hWnd&#93;,addr @Buffer,&quot;Enumerate Windows&quot;,MB_OK<br />      invoke SetFocus,&#91;@hCtl&#93;<br />    ret<br /><br />endproc ListProc<br />; - - - - - - - - - - - - - - - - - - -<br />proc PushButton , lpText,hParent,a,b,wd,ht,ID<br /><br />    invoke CreateWindowEx,0,\<br />            &quot;BUTTON&quot;,&#91;@lpText&#93;,\<br />            WS_CHILD | WS_VISIBLE,\<br />            &#91;@a&#93;,&#91;@b&#93;,&#91;@wd&#93;,&#91;@ht&#93;,&#91;@hParent&#93;,&#91;@ID&#93;,\<br />            &#91;hInstance&#93;,NULL<br /><br />endproc PushButton<br /></code></pre></div>
    <div class="meta">Posted on 2004-03-27 20:05:33 by Nguga</div>
   </div>
  </div>
 </body>
</html>