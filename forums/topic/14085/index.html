<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>problem with namespace and @size - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14085" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=14085">problem with namespace and @size</a></p>
   <div class="post" id="post-108833">
    <div class="subject"><a href="#post-108833">problem with namespace and @size</a></div>
    <div class="body">ok, I'm probably just tired (way past my bedtime), but when namespacing part of my code just now, I ran into some trouble using @global: with @size<br /><br /><br />mov(@size(namespace_data), eax);<br /><br />works fine, but when I try using @size on data outside my namespace, like for example:<br /><br />mov(@size(@global:w.POINT), eax);<br /><br />generates following error:<br />&quot;undefined identifier (dest memory operand)&quot;<br /><br />dest memory operand is eax, which is not the cause of error, so I assume there<br />are parsing troubles with the @size(@global:w.POINT) part of the statement.<br /><br />am I simply using the wrong syntax? or am I just really dumb and tired?<br /><br />I have no problem using @global: in other statements, such as<br /><br />if(eax = @global:w.WM_COMMAND) then...<br /><br />only in the @size function.<br /><br />I have the itching feeling that I am being very stupid here.....</div>
    <div class="meta">Posted on 2003-06-30 17:26:18 by BinarySoup</div>
   </div>
   <div class="post" id="post-108934">
    <div class="subject"><a href="#post-108934">Re: problem with namespace and @size</a></div>
    <div class="body"><div class="quote"><em>Originally posted by BinarySoup </em><br />ok, I'm probably just tired (way past my bedtime), but when namespacing part of my code just now, I ran into some trouble using @global: with @size<br /></div><br />Not surprising, namespace lookups are somewhat fragile in HLA.<br /><br /><br /><div class="quote"><br />mov(@size(namespace_data), eax);<br /><br />works fine, but when I try using @size on data outside my namespace, like for example:<br /><br />mov(@size(@global:w.POINT), eax);<br /><br />generates following error:<br />&quot;undefined identifier (dest memory operand)&quot;<br /></div><br /><br />Best suggestion I can make is to pull all actual procedure declarations out of your namespace and only put @forward or @external definitions in the actual namespace section, e.g.,<br /><br /><pre><code><br />program c;<br />#include&#40; &quot;stdlib.hhf&quot; &#41;<br />#include&#40; &quot;w.hhf&quot; &#41;<br /><br />namespace x;<br />	static<br />		namespace_data&#58;dword;<br /><br />	procedure a; @forward;<br /><br />end x;<br /><br />procedure x.a;<br />begin a;<br /><br />	mov&#40; @size&#40; w.POINT &#41;, eax &#41;;<br />	mov&#40; eax, x.namespace_data &#41;;<br /><br />end a;<br /><br />begin c;<br /><br />end c;<br />           <br /><br /></code></pre><br /><br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-07-01 14:47:15 by rhyde</div>
   </div>
   <div class="post" id="post-108937">
    <div class="subject"><a href="#post-108937">problem with namespace and @size</a></div>
    <div class="body">thanks Randy, this is a working solution that actually saves me alot of @global: typing ;)<br /><br />btw, is there anyway to use nested namespaces?</div>
    <div class="meta">Posted on 2003-07-01 15:16:44 by BinarySoup</div>
   </div>
   <div class="post" id="post-109029">
    <div class="subject"><a href="#post-109029">problem with namespace and @size</a></div>
    <div class="body"><div class="quote"><em>Originally posted by BinarySoup </em>btw, is there anyway to use nested namespaces? </div><br /><br />No. I never saw the need for it so I never implemented it. However, if you give me a good reason, I'd be willing to consider adding it to HLA v2.0 (not really feasible to add it to v1.x; namespaces are a real kludge in v1.x and, as you can tell, the code is rather fragile).<br /><br />If you really need &quot;nested namespace&quot;, you can kind of achieve this by using a pair of classes:<br /><br /><pre><code><br />type<br />    class1&#58;class<br />         &lt;static, readonly, storage, const, var, macro, and procedure declarations&gt;<br />    endclass;<br /><br />    class2&#58;class<br />         &lt;static, readonly, storage, const, var, macro, and procedure declarations&gt;<br />         nestedclass&#58;class1;<br />         &lt;static, readonly, storage, const, var, macro, and procedure declarations&gt;<br />    endclass;<br /></code></pre><br /><br />If you don't instantiate either class, you can access the static (non-var, non-method, non-iterator) names using class2.xxxx and class2.class1.xxxx.<br /><br />Mostly, this achieves what you want.  The missing item is types. You can't nest type declarations inside classes. Also, keep in mind that HLL-like class to class procedures load ESI (with NULL), so this may be a problem.<br /><br />Implementing nested namespaces won't be that hard in HLA v2.0 if I plan on namespaces from the start (which I obviously will). I'm not sure what their utility would be however (other than to make HLA's namespace syntax a bit more generic). Might be useful for macros that expand into a namespace, I suppose.<br /><br />Another thing that would be nice in HLA v2.0 is the concept of private and public names in a class (something like what C++ provides). Haven't quite figured out how to do this in assembly language in a way that makes sense, however.<br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-07-02 10:26:08 by rhyde</div>
   </div>
   <div class="post" id="post-109075">
    <div class="subject"><a href="#post-109075">problem with namespace and @size</a></div>
    <div class="body">well, personally I would like nested namespaces for extensive program structuring, it makes it easier to group/subgroup program code and data. I'm currently working on a multi-network p2p program in my spare time, and although the networks differ vastly in implementation, with namespaces I can structure the code very similarly, the nested namespacing only improves that further. ok try to show an example of what I mean with two of the p2p networks, DirectConnect and Edonkey, parameters have been struck for sake of readability.<br /><br />namespace DirectConnect<br />namespace Edonkey<br /><br />currently my calls looks somewhat like this:<br /><br />DirectConnect.HubCreate();<br />Edonkey.ServerCreate();<br />Edonkey.ClientConnect();<br />etc etc.<br /><br />this gives a nice calling structure that is similar across all networks, but what would make it even more structured would be if I could use nested namespaces.<br /><br />DirectConnect.Hub.Connect();<br />DirectConnect.Client.Connect();<br />Edonkey.Server.Create();<br />Edonkey.Server.Connect();<br />Edonkey.Client.Ask();<br />etc etc...<br /><br />here the nested namespaces are Hub, Client, Server. granted, this has little impact on the actual code (although it allows me to re-use variable names in each nested namespace which is very nice), but it has a great impact on someone as fuzzy like me when it comes to organizing my code, implementing a call name structure etc.<br /><br />a more general example would be something like: <br /><br />namespace Employees<br />      nested<br />           Administration<br />           Engineering<br />           Manufacturing<br /><br />allowing for calls like <br />Employees.Administration.CalculateSalary();<br />Employees.Engineering.CurrentProjects();<br />etc etc...<br /><br />this type of function/data structuring is of course available through the use of classes, but the overhead is pretty pointless if all I want out of classes is the ability to bind functions and data together under a naming structure, which is the case here.<br /><br />anyway, I'm satisfied with namespaces as they work now (although a little more stability would not go amiss), nested namespaces would be the icing on the cake so to speak, allowing me to go CRAZY in my quest for code/name/data structure, but again, making wishes is easy, implementing them is a whole other matter. <br /><br />thanks again for an excellent assembler! also, I really love the syntax, it's very well thought out and consistent.</div>
    <div class="meta">Posted on 2003-07-02 16:38:45 by BinarySoup</div>
   </div>
   <div class="post" id="post-109692">
    <div class="subject"><a href="#post-109692">problem with namespace and @size</a></div>
    <div class="body">Okay.<br />I'll remove several restrictions from HLA in v2.0 including<br />nested namespaces, type declaration sections within classes, and<br />TEXT array objects.  HLA v1.x has a really messed up symbol table<br />structure (having been kludged royally over the years) and I'll seriously<br />break something if I try to add nested namespaces to it.  But HLA v2.0<br />uses a decent data structure for the symbol table so nested namespaces<br />are certainly possible.<br /><br />Randy Hyde</div>
    <div class="meta">Posted on 2003-07-08 16:10:13 by rhyde</div>
   </div>
   <div class="post" id="post-109786">
    <div class="subject"><a href="#post-109786">problem with namespace and @size</a></div>
    <div class="body">well, huge thanks, really looking forward to 2.0 ;) just hope it won't be alot of extra work for you. personally it's a great boost as I find nested namespaces the perfect way to organize and localise code/data without resorting to classes. anyway, I hope that since HLA is already highly dependant on namespaces through stdlib and includes, that you were considering a overhaul of it's robustness either way, and thus adding nested namespaces isn't a totally new branch for you in your work towards HLA 2.0. <br /><br />btw, I'm amazed everytime I stumble across someone like you, who works their arse off, creating excellent tools for people to use, for FREE. then helps them with every little problem they have, even when they obviously have neglected to read the manual that you have poured tons of time and effort into, and then take upon yourself even more work when backseat drivers like me remark on the lack of nested namespaces.<br /><br />once again, greatest of thanks!</div>
    <div class="meta">Posted on 2003-07-09 06:47:33 by BinarySoup</div>
   </div>
   <div class="post" id="post-109825">
    <div class="subject"><a href="#post-109825">problem with namespace and @size</a></div>
    <div class="body"><div class="quote"><em>Originally posted by BinarySoup </em><br />HLA is already highly dependant on namespaces through stdlib and includes, that you were considering a overhaul of it's robustness either way, and thus adding nested namespaces isn't a totally new branch for you in your work towards HLA 2.0. <br /></div><br />Absolutely not. The introduction of namespaces into HLA v1.x was a total hack specifically to support the standard library in a more reasonable fashion. I knew when I was first implementing the code that not supporting nested namespaces was a &quot;less than aesthetic&quot; solution. Alas, the design of v1.x prevented a clean implementation of namespaces (though, in retrospect, I probably should have used this as an excuse to redo the symbol table format and save myself additional headaches down the road).<br /><br /><div class="quote"><br />btw, I'm amazed everytime I stumble across someone like you, who works their arse off, creating excellent tools for people to use, for FREE. then helps them with every little problem they have, even when they obviously have neglected to read the manual that you have poured tons of time and effort into, and then take upon yourself even more work when backseat drivers like me remark on the lack of nested namespaces.<br /><br />once again, greatest of thanks! </div><br /><br />One thing I've discovered is that it doesn't make any sense to work your tail off on some project and then not support it (via documentation and on-line support). What amazes me is that there are people out there who will put a tremendous amount of effort into a project and then tell the users that they are on their own. Some people may be happy cranking out a ton of software for their own personal use, but if I'm going to expend this kind of effort to create something, I want people to use it. And unless you support and market the software, people won't use it.<br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-07-09 11:31:46 by rhyde</div>
   </div>
   <div class="post" id="post-111925">
    <div class="subject"><a href="#post-111925">problem with namespace and @size</a></div>
    <div class="body">randall.hyde wrote:<br /><br /><div class="quote">One thing I've discovered is that it doesn't make any sense to work your tail off on some project and then not support it (via documentation and on-line support). What amazes me is that there are people out there who will put a tremendous amount of effort into a project and then tell the users that they are on their own. Some people may be happy cranking out a ton of software for their own personal use, but if I'm going to expend this kind of effort to create something, I want people to use it. And unless you support and market the software, people won't use it.</div><br /><br />I am truly inspired by your commitment,  my fears was that you'd start feeling like there is no way to keep up with the demands from the users. there is a thin line between feature requests and whining, and I just want to make sure I'm not crossing it. if it ever happens, just shout!</div>
    <div class="meta">Posted on 2003-07-25 22:42:56 by BinarySoup</div>
   </div>
  </div>
 </body>
</html>