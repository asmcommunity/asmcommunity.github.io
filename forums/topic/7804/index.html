<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Import sect. problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7804" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7804">Import sect. problem</a></p>
   <div class="post" id="post-56650">
    <div class="subject"><a href="#post-56650">Import sect. problem</a></div>
    <div class="body">I posted a question last week about finding the address of the import section in a PE file. I got quite a few answers (thanks to all who replied) and have modified my test program accordingly. <br /><br />The program now reads the VA address from the second entry in the data directory and then cyles through the section headers looking for a match. The section whose VA matches that from the data directory should be the import section. However, none of the VA's from the section headers seem to match the VA's from the data directory.<br /><br />I have no idea what I'm doing wrong here.<br /><br />Thanks for your help, again.<br />                            justAnotherLostSoul</div>
    <div class="meta">Posted on 2002-09-08 10:35:41 by JustanotherLostSoul</div>
   </div>
   <div class="post" id="post-56681">
    <div class="subject"><a href="#post-56681">Import sect. problem</a></div>
    <div class="body">first of all, why do you push/pop cx in the loop? that's not necessary and your program's stack will be modified if you jump to 'foundimport'.<br />now, most linkers put the import table in a separate section with section.rva == import_table.rva. this is no necessity, though. the import table might reside <em>inside</em> a section as well.</div>
    <div class="meta">Posted on 2002-09-08 14:47:49 by Tola</div>
   </div>
   <div class="post" id="post-56733">
    <div class="subject"><a href="#post-56733">Import sect. problem</a></div>
    <div class="body"><div class="quote"><em>The program now reads the VA address from the second entry in the data directory and then cyles through the section headers looking for a match.</em></div><br /><br />The member VirtualAddress of IMAGE_DATA_DIRECTORY structure is actually <strong>RelativeVirtualAddress</strong>. If you have found it you have relative pointer to first IMAGE_IMPORT_DESCRIPTOR. And you don't have look for something.</div>
    <div class="meta">Posted on 2002-09-09 04:07:48 by Four-F</div>
   </div>
  </div>
 </body>
</html>