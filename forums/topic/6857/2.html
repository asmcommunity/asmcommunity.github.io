<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Parameters checking - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6857" />
  <link rel="prev" href="../?id=6857&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=6857">Parameters checking</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=6857&amp;page=1" style="">&laquo;</a><a href="../?id=6857&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="6857" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-49573">
    <div class="subject"><a href="#post-49573">Parameters checking</a></div>
    <div class="body"><strong>Privalov</strong>, I am very happy with the macro system in FASM - seems very powerful, yet simple.  Thank you, it is a very effective design.  The lack of limitations in FASM further extend this power.</div>
    <div class="meta">Posted on 2002-07-23 10:11:27 by bitRAKE</div>
   </div>
   <div class="post" id="post-49576">
    <div class="subject"><a href="#post-49576">Parameters checking</a></div>
    <div class="body">Parameter checking -- I have not found that feature to be overly useful in MASM, and I would not consider its implementation first priority for FASM. With the usual prototyping &quot;myfunc PROTO :DWORD, :DWORD, :DWORD&quot; parameter <strong>checking</strong> equates to parameter <strong>counting</strong>. Forgetting a function parameter or using one too much will normally crash the application, and will be easily detected. It takes much more time to detect programming errors where you get the order of parameters wrong, or where you pass a DWORD value immediately when in fact a DWORD pointer to the value is required (and vice versa). Parameter counting will not help at all to find these errors.<br /><br />Frank</div>
    <div class="meta">Posted on 2002-07-23 10:22:26 by Frank</div>
   </div>
   <div class="post" id="post-49577">
    <div class="subject"><a href="#post-49577">Parameters checking</a></div>
    <div class="body">If you want to learn more about the system of macroinstructions in fasm, you can read what I have written so far for the <a target="_blank" href="http://fasm.metro-nt.pl/fasmdocpre.zip">new documentation</a>. It's an early version and may contain errors, but I hope it can help you understading how my macroinstructions work. ;) <br /><br />You can also get the first beta pre-release of fasm 1.40 <a target="_blank" href="http://fasm.metro-nt.pl/fasm140b.zip">here</a>.<br /><br />This is all very unofficial, that's why I don't even put it in a new thread. ;)</div>
    <div class="meta">Posted on 2002-07-23 10:54:41 by Tomasz Grysztar</div>
   </div>
   <div class="post" id="post-49586">
    <div class="subject"><a href="#post-49586">Parameters checking</a></div>
    <div class="body"><div class="quote"><em>Originally posted by pelaillo</em><br />I easy could do GPFs in Masm if I want (I have had a lot unwanted also).  Assembly is the best, HLL does not allow you to do interesting damages.</div> <br /><br />sure you can always do GPFs but it is your mistake then, the assembler/compiler did his best to catch all the error he could at compilation-time...<br /><br />forgetting a comma is a bit less unconscious... and sometimes far harder to find...<br /><br /><div class="quote"><em>Originally posted by Privalov </em><br />I don't want to put any HLL stuff into fasm, and I won't do that. You can customize the syntax using the macroinstructions (will be a bit enchanced in 1.40, and well documented in the new docs I'm working on currently), but if you need something more, you should use external tools. Like the C compilers generating assembly sources you can have some kind of HLL assembly compiler generating sources for fasm, why not?<br />I one write something of that kind and it's good I can promote it on my website.</div><br /><br />The problem is not HLL or not... I don't think I'm a HLL enthusiast when it comes to assembly (I don't use all these .IF .WHILE thingies), I'm talking about a feature that let you know when you are making a mistake that IS detectable...<br /><br /><div class="quote"><em>Originally posted by Frank</em><br />Parameter checking -- I have not found that feature to be overly useful in MASM, and I would not consider its implementation first priority for FASM.</div><br /><br />Because you always had it in MASM...<br /><br /><div class="quote">With the usual prototyping &quot;myfunc PROTO :DWORD, :DWORD, :DWORD&quot; parameter checking equates to parameter counting</div><br /><br />Well, that is what I'm talking about... I don't want a strict type checking, but parameter checking or parameter counting if you want to be pedantic...<br /><br /><div class="quote">Forgetting a function parameter or using one too much will normally crash the application, and will be easily detected. </div><br /><br />Did you ever worked on a great project?<br />Will you bother to test your program in ALL cases everytime? Imagine an api call crashing during a sheduled task of an automated program... :eek:<br />You can be sure that your program is &quot;algorithmely&quot; and &quot;structuraly&quot; fiable, but a undetected typo in the code may lead to a program crash if it is undetected... a loop can sometimes take many paths depending of some variable values... will you test them all? The assembler/compiler is here to tell you about typos, illegal constructions, and such...<br /><br />To me, in the programming world, using an assembler/compiler with no parameter checking is just as dangerous as having s*x with someone that may have STD without condom in the real-life... you're relying on trusting your code as you trust a partner (that may be not so trustworthy, like a &quot;malicious&quot; code where, for some reason, you don't see any error)... that's just unsafe.<br />I'm sort of worried to see the reactions about this... are you guys so self-confident just because you code in assembly and you don't need any feature of this &quot;HLL crap&quot;? That's just plain l33t... and your own code will learn you the hard way when customers will yell, and the boss will fire *you* because *you* wrote a buggy software and that one consequence for a customer was the loss of huge sums of money... all just because of a little forgotten comma the assembler didn't catch... admit it would be sad...<br /><br />I would like to heard comments on this from people like Hutch, Maverick (especially you who designed your own langage and compiler) f0dder... and anyone who wants to add his two cents... of course.</div>
    <div class="meta">Posted on 2002-07-23 12:04:33 by JCP</div>
   </div>
   <div class="post" id="post-49591">
    <div class="subject"><a href="#post-49591">Parameters checking</a></div>
    <div class="body">so... you release software without testing?  :grin:<br /><br /><br />but your point is correct, however you heard Thomas so it won't be added. (it's his program so his decision)<br />IMO The best solution to this would be a pre-parser that just checks and returns errors on your script.</div>
    <div class="meta">Posted on 2002-07-23 12:33:28 by Hiroshimator</div>
   </div>
   <div class="post" id="post-49593">
    <div class="subject"><a href="#post-49593">Parameters checking</a></div>
    <div class="body"><div class="quote"><br />(I don't know many people that type code like Ritsuko from<br />Evangelion that compiles the first time without any error! :D )<br /></div><br />Come on, how hard can it be to code something like The Magi? ;)<br /><br /><div class="quote"><br />Interactive way is less time consuming that a parameter checking<br />error lists and could be more flexible<br /></div><br />Hrm, you'd rather have the IDE spend time looking for these bugs?<br />I don't know how you work, but I spend most of my time in the IDE,<br />writing &quot;some amount&quot; of code, and only then do I hit the build<br />keystroke. Furthermore, because of my wonderful modular design :),<br />I usually only work with one source module at a time... so even<br />with big and rather slow optimizing compilers, build speed isn't<br />much of an issue. FASM is superfast, how much would it be slowed<br />down by a (properly done) invoke/proto implementation?<br /><br />Running a pre-parser before running fasm would be annoying, and<br />would probably be a whole lot slower than adapting fasm internals.<br /><br />I'm starting to like fasm, it was the only way I could (easily)<br />build a PE in a &quot;rather special&quot; form... but before it can replace<br />masm (for me, anyway) it will need COFF output (which I hear is<br />coming - great work!), some prototype+checking facility... and a<br />bit less painful way to handle imports (for &quot;standalone&quot; PE output -<br />this will not be much of an issue when building coff's and linking<br />externally).<br /><br />I guess one of fasm's great strengths is that it's very &quot;raw&quot;<br />and most everything is done through macros, and the macro system<br />seems to be very powerful... this certainly makes sense for platform<br />dependant stuff like PE imports/resources and whatnot, but a<br />feature like parameter checking (counting) is so generic that<br />you might as well implement it in the core - at least if there's<br />a noticeable speed difference between macroized checking and<br />&quot;core&quot; checking.<br /><br />What about using a more C-like syntax for structure declaration,<br />and #ifdef/#else/#endif ? I know a lot of people will dislike this<br />because it's too &quot;highlevel&quot; or whatever, but the struct declarations<br />if fasm already look a lot like C, and it would be *very* nice<br />being able to use C header files both for asm and C, without a<br />&quot;h2inc&quot; middle step... especially when dealing with OS development.</div>
    <div class="meta">Posted on 2002-07-23 12:42:14 by f0dder</div>
   </div>
   <div class="post" id="post-49594">
    <div class="subject"><a href="#post-49594">Parameters checking</a></div>
    <div class="body">You are exaggerating. When you are programming assembly you can do many mistakes that cannot be checked by compiler just because it gives you freedom. With assembler the programmer is responsible for what he is doing, the compiler has to quitely do what programmer asks for. It can be dangerous (I have even cleared my flash BIOS one day by putting wrong number of POP instructions before returning from procedure, so program<br />went out of control), but you are choosing it when you choose (low-level) assembly. <br /><br />In one of my programs I'm setting up the parameters on stack for VirtualFree just after VirtualAlloc, so they are waiting for the right moment just in place. Then I invoke the VirtualFree with not enough number of parameters, because they are already prepared on the stack. This is a kind of optimization, which you can do only in assembly language. Parameters count checking would make that impossible to do.<br /><br /><br /><br />All right, but you can still do it using the macros, why not:<br /><br /><pre><code><br />macro invoke proc,&#91;arg&#93;<br /> &#123; common count = 0<br />   forward count = count + 1<br />   common<br />    if count &lt;&gt; proc#.count<br />     display &quot;*****************************************&quot;,0Dh,0Ah<br />     display &quot;Invalid count of parameters for API call!&quot;,0Dh,0Ah<br />     display &quot;*****************************************&quot;,0Dh,0Ah<br />     halt ; illegal instruction<br />    end if<br />    invoked equ invoked,proc<br />    if ~ arg eq<br />     stdcall &#91;proc&#93;,arg<br />    else<br />     call &#91;proc&#93;<br />    end if &#125;<br /></code></pre><br /><br />Now you only have to define constants for each API calls, eg:<br /><br /><pre><code><br />MessageBox.count = 4<br />ExitProcess.count = 1<br /></code></pre><br /><br /></div>
    <div class="meta">Posted on 2002-07-23 13:00:24 by Tomasz Grysztar</div>
   </div>
   <div class="post" id="post-49597">
    <div class="subject"><a href="#post-49597">Parameters checking</a></div>
    <div class="body"><div class="quote"><br />so... you release software without testing?  :grin:<br /><br /><br />but your point is correct, however you heard Thomas so it won't be added. (it's his program so his decision)<br />IMO The best solution to this would be a pre-parser that just checks and returns errors on your script. </div><br /><br />No, but during your testing, you can hardly test all the possibilities (with good tools or with good quality insurance, maybe...)<br /><br />Tomasz do what he wants with his assembler, I'm not forcing him to add a feature I want, because it would be selfish... but an interesting discussion is started, I would even say a debate! That is not so frequent here. So even if we quit the field of fasm a bit, it is interesting imho... and perhaps Tomasz will change his decision after the debate. ;)<br /><br /><div class="quote"><br />You are exaggerating. When you are programming assembly you can do many mistakes that cannot be checked by compiler just because it gives you freedom. With assembler the programmer is responsible for what he is doing, the compiler has to quitely do what programmer asks for. It can be dangerous (I have even cleared my flash BIOS one day by putting wrong number of POP instructions before returning from procedure, so program<br />went out of control), but you are choosing it when you choose (low-level) assembly. <br /><br />In one of my programs I'm setting up the parameters on stack for VirtualFree just after VirtualAlloc, so they are waiting for the right moment just in place. Then I invoke the VirtualFree with not enough number of parameters, because they are already prepared on the stack. This is a kind of optimization, which you can do only in assembly language. Parameters count checking would make that impossible to do. </div><br /><br />I agree with you about the freedom that assembly provides (but it shouldn't be like a gun without safety lock... you can shoot yourself in the foot), but about your VirtualAlloc example, I already did this plenty times in my programs... I must admit I sometimes wished MASM to have such a feature to invoke the API... but the after-thought was that I should continue as I did... when using this &quot;optimization&quot;, continue to push arguments and calling the function explicitely... this way, I remember what I wanted to do some months after and I don't think it is a mistake if it is not...<br /><br />This is also why I suggested it to be optional... if someone don't like it, the user can disable it (by not incluing the prototype), but imho, there is more classical api calls than &quot;optimized&quot; one like your example...<br />I assume that when you use invoke, you want to do a relatively classical, &quot;standard&quot; thing, and this is the perfect place to add some security... Invoke is very widely used in all masm sources... and I assume many programmers forgot a comma between two arguments... just like programmers sometimes forget the ; delimited in C... it is frequent mistake and the compiler tells it...<br /><br />Even if there is better/more experienced programmers than me here, I don't think I'm a programming baby who needs the assembler to catch all the mistake he does, but when it can be easily catched and saves me times, why not? Free coding, yes. Unsecure coding, no.<br /><br /><div class="quote"><em>Originally posted by f0dder</em><br /><strong>&quot;Come on, how hard can it be to code something like The Magi?&quot;</div><br /><br />Some years ago, I coded a Magi-GUI like in VB, but I stopped there (and it didn't looked exactly like the original one) ;)<br /><br /><div class="quote"><strong>I'm starting to like fasm, it was the only way I could (easily)<br />build a PE in a &quot;rather special&quot; form... but before it can replace<br />masm (for me, anyway) it will need COFF output (which I hear is<br />coming - great work!), some prototype+checking facility... and a<br />bit less painful way to handle imports (for &quot;standalone&quot; PE output -<br />this will not be much of an issue when building coff's and linking<br />externally).</div><br /><br />It is not only coming, it is done. ;)<br /><br />you have to put MS COFF as format or something like that at the top of your source (there is an example in the latest version (coffee), I think).<br /><br />*EDIT* : thanks for the macro, Privalov... but why not add parameter size checking (byte, word, dword)... okay, okay, I'm a pest! ;)</div>
    <div class="meta">Posted on 2002-07-23 13:32:04 by JCP</div>
   </div>
   <div class="post" id="post-49599">
    <div class="subject"><a href="#post-49599">Parameters checking</a></div>
    <div class="body">Real assembly coders doesn't use invoke :tongue: Doesn't need type parameter checking :tongue: . Real assembly coders usually do a sub-mov-call or push-call. ;)<br /><br />Am I an elitist? :grin:</div>
    <div class="meta">Posted on 2002-07-23 13:41:42 by stryker</div>
   </div>
   <div class="post" id="post-49600">
    <div class="subject"><a href="#post-49600">Parameters checking</a></div>
    <div class="body">No, just an amateur :grin: : REAL MEN CODE IN HEX ! :grin:</div>
    <div class="meta">Posted on 2002-07-23 13:47:15 by JCP</div>
   </div>
   <div class="post" id="post-49601">
    <div class="subject"><a href="#post-49601">Parameters checking</a></div>
    <div class="body">stryker: why not use a feature when it saves time (in many ways), and<br />don't really give any performance penalties?</div>
    <div class="meta">Posted on 2002-07-23 13:48:38 by f0dder</div>
   </div>
   <div class="post" id="post-49602">
    <div class="subject"><a href="#post-49602">Parameters checking</a></div>
    <div class="body">because the code will look a little more assembly than HLL. :grin:<br /><br />Seriously, I'm just joking around since the topic is getting serious.<br /><br />I wish I could master the FASM macro styles, so I can port my xcall from MASM.</div>
    <div class="meta">Posted on 2002-07-23 13:51:42 by stryker</div>
   </div>
   <div class="post" id="post-49693">
    <div class="subject"><a href="#post-49693">Parameters checking</a></div>
    <div class="body"><div class="quote"><br />Real assembly coders doesn't use invoke :tongue: </div><br /><br />I use &quot;stdcall&quot; :rolleyes:</div>
    <div class="meta">Posted on 2002-07-24 01:23:57 by bazik</div>
   </div>
   <div class="post" id="post-49710">
    <div class="subject"><a href="#post-49710">Parameters checking</a></div>
    <div class="body"><div class="quote"><br />I don't want to put any HLL stuff into fasm, and I won't do that. <br /></div><br /><br />Love to hear that! <br />Assembly is the programming lanugage with the most freedom for the programmer, so why should a <br />Assembler restrict your freedom? 1 comma less, is one char less typing ;)<br /><br />stdcall , 0 cap msg 0<br /><br />:)</div>
    <div class="meta">Posted on 2002-07-24 03:29:20 by bazik</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=6857&amp;page=1" style="">&laquo;</a><a href="../?id=6857&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="6857" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>