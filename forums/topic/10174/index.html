<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Chess demo / size optimization - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10174" />
    <link rel="next" href="../?id=10174&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10174">Chess demo / size optimization</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=10174&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=10174&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="10174" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=10174&amp;page=2">&gt;</a><a href="../?id=10174&amp;page=2">&raquo;</a></form>   <div class="post" id="post-76270">
    <div class="subject"><a href="#post-76270">Chess demo / size optimization</a></div>
    <div class="body">Hi, folks!<br />Just finished (i.e. ran out of ideas for improvement) my chess demo - Win32, OpenGL, 1.5 KB (!).<br />Some stats: 843 lines of asm; sizeof(data) = 755; 2.25 bytes / instruction on average.<br />Grab it at <a target="_blank" href="">http://www.stud.uni-karlsruhe.de/~urkt/</a> (bottom of page).<br /><br />While I'm at it :) - anyone interested in an article about / exchanging tips on optimizing for size?<br /><br />Jan</div>
    <div class="meta">Posted on 2003-01-12 07:30:10 by Jan Wassenberg</div>
   </div>
   <div class="post" id="post-76262">
    <div class="subject"><a href="#post-76262">Chess demo / size optimization</a></div>
    <div class="body">Nice chess set!:alright:<br />Keep going on!<br /><br />Regards,<br /><br />Vortex</div>
    <div class="meta">Posted on 2003-01-12 08:15:30 by Vortex</div>
   </div>
   <div class="post" id="post-76256">
    <div class="subject"><a href="#post-76256">Chess demo / size optimization</a></div>
    <div class="body">Well, it brought down Windows XP to the blue screen - haven't seen it in a long time. :)  The code looks impressive - wish I had more time to spend on it.  Good to see byte shaving still in style. :)</div>
    <div class="meta">Posted on 2003-01-12 11:18:15 by bitRAKE</div>
   </div>
   <div class="post" id="post-76271">
    <div class="subject"><a href="#post-76271">Chess demo / size optimization</a></div>
    <div class="body">Doh :( <br />Could you send me (Jan.Wassenberg@stud.uni-karlsruhe.de) or post your imports.inc?<br />The demo used to run on XP; I've changed &quot;just a few things&quot; since then :rolleyes:</div>
    <div class="meta">Posted on 2003-01-12 11:58:22 by Jan Wassenberg</div>
   </div>
   <div class="post" id="post-76264">
    <div class="subject"><a href="#post-76264">Chess demo / size optimization</a></div>
    <div class="body">worked fine for me on winxp.... maybe i didnt' play long enough?</div>
    <div class="meta">Posted on 2003-01-12 11:58:49 by BubbaFate</div>
   </div>
   <div class="post" id="post-76257">
    <div class="subject"><a href="#post-76257">Chess demo / size optimization</a></div>
    <div class="body"><pre><code>; System info&#58;<br />;   Win XP Service Pack 1 &#40;Build 2600&#41;<br />;   NVIDIA Corporation GeForce3/PCI/3DNOW! 1.4.0<br /><br />opengl32	equ	0x5ed00000<br /><br />GetProcAddress	equ	0x77e7b332<br />CreateWindowExA	equ	0x77d4bc2f<br />GetMessageA	equ	0x77d45aaf<br />GetDC		equ	0x77d8a1bc<br />SetPixelFormat	equ	0x77c9e963<br /><br />TickCount	equ	0x7ffe0000<br /><br />%assign last_ord 1</code></pre></div>
    <div class="meta">Posted on 2003-01-12 12:08:52 by bitRAKE</div>
   </div>
   <div class="post" id="post-76252">
    <div class="subject"><a href="#post-76252">Chess demo / size optimization</a></div>
    <div class="body"><div class="quote"><br /><pre><code>; System info&#58;<br />;   Win XP Service Pack 1 &#40;Build 2600&#41;<br />;   NVIDIA Corporation GeForce3/PCI/3DNOW! 1.4.0<br /><br />opengl32	equ	0x5ed00000<br /><br />GetProcAddress	equ	0x77e7b332<br />CreateWindowExA	equ	0x77d4bc2f<br />GetMessageA	equ	0x77d45aaf<br />GetDC		equ	0x77d8a1bc<br />SetPixelFormat	equ	0x77c9e963<br /><br />TickCount	equ	0x7ffe0000<br /><br />%assign last_ord 1</code></pre> </div><br /><br />Scanning the memory of the system dlls is better than using fixed values 8)<br /><br />See: <a target="_blank" href="http://www.programmingjournal.com/issue4/art3/index.htm">http://www.programmingjournal.com/issue4/art3/index.htm</a></div>
    <div class="meta">Posted on 2003-01-12 12:31:26 by bazik</div>
   </div>
   <div class="post" id="post-76265">
    <div class="subject"><a href="#post-76265">Re: Chess demo / size optimization</a></div>
    <div class="body"><div class="quote"><br />While I'm at it :) - anyone interested in an article about / exchanging tips on optimizing for size?</div> Really awesome work on that chess board! And an article about optimizing for size and maybe speed would be very very usefull! If you want to create such an article then I would defintly read it! :alright:</div>
    <div class="meta">Posted on 2003-01-12 12:59:03 by natas</div>
   </div>
   <div class="post" id="post-76272">
    <div class="subject"><a href="#post-76272">Chess demo / size optimization</a></div>
    <div class="body">bitRAKE: Thanks.<br />I don't see anything suspicious; why should it work on BubbaFate's system and not yours? :confused: Usual question: do you have the latest drivers? BTW, anyone know how to detect this a) without too much effort b) in a somewhat portable fashion?<br /><br />Hey bazik, good link!<br />First a note on the article: &quot;There is another problem for WinNT/Win2K (at least proven for Win2K and guessed for WinNT) [...] that those operating systems don't run EXE files that have no import table&quot;. This is because thread startup code is in kernel32 =&gt; kernel32 needs to be loaded (pretty much any import will do, since they all reference kernel32).<br /><br />What the guy is doing is basically GetProcAddress; in my case, regular imports would probably be smaller (there was a bit of space left in the header for the DLL strings).<br />Another alternative (from a couple versions back :)): grab the necessary functions from opengl32's IAT. <br /><br />In case anyone's interested, here it is:<br /><pre><code><br />; copy glu32 imports to API table<br />	mov		esi, data			; esi -&gt; import from glu32<br />	mov		edi, bss<br />	mov		ebp, edi<br />	lodsd						; eax -&gt; glu32 func<br />	stosd<br />	movsd<br /><br />; copy funcs from opengl32 import table<br />	mov		ax, 0x1080			; eax -&gt; glu32 import tbl + 0x80<br />	mov		edx, &#91;eax&#93;			; edx -&gt; ogl32 func<br />	mov		dx, 0x1000			; edx -&gt; ogl32 import tbl<br />	lodsd						; eax = 0<br />	mov		cl, num_funcs<br />.1&#58;	lodsb						; offset/4 of desired func in IAT<br />	mov		eax, &#91;edx+eax*4&#93;<br />	stosd<br />	xor		eax, eax<br />	loop		.1<br />	mov		dh, 0				; edx -&gt; ogl32 dll<br /></code></pre><br /><br />I switched to fixed offsets when I realized that this method is no less system dependent ;)<br />Anyway, I need the 'make' step to fixup the opengl32 ordinals (WinXP opengl32 lacks DllInitialize).<br /><br />natas - Thanks! :) Added to my rather lengthy to-do list...</div>
    <div class="meta">Posted on 2003-01-12 15:41:19 by Jan Wassenberg</div>
   </div>
   <div class="post" id="post-76263">
    <div class="subject"><a href="#post-76263">Chess demo / size optimization</a></div>
    <div class="body">&quot;See: <a target="_blank" href="http://www.programmingjournal.com/issue4/art3/index.htm">http://www.programmingjournal.com/issue4/art3/index.htm</a>&quot;<br />Very slow example, stolen from viral writers<br /><br />&quot;Scanning the memory of the system dlls is better than using fixed values&quot;<br />Wrong<br /><br />The best way is to patch your .exe file using fixed values<br />The patcher is  your setup.exe<br /><br />If you change OS, you must start your setup.exe again to repatch it.<br /><br />Regards,<br />Lingo</div>
    <div class="meta">Posted on 2003-01-12 15:58:06 by lingo12</div>
   </div>
   <div class="post" id="post-76266">
    <div class="subject"><a href="#post-76266">Chess demo / size optimization</a></div>
    <div class="body"><div class="quote"><br />&quot;See: <a target="_blank" href="http://www.programmingjournal.com/issue4/art3/index.htm">http://www.programmingjournal.com/issue4/art3/index.htm</a>&quot;<br />Very slow example, stolen from viral writers<br /><br />&quot;Scanning the memory of the system dlls is better than using fixed values&quot;<br />Wrong<br /><br />The best way is to patch your .exe file using fixed values<br />The patcher is  your setup.exe<br /><br />If you change OS, you must start your setup.exe again to repatch it.</div><br />Where do you get this information from? your knowledge doesnt come from<br />just reading plain assembly tutorials/books? I would be interested in some<br />links to any reading material you may know of. ( ;) )</div>
    <div class="meta">Posted on 2003-01-12 16:25:28 by natas</div>
   </div>
   <div class="post" id="post-76253">
    <div class="subject"><a href="#post-76253">Chess demo / size optimization</a></div>
    <div class="body"><div class="quote"><br /><br />Where do you get this information from? your knowledge doesnt come from<br />just reading plain assembly tutorials/books? I would be interested in some<br />links to any reading material you may know of. ( ;) ) </div><br /><br />I think I read different ezines than lingo :grin:</div>
    <div class="meta">Posted on 2003-01-12 17:09:18 by bazik</div>
   </div>
   <div class="post" id="post-76273">
    <div class="subject"><a href="#post-76273">Chess demo / size optimization</a></div>
    <div class="body">... Me dont care about the rules, and decided to write stuff that could potentially shut the board down...</div>
    <div class="meta">Posted on 2003-01-12 18:40:45 by Jan Wassenberg</div>
   </div>
   <div class="post" id="post-76267">
    <div class="subject"><a href="#post-76267">Chess demo / size optimization</a></div>
    <div class="body"><strong>Thanks Jan Wassenberg!</strong> ... me know the rulez too but decided take advantage of the presented content.   Me know mods will remove it so me feel smart that i got it anyways.   Who cares if the board shuts down, i got what i want.</div>
    <div class="meta">Posted on 2003-01-12 19:05:47 by natas</div>
   </div>
   <div class="post" id="post-76274">
    <div class="subject"><a href="#post-76274">Chess demo / size optimization</a></div>
    <div class="body">oh yeah *sigh*<br /><br />Me realize this is against the rulez and still add more forbidden content, and chuckle with natas.</div>
    <div class="meta">Posted on 2003-01-12 19:23:38 by Jan Wassenberg</div>
   </div>
   <div class="post" id="post-76258">
    <div class="subject"><a href="#post-76258">Chess demo / size optimization</a></div>
    <div class="body"><strong><span style="font-size:18px>Keep your personal phillosophies regarding such content to yourself or private email!  Abide by the rules.  They are there for a purpose!! </span></strong></div>
    <div class="meta">Posted on 2003-01-12 22:01:19 by NaN</div>
   </div>
   <div class="post" id="post-76268">
    <div class="subject"><a href="#post-76268">Chess demo / size optimization</a></div>
    <div class="body"><div class="quote"><br /><strong>Thanks Jan Wassenberg!</strong> ... me know the rulez too but decided take advantage of the presented content.   Me know mods will remove it so me feel smart that i got it anyways.   Who cares if the board shuts down, i got what i want.<br /> </div> <br />Ofcourse I took advantage of the presented content! Why shouldnt I?<br />I knew the links were illegal on this board. However, I didnt post them!!! <br />I DID NOT ASK FOR ANYTHING THAT WOULD VIOLATE THE RULES OF THIS BOARD! :mad: <br /><br />When other people post things wich are not allowed on this board I usually tell <br />them(like I did in this case too).What they do when I remind them is upto them. <br />Other people on this board usually edites and removes the &quot;illegal&quot; text after they <br />are reminded. So calm down!</div>
    <div class="meta">Posted on 2003-01-12 23:42:36 by natas</div>
   </div>
   <div class="post" id="post-76254">
    <div class="subject"><a href="#post-76254">Chess demo / size optimization</a></div>
    <div class="body">Sorry NaN for editing your post, but I hate that Steve Gibson'ing :rolleyes:</div>
    <div class="meta">Posted on 2003-01-13 06:59:52 by bazik</div>
   </div>
   <div class="post" id="post-76261">
    <div class="subject"><a href="#post-76261">Chess demo / size optimization</a></div>
    <div class="body">who in the hell cares about what you hate... editing posts of others could<br />be seriosly more dangerous to this board than posting code to get api's from <br />memory ( or whatever jan posted... i didn't had the chance to read it ). <br /><br />what is this all about, write code that's better than gibsons and THEN start<br />the whining.</div>
    <div class="meta">Posted on 2003-01-13 10:02:00 by mob</div>
   </div>
   <div class="post" id="post-76255">
    <div class="subject"><a href="#post-76255">Chess demo / size optimization</a></div>
    <div class="body">&gt;who in the hell cares about what you hate... editing posts of others could<br />&gt;be seriosly more dangerous to this board than posting code to get api's from <br />&gt;memory ( or whatever jan posted... i didn't had the chance to read it ). <br /><br />First, I just made the font size smaller, mob so stop f*cking me off. <br /><br />&gt;what is this all about, write code that's better than gibsons and THEN start<br />&gt;the whining. <br /><br />Second, I <strong>never</strong> sayed I could write better code as he does. I simply hate this colorfull, big letter writing.</div>
    <div class="meta">Posted on 2003-01-13 10:42:23 by bazik</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=10174&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=10174&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="10174" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=10174&amp;page=2">&gt;</a><a href="../?id=10174&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>