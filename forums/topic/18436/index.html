<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>D3D9 includes with COINVOKE-method - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18436" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=18436">D3D9 includes with COINVOKE-method</a></p>
   <div class="post" id="post-142765">
    <div class="subject"><a href="#post-142765">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">Finally after resolving the problem why I could not link<br />the Directx examples from Scrontsoft, ( I needed to<br />replace the UUID.LIB with the UUID.LIB from VC++ v6 )<br />I started to translate the d3dx9 include files.<br /><br />I've used the COINVOKE method.<br /><br />They are complete, except for the d3dx9math.inl those are<br />not completed yet.<br /><br />The most important ones are present:<br /><br />D3DXVec3Length<br />D3DXVec3Dot<br />D3DXVec3Cross<br />D3DXMatrixIdentity<br /><br />Also added some usefull macros:<br /><br />1) FLOAT_<br /><br />2) GUID_ADDR<br /><br />3) TEXT_<br /><br />4) Alloc_mem and Delete_mem (see sources how to use them)<br /><br /><br />To demonstrate the direct3D9 includes i've translated the<br />&quot;meshes tutorial&quot; of the directx9_sdk (summer edition)<br />(I'll do some more in the future when I find some time)<br /><br /><br />And here you can download the complete package:<br /><br />   <a target="_blank" href="http://members.home.nl/siekmanski/d3dx9_asm.zip">http://members.home.nl/siekmanski/d3dx9_asm.zip</a><br /><br />Have fun with it and let me know if you find some errors.<br /><br />Dsound update... (june 13th)<br /><br /> Siekmanski</div>
    <div class="meta">Posted on 2004-06-03 04:28:49 by Siekmanski</div>
   </div>
   <div class="post" id="post-142767">
    <div class="subject"><a href="#post-142767">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">here are the includes without the libs:<br /><br />Dsound update... (june 13th)<br /><br />Update (june 18th)</div>
    <div class="meta">Posted on 2004-06-03 04:33:21 by Siekmanski</div>
   </div>
   <div class="post" id="post-142779">
    <div class="subject"><a href="#post-142779">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">Nice work.<br />The COINVOKE method is equivalent to the ICALL method from atc.<br />Under atc we have the options pcall, icall, ocall.<br />Therefore, should I wish, I can format my source similarly, or even add an equate COINVOKE textequ ICALL or similar to use YOUR source with MY headers :)</div>
    <div class="meta">Posted on 2004-06-03 08:27:16 by Homer</div>
   </div>
   <div class="post" id="post-142787">
    <div class="subject"><a href="#post-142787">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">Hello EvilHomer2k<br /><br />I'm not familiar with all those other COM-calling stuff.<br />It's nice to share the same interest in 3d programming.<br />Hopefully we can use all the d3d9 stuff in assembler.<br />I'm going to try some stuff to test the includes and then<br />post it.<br /><br />I need much more time (36 hours in a day sounds good to me).</div>
    <div class="meta">Posted on 2004-06-03 10:55:04 by Siekmanski</div>
   </div>
   <div class="post" id="post-142896">
    <div class="subject"><a href="#post-142896">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">just updated the FLOAT_ macro in the file: dx9macros.inc<br /><br />FLOAT_ MACRO float_number:REQ<br />	LOCAL float_num<br />	.data<br />	 float_num FLOAT float_number<br />	.code<br />	EXITM &lt;float_num&gt;<br />ENDM<br /><br />chanched to:<br /> <br />FLOAT_ MACRO float_number:REQ<br />	LOCAL float_num<br />	.data<br />	 float_num dd float_number<br />	.code<br />	EXITM &lt;float_num&gt;<br />ENDM<br /><br /><br />It couldn't handle negative numbers, now it can.<br /><br />Allmost done translating the TEXT3D example of the dx9_SDK<br />Post it as it's done.<br /><br />SIEKMANSKI</div>
    <div class="meta">Posted on 2004-06-05 06:26:32 by Siekmanski</div>
   </div>
   <div class="post" id="post-142975">
    <div class="subject"><a href="#post-142975">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">That still won't work, unless you type it as a SFLOAT (as a REAL4 or REAL8).</div>
    <div class="meta">Posted on 2004-06-06 05:21:28 by Homer</div>
   </div>
   <div class="post" id="post-142981">
    <div class="subject"><a href="#post-142981">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">Hello EvilHomer2k<br /><br /> If I do this piece of code,<br /><br />.data<br /> number dd 0<br />.code<br /><br />	fld FLOAT_(50.0f)<br />	fadd FLOAT_(-10.0f)<br />	fistp number<br /><br />I get as a result: 40</div>
    <div class="meta">Posted on 2004-06-06 07:09:37 by Siekmanski</div>
   </div>
   <div class="post" id="post-142982">
    <div class="subject"><a href="#post-142982">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">Yes, but tests like .if fMyFloat&gt;0 will fail (I think).<br />Check and tell me what happens :)</div>
    <div class="meta">Posted on 2004-06-06 07:11:46 by Homer</div>
   </div>
   <div class="post" id="post-142984">
    <div class="subject"><a href="#post-142984">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">I shall test it.<br /><br />I don't have the time now, tell you in a few hours.</div>
    <div class="meta">Posted on 2004-06-06 07:20:54 by Siekmanski</div>
   </div>
   <div class="post" id="post-142985">
    <div class="subject"><a href="#post-142985">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">Floats are always signed, so there should only be one datatype anyway, the signed one.<br />I am not sure what the .IF macro would do though. Perhaps the problem is that the other side of the comparison is unsigned?</div>
    <div class="meta">Posted on 2004-06-06 07:21:32 by Scali</div>
   </div>
   <div class="post" id="post-143125">
    <div class="subject"><a href="#post-143125">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">d3dtext example translated.<br /><br />let me know if i'ts working on your computer.<br />btw, float_ macro didn't work in &quot;.IF&quot; macro.<br /><br />I'll use something like this instead of .IF:<br /><br />	fcomp	st(1)<br />	fnstsw	ax<br />	sahf<br />	jnc	label<br /><br />Here is the  exe and source-code.</div>
    <div class="meta">Posted on 2004-06-07 12:22:28 by Siekmanski</div>
   </div>
   <div class="post" id="post-143126">
    <div class="subject"><a href="#post-143126">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">Since negative floats use bit31 for sign just like signed integers, you can simply:<br />and eax,80000000h<br />jz label</div>
    <div class="meta">Posted on 2004-06-07 12:35:45 by Homer</div>
   </div>
   <div class="post" id="post-143127">
    <div class="subject"><a href="#post-143127">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">Thanks EvilHomer2k<br /><br />Just fast and simple, will try that.<br />Tested your code and includes they work fine on my computer.</div>
    <div class="meta">Posted on 2004-06-07 12:42:15 by Siekmanski</div>
   </div>
   <div class="post" id="post-143175">
    <div class="subject"><a href="#post-143175">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">I still recommend Caleb's d3dx8math_fkt.def file from his dx8.0 includes, which contains a bunch of handy fpu math macros including such gems as __FJG (meant to be used in conjunction with fcom/fcomp), where it is appropriate to work strictly in fpu.</div>
    <div class="meta">Posted on 2004-06-08 00:17:27 by Homer</div>
   </div>
   <div class="post" id="post-143180">
    <div class="subject"><a href="#post-143180">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">I'll check it out, must have them somewhere.</div>
    <div class="meta">Posted on 2004-06-08 01:40:19 by Siekmanski</div>
   </div>
   <div class="post" id="post-143687">
    <div class="subject"><a href="#post-143687">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">DSound9 includes Translated..<br /><br />Included a Playwav example to demonstrate includes<br /><br />Later, Siekmanski</div>
    <div class="meta">Posted on 2004-06-13 14:34:28 by Siekmanski</div>
   </div>
   <div class="post" id="post-144086">
    <div class="subject"><a href="#post-144086">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">Modified for atc, to test my dsound.inc<br /><br /><pre><code><br />	title	Playwav - Siekmanski 2004 - Modified by Homer for ATC<br /><br />         .586<br />         .model flat, stdcall<br />         option casemap &#58;none   ; Case sensitive<br />   <br />	include	\masm32\include\windows.inc<br />	include	\masm32\include\user32.inc<br />	include	\masm32\include\kernel32.inc<br />	include	\masm32\include\comdlg32.inc<br />	include	\masm32\include\winmm.inc<br /><br />__DEBUG__ equ 0<br />return macro px&#58;REQ<br />mov eax,px<br />ret<br />endm<br /><br />m2m macro pd&#58;REQ,ps&#58;REQ<br />push ps<br />pop pd<br />endm<br /><br />       include \masm32\d3d9\class31.inc              ;Ultrano<br />       include \masm32\d3d9\include\dsound.inc  ;Homer<br /><br />	includelib  \masm32\lib\user32.lib<br />	includelib  \masm32\lib\kernel32.lib<br />	includelib	\masm32\lib\comdlg32.lib<br />	includelib	\masm32\lib\winmm.lib<br /><br />	includelib	dsound.lib<br /><br />.data<br /><br />align	4<br />g_pDS				LPDIRECTSOUND8		NULL<br />set g_pDS as IDirectSound8<br />g_pDSWavSample		LPDIRECTSOUNDBUFFER8	NULL<br />set g_pDSWavSample as IDirectSoundBuffer8<br /><br />dshWnd			dd 0<br />hInst          	      dd 0<br />String_buffer  	      db 128 dup &#40;0&#41;<br /><br />OpenTitel			db &quot;Open Wav file&quot;,0<br />OpenFilter			db &quot;Wav files&quot;,0,&quot;*.wav&quot;,0,0<br />FilenaamPlusPad	      db 260 dup&#40;0&#41;<br />Filenaam			db 128 dup&#40;0&#41;<br />ofn				OPENFILENAME &lt;&gt;  ; structure<br /><br />.code<br /><br />Load_wav proc Wav_name&#58;DWORD,pDSBuffer&#58;DWORD<br />LOCAL w_pDSSample&#58;LPDIRECTSOUNDBUFFER8<br />set w_pDSSample as IDirectSoundBuffer8<br />LOCAL dsbdesc&#58;DSBUFFERDESC<br />LOCAL hMmio&#58;DWORD<br />LOCAL WaveInfo&#58;MMCKINFO<br />LOCAL ChunkInfo&#58;MMCKINFO<br />LOCAL wfx&#58;WAVEFORMATEX<br />LOCAL S_data&#58;DWORD<br />LOCAL S_lengte&#58;DWORD<br /><br />	mov			eax,pDSBuffer	; get the soundbuffer adres<br />	mov			eax,&#91;eax&#93;<br />	mov			w_pDSSample,eax ; save adres<br /><br />	.if 	w_pDSSample ; release in case it is an old sample<br />                pcall w_pDSSample.Release<br />            .endif<br /><br />	;Open the WAV-file and get all info<br />	invoke	mmioOpen,Wav_name,NULL,MMIO_ALLOCBUF or MMIO_READ	; Open the WAV file<br />	.if &#40;eax&#41;<br />		mov		hMmio,eax<br />		mov		WaveInfo.fccType,&quot;EVAW&quot;	; WAVE header info<br />		invoke	mmioDescend,hMmio,addr WaveInfo,NULL,MMIO_FINDRIFF<br />		.if &#40;eax&#41;<br />			invoke	MessageBox,NULL,CTEXT&#40;&quot;this is not a wav file...&quot;&#41;,CTEXT&#40;&quot;Wav read error&quot;&#41;,MB_OK OR MB_ICONERROR<br />			jmp		Load_wav_error<br />		.endif<br />		mov		ChunkInfo.ckid,&quot; tmf&quot;		; fmt  field in WAVE header<br />		invoke	mmioDescend,hMmio,addr ChunkInfo,addr WaveInfo,MMIO_FINDCHUNK<br />		.if &#40;eax&#41;<br />			invoke	MessageBox,NULL,CTEXT&#40;&quot;FMT Chunk not found...&quot;&#41;,CTEXT&#40;&quot;Wav read error&quot;&#41;,MB_OK OR MB_ICONERROR<br />			jmp		Load_wav_error<br />		.endif<br />		invoke	mmioRead,hMmio,addr wfx,ChunkInfo.ckSize	; read Wave Format Header<br />		.if &#40;eax != ChunkInfo.ckSize&#41;<br />			invoke	MessageBox,NULL,CTEXT&#40;&quot;Wave Format Info Read Error...&quot;&#41;,CTEXT&#40;&quot;Wav read error&quot;&#41;,MB_OK OR MB_ICONERROR<br />			jmp		Load_wav_error<br />		.endif<br />		invoke	mmioAscend,hMmio,addr ChunkInfo,NULL<br />		mov		ChunkInfo.ckid,&quot;atad&quot;	; Wave Data<br />		invoke	mmioDescend, hMmio,addr ChunkInfo,addr WaveInfo,MMIO_FINDCHUNK<br />		.if &#40;eax&#41;<br />			invoke	MessageBox,NULL,CTEXT&#40;&quot;DATA Chunk not found...&quot;&#41;,CTEXT&#40;&quot;Wav read error&quot;&#41;,MB_OK OR MB_ICONERROR<br />			jmp		Load_wav_error<br />		.endif<br /><br /><br />	; Init a Directsound buffer with the Info we found in the Wav-file<br />	invoke		RtlZeroMemory,ADDR dsbdesc,sizeof dsbdesc<br />            mov			dsbdesc.dwSize,sizeof DSBUFFERDESC<br />            mov			dsbdesc.dwFlags,DSBCAPS_GLOBALFOCUS<br />	mov			eax,ChunkInfo.ckSize		; Wav-data size<br />	mov			dsbdesc.dwBufferBytes,eax<br />	lea			eax,wfx						; Wav-data format<br />	mov			dsbdesc.lpwfxFormat,eax<br />	lea			eax,dsbdesc.guid3DAlgorithm<br />            lea                               ebx,DS3DALG_DEFAULT<br />	invoke RtlMoveMemory,eax,ebx,16<br /><br />	; create the soundbuffer<br />	icall	g_pDS,IDirectSound8,CreateSoundBuffer,addr dsbdesc,addr w_pDSSample,NULL <br />	.if &#40;eax != DS_OK&#41;<br />		invoke	MessageBox, NULL, CTEXT&#40;&quot;CreateSoundBuffer...&quot;&#41;, CTEXT&#40;&quot;DSound Error&quot;&#41;,MB_OK OR MB_ICONERROR<br />		jmp		Load_wav_error<br />	.endif<br /><br />	; lock and get the adres of the soundbuffer<br />	icall	w_pDSSample,IDirectSoundBuffer8,Lock,0,ChunkInfo.ckSize,addr S_data,addr S_lengte,NULL,0,0 <br />	.if &#40;eax != DS_OK&#41;<br />		invoke	MessageBox, NULL, CTEXT&#40;&quot;Lock SoundBuffer...&quot;&#41;, CTEXT&#40;&quot;DSound Error&quot;&#41;,MB_OK OR MB_ICONERROR<br />		jmp		Load_wav_error<br />	.endif<br /><br />	; Read the wave data into the soundbufffer<br />	invoke		mmioRead,hMmio,S_data,ChunkInfo.ckSize<br /><br />	; unlock the soundbuffer<br />	icall	w_pDSSample,IDirectSoundBuffer8,Unlock,S_data,S_lengte,NULL,0 <br />	.if &#40;eax != DS_OK&#41;<br />		invoke	MessageBox, NULL, CTEXT&#40;&quot;Unlock SoundBuffer...&quot;&#41;, CTEXT&#40;&quot;DSound Error&quot;&#41;,MB_OK OR MB_ICONERROR<br />		jmp		Load_wav_error<br />	.endif<br />	; set sample start position<br />	icall	w_pDSSample,IDirectSoundBuffer8,SetCurrentPosition,0 <br />.else<br />	invoke		MessageBox,NULL,CTEXT&#40;&quot;wav file not found...&quot;&#41;,CTEXT&#40;&quot;Wav read error&quot;&#41;,MB_OK OR MB_ICONERROR<br />	jmp			No_wav<br />.endif<br />	xor			ecx,ecx<br />	xor			edx,edx<br />	mov			eax,wfx.nSamplesPerSec<br />	mov			cx,wfx.wBitsPerSample <br />	mov			dx,wfx.nChannels<br /><br />   invoke		wsprintf,addr String_buffer,CTEXT&#40;&quot; Rate&#58; %d   BPS&#58; %d   Channels&#58; %d   Length&#58; %d&quot;&#41;,eax,ecx,edx,ChunkInfo.ckSize<br /><br />	invoke		SetDlgItemText,dshWnd,101,addr String_buffer<br /><br />	invoke		mmioClose,hMmio,NULL<br />	mov			eax,pDSBuffer<br />	mov			ecx,w_pDSSample<br />	mov			&#91;eax&#93;,ecx		; save soundbuffer adres<br />	return		DS_OK<br />Load_wav_error&#58;<br />	invoke		mmioClose,hMmio,NULL<br />            .if w_pDSSample<br />	   pcall w_pDSSample.Release<br />            .endif<br />No_wav&#58;<br />	invoke		SetDlgItemText,dshWnd,100,CTEXT&#40;&quot; no file loaded..&quot;&#41;<br />	invoke		SetDlgItemText,dshWnd,101,CTEXT&#40;&quot; none..&quot;&#41;<br />	mov			eax,pDSBuffer<br />	xor			ecx,ecx<br />	mov			&#91;eax&#93;,ecx		; clear soundbuffer adres<br />	return		E_FAIL<br />Load_wav endp<br /><br />;________________________________________________________________________________<br /><br />StartDSound 	proc hwnd&#58;DWORD,Mono_stereo&#58;DWORD,Sample_rate&#58;DWORD,Sample_bits&#58;DWORD<br />LOCAL		dsbdesc&#58;DSBUFFERDESC<br />LOCAL		wfx&#58;WAVEFORMATEX<br />LOCAL		g_pDSBPrimary&#58;LPDIRECTSOUNDBUFFER8<br /><br />	invoke		DirectSoundCreate8,NULL,addr g_pDS,NULL<br />	.if &#40;eax != DS_OK&#41;<br />		invoke	MessageBox, NULL, CTEXT&#40;&quot;DirectSoundCreate...&quot;&#41;, CTEXT&#40;&quot;DSound Error&quot;&#41;,MB_OK OR MB_ICONERROR<br />		return	E_FAIL<br />	.endif<br /><br />	icall	g_pDS,IDirectSound8,SetCooperativeLevel,hwnd,DSSCL_PRIORITY <br />	.if &#40;eax != DS_OK&#41;<br />		invoke	MessageBox, NULL, CTEXT&#40;&quot;SetCooperativeLevel...&quot;&#41;, CTEXT&#40;&quot;DSound Error&quot;&#41;,MB_OK OR MB_ICONERROR<br />		return	E_FAIL<br />	.endif<br /><br />	invoke		RtlZeroMemory,ADDR dsbdesc,sizeof dsbdesc<br />   mov			dsbdesc.dwSize,sizeof DSBUFFERDESC<br />   mov			dsbdesc.dwFlags,DSBCAPS_PRIMARYBUFFER<br />	icall	g_pDS,IDirectSound8,CreateSoundBuffer,addr dsbdesc,addr g_pDSBPrimary,NULL <br />	.if &#40;eax != DS_OK&#41;<br />		invoke	MessageBox, NULL, CTEXT&#40;&quot;CreateSoundBuffer...&quot;&#41;, CTEXT&#40;&quot;DSound Error&quot;&#41;,MB_OK OR MB_ICONERROR<br />		return	E_FAIL<br />	.endif<br /><br />	invoke		RtlZeroMemory,ADDR wfx,sizeof wfx<br />	mov			wfx.wFormatTag,WAVE_FORMAT_PCM <br />	mov			eax,Mono_stereo<br />	mov			wfx.nChannels,ax<br />	mov			eax,Sample_bits<br />	mov			wfx.wBitsPerSample,ax <br />	mul			Mono_stereo<br />	shr			eax,3<br />	mov			wfx.nBlockAlign,ax<br />	mov			ecx,Sample_rate<br />	mov			wfx.nSamplesPerSec,ecx<br />	mul			ecx<br /> 	mov			wfx.nAvgBytesPerSec,eax<br /><br />	icall 	g_pDSBPrimary,IDirectSoundBuffer8,SetFormat,addr wfx<br />	.if &#40;eax != DS_OK&#41;<br />		invoke		MessageBox, NULL, CTEXT&#40;&quot;SetFormat Primary Buffer...&quot;&#41;, CTEXT&#40;&quot;DSound Error&quot;&#41;,MB_OK OR MB_ICONERROR<br />		return	E_FAIL<br />	.endif<br />            set g_pDSBPrimary as IDirectSoundBuffer8<br />	.if g_pDSBPrimary<br />                pcall g_pDSBPrimary.Release<br />            .endif<br />	return	DS_OK<br />StartDSound	endp<br /><br /><br />StopDSound 	proc<br />	.if g_pDSWavSample<br />                pcall g_pDSWavSample.Release<br />            .endif<br />            .if  g_pDS<br />    	    pcall g_pDS.Release<br />            .endif<br />	return	0<br />StopDSound	endp<br /><br />WndProc proc   hWnd&#58;DWORD, uMsg, wParam, lParam<br />LOCAL    hIcon&#58;DWORD<br />	.if uMsg == WM_INITDIALOG<br />			invoke	LoadIcon, hInst, 200<br />			mov	hIcon,eax<br />			mov		eax,hWnd<br />			mov		dshWnd,eax<br />			invoke	SendMessage,hWnd,WM_SETICON,1,hIcon<br /><br />			invoke	StartDSound,hWnd,2,44100,16  <br />			.if &#40;eax != DS_OK&#41;<br />				jmp	close<br />			.endif<br /><br />			invoke	Load_wav,CTEXT&#40;&quot;directx4.wav&quot;&#41;,addr g_pDSWavSample<br />			.if &#40;g_pDSWavSample != 0&#41;<br />				invoke		SetDlgItemText,hWnd,100,CTEXT&#40;&quot; Name&#58; directx4.wav&quot;&#41;<br />				icall	g_pDSWavSample,IDirectSoundBuffer8,SetCurrentPosition,0 <br />				icall	g_pDSWavSample,IDirectSoundBuffer8,Play,0,0,0<br />			.endif<br />			return	0<br /><br />	.elseif uMsg == WM_COMMAND<br />		.if wParam == 102<br />			mov		FilenaamPlusPad&#91;0&#93;,0<br />			mov		Filenaam&#91;0&#93;,0<br />			mov		ofn.lStructSize,&#40;sizeof OPENFILENAME&#41;<br />			m2m		ofn.hWndOwner,hWnd<br />			m2m		ofn.hInstance,hInst<br />			m2m		ofn.lpstrFilter,offset OpenFilter<br />			m2m		ofn.lpstrFile,offset FilenaamPlusPad<br />			mov		ofn.nMaxFile,&#40;sizeof FilenaamPlusPad&#41;<br />			m2m		ofn.lpstrFileTitle,offset Filenaam<br />			mov		ofn.nMaxFileTitle,&#40;sizeof Filenaam&#41;<br />			m2m		ofn.lpstrTitle,offset OpenTitel<br />			mov		ofn.Flags,OFN_EXPLORER or OFN_FILEMUSTEXIST or OFN_LONGNAMES<br />			invoke	GetOpenFileName,ADDR ofn<br />			.if &#40;FilenaamPlusPad&#91;0&#93; != 0&#41;<br />				invoke	Load_wav,addr FilenaamPlusPad,addr g_pDSWavSample<br />		   		invoke	wsprintf,addr String_buffer,CTEXT&#40;&quot; Name&#58; %s&quot;&#41;,addr Filenaam<br />				invoke	SetDlgItemText,hWnd,100,addr String_buffer<br />				ret<br />			.endif<br />		.elseif wParam == 103<br />			.if &#40;g_pDSWavSample != 0&#41;<br />				icall	g_pDSWavSample,IDirectSoundBuffer8,SetCurrentPosition,0 <br />				invoke		GetDlgItem,hWnd,105<br />				invoke		SendMessage,eax,BM_GETSTATE,0,0<br />				.if	&#40;eax == BST_CHECKED&#41;<br />					icall	g_pDSWavSample,IDirectSoundBuffer8,Play,0,0,DSBPLAY_LOOPING <br />					ret<br />				.else<br />					icall	g_pDSWavSample,IDirectSoundBuffer8,Play,0,0,0 <br />					ret<br />				.endif<br />			.endif<br /><br /><br />		.elseif wParam == 104<br />			.if &#40;g_pDSWavSample != 0&#41;<br />				icall	g_pDSWavSample,IDirectSoundBuffer8,Stop <br />				ret<br />			.endif<br />         .endif<br /><br />	.elseif uMsg == WM_CLOSE<br />close&#58;		invoke	StopDSound<br />			invoke	EndDialog,hWnd,0<br />			return	0<br />	.endif<br />	return	0<br />WndProc endp<br /><br />start&#58;<br />	invoke	GetModuleHandle,NULL<br />	mov		hInst,eax<br />	invoke	DialogBoxParam,hInst,CTEXT&#40;&quot;TESTDLG&quot;,0&#41;,0,addr WndProc,0<br />	invoke	ExitProcess,0<br />end start<br /></code></pre><br /><br />works :)</div>
    <div class="meta">Posted on 2004-06-17 03:07:48 by Homer</div>
   </div>
   <div class="post" id="post-144099">
    <div class="subject"><a href="#post-144099">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">Hello EvilHomer2k<br /><br />Yes it works OK !!!<br /><br />I have also included a streaming soundbuffer in my Aspi based<br />Digital CD-Player. It works perfectly !<br />I'm not finished yet with this CD-Player because of this DX9 project.<br /><br />My next idea is to run to the Computer-shop and buy a FORCE-FEEDBACK<br />game pad and then translating the DirectInput include.<br /><br />At this moment I'm coding a DX9 &quot;skeleton source&quot; wich will have all<br />the basic functionalities I need for GAME/DEMO coding such as:<br /><br />Auto-search for  the best Vertexprocessing_type and D3DDevice_type,<br />Enumerating display modes, flipping between Windowed and Fullscreen mode<br />or let the User choose from a dialogbox.<br /><br />So everything will be there even for testing all modes.<br /><br />BTW, Did anyone tested my DX9 examples or used my D3D9 includes ?<br /><br />I'm all ears for comments suggestions bugs etc. <br /><br />Later, Siekmanski</div>
    <div class="meta">Posted on 2004-06-17 07:35:06 by Siekmanski</div>
   </div>
   <div class="post" id="post-144105">
    <div class="subject"><a href="#post-144105">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">I tested your examples, they worked fine.<br />Don't be discouraged by the lack of interest in your includes, it's early days... besides, if they want to code dx in asm, they have little choice ;)</div>
    <div class="meta">Posted on 2004-06-17 09:30:28 by Homer</div>
   </div>
   <div class="post" id="post-144148">
    <div class="subject"><a href="#post-144148">D3D9 includes with COINVOKE-method</a></div>
    <div class="body">D3D9 includes update !!!!<br /><br />Removed a bug......<br /><br />Later Siekmanski.</div>
    <div class="meta">Posted on 2004-06-17 21:16:11 by Siekmanski</div>
   </div>
  </div>
 </body>
</html>