<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Right SMTP? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19459" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=19459">Right SMTP?</a></p>
   <div class="post" id="post-150016">
    <div class="subject"><a href="#post-150016">Right SMTP?</a></div>
    <div class="body">I have an e-mail sender here but it is not working. I don't know if the mistake is on the SMTP adresses or on the code. Does anyone know the SMTP of yahoo and the hotmail? Thank you<br /><br /><pre><code><br />.386<br />.MODEL FLAT, STDCALL<br />LOCALS @@<br /><br />EXTRN WSAStartup		&#58;PROC<br />EXTRN socket		&#58;PROC<br />EXTRN gethostbyname	&#58;PROC<br />EXTRN htons		&#58;PROC<br />EXTRN connect		&#58;PROC<br />EXTRN closesocket		&#58;PROC<br />EXTRN WSACleanup		&#58;PROC<br />EXTRN ExitProcess		&#58;PROC<br />EXTRN closesocket		&#58;PROC<br />EXTRN WSACleanup		&#58;PROC<br />EXTRN MessageBoxA		&#58;PROC<br />EXTRN ExitProcess		&#58;PROC<br />EXTRN recv		&#58;PROC<br />EXTRN lstrlen		&#58;PROC<br />EXTRN send		&#58;PROC<br /><br />INCLUDE TOOLS\W32.INC<br /><br />.DATA<br /><br />; ------------------------- INFORMA??O DO SMTP -------------------------<br />;<br />INICIAR			DB	&quot;HELO pop3.yahoo.com&quot;, 13, 10, 0<br />ORIGEM			DB	&quot;MAIL FROM&#58;&lt;dcba@yahoo.com&gt;&quot;, 13, 10, 0<br />DESTINO			DB	&quot;RCPT TO&#58;&lt;abcd@hotmail.com&gt;&quot;, 13, 10, 0<br />DADOS			DB	&quot;DATA&quot;, 13, 10, 0<br />FECHAR			DB	&quot;RSET&quot;, 13, 10, 0<br />SAIR			DB	&quot;QUIT&quot;, 13, 10, 0<br />TEXTO			DB	13, 10, &quot;Mensagem enviada pelo&quot;, 13, 10<br />			DB	&quot;programa do Rodrigo !&quot;, 13, 10, '.', 13, 10, 0<br />;<br />; ---------------------------------------------------------------------<br /><br />hSOCKET			DD	?, 0<br />SMTP			DB	&quot;pop3.hotmail.com&quot;, 0<br />BUFFER			DB	501 DUP&#40;0&#41;<br /><br />rs221			DB 	&quot;221 &quot;, 0<br />rs250			DB	&quot;250 &quot;, 0<br />rs354			DB	&quot;354 &quot;, 0<br /><br />ERRO			DB	&quot;Erro  &quot;, 0<br />CERTO			DB	&quot;Tudo bem !&quot;, 0<br /><br />ALIGN 4<br />WSADATA			STRUC<br />wVersion		DW	?<br />wHighVersion		DW	?<br />szDescription		DB	257 DUP&#40;?&#41;<br />szSystemStatus		DB	129 DUP&#40;?&#41;<br />iMaxSockets		DW	?<br />iMaxUdpDg		DW	?<br />lpVendorInfo		DD	?<br />WSADATA			ENDS<br />WSD			WSADATA &lt;&gt;<br /><br />ALIGN 4<br />SOCKADDR_IN		STRUC<br />sin_family		DW	?<br />sin_port		DW	?<br />sin_addr		DD	?<br />sin_zero		DB	8 DUP&#40;?&#41;<br />SOCKADDR_IN		ENDS<br />SIN			SOCKADDR_IN &lt;AF_INET,?,?,?&gt;<br /><br />.CODE<br /><br />MAIN		PROC<br /><br />; --------------------------------------------- 0<br /><br />		PUSH	OFFSET WSD<br />		PUSH	101h<br />		CALL	WSAStartup<br />		TEST	EAX, EAX<br />		JZ	@@1<br /><br />		PUSH	48<br />		JMP	FIM<br /><br />; --------------------------------------------- 1<br /><br />@@1&#58;		PUSH    0<br />		PUSH	SOCK_STREAM<br />		PUSH	AF_INET<br />		CALL	socket<br />		CMP	EAX, INVALID_SOCKET<br />		JNE	@@2<br /><br />		PUSH	49<br />		JMP	FIM<br /><br />@@2&#58;		MOV	&#91;hSOCKET&#93;, EAX<br /><br />; --------------------------------------------- 2<br /><br />		PUSH	OFFSET SMTP<br />		CALL	gethostbyname<br />		TEST	EAX, EAX<br />		JNZ	@@3<br /><br />		PUSH	50<br />		JMP	FIM<br /><br />@@3&#58;		MOV	EBX, EAX<br />		MOV	EBX, &#91;EBX + 12&#93;<br />		MOV	EBX, &#91;EBX&#93;<br />		MOV	EAX, &#91;EBX&#93;<br />		MOV	&#91;SIN.sin_addr&#93;, EAX<br /><br />		PUSH	25<br />		CALL	htons<br />		MOV	&#91;SIN.sin_port&#93;, AX<br /><br />; --------------------------------------------- 3<br /><br />		PUSH	16<br />		PUSH	OFFSET SIN<br />		PUSH	&#91;hSOCKET&#93;<br />		CALL	connect<br />		CMP	EAX, SOCKET_ERROR<br />		JNE	@@4<br /><br />		PUSH	51<br />		JMP	FIM<br /><br />@@4&#58;		CALL	RESPOSTAS<br /><br />		CMP	EAX, &quot; 022&quot;<br />		JNE	FIM<br /><br />; --------------------------------------------- 4<br /><br />		MOV	EAX, DWORD PTR &#91;rs250&#93;<br /><br />		PUSH	EAX<br />		PUSH	OFFSET INICIAR<br />		CALL	ENVIAR_RECEBER<br />		TEST	EAX, EAX<br />		JZ	@@5<br /><br />		PUSH	52<br />		JMP	FIM<br /><br />; --------------------------------------------- 5<br /><br />@@5&#58;		MOV	EAX, DWORD PTR &#91;rs250&#93;<br /><br />		PUSH	EAX<br />		PUSH	OFFSET ORIGEM<br />		CALL	ENVIAR_RECEBER<br />		TEST	EAX, EAX<br />		JZ	@@6<br /><br />		PUSH	53<br />		JMP	FIM<br /><br />; --------------------------------------------- 6<br /><br />@@6&#58;		MOV	EAX, DWORD PTR &#91;rs250&#93;<br /><br />		PUSH	EAX<br />		PUSH	OFFSET DESTINO<br />		CALL	ENVIAR_RECEBER<br />		TEST	EAX, EAX<br />		JZ	@@7<br /><br />		PUSH	54<br />		JMP	FIM<br /><br />; --------------------------------------------- 7<br /><br />@@7&#58;		MOV	EAX, DWORD PTR &#91;rs354&#93;<br /><br />		PUSH	EAX<br />		PUSH	OFFSET DADOS<br />		CALL	ENVIAR_RECEBER<br />		TEST	EAX, EAX<br />		JZ	@@8<br /><br />		PUSH	55<br />		JMP	FIM<br /><br />; --------------------------------------------- 8<br /><br />@@8&#58;		MOV	EAX, DWORD PTR &#91;rs250&#93;<br /><br />		PUSH	EAX<br />		PUSH	OFFSET TEXTO<br />		CALL	ENVIAR_RECEBER<br />		TEST	EAX, EAX<br />		JZ	@@9<br /><br />		PUSH	56<br />		JMP	FIM<br /><br />; --------------------------------------------- 9<br /><br />@@9&#58;		MOV	EAX, DWORD PTR &#91;rs250&#93;<br /><br />		PUSH	EAX<br />		PUSH	OFFSET FECHAR<br />		CALL	ENVIAR_RECEBER<br />		TEST	EAX, EAX<br />		JZ	@@10<br /><br />		PUSH	57<br />		JMP	FIM<br /><br />; --------------------------------------------- 10<br /><br />@@10&#58;		MOV	EAX, DWORD PTR &#91;rs221&#93;<br /><br />		PUSH	EAX<br />		PUSH	OFFSET SAIR<br />		CALL	ENVIAR_RECEBER<br />		TEST	EAX, EAX<br />		JZ	@@11<br /><br />		PUSH	58<br />		JMP	FIM<br /><br />; --------------------------------------------- 11<br /><br />@@11&#58;		PUSH	&#91;hSOCKET&#93;<br />		CALL	closesocket<br /><br />		CALL	WSACleanup<br /><br />		PUSH	MB_OK<br />		PUSH	OFFSET CERTO<br />		PUSH	OFFSET CERTO<br />		PUSH	0<br />		CALL	MessageBoxA<br /><br />		PUSH	0<br />		CALL	ExitProcess<br />MAIN		ENDP<br /><br />; ---------------------------------------------<br /><br />FIM&#58;		POP	EAX<br />		MOV	&#91;ERRO + 5&#93;, AL<br /><br />		PUSH	&#91;hSOCKET&#93;<br />		CALL	closesocket<br /><br />		CALL	WSACleanup<br /><br />		PUSH	MB_OK<br />		PUSH	OFFSET ERRO<br />		PUSH	OFFSET ERRO<br />		PUSH	0<br />		CALL	MessageBoxA<br /><br />		PUSH	0<br />		CALL	ExitProcess<br /><br />; ---------------------------------------------<br />RESPOSTAS	PROC<br />; ---------------------------------------------<br />		MOV	EDI, OFFSET BUFFER<br />		XOR	EAX, EAX<br />		MOV	ECX, 501<br />		CLD<br /><br />		REP	STOSB<br /><br />		PUSH	0<br />		PUSH	500<br />		PUSH	OFFSET BUFFER<br />		PUSH	&#91;hSOCKET&#93;<br />		CALL	recv<br />		CMP	EAX, SOCKET_ERROR<br />		JE	FIM<br /><br />		MOV	EAX, DWORD PTR &#91;BUFFER&#93;<br />		RET<br />RESPOSTAS	ENDP<br />; ---------------------------------------------<br />;<br />; ---------------------------------------------<br />ENVIAR_RECEBER	PROC<br />		ARG	PACK&#58;DWORD, COND&#58;DWORD<br />; ---------------------------------------------<br />		PUSH	EBX<br />		MOV	EBX, &#91;COND&#93;<br /><br />		PUSH	&#91;PACK&#93;<br />		CALL	lstrlen<br /><br />		PUSH	0<br />		PUSH	EAX<br />		PUSH	&#91;PACK&#93;<br />		PUSH	&#91;hSOCKET&#93;<br />		CALL	send<br />		CMP	EAX, SOCKET_ERROR<br />		JE	FIM<br /><br />		CALL	RESPOSTAS<br />		CMP	EAX, EBX<br />		JNE	@@1<br /><br />		POP	EBX<br />		XOR	EAX, EAX<br />		RET<br /><br />@@1&#58;		POP	EBX<br />		MOV	EAX, 1<br />		RET<br />ENVIAR_RECEBER	ENDP<br />; ---------------------------------------------<br /><br />END		MAIN<br /></code></pre></div>
    <div class="meta">Posted on 2004-09-19 18:41:28 by Marginais</div>
   </div>
   <div class="post" id="post-150017">
    <div class="subject"><a href="#post-150017">Right SMTP?</a></div>
    <div class="body">it's definitely not pop3.hotmail.com, you have to find the mx servers - mx1.hotmail.com, etc.</div>
    <div class="meta">Posted on 2004-09-19 18:55:28 by Drocon</div>
   </div>
   <div class="post" id="post-150018">
    <div class="subject"><a href="#post-150018">Right SMTP?</a></div>
    <div class="body">I've already tried everything - SMTP, POP3, none - but what are these mx servers?</div>
    <div class="meta">Posted on 2004-09-19 19:05:34 by Marginais</div>
   </div>
   <div class="post" id="post-150066">
    <div class="subject"><a href="#post-150066">Right SMTP?</a></div>
    <div class="body">Most MTAs lookup the domain part ( the part after the @ ) of the e-mail address every<br />time.<br /><br /><pre><code><br />.data<br />szHostName db &quot;yahoo.com&quot;,0<br />.code<br />invoke gethostbyname,addr szHostName</code></pre><br /><br />Regards,  P1  8)</div>
    <div class="meta">Posted on 2004-09-20 14:03:08 by Pone</div>
   </div>
   <div class="post" id="post-153383">
    <div class="subject"><a href="#post-153383">Right SMTP?</a></div>
    <div class="body">use pop.skynet.be  this one is almost all the time online and you don't need a password to connect to it (i believe so)</div>
    <div class="meta">Posted on 2004-11-22 18:52:01 by raidu</div>
   </div>
   <div class="post" id="post-153385">
    <div class="subject"><a href="#post-153385">Right SMTP?</a></div>
    <div class="body">To get MX servers, you have to a special DNS look-up.<br /><br />I have source, but it is for FASM (attached).</div>
    <div class="meta">Posted on 2004-11-22 19:05:46 by comrade</div>
   </div>
  </div>
 </body>
</html>