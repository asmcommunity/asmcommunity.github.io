<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Homer's GameDev Tute Project - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15548" />
    <link rel="next" href="../?id=15548&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=10">Graphics &amp; Game Development</a> &raquo; <a href="../?id=15548">Homer's GameDev Tute Project</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=15548&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=15548&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="15548" /><input type="number" name="page" min="1" max="3" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=15548&amp;page=2">&gt;</a><a href="../?id=15548&amp;page=3">&raquo;</a></form>   <div class="post" id="post-120750">
    <div class="subject"><a href="#post-120750">Homer's GameDev Tute Project</a></div>
    <div class="body">Thought I'd create a thread where I can lay out a tutorial in steps starting with a basic win32 skeleton and working from there towards a full d3d game, since I'm teaching several would-be gamecoders at the moment, it seemed appropriate to share with the asm community at the same time.<br />I am looking forwards to seeing much feedback in this thread !!<br />Any sourcecode published here will be absolutely open-sourced.<br />That means you can do anything you like with it.<br /><br />Does this thread sound like something that we can use?</div>
    <div class="meta">Posted on 2003-10-08 02:38:46 by Homer</div>
   </div>
   <div class="post" id="post-120751">
    <div class="subject"><a href="#post-120751">Homer's GameDev Tute Project</a></div>
    <div class="body">nice ideea :alright: <br /><br />it would be nice to have it as a htm, more like Iczelion tutorials (.htm and sources in a zip file).</div>
    <div class="meta">Posted on 2003-10-08 03:11:56 by TBD</div>
   </div>
   <div class="post" id="post-120752">
    <div class="subject"><a href="#post-120752">Homer's GameDev Tute Project</a></div>
    <div class="body">Superb :alright:</div>
    <div class="meta">Posted on 2003-10-08 03:31:12 by AceEmbler</div>
   </div>
   <div class="post" id="post-120792">
    <div class="subject"><a href="#post-120792">Homer's GameDev Tute Project</a></div>
    <div class="body">I'm going to assume that the average village idiot who downloaded MASM and installed it has managed to find the ProStart tool and create a basic win32 skeleton.<br />I'm not going to get bogged down in refining the skeleton for now.<br /><br />Without further ado...<br /><br />The first thing we should know about Direct3D is that D3D basically has two modes of operation - it can run &quot;Windowed&quot;, and it can run &quot;FullScreen&quot;.<br />I'm sure we all understand what these look like.<br /><br />What is less clear is that in order to fire up D3D in the first place, we already need to have an application window !!! That means we NEED a basic win32 skeleton to make at LEAST an application window.<br /><br />The reason is because when we initialize D3D, it asks for the handle of an already existing window.<br /><br />Most of the functions we will use in D3D programming are only available through COM interfaces, but don't be frightened, we have a solution.<br /><br />My tutorials will rely on the &quot;mcall&quot; macro which we will use to call those nasty COM functions, and it works basically the same way as &quot;invoke&quot; does.<br />We'll cover that ground and more as we go.<br /><br />Our first mission then is to lay out a SIMPLE win32 skeleton (use ProStart and disable all the bells and whistles). It doesn't need to do ANYTHING except create a window.<br /><br />I'm not going to explain how the win32 skeleton works, I did that in my MASM FOR MORONS tutorial if you care to search for it.<br /><br />Create a folder inside your MASM folder, and build your project skeleton inside it.<br />Next we'll describe a basic InitD3D procedure and basic D3DCleanup procedure, and maybe we'll also add a sketchy Render function that does little more than clear the screen to a color. <br />If we manage to fit those into the next post, we'll have a DirectX application that does &quot;something&quot;. Nice start, eh?<br /><br />I know I haven't actually said much, nevertheless, please don't hesitate to ask questions along the way.</div>
    <div class="meta">Posted on 2003-10-08 08:59:22 by Homer</div>
   </div>
   <div class="post" id="post-120807">
    <div class="subject"><a href="#post-120807">Homer's GameDev Tute Project</a></div>
    <div class="body">i'm looking forward for such a tutorial! it's all i waited for :)<br />which dx are you going to use? will you give sources for includes etc.? <br />thank you very much! <br /><br />NOP</div>
    <div class="meta">Posted on 2003-10-08 13:01:52 by NOP-erator</div>
   </div>
   <div class="post" id="post-120943">
    <div class="subject"><a href="#post-120943">Homer's GameDev Tute Project</a></div>
    <div class="body">The tutorial will be based around DirectX8.1b which is in my opinion the most universal version in use at the moment and possibly for the next couple of years.<br />Source will be provided for includes where necessary, and we'll even have to make a few REPAIRS to the includes for some functions.<br /><br />Mostly we'll be using Scronty's includes for DirectX8.1, search the board for a link to his download pages.<br /><br />Anyway, I'm sure some of you are keen to get started, so let's :)<br /><br />The first thing I'm going to post is a basic Win32 Skeleton, as well as two important procedures, InitD3D and D3DCleanup.<br />The Skeleton also contains a basic Render driver in the &quot;MessagePump&quot;, but you'll notice it's been disabled until we add a basic Render function.<br /><br />You will need to have libci.lib and uuid.lib in the project folder if you want to build the project as they are &quot;late-bound&quot; by masm's Linker.<br /><br />Notice how tidy (and short) the source is when we use $invoke correctly?<br /><br />This thread is officially open for debate.</div>
    <div class="meta">Posted on 2003-10-10 02:23:51 by Homer</div>
   </div>
   <div class="post" id="post-120944">
    <div class="subject"><a href="#post-120944">Homer's GameDev Tute Project</a></div>
    <div class="body">If you look at the D3DCleanup procedure, you'll notice we use a macro called _saferelease which is just to keep things tidy.<br /><br />I'd just like to describe what _saferelease really does.<br />If you imagine the following code:<br /><br />.if pInterface != NULL<br />mcall ,IUnknown_Release<br />mov pInterface, NULL<br />.endif<br /><br />THATS WHAT _saferelease DOES !!!<br /><br />We hand it a variable name. The macro checks if the variable is NULL, and if it IS NOT NULL, the macro assumes that the variable contains a pointer to a DX interface, which it will release with IUnknown_Release (works for all interfaces), and sets the Var to NULL so that we won't accidentally try to use it or release it again.</div>
    <div class="meta">Posted on 2003-10-10 02:30:19 by Homer</div>
   </div>
   <div class="post" id="post-120946">
    <div class="subject"><a href="#post-120946">Homer's GameDev Tute Project</a></div>
    <div class="body">Does anyone NOT understand what an &quot;interface&quot; is, or how to use the &quot;mcall&quot; macro to call functions belonging to an interface?</div>
    <div class="meta">Posted on 2003-10-10 02:31:48 by Homer</div>
   </div>
   <div class="post" id="post-120953">
    <div class="subject"><a href="#post-120953">Homer's GameDev Tute Project</a></div>
    <div class="body">I use my own interfacing macros, but I can grok what you mean.<br /><br />Incidentally, the uuid.lib included with MASM v8 doesn't contain the IID_IUnknown GUID any more.  This used to be covered for by its inclusion in dxguid.lib from the DirectX SDK, but as of the DX9 SDK it's been removed from there too.  If you get a link error complaining about IID_IUnknown, get the uuid.lib from MASM v7, or define it yourself with this code in your .data section:<br /><br /><pre><code><br />IID_IUnknown  GUID &#123;0,0,0,&lt;0C0h,0,0,0,0,0,0,046h&gt;&#125;<br /></code></pre></div>
    <div class="meta">Posted on 2003-10-10 03:17:29 by Tatterdemalian</div>
   </div>
   <div class="post" id="post-120961">
    <div class="subject"><a href="#post-120961">Homer's GameDev Tute Project</a></div>
    <div class="body">All the GUIDS we will use have been defined manually in one of the header files included in the posted source (I can't remember which, but it's part of MASMv8 anyway...) <br /><br />Even though we may define all guids manually, UUID.LIB is STILL required by the Linker, it seems that its used internally by DX.<br /><br />As for your choice of COM Interface access methods, if you don't want to use MCALL or don't like that interface declaration method, and you understand what you are doing, by all means, choose what you like.<br />If you are new to COM method calls, or don't have a VERY good idea what we are doing when we call COM methods, I recommend sticking to MCALL at least until you do.<br /><br />There's only one drawback to using MCALL, which is that internally it uses the EDX register, which it trashes during an MCALL, so if we WANT to use EDX and we WANT to use mcall, we should bear this in mind.</div>
    <div class="meta">Posted on 2003-10-10 04:06:35 by Homer</div>
   </div>
   <div class="post" id="post-120964">
    <div class="subject"><a href="#post-120964">Homer's GameDev Tute Project</a></div>
    <div class="body">it seems that the includes i once downloaded from scrontsofts site are not complete.. trying to build your project i'm always missing files! :mad: <br /><br />some of them i could find in my dx7 include files, but some of them i can't find anywhere. the last i had to stop on was:<br /><br />d3dx8math_fkt.def<br /><br />i also had to change a line in your projectdata.inc file from<br />include     c:\masm32\include\dx81include\d3dx8math.inc<br />to<br />include     c:\masm32\include\d3dx8math.inc <br /><br />why using an extra folder for just one file!? <br /><br />is it possible that you can upload your complete include and lib files, and everything is needed, so that i can download them? the most important thing for me now is, that i can get started.. <br />i also offer to upload the includes and libs to my webspace at university, so that it is accessible to everybody for a long time, so you don't need to bother yours. <br /><br />thanks for help! <br /><br />bye</div>
    <div class="meta">Posted on 2003-10-10 04:28:56 by NOP-erator</div>
   </div>
   <div class="post" id="post-120966">
    <div class="subject"><a href="#post-120966">Homer's GameDev Tute Project</a></div>
    <div class="body">I just ripped the guts out of one of my existing D3D projects - as for the path issue, I keep two folders with separate includes for DX8.0 and DX8.1, thats all.<br /><br />The file you found missing is from Caleb's DX8 includes.<br />We aren't actually using this math include yet, so you COULD comment it out.<br />It contains a bunch of nice floating point math macros coded by Caleb.<br />We'll for SURE use it later because most of these macros are MUCH faster than their DX equivalents, even though they are coded &quot;naively&quot;.<br />That means that if we reworked them with cpu-detecting casecode, they could be possibly even FASTER STILL.<br /><br />Here it is :)</div>
    <div class="meta">Posted on 2003-10-10 04:39:27 by Homer</div>
   </div>
   <div class="post" id="post-120970">
    <div class="subject"><a href="#post-120970">Homer's GameDev Tute Project</a></div>
    <div class="body">Please expect some minor teething problems with include files.<br />Be aware that the DX8.0 and DX8.1 includes ARE NOT THE SAME !!!<br />Neither are the associated LIB files.<br /><br />We are using the DX8.1a or DX8.1b libs, and we are using the DX8.1 includes from Scronty.<br /><br />Should anyone have problems with their INC files, please verify that you have the correct dx version inc and lib files.<br /><br />If you get it to compile ONCE, you know you are on the way.<br /><br />A final note to disregard the &quot;file not found&quot; error during compile.<br />This is a result of the linker not finding an RC file, you will find that an exe file in fact WAS created, if you look :)</div>
    <div class="meta">Posted on 2003-10-10 04:50:49 by Homer</div>
   </div>
   <div class="post" id="post-120971">
    <div class="subject"><a href="#post-120971">Homer's GameDev Tute Project</a></div>
    <div class="body">ok.. downloaded calebs includes.. (actually only defs in the include folder)<br />now the following problem while building:<br /><br /><pre><code><br />Microsoft &#40;R&#41; Macro Assembler Version 6.14.8444<br />Copyright &#40;C&#41; Microsoft Corp 1981-1997.  All rights reserved.<br /><br /> Assembling&#58; c&#58;\masm32\nop\dxproject1\dxproject\project.asm<br />c&#58;\masm32\include\d3dx8math_fkt.def&#40;5611&#41; &#58; error A2005&#58; symbol redefinition &#58; D<br />3DXVec2Length<br />c&#58;\masm32\include\d3dx8math_fkt.def&#40;5613&#41; &#58; error A2006&#58; undefined symbol &#58; pV<br />c&#58;\masm32\include\d3dx8math_fkt.def&#40;5618&#41; &#58; fatal error A1008&#58; unmatched macro n<br />esting<br />_<br />Assembly Error<br />Dr?cken Sie eine beliebige Taste . . .<br /></code></pre><br /><br />thank you for your effort</div>
    <div class="meta">Posted on 2003-10-10 04:51:17 by NOP-erator</div>
   </div>
   <div class="post" id="post-120972">
    <div class="subject"><a href="#post-120972">Homer's GameDev Tute Project</a></div>
    <div class="body"><div class="quote">c:\masm32\include\d3dx8math_fkt.def(5611) : error A2005: symbol redefinition : D</div> <br /><br />look in the .FKT file for the PROTO associated with the redefined function.<br />Comment it out - it's defined in Scronty's include.</div>
    <div class="meta">Posted on 2003-10-10 04:55:08 by Homer</div>
   </div>
   <div class="post" id="post-120973">
    <div class="subject"><a href="#post-120973">Homer's GameDev Tute Project</a></div>
    <div class="body">When you are debugging compile errors like this, ALWAYS FIX THE VERY FIRST PROBLEM before trying to fix the rest.<br />Very often, subsequent errors are generated by the preceeding one.<br /><br /><br /><br />If you want to disable Scronty's PROTO and use the macro version instead,<br /><br />D3DXVec2Length		macro	pV : REQ<br /><br />                        IFDIFI	pV, &lt;FPUStack&gt;<br />                        __LoadFloat2		pV1<br />                        ENDIF<br />                        __LengthFloat2<br />endm<br /><br /><br />The problem to fix in the FKT file if you look, pV1 is the WRONG NAME<br />The macro uses the name pV<br />Change one of them so the name matches, and the macro will be ok.<br /><br />As I said earlier, we'll find a few minor errors to repair in the includes as we go.<br />There will be more to come , but we should get a compile at this point.</div>
    <div class="meta">Posted on 2003-10-10 04:56:15 by Homer</div>
   </div>
   <div class="post" id="post-120981">
    <div class="subject"><a href="#post-120981">Homer's GameDev Tute Project</a></div>
    <div class="body">ok, there were some more symbol redefinitions.. some of them i  could comment out in the inc file, but some others i had to comment out the whole macro in the d3dx8math_fkt.def file...<br />the pV error disappeared automatically, as you said when giving the hint to remove the first error first. <br />it assembles now, but linking is a problem.. missing a file again ^^' <br /><br /><pre><code><br />LINK &#58; fatal error LNK1104&#58; cannot open file &quot;c&#58;\masm32\lib\d3dxof.lib&quot;<br />_<br />Link error<br /></code></pre><br /><br />my offer uploading the complete includes and libs to one location is still up to date :)<br /><br />thanks for you PM, but i get notified about answers in the thread.<br /><br />so long, <br />  NOP</div>
    <div class="meta">Posted on 2003-10-10 05:54:21 by NOP-erator</div>
   </div>
   <div class="post" id="post-120990">
    <div class="subject"><a href="#post-120990">Homer's GameDev Tute Project</a></div>
    <div class="body">Your Missing File...<br /><br /><br />(I'd rather not post all the incs and libs, its an educational experience to fix these problems at least ONCE yourself, I am here to help..)\<br /><br />D3DXOF is another file that could be commented out (for now), since to date we call NO functions that it contains (it provides support for XFile helper functions).</div>
    <div class="meta">Posted on 2003-10-10 07:28:24 by Homer</div>
   </div>
   <div class="post" id="post-120991">
    <div class="subject"><a href="#post-120991">Homer's GameDev Tute Project</a></div>
    <div class="body">The macros in the FKT file are ALTERNATIVES to the associated DX functions of the same name. We can't call a macro and a procedure the same name, so we have to disable either a PROTO to a procedure, or comment out the macro of the same name. I have stated that the FKT macros are in fact preferable to the DX functions, but they will BOTH work, and furthermore, you can happily mix and match them provided the names are not duplicated. If you WANT to, you can rename the macros and have the full complement of both codebases at your disposal.<br />Does this make sense?</div>
    <div class="meta">Posted on 2003-10-10 07:40:57 by Homer</div>
   </div>
   <div class="post" id="post-120992">
    <div class="subject"><a href="#post-120992">Homer's GameDev Tute Project</a></div>
    <div class="body">Moving right along, we can afford to add a rather sketchy Render function, so we can ummm ... SEE SOMETHING !!<br /><br />The following source should be saved as &quot;Render.inc&quot;<br />It should be included in the Project.asm file Includez section (where the others are).<br />Project.asm contains a call to this procedure which needs to be uncommented.<br />Now we can compile again, and we should see a BLACK SCREEN instead of a simple GREY one. Big woops !! Are you excited yet? :tongue:<br /><br />.data<br />fp1 FLOAT 1.0f<br />.code<br /><br />Render PROC hWin:HWND, MyFillColor:DWORD<br />mcall ,IDirect3DDevice8_Clear,0, NULL, (D3DCLEAR_TARGET OR D3DCLEAR_ZBUFFER), MyFillColor, fp1, 0<br />mcall ,IDirect3DDevice8_BeginScene<br />;==================================<br />;We aren't drawing anything yet<br />;But if we were, it would happen here :)<br />;==================================<br />mcall ,IDirect3DDevice8_EndScene<br />     mcall ,IDirect3DDevice8_Present, 0, 0, 0, 0  ;Present backbuffer to the screen<br />     return S_OK<br />Render ENDP</div>
    <div class="meta">Posted on 2003-10-10 07:53:25 by Homer</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=15548&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=15548&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="15548" /><input type="number" name="page" min="1" max="3" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=15548&amp;page=2">&gt;</a><a href="../?id=15548&amp;page=3">&raquo;</a></form>  </div>
 </body>
</html>