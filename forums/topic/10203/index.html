<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>A little demo, how to create uniform menus and toolbars. - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10203" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=10203">A little demo, how to create uniform menus and toolbars.</a></p>
   <div class="post" id="post-76529">
    <div class="subject"><a href="#post-76529">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">Hi all.<br /><br />These days I began to rewrite from scratch my program SpaceGlyph on FASM. (You can see how it looks on my web site) So, SpaceGlyph was writen on Delphi and the user interface is very rich - icons, pictures etc.<br />When I try to make this on assembler, I found that there is many problems and I decide to write some system for uniform handling of menus and toolbars. Something like &quot;Actions&quot; in Delphi. <br /><br />The atachment is the first version of this system. It's too raw and not optimised, but I think it works pretty good on my computer (Cyrix MII 333MHz, Win95 OSR2). Please test it and post some opinions.<br /><br />Thanks.</div>
    <div class="meta">Posted on 2003-01-15 18:17:16 by JohnFound</div>
   </div>
   <div class="post" id="post-76539">
    <div class="subject"><a href="#post-76539">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">Use <strong>CreatePopupMenu</strong> for submenus, otherwise you leak resources.</div>
    <div class="meta">Posted on 2003-01-15 19:47:10 by comrade</div>
   </div>
   <div class="post" id="post-76580">
    <div class="subject"><a href="#post-76580">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">Hi comrade.<br /><br />Hm, I read the help for the <strong>CreatePopupMenu</strong> and <strong>CreateMenu</strong>, but there is no any information about resource leaks. In other hand, my idea was to use one subroutine <strong>CreateCoolMenu</strong> to create main menus and popup menus. If I must use <strong>CreatePopupMenu</strong> for popupmenus, I must put some flag - menu type or similar and checks.<br /><br />How you determine these leaks? Maybe there is some utility program?<br /><br />To all:<br />  I have another problem with this demo too: If you start the demo, you can see some empty space between the flat buttons and the bottom border of the toolbar. Did someone knows, how I can remove this space?</div>
    <div class="meta">Posted on 2003-01-16 03:43:02 by JohnFound</div>
   </div>
   <div class="post" id="post-76609">
    <div class="subject"><a href="#post-76609">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">The comrade is absolutely right. I checked the MyActions demo and found some resource leaks because of using CreateMenu for submenus. Here is the fixed version.<br /><br />Thanks comrade  :alright: <br /><br />But I still can't fix the problem with the Toolbar empty space under the buttons. If someone helps me with this, I will be very thankful.</div>
    <div class="meta">Posted on 2003-01-16 05:56:03 by JohnFound</div>
   </div>
   <div class="post" id="post-76611">
    <div class="subject"><a href="#post-76611">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">I forget the file: <br />:)</div>
    <div class="meta">Posted on 2003-01-16 05:58:37 by JohnFound</div>
   </div>
   <div class="post" id="post-76742">
    <div class="subject"><a href="#post-76742">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">What space?</div>
    <div class="meta">Posted on 2003-01-16 17:50:28 by comrade</div>
   </div>
   <div class="post" id="post-76824">
    <div class="subject"><a href="#post-76824">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">Look at the snapshot:<br /><br />This gap becomes only when the toolbar is flat.</div>
    <div class="meta">Posted on 2003-01-17 04:02:53 by JohnFound</div>
   </div>
   <div class="post" id="post-87414">
    <div class="subject"><a href="#post-87414">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">Hi !<br />I have the same gap problem with my toolbar, do you have found a solution ?<br /><br />Thanks !</div>
    <div class="meta">Posted on 2003-03-16 13:09:32 by JCP</div>
   </div>
   <div class="post" id="post-87557">
    <div class="subject"><a href="#post-87557">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">Hi Readiosys.<br />Unfortunately I didn't found solution for this problem. But the problem is serious (and maybe it must be discused in MAIN thread of the forum, because this is common problem of the flat toolbars.) The gap between the buttons and bottom edge of the toolbat stays very large when the toolbar is wraped on several rows, like this:</div>
    <div class="meta">Posted on 2003-03-17 07:05:01 by JohnFound</div>
   </div>
   <div class="post" id="post-87580">
    <div class="subject"><a href="#post-87580">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">You have to use the CCS_NORESIZE style for your toolbar and size the toolbar yourself, use TB_GETITEMRECT on the last button (this gets you the height the toolbar should be) and then use MoveWindow (or SetWindowPos) to size the toolbar.</div>
    <div class="meta">Posted on 2003-03-17 09:10:48 by Joshua</div>
   </div>
   <div class="post" id="post-87584">
    <div class="subject"><a href="#post-87584">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">What is a resource leak?</div>
    <div class="meta">Posted on 2003-03-17 09:42:52 by Odyssey</div>
   </div>
   <div class="post" id="post-87587">
    <div class="subject"><a href="#post-87587">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">I just had a look at the program. Very impressive  I always wanted to know how add bitmaps to menu items like it is done in delphi. I will now attempt to decipher the code.</div>
    <div class="meta">Posted on 2003-03-17 09:51:44 by Odyssey</div>
   </div>
   <div class="post" id="post-87595">
    <div class="subject"><a href="#post-87595">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body"><div class="quote"><br />You have to use the CCS_NORESIZE style for your toolbar and size the toolbar yourself, use TB_GETITEMRECT on the last button (this gets you the height the toolbar should be) and then use MoveWindow (or SetWindowPos) to size the toolbar. </div><br /><br />Sounds nice: I will try when I get home.<br />Thanks !</div>
    <div class="meta">Posted on 2003-03-17 10:27:50 by JCP</div>
   </div>
   <div class="post" id="post-87598">
    <div class="subject"><a href="#post-87598">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">Odyssey, a leak is when you allocate something and forget to deallocate it. This is always a bad thing, though not always severe - windows will take care of closing file handles, deallocating heap (etc) when your program shuts down, so small leaks will not matter too much (but SHOULD be tracked down and fixed). Resource leaks tend to be pretty severe, since especially crappy old 9x series of windows are very limited. Yep, on 9x resource leaks can end up in BSODs rather easily.</div>
    <div class="meta">Posted on 2003-03-17 10:34:21 by f0dder</div>
   </div>
   <div class="post" id="post-87615">
    <div class="subject"><a href="#post-87615">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">Thank you Joshua!<br />Now the &quot;big ugly gap&quot; problem :grin: is fixed.<br />Here is the last version, and it seems to work good. Some minor changes and code cleaning are made too.</div>
    <div class="meta">Posted on 2003-03-17 12:32:09 by JohnFound</div>
   </div>
   <div class="post" id="post-87618">
    <div class="subject"><a href="#post-87618">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">It worked for me too: thank you very much, Joshua !</div>
    <div class="meta">Posted on 2003-03-17 13:01:30 by JCP</div>
   </div>
   <div class="post" id="post-114031">
    <div class="subject"><a href="#post-114031">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">Glad I could be of service<br /><br />I do have one remark about the ownerdrawn menu's though: Set the MenuText to size 24 (in display properties), and run the app. See what happens... It's never recommended to hardcode these values.<br />Also I woudn't include a Disabled toolbar bitmap, the windows default way of telling the user something is disabled is by embossing the text or image. This is an effect that can easily be created on the fly for such small bitmaps. Although you would lose the nice shading effect.<br /><br />Anyways for an example of what i mean: look at this.</div>
    <div class="meta">Posted on 2003-08-16 00:21:58 by Joshua</div>
   </div>
   <div class="post" id="post-114567">
    <div class="subject"><a href="#post-114567">A little demo, how to create uniform menus and toolbars.</a></div>
    <div class="body">Hi JohnFound<br /><br />For flat Toolbars,have a look in forum Custom Controls-&gt;ManosGrid.<br /><br />Regards,Manos.</div>
    <div class="meta">Posted on 2003-08-20 07:51:16 by Anonymous</div>
   </div>
  </div>
 </body>
</html>