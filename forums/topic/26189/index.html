<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Local IP - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26189" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26189">Local IP</a></p>
   <div class="post" id="post-190569">
    <div class="subject"><a href="#post-190569">Local IP</a></div>
    <div class="body">Hello,

Recently I tried to find a function that helps me to resolve me local IP address. So far i have looked through 
WinSock f-ns, no success yet. Someone plz point me on to some small example.
Thanks!</div>
    <div class="meta">Posted on 2000-11-21 01:24:00 by AndyCar</div>
   </div>
   <div class="post" id="post-190570">
    <div class="subject"><a href="#post-190570">Local IP</a></div>
    <div class="body">Hi,
Currently I am working on a small Netspy Utility.
I will published it in december.
Here is a code snippet :

;---------------------------------------------------------------
; API "gethostname" returns the standard host name local machine
;---------------------------------------------------------------
push    60h                   ;namelen, the length of the buffer
push    OFFSET Buffer         ;name, pointer  receives hostname
call    gethostname           ;- API Function -
cmp     eax,0h                ;error ?
jne     My_Error              ;- ErrorRoutine -
;---------------------------------------------------------------
; API "gethostbyname" gets host information for a host name.
;---------------------------------------------------------------
push    OFFSET Buffer         ;name, pointer to name of the host
call    gethostbyname         ;- API Function -
cmp     eax,0h                ;error ?
je      My_Error              ;- ErrorRoutine -
mov     ebx,          ;get h_addr_list from hostent struc
mov     eax,             ;get far pointer
mov     ebx,             ;get far pointer
;---------------------------------------------------------------
; API "inet_ntoa" converts net address to string in dotted format
;---------------------------------------------------------------
push    ebx                   ;in, struc Internet host address
call    inet_ntoa             ;- API Function -
cmp     eax,0h                ;error ?</div>
    <div class="meta">Posted on 2000-11-21 04:38:00 by Test Department </div>
   </div>
  </div>
 </body>
</html>