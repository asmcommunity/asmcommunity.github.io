<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Any way around the &quot;line too long&quot; limitation in M - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9744" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9744">Any way around the &quot;line too long&quot; limitation in M</a></p>
   <div class="post" id="post-72394">
    <div class="subject"><a href="#post-72394">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">Ok, I'm starting to get <strong>very</strong> annoyed by the &quot;line too long&quot; error in the MASM compiler by now. :mad:<br />It keeps popping up all the time, forcing me to make my code much more ugly and complex than necessary. :(<br /><br />Is there any way to increase this limit of how long lines can be? Please, <strong>please</strong>, I beg you, someone? :)<br /><br />I have quite many macros in the code I'm working with right now, and to some of them I pass multiple strings as parameters in their calls, e.g. like this:<br /><br /><pre><code><br />STRING_PROCESSING_MACRO &quot;This is a parameter string&quot;, \<br />                        &quot;This is also a parameter string&quot;, \<br />                        &quot;Soon there can't be any more parameter strings&quot;, \<br />                        &quot;The stupid error will probably pop up somewhere around here&quot;<br /></code></pre> <br />And when I try to compile it, I get the following error from the compiler:<br /><br /><em>&quot;error A2039: line too long&quot;</em><br /><br /><br />I solve this by putting each of the strings in temporary text macro objects, like this:<br /><br /><br /><pre><code><br />P1 textequ &lt;&quot;This is a parameter string&quot;&gt;<br />P2 textequ &lt;&quot;This is also a parameter string&quot;&gt;<br />P3 textequ &lt;&quot;Soon there can't be any more parameter strings&quot;&gt;<br />P4 textequ &lt;&quot;The stupid error will probably pop up somewhere around here&quot;&gt;<br />STRING_PROCESSING_MACRO P1, P2, P3, P4<br /></code></pre> <br />But this is not good at all, and very ugly. :(<br /><br /><br />So, is there any way to increase this line length limit in MASM? I'll even patch ml.exe if I have to, just please help me! :)<br /><br />If the answer to that question is &quot;no&quot;, is there at least a nicer way to accomplish the macro call in the example above than my ugly solution?<br /><br /><br />Any and all suggestions would be greatly appreciated.<br /><br />Thanks!</div>
    <div class="meta">Posted on 2002-12-23 19:34:26 by dELTA</div>
   </div>
   <div class="post" id="post-72427">
    <div class="subject"><a href="#post-72427">Re: Any way around the &quot;line too long&quot; limitation</a></div>
    <div class="body"><div class="quote"><br />... So, is there any way to increase this line length limit in MASM? I'll even patch ml.exe if I have to, just please help me! :)</div><br /><br />You will quickly receive little to no help around here if you ask us to help patch <strong><em>anything</strong></em>.  Careful for what you write.<br /><br />No, there is not *legal* means to make a string longer than 512 characters.<br />If you want more, i sugest C++ or simular HLL compilers.<br /><br />:NaN:</div>
    <div class="meta">Posted on 2002-12-23 22:39:05 by NaN</div>
   </div>
   <div class="post" id="post-72473">
    <div class="subject"><a href="#post-72473">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">Ok, sorry about that, I really didn't mean it like a crack or anything, just like a functionality improvement for personal usage, and it was only a last way out, and mostly a way to express how eager I was to get past this problem. :(<br /><br />Anyway, is there any &quot;common way&quot; to get past this problem with calling macros with too long parameters? There must be quite a few people having the same problem every now and then, right? I would really guess that some of them have come up with a better solution than the one I'm using? :)<br /><br />Thanks!</div>
    <div class="meta">Posted on 2002-12-24 05:34:17 by dELTA</div>
   </div>
   <div class="post" id="post-72478">
    <div class="subject"><a href="#post-72478">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">STRING_PROCESSING_MACRO db &quot;This is a parameter string&quot;,<br />                       db  &quot;This is also a parameter string&quot;,<br />                        db &quot;Soon there can't be any more parameter strings&quot;<br />                        db &quot;The stupid error will probably pop up somewhere around here&quot;<br /><br />like this.</div>
    <div class="meta">Posted on 2002-12-24 05:51:50 by Hiroshimator</div>
   </div>
   <div class="post" id="post-72482">
    <div class="subject"><a href="#post-72482">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">Hmm, could you please explain that a bit further?<br /><br />I just tried it, and it gave a lot of errors (&quot;missing parameter&quot; error for the macro for example). It also seems strange just intuitively to call a macro by placing a bunch of &quot;db &lt;string&gt;&quot; items after it? How would the macro know that those strings belong to it (especially when using vararg parameters)? Won't those strings just be placed directly in the code segment when doing like that?<br /><br />Thanks a lot anyway, I hope you can clearify this further, so that I can understand, and get around this problem.</div>
    <div class="meta">Posted on 2002-12-24 06:38:42 by dELTA</div>
   </div>
   <div class="post" id="post-72494">
    <div class="subject"><a href="#post-72494">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">What Hiro is refering to is NOT placing the null after the first line, when you declair a string in the .data segment:<br /><br /><pre><code>.data<br /><br /> szText  db &quot;String of text&quot;,0<br /><br />For multiple lines, drop the null, and contrinue&#58;<br /><br /> szText2 db &quot;Sting of text on the first line &quot;<br />         db &quot;That will automatically be concatenated to the one &quot;<br />         db &quot;before, because in memory this is just one LONG array of &quot;<br />         db &quot;bytes as declaired by the db at the begining of each line.  &quot;<br />         db &quot;All these bytes are addressed initially by szText2 and since &quot;<br />         db &quot;there is no NULL, string routines will keep parsing memory until &quot;<br />         db &quot;it findes this null&quot;, &#91;b&#93;0&#91;/b&#93;</code></pre></div>
    <div class="meta">Posted on 2002-12-24 08:13:20 by NaN</div>
   </div>
   <div class="post" id="post-72505">
    <div class="subject"><a href="#post-72505">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">Yup...  i think Hiro had an extra comma at the end of the first two lines which are causing you the grievances!<br /><div class="quote"><br />STRING_PROCESSING_MACRO db &quot;This is a parameter string&quot;,<br />                       db  &quot;This is also a parameter string&quot;,<br />                        db &quot;Soon there can't be any more parameter strings&quot;<br />                        db &quot;The stupid error will probably pop up somewhere around here&quot;<br /><br />like this. </div></div>
    <div class="meta">Posted on 2002-12-24 09:26:46 by jademtech</div>
   </div>
   <div class="post" id="post-72507">
    <div class="subject"><a href="#post-72507">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">And no NULL... so if used, it wouldnt stop when the string ended.<br /><br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-12-24 09:33:38 by NaN</div>
   </div>
   <div class="post" id="post-72508">
    <div class="subject"><a href="#post-72508">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">This works because the thing before the first db acts as a label and all the subsequent lines just define data.  That was a bit unclear, so i'll try to elucidate further :grin: <br /><br /><pre><code><br />szHW db &quot;Hello &quot;<br />  db &quot;world&quot;,0<br /><br />invoke Bleh, addr szHW<br /></code></pre><br /><br />A label is created for szHW and bytes are written starting from the label - &quot;Hello world&quot;,0.  So addr gets the location of the beginning of the string, szHW...<br /><br />i sometimes use this to lop off some bytes from strings (not sure if this is bad practice or not):<br /><br /><pre><code><br />szFileName db &quot;An untitled file&quot;<br />szLoadedMsg db &quot; is currently loaded.&quot;,0<br /></code></pre><br /><br />i used something similar to set the window title of a notepad-like program.  When no file was loaded, it loaded a string starting at FileName.  Otherwise, it loaded the file name from another memory location and appended szLoadedMsg to it.<br /><br />btw, not exactly sure how splitting up a string like the first example will affect sizeof...  not going to look it up or test.</div>
    <div class="meta">Posted on 2002-12-24 09:36:40 by jademtech</div>
   </div>
   <div class="post" id="post-72509">
    <div class="subject"><a href="#post-72509">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body"><div class="quote"><br />And no NULL... so if used, it wouldnt stop when the string ended.<br /><br />:alright:<br />NaN </div><br /><br />lol...  true dat :grin:  it could, however, be passed the string length, like for some old DOS interrupts :rolleyes:</div>
    <div class="meta">Posted on 2002-12-24 09:37:18 by jademtech</div>
   </div>
   <div class="post" id="post-72526">
    <div class="subject"><a href="#post-72526">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">Thanks for all the input guys, but sadly I don't think that this really adresses my real problem. :(<br /><br />I want to pass the strings as text macro strings (i.e. they should not be put in the actual exe-file first, and then referenced). For example, I might want to encrypt them directly in the exe-file with a macro, and then decrypt them during runtime. Then they need to be passed as pure text macro strings (enclosed in &lt;&gt;) and not like that. :(<br /><br />But I guess I'll just have to give up and resort to my original solution then. I just don't understand how they could implement such a crappy limitation in the MASM compiler, which is otherwise so powerful. :(<br /><br />Thanks anyway everyone!</div>
    <div class="meta">Posted on 2002-12-24 10:58:11 by dELTA</div>
   </div>
   <div class="post" id="post-72591">
    <div class="subject"><a href="#post-72591">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">I don't really see the problem, it just depends on what you want to do. The standard format,<br /><br />name db &quot;text&quot;<br />     db &quot;more text&quot;<br />     db &quot;even more text again&quot;,0<br /><br />works fine.<br /><br />If you want to put it in a macro,<br /><br />MyText MACRO<br />name db &quot;text&quot;<br />     db &quot;more text&quot;<br />     db &quot;even more text again&quot;,0<br />ENDM<br /><br />In initialised .DATA<br /><br />.DATA<br />  MyText<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-12-24 20:29:04 by hutch--</div>
   </div>
   <div class="post" id="post-72617">
    <div class="subject"><a href="#post-72617">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">I usually write as this to make it clear:<br />VersionInfo  Label Byte <br />                    db  &quot;Small Utility for File Search&quot;, 0AH,0DH<br />                    db  0DH, 0AH<br />                    db &quot;Author: Smallwaves.&quot;,0DH,0AH<br />                    db &quot; Other Info&quot;, 0DH,0AH<br />                    db 0;end flag.<br />or if it's a array of structure, just like this:<br />NodesArrary Label Node<br />                    Node &lt;,,&gt; <br />                    Node &lt;,,&gt;<br /><br /> :rolleyes:</div>
    <div class="meta">Posted on 2002-12-25 03:12:56 by smallwaves</div>
   </div>
   <div class="post" id="post-72639">
    <div class="subject"><a href="#post-72639">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">Ok, either I'm very stupid, or there's a lot of misunderstanding of my question going on here. :)<br /><br />Once again:<br /><br />What I want to do:<br /><br />* <strong>Call</strong> a macro with several <em>text macro type</em> string <strong>parameters</strong> (i.e. the type of strings that are inside &lt;&gt; delimiters, meta-data) without having to limit these parameters to short strings due to the line-length limitation problem in MASM.<br /><br /><br />What I do <strong>not</strong> want to do:<br /><br />* Use (references to) strings that are located in the actual exe-image of the program (the macro might for example encrypt the strings before storing them in the actual program data).<br /><br />* Define a macro, I know how to do that. :)<br /><br /><br />Please read my original post in this thread for more info. :tongue: <br /><br /><br />Thanks everyone. :alright:</div>
    <div class="meta">Posted on 2002-12-25 06:34:18 by dELTA</div>
   </div>
   <div class="post" id="post-72648">
    <div class="subject"><a href="#post-72648">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">dELTA,<br />     Obviously the line buffer in MASM is a generous finite length.  If it were a ridiculous 16K, or had a virtual buffer manager, then someone would try to write a book using a macro.  Without access to the MASM source, or the ability to evaluate and patch an extremely complex program, there isn't too much anyone can do about it.  A line has a predetermined length, and that's it. <br /><br /> The below example below is what I used to initialize a large structure.  It is similar to your method.  I could not fit all the initialization between the brackets without running out of space. It might be ugly, but at least it's clear.  By the way, it appears that mulitple consecutive space characters and comments use up room in the line buffer too.  Ratch<br /><br /><pre><code><br />S1 TEXTEQU \<br />  &lt;PIXELFORMATDESCRIPTOR,\  ;size of this pixel format descriptor<br />   1,\                      ;version number<br />   PFD_DRAW_TO_WINDOW OR \  ;format must support window<br />   PFD_SUPPORT_OPENGL OR \  ;format must support OpenGL<br />   PFD_DOUBLEBUFFER,\       ;must support double buffering<br />   PFD_TYPE_RGBA&gt;           ;request an RGBA format<br />S2 TEXTEQU \<br />  &lt;8,\                      ;select our color depth<br />   0,0,0,0,0,0,\            ;color bits ignored<br />   0,\                      ;no alpha buffer<br />   0,\                      ;shift bit ignored<br />   0&gt;                       ;no accumulation buffer<br />S3 TEXTEQU \<br />  &lt;0,0,0,0,\                ;accumulation bits ignored<br />   16,\                     ;16Bit Z-buffer &#40;depth buffer&#41;  <br />   0,\                      ;no stencil buffer<br />   0,\                      ;no auxiliary buffer<br />   PFD_MAIN_PLANE,\         ;main drawing layer<br />   0,\                      ;reserved<br />   0,0,0&gt;                   ;layer masks ignored<br /><br />pfd PIXELFORMATDESCRIPTOR &#123;S1,S2,S3&#125; ;pfd tells windows how we want things to be</code></pre></div>
    <div class="meta">Posted on 2002-12-25 09:27:11 by Ratch</div>
   </div>
   <div class="post" id="post-72658">
    <div class="subject"><a href="#post-72658">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">I wouldn't really call it &quot;generous&quot; when it doesn't even allow relatively commonly used constructs, and happen to me every now and then, but anyway.<br /><br />And I can't really see the disadvantage of having a 16k or dynamic size buffer either. So what if someone wrote a book with a macro? They would have ugly code, and the rest of us would never have to be bothered with useless errors in our beautiful code, that's all. ;) It's simply clean and beautiful not to have unfounded static limitations in a product, so Microsoft disappoints me somewhat here. :(<br /><br />And yes, I noticed too that all whitespaces are included in the count, which makes it even more ugly, and dependant on the current indentation level too. :(<br /><br />Finally, thanks for your example!</div>
    <div class="meta">Posted on 2002-12-25 11:46:41 by dELTA</div>
   </div>
   <div class="post" id="post-72683">
    <div class="subject"><a href="#post-72683">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">dELTA,<br /><br />Its always been the case of finding out what a tool will do and working within its capacity, do it the other way around and you will end up with problems of the type you have.<br /><br />====================================<br />* Use (references to) strings that are located in the actual exe-image of the program (the macro might for example encrypt the strings before storing them in the actual program data).<br />====================================<br /><br />Now some of what you want to do is no big deal to do, what you write in a macro is NOT contained in the exe image until you use the macro.<br /><br />Make a macro header file with many different macros in it which are sized to give you the granularity you require.<br /><br />Nest them if you need some of the groupings larger.<br /><br />Call only the macros you require and you file only contains what you want.<br /><br />The requirement to encrypt the data before it goes into the .DATA section is something that an assembler cannot do as placing data in the .DATA section (or the code section if you wanted to) occurs BEFORE the file in assembled. To do this you would need some form of preprocessor to do what you are after.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-12-25 17:08:33 by hutch--</div>
   </div>
   <div class="post" id="post-72701">
    <div class="subject"><a href="#post-72701">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">Hutch,<br /><br />I know very well that things that are written inside macros are not put in the exe-file until the macro is called, but it would be pretty useless to write a new macro for every single text I want to put into the file. The task of <em>dynamic</em> code/data-generation, by use of parameters, is exactly what macro's are mainly for, and hence I find it quite unfortunate that the process of passing parameters to them has functionality-restricting limits on them like this in MASM. That's all.<br /><br />And no, text-macro type strings (the ones delimited by &lt;&gt;) are <strong>not</strong> put into the exe-file before it is assembled. And it is <strong>indeed</strong> possible to encrypt data before it is put into the exe-file by using macros. And &quot;<em>To do this you would need some form of preprocessor</em>&quot;? :confused: If you don't classify macros and conditional assembly operators as a preprocessor activity, I don't know what could be called so?<br /><br />Here's a simple example for you (please excuse any syntax errors, it's only a conceptual example, written in 30 seconds off the top of my head):<br /><br /><pre><code><br />ENCRYPT_STRING MACRO plaintext_string&#58;REQ, \<br />                     data_label_name&#58;REQ<br /><br />encrypted_result TEXTEQU &lt;&gt;<br />    FORC current_plain_char, &lt;plaintext_string&gt;<br />        current_crypted_char TEXTEQU %&#40;current_plain_char XOR 0FFh&#41;<br />        encrypted_result catstr encrypted_result, current_crypted_char<br />    ENDM<br />.data<br />data_label_name&#58;    db      &quot;&amp;encrypted_result&quot;, 0<br />.code<br />ENDM<br /></code></pre><br />This macro would be used like this in the code:<br /><pre><code><br />    ENCRYPT_STRING &lt;This string will be encrypted in the exe&gt;, crypted_str<br /></code></pre><br />and an equivalent decryption operation would have to be used during runtime before using the string in the program.<br /><br /><br />So, as much as I appreciate your info and advice, I must ask you to please not accuse me of things like not knowing what my tools can do, at least not without having reasonable grounds for it. Believe me, I mostly do (in this case at least, and I do my best to do so in other cases too). Also, it might not be a good idea for you to post here that MASM can't do things that it indeed can do. Being a person of your respect around here and everything, many people might believe you, and then become unnecessarily dishearted.<br /><br />Thanks!</div>
    <div class="meta">Posted on 2002-12-25 18:11:41 by dELTA</div>
   </div>
   <div class="post" id="post-72710">
    <div class="subject"><a href="#post-72710">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">Unless there is a command line option to increase line length, you're stuck with the line length limit of MASM.<br /><br />You will need to devise a way to do the equivalent work in incremental macro calls, rather than as a one-step macro.</div>
    <div class="meta">Posted on 2002-12-25 18:35:52 by tenkey</div>
   </div>
   <div class="post" id="post-72758">
    <div class="subject"><a href="#post-72758">Any way around the &quot;line too long&quot; limitation in M</a></div>
    <div class="body">dELTA,<br /><br />----------------------<br />So, as much as I appreciate your info and advice, I must ask you to please not accuse me of things like not knowing what my tools can do, at least not without having reasonable grounds for it. Believe me, I mostly do (in this case at least, and I do my best to do so in other cases too). Also, it might not be a good idea for you to post here that MASM can't do things that it indeed can do. Being a person of your respect around here and everything, many people might believe you, and then become unnecessarily dishearted.<br />----------------------<br /><br />Nah, you are barking up the wrong tree here, what I see you doing is leading with what you WANT to do but running into a limit that prevents it.<br /><br />----------------------<br />The task of dynamic code/data-generation, by use of parameters, is exactly what macro's are mainly for, and hence I find it quite unfortunate that the process of passing parameters to them has functionality-restricting limits on them like this in MASM.<br />----------------------<br /><br />This is where I see your problem, MASM macros are crude at best but can do a reasonable amount of simple preprocessing if you can be bothered with it. What it is doing as a preprocessor is exactly the opposite of what you have described, &quot;code/data-generation&quot;. It is STATIC insertion of code into source BEFORE it is assembled. Dynamic code is what you do with instructions AFTER it is up and going as an assembled binary file.<br /><br />What I did suggest to you is do your own preprocessing BEFORE you pass it to MASM, if you like, PRE-preprocessing of the data you want encrypted and just place it in the data section where you want. This can of cource generate other problems like the encrypted data will not work in the DB format you want to use but you can automatically generate DB data in table form as ascii characters, insert that into either the code or data sections and call it from the start address.<br /><br />This stuff is technically trivial to do as long as you understand the limits of the assembler you are using.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-12-26 04:16:53 by hutch--</div>
   </div>
  </div>
 </body>
</html>