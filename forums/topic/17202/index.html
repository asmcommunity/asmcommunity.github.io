<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Can add-in change text color ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=17202" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=41">WinAsm Studio</a> &raquo; <a href="../?id=17202">Can add-in change text color ?</a></p>
   <div class="post" id="post-133312">
    <div class="subject"><a href="#post-133312">Can add-in change text color ?</a></div>
    <div class="body">Is there any way to write a add-in that can change text color in the editor of Winasm. I ask so because I can't do that via this one.<br /><pre><code><br />SetColor PROC pCharRange&#58;DWORD<br />	LOCAL charformat&#58;CHARFORMAT<br />	;// select the text before set color<br />	invoke SendMessage, hEditor, EM_EXSETSEL, 0, pCharRange<br />	mov charformat.cbSize, sizeof charformat<br />	mov charformat.dwMask, CFM_COLOR + CFM_BOLD<br />	M2M charformat.crTextColor, RED_COLOR<br />	mov charformat.dwEffects, CFE_AUTOCOLOR + CFE_BOLD<br />	invoke SendMessage, hEditor, EM_SETCHARFORMAT, SCF_SELECTION, addr charformat<br />	<br />	Ret<br />SetColor EndP<br /></code></pre></div>
    <div class="meta">Posted on 2004-02-12 17:13:09 by santa</div>
   </div>
   <div class="post" id="post-133358">
    <div class="subject"><a href="#post-133358">Can add-in change text color ?</a></div>
    <div class="body">Hi,<br /><br />The CodeHi control supports many standard edit messages but not all. <br /><br />As can be seen in the WAAddIn.inc file, the standard messages supported are: EM_EXLINEFROMCHAR, EM_EXSETSEL, EM_EXGETSEL, EM_FINDTEXTEX, EM_GETTEXTRANGE, EM_FINDWORDBREAK, EM_CANREDO, EM_REDO, EM_HIDESELECTION, EM_GETSELTEXT, EM_CANPASTE, EM_STREAMIN, EM_STREAMOUT, EM_CHARFROMPOS, EM_POSFROMCHAR, EM_LINEFROMCHAR, EM_LINEINDEX, EM_LINELENGTH, EM_GETLINE, EM_GETFIRSTVISIBLELINE, EM_LINESCROLL, EM_SCROLLCARET, EM_SETSEL, EM_GETSEL, EM_GETMODIFY, EM_SETMODIFY, EM_REPLACESEL, EM_GETLINECOUNT, EM_GETRECT, EM_CANUNDO, EM_UNDO, EM_EMPTYUNDOBUFFER, WM_COPY, WM_CUT, WM_PASTE, WM_CLEAR, WM_SETTEXT, WM_GETTEXT, WM_GETTEXTLENGTH.<br /><br />In addition, the user messages supported are CHM_xxxxxx.<br /><br />I would suggest you have a look on these messages and let me know of any questions you might have.<br /><br />Regards,<br /><br />akyprian</div>
    <div class="meta">Posted on 2004-02-13 06:10:53 by akyprian</div>
   </div>
  </div>
 </body>
</html>