<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>conection state - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12141" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=12141">conection state</a></p>
   <div class="post" id="post-93254">
    <div class="subject"><a href="#post-93254">conection state</a></div>
    <div class="body">Hello , I want  to know if my Internet conection is broken in a determinated moment<br />and I try with RasEnumConections and RasGetStatus but dont work for me<br />I dont know the correct use for this (sorry for my bad english)<br /><br />I need a sample for get the status conection.<br />Always thanks for all to everybody in this wonderful forum<br />:alright:</div>
    <div class="meta">Posted on 2003-04-04 13:32:47 by mnemox</div>
   </div>
   <div class="post" id="post-95061">
    <div class="subject"><a href="#post-95061">conection state</a></div>
    <div class="body">try looking up InternetCheckConnection  in the MSDN<br />that should work for you I think.</div>
    <div class="meta">Posted on 2003-04-10 04:38:18 by asmboy</div>
   </div>
   <div class="post" id="post-95971">
    <div class="subject"><a href="#post-95971">I need wininet.h</a></div>
    <div class="body">This is working for me but I don't know the value of  this flags.<br />I think are in wininet.h but I dont have this file. <br /><br />INTERNET_CONNECTION_CONFIGURED   Local system has a valid connection to the Internet, <br />                                                                but it might or might not be currently connected. <br />INTERNET_CONNECTION_LAN                  Local system uses a local area network to connect to the Internet. <br />INTERNET_CONNECTION_MODEM            Local system uses a modem to connect to the Internet. <br />INTERNET_CONNECTION_MODEM_BUSY  No longer used. <br />INTERNET_CONNECTION_OFFLINE           Local system is in offline mode. <br />INTERNET_CONNECTION_PROXY              Local system uses a proxy server to connect to the Internet. <br />INTERNET_RAS_INSTALLED                       Local system has RAS installed.<br /><br />I try with CERO and working (first parameter)<br /><br />        invoke InternetGetConnectedState, 0, NULL       ; INTERNET_CONNECTION_CONFIGURED == 0 ??<br /><br />         .if eax == 0                   ; FALSE = no hay conexion (There is not conection)<br /><br />             invoke ShellExecute, hWnd, NULL, addr reboot, NULL, NULL, SW_SHOWNA<br /><br />         .endif<br />                                                  :grin:</div>
    <div class="meta">Posted on 2003-04-12 17:59:04 by mnemox</div>
   </div>
   <div class="post" id="post-96035">
    <div class="subject"><a href="#post-96035">conection state</a></div>
    <div class="body">Some of those constants are in windows.inc.  anyway, here are the ones in Hutch's windows.inc:<br />INTERNET_CONNECTION_MODEM equ 1<br />INTERNET_CONNECTION_LAN equ 2<br />INTERNET_CONNECTION_MODEM_BUSY equ 8<br />INTERNET_CONNECTION_PROXY equ 4<br /><br />These are also the only ones defined in wininet.h /w MSVC 7.</div>
    <div class="meta">Posted on 2003-04-12 22:35:34 by jademtech</div>
   </div>
  </div>
 </body>
</html>