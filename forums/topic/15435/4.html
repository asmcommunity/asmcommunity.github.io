<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Grid custom control - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15435" />
  <link rel="prev" href="../?id=15435&amp;page=3" />  <link rel="next" href="../?id=15435&amp;page=5" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=15435">Grid custom control</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=15435&amp;page=1" style="">&laquo;</a><a href="../?id=15435&amp;page=3" style="">&lt;</a><input type="hidden" name="id" value="15435" /><input type="number" name="page" min="1" max="5" step="1" value="4" onchange="this.form.submit();" /><a href="../?id=15435&amp;page=5">&gt;</a><a href="../?id=15435&amp;page=5">&raquo;</a></form>   <div class="post" id="post-124972">
    <div class="subject"><a href="#post-124972">Grid custom control</a></div>
    <div class="body">Hi mnemox<br /><br />If I can find the time.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-11-21 04:18:23 by KetilO</div>
   </div>
   <div class="post" id="post-124973">
    <div class="subject"><a href="#post-124973">Grid custom control</a></div>
    <div class="body">Hi all<br /><br />New upload at the top.<br /><br />Whats new:<br />- Created RAGrid.lib and a demo showing how to use the library in your project.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-11-21 04:20:11 by KetilO</div>
   </div>
   <div class="post" id="post-125008">
    <div class="subject"><a href="#post-125008">Grid custom control</a></div>
    <div class="body">Thanks KetilO. I have now set up 3 of your controls (RAEdit, RAGrid, RAHexEd) working in my emulator project just fine, which makes my program look so slick! The teachers in our college praised for my program (and for your controls as well ^_^). My program is being used in our MCU lab now. Thanks again and keep on good working!<br /><br />And web site of my project:<br /><a target="_blank" href="http://member.netease.com/~huangyc/chip/">http://member.netease.com/~huangyc/chip/</a></div>
    <div class="meta">Posted on 2003-11-21 09:45:25 by optimus</div>
   </div>
   <div class="post" id="post-125026">
    <div class="subject"><a href="#post-125026">Grid custom control</a></div>
    <div class="body">Hi optimus<br /><br />Nice to hear that your hard work turned into something useful.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-11-21 13:07:40 by KetilO</div>
   </div>
   <div class="post" id="post-125028">
    <div class="subject"><a href="#post-125028">Grid custom control</a></div>
    <div class="body">Cool, Kjetil! ;) Good work, once again... One question: are you going to make a &quot;lib-version&quot; of RAEdit, RAHexEd (and maybe the resource editor) too??<br /><br />Regards,<br />Tommy</div>
    <div class="meta">Posted on 2003-11-21 13:25:05 by Tommy</div>
   </div>
   <div class="post" id="post-125124">
    <div class="subject"><a href="#post-125124">Bad code or bug</a></div>
    <div class="body">Hi all , Im here another time , I have this code but when edit a cell<br />the first time the title bar is empty , and the next times workin fine<br />the title bar get the text from the cell without problems, only the first<br />time the buffer is empty...   why?<br /><br /><br /><br />   .elseif eax==GN_AFTEREDIT<br /><br />              invoke SendMessage, hGrd, GM_GETCURSEL, 0, 0<br />              mov edx,eax<br />              invoke SendMessage, hGrd, GM_GETCELLDATA, edx, addr szBuffCellData<br /><br />              invoke SetWindowText, hWnd, addr szBuffCellData<br /><br /><br /><br />Thanks for all.</div>
    <div class="meta">Posted on 2003-11-22 15:55:43 by mnemox</div>
   </div>
   <div class="post" id="post-125131">
    <div class="subject"><a href="#post-125131">Grid custom control</a></div>
    <div class="body">Hi mnemox<br /><br />Have a look at the comments for each notification message.<br /><br /><pre><code><br />GN_BEFOREEDIT	;Sendt before the cell edit control shows<br />GN_AFTEREDIT	;Sendt when the cell edit control is about to close<br />GN_BEFOREUPDATE	;Sendt before a cell updates grid data<br />GN_AFTERUPDATE	;Sendt after grid data has been updated<br /></code></pre> <br /><br />In your example the grid data is not updated yet. Using GN_AFTERUPDATE should solve the problem.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-11-22 17:08:10 by KetilO</div>
   </div>
   <div class="post" id="post-125136">
    <div class="subject"><a href="#post-125136">Grid custom control</a></div>
    <div class="body">Great work, Ketil.<br />Are you going to implement column width autosize?<br />I mean feature that exist in &quot;usual&quot; sheets - dblclk when<br />mouse between two columns heads make the column autosize to fit width of max length string in the column.</div>
    <div class="meta">Posted on 2003-11-22 17:53:51 by The Svin</div>
   </div>
   <div class="post" id="post-125137">
    <div class="subject"><a href="#post-125137">Grid custom control</a></div>
    <div class="body">OK, its true , im sorry. <br /><br />Thanks for your help one more time.</div>
    <div class="meta">Posted on 2003-11-22 17:58:10 by mnemox</div>
   </div>
   <div class="post" id="post-125267">
    <div class="subject"><a href="#post-125267">Grid custom control</a></div>
    <div class="body">There are altogether 8 RAGrids in my app now! :)<br /><br /><img src="http://member.netease.com/~huangyc/chip/Screenshot_full.gif" /></div>
    <div class="meta">Posted on 2003-11-24 02:38:01 by optimus</div>
   </div>
   <div class="post" id="post-125268">
    <div class="subject"><a href="#post-125268">Grid custom control</a></div>
    <div class="body">And I wonder if there is an easy way to compile RAEdit, RAGrid, RAHexEd into one single DLL?</div>
    <div class="meta">Posted on 2003-11-24 02:39:19 by optimus</div>
   </div>
   <div class="post" id="post-125278">
    <div class="subject"><a href="#post-125278">Grid custom control</a></div>
    <div class="body">Hi optimus<br /><br />Nice looking app.<br />Only old fashion hard work lets you create one dll from three dll's.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-11-24 05:01:54 by KetilO</div>
   </div>
   <div class="post" id="post-125296">
    <div class="subject"><a href="#post-125296">Grid custom control</a></div>
    <div class="body">What about compiling the controls to *.lib?</div>
    <div class="meta">Posted on 2003-11-24 08:47:35 by Tommy</div>
   </div>
   <div class="post" id="post-125382">
    <div class="subject"><a href="#post-125382">Grid custom control</a></div>
    <div class="body">Is it possible to make 3 dlls into 3 lib, and another project to adopt these 3 libs and compile into one dll?</div>
    <div class="meta">Posted on 2003-11-24 20:42:39 by optimus</div>
   </div>
   <div class="post" id="post-125406">
    <div class="subject"><a href="#post-125406">Grid custom control</a></div>
    <div class="body">Hi Tommy &amp; optimus<br /><br />Creating a library of the dll's does not solve any problems. You still have to rewrite to handle resources.<br /><br />KetilO</div>
    <div class="meta">Posted on 2003-11-25 02:44:07 by KetilO</div>
   </div>
   <div class="post" id="post-125415">
    <div class="subject"><a href="#post-125415">Grid custom control</a></div>
    <div class="body">Hi Kjetil... I didn't mean that either... I just wondered if you could make library versions of your controls (like you did with the grid) or something... COFF maybe, so that all the controls can be compile within the executable to be written. You see?</div>
    <div class="meta">Posted on 2003-11-25 05:15:35 by Tommy</div>
   </div>
   <div class="post" id="post-130190">
    <div class="subject"><a href="#post-130190">capture ins and supr keys</a></div>
    <div class="body">Hello again , how can I capture in griddemo the ins and supr keys ?<br /><br />I want add a new row by push the ins key and delete a row by push supr key.<br /><br />thanks in advance for all.  :alright:</div>
    <div class="meta">Posted on 2004-01-09 16:09:52 by mnemox</div>
   </div>
   <div class="post" id="post-130987">
    <div class="subject"><a href="#post-130987">Grid custom control</a></div>
    <div class="body">I'm coding up a small utility using your grid control, and I've run into an annoying problem. I'm not sure what I'm doing wrong, so I kinda hoped you could spot the problem.<br /><br />So far, the program is basically a grid control in a dialogbox. The grid has two columns, column 0 is text, column 1 is a custom column. Basically what I'm trying to do is store two one-byte values in the data for this column, and switch between displaying one value or the other based on a flag in my program. Sorry for abusing your control in this way, but having two grid controls seemed like bloat for something so simple. :)<br /><br />The problem is that entering a value in one column sometimes seems to change the value for the other column as well. For example, I enter a space in the text column, and the user column displays &quot;32&quot;. Also when I enter &quot;32&quot; in the user column, the first character of the text column changes to a space. What makes it really strange is that these seem to link and unlink at random.<br /><br />This is the code I use to initialize the user column (almost 100% copied from your code):<br /><br /><pre><code><br />	mov		col.colwt,50<br />	mov		col.lpszhdrtext,CTEXT&#40;&quot;Init&quot;&#41;<br />	mov		col.halign,GA_ALIGN_LEFT<br />	mov		col.calign,GA_ALIGN_RIGHT<br />	mov		col.ctype,TYPE_USER<br />	mov		col.ctextmax,2<br />	mov		col.lpszformat,0<br />	mov		col.himl,0<br />	mov		col.hdrflag,0<br />	invoke CreateWindowEx,0,CTEXT&#40;&quot;Edit&quot;&#41;,NULL,WS_CHILD or WS_BORDER or WS_CLIPCHILDREN or WS_CLIPSIBLINGS or ES_AUTOHSCROLL or ES_RIGHT,0,0,0,0,hWnd,NULL,hInstance,0<br />	mov		col.edthwnd,eax<br />	invoke SetWindowLong,eax,GWL_WNDPROC,offset EdtLongProc<br />	invoke SetWindowLong,col.edthwnd,GWL_USERDATA,eax<br />	invoke SendMessage,col.edthwnd,EM_LIMITTEXT,3,0<br />	invoke SendMessage,hGrd,GM_ADDCOL,0,addr col<br /></code></pre><br /><br />This is the code I have in my WndProc for handling the grid notifications:<br /><br /><pre><code><br />	.elseif eax==WM_NOTIFY<br />		mov		esi,lParam<br />		mov		eax,&#91;esi&#93;.NMHDR.hwndFrom<br />		.if eax==hGrd<br />			mov		eax,&#91;esi&#93;.NMHDR.code<br />			.if eax==GN_HEADERCLICK<br />				invoke SendMessage,hGrd,GM_COLUMNSORT,&#91;esi&#93;.GRIDNOTIFY.col,SORT_INVERT<br /><br />			.elseif eax==GN_BEFOREEDIT<br />				mov eax,&#91;esi&#93;.GRIDNOTIFY.col<br />				.if eax==1<br />					mov edx,&#91;esi&#93;.GRIDNOTIFY.row<br />					shl edx,16<br />					or edx,eax<br />					invoke SendMessage,hGrd,GM_CELLCONVERT,edx,addr buf1<br />					invoke SendMessage,&#91;esi&#93;.GRIDNOTIFY.hwnd,WM_SETTEXT,0,addr buf1<br />					invoke SendMessage,&#91;esi&#93;.GRIDNOTIFY.hwnd,EM_SETSEL,0,-1<br />				.endif<br />				<br />			.elseif eax==GN_AFTEREDIT<br />				mov eax,&#91;esi&#93;.GRIDNOTIFY.col<br />				.if eax==1<br />					mov edx,&#91;esi&#93;.GRIDNOTIFY.row<br />					shl edx,16<br />					or edx,eax<br />					invoke SendMessage,hGrd,GM_GETCELLDATA,edx,&#91;esi&#93;.GRIDNOTIFY.lpdata<br />					invoke SendMessage,&#91;esi&#93;.GRIDNOTIFY.hwnd,WM_GETTEXT,sizeof buf1,addr buf1<br />					invoke DecToBin,addr buf1<br />					.if eax&gt;255<br />						xor eax,eax<br />					.endif<br />					mov ecx,&#91;esi&#93;.GRIDNOTIFY.lpdata<br />					.if ViewRoll<br />						mov &#91;ecx+1&#93;,al<br />					.else<br />						mov &#91;ecx&#93;,al<br />					.endif<br />				.endif<br />				<br />			.elseif eax==GN_USERCONVERT<br />				xor eax,eax<br />				mov ecx,&#91;esi&#93;.GRIDNOTIFY.lpdata<br />				.if ViewRoll<br />					mov al,&#91;ecx+1&#93;<br />					invoke BinToDec,eax,&#91;esi&#93;.GRIDNOTIFY.lpdata<br />				.else<br />					mov al,&#91;ecx&#93;<br />					invoke BinToDec,eax,&#91;esi&#93;.GRIDNOTIFY.lpdata<br />				.endif<br />				<br />			.endif<br />		.endif<br /></code></pre></div>
    <div class="meta">Posted on 2004-01-18 13:43:33 by Qweerdy</div>
   </div>
   <div class="post" id="post-130990">
    <div class="subject"><a href="#post-130990">Grid custom control</a></div>
    <div class="body">Ketil, dunno if the control already has this option, but what about supporting excel-style keyboard navigation? You know, allow arrow keys to change to another cell even when editing data? (Should of course be configurable if you want it enabled or not)</div>
    <div class="meta">Posted on 2004-01-18 14:36:16 by f0dder</div>
   </div>
   <div class="post" id="post-131288">
    <div class="subject"><a href="#post-131288">??Hi !!, Qweerdy</a></div>
    <div class="body">I think your code here is wrong<br /><br />			.elseif eax==GN_AFTEREDIT<br />				mov eax,.GRIDNOTIFY.col             ;this dont work to me<br />				.if eax==1<br />					mov edx,.GRIDNOTIFY.row<br />					shl edx,16<br /><br /><br /><br />I try it and dont work in GN_AFTERUPDATE, you must try this:<br /><br />			.elseif eax==GN_AFTEREDIT<br />				invoke SendMessage, hGrd, GM_GETCURCOL, 0, 0     ;this work fine<br />				.if eax==1<br />					mov edx,.GRIDNOTIFY.row<br />					shl edx,16</div>
    <div class="meta">Posted on 2004-01-21 15:25:09 by mnemox</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=15435&amp;page=1" style="">&laquo;</a><a href="../?id=15435&amp;page=3" style="">&lt;</a><input type="hidden" name="id" value="15435" /><input type="number" name="page" min="1" max="5" step="1" value="4" onchange="this.form.submit();" /><a href="../?id=15435&amp;page=5">&gt;</a><a href="../?id=15435&amp;page=5">&raquo;</a></form>  </div>
 </body>
</html>