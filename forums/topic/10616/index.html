<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>GetModuleHandle source? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10616" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10616">GetModuleHandle source?</a></p>
   <div class="post" id="post-79858">
    <div class="subject"><a href="#post-79858">GetModuleHandle source?</a></div>
    <div class="body">Hi I'm trying to understand the inner workings of the getmodulehandle api....this is the code i have got so far it just gets any help understanding this would be good.<br />written in fasm.<br /><br /><pre><code><br /><br />        cmp &#91;ModuleName&#93;,0x0        ; check if Modulename null<br />        jne NotCallingProc<br /><br />CallingProc&#58;<br />        mov eax,&#91;fs&#58;0x18&#93;                ; im not sure about this<br />        mov eax,&#91;eax+0x30&#93;            ; and this<br />        mov eax,&#91;eax+0x8&#93;              ; and this<br />        jmp ExitGetModuleHandleX <br /><br /></code></pre> <br /><br />thanks :)</div>
    <div class="meta">Posted on 2003-02-04 04:35:13 by keyoke</div>
   </div>
   <div class="post" id="post-79866">
    <div class="subject"><a href="#post-79866">GetModuleHandle source?</a></div>
    <div class="body">the fs selector holds a structure with windows internal data.<br />You can find a short description in this <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=4769">thread</a></div>
    <div class="meta">Posted on 2003-02-04 06:51:29 by beaster</div>
   </div>
   <div class="post" id="post-79874">
    <div class="subject"><a href="#post-79874">GetModuleHandle source?</a></div>
    <div class="body">aside for curiosity, you shouldn't be messing with this stuff. if you start depending on any of it, your apps will break.</div>
    <div class="meta">Posted on 2003-02-04 08:18:47 by f0dder</div>
   </div>
   <div class="post" id="post-79887">
    <div class="subject"><a href="#post-79887">GetModuleHandle source?</a></div>
    <div class="body">Here's Matt Pietrek's article about the TIB/TEB, which fs points to <a target="_blank" href="http://www.microsoft.com/msj/defaulttop.asp?page=/msj/archive/S2CE.htm">http://www.microsoft.com/msj/defaulttop.asp?page=/msj/archive/S2CE.htm</a></div>
    <div class="meta">Posted on 2003-02-04 10:07:19 by stormix</div>
   </div>
   <div class="post" id="post-79905">
    <div class="subject"><a href="#post-79905">GetModuleHandle source?</a></div>
    <div class="body">thanks guys this will help me alot, f0dder i dont really wanna mess around to much with these values all i wanna do really is code my own version of getmodulehandle :)<br />anyway later guys</div>
    <div class="meta">Posted on 2003-02-04 11:37:47 by keyoke</div>
   </div>
   <div class="post" id="post-79917">
    <div class="subject"><a href="#post-79917">GetModuleHandle source?</a></div>
    <div class="body">code your own version of getmodulehandle... but then you *are* going to mess around with those values. getmodulehandle is one of those things that aren't safe to implement yourself.</div>
    <div class="meta">Posted on 2003-02-04 12:20:15 by f0dder</div>
   </div>
   <div class="post" id="post-79967">
    <div class="subject"><a href="#post-79967">GetModuleHandle source?</a></div>
    <div class="body">plus that code u got for getmodulehandle rite now will only work on 9x, not on NT</div>
    <div class="meta">Posted on 2003-02-04 18:46:03 by BubbaFate</div>
   </div>
   <div class="post" id="post-80000">
    <div class="subject"><a href="#post-80000">GetModuleHandle source?</a></div>
    <div class="body"><div class="quote">will only work on 9x, not on NT</div> <br /><br />but this is code i got from the kernel32.dll on a win2k system surely it should work</div>
    <div class="meta">Posted on 2003-02-05 05:09:43 by keyoke</div>
   </div>
   <div class="post" id="post-80002">
    <div class="subject"><a href="#post-80002">GetModuleHandle source?</a></div>
    <div class="body">keyoke. you can't just rip a piece of code from kernel32 (or whereever) and expect<br />it to work across multiple windows versions. Especially a thing like GetModuleHandle<br />that will have to refer to internal tables, or end up in native calls. forget it.</div>
    <div class="meta">Posted on 2003-02-05 05:14:33 by f0dder</div>
   </div>
   <div class="post" id="post-80017">
    <div class="subject"><a href="#post-80017">GetModuleHandle source?</a></div>
    <div class="body">ok f0dder i understand wat ur saying... for sum reason i thought they would be the same for most ms os's like win95,98,2k,nt well....haha my bad i didnt think the underlying code of the api would be different...dang :(<br />thnx</div>
    <div class="meta">Posted on 2003-02-05 07:00:11 by keyoke</div>
   </div>
  </div>
 </body>
</html>