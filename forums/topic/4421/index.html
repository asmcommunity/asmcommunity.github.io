<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>translate c++ to asm - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4421" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4421">translate c++ to asm</a></p>
   <div class="post" id="post-30733">
    <div class="subject"><a href="#post-30733">translate c++ to asm</a></div>
    <div class="body">the reason begin every console asm &quot;hello world&quot; i study they all looking different from each other.<br /><br />#include &lt;iostream.h&gt;<br />int main()<br />{<br />cout &lt;&lt; &quot;Hello&quot;;<br />}<br /><br /><br />thx</div>
    <div class="meta">Posted on 2002-03-25 06:28:09 by k0d</div>
   </div>
   <div class="post" id="post-30737">
    <div class="subject"><a href="#post-30737">translate c++ to asm</a></div>
    <div class="body">This should help ya.... handles input and output... just copy, paste &amp; compile to see what it's doing!<br /><br />regards,<br />bAZiK<br /><br />P.S.: This is better than you C++ crap: <br /><pre><code><br />#include &lt;stdio.h&gt;<br />void main&#40;&#41; &#123; printf&#40;&quot;Hello!&quot;&#41;; &#125;<br /></code></pre><br /><br />ANSI-C rulez! :grin: <br /><br /><pre><code><br />--------------------------------------------------------------------------------<br />; ###############################<br /><br />        .386<br />        .model flat, stdcall<br />        option casemap &#58;none<br /><br />; ###############################<br /><br />        include \masm32\include\windows.inc<br />        include \masm32\include\user32.inc<br />        include \masm32\include\kernel32.inc<br />        include \masm32\include\shell32.inc<br /><br />        includelib \masm32\lib\user32.lib<br />        includelib \masm32\lib\kernel32.lib<br />        includelib \masm32\lib\shell32.lib<br /><br />; ###############################<br /><br />        CPut PROTO &#58;DWORD<br />        CPutErr PROTO &#58;DWORD<br />        CGet PROTO<br />        GetCmd PROTO<br />        ListLong PROTO<br />        ChangeDir PROTO<br />        Execute PROTO<br /><br />; ###############################<br /><br />    .data<br />        ; ################## console strings<br />        szConTitle      db &quot;WinShell Konsole v0.10&quot;, 0<br />        szConAbout      db &quot;Copyright 2001 by bAZiK&quot;, 13,10, 0<br />        szNewLine       db 13, 10, 0<br />        szError         db &quot;Error&#58; Command or File not found!&quot;, 13,10,13,10, 0<br />        szTimeFormat    db &quot;HH&#58;mm&#58;ss&quot;, 0<br />        szDateFormat    db &quot;dd.MM.yyyy&quot;, 0<br />        szChgError      db &quot;Error&#58; Directory not found!&quot;, 13,10, 0<br />        szShellError    db &quot;Error&#58; File not found!&quot;, 13,10, 0<br /><br />        ; ################## console commands<br />        szExit          db &quot;exit&quot;, 0<br />        szll            db &quot;ll&quot;, 0<br />        szcd            db &quot;cd&quot;, 0<br />        szx             db &quot;x&quot;, 0<br /><br />        ; ################## wsprintf templates<br />        szConPrompt     db &quot;%s &gt; &quot;, 0<br />        szListFormat    db &quot;%s  %s  %s  %35s  %13lu&quot;, 0<br />        szTotalFormat   db &quot;Total Size&#58; %lu Byte&#40;s&#41;&quot;, 13,10, 0<br /><br />         ; ################# structures<br />        wfd             WIN32_FIND_DATA &lt;&gt;<br />        syst            SYSTEMTIME &lt;&gt;<br />        ft              FILETIME &lt;&gt;<br /><br />; ###############################<br /><br />    .data?<br />        szOutputBuffer  db 512 dup &#40;?&#41;<br />        szInputBuffer   db 512 dup &#40;?&#41;<br />        szCmdBuffer     db 512 dup &#40;?&#41;<br />        szDirBuffer     db 512 dup &#40;?&#41;<br />        szListBuffer    db 512 dup &#40;?&#41;<br />        szAttribBuffer  db 20 dup &#40;?&#41;<br />        szTimeBuffer    db 20 dup &#40;?&#41;<br />        szDateBuffer    db 20 dup &#40;?&#41;<br />        szTotalBuffer   db 512 dup &#40;?&#41;<br />        szChgBuffer     db 512 dup &#40;?&#41;<br />        szShellBuffer   db 512 dup &#40;?&#41;<br />        hFind           dd ?<br />        hInput          dd ?<br />        hOutput         dd ?<br />        hWritten        dd ?<br />        hRead           dd ?<br />        hMenu           dd ?<br />        hConWin         dd ?<br />        lpTotalSize     dd ?<br /><br />; ###############################<br /><br />    .code<br /><br />start&#58;<br />    invoke GetStdHandle, STD_INPUT_HANDLE<br />    mov hInput, eax<br />    invoke GetStdHandle, STD_OUTPUT_HANDLE<br />    mov hOutput, eax<br />    invoke SetConsoleTitle, addr szConTitle<br /><br />    invoke SetConsoleTextAttribute, hOutput, FOREGROUND_RED or \<br />                                    FOREGROUND_GREEN or \<br />                                    FOREGROUND_BLUE or \<br />                                    FOREGROUND_INTENSITY or \<br />                                    BACKGROUND_BLUE<br />    invoke CPut, addr szConTitle<br />    invoke CPut, addr szNewLine<br />    invoke CPut, addr szConAbout<br />    invoke SetConsoleTextAttribute, hOutput, FOREGROUND_RED or \<br />                                    FOREGROUND_GREEN or \<br />                                    FOREGROUND_BLUE or \<br />                                    FOREGROUND_INTENSITY<br />    invoke CPut, addr szNewLine<br /><br /> @@&#58;<br />    call CGet<br />    call GetCmd<br />    cmp byte ptr &#91;szCmdBuffer&#93;, 0 ; return gedr?ckt<br />    je  @B<br /><br />    invoke lstrcmp, addr szCmdBuffer, addr szExit<br />    .if eax == 0<br />        jmp @F<br />    .endif<br /><br />    invoke lstrcmp, addr szCmdBuffer, addr szll<br />    .if eax == 0<br />        call ListLong<br />        jmp @B<br />    .endif<br /><br />    invoke lstrcmp, addr szCmdBuffer, addr szcd<br />    .if eax == 0<br />        call ChangeDir<br />        invoke CPut, addr szNewLine<br />        jmp @B<br />    .endif<br /><br />    invoke lstrcmp, addr szCmdBuffer, addr szx<br />    .if eax == 0<br />        call Execute<br />        invoke CPut, addr szNewLine<br />        jmp @B<br />    .endif<br /><br />    invoke CPutErr, addr szError<br />    jmp @B<br /> @@&#58;<br /><br />    invoke ExitProcess, 0<br /><br />; ###############################<br /><br />Execute proc<br />    invoke RtlZeroMemory, addr szShellBuffer, 512<br />    lea edi, szInputBuffer<br />    lea esi, szShellBuffer<br />    add edi, 2 ; 'x '<br /> @@&#58;<br />    mov al, byte ptr &#91;edi&#93;<br />    cmp al, 13<br />    je @F<br />    mov byte ptr &#91;esi&#93;, al<br />    inc edi<br />    inc esi<br />    or al, al<br />    jnz @B<br /> @@&#58;<br />    invoke ShellExecute, 0, 0, addr szShellBuffer, 0, \<br />                         addr szDirBuffer, SW_SHOWNORMAL<br />    cmp eax, ERROR_FILE_NOT_FOUND<br />    jne @F<br /><br />    invoke CPutErr, addr szShellError<br /> @@&#58;<br />    ret<br /><br />Execute endp<br /><br />; ###############################<br /><br />ChangeDir proc<br />    invoke RtlZeroMemory, addr szChgBuffer, 512<br />    lea edi, szInputBuffer<br />    lea esi, szChgBuffer<br />    add edi, 3 ; 'cd '<br /> @@&#58;<br />    mov al, byte ptr &#91;edi&#93;<br />    cmp al, 13<br />    je @F<br />    mov byte ptr &#91;esi&#93;, al<br />    inc edi<br />    inc esi<br />    or al, al<br />    jnz @B<br /> @@&#58;<br />    invoke SetCurrentDirectory, addr szChgBuffer<br />    cmp eax, 0<br />    jne @F<br /><br />    invoke CPutErr, addr szChgError<br /> @@&#58;<br />    ret<br />ChangeDir endp<br /><br />; ###############################<br /><br />ListLong proc<br />    mov eax, 0<br />    mov lpTotalSize, eax<br /><br />    invoke CPut, addr szNewLine<br />    invoke lstrlen, addr szDirBuffer<br />    lea edi, szDirBuffer<br />    add edi, eax<br />    mov byte ptr &#91;edi&#93;, 42 ; *<br /><br />    invoke FindFirstFile, addr szDirBuffer, addr wfd<br />    mov hFind, eax<br /><br /> @@&#58;<br />    lea edi, szAttribBuffer<br />    mov eax, wfd.dwFileAttributes<br /><br />    .if &#40;eax &amp; FILE_ATTRIBUTE_DIRECTORY&#41;<br />        mov byte ptr &#91;edi&#93;, 100 ; d<br />    .else<br />        mov byte ptr &#91;edi&#93;, 45 ; -<br />    .endif<br /><br />    inc edi<br /><br />    .if &#40;eax &amp; FILE_ATTRIBUTE_ARCHIVE&#41;<br />        mov byte ptr &#91;edi&#93;, 97 ; a<br />    .else<br />        mov byte ptr &#91;edi&#93;, 45 ; -<br />    .endif<br /><br />    inc edi<br /><br />    .if &#40;eax &amp; FILE_ATTRIBUTE_SYSTEM&#41;<br />        mov byte ptr &#91;edi&#93;, 115 ; s<br />    .else<br />        mov byte ptr &#91;edi&#93;, 45 ; -<br />    .endif<br /><br />    inc edi<br /><br />    .if &#40;eax &amp; FILE_ATTRIBUTE_HIDDEN&#41;<br />        mov byte ptr &#91;edi&#93;, 104 ; h<br />    .else<br />        mov byte ptr &#91;edi&#93;, 45 ; -<br />    .endif<br /><br />    inc edi<br /><br />    .if &#40;eax &amp; FILE_ATTRIBUTE_READONLY&#41;<br />        mov byte ptr &#91;edi&#93;, 114 ; r<br />    .else<br />        mov byte ptr &#91;edi&#93;, 45 ; -<br />    .endif<br /><br />    invoke FileTimeToLocalFileTime, addr wfd.ftLastWriteTime, addr ft<br />    invoke FileTimeToSystemTime, addr ft, addr syst<br />    invoke GetTimeFormat, 0, 0, addr syst, \<br />                          addr szTimeFormat, addr szTimeBuffer, 20<br />    invoke GetDateFormat, 0, 0, addr syst, addr szDateFormat, \<br />                          addr szDateBuffer, 20<br /><br />    mov eax, MAXDWORD<br />    mov ebx, wfd.nFileSizeHigh<br />    imul ebx<br />    add eax, wfd.nFileSizeLow<br />    mov edx, eax<br /><br />    add lpTotalSize, edx<br /><br />    invoke wsprintf, addr szListBuffer, addr szListFormat, \<br />                     addr szAttribBuffer, addr szDateBuffer, \<br />                     addr szTimeBuffer, addr wfd.cFileName, edx<br /><br />    invoke CPut, addr szListBuffer<br />    invoke CPut, addr szNewLine<br /><br />    invoke RtlZeroMemory, addr szListBuffer, 512 ; clear buffer<br />    invoke FindNextFile, hFind, addr wfd<br />    invoke GetLastError<br />    cmp eax, ERROR_NO_MORE_FILES<br />    jne @B<br /><br />    invoke CPut, addr szNewLine<br /><br />    invoke wsprintf, addr szTotalBuffer, addr szTotalFormat, lpTotalSize<br />    invoke CPut, addr szTotalBuffer<br /><br />    invoke CPut, addr szNewLine<br />    invoke CloseHandle, hFind<br /><br />    ret<br />ListLong endp<br /><br />; ###############################<br /><br />CPutErr proc lpText&#58;DWORD<br />    invoke SetConsoleTextAttribute, hOutput, FOREGROUND_RED or \<br />                                    FOREGROUND_INTENSITY<br />    invoke CPut, lpText<br />    invoke SetConsoleTextAttribute, hOutput, FOREGROUND_RED or \<br />                                    FOREGROUND_GREEN or \<br />                                    FOREGROUND_BLUE or \<br />                                    FOREGROUND_INTENSITY<br />    ret<br />CPutErr endp<br /><br />; ###############################<br /><br />CPut proc lpText&#58;DWORD<br />    invoke lstrlen, lpText<br />    invoke WriteFile, hOutput, lpText, eax, addr hWritten, 0<br />    mov eax, hWritten<br />    ret<br />CPut endp<br /><br />; ###############################<br /><br />CGet proc<br />    invoke RtlZeroMemory, addr szDirBuffer, 512<br />    invoke GetCurrentDirectory, 512, addr szDirBuffer<br />    lea edi, szDirBuffer<br />    add edi, eax<br />    cmp byte ptr &#91;edi-1&#93;, &quot;\&quot;<br />    je @F<br />    mov byte ptr &#91;edi&#93;, &quot;\&quot;<br /> @@&#58;<br />    invoke wsprintf, addr szOutputBuffer, addr szConPrompt, addr szDirBuffer<br />    invoke CPut, addr szOutputBuffer<br />    invoke RtlZeroMemory, addr szInputBuffer, 512<br />    invoke ReadFile, hInput, addr szInputBuffer, 512, addr hRead, 0<br />    mov eax, hRead<br />    ret<br />CGet endp<br /><br />; ###############################<br /><br />GetCmd proc<br />    invoke RtlZeroMemory, addr szCmdBuffer, 512<br />    lea edi, szInputBuffer<br />    lea esi, szCmdBuffer<br /> @@&#58;<br />    mov al, byte ptr &#91;edi&#93;<br />    cmp al, 32<br />    je @F<br />    cmp al, 13<br />    je @F<br />    mov byte ptr &#91;esi&#93;, al<br />    inc edi<br />    inc esi<br />    or al, al<br />    jnz @B<br /> @@&#58;<br />    ret<br />GetCmd endp<br /><br />; ###############################<br /><br />end start<br /><br />; ###############################<br /></code></pre></div>
    <div class="meta">Posted on 2002-03-25 07:09:44 by bazik</div>
   </div>
   <div class="post" id="post-30739">
    <div class="subject"><a href="#post-30739">thx bazik</a></div>
    <div class="body">i've already tryed it, run it thx , but i am looking for &quot;hello&quot; so i could practive the opcodes  this way i get familiar with them. <br />But every &quot;hello&quot; console i found differ from one another. so i am looking for plain hello console so  i know whats going in the code.<br /><br />bazik you got to think about what c++ means:<br /><br />C  See<br />++ Increment ONE</div>
    <div class="meta">Posted on 2002-03-25 07:30:55 by k0d</div>
   </div>
   <div class="post" id="post-30771">
    <div class="subject"><a href="#post-30771">translate c++ to asm</a></div>
    <div class="body">build with:<br /><br />ml /c /coff hello.asm<br />link /subsystem:console hello.obj</div>
    <div class="meta">Posted on 2002-03-25 10:26:05 by malone</div>
   </div>
   <div class="post" id="post-30911">
    <div class="subject"><a href="#post-30911">thx malone</a></div>
    <div class="body">this is exactly what i was looking for.</div>
    <div class="meta">Posted on 2002-03-26 01:03:10 by k0d</div>
   </div>
  </div>
 </body>
</html>