<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Setting a DIRECTORY time / date - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3144" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3144">Setting a DIRECTORY time / date</a></p>
   <div class="post" id="post-20686">
    <div class="subject"><a href="#post-20686">Setting a DIRECTORY time / date</a></div>
    <div class="body">Hello,<br /><br />I wonder how to get/set the time/date of a directory. I thought i could use:<br /><br />invoke CreateFile, szFileName, GENERIC_READ + GENERIC_WRITE, FILE_SHARE_READ, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_DIRECTORY, NULL<br /><br />mov hFile, eax<br /><br />invoke GetFileTime, hFile, ADDR DateTime, ADDR DateTime, ADDR DateTime<br /><br />invoke CloseHandle, hFile<br /><br />but that gives me a file open error, so what is the right way to do it?<br /><br />TIA</div>
    <div class="meta">Posted on 2002-01-23 12:37:16 by Slash0r</div>
   </div>
   <div class="post" id="post-20688">
    <div class="subject"><a href="#post-20688">Setting a DIRECTORY time / date</a></div>
    <div class="body">PlatformSDK seems to indicate that you can, indeed, use CreateFile<br />to &quot;open&quot; a directory. Try using &quot;0&quot; for dwDesiredAccess and dwShareMode,<br />OPEN_EXISTING for dwCreationDisposition, 0 for dwFlagsAndAttributes,<br />and see if that works.</div>
    <div class="meta">Posted on 2002-01-23 12:44:21 by f0dder</div>
   </div>
  </div>
 </body>
</html>