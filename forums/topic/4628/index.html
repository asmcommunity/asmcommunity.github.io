<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Crc32 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4628" />
    <link rel="next" href="../?id=4628&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=4628">Crc32</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=4628&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=4628&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="4628" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=4628&amp;page=2">&gt;</a><a href="../?id=4628&amp;page=2">&raquo;</a></form>   <div class="post" id="post-32472">
    <div class="subject"><a href="#post-32472">Crc32</a></div>
    <div class="body">In the same way as with the adler32 thread, here's a CRC32 algo in asm and a test program. Just put a 2MB+ file as file.dat in the dirctory, run file2obj, run make and run test.exe.<br />Here's what I got so far:<br /><pre><code><br />;Calculate table&#58;<br /><br />Thomas1_ct proc uses ebx esi edi<br />    mov     edi, offset CRCtable  - 4<br />    xor     ecx, ecx<br />    <br />    _ml&#58;<br />    mov     eax, ecx<br />    mov     ebx, 0EDB88320h<br />    add     edi, 4<br />    mov     esi, 8<br />    @@&#58;<br />        shr eax, 1    <br />        sbb edx, edx  <br />        and edx, ebx<br />        xor eax, edx<br />    dec esi<br />    jnz @B<br />    inc     ecx<br />    mov     &#91;edi&#93;, eax<br />    cmp     ecx, 256<br />    jb      _ml<br />ret<br />Thomas1_ct endp<br /><br />; Calculate CRC<br />; &#40;Uses Thomas1_ct for table generation&#41;<br />Thomas2 proc uses ebx esi edi buf&#58;DWORD, len&#58;DWORD<br />    mov     esi, buf<br />    mov     edi, offset CRCtable<br />    mov     edx, len<br />    shr     edx, 1<br />    or      ecx, -1<br />    xor     eax, eax<br />    @@&#58;<br />    mov     al, &#91;esi&#93;<br />    xor     al, cl<br />    shr     ecx, 8<br />    mov     ebx, &#91;edi+4*eax&#93;<br />    xor     ecx, ebx<br />    <br />    mov     al, &#91;esi+1&#93;<br />    xor     al, cl<br />    shr     ecx, 8<br />    mov     ebx, &#91;edi+4*eax&#93;<br />    add     esi,2<br />    xor     ecx, ebx<br />    <br />    dec     edx<br />    jnz     @B<br />    <br />    test    len, 1<br />    jz      @F<br />    mov     al, &#91;esi&#93;<br />    xor     al, cl<br />    inc     esi<br />    shr     ecx, 8<br />    mov     ebx, &#91;edi+4*eax&#93;<br />    xor     ecx, ebx<br />    @@&#58;<br />    <br />    mov     eax, ecx   <br />    not     eax<br />    ret<br />Thomas2 endp<br /></code></pre><br /><br />I found another one by tE, one from Nico and one from Huh but I couldn't get the last one working..<br /><br />Results:<br /><pre><code><br />AMD Thunderbird 1.4GHz<br />------------------------------------------------------------------<br />eax = tE            &#58; &#91;B2033B77&#93;, 1672 ms &#91;10x2MB&#93;,   11.96 MB/s<br />eax =        592 ticks&#40;!&#41; for table.<br />eax = Thomas1       &#58; &#91;B2033B77&#93;,  131 ms &#91;10x2MB&#93;,  152.67 MB/s<br />eax =       112855 ticks&#40;!&#41; for table.<br />eax = Nico          &#58; &#91;B2033B77&#93;,  180 ms &#91;10x2MB&#93;,  111.11 MB/s<br />eax =       222965 ticks&#40;!&#41; for table.<br />eax = Thomas2       &#58; &#91;B2033B77&#93;,  130 ms &#91;10x2MB&#93;,  153.84 MB/s<br />eax =       81628 ticks&#40;!&#41; for table.<br /><br />Pentium III - 550 MHz<br />------------------------------------------------------------------<br />eax = tE            &#58; &#91;B2033B77&#93;, 3966 ms &#91;10x2MB&#93;,    5.04 MB/s<br />eax =        314 ticks&#40;!&#41; for table.<br />eax = Thomas1       &#58; &#91;B2033B77&#93;,  341 ms &#91;10x2MB&#93;,   58.65 MB/s<br />eax =       158263 ticks&#40;!&#41; for table.<br />eax = Nico          &#58; &#91;B2033B77&#93;,  570 ms &#91;10x2MB&#93;,   35.08 MB/s<br />eax =       202842 ticks&#40;!&#41; for table.<br />eax = Thomas2       &#58; &#91;B2033B77&#93;,  591 ms &#91;10x2MB&#93;,   33.84 MB/s<br />eax =       463400 ticks&#40;!&#41; for table.<br /></code></pre><br /><br />Thomas</div>
    <div class="meta">Posted on 2002-04-05 04:23:21 by Thomas</div>
   </div>
   <div class="post" id="post-32501">
    <div class="subject"><a href="#post-32501">Crc32</a></div>
    <div class="body">Thomas, that is great as I wanted to work on a crc-32 algo implementation this week-end... so I guess I will try to participate to the &quot;optimizing process&quot; ;)</div>
    <div class="meta">Posted on 2002-04-05 08:36:25 by JCP</div>
   </div>
   <div class="post" id="post-32503">
    <div class="subject"><a href="#post-32503">Crc32</a></div>
    <div class="body">Some crc-32 assembly routines can be found on this site too : <a target="_blank" href="http://www.geocities.com/SiliconValley/Heights/7394/">http://www.geocities.com/SiliconValley/Heights/7394/</a></div>
    <div class="meta">Posted on 2002-04-05 09:05:27 by JCP</div>
   </div>
   <div class="post" id="post-32505">
    <div class="subject"><a href="#post-32505">Crc32</a></div>
    <div class="body">I added the one from the site Readiosys mentioned (by Adam Stanislav):<br /><br /><pre><code><br />AMD Thunderbird 1.4Ghz&#58;<br /><br />eax = tE             &#58; &#91;B2033B77&#93;, 1592 ms &#91;10x2MB&#93;,   12.56 MB/s<br />eax =        804 ticks&#40;!&#41; for table.<br />eax = Thomas1        &#58; &#91;B2033B77&#93;,  130 ms &#91;10x2MB&#93;,  153.84 MB/s<br />eax =       125213 ticks&#40;!&#41; for table.<br />eax = Nico           &#58; &#91;B2033B77&#93;,  180 ms &#91;10x2MB&#93;,  111.11 MB/s<br />eax =       221046 ticks&#40;!&#41; for table.<br />eax = Thomas2        &#58; &#91;B2033B77&#93;,  131 ms &#91;10x2MB&#93;,  152.67 MB/s<br />eax =       82106 ticks&#40;!&#41; for table.<br />eax = Adam Stanislav &#58; &#91;B2033B77&#93;,  190 ms &#91;10x2MB&#93;,  105.26 MB/s<br />eax =        478 ticks&#40;!&#41; for table.<br /><br />&#40;Can't test on the other machine right now&#41;<br /></code></pre><br /><br />Updated files are in the attachment.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-04-05 09:38:17 by Thomas</div>
   </div>
   <div class="post" id="post-32506">
    <div class="subject"><a href="#post-32506">Crc32</a></div>
    <div class="body">Sorry Thomas, I would have added it by myself if I wasn't at work and had my assembler/time to do it right now...<br /><br />I found another one, from Jay (NASM), if you want to add it :<br /><br /><pre><code><br />bits 32<br /><br />global init_crc<br />global update_crc<br /><br />segment code public align=4 use32 class=code<br /><br />; Initializes the crc_table, call this first<br />init_crc&#58;<br />   xor eax, eax<br />   xor edx, edx<br /><br />.loop&#58;<br />   mov ecx, eax<br />   mov edx, 8<br />.inloop&#58;<br />   test ecx, 1<br />   jz .clear<br />   shr ecx, 1<br />   xor ecx, 0xedb88320<br />   jmp short .set<br />.clear&#58;<br />   shr ecx, 1<br />.set&#58;<br />   dec edx<br />   jnz .inloop<br /><br />   mov &#91;crc_table + eax*4&#93;, ecx<br />   inc eax<br />   cmp eax, 256<br />   jl .loop<br /><br />   retn<br /><br />; update_crc&#58; Updates a running crc with bytes buf&#91;0..len-1&#93; and returns the crc<br />; Takes 3 parameters, &#40;DWORD crc,LPBYTE buf,DWORD len&#41;<br />; crc&#58; The current crc value<br />; buf&#58; Pointer to the buffer to update crc<br />; len&#58; length of the buffer<br />align 4<br />update_crc&#58;<br />   push ebp<br />   mov ebp, esp<br /><br />; PARAMS<br />%define crc ebp + 8<br />%define buf ebp + 12<br />%define len ebp + 16<br /><br />   push edi<br /><br />   mov eax, &#91;crc&#93;<br />   xor eax, 0xFFFFFFFF<br /><br />   mov edi, &#91;buf&#93;<br />   xor ecx, ecx<br /><br />   cmp &#91;len&#93;, dword 0<br />   je .done<br />.loop&#58;<br />   mov edx, eax<br />   xor edx, &#91;edi + ecx&#93;<br />   and edx, 0xFF<br />   shr eax, 8<br />   xor eax, &#91;crc_table + edx*4&#93;<br /><br />   inc ecx<br />   cmp ecx, &#91;len&#93;<br />   jl .loop<br />.done&#58;<br />   xor eax, 0xFFFFFFFF<br /><br />   pop edi<br /><br />   leave<br />   retn 12<br /><br />segment bss public align=4 use32 class=bss<br /><br />crc_table resd 256<br /></code></pre></div>
    <div class="meta">Posted on 2002-04-05 10:00:37 by JCP</div>
   </div>
   <div class="post" id="post-32513">
    <div class="subject"><a href="#post-32513">Crc32</a></div>
    <div class="body"><pre><code><br />------------------------------------------------------------------<br />eax = tE             &#58; &#91;B2033B77&#93;, 1633 ms &#91;10x2MB&#93;,   12.24 MB/s<br />eax =        379 ticks&#40;!&#41; for table.<br />eax = Thomas1        &#58; &#91;B2033B77&#93;,  140 ms &#91;10x2MB&#93;,  142.85 MB/s<br />eax =       115930 ticks&#40;!&#41; for table.<br />eax = Nico           &#58; &#91;B2033B77&#93;,  190 ms &#91;10x2MB&#93;,  105.26 MB/s<br />eax =       223476 ticks&#40;!&#41; for table.<br />eax = Thomas2        &#58; &#91;B2033B77&#93;,  140 ms &#91;10x2MB&#93;,  142.85 MB/s<br />eax =       81703 ticks&#40;!&#41; for table.<br />eax = Adam Stanislav &#58; &#91;B2033B77&#93;,  191 ms &#91;10x2MB&#93;,  104.71 MB/s<br />eax =        409 ticks&#40;!&#41; for table.<br />eax = Jay            &#58; &#91;B2033B77&#93;,  180 ms &#91;10x2MB&#93;,  111.11 MB/s<br />eax =       467825 ticks&#40;!&#41; for table.<br /></code></pre><br /><br />Thomas</div>
    <div class="meta">Posted on 2002-04-05 10:54:23 by Thomas</div>
   </div>
   <div class="post" id="post-32515">
    <div class="subject"><a href="#post-32515">Crc32</a></div>
    <div class="body"><pre><code><br />proc Nexo_ct uses ebx esi edi<br />	lea	edi,&#91;CRCtable&#93;<br />	xor	ebx,ebx<br />	mov	edx,0EDB88320h<br />@@lp&#58;	mov	eax,ebx<br />	mov	ecx,8<br />@@&#58;	xor	esi,esi<br />	shr	eax,1<br />	cmovc	esi,edx<br />	xor	eax,esi<br />	dec	ecx<br />	jne	@B<br />	mov	&#91;edi&#93;,eax<br />	add	edi,4<br />	inc	bl<br />	jne	@@lp<br />	ret<br />endp<br /><br />macro CRC<br />	movzx edx,al<br />	shr eax,8<br />	xor eax,&#91;edi+4*edx&#93;<br />endm<br /><br />proc Nexo uses esi edi, lpData&#58;DWORD,DataSize&#58;DWORD<br />	mov ecx,&#91;DataSize&#93;<br />	or eax,-1<br />	mov esi,&#91;lpData&#93;<br />	mov edi,offset CRCtable<br />	sub ecx,4<br />	jl @@b<br />@@&#58;	xor eax,&#91;esi&#93;<br />	add esi,4<br />	CRC<br />	CRC<br />	CRC<br />	CRC<br />	sub ecx,4<br />	jge @B<br />@@b&#58;	mov edx,&#91;tblmsk+4*&#40;ecx+4&#41;&#93;<br />	and edx,&#91;esi&#93;<br />	xor eax,edx<br />	lea esi,&#91;esi+4+ecx&#93;<br />	jmp &#91;tblunr+4*&#40;ecx+4&#41;&#93;<br />align 8<br />tblmsk	dd 0,0FFh,0FFFFh,0FFFFFFh<br />u_delta = unr_d-unr<br />tblunr	dd unr+3*u_delta,unr+2*u_delta,unr+1*u_delta,unr<br /><br />unr&#58;	CRC<br />unr_d&#58;	CRC<br />	CRC<br />	not eax<br />	ret<br />endp<br /></code></pre> <br /><br />I have magnified a block size up to 10 Mbytes because very small numbers of a time were gained.<br /><br />Pentium II 400MHz<br /><br /><div class="quote"><br />Thomas1       : [87DD3D07], 2443 ms [10x10MB],   40.93 MB/s      138876 ticks(!) for table.<br />Nico          : [87DD3D07], 3966 ms [10x10MB],   25.21 MB/s      232933 ticks(!) for table.<br />Thomas2       : [87DD3D07], 3956 ms [10x10MB],   25.27 MB/s      138909 ticks(!) for table.<br />Nexo          : [87DD3D07], 2263 ms [10x10MB],   44.18 MB/s      133792 ticks(!) for table.<br /></div><br /><br />Athlon XP 1400MHz<br /><br /><div class="quote"><br />Nico           : [87DD3D07],  704 ms [10x10MB],  142.04 MB/s      247010 ticks(!) for table.<br />Thomas1        : [87DD3D07],  406 ms [10x10MB],  246.30 MB/s      87947 ticks(!) for table.<br />Thomas2        : [87DD3D07],  453 ms [10x10MB],  220.75 MB/s      87758 ticks(!) for table.<br />Adam Stanislav : [87DD3D07],  719 ms [10x10MB],  139.08 MB/s       327 ticks(!) for table.<br />Jay            : [87DD3D07],  562 ms [10x10MB],  177.93 MB/s      254086 ticks(!) for table.<br />Nexo           : [87DD3D07],  406 ms [10x10MB],  246.30 MB/s      87559 ticks(!) for table.<br /></div></div>
    <div class="meta">Posted on 2002-04-05 11:43:41 by Nexo</div>
   </div>
   <div class="post" id="post-32553">
    <div class="subject"><a href="#post-32553">Crc32</a></div>
    <div class="body">Hi !<br /><br />I tried to optimize a bit the Thomas' table generation proc...<br /><br />Here's my new version :<br /><br /><pre><code><br />ThomasReadiosys_ct proc uses ebx esi edi<br />	mov		edi, offset CRCtable - 4<br />	xor		ecx, ecx<br />	<br />	_ml&#58;<br />	mov		eax, ecx<br />	add edi, 4<br />	mov		esi, 8<br />	@@&#58;<br />		shr eax, 1    <br />		sbb edx, edx  <br />		and edx, 0EDB88320h<br />		xor eax, edx<br />	dec	esi<br />	jnz	@B<br />	inc		ecx<br />	mov     &#91;edi&#93;, eax<br />	cmp		ecx, 256<br />	jb		_ml<br />	ret<br />ThomasReadiosys_ct endp<br /></code></pre><br /><br />As you can see, the only change is that edx is &quot;anded&quot; with an immediate value instead of a register... so the line &quot;mov ebx, 0EDB88320h&quot; from the original Thomas' version disappears...<br />It seems to be a little faster because of that...<br /><br /><pre><code><br />Thomas1_ct &#40;test.asm, 18&#41;<br />PROFILECYCLES = 8731 &#40;test.asm, 20&#41;<br />ThomasReadiosys_ct &#40;test.asm, 22&#41;<br />PROFILECYCLES = 7709 &#40;test.asm, 24&#41;<br />Make finished.<br /></code></pre><br /><br />More than 1000 cycles less.<br /><br />I also tested a stosd based version to fill the table but it is slower than the Thomas' original version.<br />I will try to have a closer look after some sleep... ;)<br /><br />PS : The results are from my 1.2 GHz Athlon TB and from the excellent Maverick's PROFILEr... I will try to test it tomorrow on my P4 1.6 GHz Notebook...<br /><br />*EDIT* : It seems to be slower on the P4 than the original Thomas version (~1000 cycles) but faster on my 450 MHz Celeron (~250 cycles).<br /><br />I attach a test package, as the Maverick's tool seems to be more adapted to benchmark the table generation routine.<br /><br />Thanks for your attention and remarks.</div>
    <div class="meta">Posted on 2002-04-05 17:13:19 by JCP</div>
   </div>
   <div class="post" id="post-32554">
    <div class="subject"><a href="#post-32554">Crc32</a></div>
    <div class="body">Nice code Nexo, but:<br /><br />- u can remove add esi,4 from main loop and work with:<br />  xor eax,  ; ecx-&gt; negative value esi-&gt;end of buffer<br /><br />- remove lea esi, </div>
    <div class="meta">Posted on 2002-04-05 17:20:50 by buliaNaza</div>
   </div>
   <div class="post" id="post-32588">
    <div class="subject"><a href="#post-32588">Crc32</a></div>
    <div class="body"><strong>buliaNaza</strong>, I dont remove add esi,4, becouse it will be wrong CRC32 &amp; burst mode off:<br /><span style="font-size:9px><pre><code><br />Nexo          &#58; &#91;87DD3D07&#93;,  406 ms &#91;10x10MB&#93;,  246.30 MB/s      87559 ticks&#40;!&#41; for table.<br />Nexo2         &#58; &#91;0304F8EE&#93;,  594 ms &#91;10x10MB&#93;,  168.35 MB/s      67342 ticks&#40;!&#41; for table.<br /></code></pre></span><br /><br />lea esi,.. was need for pointer on next block ;)<br />It is may be removed here.</div>
    <div class="meta">Posted on 2002-04-06 00:51:22 by Nexo</div>
   </div>
   <div class="post" id="post-32594">
    <div class="subject"><a href="#post-32594">PREFETCH</a></div>
    <div class="body">Nice little boost in speed with prefetch.<br />Don't waste your Athlon - use prefetch. ;)<br />Thanks for the algo, <strong>Nexo</strong>.<pre><code>CRC MACRO<br />	movzx edx,al<br />	shr eax,8<br />	xor eax,&#91;edi+4*edx&#93;<br />ENDM<br /><br />CACHELINE EQU 64<br />DO_LINES EQU 2<br /><br />NexoBit PROC uses esi edi ebx, lpData&#58;DWORD,DataSize&#58;DWORD<br />	mov esi,&#91;lpData&#93;<br />	mov edi,offset CRCtable<br />	mov ebx,&#91;DataSize&#93;<br />	and &#91;DataSize&#93;,3<br />	and ebx,-4<br />	or eax,-1<br />	sub ebx,CACHELINE * DO_LINES<br />	jl j9<br /><br />j1&#58;<br />	add esi,CACHELINE * DO_LINES       ; bytes ahead<br />	mov ecx,0-&#40;CACHELINE*DO_LINES&#41;/4   ; DWORDS<br /><br />	i=0<br />	WHILE i NE DO_LINES<br />		i=i+1<br />		prefetchnta &#91;esi + CACHELINE * &#40;i-DO_LINES+2&#41;&#93;<br />	ENDM<br /><br />j2&#58;	xor eax,&#91;esi+ecx*4&#93;<br />	CRC<br />	CRC<br />	CRC<br />	CRC<br />	inc ecx<br />	jne j2<br /><br />	sub ebx,CACHELINE * DO_LINES<br />	jge j1<br />j9&#58;<br />	add ebx,CACHELINE * DO_LINES<br />	add esi,ebx<br />	sub ecx,ebx<br />	and ebx,0<br />	sar ecx,2<br />	jne j2<br /><br />	mov ecx,&#91;DataSize&#93;<br />	mov edx,&#91;tblmsk + 4*ecx&#93;<br />	and edx,&#91;esi&#93;<br />	xor eax,edx<br />	lea esi,&#91;esi+4+ecx&#93;<br />	jmp &#91;tblunr + 4*ecx&#93;<br />	align 8 ; should be align 64<br />unr&#58;&#58;<br />	CRC<br />unr_d&#58;&#58;<br />	CRC<br />	CRC<br />	not eax<br />	ret<br />.data<br />	align 8 ; should be align 32<br />tblmsk	dd 0,0FFh,0FFFFh,0FFFFFFh<br />u_delta = unr_d-unr<br />tblunr	dd unr+3*u_delta,unr+2*u_delta,unr+1*u_delta,unr<br />.code<br />NexoBit ENDP</code></pre></div>
    <div class="meta">Posted on 2002-04-06 03:13:57 by bitRAKE</div>
   </div>
   <div class="post" id="post-32597">
    <div class="subject"><a href="#post-32597">Crc32</a></div>
    <div class="body"><strong>BitRAKE</strong>, ?refetch here it is useless owing to specificity of looping. You can be convinced of it under the test ;)<br />How many you have received a scoring from prefetch?</div>
    <div class="meta">Posted on 2002-04-06 04:53:48 by Nexo</div>
   </div>
   <div class="post" id="post-32620">
    <div class="subject"><a href="#post-32620">Crc32</a></div>
    <div class="body">Hi Nexo,<br />I say over you can..<pre><code><br />	mov	ebx,&#91;DataSize&#93;<br />	or	eax,-1<br />	mov	esi,&#91;lpData&#93;<br />	mov	edi,offset CRCtable<br />	cmp	ebx,4<br />	jl	@@b<br />	mov	ecx,ebx<br />	and     ecx,-4<br />	add	esi,ecx<br />	sub	ebx,ecx		<br />	neg	ecx<br />@@Loop&#58;<br />	xor	eax,&#91;esi+ecx&#93;<br />	CRC<br />	CRC<br />	CRC<br />	CRC<br />	add	ecx,4<br />	jl	@@Loop<br />@@b&#58;<br />	;test	ebx, ebx<br />	;jz	exit<br />	mov	edx,&#91;tblmsk+4*ebx&#93;<br />	and	edx,&#91;esi&#93;<br />	xor	eax,edx<br />	jmp	&#91;tblunr+4*ebx&#93;<br />align 8<br />tblmsk  dd 0, 0FFh, 0FFFFh, 0FFFFFFh<br />u_delta = unr_d-unr<br />tblunr  dd unr+3*u_delta, unr+2*u_delta, unr+1*u_delta, unr<br /><br />	unr&#58;	CRC<br />	unr_d&#58;	CRC<br />		CRC<br />        ;exit&#58;<br />		not eax<br />		ret</code></pre></div>
    <div class="meta">Posted on 2002-04-06 10:10:30 by buliaNaza</div>
   </div>
   <div class="post" id="post-32624">
    <div class="subject"><a href="#post-32624">Crc32</a></div>
    <div class="body">Pentium 4 1400MHz<br /><pre><code>&#91;size=9&#93;<br />Nico           &#58; &#91;F3032BB4&#93;, 1021 ms &#91;10x10MB&#93;,   97.94 MB/s      493776 ticks&#40;!&#41; for table.<br />Thomas1        &#58; &#91;F3032BB4&#93;,  501 ms &#91;10x10MB&#93;,  199.60 MB/s      239124 ticks&#40;!&#41; for table.<br />Thomas2        &#58; &#91;F3032BB4&#93;,  470 ms &#91;10x10MB&#93;,  212.76 MB/s      238784 ticks&#40;!&#41; for table.<br />Adam Stanislav &#58; &#91;F3032BB4&#93;,  761 ms &#91;10x10MB&#93;,  131.40 MB/s       268 ticks&#40;!&#41; for table.<br />Jay            &#58; &#91;F3032BB4&#93;,  711 ms &#91;10x10MB&#93;,  140.64 MB/s      472528 ticks&#40;!&#41; for table.<br />Nexo           &#58; &#91;F3032BB4&#93;,  501 ms &#91;10x10MB&#93;,  199.60 MB/s      182564 ticks&#40;!&#41; for table.<br />NexoBit        &#58; &#91;F3032BB4&#93;,  511 ms &#91;10x10MB&#93;,  195.69 MB/s      183100 ticks&#40;!&#41; for table.<br />&#91;/SIZE&#93;</code></pre></div>
    <div class="meta">Posted on 2002-04-06 11:11:31 by Nexo</div>
   </div>
   <div class="post" id="post-32625">
    <div class="subject"><a href="#post-32625">Crc32</a></div>
    <div class="body">Maybe, there is something wrong with my machine?<pre><code>eax = Nexo           &#58; &#91;88ABBE8A&#93;,  842 ms &#91;64x2MB&#93;,  152.01 MB/s<br />eax = NexoBit        &#58; &#91;88ABBE8A&#93;,  571 ms &#91;64x2MB&#93;,  224.16 MB/s<br /><br />eax = Nexo           &#58; &#91;88ABBE8A&#93;, 3294 ms &#91;256x2MB&#93;,  155.43 MB/s<br />eax = NexoBit        &#58; &#91;88ABBE8A&#93;, 2203 ms &#91;256x2MB&#93;,  232.41 MB/s<br />eax = NexoBit        &#58; &#91;88ABBE8A&#93;, 2203 ms &#91;256x2MB&#93;,  232.41 MB/s<br />eax = NexoBit        &#58; &#91;88ABBE8A&#93;, 2203 ms &#91;256x2MB&#93;,  232.41 MB/s</code></pre>Athlon TB 1333, P4 sucks :)</div>
    <div class="meta">Posted on 2002-04-06 11:13:41 by bitRAKE</div>
   </div>
   <div class="post" id="post-32632">
    <div class="subject"><a href="#post-32632">Crc32</a></div>
    <div class="body">Hi, <strong>buliaNaza</strong>. The code became longer, speed the same.<br />Here even prefetch does not help.<br />Complete stupor of the processor on dependences.</div>
    <div class="meta">Posted on 2002-04-06 11:58:27 by Nexo</div>
   </div>
   <div class="post" id="post-32633">
    <div class="subject"><a href="#post-32633">Crc32</a></div>
    <div class="body"><strong>BitRAKE</strong>, I have put same 64x2Mb parameters.<br /><pre><code><br />Thomas1        &#58; &#91;7E2CDFAB&#93;,  531 ms &#91;64x2MB&#93;,  241.05 MB/s<br />Thomas2        &#58; &#91;7E2CDFAB&#93;,  594 ms &#91;64x2MB&#93;,  215.48 MB/s<br />Adam Stanislav &#58; &#91;7E2CDFAB&#93;,  922 ms &#91;64x2MB&#93;,  138.82 MB/s<br />Jay            &#58; &#91;7E2CDFAB&#93;,  734 ms &#91;64x2MB&#93;,  174.38 MB/s<br />Nexo           &#58; &#91;7E2CDFAB&#93;,  531 ms &#91;64x2MB&#93;,  241.05 MB/s<br />NexoBit        &#58; &#91;7E2CDFAB&#93;,  532 ms &#91;64x2MB&#93;,  240.60 MB/s<br /></code></pre><br /><br /><pre><code><br />Thomas1        &#58; &#91;7E2CDFAB&#93;, 2172 ms &#91;256x2MB&#93;,  235.72 MB/s<br />Thomas2        &#58; &#91;7E2CDFAB&#93;, 2328 ms &#91;256x2MB&#93;,  219.93 MB/s<br />Adam Stanislav &#58; &#91;7E2CDFAB&#93;, 3735 ms &#91;256x2MB&#93;,  137.08 MB/s<br />Jay            &#58; &#91;7E2CDFAB&#93;, 2985 ms &#91;256x2MB&#93;,  171.52 MB/s<br />Nexo           &#58; &#91;7E2CDFAB&#93;, 2203 ms &#91;256x2MB&#93;,  232.41 MB/s<br />NexoBit        &#58; &#91;7E2CDFAB&#93;, 2203 ms &#91;256x2MB&#93;,  232.41 MB/s</code></pre></div>
    <div class="meta">Posted on 2002-04-06 12:01:48 by Nexo</div>
   </div>
   <div class="post" id="post-32634">
    <div class="subject"><a href="#post-32634">Crc32</a></div>
    <div class="body">I understand what your say <strong>Nexo</strong>, but as the processor speed increases, this does not matter - the memory latency will put an upper limit on the algo.  I agree that prefetch is not a big plus here, but it helps.  Yes, the DDR memory matches the processor speed, but try it on a 2.2Ghz XP with DDR - the difference will be more appearant.  My only tests have been on an Athlon, but I feel the same argument would hold for faster P$'s.</div>
    <div class="meta">Posted on 2002-04-06 12:08:41 by bitRAKE</div>
   </div>
   <div class="post" id="post-32635">
    <div class="subject"><a href="#post-32635">Crc32</a></div>
    <div class="body">Why is CRC32 to wonderful anyhow?  I've seen other checksum algos that work just fine and are only a few lines of code.  CRC seems like overkill to me.<br /><br />The point is to generate a unique signature from a block of data, right?  I can think of about 20 different ways to do that that isn't so cumbersome.<br /><br />Maybe I have the wrong ideas about CRC.  Somebody enlighten me please :D</div>
    <div class="meta">Posted on 2002-04-06 12:09:25 by iblis</div>
   </div>
   <div class="post" id="post-32647">
    <div class="subject"><a href="#post-32647">Crc32</a></div>
    <div class="body"><div class="quote"><strong>I understand what your say <strong>Nexo</strong>, but as the processor speed increases, this does not matter - the memory latency will put an upper limit on the algo.  I agree that prefetch is not a big plus here, but it helps.</div><br />Correctly you think :)<br /><div class="quote"><strong>Yes, the DDR memory matches the processor speed, but try it on a 2.2Ghz XP with DDR - the difference will be more appearant.</div><br />While there is no possibility to test XP 2200+ (1800MHz). On the other hand, if the code of cycle worked more slowly the difference should be more? Try it:<br /><pre><code><br />CRC macro<br />push ebp<br />REPT 11<br />imul ebp,9999999<br />ENDM<br />pop ebp<br />	movzx edx,al<br />	shr eax,8<br />	xor eax,&#91;CRCtable+4*edx&#93;<br />endm<br /><br />Nexo           &#58; &#91;7E2CDFAB&#93;, 16640 ms &#91;256x2MB&#93;,   30.76 MB/s<br />NexoBit        &#58; &#91;7E2CDFAB&#93;, 17329 ms &#91;256x2MB&#93;,   29.54 MB/s<br /></code></pre><br />I somewhere wander? ;)<br /><br /><div class="quote"><strong><br />My only tests have been on an Athlon, but I feel the same argument would hold for faster P$'s.</div><br />The Pentium 4 has hardware prefetch. The tested Pentium 4 had DDR333 ;)<br />I tested on XP 1533MHz, but the trend has remained the same :(<br />Where here 10 GHz processers? :)</div>
    <div class="meta">Posted on 2002-04-06 15:06:29 by Nexo</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=4628&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=4628&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="4628" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=4628&amp;page=2">&gt;</a><a href="../?id=4628&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>