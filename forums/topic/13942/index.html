<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Problems using COM methods - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13942" />
    <link rel="next" href="../?id=13942&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=13942">Problems using COM methods</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=13942&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=13942&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="13942" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=13942&amp;page=2">&gt;</a><a href="../?id=13942&amp;page=2">&raquo;</a></form>   <div class="post" id="post-107760">
    <div class="subject"><a href="#post-107760">Problems using COM methods</a></div>
    <div class="body">This is my first attempt to use COM. I am trying to use COM functions in a  DLL made by someone else. I wrote the code below just for testing, it should just display an aboutbox of the DLL: <br /><br />invoke CoInitialize,NULL<br />invoke CoCreateInstance,addr CLSID_IfcServer,NULL,CLSCTX_INPROC_SERVER,addr IID_IIfcServer,addr pIfcServer<br />coinvoke pIfcServer,IIfcServer,About<br />invoke CoUninitialize<br />		<br />The CoCreateInstance seems to be working.  However, the coinvoke crashes the program. My guess is that i am just passing a wrong argument somewhere or have some other simple error, i just can't find it. <br /><br />I traced the coinvoke part with a debugger and it compiles to this:<br />mov edx,<br />mov edx,<br />push dword ptr <br />call ;this will screw things up (points to totally wrong address?)<br /><br />I have the following defined in .data section:<br /><br />DeclareGuid CLSID_IfcServer<br />DeclareGuid IID_IIfcServer<br />pIfcServer dword 0<br /><br /><br />I made an INC file from the appropriate TLB file with Tlb2Inc.exe. This is the relevent part of it:<br /><br />;CoClass : IfcServer<br />;~~~~~~~~~~~~~~~~~<br />;{0D2BA2E1-6CE5-11D3-A74D-00104BF20ED3}<br />sCLSID_IfcServer TEXTEQU &lt;{00D2BA2E1H, 06CE5H, 011D3H, {0A7H, 04DH, 000H, 010H, 04BH, 0F2H, 00EH, 0D3H}}&gt;<br /><br />;DispInterface : IIfcServer<br />;~~~~~~~~~~~~~~~~~~~~~~<br />;{0D2BA2E0-6CE5-11D3-A74D-00104BF20ED3}<br />sIID_IIfcServer TEXTEQU &lt;{00D2BA2E0H, 06CE5H, 011D3H, {0A7H, 04DH, 000H, 010H, 04BH, 0F2H, 00EH, 0D3H}}&gt;<br /><br />IIfcServer_GetSpacesProto typedef proto IIfcServer_GetSpacesProto :DWORD<br />IIfcServer_ReadIfcFileProto typedef proto IIfcServer_ReadIfcFileProto :DWORD,:DWORD<br />IIfcServer_ReadIfcHeaderProto typedef proto IIfcServer_ReadIfcHeaderProto :DWORD,:DWORD<br />IIfcServer_GetWallsProto typedef proto IIfcServer_GetWallsProto :DWORD<br />IIfcServer_GetProjectProto typedef proto IIfcServer_GetProjectProto :DWORD<br />IIfcServer_SaveIfcFileProto typedef proto IIfcServer_SaveIfcFileProto :DWORD<br />IIfcServer_GetLastErrorMessageProto typedef proto IIfcServer_GetLastErrorMessageProto :DWORD<br />IIfcServer_FindSpaceProto typedef proto IIfcServer_FindSpaceProto :DWORD,:REAL8,:REAL8<br />IIfcServer_AboutProto typedef proto IIfcServer_AboutProto :DWORD<br />IIfcServer_GetObjectProto typedef proto IIfcServer_GetObjectProto :DWORD,:DWORD<br />IIfcServer_GetPreferenceProto typedef proto IIfcServer_GetPreferenceProto :DWORD<br />IIfcServer_CreateNewProxyProto typedef proto IIfcServer_CreateNewProxyProto :DWORD<br />IIfcServer_GetBuildingStoreysProto typedef proto IIfcServer_GetBuildingStoreysProto :DWORD<br />IIfcServer_CreateSimplifiedGeometryProto typedef proto IIfcServer_CreateSimplifiedGeometryProto :DWORD,:DWORD<br />IIfcServer_GetBuildingPartsBetweenSpacesProto typedef proto IIfcServer_GetBuildingPartsBetweenSpacesProto :DWORD,:DWORD,:DWORD<br />IIfcServer_CreateNewTableProto typedef proto IIfcServer_CreateNewTableProto :DWORD<br />IIfcServer_GetTablesProto typedef proto IIfcServer_GetTablesProto :DWORD<br />IIfcServer_GetIfcSchemaProto typedef proto IIfcServer_GetIfcSchemaProto :DWORD<br /><br />IIfcServer_GetSpacesVal typedef ptr IIfcServer_GetSpacesProto<br />IIfcServer_ReadIfcFileVal typedef ptr IIfcServer_ReadIfcFileProto<br />IIfcServer_ReadIfcHeaderVal typedef ptr IIfcServer_ReadIfcHeaderProto<br />IIfcServer_GetWallsVal typedef ptr IIfcServer_GetWallsProto<br />IIfcServer_GetProjectVal typedef ptr IIfcServer_GetProjectProto<br />IIfcServer_SaveIfcFileVal typedef ptr IIfcServer_SaveIfcFileProto<br />IIfcServer_GetLastErrorMessageVal typedef ptr IIfcServer_GetLastErrorMessageProto<br />IIfcServer_FindSpaceVal typedef ptr IIfcServer_FindSpaceProto<br />IIfcServer_AboutVal typedef ptr IIfcServer_AboutProto<br />IIfcServer_GetObjectVal typedef ptr IIfcServer_GetObjectProto<br />IIfcServer_GetPreferenceVal typedef ptr IIfcServer_GetPreferenceProto<br />IIfcServer_CreateNewProxyVal typedef ptr IIfcServer_CreateNewProxyProto<br />IIfcServer_GetBuildingStoreysVal typedef ptr IIfcServer_GetBuildingStoreysProto<br />IIfcServer_CreateSimplifiedGeometryVal typedef ptr IIfcServer_CreateSimplifiedGeometryProto<br />IIfcServer_GetBuildingPartsBetweenSpacesVal typedef ptr IIfcServer_GetBuildingPartsBetweenSpacesProto<br />IIfcServer_CreateNewTableVal typedef ptr IIfcServer_CreateNewTableProto<br />IIfcServer_GetTablesVal typedef ptr IIfcServer_GetTablesProto<br />IIfcServer_GetIfcSchemaVal typedef ptr IIfcServer_GetIfcSchemaProto<br /><br />  _vtIIfcServer MACRO CastName:REQ<br />  ; IDispatch methods<br />  _vtIDispatch CastName<br />  ; IIfcServer methods<br />  &amp;CastName&amp;_GetSpaces IIfcServer_GetSpacesVal ?<br />  &amp;CastName&amp;_ReadIfcFile IIfcServer_ReadIfcFileVal ?<br />  &amp;CastName&amp;_ReadIfcHeader IIfcServer_ReadIfcHeaderVal ?<br />  &amp;CastName&amp;_GetWalls IIfcServer_GetWallsVal ?<br />  &amp;CastName&amp;_GetProject IIfcServer_GetProjectVal ?<br />  &amp;CastName&amp;_SaveIfcFile IIfcServer_SaveIfcFileVal ?<br />  &amp;CastName&amp;_GetLastErrorMessage IIfcServer_GetLastErrorMessageVal ?<br />  &amp;CastName&amp;_FindSpace IIfcServer_FindSpaceVal ?<br />  &amp;CastName&amp;_About IIfcServer_AboutVal ?<br />  &amp;CastName&amp;_GetObject IIfcServer_GetObjectVal ?<br />  &amp;CastName&amp;_GetPreference IIfcServer_GetPreferenceVal ?<br />  &amp;CastName&amp;_CreateNewProxy IIfcServer_CreateNewProxyVal ?<br />  &amp;CastName&amp;_GetBuildingStoreys IIfcServer_GetBuildingStoreysVal ?<br />  &amp;CastName&amp;_CreateSimplifiedGeometry IIfcServer_CreateSimplifiedGeometryVal ?<br />  &amp;CastName&amp;_GetBuildingPartsBetweenSpaces IIfcServer_GetBuildingPartsBetweenSpacesVal ?<br />  &amp;CastName&amp;_CreateNewTable IIfcServer_CreateNewTableVal ?<br />  &amp;CastName&amp;_GetTables IIfcServer_GetTablesVal ?<br />  &amp;CastName&amp;_GetIfcSchema IIfcServer_GetIfcSchemaVal ?<br /><br />ENDM<br /><br />IIfcServer STRUCT<br />  _vtIIfcServer IIfcServer<br />IIfcServer ENDS  <br /><br /><br />Thanks for any help.</div>
    <div class="meta">Posted on 2003-06-20 17:28:53 by Janne</div>
   </div>
   <div class="post" id="post-107770">
    <div class="subject"><a href="#post-107770">Problems using COM methods</a></div>
    <div class="body">Hi Janne<br /><br />code looks good, cant see any error. Are you sure CoCreateInstance returns S_OK (=0)?<br /><br />since this server uses typeinfo, you also may use <a target="_blank" href="http://www.japheth.de/download/comview.zip">comview</a> to test it (comview uses IDispatch::Invoke to call methods, not vtable calls, but vtable will be shown).<br /><br />japheth</div>
    <div class="meta">Posted on 2003-06-21 00:52:51 by japheth</div>
   </div>
   <div class="post" id="post-107776">
    <div class="subject"><a href="#post-107776">Problems using COM methods</a></div>
    <div class="body">Thanks, Japheth<br /><br />The CoCreateInstance does return 0. <br /><br />When I use Comview's &quot;Create Instance&quot; it shows two interfaces, Iunknown and IDispatch. When i select IDispatch and &quot;View VTable&quot;, it displays entries 0 - 6. Now im kinda confused because i don't know <br /><br />- what is the purpose of IDispatch interface<br />- what are the methods of IDispatch <br />- where is the IIfcServer interface and its methods</div>
    <div class="meta">Posted on 2003-06-21 02:37:32 by Janne</div>
   </div>
   <div class="post" id="post-107809">
    <div class="subject"><a href="#post-107809">Problems using COM methods</a></div>
    <div class="body">IDispatch is the root interface of Automation, or any program that accepts late binfing for scripting. Your IIfcServer interface inherits from it.<br /><br />I've never used Comview, so I couldn't tell you if it is properly reporting the interface or just up chucking some bug.<br /><br />what I do see in the definition you have for IIfcServer looks wrong. It lacks any parameters, and every method has at least one (the THIS parameter). This is the part with the &amp;castname&amp; prefix, and you don't need the typedef protos. <br /><br />The code section starting with &quot;_vtIIfcServer MACRO CastName:REQ&quot; creates a structure for the interface definitions, without any methods there all bets are off (If you're using my colib stuff then coinvoke is looking for the wrong count of parameters)<br /><br />Just for a giggle, try something simple with the interface that HAS to work, like a paired AddRef and Release, or even Queryinterface it for IIfcServer.<br /><br /><br />Good luck</div>
    <div class="meta">Posted on 2003-06-21 09:51:51 by Ernie</div>
   </div>
   <div class="post" id="post-107813">
    <div class="subject"><a href="#post-107813">Problems using COM methods</a></div>
    <div class="body">Hi Janne<br /><br />Comview will scan an object for interfaces it founds in HKEY_CLASSES_ROOT\Interface. For automation objects like your dll, the interface inheriting from IDispatch should be inserted there with its IID (00D2BA2E0H, 06CE5H, 011D3H, ...). If it is not, comview will not show it (same behaviour as OLEView).<br /><br />So if this interface isnt shown, something is wrong, perhabs type library isnt registered properly<br /><br />Ernie<br /><br />what I see from Jannes first post<br />&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />mov edx,<br />mov edx,<br />push dword ptr <br />call ;this will screw things up (points to totally wrong address?)<br />&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />is that the called method HAS this pointer, so its possibly not the problem<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-06-21 10:45:37 by japheth</div>
   </div>
   <div class="post" id="post-107816">
    <div class="subject"><a href="#post-107816">Problems using COM methods</a></div>
    <div class="body">Thanks for the replies.<br /><br />Japheth, you guessed right, the typelib was'nt registered, so i used Comview to register it. Now both Comview and oleview display also the IIfcServer interface. <br /><br />However, the problem still remains, the program crashes. <br /><br />Looking with Comview, i see that IIfcServer and IDispatch Vtables are identical. Maybe IIfcServer is a &quot;dispatchonly&quot; interface? Is there any sure way checking if this is the case? <br /><br />Ernie, i tested the AddRef / Release,they seem to be working. AddRef returned 2, Release returned 1.</div>
    <div class="meta">Posted on 2003-06-21 12:10:40 by Janne</div>
   </div>
   <div class="post" id="post-107851">
    <div class="subject"><a href="#post-107851">Problems using COM methods</a></div>
    <div class="body">Janne,<br /><br />to check if methods may be called via vtable open type library with comview, the interface typeinfo should be marked as DUAL and all methods should have a vtable offset.<br />But since comview doesn't show any differences between IIfcServer and IDispatch, I guess there is a problem. vtable of IIfcServer should contain all methods (with its names, not just numbers) if it is a real dual interface.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-06-22 01:14:44 by japheth</div>
   </div>
   <div class="post" id="post-107884">
    <div class="subject"><a href="#post-107884">Problems using COM methods</a></div>
    <div class="body">Hi again,<br /><br />i attached an image about what Comview tells about the typelib.<br /><br />I thought i'd try to access the methods with IDispatch::Invoke. Then i saw that Comview can help in that, too. So i used Comviews &quot;create dispatch helper&quot; function and included also the .inc files that come with Comview. Then i commented out my own COM related code and tried to build the project.<br /><br />I'm using masm32v8, so after i replaced windows.inc 1.25e with 1.25a i got the project to assemble. But the link keeps giving me the error <br /><br />error LNK2001: unresolved external symbol _GUID_NULL<br /><br />I tried to build using several different versions of uuid.lib, but the error is always the same. Any ideas?</div>
    <div class="meta">Posted on 2003-06-22 09:33:53 by Janne</div>
   </div>
   <div class="post" id="post-107904">
    <div class="subject"><a href="#post-107904">Problems using COM methods</a></div>
    <div class="body">Hi Janne,<br /><br />for some problems (and workaround) with MASM32 V8 look <a target="_blank" href="http://www.japheth.de/masm32.html">here</a><br /><br />An excerpt from WebBrowserApp MAP file shows:<br /><br /> 0002:00000058       __imp__CoInitialize@4      00402058     ole32:ole32.dll<br /> 0002:0000005c       __imp__CoCreateInstance@20 0040205c     ole32:ole32.dll<br /> 0002:00000060       __imp__CLSIDFromProgID@8   00402060     ole32:ole32.dll<br /> 0002:00000064       \177ole32_NULL_THUNK_DATA  00402064     ole32:ole32.dll<br /> 0002:000001d0       _GUID_NULL                 004021d0     uuid:cguid_i_guid0.obj<br /> 0002:000001e0       _IID_IUnknown              004021e0     uuid:unknwn_i_guid0.obj<br /> 0002:000001f0       _IID_IDispatch             004021f0     uuid:oaidl_i_guid4.obj<br /> 0002:00000200       _IID_IConnectionPointContainer 00402200     uuid:ocidl_i_guid3.obj<br /> 0002:00000210       __IMPORT_DESCRIPTOR_KERNEL32 00402210     kernel32:KERNEL32.dll<br /> 0002:00000224       __IMPORT_DESCRIPTOR_USER32 00402224     user32:USER32.dll<br /> 0002:00000238       __IMPORT_DESCRIPTOR_ole32  00402238     ole32:ole32.dll<br /> 0002:0000024c       __IMPORT_DESCRIPTOR_OLEAUT32 0040224c     oleaut32:OLEAUT32.dll<br /> 0002:00000260       __NULL_IMPORT_DESCRIPTOR   00402260     kernel32:KERNEL32.dll<br /><br />so GUID_NULL should be defined in UUID.LIB, but you may define it at your own, presumably<br />its just the same as IID_NULL, that are 16 NULL bytes.</div>
    <div class="meta">Posted on 2003-06-22 13:14:54 by japheth</div>
   </div>
   <div class="post" id="post-107922">
    <div class="subject"><a href="#post-107922">Problems using COM methods</a></div>
    <div class="body">After i added to .data<br /><br />GUID_NULL GUID {000000000H,00000H,00000H,{000H,000H,000H,000H,000H,000H,000H,000H}}<br /><br />the project links just fine. My COM test code works too, now using IDispatch:<br /><br />invoke CoCreateInstance,addr CLSID_IfcServer,NULL,CLSCTX_INPROC_SERVER,addr IID_IIfcServer, addr pIfcServer<br /><br />invoke dm(pIfcServer,IIfcServer,About)<br /><br />So Japheth, thanks a lot for your help and making the Comview, which is a great tool for this COM stuff.</div>
    <div class="meta">Posted on 2003-06-22 17:07:30 by Janne</div>
   </div>
   <div class="post" id="post-108946">
    <div class="subject"><a href="#post-108946">Problems using COM methods</a></div>
    <div class="body">Yet another question, i'm still dealing with the same DLL.<br /><br />For example, this is in the asm include created by Comview:<br /><br />;--- IIfcSpace, Type=DISPATCH, GUID={0D2BA2E3-6CE5-11D3-A74D-00104BF20ED3}<br /><br />;DISPID_Code	EQU	01h<br />;DISPID_Name	EQU	02h<br />;DISPID_Type	EQU	03h<br />;DISPID_Area	EQU	04h<br />;DISPID_Volume	EQU	05h<br />;DISPID_Perimeter	EQU	06h<br />;DISPID_VentilationAirFlowrate	EQU	07h<br />;DISPID_TotalHeatGain	EQU	08h<br />;DISPID_TotalHeatLoss	EQU	09h<br />;DISPID_HeatingDesignTemperature	EQU	0Ah<br />;DISPID_CoolingDesignTemperature	EQU	0Bh<br />;DISPID_ExhaustAirFlowrate	EQU	0Ch<br /><br />;--- dispinterface only<br />ifndef IIfcSpaceVtbl<br />BEGIN_INTERFACE IIfcSpace, IDispatch<br />	DISPMETHOD	GetGUID	, :ptr BSTR<br />	DISPMETHOD	GetBorder	, :ptr LPDISPATCH<br />	DISPMETHOD	GetInstance	, :ptr SDWORD<br />	DISPMETHOD	GetWalls	, :ptr LPDISPATCH<br />	DISPMETHOD	GetAdjacentSpaces	, :ptr LPDISPATCH<br />	DISPMETHOD	GetOwnerHistory	, :ptr LPDISPATCH<br />	DISPMETHOD	GetAxis2Placement3d	, :ptr LPDISPATCH<br />	DISPMETHOD	GetFloor	, :ptr LPDISPATCH<br />	DISPMETHOD	GetRoofSlab	, :ptr LPDISPATCH<br />END_INTERFACE<br />endif<br /><br />sIID_IIfcSpace textequ &lt;IID {00D2BA2E3h,06CE5h,011D3h,{0A7h,04Dh,000h,010h,04Bh,0F2h,00Eh,0D3h}}&gt;<br /><br /><br />and this in the Dispatch helper<br /><br />;--- IIfcSpace, Type=DISPATCH, GUID={0D2BA2E3-6CE5-11D3-A74D-00104BF20ED3}<br /><br />	DEFINE_DISPMETHOD	IIfcSpace , GetGUID, 0Dh, METHOD, VT_BSTR<br />	DEFINE_DISPMETHOD	IIfcSpace , GetBorder, 0Eh, METHOD, VT_DISPATCH<br />	DEFINE_DISPMETHOD	IIfcSpace , GetInstance, 0Fh, METHOD, VT_I4<br />	DEFINE_DISPMETHOD	IIfcSpace , GetWalls, 010h, METHOD, VT_DISPATCH<br />	DEFINE_DISPMETHOD	IIfcSpace , GetAdjacentSpaces, 011h, METHOD, VT_DISPATCH<br />	DEFINE_DISPMETHOD	IIfcSpace , GetOwnerHistory, 012h, METHOD, VT_DISPATCH<br />	DEFINE_DISPMETHOD	IIfcSpace , GetAxis2Placement3d, 013h, METHOD, VT_DISPATCH<br />	DEFINE_DISPMETHOD	IIfcSpace , GetFloor, 014h, METHOD, VT_DISPATCH<br />	DEFINE_DISPMETHOD	IIfcSpace , GetRoofSlab, 015h, METHOD, VT_DISPATCH<br /><br /><br />so, if i got it right, the dispatch macros in Comview includes work with methods only? Not when getting / setting properties (Code, Name etc for this interface)?</div>
    <div class="meta">Posted on 2003-07-01 17:04:22 by Janne</div>
   </div>
   <div class="post" id="post-108986">
    <div class="subject"><a href="#post-108986">Problems using COM methods</a></div>
    <div class="body"><div class="quote">so, if i got it right, the dispatch macros in Comview includes work with methods only? Not when getting / setting properties (Code, Name etc for this interface)?</div> <br /><br />I've never used Comview, but in gereral a property is actually just a method.<br /><br />VB established the concept of an object having both methods and properties to make it easier on the developer to keep re-use an object, but a property to VB is implimented in COM by having a pair of methods to get and set some property (or just one or the other, example a read only property only had a get method).<br /><br />So properties are really methods.</div>
    <div class="meta">Posted on 2003-07-02 00:00:25 by Ernie</div>
   </div>
   <div class="post" id="post-108989">
    <div class="subject"><a href="#post-108989">Problems using COM methods</a></div>
    <div class="body">If I remember correctly, comview should add prefixes &quot;get_&quot; and &quot;put_&quot; to PROPERTY_GET and PROPERTY_PUT &quot;methods&quot; names. Thats the whole difference.<br /><br />So theres an excerpt of an interface with properties created by comview<br /><br /><pre><code><br />	DEFINE_DISPMETHOD	IAsmClass , put_Value, 00h, PROPERTYPUT, , VT_I4<br />	DEFINE_DISPMETHOD	IAsmClass , get_Value, 00h, PROPERTYGET, VT_I4<br />	DEFINE_DISPMETHOD	IAsmClass , Raise, 01h, METHOD, , VT_USERDEFINED,VT_BYREF OR VT_VARIANT,VT_VARIANT,VT_I4<br />	DEFINE_DISPMETHOD	IAsmClass , put_ForeColor, 0FFFFFDFFh, PROPERTYPUT, , VT_USERDEFINED<br />	DEFINE_DISPMETHOD	IAsmClass , get_ForeColor, 0FFFFFDFFh, PROPERTYGET, VT_USERDEFINED<br />	DEFINE_DISPMETHOD	IAsmClass , put_BackColor, 0FFFFFE0Bh, PROPERTYPUT, , VT_USERDEFINED<br />	DEFINE_DISPMETHOD	IAsmClass , get_BackColor, 0FFFFFE0Bh, PROPERTYGET, VT_USERDEFINED<br />	DEFINE_DISPMETHOD	IAsmClass , put_ClientEdge, 02h, PROPERTYPUT, , VT_I2<br />	DEFINE_DISPMETHOD	IAsmClass , get_ClientEdge, 02h, PROPERTYGET, VT_I2<br />	DEFINE_DISPMETHOD	IAsmClass , AboutBox, 0FFFFFDD8h, METHOD, <br /></code></pre></div>
    <div class="meta">Posted on 2003-07-02 01:24:01 by japheth</div>
   </div>
   <div class="post" id="post-109053">
    <div class="subject"><a href="#post-109053">Problems using COM methods</a></div>
    <div class="body">For some reason, Comview did not create in Dispatch helper the lines for any of the properties, just for the methods. But when i add the lines there manually, for example<br /><br />DEFINE_DISPMETHOD	IIfcSpace , get_Code, 01h, PROPERTYGET, VT_BSTR<br /><br />getting a property with<br /><br />invoke dm(pSpace,IIfcSpace,get_Code),addr Code<br /><br />works OK.</div>
    <div class="meta">Posted on 2003-07-02 13:55:52 by Janne</div>
   </div>
   <div class="post" id="post-109080">
    <div class="subject"><a href="#post-109080">Problems using COM methods</a></div>
    <div class="body">Check your preferences in the ComView tool.   I remember a while ago i had something similar until Japheth pointed out there is check box options to filter out some conversions.<br /><br />Hope it helps (didnt read the entire thread thru)<br />:NaN:</div>
    <div class="meta">Posted on 2003-07-02 17:10:13 by NaN</div>
   </div>
   <div class="post" id="post-109124">
    <div class="subject"><a href="#post-109124">Problems using COM methods</a></div>
    <div class="body">Janne,<br /><br />thats possibly an error. I will check this.<br /><br />&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br /><br />Just checked it with excel typelib, dispinterface Style:<br /><br />;--- Style, Type=DISPATCH, GUID={00020852-0000-0000-C000-000000000046}<br /><br />	DEFINE_DISPMETHOD	Style , get_Application, 094h, PROPERTYGET, VT_BYREF OR VT_USERDEFINED<br />	DEFINE_DISPMETHOD	Style , get_Creator, 095h, PROPERTYGET, VT_USERDEFINED<br />	DEFINE_DISPMETHOD	Style , get_Parent, 096h, PROPERTYGET, VT_DISPATCH<br />	DEFINE_DISPMETHOD	Style , get_AddIndent, 0427h, PROPERTYGET, VT_BOOL<br />	DEFINE_DISPMETHOD	Style , put_AddIndent, 0427h, PROPERTYPUT, , VT_BOOL<br />	DEFINE_DISPMETHOD	Style , get_BuiltIn, 0229h, PROPERTYGET, VT_BOOL<br />	DEFINE_DISPMETHOD	Style , get_Borders, 01B3h, PROPERTYGET, VT_BYREF OR VT_USERDEFINED<br />	DEFINE_DISPMETHOD	Style , Delete, 075h, METHOD, VT_VARIANT<br />	DEFINE_DISPMETHOD	Style , get_Font, 092h, PROPERTYGET, VT_BYREF OR VT_USERDEFINED<br /><br />Seems to work as it should. So the error reported by Janne looks mysterious to me.<br /><br />Janne, please post your .TLB file (if its not too big, else email it).</div>
    <div class="meta">Posted on 2003-07-03 01:44:01 by japheth</div>
   </div>
   <div class="post" id="post-109127">
    <div class="subject"><a href="#post-109127">Problems using COM methods</a></div>
    <div class="body">here's the TLB</div>
    <div class="meta">Posted on 2003-07-03 02:29:21 by Janne</div>
   </div>
   <div class="post" id="post-109132">
    <div class="subject"><a href="#post-109132">Problems using COM methods</a></div>
    <div class="body">Thanks Janne,<br /><br />I see the problem now. Properties of these interfaces are implemented as variables, not functions, which is pretty rare.<br /><br />I changed comview to support this case and it may be downloaded <a target="_blank" href="http://www.japheth.de/download/comview210.zip">from here</a>.<br />Its a preliminary version, please tell about any problems arising.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-07-03 05:22:49 by japheth</div>
   </div>
   <div class="post" id="post-109140">
    <div class="subject"><a href="#post-109140">Problems using COM methods</a></div>
    <div class="body">Hi,<br />now the PROPERTYGETs seem to be OK, but the PROPERTYPUTs are still missing?</div>
    <div class="meta">Posted on 2003-07-03 06:57:50 by Janne</div>
   </div>
   <div class="post" id="post-109142">
    <div class="subject"><a href="#post-109142">Problems using COM methods</a></div>
    <div class="body">Just updated, now PROPPUTs should be there as well. Use link above.</div>
    <div class="meta">Posted on 2003-07-03 08:11:52 by japheth</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=13942&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=13942&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="13942" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=13942&amp;page=2">&gt;</a><a href="../?id=13942&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>