<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Noob question about USB devices - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20852" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=20852">Noob question about USB devices</a></p>
   <div class="post" id="post-158508">
    <div class="subject"><a href="#post-158508">Noob question about USB devices</a></div>
    <div class="body">Hi Everybody. <br /><br />I&#39;m new to Win32asm programming but did a bit of Tasm many moons ago. Anyhow, I am learning Win32asm though Iczelion&#39;s great set of tutorials and have got to the part about creating and handling files. To experiment with this I wrote a little app to copy a file to a USB pen drive. On my PC the pen drive always mounts as the same letter, so my program copies the file from one drive to the other. Well, I have to start somewhere.<br /><br />Can I add functionality to my program to check that the destination drive is a pen drive? Does anyone know what API calls I should investigate to detect if the pen drive is present in the system?<br /><br />If the detection and identification of USB pen drives is ultra complex, please let me know and I&#39;ll continue with the tutorial and come back to it later. <br /><br />Regards, <br />Lightman </div>
    <div class="meta">Posted on 2005-03-29 05:10:20 by Lightman</div>
   </div>
   <div class="post" id="post-158511">
    <div class="subject"><a href="#post-158511">Re: Noob question about USB devices</a></div>
    <div class="body">I wish I knew how to do this :/<br /><br />If you use <strong>QueryDosDevice</strong>, you will get a string like <em>\Device\Harddisk5\DP(1)0-0+10</em> which can perhaps be useful for some further querying (haven&#39;t looked into it). Otherwise, the best bet is probably <strong>GetDriveType</strong>, which should return <em>DRIVE_REMOVABLE</em> for pendrives.</div>
    <div class="meta">Posted on 2005-03-29 07:09:57 by f0dder</div>
   </div>
   <div class="post" id="post-158518">
    <div class="subject"><a href="#post-158518">Re: Noob question about USB devices</a></div>
    <div class="body">I use WNetOpenEnum &amp; WNetEnumResource ( all WIN32 OSes ) to parse mapped sources.? But you may need to do more research to determine if that resource is a pen drive.? I got working code for my parser on this if you want it.? <br /><br />Ask for it on <a target="_blank" href="http://www.masmforum.com">http://www.masmforum.com</a>&nbsp; Seeing, I don&#39;t check here regularly enough.<br /><br />Regards,? P1? 8)</div>
    <div class="meta">Posted on 2005-03-29 09:42:07 by Pone</div>
   </div>
   <div class="post" id="post-158519">
    <div class="subject"><a href="#post-158519">Re: Noob question about USB devices</a></div>
    <div class="body">Pone, does that work for local stuff as well? And could you post the source here - I don&#39;t really want to go to that evil place ;)<br /></div>
    <div class="meta">Posted on 2005-03-29 10:13:26 by f0dder</div>
   </div>
   <div class="post" id="post-158561">
    <div class="subject"><a href="#post-158561">Re: Noob question about USB devices</a></div>
    <div class="body">Thanks Guys, <br /><br /><br />I have been playing with GetDriveType which does return the value for removable disk. For the time being I can check the pen device by ensuring that it is a removable device and not a floppy disk drive. In the furture I would like to return the name of the device and check that it is a USB pen, but given that I have just learnt how to create a file in win32asm, I am getting ahead of myself a bit.<br /><br />If anyone out there comes accross info of USB programming, would you pass it on. <br /><br />Regards,<br /><br />Lightman</div>
    <div class="meta">Posted on 2005-03-30 07:25:38 by Lightman</div>
   </div>
   <div class="post" id="post-158565">
    <div class="subject"><a href="#post-158565">Re: Noob question about USB devices</a></div>
    <div class="body">How do you check that it&#39;s not a floppy drive?<br /></div>
    <div class="meta">Posted on 2005-03-30 08:39:45 by f0dder</div>
   </div>
   <div class="post" id="post-158568">
    <div class="subject"><a href="#post-158568">Re: Noob question about USB devices</a></div>
    <div class="body">F0dder, <br /><br />For the time being I am going to cheat. Via the user interface I can ask for the drive to copy the file to, if the user selects A or B then I can trap that input in my code. <br /><br />It will work, but you just know that there would be someone out there who maps a floppy to f:\ or something. <br /><br />Regards,<br /><br />Lightman</div>
    <div class="meta">Posted on 2005-03-30 09:06:48 by Lightman</div>
   </div>
   <div class="post" id="post-158571">
    <div class="subject"><a href="#post-158571">Re: Noob question about USB devices</a></div>
    <div class="body">&gt;&gt;It will work, but you just know that there would be someone out there who maps a floppy to f:\ or something. <br /><br />There&#39;s always someone whos going to try to break it by feeding it the wrong data. You can&#39;t make it right for everyone out there trying to break it. If I was you I&#39;d just ask the user for where to save it and let it go after that.<br /><br />If you &#39;have to&#39; have it save on a removable drive, just go the easy way and enumerate drives using GetDriveType starting after &quot;C&quot; and list up the removable ones. Save the user choice as standard and let it go.<br /><br />If there&#39;s ever someone emailing you claiming he mounted a floppy on K: and then chose it to save there, just put him on your ignore list. :)<br /><br /></div>
    <div class="meta">Posted on 2005-03-30 10:05:45 by JimmyClif</div>
   </div>
  </div>
 </body>
</html>