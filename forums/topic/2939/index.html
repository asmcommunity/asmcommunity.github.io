<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Printer help - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2939" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2939">Printer help</a></p>
   <div class="post" id="post-19020">
    <div class="subject"><a href="#post-19020">Printer help</a></div>
    <div class="body">Anybody know why the following code doesn't print anything?<br />There is no error after calls to PrintDlg or StartDoc.  This is puzzling.  I read all the api help but still confusion reigns.  Any links or samples to source code much appreciated.<br /><br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br />            mov pd.lStructSize,SIZEOF pd<br />            push hWndList<br />            pop ofn.hwndOwner<br />            push hInstance<br />            pop pd.hInstance<br />            mov pd.Flags,PD_DISABLEPRINTTOFILE or      PD_RETURNDC  or PD_NOPAGENUMS or PD_NOSELECTION<br />            mov docifo.cbSize,SIZEOF docifo<br />            mov docifo.lpszDocName,OFFSET szDocTitle<br />            mov docifo.lpszOutput,OFFSET szOutFileName<br />            mov docifo.fwType,NULL<br />            invoke PrintDlg,ADDR pd<br />            or eax,00h<br />            jz @f<br />            invoke StartDoc,pd.hDC,ADDR docifo<br />            <br />            invoke EndDoc,pd.hDC<br />            invoke DeleteDC,pd.hDC<br />           @@: <br />;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-01-13 20:32:37 by czDrillard</div>
   </div>
   <div class="post" id="post-19033">
    <div class="subject"><a href="#post-19033">Printer help</a></div>
    <div class="body">It looks good to me, with a three small things of interest...<br /><br />1)  My working example uses offset instead of addr on: <em>invoke PrintDlg,ADDR pd</em> (should be an issue tho..)<br /><br />2) I didnt play with so many flags. (again shouldnt matter)<br /><br />3) I do StartPage following Start Doc... (which i dont see)<br /><br />Here is my source.  It works fine.  (in case your wondering the code was written for an engineering application, so the output is all electrical jargin :) )<br /><br />Hope it helps..<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-01-14 03:29:15 by NaN</div>
   </div>
   <div class="post" id="post-19047">
    <div class="subject"><a href="#post-19047">Printer help</a></div>
    <div class="body">czDrillard:<br />Between Start - EndDoc... <br />You should organize a loop with StartPage ... End..<br />And inner loop wich should write text to printer as you do it<br />in window for example, ... may be done with TextOut for example</div>
    <div class="meta">Posted on 2002-01-14 05:36:53 by The Svin</div>
   </div>
   <div class="post" id="post-19090">
    <div class="subject"><a href="#post-19090">Printer help</a></div>
    <div class="body">Nan, thanks for the attachment and Svin thanks for your suggestion.  I'll try to use the information to put together a program that prints.<br />Btw, I'm wanting to print the urls listed in the index.dat files so I might be raising more questions on this same subject:)<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-01-14 10:02:45 by czDrillard</div>
   </div>
  </div>
 </body>
</html>