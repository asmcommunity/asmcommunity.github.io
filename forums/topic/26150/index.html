<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Problems with Find...File - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26150" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26150">Problems with Find...File</a></p>
   <div class="post" id="post-190345">
    <div class="subject"><a href="#post-190345">Problems with Find...File</a></div>
    <div class="body">Hello all

I looked at Iczelion's Tut31 (ListView) cause I need a prog that searches a specified folder for all files and list them. My problem now is that I want the program to add files that are in a subfolder, too. Can anybody show me how I can do this? I know that I have to examine the structure of the file found and look if it is a folder, but how do I get the Handle for the new folder and continue my search there until there is no other file and then return to the folder above.

Any help would be really great.

Stefan</div>
    <div class="meta">Posted on 2000-11-12 08:39:00 by Stefan Krause</div>
   </div>
   <div class="post" id="post-190346">
    <div class="subject"><a href="#post-190346">Problems with Find...File</a></div>
    <div class="body">Hi Stefan,

This question was also posted in comp.lang.asm.x86 by Remco de Lang some time ago. Take a look at this thread:
<a target="_blank" href="http://x75.deja.com/[ST_rn=ps">/viewthread.xp?AN=683391269&search=thread&svcclass=dnyr]http://x75.deja.com//viewthread.xp?AN=683391269&search=thread&svcclass=dnyr</a>

Thomas
exagone.cjb.net</div>
    <div class="meta">Posted on 2000-11-12 08:47:00 by Thomas</div>
   </div>
   <div class="post" id="post-190347">
    <div class="subject"><a href="#post-190347">Problems with Find...File</a></div>
    <div class="body">Hi Thomas,

to be honest. The hint with the other messageboard was not that great don't you think? All that is said there I already know. I want to know how exactly it is done, and that is not said there. I sent a mail to the guy who posted MSG 9 to ask him if he sends this proggy to me, but the other MSG's were no help.

Stefan</div>
    <div class="meta">Posted on 2000-11-12 09:43:00 by Stefan Krause </div>
   </div>
   <div class="post" id="post-190348">
    <div class="subject"><a href="#post-190348">Problems with Find...File</a></div>
    <div class="body">Do it recursively using the stack as variable storage (or allocate local variables yourself)

the key is the variables MUST be local if you wanna recurse, unless you wanna fiddle with linked lists (which i know you dont so you may forget i mentioned them;)

psuedocode:

proc searchfolder pathptr:dword
   local path:string
   local currentfile:findfilestructure

   findfirst&findnext loop {
      if currentfile.filename is directory {
           invoke, strcpy, addr path, pathptr
           invoke, strcat, addr path, currentfile.filename
           invoke, searchfolder, addr path      ;search subfolder
      }
      if current.filename math criteria {
           ; do your stuff
      }
   }
endp searchfolder

hope this helps, prolly not, but maybe ;)</div>
    <div class="meta">Posted on 2000-11-13 09:37:00 by Zynaps </div>
   </div>
  </div>
 </body>
</html>