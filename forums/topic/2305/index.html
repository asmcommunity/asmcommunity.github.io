<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Sending a mail with SMTP - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2305" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=2305">Sending a mail with SMTP</a></p>
   <div class="post" id="post-14558">
    <div class="subject"><a href="#post-14558">Sending a mail with SMTP</a></div>
    <div class="body">I'm french so excuse me for my English.<br /><br />I would like to post a mail under asm, but my code don't work.<br />- First  : my PROC produce a bug when it arrives at the RET instruction and I don't know why...<br />- Second : my PROC returns me every time good messages. It founds the host, the connection is successful, I can send data (I belive, because not fault occur). But the problem is that I never recive the mail in my box (in my mail).<br /> <br />Piece of information :<br /><a target="_blank" href="www.multimania.com">www.multimania.com</a> serves to have some mails like 'Nikename@multimania.com' so the host under SMTP is smtp.multimania.com, isn't it? (I think?)<br /><br />I'll put a piece of my code, so will someone could help me please ?<br /><br /><br /><br /><br />.data<br />	AppName			db &quot;AppName&quot;,0<br />	ClassName		db &quot;ClassName&quot;,0<br />	;hostname		db &quot;www.wanadoo.fr&quot;,0<br />	hostname		db &quot;smtp.wanadoo.fr&quot;,0	<br />		; wanadoo is my 'internet acces supplier'<br />	response 		dd 0<br /><br />	outmsg1			DB 'HELO'				;,0dh,0ah,0<br />	outmsg2			DB 'MAIL FROM: &lt;moimeme@wanadoo.fr&gt;'	;,0dh,0ah,0<br />	outmsg3			DB 'RCPT TO: &lt;Morgatte@citeweb.net&gt;'	;,0dh,0ah,0<br />	outmsg4			DB 'DATA'				;,0dh,0ah,0<br />	smtp_dataBuff		DB 'Voici le contenu du message.',0Dh,0Ah<br />				DB '.',0Dh,0Ah,0<br />	outmsg5			DB 'QUIT'				;,0dh,0ah,0<br /><br />				; HELO &lt;SP&gt; &lt;domain&gt; &lt;CRLF&gt;		; under telnet smtp<br />				; MAIL &lt;SP&gt; FROM:&lt;reverse-path&gt; &lt;CRLF&gt;	; works like that<br />				; RCPT &lt;SP&gt; TO:&lt;forward-path&gt; &lt;CRLF&gt;<br />				; DATA Le texte sur 1,2,3... lignes&lt;CRLF&gt;.&lt;CRLF&gt;<br />				; QUIT &lt;CRLF&gt;<br /><br />.data?<br />	hwnd                    HANDLE ?<br />	hSock			HANDLE ?<br />	SocketAddress		sockaddr_in &lt;?&gt;<br />	wsdat_			WSADATA &lt;&gt;<br /><br />.const<br />	WM_SOCKET 		equ WM_USER+100   <br />	SMTP_PORT		EQU 25      ;<br />  <br /><br />.code<br />.....<br />...<br />..<br />.<br />;################################### SOCKET ####################################################<br />Socksodise proc<br /><br />     INVOKE    WSAStartup, 101h,addr wsdat_		; initialize Winsock Library<br />     .IF eax != 0<br />          FATAL &quot;Impossible d'initialiser la DLL Winsock&quot;<br />     .ENDIF<br />          <br />  <br />     INVOKE    socket, AF_INET,SOCK_STREAM, 0		; kind of Socket<br />     .IF eax == -1<br />          SOCK_MSG &quot;H?te introuvable! (Socket)&quot;<br />          RET<br />     .ENDIF<br />     mov  hSock,eax<br />     <br /><br />          INVOKE    gethostbyname, addr hostname 	; address of SMTP server<br />          .if eax == 0<br />               SOCK_MSG &quot;H?te introuvable! (GetHostByName)&quot;<br />               INVOKE closesocket, hSock<br />               RET<br />          .endif<br />                    <br />          mov  eax,dword ptr <br />          mov  eax,dword ptr <br />          mov  eax,dword ptr       <br />          mov SocketAddress.sin_addr,eax<br /><br />     mov SocketAddress.sin_family,AF_INET<br />     INVOKE    htons, SMTP_PORT				; SMTP_PORT = 25<br />     mov SocketAddress.sin_port,ax<br />     <br /><br /><br /><br /><br /><br /><br />              <br />     INVOKE connect, hSock, addr SocketAddress, sizeof SocketAddress<br />     									;--------- CONNECT ------<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;Impossible de se connecter ? l'h?te!&quot;                    <br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />        <br />     INVOKE    recv, hSock, offset response, 4, 0	; With response dd 0<br />     .IF eax==0          <br />          INVOKE closesocket, hSock				; it doesn't work<br />          RET<br />     .ELSEIF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (CONNEXION -&gt; recv)&quot;	; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ELSEIF eax==4<br />          SOCK_MSG &quot;Reception apr?s CONNECT correcte&quot;		; it Works<br />     .ENDIF							; Connection is OK<br />       <br /><br /><br /><br /><br /><br />     ;SEND     HELO							---------- HELO -------<br />     INVOKE    lstrlen, addr outmsg1<br />     INVOKE    send, hSock,addr outmsg1, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE HELO)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br /><br /><br />     INVOKE    recv, hSock, offset response, 4, 0  ; read bytes from incoming<br />     .IF eax==0          <br />          INVOKE closesocket, hSock				; it doesn't work<br />          RET<br />     .ELSEIF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET (HELO -&gt; recv)!&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ELSEIF eax==4<br />          SOCK_MSG &quot;Reception apr?s SEND HELO correcte&quot;		; it works<br />     .ENDIF         						; Sending HELO is OK<br /><br /><br /><br /><br /><br /><br />     <br />     ;SEND     MAIL FROM: 						------- MAIL FROM -----<br />     INVOKE    lstrlen, addr outmsg2<br />     INVOKE    send, hSock,addr outmsg2, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE MAIL)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />    <br /><br />     INVOKE    recv, hSock, offset response, 4, 0          	; read bytes from incoming<br />     .IF eax==0          <br />          INVOKE closesocket, hSock     			; it doesn't work<br />          RET<br />     .ELSEIF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (MAIL -&gt; recv)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ELSEIF eax==4<br />          SOCK_MSG &quot;Reception apr?s SEND MAIL FROM: correcte&quot;	; it works<br />     .ENDIF         						; Sending MAIL FROM: is OK<br /><br /><br /><br /><br /><br /><br /><br /><br />     ;SEND     RCPT TO:							--------- RCPT TO ------<br />     INVOKE    lstrlen, addr outmsg3<br />     INVOKE    send, hSock,addr outmsg3, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE RCPT TO)&quot;	; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />     <br /><br />     INVOKE    recv, hSock, offset response, 4, 0 ; read bytes from incoming<br />     .IF eax==0          <br />          INVOKE closesocket, hSock				; it doesn't work<br />          RET<br />     .ELSEIF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (RCPT TO -&gt; recv)&quot;	; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ELSEIF eax==4<br />          SOCK_MSG &quot;Reception apr?s RCPT TO: correcte&quot;		; it works<br />     .ENDIF         						; Sending RCPT TO: is OK<br /><br /><br /><br /><br /><br /><br /><br /><br />     ;SEND     DATA							---------- DATA --------<br />     INVOKE    lstrlen, addr outmsg4<br />     INVOKE    send, hSock,addr outmsg4, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE DATA)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />     <br /><br />     INVOKE    recv, hSock, offset response, 4, 0          	; read bytes from incoming<br />     .IF eax==0          <br />          INVOKE closesocket, hSock        			; it doesn't work<br />          RET<br />     .ELSEIF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (DATA -&gt; recv)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ELSEIF eax==4<br />          SOCK_MSG &quot;Reception apr?s DATA correcte&quot;		; it works<br />     .ENDIF         						; Sending DATA is OK<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />     <br />     ;SEND     TEXT							------ LE MESSAGE ------<br />     INVOKE    lstrlen, smtp_dataBuff<br />     INVOKE    send, hSock,smtp_dataBuff, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE TEXT)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />     <br /><br />     INVOKE    recv, hSock, offset response, 4, 0          	; read bytes from incoming<br />     .IF eax==0          <br />          INVOKE closesocket, hSock       <br />          RET<br />     .ELSEIF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (TEXT -&gt; recv)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock                   <br />          RET<br />     .ELSEIF eax==4<br />          SOCK_MSG &quot;Reception apr?s SEND TEXT correcte&quot;		; it works<br />     .ENDIF         						; Sending THE CONTENT OF<br />								; THE MESSAGE is OK<br />    <br /><br /><br /><br /><br /><br /><br /><br />     ;SEND     QUIT							      ------ QUIT ------<br />     INVOKE    lstrlen, outmsg5<br />     INVOKE    send, hSock,outmsg5, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE QUIT)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />     <br /><br />     INVOKE    recv, hSock, offset response, 4, 0          	; read bytes from incoming<br />     .IF eax==0          <br />          INVOKE closesocket, hSock       <br />          RET<br />     .ELSEIF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (outmsg5 -&gt; recv)&quot;	; it doesn't work<br />          INVOKE closesocket, hSock                   <br />          RET<br />     .ELSEIF eax==4<br />          SOCK_MSG &quot;Reception apr?s SEND QUIT correcte&quot;		; it works<br />     .ENDIF         						; Sending QUIT is OK<br /><br /><br /><br /><br /><br />     INVOKE closesocket, hSock<br />     INVOKE WSACleanup <br />     ret	; &lt;----------------------------------------------- here I have a bug<br />Socksodise endp<br />;#################################### SOCKET ###################################################<br /><br />Thanks:confused:</div>
    <div class="meta">Posted on 2001-12-10 17:28:14 by Morgatte</div>
   </div>
   <div class="post" id="post-14646">
    <div class="subject"><a href="#post-14646">Sending a mail with SMTP</a></div>
    <div class="body">What do you mean exactly with 'bug'? Does your program crash? Does any error occur? <br />Also, you shoudn't comment the 0Dh,0Ah,0 in these strings:<br /><pre><code><br />outmsg1 DB 'HELO'&#91;b&#93;;&#91;/b&#93;,0dh,0ah,0 <br />outmsg2 DB 'MAIL FROM&#58; &lt;moimeme@wanadoo.fr&gt;' &#91;b&#93;;&#91;/b&#93;,0dh,0ah,0 <br />outmsg3 DB 'RCPT TO&#58; &lt;Morgatte@citeweb.net&gt;' &#91;b&#93;;&#91;/b&#93;,0dh,0ah,0 <br />.... and so on...<br /></code></pre><br />Remove these semi-collons, you need the CRLF and null terminator.<br /><br />Then another thing is that you use this to receive the response:<br /><pre><code><br />INVOKE recv, hSock, offset response, 4, 0 ; With response dd 0 <br /></code></pre><br /><br />However you assume the length of the response is always 4. But this isn't correct. There can be a response of any length:<br /><pre><code><br />503&#91;cr&#93;&#91;lf&#93; &#40;5 bytes&#41;<br />503 5.5.1 Waiting for HELO/EHLO command&#91;cr&#93;&#91;lf&#93; &#40;41 bytes&#41;<br /></code></pre><br />You always just receive 4 bytes so you don't retrieve the full response.<br /><br />Thomas</div>
    <div class="meta">Posted on 2001-12-11 14:07:43 by Thomas</div>
   </div>
   <div class="post" id="post-14690">
    <div class="subject"><a href="#post-14690">Sending a mail with SMTP</a></div>
    <div class="body">Bonjour Morgatte, <br />Je n'ai pas lu ton code mais j'esp?re que cet attachement t'aidera.<br />Il faut juste que tu remplaces &quot;xxxx@aaa.com&quot; par ton mail et que tu places un fichier BRSKLOG.BAK ( avec les donn?es que tu veux envoyer) dans le repertoire syst?me de windows. <br /><br />PS : Si tu utilises une proc?dure de fen?tre met ce code dans une thread sinon le prog ne fonctionnera pas...<br /><br /><br />Amicalement<br /><br />Axial</div>
    <div class="meta">Posted on 2001-12-12 01:48:11 by Axial</div>
   </div>
   <div class="post" id="post-14695">
    <div class="subject"><a href="#post-14695">Sending a mail with SMTP</a></div>
    <div class="body">Thank you Thomas I have a doubt about The 4 bytes of 'recv' and and other about &lt;CRLF&gt;.<br /><br /><br />The Ret instruction occur an exception violation memory (Read), so I   have think I could put a SEH But I prefer understand why this Exception occurs.<br /><br /><br /><br />Axial<br />Merci  beaucoup pour ton fichier. J'esp?re qu'il n'est pas trop gros pour que je puisse le d?cortiquer sans trop de probl?mes.<br /><br /><br />@+</div>
    <div class="meta">Posted on 2001-12-12 04:09:20 by Morgatte</div>
   </div>
   <div class="post" id="post-14700">
    <div class="subject"><a href="#post-14700">Sending a mail with SMTP</a></div>
    <div class="body"><div class="quote"><br />;SEND QUIT ------ QUIT ------ <br />INVOKE lstrlen, outmsg5 <br />INVOKE send, hSock,outmsg5, eax, NULL <br />SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE QUIT)&quot; ; it doesn't work <br />INVOKE closesocket, hSock <br /></div><br /><br />R?essaye avec &quot;Addr outmsg5&quot;, normalement ?a devrait marcher apres ?a.<br />A+<br /><br />Axial</div>
    <div class="meta">Posted on 2001-12-12 05:01:40 by Axial</div>
   </div>
   <div class="post" id="post-14705">
    <div class="subject"><a href="#post-14705">Sending a mail with SMTP</a></div>
    <div class="body">as a standard, you may want to add protocol handling to check for errors that may occur between sessions, mainly. <br />refer to the smtp rfc to see the meaning of the various codes generated by an smtp server.<br /><br />clip</div>
    <div class="meta">Posted on 2001-12-12 06:50:28 by clip</div>
   </div>
   <div class="post" id="post-14722">
    <div class="subject"><a href="#post-14722">Sending a mail with SMTP</a></div>
    <div class="body">Thanks for all, It works now. :alright: <br /><br /><br />Axial<br />Merci beaucoup pour ton fichier, il m'a beaucoup aid?.<br />Mais il doit y avoir une petite erreur, ici: <br /><br />invoke  send, Sock, addr cmd2,cmd4Size,0<br /><br />cmd4 = 'QUIT' et au moment de le pass? on redonne cmd2 ? la place.<br /><br />Une autre chose: a un moment il y a une recherche dans le registre pour trouver le client install? sur l'ordinateur:<br /><br />Moi ce r?pertoire, il n'existe pas.<br />szAccount    DB   'Software\Microsoft\Internet Account Manager\Accounts\',0<br />Donc il ne trouve rien.<br /><br />Mais pas de probl?me maintenant tout marche bien<br /><br /><br /><br /><br />:alright: :alright:</div>
    <div class="meta">Posted on 2001-12-12 11:20:28 by Morgatte</div>
   </div>
   <div class="post" id="post-14781">
    <div class="subject"><a href="#post-14781">Sending a mail with SMTP</a></div>
    <div class="body"><div class="quote">invoke send, Sock, addr cmd2,cmd4Size,0 </div> <br /><br />Oui, je me souviens je n'avais pas corrig? cette erreur dans cette version...<br /><br /><div class="quote"><br />Moi ce r?pertoire, il n'existe pas. <br />szAccount DB 'Software\Microsoft\Internet Account Manager\Accounts\',0 <br /></div><br /><br />Curieux cette erreur, tu tournes sous Windows NT ???</div>
    <div class="meta">Posted on 2001-12-13 01:19:05 by Axial</div>
   </div>
   <div class="post" id="post-14787">
    <div class="subject"><a href="#post-14787">Sending a mail with SMTP</a></div>
    <div class="body">No, only under Win95</div>
    <div class="meta">Posted on 2001-12-13 04:35:24 by Morgatte</div>
   </div>
   <div class="post" id="post-14795">
    <div class="subject"><a href="#post-14795">Sending a mail with SMTP</a></div>
    <div class="body">Morgatte - Glad you got your program working. I was trying to follow this thread, but French is not my language...so I was wondering how you fixed your code to make it work?</div>
    <div class="meta">Posted on 2001-12-13 06:41:32 by gscundiff</div>
   </div>
   <div class="post" id="post-14797">
    <div class="subject"><a href="#post-14797">Sending a mail with SMTP</a></div>
    <div class="body">I know it's easier to speak (write) French for French people, but I think we should write using English language.<br />Then people wouldn't have so many problems with understanding even though we make mistakes (maybe a lot !).<br /><br /><br />Hi Morgatte, (we are a lot of French people here !!!),<br /><br />I don't think that you can send mail with smtp.multimania.com, because it is not a ISP. You know, my site is hosted at multimania and when you create your email address, you can just receive mail under Outlook or other (via pop), but you can't send mail with multimania, on their site, they say you must use your ISP smtp address. (like me under wanadoo.fr so it is smtp.wanadoo.fr)<br /><br />You know, I've seen something very strange:<br />I can send mails via smtp.wanadoo.fr, without putting a real username and real password, so I can send someone mails with <a href="mailto:microsoft@bob.fr">microsoft@bob.fr</a> for example. It works and no password is recquired. But when I insert an attachment, then the mail can't be sent.<br />I think it's a security hole, because it is really hallucinating, isn't it ?</div>
    <div class="meta">Posted on 2001-12-13 06:44:15 by Vom-bonjour:-()</div>
   </div>
   <div class="post" id="post-14800">
    <div class="subject"><a href="#post-14800">Sending a mail with SMTP</a></div>
    <div class="body">Yet another french there !!! :)<br /><br />(&quot;Vive la France ! Vive la France ! Le Schedar pue !&quot; like says the IBM ad). :)<br /><br />Now, let's stop bad jokes and the not-so-serious patriotism. :)<br /><br />Vom, i have seen the same &quot;security hole&quot; in wanadoo (french isp in case the others people are wondering), with their news server... but the problem has been fixed few weeks ago.<br />At home, I use Club-Internet, and without good login and pass and an active Club-Internet connexion, it's impossible to send or receive mail via their servers...<br /><br />But anyway, perhaps Wanadoo considers this as a feature ? and for most of us, it is ;)</div>
    <div class="meta">Posted on 2001-12-13 07:29:46 by JCP</div>
   </div>
   <div class="post" id="post-14812">
    <div class="subject"><a href="#post-14812">Sending a mail with SMTP</a></div>
    <div class="body">it's not a security hole, the smtp server just allows 'relaying' of mails to anyone, in sendmail, previous versions allow relaying as default (btw, using smtp doesn't require you a password for any sort of authentication).. you know back then, most admins didn't bother to set their smtp servers to deny relaying until abusive people started using them to spoof mail and to mail bomb.  now, i think it's in an admin's check list to deny relaying when setting up an smtp server (well, some of them forget, like the sysads in my school :)).<br /><br /><br />clip</div>
    <div class="meta">Posted on 2001-12-13 09:45:14 by clip</div>
   </div>
   <div class="post" id="post-14817">
    <div class="subject"><a href="#post-14817">Sending a mail with SMTP</a></div>
    <div class="body">Okay I'll speak english :grin: <br /><br />Hi others, am I the only one or do you have this path ?<br /><div class="quote"><br />HKEY_CURRENT_USER\Software\Microsoft\Internet Account Manager\Accounts\ [\QUOTE]</div>
    <div class="meta">Posted on 2001-12-13 10:46:19 by Axial</div>
   </div>
   <div class="post" id="post-14855">
    <div class="subject"><a href="#post-14855">Sending a mail with SMTP</a></div>
    <div class="body">Axial,<br /><br />I don't have this key on any of my Win9x machines.<br /><br />farrier</div>
    <div class="meta">Posted on 2001-12-13 13:35:25 by farrier</div>
   </div>
   <div class="post" id="post-14915">
    <div class="subject"><a href="#post-14915">Sending a mail with SMTP</a></div>
    <div class="body">Thanks Farrier,<br /><br />I just forgot this prog assumes you have M$-OUTLOOK installed and configured...<br /><br />:stupid:</div>
    <div class="meta">Posted on 2001-12-14 01:34:56 by Axial</div>
   </div>
   <div class="post" id="post-14925">
    <div class="subject"><a href="#post-14925">Sending a mail with SMTP</a></div>
    <div class="body">AXIAL,<br /><br />I haven't got this patch.<br />But at HKEY_CURRENT_USER\RemoteAccess I can found<br />Default=Wanadoo &lt;-- My FAI (ISP = FAI ???)<br />InternetProfile=Wanadoo<br /><br />So I made a loop to obtain first smtp.wanadoo.com and if it does not work it give me smtp.wanadoo.fr<br /><br />Now it Works.<br /><br /><br /><br /><br />Von - bonjour,<br />Yes that's right Multimania isn't a ISP. So That can't work.<br /><br /><br /><br />gscundiff, ;)<br />I have got two codes.<br /><br />First is a very basic snipet code, only to understand...<br /><br /><br />.386 <br />.model flat,stdcall <br />option casemap:none <br /><br /><br />      include \MASM32\INCLUDE\windows.inc<br /><br /><br />      include \MASM32\INCLUDE\user32.inc<br />      include \MASM32\INCLUDE\kernel32.inc<br />      include \MASM32\INCLUDE\wsock32.inc<br /><br />      includelib \MASM32\LIB\user32.lib<br />      includelib \MASM32\LIB\kernel32.lib<br />      includelib \MASM32\LIB\Wsock32.lib<br /><br /><br /><br /><br />recvlp		proto<br /><br /><br />.data<br /><br />	hostname		db &quot;smtp.wanadoo.fr&quot;,0   ; my ISP<br /><br />	HELO			DB 'HELO smtp.wanadoo.fr', 0dh, 0ah, 0<br />	MAIL			DB 'MAIL FROM: &lt;mailanonyme@free.fr&gt;', 0dh, 0ah, 0<br />	RCPT			DB 'RCPT TO: &lt;Morgatte@multimania.com&gt;', 0dh, 0ah, 0                       ; my mail<br />	DATA			DB 'DATA',0dh,0ah,0<br />	smtp_dataBuff		DB 'Voici le contenu du message...', 0dh, 0ah<br />				DB 'qui peut ?tre sur plusieurs lignes.', 0dh, 0ah,'.', 0dh, 0ah, 0<br />	QUIT			DB 'QUIT', 0dh, 0ah, 0<br /><br /><br />.data?<br />	hSock			HANDLE ?<br />	SocketAddress		sockaddr_in &lt;?&gt;<br />	ws_data			WSADATA &lt;&gt;<br />	recvbuf         	dd      ?<br />	BBB			db	?<br /><br /><br /><br />.const  <br />	SMTP_PORT		EQU 25		; port 25 = smtp<br />  <br /><br />.code<br />;----------------------- Proc?dure attente de r?ponse --------------------<br />recvlp proc                                               ; tanks to AXIAL for this proc<br />    invoke  recv,hSock, addr recvbuf, 4,0<br />    cmp     eax,4                           ;On a re?u un dword ?<br />    jnz     qut<br /><br />    @@:<br />    invoke  recv,hSock,addr BBB,1,0<br />    cmp     eax,1                           ;On a re?u un octes ?<br />    jne     @B<br />    cmp     byte ptr ,0ah              ;Est-ce 0ah <br />    jne     @B<br />                                            ;Oui? cela signifie que le serveur a fini de r?pondre<br />    @@:<br />    qut:<br />    mov     eax,dword ptr          ;Valeur de retour dans eax<br />    ret<br />recvlp endp<br />;--------------------------------------------------------------------------<br /><br />start:<br />;################################### SOCKET ####################################################<br /><br /><br />     INVOKE    WSAStartup, 101h, addr ws_data		; initialise la librairie Winsock<br />     .IF eax != 0<br />          ; mettre le message &quot;Impossible d'initialiser la DLL Winsock&quot;<br />     .ENDIF<br />          <br />  <br />     INVOKE    socket, AF_INET, SOCK_STREAM, 0		; type de Socket<br />     mov  hSock,eax<br />     .IF eax == -1<br />           ; mettre le message &quot;H?te introuvable! (Socket)&quot;<br />     .ENDIF<br /><br />     <br /><br />     INVOKE    gethostbyname, addr hostname 		; nom du serveur SMTP<br />     .if eax == 0<br />         ; Mettre le message &quot;H?te introuvable! (GetHostByName)&quot;<br />     .endif<br />                    <br />     mov  eax,dword ptr  ; eax re?oit la valeur du membre h_list (voir la structure &quot;hostent&quot;)<br />     mov  eax,dword ptr     ; copie le pointer sur l'actuel adresse IP dans eax<br />     mov  eax,dword ptr     ; copie l'adresse IP dans eax (voir la structure &quot;hostent&quot;)<br />     mov  SocketAddress.sin_addr,eax<br /><br />     mov SocketAddress.sin_family,AF_INET<br />     INVOKE    htons, SMTP_PORT				; SMTP_PORT = 25<br />     mov SocketAddress.sin_port,ax<br /><br /><br /><br />; --------- CONNECT ------<br /><br />    INVOKE    connect, hSock, addr SocketAddress, sizeof SocketAddress<br />    INVOKE    recvlp<br />    cmp eax, ' 022'	; le message 220 est retourn? si correcte<br />    jne abandon<br /><br /><br />; ---------- HELO -------<br /><br />    INVOKE    lstrlen, addr HELO<br />    INVOKE    send, hSock, addr HELO, eax, NULL<br />    INVOKE    recvlp<br />    cmp eax, ' 052'	; le message 250 est retourn? si correcte<br />    jne abandon<br /><br /><br />; ------- MAIL FROM -----<br /><br />    INVOKE    lstrlen, addr MAIL<br />    INVOKE    send, hSock, addr MAIL, eax, NULL<br />    INVOKE    recvlp<br />    cmp eax, ' 052'	; le message 250 est retourn? si correcte<br />    jne abandon<br /><br /><br />; --------- RCPT TO ------<br /><br />    INVOKE    lstrlen, addr RCPT<br />    INVOKE    send, hSock, addr RCPT, eax, NULL<br />    INVOKE    recvlp<br />    cmp eax, ' 052'	; le message 250 est retourn? si correcte<br />    jne abandon<br /><br /><br />; ---------- DATA --------<br /><br />    INVOKE    lstrlen, addr DATA<br />    INVOKE    send, hSock,addr DATA, eax, NULL<br />    INVOKE    recvlp<br />    cmp eax, ' 453'	; le message 354 est retourn? si correcte<br />    jne abandon<br /><br />     <br />; ------ LE MESSAGE ------<br /><br />    INVOKE    lstrlen, addr smtp_dataBuff<br />    INVOKE    send, hSock, addr smtp_dataBuff, eax, NULL<br />    INVOKE    recvlp<br />    cmp eax, ' 052'	; le message 250 est retourn? si correcte<br />    jne abandon<br /><br /><br />; ------ QUIT ------<br /><br />    INVOKE    lstrlen, addr QUIT<br />    INVOKE    send, hSock, addr QUIT, eax, NULL<br />    INVOKE    recvlp<br />    cmp eax, ' 122'	; le message 221 est retourn? si correcte<br />    jne abandon<br /><br /><br />abandon:<br /><br />     INVOKE closesocket, hSock<br />     INVOKE WSACleanup <br /><br />;#################################### SOCKET ###################################################<br /><br />xor eax, eax<br />invoke ExitProcess, eax<br /><br />end start<br /><br /><br /><br /><br /><br />This second code contian a loop and look for your ISP in your registeries.<br /><br />.386 <br />.model flat,stdcall <br />option casemap:none <br /><br />include \masm32\include\wsock32.inc<br />includelib \masm32\lib\Wsock32.lib<br />include inclusions.inc<br />	include \masm32\include\advapi32.inc ;&lt;-- Registres<br />	includelib \masm32\lib\advapi32.lib <br /><br /><br />Socksodise	proto<br />recvlp		proto<br />RegHost		proto<br /><br />.data<br />	AppName			db &quot;AppName&quot;,0<br />	ClassName		db &quot;ClassName&quot;,0<br />	smtp			db &quot;smtp.&quot;,0<br />	fr			db &quot;.fr&quot;,0<br />	com			db &quot;.com&quot;,0<br />	hostfr			db 50 dup (0)<br />	hostcom			db 50 dup (0)<br />	hostname		db 50 dup (0)	<br />	HELO0			DB 'HELO ',0<br />	CRLF			DB 0dh,0ah,0<br />	HELO			DB 50 dup (0)<br />	Zero			DB 50 dup (0)<br />	response 		dd 0<br /><br />	;outmsg1			DB 'HELO smtp.wanadoo.fr', 0dh, 0ah, 0<br />	outmsg2			DB 'MAIL FROM: &lt;moimeme@wanadoo.fr&gt;', 0dh, 0ah, 0<br />	outmsg3			DB 'RCPT TO: &lt;trenaud@multimania.com&gt;', 0dh, 0ah, 0<br />	outmsg4			DB 'DATA',0dh,0ah,0<br />	smtp_dataBuff		DB 'Voici le contenu du message.', 0Dh, 0Ah,'.', 0Dh, 0Ah, 0<br />	outmsg5			DB 'QUIT', 0dh, 0ah, 0<br /><br />	Sous_Clef	 	db &quot;RemoteAccess&quot;,0 ;&lt;-- pour RegOpenKeyEx<br />	Valeur 			db &quot;InternetProfile&quot;,0 ;&lt;-- Idem<br />	Donnee_Lire 		db 50 dup(0),0 ;&lt;-- Pour RegQueryValueEX<br />	Taille_Donnee 		dd 80 <br /><br />				; HELO &lt;SP&gt; &lt;domain&gt; &lt;CRLF&gt;<br />				; MAIL &lt;SP&gt; FROM:&lt;reverse-path&gt; &lt;CRLF&gt;<br />				; RCPT &lt;SP&gt; TO:&lt;forward-path&gt; &lt;CRLF&gt;<br />				; DATA Le texte sur 1,2,3... lignes&lt;CRLF&gt;.&lt;CRLF&gt;<br />				; QUIT &lt;CRLF&gt;<br /><br />	msgConnect		db &quot;Retour de Connect&quot;,0<br />	msgHELO			db &quot;Retour de HELO&quot;,0<br />	msgMAIL			db &quot;Retour de MAIL FROM&quot;,0<br />	msgRCPT			db &quot;Retour de RCPT TO&quot;,0<br />	msgDATA			db &quot;Retour de DATA&quot;,0<br />	msgTEXT			db &quot;Retour de TEXT&quot;,0<br />	msgQUIT			db &quot;Retour de QUIT&quot;,0<br /><br />        format_Aeffacer db &quot;valeur : %li d?cim&quot;,0<br /><br />.data?<br />	hwnd                    HANDLE ?<br />	hSock			HANDLE ?<br />	SocketAddress		sockaddr_in &lt;?&gt;<br />	ws_data			WSADATA &lt;&gt;<br />	recvbuf         	dd      ?<br />	BBB			db	?<br />	pHKey 			HANDLE ?<br />	abandonner		db ?<br />	nom_ordi		db 30 dup (?)<br />	Aeffacer  db 50 dup (?)         ; sert ? mes testes avec la fonction wsprint<br /><br /><br />.const  <br />	SMTP_PORT		EQU 25      ;<br />  <br /><br />.code<br />start:<br /><br /><br />	invoke RegHost<br />	invoke Socksodise<br />	invoke ExitProcess,0<br /><br /><br />;################################### SOCKET ####################################################<br />Socksodise proc<br /><br /><br /><br /><br />     INVOKE    WSAStartup, 101h, addr ws_data		; initialize Winsock Library<br />     .IF eax != 0<br />          FATAL &quot;Impossible d'initialiser la DLL Winsock&quot;<br />     .ENDIF<br />          <br />  <br />     ;invoke gethostname,offset nom_ordi,sizeof nom_ordi<br />     <br /><br /><br /><br /><br /><br />     invoke lstrcpy, addr hostname, addr hostcom<br />     jmp go<br />     nouvelessaifr:<br />     invoke lstrcpy, addr hostname, addr hostfr<br />     go:<br /><br />    invoke    lstrcpy, addr HELO, addr Zero	; vide HELO<br />    invoke    lstrcat, addr HELO, addr HELO0	; HELO = 'HELO '<br />    invoke    lstrcat, addr HELO, addr hostname	; HELO = 'HELO smtp.wanadoo.fr'<br />    invoke    lstrcat, addr HELO, addr CRLF	; HELO = 'HELO smtp.wanadoo.fr',0dh,0ah,0<br /><br /><br />invoke MessageBox, 0, addr HELO, addr HELO, 0<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />     INVOKE    socket, AF_INET, SOCK_STREAM, 0		; kind of Socket<br />     mov  hSock,eax<br />     .IF eax == -1<br />          SOCK_MSG &quot;H?te introuvable! (Socket)&quot;<br />          RET<br />     .ENDIF<br /><br />     <br /><br />          INVOKE    gethostbyname, addr hostname 	; address of SMTP server<br />          .if eax == 0<br />               SOCK_MSG &quot;H?te introuvable! (GetHostByName)&quot;<br />               INVOKE closesocket, hSock<br />               RET<br />          .endif<br />                    <br />          mov  eax,dword ptr <br />          mov  eax,dword ptr <br />          mov  eax,dword ptr      <br />        mov ebx, eax  <br />	mov SocketAddress.sin_addr,eax<br />	invoke inet_ntoa,ebx<br />	.if eax == 0<br />				; &lt;-- normalement eax pointe sur la chaine de caract IP<br />				; donc si eax == 0, c'est qu'on est pas connect?.<br />	.endif<br />	<br />     mov SocketAddress.sin_family,AF_INET<br />     INVOKE    htons, SMTP_PORT				; SMTP_PORT = 25<br />     mov SocketAddress.sin_port,ax<br />     <br /><br /><br /><br /><br /><br /><br />              <br />     INVOKE connect, hSock, addr SocketAddress, sizeof SocketAddress<br />     									;--------- CONNECT ------<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;Impossible de se connecter ? l'h?te!&quot; <br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />        <br />    call   recvlp<br />    invoke MessageBox, 0, addr recvbuf, addr msgConnect, 0<br /><br /><br /><br />     ;SEND     HELO							---------- HELO -------<br />     INVOKE    lstrlen, addr HELO<br />     INVOKE    send, hSock,addr HELO, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE HELO)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br /><br />    call   recvlp<br />    invoke MessageBox, 0, addr recvbuf, addr msgHELO, 0<br /><br /><br /><br /><br />     <br />     ;SEND     MAIL FROM: 						------- MAIL FROM -----<br />     INVOKE    lstrlen, addr outmsg2<br />     INVOKE    send, hSock,addr outmsg2, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE MAIL)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />    <br />    call   recvlp<br />    invoke MessageBox, 0, addr recvbuf, addr msgMAIL, 0<br /><br /><br /><br /><br /><br /><br />     ;SEND     RCPT TO:							--------- RCPT TO ------<br />     INVOKE    lstrlen, addr outmsg3<br />     INVOKE    send, hSock,addr outmsg3, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE RCPT TO)&quot;	; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />     <br />    call   recvlp<br />    .if eax != ' 052'				; si RCPT TO n'est pas valide alors c'est que l'hote<br />	.if abandonner != 1			; n'est pas le bon donc au lieu de smtp.host.com<br />		mov abandonner, 1		; on revient au d?but avec smtp.host.fr<br />		INVOKE closesocket, hSock	; Si ?a ne marche pas non plus, alors<br />		jmp nouvelessaifr		; on abandonne pour de bon.<br />	.endif<br />    .endif<br />    mov abandonner, 0<br />    invoke MessageBox, 0, addr recvbuf, addr msgRCPT, 0<br /><br /><br /><br /><br /><br /><br />     ;SEND     DATA							---------- DATA --------<br />     INVOKE    lstrlen, addr outmsg4<br />     INVOKE    send, hSock,addr outmsg4, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE DATA)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />     <br />    call   recvlp<br />    invoke MessageBox, 0, addr recvbuf, addr msgDATA, 0<br /><br /><br /><br /><br /><br /><br />     <br />     ;SEND     TEXT							------ LE MESSAGE ------<br />     INVOKE    lstrlen, addr smtp_dataBuff<br />     INVOKE    send, hSock, addr smtp_dataBuff, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE TEXT)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />     <br />    call   recvlp<br />    invoke MessageBox, 0, addr recvbuf, addr msgTEXT, 0<br /><br /><br /><br /><br /><br /><br />     ;SEND     QUIT							      ------ QUIT ------<br />     INVOKE    lstrlen, addr outmsg5<br />     INVOKE    send, hSock, addr outmsg5, eax, NULL<br />     .IF eax==SOCKET_ERROR<br />          SOCK_MSG &quot;ERREUR DE SOCKET! (ENVOI DE QUIT)&quot;		; it doesn't work<br />          INVOKE closesocket, hSock<br />          RET<br />     .ENDIF<br />     <br />    call   recvlp<br />    invoke MessageBox, 0, addr recvbuf, addr msgQUIT, 0<br /><br /><br /><br />     INVOKE closesocket, hSock<br />     INVOKE WSACleanup <br />     ret	; &lt;----------------------------------------------- here I have a bug<br /><br />;#################################### SOCKET ###################################################<br /><br /><br /><br />;############################# ATTENDRE LES R?PONSES ###########################################<br />recvlp proc<br />    invoke  recv,hSock, addr recvbuf, 4,0<br />    cmp     eax,4                           ;On a re?u un dword ?<br />    jnz     qut<br /><br />    @@:<br />    invoke  recv,hSock,addr BBB,1,0<br />    cmp     eax,1                           ;On a re?u un octes ?<br />    jne     @B<br />    cmp     byte ptr ,0ah              ;Est 0ah <br />    jne     @B<br />                                            ;Oui? cela signifie que le serveur a fini de r?pondre<br />    @@:<br />    qut:<br />    mov     eax,dword ptr          ;Valeur de retour dans eax<br />    ret<br />recvlp endp<br />;############################# ATTENDRE LES R?PONSES ###########################################<br /><br /><br /><br />;################################### REG HOST ##################################################<br />RegHost proc<br /><br />invoke RegOpenKeyEx, 	HKEY_CURRENT_USER, \<br />	   		offset Sous_Clef, \<br />			NULL, \<br />			KEY_ALL_ACCESS, \<br />			offset pHKey<br /><br />invoke RegQueryValueEx, pHKey, \<br />	   		addr Valeur, \<br />			NULL, \<br />			NULL, \<br />			addr Donnee_Lire, \<br />			addr Taille_Donnee<br /><br />invoke RegCloseKey, pHKey<br /><br />invoke CharLower, addr Donnee_Lire		; WanAdOO --&gt; wanadoo<br /><br /><br />invoke lstrcat, addr hostfr, addr smtp		; host = &quot;smtp.&quot;<br />invoke lstrcat, addr hostfr, addr Donnee_Lire	; host = &quot;smtp.wanadoo&quot;<br />invoke lstrcat, addr hostfr, addr fr		; host = &quot;smtp.wanadoo.fr&quot;<br /><br />invoke lstrcat, addr hostcom, addr smtp		; host = &quot;smtp.&quot;<br />invoke lstrcat, addr hostcom, addr Donnee_Lire	; host = &quot;smtp.wanadoo&quot;<br />invoke lstrcat, addr hostcom, addr com		; host = &quot;smtp.wanadoo.com&quot;<br /><br />ret<br />RegHost endp<br />;################################### REG HOST ##################################################<br /><br /><br />Socksodise endp<br />end start</div>
    <div class="meta">Posted on 2001-12-14 04:50:23 by Morgatte</div>
   </div>
   <div class="post" id="post-14926">
    <div class="subject"><a href="#post-14926">Sending a mail with SMTP</a></div>
    <div class="body">Sorry, in the second code, I have forgot the include file Inclusions.inc<br /><br /><br />; #########################################################################<br /><br />;     include files<br />;     ~~~~~~~~~~~~~<br />      include \MASM32\INCLUDE\windows.inc<br />      include \MASM32\INCLUDE\gdi32.inc<br />      include \MASM32\INCLUDE\user32.inc<br />      include \MASM32\INCLUDE\kernel32.inc<br />      include \MASM32\INCLUDE\Comctl32.inc<br />      include \MASM32\INCLUDE\comdlg32.inc<br />      include \MASM32\INCLUDE\shell32.inc<br /><br />;     libraries<br />;     ~~~~~~~~~<br /><br />      includelib \MASM32\LIB\gdi32.lib<br />      includelib \MASM32\LIB\user32.lib<br />      includelib \MASM32\LIB\kernel32.lib<br />      includelib \MASM32\LIB\Comctl32.lib<br />      includelib \MASM32\LIB\comdlg32.lib<br />      includelib \MASM32\LIB\shell32.lib<br /><br />; #########################################################################<br /><br />        ;=================<br />        ; Local prototypes<br />        ;=================<br />        WinMain PROTO :DWORD,:DWORD,:DWORD,:DWORD<br />        WndProc PROTO :DWORD,:DWORD,:DWORD,:DWORD<br />	initialisation PROTO :DWORD<br /><br />        wsprintfA PROTO C :DWORD,:VARARG<br />        wsprintf equ &lt;wsprintfA&gt;<br /><br />      ;=============<br />      ; Local macros<br />      ;=============<br /><br />      szText MACRO Name, Text:VARARG<br />        LOCAL lbl<br />          jmp lbl<br />            Name db Text,0<br />          lbl:<br />        ENDM<br /><br />      m2m MACRO M1, M2<br />        push M2<br />        pop  M1<br />      ENDM<br /><br />      return MACRO arg<br />        mov eax, arg<br />        ret<br />      ENDM<br /><br />    .data<br />        szDisplayName db &quot;Interceptape V1.0&quot;,0<br />        CommandLine   dd 0<br />        hWnd          dd 0<br />        hInstance     dd 0<br />        hIcon         dd 0<br /><br />; ########################### Inserted modules ############################<br />;-------------------------------------- LES MACROS -------------------------------------<br />FATAL MACRO msg<br />    LOCAL @@msg<br />    ;LOCAL @@hndl<br />    .DATA<br />    @@msg       DB        msg, 0<br />    ;@@hndl	DD hndl<br />    .CODE<br /><br />    INVOKE MessageBox, NULL, ADDR @@msg, ADDR AppName, MB_OK<br />    INVOKE ExitProcess, 0<br />ENDM<br /><br />SOCK_MSG MACRO msg<br />    LOCAL @@msg<br />    .DATA<br />    	@@msg       DB        msg, 0<br />    .CODE<br /><br />    INVOKE MessageBox, NULL, ADDR @@msg, ADDR AppName, MB_OK<br />	;INVOKE    lstrcpy, srvBuff, addr @@msg<br />	;INVOKE    SendMessage, hText,WM_SETTEXT,NULL,srvBuff<br />ENDM<br />;----------------------------------------------------------------------------------------------<br /><br /><br />; #########################################################################<br /><br /><br /><br />Only FATAL MACRO and SOCK_MSG MACRO are interesting.</div>
    <div class="meta">Posted on 2001-12-14 04:57:54 by Morgatte</div>
   </div>
   <div class="post" id="post-14930">
    <div class="subject"><a href="#post-14930">Sending a mail with SMTP</a></div>
    <div class="body">Salut Morgatte,<br /><br />Yes, isp = fai :)<br /><br />I didn't had time to read your code carefully (understand :more than 30 sec ^^) but I have a little suggestion :<br /><br /><pre><code><br /><br />invoke lstrcat, addr hostfr, addr smtp ; host = &quot;smtp.&quot; <br />invoke lstrcat, addr hostfr, addr Donnee_Lire ; host = &quot;smtp.wanadoo&quot; <br />invoke lstrcat, addr hostfr, addr fr ; host = &quot;smtp.wanadoo.fr&quot; <br />invoke lstrcat, addr hostcom, addr smtp ; host = &quot;smtp.&quot; <br />invoke lstrcat, addr hostcom, addr Donnee_Lire ; host = &quot;smtp.wanadoo&quot; <br />invoke lstrcat, addr hostcom, addr com ; host = &quot;smtp.wanadoo.com&quot; <br /></code></pre><br /><br />I think it will be better to use wsprintf here.<br />More compact and faster since you can concatenate several strings in one call (&quot;%s&quot;).<br /><br />I will try to read it more carefully tonight. ;)<br /><br />Bye.</div>
    <div class="meta">Posted on 2001-12-14 05:44:06 by JCP</div>
   </div>
   <div class="post" id="post-14942">
    <div class="subject"><a href="#post-14942">Sending a mail with SMTP</a></div>
    <div class="body">Morgatte - WOW, thanks for posting your code!<br /><br />I, like Readiosys, will have to take a day or so to sift through it. Looks pretty good after a quick look though!<br /><br />What do you plan to do with it?</div>
    <div class="meta">Posted on 2001-12-14 08:09:28 by gscundiff</div>
   </div>
  </div>
 </body>
</html>