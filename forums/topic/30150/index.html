<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Porting to FASM - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=30150" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=30150">Porting to FASM</a></p>
   <div class="post" id="post-212637">
    <div class="subject"><a href="#post-212637">Porting to FASM</a></div>
    <div class="body">Hey all,<br />I was reading a book by Paul Carter entitled &quot;PC Assembly Language&quot; when I reached my first program, I was rather excited until I came upon a problem<br />the book utilizes NASM and DJGPP to create the assembly code however I am using Flat Assembler, observe the book&#039;s &quot;First Program&quot; below<br /><pre><code><br />%include &quot;asm_io.inc&quot;<br /><br />segment .data<br />prompt1 db &quot;Enter a number: &quot; , 0<br />prompt2 db &quot;Enter another number: &quot; , 0<br />outmsg1 db &quot;You entered &quot; , 0<br />outmsg2 db &quot; and &quot;, 0<br />outmsg3 db &quot;, the sum of these is &quot;, 0<br /><br />segment .bss<br /><br />input1 resd1<br />input2 resd1<br /><br />segment .text<br />global _asm_main<br />_asm_main:<br />enter 0,0<br />pusha<br /><br />mov eax, prompt1<br />call print_string<br /><br />call read_int<br />mov , eax<br /><br />mov eax, prompt2<br />call print_string<br /><br />call read_int<br />mov ,eax<br /><br />mov eax, <br />add eax, <br />call print_int<br />mov eax, outmsg2<br />call print_string<br />mov eax, <br />call print_int<br />mov eax, outmsg3<br />call print_string<br />mov eax, ebx<br />call print_int<br />call print_nl<br /><br />popa<br />mov eax,0<br />leave<br />ret<br /><br /></code></pre><br /><strong>Now onto my question how would I port this to FASM (if its possible) and is there a constant set of instructions needed to do this.</strong><br />Here is the Example instructions with all various forms: http://www.drpaulcarter.com/pcasm/<br />at the bottom of the provided link is the example code.<br />Thanks,<br />v0rtex.</div>
    <div class="meta">Posted on 2010-08-12 10:42:19 by v0rtex</div>
   </div>
   <div class="post" id="post-212639">
    <div class="subject"><a href="#post-212639">Re: Porting to FASM</a></div>
    <div class="body"><pre><code>format elf<br />include &quot;asm_io.inc&quot;<br /><br />section &#039;.data&#039;<br />prompt1 db &quot;Enter a number: &quot; , 0<br />prompt2 db &quot;Enter another number: &quot; , 0<br />outmsg1 db &quot;You entered &quot; , 0<br />outmsg2 db &quot; and &quot;, 0<br />outmsg3 db &quot;, the sum of these is &quot;, 0<br /><br />section &#039;.bss&#039; writable<br /><br />input1 resd1<br />input2 resd1<br /><br />section &#039;.text&#039; executable<br />public _asm_main<br /><br />_asm_main:<br />enter 0,0<br />pusha<br /><br />mov eax, prompt1<br />call print_string<br /><br />call read_int<br />mov , eax<br /><br />mov eax, prompt2<br />call print_string<br /><br />call read_int<br />mov ,eax<br /><br />mov eax, <br />add eax, <br />mov ebx, eax<br /><br />dump_regs 1<br />dump_mem 2, outmsg1, 1<br /><br />mov eax, outmsg1<br />call print_string<br />mov eax, <br />call print_int<br />mov eax, outmsg2<br />call print_string<br />mov eax, <br />call print_int<br />mov eax, outmsg3<br />call print_string<br />mov eax, ebx<br />call print_int<br />call print_nl<br /><br />popa<br />mov eax,0<br />leave<br />ret</code></pre>But of course the include file will be missing. I&#039;ve assumed that you intended to create an ELF object file, if you need this for Windows perhaps the linker won&#039;t support this format so you&#039;ll have to use &quot;MS COFF&quot; or &quot;COFF&quot; format instead (check the manual).</div>
    <div class="meta">Posted on 2010-08-12 14:52:47 by LocoDelAssembly</div>
   </div>
   <div class="post" id="post-215170">
    <div class="subject"><a href="#post-215170">Re: Porting to FASM</a></div>
    <div class="body">I have the same problem too, could someone help me?</div>
    <div class="meta">Posted on 2011-10-09 02:49:51 by bolzano_1989</div>
   </div>
   <div class="post" id="post-215175">
    <div class="subject"><a href="#post-215175">Re: Porting to FASM</a></div>
    <div class="body">V0rtex mentions DJGPP. DJGPP uses &quot;COFF&quot; (Common Object File Format) for it&#039;s linkable object files. Windows also uses COFF... but it&#039;s a slightly different version of COFF. If you were using Nasm, you would specify the output format on the command line: &quot;-f coff&quot; for DJGPP COFF, and &quot;-f win32&quot; for MS-COFF. Fasm specifies the output format in the source, so this would have to be added to Dr. Carter&#039;s examples, as LocoDelAssembly shows.<br /><br />Unless I&#039;m mistaken, Fasm will produce either an executable format directly, or a linkable object format. Dr. Carter&#039;s system requires a linkable object file, since he links with C libraries in order to be &quot;portable&quot;. Portability doesn&#039;t happen by magic, it requires some thought (this is true even with C, regardless of what it says in the glossy brochure!). I&#039;m thinking &quot;format elfobj&quot; (I&#039;m not sure how Fasm spells it) might be correct, rather than &quot;format elf&quot;(?).<br /><br />There&#039;s another subtle difference...<br />Nasm:<br /><pre><code><br />section .bss<br />&nbsp; &nbsp; input1 resd 1<br /></code></pre><br />Note the space between &quot;resd&quot; and &quot;1&quot;! The posted code is not quite correct, IMO.<br />Unless I&#039;m mistaken, Fasm uses...<br /><pre><code><br />section &#039;.bss&#039; writable<br />&nbsp; &nbsp; input1 rd 1<br /></code></pre><br /><br />There may be other small differences, but the actual CPU instructions are the same (I&#039;m pretty sure). These small differences would have to be applied to the example files, &quot;asm_io.inc&quot;, and &quot;asm_io.asm&quot;... I think &quot;driver.c&quot; would be okay without any changes(?).<br /><br />Although the differences between Nasm and Fasm are small, they&#039;re enough so that it &quot;won&#039;t work&quot; if it&#039;s not done right. Beginners, struggling to learn assembly language, don&#039;t need any &quot;extra complications&quot;! It might be worth your while to switch to Nasm, at least &quot;for the duration&quot; of working through Dr. Carter&#039;s book and examples.<br /><br />http://www.nasm.us<br /><br />I think the download page is working, although the Forum is down. (if SpooK or synfire or p1ranha know anything about that, clue me in - I can&#039;t even log in to Peter&#039;s machine to check mail at the moment. fbkotler at myfairpoint dot net - always happy to talk about assembly language!)<br /><br />But I know how asm-folk are - we&#039;re a pretty stubborn lot! If you wanna use Fasm, you wanna use Fasm! I&#039;m a &quot;devout Nasmist&quot;, myself (sounds nicer than &quot;Nasm bigot&quot;, but it means the same :) ) I&#039;d probably be using Fasm if I hadn&#039;t already been &quot;hooked&quot; on Nasm when Fasm came out! Nice assembler - Tomasz is doing a terrific job! But I&#039;m not that familiar with the details of it. I&#039;d be glad to conspire with anyone familiar with Fasm to get Dr. Carter&#039;s examples working, if there&#039;s interest in it. (heck, I&#039;m even attempting to write some Gas code lately - boy, do I make a lot of mistakes!)...<br /><br />Fasm has a nice forum. I don&#039;t check it often. There may be some information on this subject already. No harm &quot;reinventing the wheel&quot; - if we didn&#039;t, they&#039;d still be chipped out of granite and have wooden axels - but duplicating work already done is foolish. Some &quot;Fasmist&quot; should check this!<br /><br />Best,<br />Frank<br /><br /></div>
    <div class="meta">Posted on 2011-10-09 10:36:07 by fbkotler</div>
   </div>
  </div>
 </body>
</html>