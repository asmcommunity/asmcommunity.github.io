<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Recognize The WinMain - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22287" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22287">Recognize The WinMain</a></p>
   <div class="post" id="post-167456">
    <div class="subject"><a href="#post-167456">Recognize The WinMain</a></div>
    <div class="body">Need your help......<br /><br />1.How can we identifying the WinMain Function by the Arguments passed to it .<br />2.What are in these eax, esi, ebx.<br /><br />.text:00401804  push   eax<br />.text:00401805  push   esi<br />.text:00401806  push   ebx<br />.text:00401807  push   ebx<br />.text:00401808  call   ds:GetModuleHandleA<br />.text:0040180E  push   eax<br />.text:0040180F  call   _WinMain@16<br />.text:00401814  mov    , eax<br />.text:00401817  push   eax<br />.text:00401818  call   ds:exit<br /><br />Thanx!<br /><br /></div>
    <div class="meta">Posted on 2005-11-02 20:59:58 by iNeedSpeed</div>
   </div>
   <div class="post" id="post-167458">
    <div class="subject"><a href="#post-167458">Re: Recognize The WinMain</a></div>
    <div class="body">Generally it refers to something like this.&nbsp; <br /><br />push CmdShow<br />push lpCmdLine<br />push HINSTANCE,<br />push HINSTANCE,<br />call WinMain proc<br /><br />As a rule when I write the code I name my win procs names I can remember then after compiling with debug symbols easy to identify&nbsp; ;)<br /><br /><br />best regards,<br /><br />czDrillard<br /><br /></div>
    <div class="meta">Posted on 2005-11-02 22:58:16 by czDrillard</div>
   </div>
   <div class="post" id="post-167465">
    <div class="subject"><a href="#post-167465">Re: Recognize The WinMain</a></div>
    <div class="body">yes?thanx?</div>
    <div class="meta">Posted on 2005-11-03 00:50:23 by iNeedSpeed</div>
   </div>
   <div class="post" id="post-167469">
    <div class="subject"><a href="#post-167469">Re: Recognize The WinMain</a></div>
    <div class="body">eax, ebx, ecx, edx, esi, edi, ebp, esp, eip are all the names of the &#39;registers&#39;. &#39;Register&#39; is a 32-bit &#39;variable&#39; which resides inside the CPU (so it&#39;s very fast). There are more registers than these.</div>
    <div class="meta">Posted on 2005-11-03 03:30:42 by ti_mo_n</div>
   </div>
   <div class="post" id="post-167470">
    <div class="subject"><a href="#post-167470">Re: Recognize The WinMain</a></div>
    <div class="body">If you don&#39;t know what registers are I&#39;d suggest reading the basic document every starting assembly programmer should read &quot;The art of assembly&quot; by Randall Hyde (document can be found on google)</div>
    <div class="meta">Posted on 2005-11-03 04:44:10 by Scorpie</div>
   </div>
   <div class="post" id="post-167474">
    <div class="subject"><a href="#post-167474">Re: Recognize The WinMain</a></div>
    <div class="body"><div class="quote"><br />1.How can we identifying the WinMain Function by the Arguments passed to it .<br /></div><br />When YOU write your code, you could always add some NOP&#39;s to the code before the call<br />to winMain, to make it easier to find when you dis-assemble it.<br /><br /></div>
    <div class="meta">Posted on 2005-11-03 08:47:24 by rags</div>
   </div>
   <div class="post" id="post-167482">
    <div class="subject"><a href="#post-167482">Re: Recognize The WinMain</a></div>
    <div class="body">The classical typing with the&nbsp; <span class="mono">invoke</span> statement :<br /><pre><code>invoke WinMain, hInstance,NULL,CommandLine, SW_SHOWDEFAULT</code></pre></div>
    <div class="meta">Posted on 2005-11-03 12:44:50 by Vortex</div>
   </div>
   <div class="post" id="post-167586">
    <div class="subject"><a href="#post-167586">Re: Recognize The WinMain</a></div>
    <div class="body">iNeedSpeed,<br />&nbsp; &nbsp;  The &quot;WinMain&quot; program is the root program in a Windows program.&nbsp; You do not need to set up still another layer of routine calls with &quot;invoke WinMain, hInstance,NULL,CommandLine, SW_SHOWDEFAULT&quot; .&nbsp; Just code what you want to do in WinMain and include the starting label.&nbsp; I never use a call to WinMain is my programs.&nbsp; I can send you the template I use as an example if you like.&nbsp; Ratch</div>
    <div class="meta">Posted on 2005-11-06 10:06:25 by Ratch</div>
   </div>
   <div class="post" id="post-167593">
    <div class="subject"><a href="#post-167593">Re: Recognize The WinMain</a></div>
    <div class="body">to All of you,thank you !<br /><br />Ratch, I am glad with your help.<br />my email : joymyway@163.com.</div>
    <div class="meta">Posted on 2005-11-06 22:29:04 by iNeedSpeed</div>
   </div>
   <div class="post" id="post-167599">
    <div class="subject"><a href="#post-167599">Re: Recognize The WinMain</a></div>
    <div class="body"> iNeedSpeed,<br /><br />&nbsp; &nbsp;  Here is the template.&nbsp; Edit out what you do not want or need.&nbsp; As you can see, you do not need to make any calls to WinMain.&nbsp; Ask if you have any questions. Ratch<br /><br /><br /><pre><code><br />;*****WINMAIN*******************************************************************<br />WMSTRUC STRUC<br /> msg MSG {}&nbsp; &nbsp; &nbsp; ;message structure ****ALWAYS KEEP MSG STRUCTURE AT BEGINNING<br />WMSTRUC ENDS<br /><br />MAIN:<br /> XOR EBP,EBP&nbsp; &nbsp;  ;handy constant zero<br /> SUB ESP,WMSTRUC ;make local space<br /><br /> INVOKE GetModuleHandle,EBP<br /><br /> MOV ESI,EAX&nbsp; &nbsp;  ;now ESI=module handle<br /><br />;*****CLASS REGISTRATION********************************************************<br />APPNAME EQU &#39;%%%%%&#39;<br /> IF TRUE ;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br /> RPUSHIT EBP,LTEXT(szAppName,APPNAME,0)&nbsp; &nbsp; ;for no menu<br /> ELSE ;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;<br /> RPUSHIT LTEXT(szAppName,APPNAME,0),@ szAppName ; for menu <br /> ENDIF ;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br /> IF TRUE ;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br /> PUSH COLOR_WINDOW+1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;for window background color<br /> ELSE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;<br /> INVOKE CreateSolidBrush,WHITE_BRUSH	&nbsp; ;<br /> PUSH EAX<br /> ENDIF ;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br /> INVOKE LoadCursor,EBP,IDC_ARROW<br /> PUSH EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;cursor handle<br /><br /> IF TRUE ;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br /> INVOKE LoadIcon,EBP,IDI_APPLICATION&nbsp; &nbsp; &nbsp; ;EBP=0<br /> ELSE ;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;&lt;<br /> INVOKE LoadIcon,ESI,#########&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;ESI=hInst<br /> ENDIF ;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br /> S1=CS_HREDRAW OR CS_VREDRAW<br /> RPUSHIT S1,@ WINCALLBACK,EBP,EBP,ESI,EAX ;ESI=hInst<br /> INVOKE RegisterClass,ESP<br /><br />IF DBUG<br /> TEST EAX,EAX<br /> .IF ZERO?<br />&nbsp;  INVOKE MessageBox,ESI,TEXT(&#39;Class registration failed.&#39;,0),EBP,EBP ;EBP=0<br />&nbsp;  JMP EXIT<br /> .ENDIF<br />ENDIF<br /><br /> ADD ESP,WNDCLASS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;balance stack from WNDCLASS<br />; ADD ESP,WNDCLASSEX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;balance stack from WNDCLASSEX<br /><br />;*****END OF CLASS REGISTRATION*************************************************<br />;*****WINDOW CREATION***********************************************************<br /><br /> MOV ECX,CW_USEDEFAULT<br /> S1=WS_OVERLAPPEDWINDOW<br /><br /> INVOKE CreateWindowEx,EBP,@ szAppName,@ szAppName,\<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; S1,ECX,ECX,ECX,ECX,EBP,EBP,ESI,EBP ;EBP=0<br />IF DBUG<br /> TEST EAX,EAX<br /> .IF ZERO?<br />&nbsp;  INVOKE MessageBox,ESI,TEXT(&#39;Main CreateWindow call error&#39;,0),EBP,EBP ;EBP=0<br />&nbsp;  JMP EXIT<br /> .ENDIF<br />ENDIF<br /><br /> MOV ,EAX&nbsp; &nbsp; &nbsp; &nbsp; ;window handle <br /> MOV ESI,EAX&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;now ESI=hwnd=window handle<br /><br />;*****END OF WINDOW CREATION****************************************************<br /><br /> INVOKE ShowWindow,ESI,SW_SHOWNORMAL<br /><br /> INVOKE UpdateWindow,ESI<br /><br />IF DBUG<br /> TEST EAX,EAX<br /> .IF ZERO?<br />&nbsp;  INVOKE MessageBox,ESI,TEXT(&#39;UpdateWindow call error&#39;,0),EBP,EBP ;EBP=0<br />&nbsp;  JMP EXIT<br /> .ENDIF<br />ENDIF<br /><br /> MOV EBX,ESP&nbsp; ;EBX=ESP=&amp;msg<br /><br /> .WHILE NOT 0 ;beginning of message loop<br />&nbsp;  INVOKE GetMessage,EBX,EBP,EBP,EBP ;<br />&nbsp;  TEST EAX,EAX<br /><br />&nbsp;  IF DBUG<br />&nbsp; &nbsp; JS GMERR ;jump out on GetMessage error<br />&nbsp;  ELSE<br />&nbsp; &nbsp; JS EXIT&nbsp; ;jump out on GetMessage error<br />&nbsp;  ENDIF<br /><br />&nbsp;  .BREAK .IF ZERO? ;jump out on WM_QUIT message<br /><br />&nbsp;  IF FALSE ;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />&nbsp;  CMP ,EBP<br />&nbsp;  JZ F@<br /><br />&nbsp;  INVOKIT IsDialogMessage,,EBX ;ESI=dialog box handle,EBX=&amp;msg<br />&nbsp;  TEST EAX,EAX<br />&nbsp;  .CONTINUE .IF !ZERO?<br />&nbsp;  @@:<br />&nbsp;  ENDIF ;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br />&nbsp;  IF FALSE ;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;<br />&nbsp;  INVOKE TranslateAccelerator,ESI,,EBX ;EBX=&amp;msg<br /><br />&nbsp;  TEST EAX,EAX<br />&nbsp;  .CONTINUE .IF !ZERO?<br />&nbsp;  ENDIF ;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br /><br />&nbsp;  INVOKE TranslateMessage,EBX ;EBX=&amp;msg<br />&nbsp;  INVOKE DispatchMessage, EBX ;EBX=&amp;msg<br /> .ENDW&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;repeat message loop<br /><br /> MOV EAX,<br /><br />EXIT:<br /> ADD ESP,WMSTRUC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;recover local space<br /><br /> INVOKE ExitProcess,EAX<br /><br />IF DBUG<br />GMERR:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ;display error message via message box &amp; jmp to EXIT<br /> INVOKE MessageBox,ESI,TEXT(&#39;GetMessage call error&#39;,0),EBP,EBP ;EBP=0<br /> JMP EXIT<br />ENDIF<br /><br />;*****END OF WINMAIN************************************************************<br /></code></pre></div>
    <div class="meta">Posted on 2005-11-07 01:11:48 by Ratch</div>
   </div>
   <div class="post" id="post-167603">
    <div class="subject"><a href="#post-167603">Re: Recognize The WinMain</a></div>
    <div class="body">yeah! thank you..................</div>
    <div class="meta">Posted on 2005-11-07 05:57:59 by iNeedSpeed</div>
   </div>
  </div>
 </body>
</html>