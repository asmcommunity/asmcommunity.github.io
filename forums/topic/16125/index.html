<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Environment - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16125" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=16125">Environment</a></p>
   <div class="post" id="post-125069">
    <div class="subject"><a href="#post-125069">Environment</a></div>
    <div class="body">A short example would be nice, a tutorial would be nicer. <br /><br />How do I set up custom system environments from within HLA  code (is it even possible)?<br /><br />The only other way I can think of is to set up a program-local environment and search for files in each location manually until found.</div>
    <div class="meta">Posted on 2003-11-21 20:48:58 by Kain</div>
   </div>
   <div class="post" id="post-125082">
    <div class="subject"><a href="#post-125082">Re: Environment</a></div>
    <div class="body"><div class="quote"><br />A short example would be nice, a tutorial would be nicer. <br /><br />How do I set up custom system environments from within HLA  code (is it even possible)?<br /><br />The only other way I can think of is to set up a program-local environment and search for files in each location manually until found. </div><br /><br />You can set up an environment variable for the current process, but the changes are lost when the process quits. The only way to set global environment variables is through the registry.  The initHLA.HLA application provides an example of this.<br /><br />I assume this is what you're asking about.<br /><br />There is a Win32 API function call for manipulating environment variables. I don't have the reference handy right now. But adding environment variable support to the ARGs module wouldn't be a bad idea at all. Having a module to read and modify INI files would be nice, too.<br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-11-22 01:37:42 by rhyde</div>
   </div>
   <div class="post" id="post-125119">
    <div class="subject"><a href="#post-125119">Environment</a></div>
    <div class="body">I'm more interested in the temporary process environment saved into (and loaded from) an ini file rather than modifying the registery.<br /><br />I don't want anybody messing around with my registry (they have a tendency to pollute).   on the same note, I don't like to mess around with somebody else's registry.</div>
    <div class="meta">Posted on 2003-11-22 13:22:08 by Kain</div>
   </div>
   <div class="post" id="post-125159">
    <div class="subject"><a href="#post-125159">Environment</a></div>
    <div class="body"><div class="quote"><br />I'm more interested in the temporary process environment saved into (and loaded from) an ini file rather than modifying the registery.<br /><br />I don't want anybody messing around with my registry (they have a tendency to pollute).   on the same note, I don't like to mess around with somebody else's registry. </div><br /><br />Here are some Win32 API functions you should look at:<br /><br />ExpandEnvironmentStrings<br />FreeEnvironmentStrings<br />GetEnvironmentStrings<br />GetEnvironmentVariable<br />SetEnvironmentVariable<br /><br />These functions are part of the kernel32.lib module. You can find documentation for kernel32 here:<br /><a target="_blank" href="http://webster.cs.ucr.edu/Page_win32/0_win32asm.html">http://webster.cs.ucr.edu/Page_win32/0_win32asm.html</a><br /><br />Keep in mind that whenever Windows returns a string to an application, it is a zero terminated string, not an HLA string. Therefore, you might want to run the return strings through a function like conv.cStrToStr or something similar if you want to process these strings using HLA string functions.<br /><br />Note, btw, that you'll get the prototypes for the above by including the &quot;w.hhf&quot; header file.<br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-11-23 00:16:13 by rhyde</div>
   </div>
   <div class="post" id="post-125168">
    <div class="subject"><a href="#post-125168">Environment</a></div>
    <div class="body">Thanks.  I didn't know where to start, this has been much help</div>
    <div class="meta">Posted on 2003-11-23 02:49:01 by Kain</div>
   </div>
  </div>
 </body>
</html>