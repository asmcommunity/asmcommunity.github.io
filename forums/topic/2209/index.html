<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Creating Multiple Windows - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2209" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2209">Creating Multiple Windows</a></p>
   <div class="post" id="post-13951">
    <div class="subject"><a href="#post-13951">Creating Multiple Windows</a></div>
    <div class="body">I'm trying to break my habit of always using dialogs, and starting to code using 'real' windows instead.  I've run into a problem though, and I'm sure I'm overlooking something.  I've got two (possibly another one too, haven't decided yet) windows--the main window and an about-type window (a regular window not ShellAbout) that I'd like to create when the 'about' menu item gets clicked.<br /><br />So I'm trying to subclassing the about window and it's got it's own wndproc.  I've tried assigning this wndproc in it's WNDCLASSEX struct as well as later on using SetWindowLong.  Neither method worked, so I tested the return of the CreateWindowEx (for the about win) call and it was 0.  I used the GetErrDescription function in the masmlib (pity it can't retrieve more 'useful' info) and it spit out something along the lines of 'error 87:  Incorrect parameters', but everything looks alright to my glazed over (from staring at qeditor all day) eyes.<br /><br />Does anyone know where I can check an example of a single masm program which uses more than one (regular, non mdi) windows with their own wndprocs?<br /><br />I can post my code if it's needed to answer my question, but right now it's big (for me at least), around 600+ lines at last count and I've got a monumental headache so if I don't have to read through it cutting out only the code in question it'll make my day!  :)<br /><br />Incidentally does one of those new fangled asm IDE's have some sort of feature which (like the hll IDE's) gives you a list on the side of your procs or whatever and let you instantly jump to that section of your code?  That'd be wonderful.</div>
    <div class="meta">Posted on 2001-12-04 16:00:06 by Will</div>
   </div>
   <div class="post" id="post-13960">
    <div class="subject"><a href="#post-13960">Creating Multiple Windows</a></div>
    <div class="body">have u tested it without subclasing yet? also i wouldnt mind seeing some source code.</div>
    <div class="meta">Posted on 2001-12-04 17:50:05 by smurf</div>
   </div>
   <div class="post" id="post-13964">
    <div class="subject"><a href="#post-13964">Creating Multiple Windows</a></div>
    <div class="body">I believe that ketilO's RADasm has the jump-to-function feature that were asking about.<br /><br />With your About window, are you assigning it a parent when you create it?</div>
    <div class="meta">Posted on 2001-12-04 18:10:35 by sluggy</div>
   </div>
   <div class="post" id="post-13992">
    <div class="subject"><a href="#post-13992">Creating Multiple Windows</a></div>
    <div class="body">Hi 4oh4,<br /><br />If I understand you right you want to call 'about' window for example instead of 'about' dialog box.  If this is so you click on 'about' menu item in your main window and register new class of window.  point to your about proc and register and create window.  when your done with it to close call destroy window and unregisterClass.  (I don't know if this last is necessary but I always do it).<br /><br />hope this is helpful,<br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2001-12-05 01:22:15 by czDrillard</div>
   </div>
   <div class="post" id="post-13994">
    <div class="subject"><a href="#post-13994">Creating Multiple Windows</a></div>
    <div class="body">smurf:<br />At first I wrote the code for both windows in two separate files until I got the control placement the way that I wanted them and everything was working.  Now I'm just trying to sort of combine both of them into one program.  I've tried it with and without subclassing, using the same wndproc for both at first.  When that didn't work I thought that maybe I *had* to subclass each additional window.  I'm attaching an example of what I *want* to do.  There's some comments just to let you know why I did things the way I did.  I'm sure it's something silly.<br /><br />sluggy:<br />Thanks for the radasm suggestion.  I dl'ed it and tried it.  Honestly I wish there was an ide somewhere in between that and qeditor.  It'll be hard to get used to all the extra stuff, although I do like the rsrc editor and syntax highlighting.  I haven't fully explored it yet, but I hope that the syntax coloring is adjustable.<br />I've tried it with and without assigning a parent hwnd in the CreateWindowEx call, but shouldn't I assign it?<br /><br /><br />thanks for looking at the code and I'm sure it's something basic that I'm not understanding.<br /><br />-----------------------------------------------<br />edited cause our posts crossed cz<br /><br />I think I understand the basic concept of it.  It's just that the call to CreateWindowEx for the about window is failing and I can't seem to figure out why.  But you're absolutely right.  That's exactly what I'm trying to do.</div>
    <div class="meta">Posted on 2001-12-05 01:30:38 by Will</div>
   </div>
   <div class="post" id="post-14000">
    <div class="subject"><a href="#post-14000">Creating Multiple Windows</a></div>
    <div class="body">I just checked one of your examples (the mouse-over button one) cz, and I understand it now.  My code was almost completely wrong.</div>
    <div class="meta">Posted on 2001-12-05 02:39:24 by Will</div>
   </div>
  </div>
 </body>
</html>