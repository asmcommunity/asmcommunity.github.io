<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ASSUME directive in HLA? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13495" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=13495">ASSUME directive in HLA?</a></p>
   <div class="post" id="post-104542">
    <div class="subject"><a href="#post-104542">ASSUME directive in HLA?</a></div>
    <div class="body">started playing around with the HLA assembler tonight, and I must say I am mighty impressed, the code structure is very neat and the hla standard lib is amazing!! anyway, I am slowly grasping the extended syntax and am happily converting some of my masm programs to hla. However, I ran in to a little problem just now, basically I was wondering if there is a equivalent in hla to masm's ASSUME directive. the assume directive in masm basially allows you to set a register as a pointer to a predefined struct, so you can do<br /><br />assume 	eax : ptr dummystruct<br />mov 	.dummyparameter, NULL<br /><br />where dummyparameter is of course a structure field of dummystruct.<br /><br />when looking through the (massive!!) HLAref the only thing I found was the pointer to base_type, which<br />is nice and all, but doesn't allow you to type a register, right? instead if I created a pointer to base type it<br />would be either stack based or placed in the data section.<br /><br />type p_dummystruct: pointer to dummystruct<br /><br />which I can then create in the static data seg as for example:<br />pDS: p_dummystruct;<br /><br />and use in program:<br />mov(&amp;of_a_dummystruct, pDS);<br />mov(1, pDS.dummyparameter);<br /><br />assuming this works, is there any way I can temporarily cast a register as a pointer type?<br /><br /><br />I'm probably not making any sense here, too tired to think straight...<br /><br />oh, and before I go to sleep, another thing. I was doing some winsock stuff, and since there wasn't any winsock hhf I threw together a ws2_32.hhf myself in a hurry, just the functions I needed. anyway all worked fine except for the 'socket' function which generated errors, seemingly colliding with the SOCKET type definition, so I had to rename the socket function to something like createsocket in order to get it to work, not a big hassle, but I was wondering if there was some way around this, since hla seems to regard SOCKET and socket as the same definition?<br /><br />once more I must say from what I've seen hla is a masterpiece, the overhead generated isn't much from what I've seen studying the generated masm code and even that can be avoided if one wants to do it all by hand so to speak, also the hla standard lib seems just incredible, and I haven't even started glancing at the classes and objects yet,  this will be a ride!<br /><br />but first I must sleep....</div>
    <div class="meta">Posted on 2003-05-23 18:31:00 by BinarySoup</div>
   </div>
   <div class="post" id="post-104601">
    <div class="subject"><a href="#post-104601">ASSUME directive in HLA?</a></div>
    <div class="body">Quick answer on the first question is:<br /><br /><pre><code><br />       mov&#40;NULL, &#40;type  dummystruct  &#91;eax&#93;&#41;.dummyparameter&#41;;<br /></code></pre><br /><br />You can also look at Iczelion tutorials converted to HLA (tutorials #02 - 15 included in example folder of HLA package, tutorials # 16-32 are in this msgboard &quot;Iczelion tutorials converted&quot; thread)</div>
    <div class="meta">Posted on 2003-05-24 11:23:13 by Green Joe</div>
   </div>
   <div class="post" id="post-104613">
    <div class="subject"><a href="#post-104613">ASSUME directive in HLA?</a></div>
    <div class="body">thanks!, the ability to type-cast registers on a instruction by instruction basis is great, hla really is a small dream come true! oh and great work on the iczelion tuts, I just checked them, great information there for masm32-&gt;hla. by the way, are there anywhere one can find hhf includes for other win32 libraries other than those included in the hla package? I have converted parts of ws2_32 myself for my own needs, but I was hoping there had been others converted?</div>
    <div class="meta">Posted on 2003-05-24 13:47:40 by BinarySoup</div>
   </div>
   <div class="post" id="post-104618">
    <div class="subject"><a href="#post-104618">ASSUME directive in HLA?</a></div>
    <div class="body">The only hhf I aware of is share32.hhf. <br />I did it manually and included with Tutorial #23. While it wasn't much work with this hhf, becouse it is relatively small, it is not a good idea to make hhfs manually. Much better solution would be to write a tool that convert MASM incs to HLA hhfs. I believe it is not a great challenge to create such small command line utility.</div>
    <div class="meta">Posted on 2003-05-24 14:24:49 by Green Joe</div>
   </div>
   <div class="post" id="post-104640">
    <div class="subject"><a href="#post-104640">ASSUME directive in HLA?</a></div>
    <div class="body">yeah you're right, shouldn't be impossible to write a program that creates a hhf based on the output of a dumpbin symbol table.</div>
    <div class="meta">Posted on 2003-05-24 17:29:28 by BinarySoup</div>
   </div>
   <div class="post" id="post-104643">
    <div class="subject"><a href="#post-104643">ASSUME directive in HLA?</a></div>
    <div class="body">Tutorial #21 even explain how to do it... thru Pipe ... To redirect output from dumpbin to your program,<br />compute how many parameters each function excepts and write apropreate prototype to hhf file.<br /><br />Converting structs is more difficult task.... at least it seems so.</div>
    <div class="meta">Posted on 2003-05-24 17:50:03 by Green Joe</div>
   </div>
   <div class="post" id="post-104747">
    <div class="subject"><a href="#post-104747">Re: ASSUME directive in HLA?</a></div>
    <div class="body"><div class="quote"><br />started playing around with the HLA assembler tonight, and I must say I am mighty impressed, the code structure is very neat and the hla standard lib is amazing!! anyway, I am slowly grasping the extended syntax and am happily converting some of my masm programs to hla. However, I ran in to a little problem just now, basically I was wondering if there is a equivalent in hla to masm's ASSUME directive. the assume directive in masm basially allows you to set a register as a pointer to a predefined struct, so you can do<br /><br />assume 	eax : ptr dummystruct<br />mov 	.dummyparameter, NULL<br /><br />where dummyparameter is of course a structure field of dummystruct.<br /><br /></div><br /><br />In HLA, the way you would do this is via type coercion and TEXT constants,<br />e.g.,<br /><br />const<br />    eaxdp :text := &quot;(type dummystruct )&quot;;<br />      .<br />      .<br />      .<br />   mov( NULL, eaxdp.dummyparameter );  // eaxdp expands to the string above...<br /><br /><br /><br /><br /><div class="quote"><br />when looking through the (massive!!) HLAref the only thing I found was the pointer to base_type, which<br />is nice and all, but doesn't allow you to type a register, right? instead if I created a pointer to base type it<br />would be either stack based or placed in the data section.<br /><br />type p_dummystruct: pointer to dummystruct<br /><br />which I can then create in the static data seg as for example:<br />pDS: p_dummystruct;<br /><br />and use in program:<br />mov(&amp;of_a_dummystruct, pDS);<br />mov(1, pDS.dummyparameter);<br /><br />assuming this works, is there any way I can temporarily cast a register as a pointer type?<br /><br /></div><br /><br />Yes, the type coercion operator:  (type &lt;typename&gt; &lt;objectToCast&gt;)<br /><br />Often, this involves quite a bit of extra typing, so if you do it often, using<br />the TEXT assignment becomes quite useful.<br /><br /><div class="quote"><br /><br />I'm probably not making any sense here, too tired to think straight...<br /><br />oh, and before I go to sleep, another thing. I was doing some winsock stuff, and since there wasn't any winsock hhf I threw together a ws2_32.hhf myself in a hurry, just the functions I needed. anyway all worked fine except for the 'socket' function which generated errors, seemingly colliding with the SOCKET type definition, so I had to rename the socket function to something like createsocket in order to get it to work, not a big hassle, but I was wondering if there was some way around this, since hla seems to regard SOCKET and socket as the same definition?<br /></div><br /><br />Nope, no easy way around it. HLA uses a &quot;case neutrality&quot; convention<br />unlike C's (horrible) case sensitive convention.  There are two solutions to this<br />problem -<br /><br />1. put your definition in a (different) namespace (or put the original definition in a<br />    namespace).<br /><br />2. Use some sort of suffix or prefix character sequence to differentiate them.<br /><br />For example, within the w.hhf header file I attempt to use a &quot;_c&quot; suffix for constants<br />that conflict with other identifiers or &quot;_t&quot; for type names that conflict with other identifiers.<br />(and leave the more commonly used ID of the two alone).<br /><br />Some might claim that changing HLA's case neutrality feature to case sensitive would<br />solve the problem. This is not at all true.  There are still problems that have to be dealt<br />with such as C identifiers that conflict with HLA reserved words.  Fortunately, namespaces<br />solve most of the problems and the suffix tricks handles the few cases where namespaces<br />just aren't sufficient.<br /><br /><br /><div class="quote"><br />once more I must say from what I've seen hla is a masterpiece, the overhead generated isn't much from what I've seen studying the generated masm code and even that can be avoided if one wants to do it all by hand so to speak, also the hla standard lib seems just incredible, and I haven't even started glancing at the classes and objects yet,  this will be a ride!<br /><br />but first I must sleep.... </div><br /><br />Yeah, me too!<br />Thanks for the kind words.<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-05-25 13:33:45 by rhyde</div>
   </div>
   <div class="post" id="post-105038">
    <div class="subject"><a href="#post-105038">ASSUME directive in HLA?</a></div>
    <div class="body">Randall Hyde wrote:<br /><div class="quote">In HLA, the way you would do this is via type coercion and TEXT constants,</div> <br />ahh text constants, I knew there was something better in this world than copy/paste, sweet stuff :D<br /><br /><br />Randall Hyde wrote:<br /><div class="quote">1. put your definition in a (different) namespace (or put the original definition in a<br />namespace).<br />2. Use some sort of suffix or prefix character sequence to differentiate them.<br /></div><br /><br />hmmm.. well, neither of these are perhaps a good solution in this case, SOCKET definition collides with socket function, both in the 'w' namespace. moving socket or SOCKET out into another namespace seems wrong. and really, any naming convention that allows both a data definiton and a function to carry the same name albeit with different case:ing is really stupid in my book, so I'll probably stick to using 'createsocket' instead of 'socket', looks better next to 'closesocket' anyways ;)<br /><br /> <br />Randall Hyde wrote:<br /><div class="quote">Thanks for the kind words.</div><br /><br />you are very welcome, and thank YOU for HLA, I'm currently trying to read up on the powerful macro system, and from what little my small brain can grasp, it is truly great!</div>
    <div class="meta">Posted on 2003-05-27 18:39:28 by BinarySoup</div>
   </div>
   <div class="post" id="post-105067">
    <div class="subject"><a href="#post-105067">ASSUME directive in HLA?</a></div>
    <div class="body"><div class="quote"><br />yeah you're right, shouldn't be impossible to write a program that creates a hhf based on the output of a dumpbin symbol table. </div><br /><br />Actually, the original HLA header files for Windows were created by writing a short program that did exactly this.  Worked great for all the API functions (still had to do the parameter names and types manually, but this saved quite a bit of effort). The windows.hhf header file was originally created by writing a program that manipulated the windows.inc header file that comes with the MASM32 package.  Still require a bit of manual manipulation, but at 17,000 lines of code, any automation at all is a tremendous help!<br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-05-27 23:56:47 by rhyde</div>
   </div>
  </div>
 </body>
</html>