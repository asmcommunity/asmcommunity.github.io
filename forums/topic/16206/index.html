<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>localized string resources - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16206" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16206">localized string resources</a></p>
   <div class="post" id="post-125719">
    <div class="subject"><a href="#post-125719">localized string resources</a></div>
    <div class="body">I made a resource script with two languages, so I get automatically german texts on a german windows and english on an english one:<pre><code>	STRINGTABLE LANGUAGE LANG_ENGLISH, SUBLANG_NEUTRAL<br />	BEGIN<br />		IDS_HELP						&quot;Help&quot;<br />		...<br />	END<br /><br />	STRINGTABLE LANGUAGE LANG_GERMAN, SUBLANG_NEUTRAL<br />	BEGIN<br />		IDS_HELP						&quot;Hilfe&quot;<br />		...<br />	END</code></pre>now I have two questions: if I use LoadString Windows decides, which language to load. Can I change this decicion to another language? Something like SetGlobalLanguage (ID) would be fine :) ... other question: some strings are identical in both languages, can I make a third section with LANGUAGE_NEUTRAL, that contains the equal strings for all languages?</div>
    <div class="meta">Posted on 2003-11-27 05:23:30 by beaster</div>
   </div>
   <div class="post" id="post-125724">
    <div class="subject"><a href="#post-125724">localized string resources</a></div>
    <div class="body">Afternoon, beaster.<br /><br />Is this what you're looking for? ...<br /><br /><div class="quote"><br />Platform SDK: International Features <br />SetThreadLocale<br />The SetThreadLocale function sets the calling thread's current locale. <br /><br />BOOL SetThreadLocale (<br />  LCID Locale   // locale identifier<br />);<br />Parameters<br />Locale <br /> Specifies the new locale for the calling thread. This parameter can be a locale identifier created by the MAKELCID macro, or one of the following predefined values. Value Meaning <br />LOCALE_SYSTEM_DEFAULT Default system locale. <br />LOCALE_USER_DEFAULT Default user locale. <br /><br /><br />For more information, see Locales. <br /><br />Return Values<br />If the function succeeds, the return value is a nonzero value. <br /><br />If the function fails, the return value is zero. To get extended error information, call GetLastError. <br /><br />Remarks<br />When a thread is created, it uses the system default thread locale. The system reads the system default thread locale from the registry when the system boots. This system default can be modified for future process and thread creation using Control Panel's International application. <br /><br />The SetThreadLocale function affects the selection of resources that are defined with a LANGUAGE statement. This affects such functions as CreateDialog, DialogBox, LoadMenu, LoadString, and FindResource, and sets the code page implied by CP_THREAD_ACP, but does not affect FindResourceEx. <br /><br />Requirements <br />  Windows NT/2000 or later: Requires Windows NT 3.1 or later.<br />  Windows 95/98/Me: Unsupported.<br />  Header: Declared in Winnls.h; include Windows.h.<br />  Library: Use Kernel32.lib.<br /><br />See Also<br />National Language Support Overview, National Language Support Functions, CreateDialog, DialogBox, LoadMenu, LoadString, FindResource, GetThreadLocale, GetSystemDefaultLCID, GetUserDefaultLCID, MAKELCID <br /><br />Microsoft Platform SDK, February 2001 Edition.<br />This content last built on Thursday, February 01, 2001.<br /></div><br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2003-11-27 06:57:04 by Scronty</div>
   </div>
   <div class="post" id="post-125784">
    <div class="subject"><a href="#post-125784">localized string resources</a></div>
    <div class="body">I know you can change the langid with FormatMessage but with LoadString I don't know</div>
    <div class="meta">Posted on 2003-11-27 12:41:51 by greenant</div>
   </div>
   <div class="post" id="post-125821">
    <div class="subject"><a href="#post-125821">localized string resources</a></div>
    <div class="body">ah thanks, SetThreadLocale seems to be what I was looking for, unfortunately its not for Win9X. Maybe I will write a helper function with FindResource and LoadResource, that can do something like LoadLocalString (hIntance, idString, idLang, pszText)</div>
    <div class="meta">Posted on 2003-11-28 06:35:02 by beaster</div>
   </div>
   <div class="post" id="post-125822">
    <div class="subject"><a href="#post-125822">localized string resources</a></div>
    <div class="body">...or you could code your own string localization stuff :)</div>
    <div class="meta">Posted on 2003-11-28 06:44:53 by f0dder</div>
   </div>
  </div>
 </body>
</html>