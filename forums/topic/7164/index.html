<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>detect if program has been run once and if yes change passwo - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7164" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7164">detect if program has been run once and if yes change passwo</a></p>
   <div class="post" id="post-51831">
    <div class="subject"><a href="#post-51831">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">hey guys I was thinking and thought maybe if I got the program to run once then change its password this would be a good protection scheme. Like for example, the person runs the program, and if he puts the right password in, it places a registry key in his/her registry and then he is able to run the program as many times as he wants but after he puts in the right reg key, it changes so if he tries to make a keygen for it/give out the key it wont work because the key will be different for each program (this is a small distributed program and only want a few peopletouse it so I will just make a seperate key for each person but like they say, you cant trust anyone these days lol). How would I make the program modify itself to change the key? thx.<br /><br />RIF</div>
    <div class="meta">Posted on 2002-08-05 21:06:11 by resistance_is_futile</div>
   </div>
   <div class="post" id="post-51846">
    <div class="subject"><a href="#post-51846">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">Evilz crackerz will patch the program... (the old &quot;bad boy -&gt; good boy&quot; method)<br />Imho, it is not a solution that will prevent cracking...<br />If it is distributed to few people, mark each executable with a different signature ID for each guy/customer... if you find it in some websites <em>freely</em>, you can check for the signature and know from who diffused it... (and then, stopping distributing software to this person, and eventually contact your lawyer).<br /><br />If you make an external program that modify your main program and put encrypted information (Company, name, etc) in unused room (padding, or anything else), theres many chances it will be unnoticed and by decrypting the fields with your external program, you will be able to know to whom it belongs... (the name, compagny, will appear).<br /><br />That is heavy and doesn't prevent illegal diffusions, but you can know who diffuse your software and do something about that...</div>
    <div class="meta">Posted on 2002-08-06 00:53:29 by JCP</div>
   </div>
   <div class="post" id="post-51850">
    <div class="subject"><a href="#post-51850">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">the user can create a copy of your program before installation and before entering the reg. key. Its' still not a good idea.<br /><br />If you really want this form of protection you better be the one to install the program(personally).</div>
    <div class="meta">Posted on 2002-08-06 01:04:03 by stryker</div>
   </div>
   <div class="post" id="post-51853">
    <div class="subject"><a href="#post-51853">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">lol u guys are so smart its crazy. I would have never thought of copying it before they started the program up! I still need to add a protection scheme of some kind though. Any suggestions. Examples are great because I still dont get the whole crc thing. Protection schemes arent my thing. :mad:</div>
    <div class="meta">Posted on 2002-08-06 01:17:50 by resistance_is_futile</div>
   </div>
   <div class="post" id="post-51855">
    <div class="subject"><a href="#post-51855">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">Here's a very simple one. I'm too tired to give an example but this one will show you a <strong>very weak</strong> name-regcode thingy.<br /><br />1. Create 2 edit boxes(1 for the name, 1 for the reg code) and 1 button<br />2. Think of a string. E.G. stryker.<br />3. Find the CRC of the string &quot;stryker&quot;<br />4. Store this CRC value on the data segment or anywhere you wanted it to...<br />5. This string &quot;stryker&quot; is the name of the customer which is to be typed in the first edit box. The CRC value is the one to be typed in the second edit box.<br /><br />Now onto the main event...<br /><br />6. When the user clicks the button, get the text on the first edit control<br />7. CRC this string<br />8. compare this CRC value and the regcode entered on the second edit box and the CRC value <strong>personally embedded on the application</strong>.<br /><br />...<br /><br />I'm sure you can handle from here. Search for CRC on this board, there's a lot. I have a sample code here <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=6270&amp;perpage=15&amp;highlight=CRC&amp;pagenumber=2">http://www.asmcommunity.net/board/index.php?topic=6270&amp;perpage=15&amp;highlight=CRC&amp;pagenumber=2</a><br /><br />For me, I don't see anything wrong with name-regcode or serial number protection because I know it will be cr*cked. Why put much time on protections if I knew it will be cracked? Just make sure your app can stop &quot;newbies&quot; from cr*cking it.<br /><br />Remember, most computer users aren't aware cr*cks, serials exists. So, don't worry too much.<br /><br />A stable, optimized, fast program with many awesome features is the best protection of your investments. ;)<br /><br />There's still a lot of things I could say, but I'm really really really too tired right now. :)</div>
    <div class="meta">Posted on 2002-08-06 01:46:31 by stryker</div>
   </div>
   <div class="post" id="post-51994">
    <div class="subject"><a href="#post-51994">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">okay I downloaded your example. the crc32 one and its helped a lot. I think I will go with crc32 but a little twist will be added :D.</div>
    <div class="meta">Posted on 2002-08-06 16:28:42 by resistance_is_futile</div>
   </div>
   <div class="post" id="post-52014">
    <div class="subject"><a href="#post-52014">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">hey guys having a bit of trouble with crc heh.. okay first in your example stryker, you use .686 mode. I was wondering can I use .386 instead and if so how would i get the .ash to compile right? this is an error i get when I try to get it to work in .386:<br /><br />Assembling: register.asm<br />crc32.ash(21) : error A2085: instruction or register not accepted in current CPU mode<br />crc32.ash(58) : error A2189: invalid combination with segment alignment : 8<br />register.asm(91) : fatal error A1010: unmatched block nesting : .if-.repeat-.while<br /><br />Make error(s) occured.<br /><br />Also when I change to .686 in RADASM it compiles right but then the system becomes unstable (errors pop up) and the program closes right away. This is the code I think is causing problems when I try to run it in .686 mode:<br /><pre><code><br />.if wParam==1002<br />		invoke  GetDlgItemText,hWin,IDC_EDT1,addr nm,20<br />		invoke  lstrlen,OFFSET nm<br />        invoke  crc32,OFFSET nm,eax<br />        invoke  GetDlgItemText,hWin,IDC_EDT3,addr ket,100<br />        <br />        cmp ket,eax<br />        je good<br />        jne bad<br />        .endif<br />        good&#58;<br />        invoke  MessageBox,hWin,goodtxt,goodcap,MB_OK<br />        bad&#58;<br />        invoke  MessageBox,hWin,badtxt,badcap,MB_OK<br />		<br /></code></pre><br /><br />The nm buffer is where the name is stored then &quot;crc&quot;ed and ket is where the key is stored. Then it compares the &quot;crc&quot;ed key with the key the user put in and if they are equal it jumps to good and if not it jumps to bad. Then it displays a message box depending on the situation but like i said, this isnt working right..someone help pls. Thx.<br /><br />RIF</div>
    <div class="meta">Posted on 2002-08-06 18:28:02 by resistance_is_futile</div>
   </div>
   <div class="post" id="post-52015">
    <div class="subject"><a href="#post-52015">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">The CRC algorithm created by Nexo uses the cmov?? instruction. It's only accepted in .686 mode.<br /><br />Try this if it works.<pre><code>.if wParam==1002<br />invoke  GetDlgItemText,hWin,IDC_EDT1,addr nm,20<br />invoke  lstrlen,OFFSET nm<br />        invoke  crc32,OFFSET nm,eax<br />        invoke  GetDlgItemText,hWin,IDC_EDT3,addr ket,100<br />       <br />        cmp ket,eax<br />        je good<br />        invoke  MessageBox,hWin,badtxt,badcap,MB_OK<br />        jmp @F<br />        <br />        good&#58;<br />        invoke  MessageBox,hWin,goodtxt,goodcap,MB_OK<br />        @@&#58;<br />        <br />.endif<br /></code></pre>Anyway the code is still wrong since your getting the text on IDC_EDT3 use GetDlgItemInt instead or convert the text into a dword value using atodw. Your also not saving the crc value. Do something like this<br /><br />- CRC<br />- Save the value to a variable or push/pop<br />- Get the int value on IDC_EDT3<br />- compare the CRC, int value on IDC_EDT3, ...<br /><br />CRC value returned in EAX by the crc32 procedure will be destroyed by GetDlgItemText or GetDlgItemInt.<br /><br />I assume IDC_EDT3 is the registration code edit control??</div>
    <div class="meta">Posted on 2002-08-06 18:39:20 by stryker</div>
   </div>
   <div class="post" id="post-52021">
    <div class="subject"><a href="#post-52021">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">Yes the IDC_EDT3 is the edit control for the registration key..Also IDC_EDT1 is the name control. The coee you posted worked for the most part but when I push register I get another error lol. What is the difference between GetDlgItemInt and the other? I mean I know GetDlgItemInt will change it to an integer value but then it wont work right will it? Would this work if I did my code like this:<br /><pre><code><br />.if eax==WM_INITDIALOG<br />		push	hWin<br />		pop		hWnd<br />	.elseif eax==WM_COMMAND<br />		mov		eax,wParam<br />		and		eax,0FFFFh<br />		.elseif wParam==1002<br />		invoke  GetDlgItemInt,hWin,IDC_EDT1,NULL,FALSE<br />		mov nm,eax<br />		invoke  GetDlgItemInt,hWin,IDC_EDT3,NULL,FALSE<br />		mov ket,eax<br />        invoke  lstrlen,OFFSET nm<br />        invoke  crc32,OFFSET nm,eax<br />       <br />        cmp ket,eax<br />        je good<br />         invoke  MessageBox,hWin,badtxt,badcap,MB_OK<br />        jmp @F<br />         good&#58;<br />        invoke  MessageBox,hWin,goodtxt,goodcap,MB_OK<br />        @@&#58;<br />               <br />.endif<br /></code></pre><br /><br />I tried it and it doesnt say anything when I enter the name and reg key and push the button. Like when i enter both correctly and push register, it does not display any type of messages same for wrong key and name and no key and name... :mad:</div>
    <div class="meta">Posted on 2002-08-06 19:42:18 by resistance_is_futile</div>
   </div>
   <div class="post" id="post-52023">
    <div class="subject"><a href="#post-52023">detect if program has been run once and if yes change passwo</a></div>
    <div class="body"><pre><code>.elseif eax==WM_COMMAND<br />    mov eax,wParam<br />    .IF ax==ButtonID<br />        shr eax,16<br />        .IF ax==BN_CLICKED<br />            invoke  GetDlgItemText, hWin, IDC_EDT1, offset nm, sizeof nm<br />            invoke  lstrlen, OFFSET nm<br />            invoke  crc32, OFFSET nm,eax<br />            push    eax<br />            invoke  GetDlgItemInt, hWin, IDC_EDT3, OFFSET lpTranslated, FALSE<br />            pop     edx<br />            .IF&#40;edx == eax&#41;<br />                ;Good<br />                ;Additional Comparisons here.<br />            .ELSE<br />                ;Bad<br />            .ENDIF<br />        .ENDIF<br />    .ENDIF<br />.else<br />    ;DefWindowProc<br />.endif</code></pre><br /><br />- Get the string with GetDlgItemText<br />- Find the CRC value of this string<br />- push this value<br />- Get the value with GetDlgItemInt<br />- pop a value from the stack into edx<br />- compare if the CRC value of the name entered is the same as the registration code<br />- ...<br /><br /><br />Please refer to PSDK or MSDN so you will not be confused as to what API I should use and what kind of parameters should I pass.<br /><br /><br /><br />If you want an example I can give you one. But if you prefer to learn it... ;)</div>
    <div class="meta">Posted on 2002-08-06 20:05:54 by stryker</div>
   </div>
   <div class="post" id="post-52026">
    <div class="subject"><a href="#post-52026">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">Yes I would prefer to learn it but like most people I learn better by example. But I dont want it to be handed to me..</div>
    <div class="meta">Posted on 2002-08-06 20:37:45 by resistance_is_futile</div>
   </div>
   <div class="post" id="post-52029">
    <div class="subject"><a href="#post-52029">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">Well I have tried pretty much everything so I guess Im going to quit on it because I dont know what else to do to get it to work. Thx for all the help guys.</div>
    <div class="meta">Posted on 2002-08-06 20:58:15 by resistance_is_futile</div>
   </div>
   <div class="post" id="post-52033">
    <div class="subject"><a href="#post-52033">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">I didn't use CRC since it's so widely use. Instead I use my own hasher.<br /><br />Name: stryker<br />Registration Code: 16777202<br /><br />And before the mods or any guest who will be alarmed by the name and registration code I just listed. The zipped file is not a tut on cr*cking nor is it a commercial software. The attached zipped file is a program I created to give an example of how a <strong>basic</strong> registration protection is done. Of course the approach I have here is very weak and should not be used on any other means aside from being an example. :)<br /><br />P.S. There are no fancy shwansy code/features but just a simple getstring-hash-compare<br /><br />Hey!!! look at my post count 1001 :)</div>
    <div class="meta">Posted on 2002-08-06 22:16:18 by stryker</div>
   </div>
   <div class="post" id="post-52039">
    <div class="subject"><a href="#post-52039">detect if program has been run once and if yes change passwo</a></div>
    <div class="body">hey i got it working finally!!!!!!!!!!!!!!!!! With a little help from a messagebox after each step in the program I figured out what the problem was. Here is my final code. I threw in some extra things to confuse the cr*cker a little bit but doubt it would too much. I just add to the key and subtract from it:<br /><br /><pre><code><br /><br />.IF wParam==1002<br />            invoke  GetDlgItemText, hWin, IDC_EDT1, offset g_dbBuffer, sizeof g_dbBuffer<br />            <br />            invoke  MessageBox,hWin,addr ok,addr ok,MB_OK<br />            <br />            invoke  GetDlgItemInt,hWin,IDC_EDT3,offset g_lpTranslated,FALSE<br />            <br />            invoke  MessageBox,hWin,addr ok,addr ok,MB_OK<br />            <br />            invoke  lstrlen, OFFSET g_dbBuffer<br />            <br />            invoke  MessageBox,hWin,addr ok,addr ok,MB_OK<br />            <br />            invoke  crc32, OFFSET g_dbBuffer,eax<br />            <br />            invoke  MessageBox,hWin,addr ok,addr ok,MB_OK<br />                add eax,956874599<br />                sub eax,8<br />                add eax,20<br />                add eax,956874599<br />                add eax,956874599<br />                invoke MessageBox,hWin,addr ok,addr ok,MB_OK<br /><br />            .if eax==g_lpTranslated<br />            	invoke  MessageBox,0,addr goodtxt,addr goodcap,MB_OK<br />              .else<br />              	invoke  MessageBox,0,addr badtxt,addr badcap,MB_OK<br />              	<br />            .endif<br /><br />            invoke  MessageBox,hWin,addr ok,addr ok,MB_OK <br />                       <br /><br />                	<br />                  		<br />            .endif<br />      <br />                  <br /><br />        <br />       <br /></code></pre><br /><br />As you can see I used a lot of messageboxes to debug the program lol and it helped a lot..Also I used SOME things from your example program stryker I hope you dont mind. It helped me but what helped me most was experimenting with the diff ways to set up the program and your very first example (the crc32 one that u gave me a link to the board it was on).Thx again for everyones help. It really helped.</div>
    <div class="meta">Posted on 2002-08-06 23:56:01 by resistance_is_futile</div>
   </div>
   <div class="post" id="post-52057">
    <div class="subject"><a href="#post-52057">detect if program has been run once and if yes change passwo</a></div>
    <div class="body"><div class="quote"><br />As you can see I used a lot of messageboxes to debug the program lol and it helped a lot<br /></div><br />Get yourself a debugger...</div>
    <div class="meta">Posted on 2002-08-07 03:29:44 by f0dder</div>
   </div>
  </div>
 </body>
</html>