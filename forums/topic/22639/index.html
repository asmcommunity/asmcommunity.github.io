<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>String Routines - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=22639" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=22639">String Routines</a></p>
   <div class="post" id="post-169811">
    <div class="subject"><a href="#post-169811">String Routines</a></div>
    <div class="body">Here is my string library, i hope its not too lame<br /><br /><pre><span style="font-size:2>TStrLen PROC SrcStr:DWORD<br />&nbsp; PUSH EDI<br />&nbsp; MOV EDI , SrcStr<br />&nbsp; MOV ECX , 0FFFFFFFFh<br />&nbsp; XOR AL , AL<br />&nbsp; REPNZ SCASB<br />&nbsp; NOT ECX<br />&nbsp; DEC ECX<br />&nbsp; MOV EAX , ECX<br />&nbsp; POP EDI<br />&nbsp; RET<br />TStrLen ENDP<br />;---------------------------------------------<br />TStrChar PROC SrcStr:DWORD, CharIndex:DWORD<br />&nbsp; PUSH ESI<br />&nbsp; MOV ESI , SrcStr<br />&nbsp; ADD ESI , CharIndex<br />&nbsp; LODSB<br />&nbsp; POP ESI<br />&nbsp; RET<br />TStrChar ENDP<br />;---------------------------------------------<br />TStrLower PROC SrcStr:DWORD<br />&nbsp; PUSH ESI<br />&nbsp; MOV ESI , SrcStr<br />&nbsp; @@:<br />&nbsp; &nbsp; LODSB<br />&nbsp; &nbsp; TEST AL , AL<br />&nbsp; &nbsp; JE @F<br />&nbsp; &nbsp; CMP AL , 65<br />&nbsp; &nbsp; JL @B <br />&nbsp; &nbsp; CMP AL , 90<br />&nbsp; &nbsp; JG @B&nbsp; &nbsp; <br />&nbsp; &nbsp; ADD AL , 32d<br />&nbsp; &nbsp; MOV BYTE PTR  , AL<br />&nbsp; &nbsp; JMP @B<br />&nbsp; @@:&nbsp; &nbsp; <br />&nbsp; POP ESI<br />&nbsp; RET<br />TStrLower ENDP<br />;---------------------------------------------<br />TStrUpper PROC SrcStr:DWORD<br />&nbsp; PUSH ESI<br />&nbsp; MOV ESI , SrcStr<br />&nbsp; @@:<br />&nbsp; &nbsp; LODSB<br />&nbsp; &nbsp; TEST AL , AL<br />&nbsp; &nbsp; JE @F<br />&nbsp; &nbsp; CMP AL , 97<br />&nbsp; &nbsp; JL @B <br />&nbsp; &nbsp; CMP AL , 122<br />&nbsp; &nbsp; JG @B&nbsp; &nbsp; <br />&nbsp; &nbsp; SUB AL , 32d<br />&nbsp; &nbsp; MOV BYTE PTR  , AL<br />&nbsp; &nbsp; JMP @B<br />&nbsp; @@:&nbsp; &nbsp; <br />&nbsp; POP ESI<br />&nbsp; RET<br />TStrUpper ENDP<br />;---------------------------------------------<br />TStrPart PROC SrcStr:DWORD, DestStr:DWORD, StartPos:DWORD, TheLen:DWORD<br />&nbsp; PUSH ESI<br />&nbsp; PUSH EDI<br />&nbsp; MOV ESI , SrcStr<br />&nbsp; MOV EDI , DestStr<br />&nbsp; MOV EAX , StartPos<br />&nbsp; ADD ESI , EAX<br />&nbsp; MOV ECX , TheLen<br />&nbsp; CLD<br />&nbsp; REP MOVSB<br />&nbsp; POP EDI<br />&nbsp; POP ESI<br />&nbsp; RET<br />TStrPart ENDP<br />;---------------------------------------------<br />TStrFill PROC DestStr:DWORD, FillLen:DWORD, WithChar:BYTE<br />&nbsp; PUSH EDI<br />&nbsp; MOV AL , WithChar<br />&nbsp; MOV EDI , DestStr <br />&nbsp; MOV ECX , FillLen<br />&nbsp; CLD<br />&nbsp; REP STOSB<br />&nbsp; POP EDI<br />&nbsp; RET<br />TStrFill ENDP<br />;---------------------------------------------<br />TStrLeft PROC SrcStr:DWORD, DestStr:DWORD, TheCount:DWORD<br />&nbsp; PUSH EDI<br />&nbsp; PUSH ESI<br />&nbsp; CLD<br />&nbsp; MOV ESI , SrcStr<br />&nbsp; MOV EDI , DestStr<br />&nbsp; MOV ECX , TheCount<br />&nbsp; REP MOVSB <br />&nbsp; POP ESI<br />&nbsp; POP EDI<br />&nbsp; RET<br />TStrLeft ENDP<br />;---------------------------------------------<br />TStrRight PROC SrcStr:DWORD, DestStr:DWORD, TheCount:DWORD<br />&nbsp; PUSH ESI<br />&nbsp; PUSH EDI<br />&nbsp; MOV EDI , SrcStr<br />&nbsp; MOV ECX , 0FFFFFFFFh<br />&nbsp; XOR AL , AL<br />&nbsp; REPNZ SCASB<br />&nbsp; NOT ECX<br />&nbsp; DEC ECX<br />&nbsp; SUB ECX , TheCount<br />&nbsp; MOV EDI , DestStr<br />&nbsp; MOV ESI , SrcStr<br />&nbsp; ADD ESI , ECX<br />&nbsp; MOV ECX , TheCount<br />&nbsp; CLD<br />&nbsp; REP MOVSB<br />&nbsp; POP EDI<br />&nbsp; POP ESI<br />&nbsp; RET<br />TStrRight ENDP</span></pre></div>
    <div class="meta">Posted on 2006-02-06 21:32:57 by XCHG</div>
   </div>
  </div>
 </body>
</html>