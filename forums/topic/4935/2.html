<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>New Control - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4935" />
  <link rel="prev" href="../?id=4935&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4935">New Control</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=4935&amp;page=1" style="">&laquo;</a><a href="../?id=4935&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="4935" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-34721">
    <div class="subject"><a href="#post-34721">New Control</a></div>
    <div class="body">Looks like a winner! :alright: WinXP</div>
    <div class="meta">Posted on 2002-04-23 19:11:34 by bitRAKE</div>
   </div>
   <div class="post" id="post-34724">
    <div class="subject"><a href="#post-34724">New Control</a></div>
    <div class="body"><strong>Great!</strong><br /><br />I will assume it works on NT and 2000 as well.<br /><br />Lastly, one thing that needed fixing that no one else noticed is that the second button is supose to have a 60x60 picture on it.<br /><br />But <strong>fodder's</strong> graphic doesnt show it.  So i think i know why this is.  The microsoft code to build your own masks using a wierd API that has limitations to about 30 pixels.  It says after this it fails.  And i think this is why you see only one of the two start up pictures.  The house is 23x23.  And the other is 60x60.  <br /><br />So after some softicing, i realize the api did nothing anyways (what went in came out) in terms of pixel size, so i modified the 'DrawTransparentBitmap' funciton, and removed this api.  Both graphics appear as normal on 98 still (as anticipated).<br /><br /><strong>Would everyone try this one: 95, 98, 2000, NT, ME, XP</strong><br /><br />You should see two graphics off the start, and the third box's graphic will only appear when you click the menu item for it.<br /><br />Thanx again for helping me on this everyone!!!<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-04-23 19:32:49 by NaN</div>
   </div>
   <div class="post" id="post-34727">
    <div class="subject"><a href="#post-34727">New Control</a></div>
    <div class="body">No luck on this one <strong>NaN</strong>, or picture on button 2.</div>
    <div class="meta">Posted on 2002-04-23 19:39:52 by bitRAKE</div>
   </div>
   <div class="post" id="post-34729">
    <div class="subject"><a href="#post-34729">New Control</a></div>
    <div class="body">What do you mean <strong>OR</strong> something else go wrong? ie) no pictures?<br /><br />NaN</div>
    <div class="meta">Posted on 2002-04-23 19:46:50 by NaN</div>
   </div>
   <div class="post" id="post-34731">
    <div class="subject"><a href="#post-34731">New Control</a></div>
    <div class="body">Sorry, play with words isn't good with bug report. :)<br />Just no picture on button 2.</div>
    <div class="meta">Posted on 2002-04-23 19:58:05 by bitRAKE</div>
   </div>
   <div class="post" id="post-34733">
    <div class="subject"><a href="#post-34733">New Control</a></div>
    <div class="body">Kool..  Well after re-reading the MSDN on this, i realize i made an error in my thoughts.  The DPtoLP API says it cant be greater than 27 <strong>BITS</strong>, however i read it as 27 <strong>pixels</strong>, which are apples and oranges.  So this api can easily suport a bitmap 60x60.<br /><br />So im still left clueless where the NT box's fail to display the second graphic. :rolleyes:  (Im really starting to NOT like NT ).<br /><br />Any thougthts?  I trust the first 23x23 is being displayed.  If you enable <strong>menu 3</strong>, and select add graphic from it, can you see the other 23x23 graphic??<br /><br />Thanx.<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-04-23 20:04:49 by NaN</div>
   </div>
   <div class="post" id="post-34734">
    <div class="subject"><a href="#post-34734">New Control</a></div>
    <div class="body">Yes, just that one gfx missing: :stupid:</div>
    <div class="meta">Posted on 2002-04-23 20:06:04 by bitRAKE</div>
   </div>
   <div class="post" id="post-34736">
    <div class="subject"><a href="#post-34736">New Control</a></div>
    <div class="body">This is what 9x sees...</div>
    <div class="meta">Posted on 2002-04-23 20:07:28 by NaN</div>
   </div>
   <div class="post" id="post-34738">
    <div class="subject"><a href="#post-34738">New Control</a></div>
    <div class="body">The button is too small. I can see it just by making the button bigger. :)<br /><br />mov hBut2, $invoke( MButton, addr sz002, hWin, 130,0,80,76, hBMenu2, 2200 )</div>
    <div class="meta">Posted on 2002-04-23 20:11:58 by bitRAKE</div>
   </div>
   <div class="post" id="post-34743">
    <div class="subject"><a href="#post-34743">New Control</a></div>
    <div class="body"><strong>Awesome bitRAKE</strong><br /><br />Good job!  I didnt realize that NT needed to be so specific.  I will tabulate what the size of the control needs to be per bitmap used and add this info into the README.TXT<br /><br /><br />Well, thanx to your help, i think i have all problems pounded out!<br /><br />Thanx again..<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-04-23 20:31:32 by NaN</div>
   </div>
   <div class="post" id="post-34747">
    <div class="subject"><a href="#post-34747">New Control</a></div>
    <div class="body">NaN, if the CREATESTRUCT.lpName was merely the pointer<br />supplied on the CreateWindow call, it wouldn't be safe<br />to use this in your control - who knows in which way this<br />was supplied? It could be data with temporary life cycle<br />(created in a temporary heap buffer, or a local buffer).<br /><br />Iirc, NT does a lot of parameter copying back and forth<br />(in a &quot;don't trust the user, he WILL try to crash our<br />kernel&quot; way), so your &quot;temporary OS buffer&quot; theory might<br />not be too farfetched.<br /><br />It also makes a lot of sense storing the window caption<br />yourself, you wont need to WM_GETTEXT when you need to<br />repaint, and you only depend on your own code... you know<br />what you get.<br /><br />Your tryme works fine on win2k now, well at least the text<br />does ;). trymeagain doesn't show button2 picture.<br /><br /><div class="quote"><br />(Im really starting to NOT like NT ). <br /></div><br />You ought to like it... NT enforces the PlatformSDK while<br />9x lets you get away with a lot of bad programming... some<br />of which will eventually lead to severe leaks, crashes etc.<br /><br />Remember, always assume that YOU are doing something wrong ;).<br />Great work, now you just need to change the buttondraw status<br />to nonclicked when the mouse is away from the button, and there's<br />a useful control :).</div>
    <div class="meta">Posted on 2002-04-23 20:45:38 by f0dder</div>
   </div>
   <div class="post" id="post-34752">
    <div class="subject"><a href="#post-34752">New Control</a></div>
    <div class="body">I see you've edited you post, as you have yourself discovered the same.<br /><br />For NT boxes in particular, but is good practice over all. The size of the control width and height must adhear to this:<br /><div class="quote">  Width &gt;= BitMapSize + 12<br />  Height &gt;= BitMpaSize + 16 </div><br /><br />And remember that this is designed for <strong>SQUARE</strong> bitmaps.</div>
    <div class="meta">Posted on 2002-04-23 20:59:29 by NaN</div>
   </div>
   <div class="post" id="post-34755">
    <div class="subject"><a href="#post-34755">New Control</a></div>
    <div class="body"><div class="quote"><br />I see you've edited you post, as you have yourself discovered the same. <br /></div><br />Huh? Realized what? And edited what post? :confused:</div>
    <div class="meta">Posted on 2002-04-23 21:05:50 by f0dder</div>
   </div>
   <div class="post" id="post-34757">
    <div class="subject"><a href="#post-34757">New Control</a></div>
    <div class="body"><div class="quote"><em>Originally posted by f0dder </em><br />NaN, if the CREATESTRUCT.lpName was merely the pointer<br />supplied on the CreateWindow call, it wouldn't be safe<br />to use this in your control - who knows in which way this<br />was supplied? It could be data with temporary life cycle<br />(created in a temporary heap buffer, or a local buffer).</div><br /><br />I see your point, but i <strong>TRUSTED</strong> the MSDN! It said it was a pointer, and when created i passed a pointer.  It would be nice for it to say that this is an <strong>INTERNAL</strong> pointer to copied text.  Then i wouldnt have thougth twice using a buffer.  Im really trying to keep the control as unbloated as possible, so saving a pointer is much better than an array of bytes.<br /><br /><div class="quote">You ought to like it... NT enforces the PlatformSDK while<br />9x lets you get away with a lot of bad programming... some<br />of which will eventually lead to severe leaks, crashes etc.</div><br /><br />Im sorry, but i dont see the SDK being enforced (as it is documented).  Again, i saw with softice that the pointer is transparent directly to the address of my text data (on win 9x) and confirms the information on the MSDN.  In reality, windows NT goes a step further and doesnt tell you.  <br /><br />I always use the web MSDN because it has OS version information, but this time it let me down. This is what took me all day to debug :rolleyes: .  However, your right, im now a better programmer, cause the experience has taught me alot about the 'dont trust the programmer' menality of NT :)<br /><br /><div class="quote">Great work, now you just need to change the buttondraw status to nonclicked when the mouse is away from the button, and there's a useful control :). </div><br /><br />I thought I fixed this already. :confused:<br /><br />PS: <strong>fodder</strong>, we're leap-froggin posts.  You replied to me, as i replied to bitrake, which you then replied in confusion, and i replied to your first with this, only to edit this comment after I realize your confuse.   So i ask, <em>whos on first?</em> (LoL)<br /><br />Thanx again!<br />:alright:</div>
    <div class="meta">Posted on 2002-04-23 21:12:56 by NaN</div>
   </div>
   <div class="post" id="post-34761">
    <div class="subject"><a href="#post-34761">New Control</a></div>
    <div class="body">Well... the PlatformSDK certainly isn't clear on<br />where the data the pointer points to is stored.<br />In such cases, take no chances :). If you got a<br />pointer to some structure in response to a window<br />message, you shouldn't store that pointer... you<br />should copy whatever info you need from it. Same<br />thing as with HDCs, really... unless you specify<br />a CS_OWNDC, you need to constantly get/reget the hdc.<br /><br />I think the reason I see the &quot;you shouldn't just store<br />the pointer&quot; as a very logical thing, and don't really<br />feel there's any problem with the PSDK info (though<br />as a big company, m$ ought to remove a few ambiguities<br />etc) is that I know how *I* often write code... pass<br />something to a function, use it there temporarily,<br />destroy later, et cetera. I also use a lot of &quot;black box&quot;<br />programming, which means that &quot;objects&quot; should store<br />their &quot;own properties&quot; - in the case of a control,<br />things like the caption.<br /><br />I don't think (but don't know if) there's any &quot;default<br />storage&quot; for a thing like the window caption. After all,<br />not all windows need captions, so why should *all* windows<br />waste space for a caption buffer? Or even a pointer to a<br />caption buffer... at least that's the way I think.<br /><br />Sometimes the wording in the PSDK can be a bit confusing,<br />and often special cases aren't covered. Too bad when those<br />special cases can have weird side effects. I still think<br />it's a very good set of documentation, the best OS/API<br />reference I've ever seen (*u*x manpages, booyah). But sure,<br />there are a few (very few imo) situations where on can<br />be seriously in doubt who's erring - you or the API.<br /><br /><div class="quote"><br />I thought I fixed this already<br /></div><br />You fixed the &quot;event is not generated if mouse is outside<br />rect when button is released&quot;, but you haven't yet duplicated<br />the &quot;redraw button in raised state when mouse is outside rect&quot;.<br />This is purely cosmetic, but it is windows default behaviour<br />and I've grown so used to it that buttons not following this<br />standard scare me ;P<br /><br />*pat on the back*, good work NaN.</div>
    <div class="meta">Posted on 2002-04-23 21:43:41 by f0dder</div>
   </div>
   <div class="post" id="post-34765">
    <div class="subject"><a href="#post-34765">New Control</a></div>
    <div class="body">Thanks!<br /><br />Umm I now know what your were getting at with the click event. <br /><br />Originally, i tried to support mouse over events (like IE) where the icon would become colored when the mouse is over it.  The problem was i could use WM_NCHITTEST to realize the mouse is over the control.  However, i had no way of realizeing the mouse was NOT over the control.<br /><br />I dont know how this is done.  The only way i can concieve of is a HUGE work around and 98% guarenteed not to be the correct way, so i didnt do it. (basically register a bigger window around the control, but have no drawing properties ~ Very bad idea, but the best i could think of).<br /><br />If you know how to track the mouse outside the control (with out click events) im intereseted!!  Last i read MouseCapture events are based on click events, so im running out of messages to process?? :(<br /><br />Thanx again!<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2002-04-23 21:57:57 by NaN</div>
   </div>
   <div class="post" id="post-34771">
    <div class="subject"><a href="#post-34771">New Control</a></div>
    <div class="body">An idea for the &quot;hot stuff&quot; (mouseover)... Well, I think you should/could<br />do it with SetCapture. Once mouse enters your control, highlight it, and<br />SetCapture. When the mouse leaves your control, draw normal, and ReleaseCapture.<br />However, PSDK says that only the foreground window can capture the mouse :/,<br />so I dunno if this way is feasible. There are some messages for mouse tracking<br />(WM_MOUSEHOVER, WM_MOUSELEAVE, ...) but those are NT4+ and 98+. But hey,<br />screw those 95 users, they probably wont care about hottracking anyway.<br /><br />Using the capture idea for hottracking (probably wont work...) would also<br />require a bit more logic to handle the case when you're actually clicking<br />the button and moving the mouse outside the control... you wouldn't want<br />to ReleaseCapture if the button is currently being clicked :).</div>
    <div class="meta">Posted on 2002-04-23 22:11:01 by f0dder</div>
   </div>
   <div class="post" id="post-34774">
    <div class="subject"><a href="#post-34774">New Control</a></div>
    <div class="body">I will look into it... dunno what will turn up tho :-/<br /><br />Another idea i had was to start a timer when WM_NCHITTEST starts (at its best resolution), and then &quot;Time out&quot; indicating the mouse is left the control, and stop the timer.<br /><br />This *i think* is a sloppy work around, because the os would be sending a good multitide of timer messages to your control.<br /><br />NaN</div>
    <div class="meta">Posted on 2002-04-23 22:19:51 by NaN</div>
   </div>
   <div class="post" id="post-34775">
    <div class="subject"><a href="#post-34775">New Control</a></div>
    <div class="body">If the SetCapture method of hottracking doesn't work (which PSDK<br />would indicate it doesn't), I can't think of an all-os way to handle it.<br />But really, it's a cosmetic issue, so using the 98+ hottracking messages<br />isn't a problem. Big deal if there's no hottracking on obsolete old<br />95, it's not like applications wont work without it :).<br /><br />I'd put &quot;draw unpressed when mouse is out&quot; higher on the todo-list<br />than hottracking though :).</div>
    <div class="meta">Posted on 2002-04-23 22:25:40 by f0dder</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=4935&amp;page=1" style="">&laquo;</a><a href="../?id=4935&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="4935" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>