<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Shell Extension Question - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16052" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=16052">Shell Extension Question</a></p>
   <div class="post" id="post-124444">
    <div class="subject"><a href="#post-124444">Shell Extension Question</a></div>
    <div class="body">Greetings, Is there a reason why one <em>should</em> package a typelibrary with a shell extension DLL? Is this necessary for marshalling purposes?</div>
    <div class="meta">Posted on 2003-11-15 11:01:39 by Poimander</div>
   </div>
   <div class="post" id="post-124448">
    <div class="subject"><a href="#post-124448">Shell Extension Question</a></div>
    <div class="body">Hi,<br /><br />how do you get such an idea?</div>
    <div class="meta">Posted on 2003-11-15 11:59:12 by japheth</div>
   </div>
   <div class="post" id="post-124451">
    <div class="subject"><a href="#post-124451">Shell Extension Question</a></div>
    <div class="body">Well, if you take a look at the VC++ generated shell extensions on <strong>CodeProject/CodeGuru</strong> several of them include a typelibrary exposing a dispinterface. I thought there must be a reason for it BTW, <strong>Montgenie's asmTxtInfo</strong> sample includes a typelibrary.</div>
    <div class="meta">Posted on 2003-11-15 13:01:11 by Poimander</div>
   </div>
   <div class="post" id="post-124458">
    <div class="subject"><a href="#post-124458">Shell Extension Question</a></div>
    <div class="body">Hi!<br /><br />Experimental variant for Shellext  with ContextMenu and ShellPropSheet.</div>
    <div class="meta">Posted on 2003-11-15 14:31:40 by robin11</div>
   </div>
   <div class="post" id="post-124464">
    <div class="subject"><a href="#post-124464">Shell Extension Question</a></div>
    <div class="body">Greetings <strong>robin11</strong>, Is that available in zip format or some other rar version compatible with WinRAR?</div>
    <div class="meta">Posted on 2003-11-15 16:27:36 by Poimander</div>
   </div>
   <div class="post" id="post-124482">
    <div class="subject"><a href="#post-124482">Shell Extension Question</a></div>
    <div class="body">I agree... im seeing too many Rar's these days... dont understand the point, for small ASM files its pointless to deviate off a well established norm to save 1Kb in a 10kb file.  Its actaully the reason why i havent reviewed his earlier postings... I have no patience for dig up the newest unrar that is compatable...</div>
    <div class="meta">Posted on 2003-11-15 23:55:08 by NaN</div>
   </div>
   <div class="post" id="post-124494">
    <div class="subject"><a href="#post-124494">Shell Extension Question</a></div>
    <div class="body">Hi!<br /><br />WinZip 8.1 SR-1 (5266)</div>
    <div class="meta">Posted on 2003-11-16 03:32:08 by robin11</div>
   </div>
   <div class="post" id="post-124500">
    <div class="subject"><a href="#post-124500">Shell Extension Question</a></div>
    <div class="body">&quot;well established format&quot;. Zip sucks, rar is nice, and unrar is free. What's the problem? - rar's pretty widespread anyway, unless some of the other &quot;non-zip formats&quot;.</div>
    <div class="meta">Posted on 2003-11-16 07:08:00 by f0dder</div>
   </div>
   <div class="post" id="post-124513">
    <div class="subject"><a href="#post-124513">Shell Extension Question</a></div>
    <div class="body">Hi f0dder,<br /><br />could you please be so kind and tell as why &quot;Zip sucks&quot;? Havent hat problems with it until now.</div>
    <div class="meta">Posted on 2003-11-16 10:43:12 by japheth</div>
   </div>
   <div class="post" id="post-124515">
    <div class="subject"><a href="#post-124515">Shell Extension Question</a></div>
    <div class="body">ZIP was invented by a capitalist/imperialist pig. RAR was made in Russia. I have WinRAR installed, and it supports ZIP, ACE, TAR, among other formats. Much better than WinZIP.</div>
    <div class="meta">Posted on 2003-11-16 10:57:31 by comrade</div>
   </div>
   <div class="post" id="post-124518">
    <div class="subject"><a href="#post-124518">Shell Extension Question</a></div>
    <div class="body">IMHO <strong>WinZIP</strong> has a much better user interface. BTW, has anyone actually <em>thought</em> about the subject of this thread?</div>
    <div class="meta">Posted on 2003-11-16 11:56:24 by Poimander</div>
   </div>
   <div class="post" id="post-124522">
    <div class="subject"><a href="#post-124522">Shell Extension Question</a></div>
    <div class="body">Hi!<br /><br />It is possible  without  typelib to solve a problem,  but with Winzip :)</div>
    <div class="meta">Posted on 2003-11-16 12:24:03 by robin11</div>
   </div>
   <div class="post" id="post-124533">
    <div class="subject"><a href="#post-124533">Shell Extension Question</a></div>
    <div class="body"><div class="quote"><br />ZIP was invented by a capitalist/imperialist pig. RAR was made in Russia. I have WinRAR installed, and it supports ZIP, ACE, TAR, among other formats. Much better than WinZIP.<br /></div><br />*giggle*<br /><br />The WinRAR interface is a much cleaner and &quot;power-user&quot; friendly than winzip. Furthermore, the zip format is awful, it doesn't support solid compression (which boosts compression ratio massively, especially when dealing with, say, a source archive).<br /><br />Anyway, enough pollution of this thread already.</div>
    <div class="meta">Posted on 2003-11-16 15:16:25 by f0dder</div>
   </div>
   <div class="post" id="post-124558">
    <div class="subject"><a href="#post-124558">Shell Extension Question</a></div>
    <div class="body"><div class="quote"><br />Anyway, enough pollution of this thread already.<br /></div><br /><br />Hmmm, f0dder, wasnt it you who has started this pollution?<br /><br />BTW, my question was about zip format, not winzip/winrar. From what I have read up to now to say &quot;zip sucks&quot; seems a bit overstretched.<br /><br />Since I dont own a copy of WinRAR and surely dont want to achieve one, I must agree with NaN and still would prefer zip format, for there is much better GUI support.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-11-16 18:44:51 by japheth</div>
   </div>
   <div class="post" id="post-124592">
    <div class="subject"><a href="#post-124592">Shell Extension Question</a></div>
    <div class="body">Poimander,<br /><br />The typelib is for the automation programming languages like VB.  So it can make it easy for the programmer to interface to the object.<br /><br />Regards,  P1</div>
    <div class="meta">Posted on 2003-11-17 09:38:32 by Pone</div>
   </div>
   <div class="post" id="post-124593">
    <div class="subject"><a href="#post-124593">Shell Extension Question</a></div>
    <div class="body"><div class="quote"><br />Hmmm, f0dder, wasnt it you who has started this pollution?<br /></div><br />Yep, and I wanted to end it. <span style="font-size:9px>(zip does suck, though. Very insecure encryption, lack of solid compression, and the compression itself isn't even all that good these days)</span></div>
    <div class="meta">Posted on 2003-11-17 10:07:44 by f0dder</div>
   </div>
   <div class="post" id="post-124652">
    <div class="subject"><a href="#post-124652">Shell Extension Question</a></div>
    <div class="body">Pone, <br /><br /><div class="quote"><br />The typelib is for the automation programming languages like VB. So it can make it easy for the programmer to interface to the object.<br /></div><br /><br />How do you get an interface pointer to a server (=shell extension) created by the shell in the shell's process?<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-11-18 01:03:44 by japheth</div>
   </div>
   <div class="post" id="post-126164">
    <div class="subject"><a href="#post-126164">Shell Extension Question</a></div>
    <div class="body">japheth,<br /><br />Sorry for the delay, I wanted to look up a ref. ( Inside COM+ BaseServices, M$ Press ), so I could answer completely.<br /><br />VB uses three methods to instantiate an object ( get a pointer ) from the TypeLib info ( roughly, a binary version of IDL ).<br />         VB syntax,                  VB instantiation method       <br />1. Set MyObj = Object,  uses CoInitializeEx &amp; CoUninitialize.<br />2. Set MyObj = New Object, uses an internal object creation mechanism. ( Limited and for Local use only. )<br />3. Set MyObj = CreateObject(&quot;MyProgID&quot;,&quot;MyServer&quot;), uses COM+/DCOM to instantiate the object on a server.<br /><br /><div class="quote"><em>Originally posted by japheth </em><br />How do you get an interface pointer to a server (=shell extension) created by the shell in the shell's process?<br /></div><br /><br />Let me know, if this covers what you want.  Otherwise, give a few details and I can provide VB code for an example.<br /><br />Regards,  P1 :cool:</div>
    <div class="meta">Posted on 2003-12-01 13:28:47 by Pone</div>
   </div>
   <div class="post" id="post-126225">
    <div class="subject"><a href="#post-126225">Shell Extension Question</a></div>
    <div class="body">Hi Pone,<br /><br />your answer doesnt exactly cover my question. Im aware of the types of VB COM object creation.<br /><br />An example: <br /><br />1- you have registered a shell namespace extension.<br />2. the shell creates an instance of this clsid at startup<br />3. you want to communicate with this INSTANCE by automation (type information)<br /><br />thats the issue. Its rather useless to create your own instance of a shell extension in your process.<br /><br />AFAIK, the shell itself doesnt use the automation interface, it has its own set of predefined interfaces<br />to communicate with its extensions. So poimanders question (why type information for shell extensions)<br />is still not answered.<br /><br />Japheth</div>
    <div class="meta">Posted on 2003-12-01 23:29:59 by japheth</div>
   </div>
  </div>
 </body>
</html>