<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Create ASM includes from Type Libs - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6313" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=6313">Create ASM includes from Type Libs</a></p>
   <div class="post" id="post-45355">
    <div class="subject"><a href="#post-45355">Create ASM includes from Type Libs</a></div>
    <div class="body">I have just &quot;released&quot; an updated version of COMView, which is (besides other things) able to create ASM include files from type libraries. That may be useful for people working with COM, VB, ADO. Let me know what you think of it.<br /><br /><a target="_blank" href="http://www.japheth.de/Download/COMView.ZIP">Click here to download</a> <br /><br />japheth</div>
    <div class="meta">Posted on 2002-06-27 04:23:33 by japheth</div>
   </div>
   <div class="post" id="post-45481">
    <div class="subject"><a href="#post-45481">Create ASM includes from Type Libs</a></div>
    <div class="body">Very, very nice, and much appreciated.<br /><br />I get a GPF if I try to create an inc file on any interface function with more than 32 parameters. (Like Access's Application_Run function.)<br />Other than that seems as smooth as silk.</div>
    <div class="meta">Posted on 2002-06-27 17:20:45 by Wayne</div>
   </div>
   <div class="post" id="post-45494">
    <div class="subject"><a href="#post-45494">Create ASM includes from Type Libs</a></div>
    <div class="body">Oops!! Seems like I counted some toes twice. There are only 31 parameters in the Access8 _Application Run function.<br /><br />???</div>
    <div class="meta">Posted on 2002-06-27 19:17:35 by Wayne</div>
   </div>
   <div class="post" id="post-45500">
    <div class="subject"><a href="#post-45500">Create ASM includes from Type Libs</a></div>
    <div class="body">My last post on this ... I promise.<br /><br />I think the issue is with the length of szStr in the ScanTypeInfoFunctions proc. The 'Run' function will generate a string approx. 400 bytes.<br /><br />Is there any significance to the 260 byte length?<br /><br />BTW: what version of windows.inc do you use? I'm having trouble building this project.</div>
    <div class="meta">Posted on 2002-06-27 20:30:39 by Wayne</div>
   </div>
   <div class="post" id="post-45549">
    <div class="subject"><a href="#post-45549">Create ASM includes from Type Libs</a></div>
    <div class="body">Thanks Wayne for reporting bugs.<br /><br />260 is the value for MAXPATH, thats all.<br /><br />About the windows.inc: I have made few &quot;small&quot; changes to windows.inc, thats true (completely forgotten about that). What can make problems are lines:<br /><br /><pre><code><br />LPSTR           TYPEDEF DWORD<br />LPCSTR          TYPEDEF DWORD<br /><br />I have changed this to&#58;<br /><br />LPSTR           TYPEDEF PTR BYTE<br />LPCSTR          TYPEDEF PTR BYTE<br /></code></pre><br /><br />so the debugger is able to show me the strings.<br /><br />Here is a small ADO sample showing how to use the gererated includes. The include ADODB.INC was generated with COMView. An access database is included. This app is 4 kB only. To run you need ADO and &quot;OLE DB Provider for Jet engine&quot; installed (should be the case if you have MS Access installed).<br /><br />japheth</div>
    <div class="meta">Posted on 2002-06-28 03:43:47 by japheth</div>
   </div>
   <div class="post" id="post-45551">
    <div class="subject"><a href="#post-45551">Create ASM includes from Type Libs</a></div>
    <div class="body">@Japheth:<br /><br />Really, reallly, really nice work! :alright:</div>
    <div class="meta">Posted on 2002-06-28 03:51:53 by bazik</div>
   </div>
   <div class="post" id="post-45573">
    <div class="subject"><a href="#post-45573">Thank You</a></div>
    <div class="body">Dear japheth,<br /><br />Your tool is so very nice to me<br />(meaning both functionality and how it is coded) ;-)<br /><br />Thanks.</div>
    <div class="meta">Posted on 2002-06-28 05:23:26 by Andycar</div>
   </div>
   <div class="post" id="post-45578">
    <div class="subject"><a href="#post-45578">Create ASM includes from Type Libs</a></div>
    <div class="body">Thanks for the replies, guys!<br /><br />The error reported from Wayne (incl. analysis! thanks again) is fixed, the parameter line can reach up to 512 bytes now (if I remember correctly, this is maximum for MASM &quot;logical&quot; lines). So hopefully MS doesn't design methods with 100 parameters.</div>
    <div class="meta">Posted on 2002-06-28 07:27:52 by japheth</div>
   </div>
   <div class="post" id="post-45586">
    <div class="subject"><a href="#post-45586">Create ASM includes from Type Libs</a></div>
    <div class="body">japheth,<br /><br /> Thanks for windows.inc changes. Project builds fine now.<br /><br /> Thanks for the ado example also. I'll check it out tonight.<br /> (Only have Accessc97 on this machine)</div>
    <div class="meta">Posted on 2002-06-28 09:23:25 by Wayne</div>
   </div>
  </div>
 </body>
</html>