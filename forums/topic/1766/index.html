<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>WinNT/2000/XP ASM programming - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=1766" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=1766">WinNT/2000/XP ASM programming</a></p>
   <div class="post" id="post-11273">
    <div class="subject"><a href="#post-11273">WinNT/2000/XP ASM programming</a></div>
    <div class="body">I have received no response on  a msg in another thread.  Perhaps an ex. would indicate the problem I am experiencing trying to get a Win95/98/ME assembly pgm running under NT/2000/XP.  Prior to using: INCLUDE  W32.INC in my .asm file I have the statement: UNICODE = 1  (I had 0 for strictly ANSI and the pgm assembled and has worked fine for several yrs on 95/98/ME  The UNICODE statement is there because it is used in the W32.INC file at the beginning.  I used the following code just to see if it would work (assemble.)<br /><br />DeleteFileA       PROCDESC    WINAPI       :HANDLE<br />DeleteFileW      PROCDESC    WINAPI       :HANDLE<br /><br />                         if  UNICODE<br />DeleteFile         TEXTEQU    &lt;DeleteFileW&gt;<br />                         else<br />DeleteFile         TEXTEQU    &lt;DeleteFileA&gt;<br />                         endif   <br /><br />While assembling TASM32 gives me the following warning (not an error), 'Global type doesn't match symbol type' refering to DeleteFileW.<br />Thanx for any help as to what I am doing wrong..</div>
    <div class="meta">Posted on 2001-11-06 09:49:56 by DaveTX47</div>
   </div>
   <div class="post" id="post-11286">
    <div class="subject"><a href="#post-11286">WinNT/2000/XP ASM programming</a></div>
    <div class="body">Dave,<br /><br />very few people now work with TASM as it is not supported by Borland/Inprise any longer and it has not been updated for years. Most of the support around at the moment is for MASM because of its far larger user base and its reasonably current status with late model M$ operating systems.<br /><br />Mixing UNICODE and ANSI code is not without its difficulties, the data format is different but at the moment, you can run ANSI code on later versions of windows with no problems where unicode will not run as native code on earlier versions like win95 or 98.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2001-11-06 15:30:28 by hutch--</div>
   </div>
   <div class="post" id="post-11295">
    <div class="subject"><a href="#post-11295">WinNT/2000/XP ASM programming</a></div>
    <div class="body">I use the DOS DEBUG program on Win2k, so TASM should run just fine.<br /><br />As Hutch hinted, use the ANSI version. If you have troubles with the ANSI version, you need to check for common errors such as not properly preserving registers. Many of the functions were forgiving in Win9x because they invoked 16-bit code. (Because of what it takes to switch to 16-bit mode, registers were automatically preserved.)<br /><br />NT/2k/XP is also a bit strict about alignment of stack data.<br /><br />When switching to Unicode, the major problem will be string data, as all Unicode strings have 16-bit characters. This will cause problems if you're passing the character count as the byte count, or vice versa.</div>
    <div class="meta">Posted on 2001-11-06 17:00:13 by tank</div>
   </div>
   <div class="post" id="post-11330">
    <div class="subject"><a href="#post-11330">WinNT/2000/XP ASM programming</a></div>
    <div class="body">Writing for unicode... ho humm. I'm afraid it's the way to go, but<br />I'm a bit reluctant to do it myself, other than where's it necessary.<br />I also think it's a bit unnecessary, all the people with funky alphabets<br />should just grow up and use something intelligible. Ok, that didn't<br />work, so we're all stuck with unicode. Bleh. On nt/2k it might be<br />good to supply a unicode version of your application, as the ansi<br />routines go through ansi-&gt;unicode conversion, and is then passed<br />to the unicode version of the API... meaning that if you write for<br />unicode, your app will run faster. I'm not really convinced that you'll<br />be able to feel this, as stuff around API calls are hardly ever speed<br />critical :).</div>
    <div class="meta">Posted on 2001-11-07 03:03:11 by f0dder</div>
   </div>
  </div>
 </body>
</html>