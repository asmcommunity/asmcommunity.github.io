<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ES_MULTILINE not allowing TAB key? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8344" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=8344">ES_MULTILINE not allowing TAB key?</a></p>
   <div class="post" id="post-60936">
    <div class="subject"><a href="#post-60936">ES_MULTILINE not allowing TAB key?</a></div>
    <div class="body">Hi,<br /><br />This is my first ever post so I'll take this opportunity to thank all the talented people on this site for some great articles/tips. This is a great resource for new ASM programmers like myself and it has already helped me out on several occasions.<br /><br />I've recently completed my first Win32 ASM program and it works fine and I'm very proud of it.<br />The only small problem I have is that I can't get a multi-line text box to respond to a TAB key. (For moving focus to the next control).<br /><br />I use a resource file to create my controls and all the single line text boxes have entries like: -<br /><br />    EDITTEXT    IDC_TEXTBOX1, 1, 1, 120, 12, ES_AUTOHSCROLL  <br /><br />These all respond correctly to the TAB key i.e. they pass focus to the next control.<br />As soon as I try any combination including the ES_MULTILINE description i.e.<br /><br />    EDITTEXT    IDC_MLTEXTBOX1, 1, 1, 120, 12, ES_AUTOHSCROLL | ES_MULTILINE etc.<br /><br />The TAB key stops working on that control when the program is run. (I.e. it doesn't pass focus to the next control.)<br />Does a multi-line box expect the programmer to trap the TAB key or might something be going wrong here?<br />Any advice would be brill thanks.<br /><br />Keep up the good work,<br /><br />Cutler<br /><br />(P.S I'm using Windows 2000 if thats is any help).</div>
    <div class="meta">Posted on 2002-10-08 07:41:09 by Cutler</div>
   </div>
   <div class="post" id="post-60949">
    <div class="subject"><a href="#post-60949">ES_MULTILINE not allowing TAB key?</a></div>
    <div class="body">Hi,<br /><br />You need to add the style WS_TABSTOP to your Edit</div>
    <div class="meta">Posted on 2002-10-08 10:08:12 by roticv</div>
   </div>
   <div class="post" id="post-60952">
    <div class="subject"><a href="#post-60952">ES_MULTILINE not allowing TAB key?</a></div>
    <div class="body">Thanks for pointing me in the right direction roticv, I hadn't tried WS_TABSTOP.<br /><br />I've tried updating my rsrc file with the following: -<br /><br />                EDITTEXT	IDC_MLTEXTBOX1, 1, 1, 100, 36, ES_LEFT | WS_BORDER | WS_TABSTOP | ES_MULTILINE etc.<br />	EDITTEXT	IDC_TEXTBOX1, 1, 60, 50, 12, ES_AUTOHSCROLL | WS_TABSTOP<br /><br />But it still refuses to process my TAB key on the multi-line box.<br />As soon as I remove ES_MULTILINE the TAB works fine!<br /><br />I'll keep plodding away to see if there is a winning combination with this.<br /><br />(It dawned on me that rsrc files may not actually be classed as Win32 ASM programming so apologies if this is an 'off-topic' query).</div>
    <div class="meta">Posted on 2002-10-08 11:28:39 by Cutler</div>
   </div>
   <div class="post" id="post-60974">
    <div class="subject"><a href="#post-60974">ES_MULTILINE not allowing TAB key?</a></div>
    <div class="body">Hey Cutler,<br /><br />This is standard windows behaviour for just about as far back as I can<br />remember.  *Usually*, in an MLE, if someone types a tab then they<br />will expect a tab to be inserted into the text they are typing; not for<br />it to jump focus to another control.  To move focus to another control<br />that intercept the tab key you need to use Ctrl-Tab.<br /><br />If this is the behaviour you would like to have then I would suggest<br />subclassing the control and handling the tab key manually.</div>
    <div class="meta">Posted on 2002-10-08 15:36:44 by Graebel</div>
   </div>
   <div class="post" id="post-61034">
    <div class="subject"><a href="#post-61034">ES_MULTILINE not allowing TAB key?</a></div>
    <div class="body">Thanks for the advice Graebel.<br /><br />I'm referring to default Visual Basic or Microsoft Access form behaviour where &lt;Cntrl&gt;+TAB inserts a TAB into the text and TAB on it's own switches the focus.<br /><br />ES_MULTILINE is responding correctly to a &lt;Cntrl&gt;+TAB (it inserts a TAB into the text) but it does nothing when TAB is pressed on it's own.<br /><br />Anyway I'll shut up about this now and consider your wise advise about subclassing.<br /><br />Thanks again.</div>
    <div class="meta">Posted on 2002-10-09 03:53:14 by Cutler</div>
   </div>
  </div>
 </body>
</html>