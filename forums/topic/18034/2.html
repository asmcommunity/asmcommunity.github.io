<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How to get all item texts of ListView in other applicaion? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18034" />
  <link rel="prev" href="../?id=18034&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18034">How to get all item texts of ListView in other applicaion?</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=18034&amp;page=1" style="">&laquo;</a><a href="../?id=18034&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="18034" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-140341">
    <div class="subject"><a href="#post-140341">How to get all item texts of ListView in other applicaion?</a></div>
    <div class="body"><div class="quote"><br />I want to copy the ListView text in other application(an Anti-Virus softeware) to my ListView in my application.<br /></div><br />Would you care to elaborate why?</div>
    <div class="meta">Posted on 2004-04-28 07:58:30 by f0dder</div>
   </div>
   <div class="post" id="post-140384">
    <div class="subject"><a href="#post-140384">How to get all item texts of ListView in other applicaion?</a></div>
    <div class="body"><div class="quote"><br /><br />Would you care to elaborate why? </div><br /><br />Yes, I do.<br /><br />I want to use this program to release my work.</div>
    <div class="meta">Posted on 2004-04-28 18:59:04 by purpleendurer</div>
   </div>
   <div class="post" id="post-140391">
    <div class="subject"><a href="#post-140391">How to get all item texts of ListView in other applicaion?</a></div>
    <div class="body">Afternoon, purpleendurer.<br /><br />You want to use an anti-virus application to release your work?<br /><br />Would you please inform us as to what you program is for and what it is meant to do?<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2004-04-28 19:44:03 by Scronty</div>
   </div>
   <div class="post" id="post-140526">
    <div class="subject"><a href="#post-140526">How to get all item texts of ListView in other applicaion?</a></div>
    <div class="body"><div class="quote"><br />Afternoon, purpleendurer.<br /><br />You want to use an anti-virus application to release your work?<br /><br />Would you please inform us as to what you program is for and what it is meant to do?<br /><br />Cheers,<br />Scronty </div><br /><br />Hi Scronty<br /><br />I consider that the functions of the anti-virus application are imperfect, so I want to use my application to advance it.<br /><br />Cheers,<br />purpleendurer<br /><br /><br /><br />If I want to copy the ListView text in other application Under win 95/98, <br />Can I use mem map file?</div>
    <div class="meta">Posted on 2004-04-30 04:54:37 by purpleendurer</div>
   </div>
   <div class="post" id="post-141241">
    <div class="subject"><a href="#post-141241">How to get all item texts of ListView in other applicaion?</a></div>
    <div class="body">Hi all<br /><br />I had tested it is available  that copy listview item in other application to the listview in my application by CreateMemMapFile() under win 95/98/2000, and I think it is available under win xp/2003.</div>
    <div class="meta">Posted on 2004-05-16 08:42:30 by purpleendurer</div>
   </div>
   <div class="post" id="post-141244">
    <div class="subject"><a href="#post-141244">How to get all item texts of ListView in other applicaion?</a></div>
    <div class="body">Hi purpleendurer<br /><br />You can also try the following ordinals under Win9x to allocate shared memory  between processes. They will allocate memory on the shared heap and you can access the pointers returned from any application. They are exported from COMCTL32.DLL. These functions will not work under NT or any new versions of the OS, they are safe for 9x because COMCTL32.DLL is no longer redistributable (ie for 9x it will no longer be upgraded) so there is no danger that they will be replaced in the target OS versions.<br /><br />invoke Alloc, cb ; Ordinal COMCTL32.DLL:71<br />Returns pv (pointer to virtual memory)<br /><br />invoke ReAlloc, pv, cb ; Ordinal COMCTL32.DLL:72<br />Returns pv (pointer to virtual memory)<br /><br />invoke Free, pv ; Ordinal COMCTL32.DLL:73<br />Returns Non-zero<br /><br />invoke GetSize, pv ; Ordinal COMCTL32.DLL:74<br />Returns bytes allocated<br /><br />I have not tried these functions yet, as I have not gotten this far in the settlement API but according to MS it is what is used to pass information between processes in for example WM_GETTEXT.</div>
    <div class="meta">Posted on 2004-05-16 09:14:51 by donkey</div>
   </div>
   <div class="post" id="post-141246">
    <div class="subject"><a href="#post-141246">How to get all item texts of ListView in other applicaion?</a></div>
    <div class="body">Here is the Desktop listview example rewritten for Win9x using the ordinals. I tested it under 95 OSR0, 98SE, NT4 and Win2K, it works fine. It will distiguish which proc to use based on the OS platform.</div>
    <div class="meta">Posted on 2004-05-16 09:51:59 by donkey</div>
   </div>
   <div class="post" id="post-141297">
    <div class="subject"><a href="#post-141297">How to get all item texts of ListView in other applicaion?</a></div>
    <div class="body">Thanks Donkey....<br /><br />You are very nice...:alright: <br /><br />I has test my code under another  computer that OS is also window 2000 pro.<br /><br />But my code can not copy the listview text and the target application auto terminated :mad:</div>
    <div class="meta">Posted on 2004-05-17 10:49:57 by purpleendurer</div>
   </div>
   <div class="post" id="post-141299">
    <div class="subject"><a href="#post-141299">How to get all item texts of ListView in other applicaion?</a></div>
    <div class="body">Hi,<br /><br />Probably a bad pointer. You have to set up the memory to point to an area inside the target application by swapping out the pszText member of the structure with the address of the newly created text buffer in the target process. When you are done you have to reset it to the pointer in your application. Windows NT/2K/XP are much more particular about buffers, especially overflows and bad pointers which is what I suspect happened to yours.</div>
    <div class="meta">Posted on 2004-05-17 11:00:47 by donkey</div>
   </div>
   <div class="post" id="post-141452">
    <div class="subject"><a href="#post-141452">How to get all item texts of ListView in other applicaion?</a></div>
    <div class="body">Hi Donkey and other friends,<br /><br />I has uploaded my code.<br /><br />In my code, I Create a mem map file by calling the CreateMemMapFile(), and use the mem map file as shared memory between processes. <br /><br />My code has 2 questions:<br /><br />1. It can copy listview item in other application to the listview in my application under win 98, but it can not copy the listview item and caused the target application auto terminated under win 2000 pro now.<br />(It worked normally under win 2000 pro the day before yesterday! I forgot where I changed!:()<br /><br />2. the height of dialog in rsrc.rc must large than 170, else my code will cause a error when close it.<br /><br /><br />I can not find where is the bad code, Can you help me?<br /><br />Thanks.<br /><br /><br /><br />I am testing my code today, and I find:<br /><br />1. My code can copy file list (it is a listview control) item in MyComputer under win 2000 pro, but when the target listview in the OpenDialog or other application, then my code can not copy the listview item and caused the target application auto terminated....<br /><br />2. If my code assembled under  windows 2000, then my code do not need to call InitCommonControls()  and can runs under windows 98 and 2000.<br /><br />But if my code assembled under  windows 98, than my must need to call InitCommonControls(), else my code can not run under windows 98.<br /><br /><br />I upload my code again.<br /><br />It assembled with MASM v8 under  windows 98, includes:<br /><br />test.asm<br />rsrc.rc<br />test.exe (new)</div>
    <div class="meta">Posted on 2004-05-19 10:39:56 by purpleendurer</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=18034&amp;page=1" style="">&laquo;</a><a href="../?id=18034&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="18034" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>