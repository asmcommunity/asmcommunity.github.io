<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Who can explain it to me?thanks! - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13035" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=13035">Who can explain it to me?thanks!</a></p>
   <div class="post" id="post-101192">
    <div class="subject"><a href="#post-101192">Who can explain it to me?thanks!</a></div>
    <div class="body">;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;<br />_GetKernelBase  proc    dwKernelRet<br />                local   @dwReturn<br /><br />                pushad<br /><br />                mov     @dwReturn, 0<br /><br />                call    @F<br /><br />@@:             <br />                pop     ebx<br />                sub     ebx, offset @B<br /><br />                assume  fs : nothing<br />                <br />                push    ebp<br /><br />                lea     eax, <br />                push    eax<br /><br />                lea     eax, <br />                push    eax<br /><br />                push    fs : [0]<br /><br />                mov     fs : [0], esp<br /><br />                mov     edi, dwKernelRet<br />                and     edi, 0ffff0000h<br /><br />                .while  TRUE<br />                    <br />                    .if     word ptr  == IMAGE_DOS_SIGNATURE<br /><br />                        mov     esi, edi<br />                        add     esi, <br /><br />                        .if     dword ptr  == IMAGE_NT_SIGNATURE<br />                            mov     @dwReturn, edi<br />                            .break<br />                        .endif<br /><br />                    .endif<br /><br />                _PageError:<br />                    <br />                    sub     edi, 010000h                         <br />                    .break  .if     edi &lt; 070000000h        <br /><br />                .endw<br /><br />                pop     fs : [0]<br />                add     esp, 0ch<br /><br />                popad<br /><br />                mov     eax, @dwReturn<br />                ret<br /><br />_GetKernelBase  endp<br /><br />i can't catch the following statements:<br /><br />         sub     edi, 010000h                         <br />         .break  .if     edi &lt; 070000000h        <br /><br />what do these means?<br /><br />thanks!</div>
    <div class="meta">Posted on 2003-05-04 20:58:05 by freeia</div>
   </div>
   <div class="post" id="post-101195">
    <div class="subject"><a href="#post-101195">Who can explain it to me?thanks!</a></div>
    <div class="body">Its one mans take on a &quot;structured&quot; (and i use that word loosely) error handler.  This is all i can get from it, i dont really know SEH all to well.  Threre are others here that do, and may be able to expand on it more...<br /><br />Sorry im not much more help than this...<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2003-05-04 21:11:39 by NaN</div>
   </div>
   <div class="post" id="post-101196">
    <div class="subject"><a href="#post-101196">Who can explain it to me?thanks!</a></div>
    <div class="body"><a target="_blank" href="http://www.asmcommunity.net/board/showthread.php?threadid=12560&amp;highlight=lingo">http://www.asmcommunity.net/board/showthread.php?threadid=12560&amp;highlight=lingo</a></div>
    <div class="meta">Posted on 2003-05-04 21:18:22 by lingo12</div>
   </div>
  </div>
 </body>
</html>