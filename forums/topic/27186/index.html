<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>CoLib 1.1 (and windows.inc 1.25) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27186" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27186">CoLib 1.1 (and windows.inc 1.25)</a></p>
   <div class="post" id="post-194958">
    <div class="subject"><a href="#post-194958">CoLib 1.1 (and windows.inc 1.25)</a></div>
    <div class="body">The new version of CoLib has been released in the new MASM32 Service Pack 2.

  This Service Pack also includes windows.inc version 1.25, which is by and large it is compatible with CoLib.

  CoLib 1.1 has some much needed improvements in the original lib (i.e., I found a few bugs). I also added the scripter tut.

  I'm currently building my current project with windows.inc version 1.25, and only found TWO lines that may cause trouble. If you don't comment out lines 26756 and 26757 of version 1.25, your COM app MUST include a ClassMap. It may be NULL, but the symbol must be defined. This applies to any app that includelib CoLib.lib.

It seems these two lines (DllGetClassObject and DllCanUnloadNow proto's) force the linker to add the modules for these procedures even if nothing else references them, and DllGetClassObject needs a ClassMap. That behavior of the linker is quite unexpected from me, and needs further search (it may be bloating all our apps with extraneous lib code).

I hope this helps you.</div>
    <div class="meta">Posted on 2001-03-11 14:01:00 by Ernie</div>
   </div>
   <div class="post" id="post-194959">
    <div class="subject"><a href="#post-194959">CoLib 1.1 (and windows.inc 1.25)</a></div>
    <div class="body">Thanks for heads up Ernie, and the bug fixes!

What is the purpose of these lines in <strong>bstrRight.asm</strong>:
<pre><code>	; check start param
	mov eax, dwCCount
	.IF dwCCount > eax 
		; adjust the count
		mov dwCCount, eax
	.ENDIF</code></pre>
Is a BSTR the same as a UNICODE string?
bitRAKE</div>
    <div class="meta">Posted on 2001-03-11 16:30:00 by bitRAKE</div>
   </div>
  </div>
 </body>
</html>