<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ExitWindowsEx question - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7633" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7633">ExitWindowsEx question</a></p>
   <div class="post" id="post-55532">
    <div class="subject"><a href="#post-55532">ExitWindowsEx question</a></div>
    <div class="body">Hello everybody,<br /><br />In windows 98 is it possible to shut-down then re-start the system in dos?  I know it's an option on the shut down menu but how can I do it?  I thought I found the answer in <strong>ExitWindowsEx</strong> function but this only supports re starting in windows not DOS.  Does anybody know of another way?<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-08-30 15:23:02 by czDrillard</div>
   </div>
   <div class="post" id="post-55537">
    <div class="subject"><a href="#post-55537">ExitWindowsEx question</a></div>
    <div class="body">I'm not sure if this will work but I've been saving some snippets I've come acrossed since last year. Also I don't have a win9x machine.<pre><code>ShellExecute&#40;NULL, NULL, &quot;Exit to DOS.pif&quot;, NULL, NULL, SW_HIDE&#41;;</code></pre></div>
    <div class="meta">Posted on 2002-08-30 15:55:44 by stryker</div>
   </div>
   <div class="post" id="post-55541">
    <div class="subject"><a href="#post-55541">ExitWindowsEx question</a></div>
    <div class="body"><strong>The SharK</strong>, how does that help?</div>
    <div class="meta">Posted on 2002-08-30 16:19:12 by comrade</div>
   </div>
   <div class="post" id="post-55549">
    <div class="subject"><a href="#post-55549">ExitWindowsEx question</a></div>
    <div class="body">Hi<br /><br />Stryker is right, Windows uses a shortcut to &quot;exit to dos&quot;<br /><br />It's located in your windows directory, and it's called &quot;Exit to DOS.pif&quot;<br /><br />( try searching on *.pif, it may be translated to your windows language )<br /><br />This is what I found:<br /><br />To create the &quot;Exit to DOS.pif&quot; (Program Information File) executable:<br />You will need to shut down Windows and restart in MS-DOS mode, then go back into Win95/98 in order for the &quot;Exit to DOS.pif&quot; file to be created in your Windows folder. According to this MicroSoft Knowledge Base (MSKB) article, to define custom Config.sys and Autoexec.bat files to be processed when you restart your computer using the &quot;Restart the computer in MS-DOS mode&quot; Shut down... option, follow these steps:<br /><br /><br />Click the Start button -&gt; click Shut Down -&gt; click &quot;Restart (the computer) in MS-DOS mode&quot; -&gt; click Yes/OK.<br /><br />At the MS-DOS command prompt -&gt; type &quot;EXIT&quot; (without quotation marks) -&gt; press Enter.<br />NOTE: Steps 1-2 are IMPORTANT if you have never used the &quot;Restart (the computer) in MS-DOS mode&quot; option before. The &quot;Exit to DOS.pif&quot; file is not created until you perform these steps the first time.<br /><br /><br />Start Windows Explorer.<br /><br />Highlight the &quot;Exit to DOS&quot; file in the Windows folder. Right-click on it -&gt; select Properties.<br /><br />Click the Program tab -&gt; click Advanced -&gt; deselect the &quot;Warn before entering MS-DOS mode&quot; box.<br /><br />Check the &quot;MS-DOS mode&quot; box -&gt; click the Advanced tab -&gt; check the &quot;Specify A New MS-DOS Configuration&quot; option.<br /><br />Define the custom Config.sys file in the &quot;Config.sys For MS-DOS Mode&quot; box. Define the custom Autoexec.bat file in the &quot;Autoexec.bat For MS-DOS Mode&quot; box.<br />Click OK/Apply to close all dialog boxes.<br />From now on, each time when you'll restart your system using the &quot;Restart (the computer) in MS-DOS mode&quot; option, your custom Config.sys and Autoexec.bat files will be processed.<br /><br /><br />To shut down Windows 95/98 to the true/native/real MS-DOS prompt from a Desktop icon, follow the same steps above, except select the &quot;Use current MS-DOS configuration&quot; instead of &quot;Specify A New MS-DOS Configuration&quot; at step #6. Name this new batch file EXIT2DOS.BAT, place it in a folder of your choice, and then create a shortcut to it on the Desktop. Also, you can skip steps 1-2 above when creating EXIT2DOS.BAT.</div>
    <div class="meta">Posted on 2002-08-30 17:08:33 by Guerrilla</div>
   </div>
   <div class="post" id="post-55718">
    <div class="subject"><a href="#post-55718">ExitWindowsEx question</a></div>
    <div class="body">Thanks for the replies this is most helpful.<br /><br />Commrade wrote:  <div class="quote">The SharK, how does that help?</div> <br />Hmmm... what does it mean?<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-09-01 12:23:40 by czDrillard</div>
   </div>
   <div class="post" id="post-55723">
    <div class="subject"><a href="#post-55723">ExitWindowsEx question</a></div>
    <div class="body"><a target="_blank" href="http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q138996&amp;">http://support.microsoft.com/default.aspx?scid=KB;EN-US;Q138996&amp;</a><br /><a target="_blank" href="http://cmmg.biosci.wayne.edu/dwomble/exit_to_dos.html">http://cmmg.biosci.wayne.edu/dwomble/exit_to_dos.html</a></div>
    <div class="meta">Posted on 2002-09-01 12:53:14 by bazik</div>
   </div>
   <div class="post" id="post-55801">
    <div class="subject"><a href="#post-55801">ExitWindowsEx question</a></div>
    <div class="body">To bazik,<br /><br />Thanks for the excellent links.  I obviously need to hone my search skills.<br />I was going to suggest that you write a  <em>Productive Search Tutorial</em> but on second thought I'm sure there's one on the net already.  I'll just have to search for it.  Hmmm...:)<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-09-02 10:44:22 by czDrillard</div>
   </div>
   <div class="post" id="post-55804">
    <div class="subject"><a href="#post-55804">ExitWindowsEx question</a></div>
    <div class="body"><strong>czDrillard</strong>, click the &quot;How to ask&quot; link in my signature :)</div>
    <div class="meta">Posted on 2002-09-02 10:48:55 by bazik</div>
   </div>
  </div>
 </body>
</html>