<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Hooking into a COM Application - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14157" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=14157">Hooking into a COM Application</a></p>
   <div class="post" id="post-109395">
    <div class="subject"><a href="#post-109395">Hooking into a COM Application</a></div>
    <div class="body">Does anyone have a rough idea how to hook into a COM application?<br /><br />Im doing some funky stuff with AutoCad and Voice recognition which is working quite well, however, there is some commands that are not accepted by autocad, since other's are running.<br /><br />Ie.  If i start a line via the &quot;Line&quot; command, and then say &quot;End Point&quot; to specify snaps to the endpoint of an object.  The &quot;End Point&quot; command issued to Autocad via. OLE fails.  THis is because the &quot;Line.arx&quot; is currently running, and to keep things syncronized it will not allow ANY other command via OLE.  <br /><br />Its a good thing really, but in my case its preventing me from being able to give sub commands to functions.  Only top-level commands via. voice recognition.<br /><br />So as a work around, i thought, i have the application Interface pointer, why not hook into it, and make the application think i typed these command into the console by sending WM_CHAR (or similar) messages to it.  The console editor DOES allow asynchronouse commands, such as this.<br /><br />However, the application Interface does not have a &quot;HWND&quot; property to utilize and get the window's handle.. which leads me to me posting this question..<br /><br />If you have advice or an alternate suggestion please help ;)<br /><br />As always, Thanks again.<br />:alright:<br />NaN</div>
    <div class="meta">Posted on 2003-07-06 00:47:50 by NaN</div>
   </div>
   <div class="post" id="post-109402">
    <div class="subject"><a href="#post-109402">Hooking into a COM Application</a></div>
    <div class="body">Well with some sluthing around with a windows spy tool, i found a backdoor to issue commands to Autocad.  It stemmed from the fact that the ActiveDrawing interface (not Application) has a HWND property.  Used by itself it doesnt do anything with WM_CHAR commands, but if i GetParent on it, i get a handle that will use and properly direct the WM_CHAR commands to the internals of the program :alright:<br /><br />Its pretty cool now, I can put on my headset, and start drafting without touching a key!  It also helps since most commands in autocaed are unique in their names and sound (&quot;Circle&quot; &quot;Line&quot; &quot;Polyline&quot; etc.)<br /><br />Anywho, this works on win98se, and dont think it would be a problem for NT kernal os's since i legitimately got the child handle from OLE first.<br /><br />However, If you still have any comments, im open to them ;)<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-07-06 03:14:43 by NaN</div>
   </div>
   <div class="post" id="post-109421">
    <div class="subject"><a href="#post-109421">Hooking into a COM Application</a></div>
    <div class="body">Absolutely great, NaN! :alright:</div>
    <div class="meta">Posted on 2003-07-06 06:41:16 by japheth</div>
   </div>
   <div class="post" id="post-109430">
    <div class="subject"><a href="#post-109430">Hooking into a COM Application</a></div>
    <div class="body">I like the way you think :)</div>
    <div class="meta">Posted on 2003-07-06 10:16:08 by Homer</div>
   </div>
   <div class="post" id="post-109434">
    <div class="subject"><a href="#post-109434">Man that's Slick!</a></div>
    <div class="body">Too cool. Would love to see that in operation.</div>
    <div class="meta">Posted on 2003-07-06 10:29:42 by mrgone</div>
   </div>
   <div class="post" id="post-109453">
    <div class="subject"><a href="#post-109453">Hooking into a COM Application</a></div>
    <div class="body">Scotty says &quot;How quaint, a keyboard&quot;, then starts typing on it as if he's done it all his life.<br /><br />Good work Nan :alright: <br /><br />When do we get the OS version and get rid of keyboards?  ;) <br /><br />Regards,  P1 :cool:</div>
    <div class="meta">Posted on 2003-07-06 15:02:47 by Pone</div>
   </div>
   <div class="post" id="post-109459">
    <div class="subject"><a href="#post-109459">Hooking into a COM Application</a></div>
    <div class="body">I also suspect your sitting in a vibrating chair and a fridge is at arms length. :grin: jk</div>
    <div class="meta">Posted on 2003-07-06 15:25:41 by RobotBob</div>
   </div>
   <div class="post" id="post-109476">
    <div class="subject"><a href="#post-109476">Hooking into a COM Application</a></div>
    <div class="body">Wow, you should consider hooking it up to your lawnmower! May I <br />suggest that it may be useful to conduct a survey of and search for <br />other COM objects which support a similar mechanism.</div>
    <div class="meta">Posted on 2003-07-06 17:58:57 by Poimander</div>
   </div>
   <div class="post" id="post-109502">
    <div class="subject"><a href="#post-109502">Hooking into a COM Application</a></div>
    <div class="body">Thanks for the support everyone!  (Im surprised to be honest ~ didnt expect such interest from everyone).<br /><br />If your thinking of such things I can post the corrected code segments for SR.  But you still need to download the SDK to install the SR engine from microsoft.   Microsoft also has &quot;MSM&quot;s (if i got the abreviation correct) for the core engine components for distribution of developer's software.  BUt to be honest i dont know how to use them.   All i know is they link into the &quot;setup.exe&quot; unpacking tools for distribution of software (and i have never fiddles with such things).<br /><br />Anywho, if you want the source fragments I would be happy to post them.<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-07-06 23:22:49 by NaN</div>
   </div>
  </div>
 </body>
</html>