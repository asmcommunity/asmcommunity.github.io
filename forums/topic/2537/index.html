<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Strings Unknown Size - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2537" />
    <link rel="next" href="../?id=2537&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=2537">Strings Unknown Size</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=2537&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=2537&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="2537" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=2537&amp;page=2">&gt;</a><a href="../?id=2537&amp;page=2">&raquo;</a></form>   <div class="post" id="post-16029">
    <div class="subject"><a href="#post-16029">Strings Unknown Size</a></div>
    <div class="body">I  finally got a serious understanding of DD, DB.  (See DWORD Post)  I got my text out of that DWORD with 1000's of zero's trailing it.  So now it's All About STRINGS.  Image that you got a string that you don't know the size of.  GetFileSize is NOT the question here. <br /><br />StrLen is the best i got so far, but it has limits.  With it you have to declare the size that you want to get.... <strong>(remember we don't know the size and we don't want to use GetFileSize for whatever reason)</strong>   My's is a long story...see previous post...<br /><br />Imagine all you know is that the string start with the letter T with a bunch of : for separator throughout the string (or what every your case may be.)<br /><br />All I want to do is get the whole string to the last KNOWN Charater :  (Dump or Delete the rest or Move the string Out of There and <em>Thats It</em> .  I now know how to do a few thing with strings, but i never have saw no one do something like this.  Is this in the M32Lib...  Do you know how to do it...  Have you saw it before.<br />Thanks</div>
    <div class="meta">Posted on 2001-12-24 22:15:32 by cmax</div>
   </div>
   <div class="post" id="post-16041">
    <div class="subject"><a href="#post-16041">Strings Unknown Size</a></div>
    <div class="body">If you can't find a function to do it, it shouldn't be very hard..<br /><br />That's why strings always have a NULL at the end. You just need to count bytes until you find the NULL. The NULL terminator is pretty much a &quot;standard&quot; but it is a problem if you need other NULLs in the string...<br /><br />:)</div>
    <div class="meta">Posted on 2001-12-24 23:42:27 by S/390</div>
   </div>
   <div class="post" id="post-16042">
    <div class="subject"><a href="#post-16042">Strings Unknown Size</a></div>
    <div class="body">There has to be some parameters regarding the string:  either a NULL termination or a stored size value.  How is the string generated?  Can you save the size from that operation?  Does the string have a standard format - what are the rule governing the string?</div>
    <div class="meta">Posted on 2001-12-24 23:50:11 by bitRAKE</div>
   </div>
   <div class="post" id="post-16046">
    <div class="subject"><a href="#post-16046">Got to get to the Bottom of this</a></div>
    <div class="body">&quot;A DWORD moved to a DD Lenghth...Now it got 10000000's of zero's trailing the real string &quot; <br /><br />This string is already genarated from an ALLOCATE fuction.  I just move it to a DD Lenghth.  This is why i get 1000's of zero's trailing the text.  It's all came from the pointer i guest with the good stuff leading it. <br /><br />So, working with this is much differnt that a db.  It got to be a way to move THAT Lenghth to ANOTHER FUCTION more Felxable than StrLen so that it can rip out ALL of what is needed....and leave the junk behind or whatever. <br /><br />(Remember, we already moved it once to get to this mess)<br />I'm Hoping that someone know how....This is not standard stuff i beleive.<br /><br />Its stuff that can or cannot be done by  an experence assembler who experence it before.  But I do believe that nothing is imposible with Assembler.  I just don't know how to do it yet or was not told that this is Impossible.<br /><br />But Hey bitRAKE if anybody know it got to be youuuuuuu.(:)<br /><br />Thanks you both for the reply</div>
    <div class="meta">Posted on 2001-12-25 00:40:32 by cmax</div>
   </div>
   <div class="post" id="post-16047">
    <div class="subject"><a href="#post-16047">Strings Unknown Size</a></div>
    <div class="body">Don't copy all the zeroes in the first place.  Find the length of the string and only copy what you need - be sure to keep atleast one of those zeroes.<br /><br />Or, maybe I don't understand what your trying to do?<br />It's easier if I see some code.  :)<br /><br />I'd be more apt to go with <strong>S/390</strong>'s wisdom.</div>
    <div class="meta">Posted on 2001-12-25 00:55:09 by bitRAKE</div>
   </div>
   <div class="post" id="post-16049">
    <div class="subject"><a href="#post-16049">Strings Unknown Size</a></div>
    <div class="body">I'm not stepping over S/390's.  I just know a little about your style and it's deep.<br /> <br />Bla...Bla...Bla   ............................my sH_t<br /><br />invoke LocalAlloc, GMEM_FIXED, GatherText <br />mov MyText, eax <br /><br />Bla...Bla...Bla ................................now i run it through my Proc<br /> <br />mov    Lenghth,eax ....@ Quantum said put it in Lenghth to see something<br /><br />invoke StrLen....@ Quantum gave me this lead more than i ever had Before<br /><br />invoke WriteFile, hFile, MyText, Lenghth, addr dwBytes, NULL<br /><br /><br />ALL IS WELL....<br /><br />But as i said before the StrLen is limited....because suppose you don't know the acual size.  I like it this way. I just want to continue.  GetFileSize may not work when coming off a DD.<br /><br />By the way, I can do this easy 1,000,000,000x with edit boxes and static boxes but i wanted to avoid this too. In mem Only.<br /><br />IT'S ALL ABOUT STRINGS NOW...My DWORD post almost turned into a novel....I talk to much....</div>
    <div class="meta">Posted on 2001-12-25 01:17:41 by cmax</div>
   </div>
   <div class="post" id="post-16050">
    <div class="subject"><a href="#post-16050">Strings Unknown Size</a></div>
    <div class="body">I am sorry, but it is late and I am having trouble understanding.<br /><br />If you don't know the length of the string and it is followed by zeroes, then you can use <strong>invoke lstrlen,MyText</strong> then <strong>eax</strong> would be the length.  You could code it yourself:<pre><code>   mov eax,MyText<br />@@&#58;cmp BYTE PTR &#91;eax&#93;,0 ; test for zero<br />   je @F<br />   inc eax ; next byte<br />   jmp @B<br />@@&#58;sub eax,MyText<br />; eax is the length of the string</code></pre><strong>Edit:</strong> <em>Reading other thread now - should have read it before...</em></div>
    <div class="meta">Posted on 2001-12-25 01:32:40 by bitRAKE</div>
   </div>
   <div class="post" id="post-16057">
    <div class="subject"><a href="#post-16057">Strings Unknown Size</a></div>
    <div class="body">&quot;But Hey bitRAKE if anybody know it got to be youuuuuuu.( &quot;<br /><br />Thanks bitRAKE <br /><br />Did i lie.<br /><br />PS: I have not studie it yet but in the future if you see anything pretaining to this can you drop us a note (i know you would).  I got to go back to the DWORD post and set a note so that anyone interested can follow the lead....That's where it all started. sending me to strings.  If this work I'M IN HEVEN on EARTH.<br /><br />Thanks Guys i did not expect this so quickly.   The things ya do to keep us on top is AMAZEING.  <br /><br />No need to say &quot;Us Rookey We Got your Back&quot;.<br /><br />All new ideas would be Explored seriously.  <br /><br />cmax over and out</div>
    <div class="meta">Posted on 2001-12-25 02:45:36 by cmax</div>
   </div>
   <div class="post" id="post-16059">
    <div class="subject"><a href="#post-16059">Results</a></div>
    <div class="body">bitRAKE, it did not work for me just yet.  I got lazy .  But what i did do was to test everything with M32Lib StrLen.  Since none of my  files exceed 150 byte I set StrLen at 150, and since it's in .txt files the little square don't show up in any of the .txt files. (I was testing it by writing .doc files)<br /><br />But if that file is less than 150 byte it leave spaces only for each (what ever it is ) making the file size bigger on disk than what it actually is.<br /><br />I figure I do it all this way than latter use some kind of edit function to delete all those space so that i can still prove to be efficient.  Programmably i will be trading one step for another by doing this. But professionally i will still be lacking.  ( no one will ever know... I can live with this )<br /><br />Good Enough i think maybe.  After 9 days and 9 nights it was all worth it educationally.<br /><br />By the way you saying I'm sorry don't become you, We all know you are the Macro King.  Thank you for taking time out to assist us.  And that goes for the rest of you Educators. Can you imagine where we would be with out you....( Jumping out of REAL Windows and everything )<br /><br />Thanks for responding and putting up with me.<br /><br />Happy New Year</div>
    <div class="meta">Posted on 2001-12-25 02:57:00 by cmax</div>
   </div>
   <div class="post" id="post-16094">
    <div class="subject"><a href="#post-16094">StrLen should work</a></div>
    <div class="body">cmax<br />StrLen should work for what you want this function counts the letters untill youget to the zero<br /><br />lets say you have this in your code<br /><br />.data<br />MyText dd ?<br />MyTextLength dd ?<br /><br />...<br />blah blah..<br /><br />iinvoke LocalAlloc ...blah<br />;now eax is a pointer to a buffer in memory<br />mov MyText, eax ;so you save it in MyText<br /><br />;Next your proc moves the string into MyText Correct?<br /><br />;then if you do this<br />invoke StrLen, MyText<br />; now eax holds the number of letters in the string pointed to by   Mytext<br />; so you would save it<br />mov MyTextLenghth, eax<br /><br />and now use MyTextLenghth when ever you need it so remember that each letter is one BYTE (even though a DWORD is used to point to it) and use MyTextLenghth as the number of bytes to write in WriteFile<br />Just remember that MyText contains the address of a memory buffer where your string is stored wich is a sequence of bytes</div>
    <div class="meta">Posted on 2001-12-25 11:27:10 by Quantum</div>
   </div>
   <div class="post" id="post-16096">
    <div class="subject"><a href="#post-16096">Strings Unknown Size</a></div>
    <div class="body">There are <em>trim</em> functions within the M32LIB to remove spaces from both sides of a string.</div>
    <div class="meta">Posted on 2001-12-25 11:44:54 by bitRAKE</div>
   </div>
   <div class="post" id="post-16151">
    <div class="subject"><a href="#post-16151">Strings Unknown Size</a></div>
    <div class="body">&gt; bitRAKE: <br />&gt; There has to be some parameters regarding the string: either a NULL<br />&gt; termination or a stored size value. How is the string generated? Can you save<br />&gt; the size from that operation? Does the string have a standard format - what<br />&gt; are the rule governing the string? <br />&gt;  <br />&gt;   <br />&gt; S/390:<br />&gt; If you can't find a function to do it, it shouldn't be very hard.. <br />&gt; <br />&gt; That's why strings always have a NULL at the end. You just need to count bytes<br />&gt; until you find the NULL. The NULL terminator is pretty much a &quot;standard&quot; but<br />&gt; it is a problem if you need other NULLs in the string...<br /><br />Strings (under Windows) are terminated by null characters (bytes with all bits<br />set to zero).  The identifier NULL represents a null pointer constant so it<br />should be reserved for use in a pointer related context.<br /><br />If you want to terminate a string just use a plain 0 (zero) or two 0's (zeros)<br />if its a wide string.  I think you guys were were confused with the NUL<br />character whose code is defined in the ASCII character set.  Natively Windows<br />9x use the ANSI character set and the NT variants use the Unicode character<br />encoding.<br /><br />Just be careful when using these terms.<br /><br />regards,<br />Boggy</div>
    <div class="meta">Posted on 2001-12-25 20:23:51 by Boggy</div>
   </div>
   <div class="post" id="post-16155">
    <div class="subject"><a href="#post-16155">Strings Unknown Size</a></div>
    <div class="body"><strong>Boggy</strong>, your absolutely correct - it's easy to get lost in all the terminology, but it's very important when trying to communicate.  I've always hated NULL and VOID.  :grin:  What the hell is wrong with 0 and <em>{nothing}</em>?  If you asked me, I'd say this stuff was invented for the compiler - not people.  Oh, someone stop me before I veer off into a Crusade... :tongue:</div>
    <div class="meta">Posted on 2001-12-26 00:09:54 by bitRAKE</div>
   </div>
   <div class="post" id="post-16165">
    <div class="subject"><a href="#post-16165">???</a></div>
    <div class="body">ok cmax,<br /><br />i really have to say, that i'm totally confused about what you're trying to do finally. please let me summarize and tell me if this is what you would like to do:<br /><br />You have a string, stored in a dword variable. that means, that there are following 3 zeroes after every character, right? it's like i explained you:<br /><br />if you define a variable like this:<br />.data<br />   myString dd &quot;c&quot;,&quot;m&quot;,&quot;a&quot;,&quot;x&quot;,0<br /><br />...in memory it looks like this:<br />   &quot;c&quot;,0,0,0,&quot;m&quot;,0,0,0,&quot;a&quot;,0,0,0,&quot;x&quot;,0,0,0,0,0,0,0<br /><br />i hope you understand that now.<br /><br />and now you would like to get the string size, although there are zeroes, right? then lstrlen won't do the job, cause it checks for a terminating zero, it would find it a the second &quot;character&quot; (cause it is a zero). so you have to code your own procedure that does the job for you. now my final question (if this what i said is correct): do you want to get the size of the string, WITH the zeroes, or WITHOUT the zeroes?<br /><br />let's say you want it without the zeroes, then this could probably do the job, provided that your string finally really looks like the one i explained you at the beginning of this post. with this code you get the number of characters of the string:<br /><br /><pre><code><br />.data<br />   myString dd &quot;c&quot;,&quot;m&quot;,&quot;a&quot;,&quot;x&quot;,0     <br />   mylength dd 0<br /><br />.code<br />    push esi<br />    lea esi,myString<br />    @@&#58;<br />    cmp BYTE PTR &#91;esi&#93;,0<br />    je @F<br />    inc mylength<br />    add esi,4<br />    jmp @B<br />    @@&#58;<br />   pop esi<br /><br /></code></pre><br /><br />and if you would like the real length of the string, that means, with the zeroes, from the beginning to the end of the string, then just multiply mylength with four:<br /><br /><pre><code><br />mov eax,mylength<br />mov ecx,4<br />mul ecx<br />mov mylength,eax<br /></code></pre><br /><br />hope that helps now....<br /><br />nop<br /><br />p.s.: if myString is a pointer to a memory location with such a string, then just use mov esi,myString instead of lea esi,myString</div>
    <div class="meta">Posted on 2001-12-26 04:20:49 by NOP-erator</div>
   </div>
   <div class="post" id="post-16181">
    <div class="subject"><a href="#post-16181">Strings Unknown Size</a></div>
    <div class="body">Boggy,<br /><br />Yes, technically you are correct. However the term &quot;zero&quot; can also lead to confusion. Are you talking about binary zero (00h) or ASCII zero (30h)?<br /><br />&quot;My string0&quot;<br /><br />is quite different than<br /><br />&quot;My string&quot;,0<br /><br />NULL, as defined by WINDOWS.INC is<br /><br />NULL equ 0<br /><br />This eliminates the possibility of any confusion. The above string can also be written with the correct result as<br /><br />&quot;My string&quot;,NULL<br /><br />And it really isn't a &quot;size&quot; issue.<br /><br />cmp al,NULL<br />cmp ax,NULL<br />cmp eax,NULL<br /><br />all generate the proper code.<br /><br />Just my $.02 :)</div>
    <div class="meta">Posted on 2001-12-26 06:07:03 by S/390</div>
   </div>
   <div class="post" id="post-16209">
    <div class="subject"><a href="#post-16209">Strings Unknown Size</a></div>
    <div class="body">NOP-erator, it's all my fault I was trying hard to talk technically. There are a few people on the Board that get angry if you don't. <br /><br />I should have just said....Have you ever gotton Blank Spaces, Black Square, Scribble Scrabble or a BUNCH of 0's at the end of your file after writing it...There a few ways to do write files and one of them that i sometimes expermiment with will do this.<br /><br />It only lead me to the intrest of wanting to know how to remove such a thing from any string or whatever. So that i know what to do...It don't really matter how i got it... i just want to remove it with a procedure.<br /><br />But the good thing about all this is that I will be an Real Assembler one day because I did not know the true detail of what DD,DB and so on was all about until now.  Beleived me I will be reading much more deeper into things now.<br /><br />I tried rTrim from M32Lib but had no luck at trying to remove these zero at the end of the line below.  I had trouble with Dest:<br /><br />Do you know how to remove all Zero or Blanks Spaces . . . .after the last   :<br /><br />Thanks<br /><br /><br />10/14/01-00738 :: 10/15/01-00262 ::0000000000000000000000000</div>
    <div class="meta">Posted on 2001-12-26 09:52:34 by cmax</div>
   </div>
   <div class="post" id="post-16215">
    <div class="subject"><a href="#post-16215">Strings Unknown Size</a></div>
    <div class="body"><div class="quote"><br /><strong>Boggy</strong>, your absolutely correct - it's easy to get lost in all the<br />terminology, but it's very important when trying to communicate.  I've always<br />hated NULL and VOID.  :grin:  What the hell is wrong with 0 and <em>{nothing}</em>?  If you asked me, I'd say this stuff was<br />invented for the compiler - not people.  Oh, someone stop me before I veer off<br />into a Crusade... :tongue: </div><br /><br />bitRAKE,<br />Yeah NULL and VOID are remnants of C, they're quite useful macros though<br />because they aid portability. For example a void * is<br />a generic pointer (can store a ponter to any data type) which is used a lot in<br />allocating memory of unknown data types i.e. malloc(), calloc(),<br />VirtualAlloc() etc.  <br /><br />But since we're only concerned with a single implementation (Windows) on a<br />specific architecture (IA32) in 32bit assembly language their sole purpose (NULL, VOID)<br />seems only to confuse asm programmers and pollute the namespace.<br /><br />S/390,<br />&gt; Yes, technically you are correct. However the term &quot;zero&quot; can also lead to<br />&gt; confusion. Are you talking about binary zero (00h) or ASCII zero (30h)? <br /><br />So then use the *correct* term: <strong>null-character</strong>; it has the bit pattern<br />of all-bits-zero, and terminates a string character string under Windows.<br />NULL is a pointer concept, it has nothing to do with the character that<br />terminates a string--using these two terms synonymously is not only confusing<br />but incorrect.<br /><br />&gt; &quot;My string0&quot;<br />&gt;<br />&gt; is quite different than <br />&gt;<br />&gt; &quot;My string&quot;,0<br /><br />Obviously, and from the context it's quite clear what the representation and<br />meaning of zero is supposed be in each case.<br /><br />&gt; NULL, as defined by WINDOWS.INC is <br />&gt;<br />&gt; NULL equ 0 <br />&gt;<br /><br />This proves nothing; SECURITY_WORLD_RID, FILE_BEGIN and PIPE_TYPE_BYTE all<br />equate to zero as well: the representation of a type should have nothing to do<br />with how it is used. <br /><br />&gt; This eliminates the possibility of any confusion. The above string can also be<br />&gt; written with the correct result as <br />&gt;<br />&gt; &quot;My string&quot;,NULL <br /><br />Well you've managed to confuse me ;P  Think about the semantics of the idea<br />you're trying to express; a string constant terminted by a null pointer<br />constant--this simply doesn't make sense. All it does is create more questions<br />than it answer.<br /><br />If you need to terminate a character sequence terminate it with a zero, if you<br />need to do a comparison with a memory address use NULL.<br /><br />The NULL macro has very specific purpose; it is a null-pointer constant used<br />in pointer related expressions--using it for any other purpose simply because<br />&quot;you can&quot; or &quot;it still produces the correct results&quot; is IMO encouraging very a<br />bad programming practice.<br /><br />The reason for NULL is because its representation can change from system to<br />system, it just so happens that under MS Windows 32 bit environments it has<br />the representation of all-bits-zero, a system could just as well define it to<br />be bit pattern of 0xdeadbeef if it wanted to.  If you move you code to that<br />system its broken. But given the nature of what we're doing (asm programming)<br />is inherently unportable, that's a moot point.<br /><br />&gt; And it really isn't a &quot;size&quot; issue. <br />&gt;<br />&gt; cmp al,NULL <br />&gt; cmp ax,NULL <br />&gt; cmp eax,NULL <br />&gt;<br />&gt; all generate the proper code. <br /><br />Yup, as I said to BitRAKE above we're working in such a specific environment<br />that we can afford to hardcode values that rely on the underlying<br />implementation and architecture, but being in a technical forum I still think<br />its important to be pedantic and make these kinds of distinctions.<br /><br />&gt;<br />&gt; Just my $.02<br />My $.05<br /><br />Cheers, <br />Boggy</div>
    <div class="meta">Posted on 2001-12-26 10:38:49 by Boggy</div>
   </div>
   <div class="post" id="post-16228">
    <div class="subject"><a href="#post-16228">need more information</a></div>
    <div class="body">cmax, then please tell me, where this string, data or whatever is stored....give me more details please....<br /><br />nop</div>
    <div class="meta">Posted on 2001-12-26 12:14:54 by NOP-erator</div>
   </div>
   <div class="post" id="post-16279">
    <div class="subject"><a href="#post-16279">Strings Unknown Size</a></div>
    <div class="body"><strong>I Got It....I Got It..... This Below Should Explain It</strong> <br /><br />Look at it as a file on disk C:\NewRecord.text and all you want to do is open the file....remove everything AFTER the last :<br />Than RE-SAVE it<br /><br /><br />This is in the file now<br />10/14/01-00738 :: 10/15/01-00262 ::0000000000000000000000000<br /><br />This should be the file After the funtion<br />10/14/01-00738 :: 10/15/01-00262 ::<br /><br /><br /><em>rTrim may be the key but i don't know how to use it.</em></div>
    <div class="meta">Posted on 2001-12-26 20:23:10 by cmax</div>
   </div>
   <div class="post" id="post-16318">
    <div class="subject"><a href="#post-16318">haha...</a></div>
    <div class="body"><div class="quote">....remove everything AFTER the last</div> <br /><br />after the last what??? would be good if you could attach the file to your next post, so i can look at it. it still isn't clear for me. sorry......it's gettin funny that you're talking, and talking, and nobody understands you...... ;) <br /><br />nop</div>
    <div class="meta">Posted on 2001-12-27 04:52:34 by NOP-erator</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=2537&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=2537&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="2537" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=2537&amp;page=2">&gt;</a><a href="../?id=2537&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>