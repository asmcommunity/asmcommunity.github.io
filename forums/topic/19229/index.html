<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>COM obj for shortcut - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19229" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=19229">COM obj for shortcut</a></p>
   <div class="post" id="post-148546">
    <div class="subject"><a href="#post-148546">COM obj for shortcut</a></div>
    <div class="body">Can anyone tell me how to retreive a shortcut's target? I don't want to read it from the lnk file itself so I thought about com objects... :shock: <br />Dom</div>
    <div class="meta">Posted on 2004-08-27 02:24:52 by Dom</div>
   </div>
   <div class="post" id="post-148548">
    <div class="subject"><a href="#post-148548">COM obj for shortcut</a></div>
    <div class="body">Hi,<br /><br />I'm not totally sure but you can do:<br /><br />- create an IShellLink object<br />- query that object for IPersistFile<br />- Call IPersistFile::Load with the path of the .LNK file<br />- call IShellLink::GetPath to get the path of the target</div>
    <div class="meta">Posted on 2004-08-27 02:36:31 by japheth</div>
   </div>
   <div class="post" id="post-148551">
    <div class="subject"><a href="#post-148551">COM obj for shortcut</a></div>
    <div class="body">well, actually i need the whole target (path + executeable)</div>
    <div class="meta">Posted on 2004-08-27 03:01:16 by Dom</div>
   </div>
   <div class="post" id="post-148558">
    <div class="subject"><a href="#post-148558">COM obj for shortcut</a></div>
    <div class="body"><div class="quote"><br />IShellLink::GetPath<br /><br /><br />Retrieves the path and file name of a shell link object. <br /><br />HRESULT STDMETHODCALLTYPE GetPath(<br />    LPSTR pszFile,<br />    int cchMaxPath,<br />    WIN32_FIND_DATA *pfd,<br />    DWORD fFlags<br />   );<br /><br />Parameters<br />pszFile <br />Address of a buffer that receives the path and file name of the shell link object. <br />cchMaxPath <br />Maximum number of bytes to copy to the buffer pointed to by the pszFile parameter. <br />pfd <br />Address of a WIN32_FIND_DATA structure that contains information about the shell link object. <br />fFlags <br />Flags that specify the type of path information to retrieve. This parameter can be a combination of the following values: Flag Description <br />SLGP_SHORTPATH  Retrieves the standard short (8.3 format) file name.  <br />SLGP_UNCPRIORITY  Retrieves the Universal Naming Convention (UNC) path name of the file.  <br />SLGP_RAWPATH  Retrieves the raw path name. A raw path is something that might not exist and may include environment variables that need to be expanded. <br /><br />Return Values<br />Returns NOERROR if the operation is successful, and a valid path is retrieved. If the operation is successful, but no path is retrieved, it returns S_FALSE and pszPath will be empty. Otherwise, it returns an OLE-defined error value.<br /><br />See Also<br />IShellLink <br /><br />Requirements <br />  Version 4.00 and later of Shell32.dll<br /><br />  Windows NT/2000: Requires Windows NT 4.0 or later. <br />  Windows 95/98: Requires Windows 95 or later. <br />  Header: Declared in shlobj.h. <br /><br /></div></div>
    <div class="meta">Posted on 2004-08-27 07:15:57 by japheth</div>
   </div>
   <div class="post" id="post-148561">
    <div class="subject"><a href="#post-148561">COM obj for shortcut</a></div>
    <div class="body">ok i got it...GetPath is my function. :wink:</div>
    <div class="meta">Posted on 2004-08-27 07:33:19 by Dom</div>
   </div>
  </div>
 </body>
</html>