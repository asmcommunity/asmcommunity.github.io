<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Digital brain continued... v2 prerelease - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7680" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7680">Digital brain continued... v2 prerelease</a></p>
   <div class="post" id="post-55824">
    <div class="subject"><a href="#post-55824">Digital brain continued... v2 prerelease</a></div>
    <div class="body">8 months ago I posted this thread: <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=2932">Neural networks object: digital brain</a>, a test program for my neural network object that recognizes characters drawn with the mouse.<br /><br />I've been working on the next version for quite a while and most of it is finished now. Some things are missing but I'll give you the prerelease here.<br /><br /><strong>Quick start</strong><br /><br />Unzip the package somewhere and run digibrain.exe. Initially, the brain is filled with random crap. Push the 'load memory' button on the bottom right. Find 'charbrain.brain' in the same dir as digibrain.exe and open it. Now the brain will be in the state as I trained it. Start drawing characters onto the tablet and you will see the  windows below show the results. Above the tablet (where the text 'drawing tablet' is) are two hidden hotspots, when you click left in that area you will delete the last character in the result list. The right part of that area adds a space to the list. That way you can write an entire sentence with your mouse :).<br /><br />Each character needs to be drawn as one continuous line, and in the same way as it was trained. <br /><br /><strong>Training mode</strong><br /><br />When you click training mode you will see a directory listing of the dir. 'train_sets', which contain training sets for the digital brain. Currently you can't add these with the tool, only modify them, but you can copy an existing .tdat file so you'll have another file to store training data in. When you click one and then click on one of the characters, you can see a stored drawing of that character. Each set contains drawings for all characters (white are chars without data, blue ones have data and the green one is the active one). When all characters have a stored image, you can train the brain with that training set using the 'train' button, optionally changing the number of times the whole set is shown to the brain (1, 10 or 100x). All training will modify the existing brain data. So you can use many training sets and train the brain with it in turns. If you want a clean brain, use the brainwash button :). <br /><br />_preset 1.tdat and _preset 2.tdat are the sets I used to create the charbrain.brain file, the empty ones are for your own use and the _numbers ;-).tdat file doesn't contain characters but the numbers (1-9,0) for the characters a-j, the others are just set to a dummy drawing. The numberbrain.brain file contains the brain trained with this set, just load it and draw numbers.<br /><br /><strong>note</strong><br /><br />In the training mode you can see in what way the characters are drawn, in run mode draw them exactly like in training mode. Even the direction is very important (the U is drawn from left to right, V from right to left). Some characters look a little weird because they had to be drawn as a continuous line. <br /><br />I hope it's a bit clear, I wrote the text above in a hurry...The final version will have some documentation with it, and the full win32asm source code.<br /><br />Have fun!<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-09-02 14:59:37 by Thomas</div>
   </div>
   <div class="post" id="post-55833">
    <div class="subject"><a href="#post-55833">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Very impressive Thomas!  Only letter that gave me trouble was V.  Watching the data update realtime is very cool.  Your work has such style to it!<br /><br />I'm curious what MS Language Bar is using - as it requires no training and gets all my letters (print or cursive), also supports other languages.  As with the speak recognition, I'm sure there are multiple levels of interpretation going on - letter, word, sentence/grammar, etc.</div>
    <div class="meta">Posted on 2002-09-02 17:50:57 by bitRAKE</div>
   </div>
   <div class="post" id="post-55834">
    <div class="subject"><a href="#post-55834">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Thomas, very nice. I love the interface, how'd you get those anti-aliased line? :) <br /><br />I've done a lot of neural network work myself lately, however nothing as intutivily user friendly as this example. Anyting I've done would bore the pants off people, this type of visual demonstration is a nice idea. Congrats.<br /><br />I'd be curious as to what net you're using, is it a back propagation, or you of the many others. Also what sort of layout are you using, ie no of layers and number of neurons per layer, thats assuming backprop again though. If you don't mind that is. :)</div>
    <div class="meta">Posted on 2002-09-02 17:54:10 by Eóin</div>
   </div>
   <div class="post" id="post-55845">
    <div class="subject"><a href="#post-55845">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Wow... verrrrrrry good ...<br /><br />I can not wait for the release :) (sources) <br /><br />Have wanted to do such a thing all of my life but never had the time to do it :)</div>
    <div class="meta">Posted on 2002-09-02 20:04:59 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-55848">
    <div class="subject"><a href="#post-55848">Digital brain continued... v2 prerelease</a></div>
    <div class="body">:(<br /><br />Won't run on my K6-2... causes an invalid instruction (looks like CMOVcc)<br /><br />--Chorus</div>
    <div class="meta">Posted on 2002-09-02 20:53:52 by chorus</div>
   </div>
   <div class="post" id="post-55912">
    <div class="subject"><a href="#post-55912">Digital brain continued... v2 prerelease</a></div>
    <div class="body"><div class="quote">Very impressive Thomas! Only letter that gave me trouble was V. Watching the data update realtime is very cool. Your work has such style to it!</div><br /><br />Did you draw the V from right to left?<br /><br /><div class="quote">I'm curious what MS Language Bar is using - as it requires no training and gets all my letters (print or cursive), also supports other languages. As with the speak recognition, I'm sure there are multiple levels of interpretation going on - letter, word, sentence/grammar, etc.</div><br /><br />Well with the proper training you can allow multiple variants of the same characters. You could try different training sets with different styles.<br /><br /><div class="quote">Thomas, very nice. I love the interface, how'd you get those anti-aliased line?  </div><br /><br />It's a kind of full scene anti-aliasing, it draws everything at double size and then scales it down by taking the average of every 4 pixels (using <a target="_blank" href="http://www.madwizard.org/snippets/viewSnippet.php?s_ID=1">this code snippet</a>). It also uses the <a target="_blank" href="http://www.madwizard.org/snippets/viewSnippet.php?s_ID=16">bitmap block blend snippet</a> and bitRAKE's <a target="_blank" href="http://www.madwizard.org/snippets/viewSnippet.php?s_ID=8">NonUniformAverages</a> function.<br /><br /><div class="quote">I'd be curious as to what net you're using, is it a back propagation, or you of the many others. Also what sort of layout are you using, ie no of layers and number of neurons per layer, thats assuming backprop again though. If you don't mind that is. </div><br /><br />It's a multilayer feedforward network with backpropagation. The network has 24 inputs. The sin/cos graph has blended blocks drawn over the line when the drawing is finished. These blocks divide the graph into 12 average sine and cosine values of the drawing angle. These values are directly fed to the network inputs.<br />Furthermore it has 26 outputs (26 characters), and one hidden layer of 20 neurons.<br /><br /><div class="quote">Won't run on my K6-2... causes an invalid instruction (looks like CMOVcc)</div><br /><br />Its because of the PNG library used for the images.. it has one CMOV instruction in the CRC procedure :). Iirc  the non-safe build of the library doesn't use the CRC proc so I'll use that one in the next build.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-09-03 09:23:36 by Thomas</div>
   </div>
   <div class="post" id="post-55913">
    <div class="subject"><a href="#post-55913">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Here's the exe without cmov (you still need the other zip)<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-09-03 09:28:19 by Thomas</div>
   </div>
   <div class="post" id="post-55930">
    <div class="subject"><a href="#post-55930">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Thats actually a tiny net :eek: . I'd figured such a complicated thing as letter recognition would required a much larger net. <br /><br />I know personally I'd have used nothing less than 100 Neurons in the hidden layer, but then I do tend to go for overkill ;) . As it stands though I still can't help but feel you could perhaps do with at least 24, I always felt hidden neurons should be never less than the inputs. But I'm sure you've tested many values, and if twenty works then using any more would be needlessly bloated and slow.<br /><br />I'm very impressed though, I look forward to seeing the net source code.</div>
    <div class="meta">Posted on 2002-09-03 12:16:51 by Eóin</div>
   </div>
   <div class="post" id="post-55942">
    <div class="subject"><a href="#post-55942">Digital brain continued... v2 prerelease</a></div>
    <div class="body"><div class="quote">I know personally I'd have used nothing less than 100 Neurons in the hidden layer, but then I do tend to go for overkill.</div><br />Many neurons require more training so I just tried out what value worked reasonably.<br /><br /><div class="quote">As it stands though I still can't help but feel you could perhaps do with at least 24, I always felt hidden neurons should be never less than the inputs.</div><br /><br />I don't know if the hidden layer should always have more neurons than the input/output layer, it would seem so. But remember that between each two layers, every possible connection is made. That means that between the input and the hidden layer, 24x20=480 connections are made, and between the hidden layer and the output, 20x26=520 connections. Each connection has it's own weight so there's more information stored than it seems. <br /><br />Now that I think of it, theoratically, if the hidden layer's output values were of infinite precision, anything could be encoded with it. Floating points don't have infinite precision but enough to define an encoding for only 26 characters (0.01 = A, 0.02 = B, 0.03 =C for example).<br /><br />I'll try using one neuron in the hidden layer and see what happens :grin:.<br /><br /><div class="quote">I'm very impressed though, I look forward to seeing the net source code.</div><br /><br />Well the nn source itself was included in the previous post (version 1), the digibrain app itself will be available very soon.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-09-03 13:09:46 by Thomas</div>
   </div>
   <div class="post" id="post-55945">
    <div class="subject"><a href="#post-55945">Digital brain continued... v2 prerelease</a></div>
    <div class="body">1 neuron in the hidden layer doesn't work at all :).. However I tried 10 and it seems to give better results than with 20 neurons :eek: :confused:.. With 10 neurons even characters drawn less perfect are recognized...<br /><br />Here's the exe with 10 neurons.. the brain files aren't compatible with this version so you'll have to train yourself.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-09-03 13:18:08 by Thomas</div>
   </div>
   <div class="post" id="post-56061">
    <div class="subject"><a href="#post-56061">Digital brain continued... v2 prerelease</a></div>
    <div class="body">I'd say 0.01, 0.02, etc are just too percise, you need atlot of training to get percision to that level. It is intresting though that 10 work better than 20.</div>
    <div class="meta">Posted on 2002-09-04 12:52:22 by Eóin</div>
   </div>
   <div class="post" id="post-56396">
    <div class="subject"><a href="#post-56396">Digital brain continued... v2 prerelease</a></div>
    <div class="body">The complete package including the latest binary, full source code and documentation is now available at my website!<br /><br /><a target="_blank" href="http://www.MadWizard.org">www.MadWizard.org</a><br /><br />Thomas</div>
    <div class="meta">Posted on 2002-09-06 14:45:33 by Thomas</div>
   </div>
   <div class="post" id="post-109214">
    <div class="subject"><a href="#post-109214">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Fantastic work Thomas!<br /><br />I wonder how hard it would be to use the time between each segment, as well, for another dimension in the network's analysis and increase accuracy.  When i made custum letters more defined as what the letter should look like, the results are often confused, and justifiably so. <br /><br />By giving the network 12 average rates to go with the 12 sine and cos values, it may be able to hold more accurate responses.  Down side is you would need to train to each person's mousing speed while drawing ;)<br /><br /><br />But beyond my babling, you've done very good work! Very clean code and quite readable.  Keep up the great work!<br /><br />:alright:<br />:NaN:</div>
    <div class="meta">Posted on 2003-07-03 22:09:46 by NaN</div>
   </div>
   <div class="post" id="post-109426">
    <div class="subject"><a href="#post-109426">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Hi Thomas,<br /><br />Can you more explain here what for algorithms you have used, Backpropagation networks, recurrent networks and how you process the given inputs, how many layers and hidden neurons, how many input neurons.<br />I ask You because I have written some recognization NN's, like as yours, based on Recurrent Neuronal Networks. On RCC's we don't define the count of Hidden Layers or Neurons per Layer, the RCC train and create these Layers self. Additional my RCC's choose by genetic algortihms the best working Network and Activation Functions.<br /><br />Most important for me are your Preprocessing of the inputs, but Your source is hard to read for me.<br /><br />By the way: how can I define my own net to train with your software. I get always an exception if I want to define my own train set of chars.<br /><br />Best regards, Hagen</div>
    <div class="meta">Posted on 2003-07-06 08:20:23 by Hagen</div>
   </div>
   <div class="post" id="post-109586">
    <div class="subject"><a href="#post-109586">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Thomas, is there anyway you can document the NNet.asm file a bit more.  Im most interested in how you use the there memory arrays.  Ie. a road map, so i can follow your source better.  I think im getting it, but im now 100%.  As well a bit more info on how your training works on these arrays woudl be nice.  (Neither is imperitive to me, i will figure both out eventually, but if you can help me along it would be nice ;) )<br /><br />Again, great work.<br />:NaN:</div>
    <div class="meta">Posted on 2003-07-07 14:51:42 by NaN</div>
   </div>
   <div class="post" id="post-109623">
    <div class="subject"><a href="#post-109623">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Hi Nan,<br /><br />if you can read Delphi I can you send my NN source.<br />For such complex algorithms is a high level language better to understand.<br />It contains normal Back Propagation Networks with QuickProp as Backpropagation algorithm.<br />The second network that I implemented are the Recurrent Neural Network. These RCC's construct they needed Layers and Neurons self on training phase.<br /><br />Hagen</div>
    <div class="meta">Posted on 2003-07-07 19:08:05 by Hagen</div>
   </div>
   <div class="post" id="post-109633">
    <div class="subject"><a href="#post-109633">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Sure zip it up and post it.  Would be a good external reference (from MASM ;) ).<br /><br />I have *some* knowledge of NN's .  I studied them four years ago in college, but i admit, i dont remember much about the specifics of the hidden layers and how they are configured for different types of networks....   Abstractly i can follow no problem.  But the source is less abstract, and more organized (which is slowing me down a bit ;) )<br /><br />:NaN:</div>
    <div class="meta">Posted on 2003-07-07 23:50:28 by NaN</div>
   </div>
   <div class="post" id="post-111252">
    <div class="subject"><a href="#post-111252">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Sorry I didn't see and coudn't reply to this thread earlier because I was on vacation..<br />The main NN code is pretty hard to read I admit, there's not much documentation in it. After this version of the digital brain program I haven't updated it (it was just a fun project for me, I've never really needed NN in other projects yet). I'll see if I can get some time to document the program, I'll have to take a good look myself as well as it's a whike ago that I wrote it. <br /><br />There is some info in the earlier thread about the program:<br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=2932">http://www.asmcommunity.net/board/index.php?topic=2932</a><br /><br />And here as well:<br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=9855">http://www.asmcommunity.net/board/index.php?topic=9855</a><br /><br />Thomas</div>
    <div class="meta">Posted on 2003-07-20 03:25:33 by Thomas</div>
   </div>
   <div class="post" id="post-111313">
    <div class="subject"><a href="#post-111313">Digital brain continued... v2 prerelease</a></div>
    <div class="body"><div class="quote">I'm curious what MS Language Bar is using - as it requires no training and gets all my letters (print or cursive), also supports other languages. As with the speak recognition, I'm sure there are multiple levels of interpretation going on - letter, word, sentence/grammar, etc.</div> <br />hey if you have any links to speech recognition software it would be very appreciated if you could pm me them!</div>
    <div class="meta">Posted on 2003-07-20 15:36:02 by Qages</div>
   </div>
   <div class="post" id="post-111321">
    <div class="subject"><a href="#post-111321">Digital brain continued... v2 prerelease</a></div>
    <div class="body">Very impressive!</div>
    <div class="meta">Posted on 2003-07-20 19:46:40 by comrade</div>
   </div>
  </div>
 </body>
</html>