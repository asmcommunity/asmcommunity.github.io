<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>GetOpenFileName - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15232" />
  <link rel="prev" href="../?id=15232&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15232">GetOpenFileName</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=15232&amp;page=1" style="">&laquo;</a><a href="../?id=15232&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="15232" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-118401">
    <div class="subject"><a href="#post-118401">GetOpenFileName</a></div>
    <div class="body">My mistake, I pasted the wrong name. For me I use, OFN_FILEMUSTEXIST or OFN_PATHMUSTEXIST or OFN_LONGNAMES or OFN_EXPLORER or OFN_HIDEREADONLY.<br /><br />Inside Commdlg.h in my sdk, it is defined as <strong>#define  OFN_EX_NOPLACESBAR         0x00000001</strong><br />So just <strong>OFN_EX_NOPLACESBAR equ 1</strong></div>
    <div class="meta">Posted on 2003-09-16 22:11:18 by roticv</div>
   </div>
   <div class="post" id="post-118408">
    <div class="subject"><a href="#post-118408">GetOpenFileName</a></div>
    <div class="body">Yup, and this is the new OPENFILENAME structure. I have renamed it, you would have to use the OFN part only for Win9x/NT4 and set the size accordingly, I tested it and it works fine:<br /><pre><code>NEWOPENFILENAME STRUCT<br />	OFN			OPENFILENAME	&lt;&gt;<br />	pvReserved		DWORD		?<br />	dwReserved		DWORD		?<br />	FlagsEx			DWORD		?<br />NEWOPENFILENAME ends</code></pre></div>
    <div class="meta">Posted on 2003-09-16 23:41:47 by donkey</div>
   </div>
   <div class="post" id="post-118413">
    <div class="subject"><a href="#post-118413">GetOpenFileName</a></div>
    <div class="body">Just as an addendum to the new structure info. The new version does not react exactly like the older, more reliable version. When you remove the Places Bar, the dialog is no longer automatically resized after the WM_INITDIALOG is sent. This was the case in the older version but it appears that MS has decided not to include the autosizing feature in this one. So, if like me you add controls to the dialog and expect it to resize automatically (as the docs say it should) you will be disappointed. To fix the problem you must use the old structure size and remove the Places Bar by other means. Also it appears the Open as read-only check box is misplaced ?</div>
    <div class="meta">Posted on 2003-09-17 00:16:10 by donkey</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=15232&amp;page=1" style="">&laquo;</a><a href="../?id=15232&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="15232" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>