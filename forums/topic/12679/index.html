<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>call a win32 api,which register changed - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=12679" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=12679">call a win32 api,which register changed</a></p>
   <div class="post" id="post-98012">
    <div class="subject"><a href="#post-98012">call a win32 api,which register changed</a></div>
    <div class="body">eax and ecx?<br />others?</div>
    <div class="meta">Posted on 2003-04-19 11:33:41 by suspy</div>
   </div>
   <div class="post" id="post-98013">
    <div class="subject"><a href="#post-98013">call a win32 api,which register changed</a></div>
    <div class="body">Only ebx,esi,edi,esp will be preserved.<br /><br />Thus expect eax,ecx,edx not to be preserved.<br /><br /> oopz... ebp will be preserved. Just remember to preserve esi,edi,ebx...<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=10285&amp;highlight=callee">http://www.asmcommunity.net/board/index.php?topic=10285&amp;highlight=callee</a></div>
    <div class="meta">Posted on 2003-04-19 11:35:53 by roticv</div>
   </div>
   <div class="post" id="post-98014">
    <div class="subject"><a href="#post-98014">call a win32 api,which register changed</a></div>
    <div class="body">You forgot ebp :)<br /><br />Thomas<br />P.S. wrong forum</div>
    <div class="meta">Posted on 2003-04-19 11:37:46 by Thomas</div>
   </div>
   <div class="post" id="post-98067">
    <div class="subject"><a href="#post-98067">call a win32 api,which register changed</a></div>
    <div class="body">suspy,<br /><br />Windows works by establishing a convention or set of rules if you like about how registers are used.<br /><br />If you use normal procedures, the two registers ESP and EBP are handled automatically. The convention is that each procedure must preserve EBX ESI and EDI if it is going to use them but is free to modify EAX ECX and EDX.<br /><br />This means in practical terms that if you want to call a Windows API function, it will preserve EBX ESI and EDI but it will most probably modify one or more of the registers EAX ECX and EDX.<br /><br />If you observe the convention properly, you preserve EBX ESI and EDI in your own procedure which will not be changed by an API call but preserve any values you have in EAX ECX and EDX before the API call and restore them aftre the API call had returned.<br /><br />This way you can safely nest as many procedures and API calls as you like without any problems.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2003-04-19 21:37:54 by hutch--</div>
   </div>
   <div class="post" id="post-98309">
    <div class="subject"><a href="#post-98309">call a win32 api,which register changed</a></div>
    <div class="body">Thanks<br />I got it</div>
    <div class="meta">Posted on 2003-04-20 23:51:11 by suspy</div>
   </div>
  </div>
 </body>
</html>