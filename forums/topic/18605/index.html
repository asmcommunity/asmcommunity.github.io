<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>timer - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18605" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=18605">timer</a></p>
   <div class="post" id="post-144112">
    <div class="subject"><a href="#post-144112">timer</a></div>
    <div class="body">Hi everyone,<br />i am sort of new in tihis stuff,acctually i just starting.I need a <strong>timer</strong> realized with assembler so it can run in win console apps.i hope the asm is my last chance since MFC and other win related stuff do not satisfy my needs.Here is the problem:i need to develop a C++ class which will take some action every <strong>20ms</strong>.Accuracy is <strong>the must</strong>.It must be possible to &quot;kill&quot; and &quot;start&quot; timer from out of program(i resolve this with handles).Threads and win timers can not give me what i need,can asm do?Is there any way to &quot;catch&quot; processor clock at given time period with asm?Any help,tip,idea,... will be of great help.<br /><br />thanks.</div>
    <div class="meta">Posted on 2004-06-17 10:46:35 by nikoladsp</div>
   </div>
   <div class="post" id="post-144115">
    <div class="subject"><a href="#post-144115">timer</a></div>
    <div class="body">You could code a driver if you want _the_ best precision - but I advice against this ;)<br /><br />If you raise your process+thread priority, and call some API which name I can't remember :/, you can get more accuracy for Sleep(), which would let you control the timer through threading.<br /><br />Timing is a pretty tough problem on multitasking&amp;protected operating systems, and it's been discussed here and other places a lot of times. Don't use RDTSC, as it can drift with power-saving schemes. Look into the multimedia timers, I believe they will use the APIC timer if available.</div>
    <div class="meta">Posted on 2004-06-17 11:00:16 by f0dder</div>
   </div>
   <div class="post" id="post-144122">
    <div class="subject"><a href="#post-144122">i just can kill myself...</a></div>
    <div class="body">Well,<br />i want use threads anyway,Sleep() is a killer for precision which must be about 100microsec.I saw some articles about using some interrupts and &quot;pump&quot; in it some fake interrupts to have more resolution.I tried MMtimers,but problem is that my class won't be used under windows-it will be used in some mobile-phone project in some custom famework,...<br />I know that windows is not RTOS so i just wanna know is this what i need is possible to do anyhow at all...<br /><br />thanks &amp; cheers.</div>
    <div class="meta">Posted on 2004-06-17 13:12:16 by nikoladsp</div>
   </div>
   <div class="post" id="post-144124">
    <div class="subject"><a href="#post-144124">timer</a></div>
    <div class="body">Is the Timer API function not good enough? I heard that its resolution is around 10ms on WindowsNT/2K/XP systems. It's really easy to implement in asm too.</div>
    <div class="meta">Posted on 2004-06-17 13:49:26 by DeX</div>
   </div>
   <div class="post" id="post-144125">
    <div class="subject"><a href="#post-144125">timer</a></div>
    <div class="body">Don't know if these help, but they seem to sugest the 10ms resolution DeX mentioned:<br /><br /><a target="_blank" href="http://www.sysinternals.com/ntw2k/info/timer.shtml">http://www.sysinternals.com/ntw2k/info/timer.shtml</a><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/multimed/htm/_win32_multimedia_timers.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/multimed/htm/_win32_multimedia_timers.asp</a><br /><br /><em>Edit: sorry, didn't read the bit about you already having tried these :)</em></div>
    <div class="meta">Posted on 2004-06-17 14:12:22 by Jibz</div>
   </div>
   <div class="post" id="post-144169">
    <div class="subject"><a href="#post-144169">timer</a></div>
    <div class="body">Thanks guys for helping.<br />you see i need good precision cause i need to measure time intervals of message packets arrival( QuerryPerformance... do a good job here) but problem arises when i need to send packages every 20milisec,get system time at get jitter.This i can't do with any win timer cause there are those mean win threading stuff:nobody guarantees me that my thread wont be suspended for say 3milisec which will ruined my measurement.<br />  cheers.</div>
    <div class="meta">Posted on 2004-06-18 04:25:57 by nikoladsp</div>
   </div>
   <div class="post" id="post-144374">
    <div class="subject"><a href="#post-144374">timer</a></div>
    <div class="body">It does seem like windows isn't the best platform for what you want :) - I assume setting process+thread priority to realtime isn't really an option for you either.<br /><br />You're prototyping stuff on windows, then going to move it to the cellphone stuff later on?</div>
    <div class="meta">Posted on 2004-06-21 03:55:01 by f0dder</div>
   </div>
   <div class="post" id="post-144379">
    <div class="subject"><a href="#post-144379">timer</a></div>
    <div class="body">You are right,<br />i develop some Symbian stuff and later we put it onto phones.For some experiment purposes we need to test some jitter and package loss.These testings needs to be implemented on Windows and on Symbian.I already wrote class to measure time elapsed between packages arrival an getting system time in NPS time format but problem arises in impementing clock to tick every 20milisec.Threads does not help me cause they can (and most probably will) cause a mistakes in measurement,so practically i do have solution already but i am serching alternative(read better solutions).<br />thanks for the help.<br />  nikola</div>
    <div class="meta">Posted on 2004-06-21 05:20:05 by nikoladsp</div>
   </div>
  </div>
 </body>
</html>