<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>On Dlls (again...) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27574" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27574">On Dlls (again...)</a></p>
   <div class="post" id="post-196972">
    <div class="subject"><a href="#post-196972">On Dlls (again...)</a></div>
    <div class="body">OK, this seems really hard to me!
Microsoft Flight Sim has a directory in it, where there are severla Dlls, that are called at startup and executed. It's possible to write a new Dll, and put it in that dir, and it will do what you want, to modify the FS. I don't know how. In another forum, the same question was put, and the answer was:

"Add the following code to the normal Dll:

void __stdcall module_init(void) {
    // add code to be executed during FS initialization
}
void __stdcall module_deinit(void) {
    // add code to be executed when FS shuts down
}

__declspec(dllexport) struct {
    struct {
        int fnID;
        PVOID fnptr;
    } t0;
    struct {
        int fnID;
        PVOID fnptr;
    } t1;
} ImportTable = {
    {0x00000000, NULL},
    {0x00000000, NULL}
};

__declspec(dllexport) struct {
    int ModuleID;
    void (__stdcall *ModuleInit)(void);
    void (__stdcall *ModuleDeinit)(void);
    UINT Flags;
    UINT Priority;
    PVOID DialogTable;
    PVOID ptr;
} Linkage = {
    0x00000000,
    module_init,
    module_deinit,
    0,
    0,
    NULL,
    NULL
};



How can I achieve the same result in Asm? What does __declspec(dllexport) struct {.... mean and how do I translate it in Asm?

Many thanks!   Kefren


This message was edited by kefren, on 4/9/2001 5:51:48 AM</div>
    <div class="meta">Posted on 2001-04-09 05:44:00 by kefren</div>
   </div>
  </div>
 </body>
</html>