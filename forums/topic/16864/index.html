<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>HLA and COM - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16864" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=16864">HLA and COM</a></p>
   <div class="post" id="post-130843">
    <div class="subject"><a href="#post-130843">HLA and COM</a></div>
    <div class="body">Can I call COM functions from HLA?<br /><br />All I really need to do is call <strong>CoInitialize</strong> and <strong>CoUninitialize</strong> so that I can eliminate these calls from Ernie's Image.lib, that I use to load large numbers of images, inside a loop.  Repeatedly starting and stopping COM can cause unpredictable results.  <br /><br />Image.lib is writen in MASM32, but I wrote an HHF for it, so I can call it from my HLA code.<br /><br />WK</div>
    <div class="meta">Posted on 2004-01-16 21:55:39 by The Worrier King</div>
   </div>
   <div class="post" id="post-130991">
    <div class="subject"><a href="#post-130991">Re: HLA and COM</a></div>
    <div class="body"><div class="quote"><em>Originally posted by The Worrier King </em><br />Can I call COM functions from HLA?<br /></div><br /><br />Sure you can.<br /><br /><div class="quote"><br />All I really need to do is call <strong>CoInitialize</strong> and <strong>CoUninitialize</strong> so that I can eliminate these calls from Ernie's Image.lib, that I use to load large numbers of images, inside a loop.  Repeatedly starting and stopping COM can cause unpredictable results.  <br /><br />Image.lib is writen in MASM32, but I wrote an HHF for it, so I can call it from my HLA code.<br /><br />WK </div><br />I am afraid I've never done this, so I can't give you the exact details.<br />But you might look at the DLL example in the HLA Examples directory (linkage with COM files is very similar to DLLs).<br />Cheers,<br />Randy Hyde</div>
    <div class="meta">Posted on 2004-01-18 14:39:35 by rhyde</div>
   </div>
   <div class="post" id="post-131120">
    <div class="subject"><a href="#post-131120">HLA and COM</a></div>
    <div class="body">Hope this helps :) <br /><br /><a target="_blank" href="http://groups.google.com/groups?dq=&amp;hl=en&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;safe=off&amp;frame=right&amp;th=4a908b8dea151109&amp;seekm=7Y2Pb.7%249b5.1%40newsfep3-gui.server.ntli.net#link7">http://groups.google.com/groups?dq=&amp;hl=en&amp;lr=&amp;ie=UTF-8&amp;oe=UTF-8&amp;safe=off&amp;frame=right&amp;th=4a908b8dea151109&amp;seekm=7Y2Pb.7%249b5.1%40newsfep3-gui.server.ntli.net#link7</a></div>
    <div class="meta">Posted on 2004-01-20 05:17:45 by Odyssey</div>
   </div>
   <div class="post" id="post-131259">
    <div class="subject"><a href="#post-131259">HLA and COM</a></div>
    <div class="body">Thanks.<br /><br />I just had to add this to one of my HHF files, and all's well. :grin: <br /><br /><pre><code>procedure	CoInitialize&#40;pvReserved&#58;dword&#41;; @returns&#40; &quot;eax&quot; &#41;; @external&#40;&quot;_CoInitialize@4&quot;&#41;; <br />procedure	CoUninitialize; @external&#40;&quot;_CoUninitialize@0&quot;&#41;;</code></pre></div>
    <div class="meta">Posted on 2004-01-21 07:20:17 by The Worrier King</div>
   </div>
  </div>
 </body>
</html>