<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>MASM32 V5 vs V7 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5296" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5296">MASM32 V5 vs V7</a></p>
   <div class="post" id="post-37463">
    <div class="subject"><a href="#post-37463">MASM32 V5 vs V7</a></div>
    <div class="body">Can anybody please explain why this code:<br /><br />invoke CreateFile, addr parambuff, GENERIC_WRITE, FILE_SHARE_READ or FILE_SHARE_WRITE, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL<br /><br />does effectively create the file in MASM V5 but in V7 eax==INVALID_HANDLE_VALUE on return.  Invoking GetLastError<br />to see what the problem is, shows error # 2, meaning the file doesn't exist, I think. Why should the file exist if the point is to create a new one? TIA</div>
    <div class="meta">Posted on 2002-05-09 21:53:29 by xXXx</div>
   </div>
   <div class="post" id="post-37472">
    <div class="subject"><a href="#post-37472">MASM32 V5 vs V7</a></div>
    <div class="body">Would be more helpful if we could see how your using the createfile api...<br /><br />There are many examples of creating a file in this forum or in the masm32 package...<br /><br />Sliver</div>
    <div class="meta">Posted on 2002-05-09 23:48:45 by Sliver</div>
   </div>
   <div class="post" id="post-37473">
    <div class="subject"><a href="#post-37473">MASM32 V5 vs V7</a></div>
    <div class="body">in V7 <br /><br />What make in V7  so great when 5 and 6 did the job RIGHT.<br /><br />All upgrades are not true to me.... c...xp and what ever</div>
    <div class="meta">Posted on 2002-05-09 23:49:02 by cmax</div>
   </div>
   <div class="post" id="post-37480">
    <div class="subject"><a href="#post-37480">MASM32 V5 vs V7</a></div>
    <div class="body">Ok, found the bug. It's not in CreateFile, but in the filename. Some parsing is being done on the filename before it's used. In v5 lstr was being used. In v7 lstr is equ'd to szLeft, but szLeft copies one more character to the destination buffer. It happens this character is invalid for filenames. <br /><br />It's true, upgrades aren't always so good. I'm still running Win95, but in this case I just wanted to make sure MASM contained all upgraded functions/constants for Internet programming.</div>
    <div class="meta">Posted on 2002-05-10 00:11:16 by xXXx</div>
   </div>
   <div class="post" id="post-37483">
    <div class="subject"><a href="#post-37483">MASM32 V5 vs V7</a></div>
    <div class="body">&quot;&quot;for Internet programming&quot;&quot;<br /><br />I would never beleive that V7 is for us as i said.  But someone else will surely know better than me....But as i said M$ need money...so</div>
    <div class="meta">Posted on 2002-05-10 00:22:10 by cmax</div>
   </div>
   <div class="post" id="post-37581">
    <div class="subject"><a href="#post-37581">MASM32 V5 vs V7</a></div>
    <div class="body">cmax, masm32 != ml.exe</div>
    <div class="meta">Posted on 2002-05-10 10:29:20 by f0dder</div>
   </div>
  </div>
 </body>
</html>