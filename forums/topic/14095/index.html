<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>API to copy snapshot of window into bitmap - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14095" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14095">API to copy snapshot of window into bitmap</a></p>
   <div class="post" id="post-108932">
    <div class="subject"><a href="#post-108932">API to copy snapshot of window into bitmap</a></div>
    <div class="body">I need an API to copy the contents of a selected portion of the screen (the contexts of my webcam window) into a buffer, a bitmap image or anything in which I can access the raw data from the screen.<br /><br />I can find the window handle alright and create a DC and a bitmap object, but what API can I use to snap the window contents ?<br /><br />Thanks for your help,<br />                                B.C.</div>
    <div class="meta">Posted on 2003-07-01 14:39:39 by Binary construct</div>
   </div>
   <div class="post" id="post-108940">
    <div class="subject"><a href="#post-108940">API to copy snapshot of window into bitmap</a></div>
    <div class="body">bitblt or copyrect ? or something =) ?</div>
    <div class="meta">Posted on 2003-07-01 16:35:48 by SFP</div>
   </div>
   <div class="post" id="post-108960">
    <div class="subject"><a href="#post-108960">API to copy snapshot of window into bitmap</a></div>
    <div class="body">Afternoon, Binary construct.<br /><br />Using the boards' search feature for &quot;webcam&quot; came up with this thread:<br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=11496">&lt;here&gt;</a> <br /><br />Download the proggy and have a look at its code. Part of it does *exactly* what you're wanting to do.<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2003-07-01 19:07:02 by Scronty</div>
   </div>
   <div class="post" id="post-109047">
    <div class="subject"><a href="#post-109047">Excellent, but got a missing Vfw.inc file</a></div>
    <div class="body">Thanks Scronty,<br />                         That's just what I was looking for, much better than grabbing it off the screen. However, the code doesn't seem to assembly, its missing a file Vfw.inc<br /><br />I've looked in masm's include directory and there's a Vfw32.inc file, but this causes lots of assembly errors. Other people seem to have got this working ok. Am I using an out of date version of masm (6.14.8444) or is Vfw.inc a non-standard file?<br /><br />Regards,<br />              B.C.</div>
    <div class="meta">Posted on 2003-07-02 13:21:31 by Binary construct</div>
   </div>
   <div class="post" id="post-109079">
    <div class="subject"><a href="#post-109079">API to copy snapshot of window into bitmap</a></div>
    <div class="body">Afternoon,  Binary construct.<br /><br />Attached is the vfw.inc file I use.<br /><br />The vfw32.inc file which comes with the Masm32 package only has the prototypes for Vfw32.lib. It doesn't include the required EQUates and structures.<br /><br />Cheers,<br />Scronty</div>
    <div class="meta">Posted on 2003-07-02 17:02:21 by Scronty</div>
   </div>
   <div class="post" id="post-109347">
    <div class="subject"><a href="#post-109347">Thanks Scronty</a></div>
    <div class="body">Ahh that fixed it, thanks Scronty.<br /><br />So the capture window that is created with the call to 'CapCreateCaptureWindow' takes care of all the low-level comms with the webcam driver ? <br /><br />Where did you learn to use functions in the Vfw.inc file ? Is documentation for this publically available ? <br /><br />The raw bitmap created in the prSaveImage function is just what i'm looking for. I plan on using it to write a motion-detection algorithm, then later move onto facial recognition (although I'll have to use C++ here).<br /><br />Thanks again,<br />                     B.C.</div>
    <div class="meta">Posted on 2003-07-05 15:37:06 by Binary construct</div>
   </div>
  </div>
 </body>
</html>