<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>IAMTVTuner help changing channel ! - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16215" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16215">IAMTVTuner help changing channel !</a></p>
   <div class="post" id="post-125799">
    <div class="subject"><a href="#post-125799">IAMTVTuner help changing channel !</a></div>
    <div class="body">Hi everyone :)  i?m having some dificulty to implement a channel changer in my<br />capTV program , a TV real time recorder to DivX  and audio to mp3 .<br /><br />already working but what i want know is to implement &quot;up&quot; and &quot;down&quot; buttons in my aplication  to change TV channels .<br /><br /><br />i tried this:<br /><br />sectiondata<br />pVCap resb IBaseFilter_size<br />pBuild resb ICaptureGraphBuilder2_size<br />pTuner resb IAMTVTuner_size<br />sectioncode<br /><br />call CoInitialize,NULL<br /><br />call CoCreateInstance, CLSID_ICaptureGraphBuilder2, NULL,\ CLSCTX_INPROC_SERVER ,IID_ICaptureGraphBuilder2,pBuild<br /><br />callcom pBuild,ICaptureGraphBuilder2.FindInterface,PIN_CATEGORY_CAPTURE,\ MEDIATYPE_Interleaved, pVCap,IID_IAMTVTuner,pTuner<br />mov dword ,22 ;....<br />callcom pTuner,IAMTVTuner.put_Channel,,-1,-1<br />callcom pTuner,IAMTVTuner.Release<br />callcom pBuild,ICaptureGraphBuilder2.Release<br />call CoUninitialize<br /><br />but just do a bug :(   uffffffffffffff<br /><br /><br /><br /><br />does any one knows how to implement this ?<br /><br /><br />my capture TV is made like this :<br /><br />call capCreateCaptureWindowA,&quot;capturaTV&quot;,WS_CHILD | WS_VISIBLE, 6, 12,352, 288,, 0<br />mov ,eax<br /><br />so on ....<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />here are the includes i made:<br /><br /><br />CLSID_ICaptureGraphBuilder2:<br />ISTRUC GUID<br />AT GUID.Data1 , dd   0bf87b6e1h<br />AT GUID.Data2 , dw  8c27h<br />AT GUID.Data3 ,dw   11d0h<br />AT GUID.Data4 , db   0b3h, 0f0h, 00h, 0aah, 00h, 37h, 61h, 0c5h<br />IEND<br /><br /><br /><br />IID_ICaptureGraphBuilder2:<br />ISTRUC GUID<br />AT GUID.Data1 , dd   93E5A4E0h<br />AT GUID.Data2 , dw  2D50h<br />AT GUID.Data3 ,dw   11D2h<br />AT GUID.Data4 , db   0ABh,0FAh,00h,0A0h,0C9h,0C6h,0E3h,8Dh<br />IEND<br /><br />STRUC ICaptureGraphBuilder2<br />    ;==This are pointers to IUnknown interface <br />   .QueryInterface    resd 1<br />   .AddRef                resd 1<br />   .Release                resd 1<br />   ;==This are pointers to Methods (functions) ICaptureGraphBuilder2<br />.AllocCapFile resd 1<br />.ControlStream resd 1<br />.CopyCaptureFile resd 1<br />.FindInterface resd 1<br />.FindPin resd 1<br />.GetFiltergraph resd 1<br />.RenderStream resd 1<br />.SetFiltergraph resd 1<br />.SetOutputFileName resd 1<br />ENDSTRUC<br /><br /><br /><br /><br />IID_IAMTVTuner:<br />ISTRUC GUID<br />AT GUID.Data1 , dd   211A8766h<br />AT GUID.Data2 , dw  03ACh<br />AT GUID.Data3 ,dw   11d1h<br />AT GUID.Data4 , db   8Dh,13h, 00h,0AAh,00h,0BDh,83h,39h<br />IEND<br /><br />;=== IAMTVTuner interface<br /><br />STRUC IAMTVTuner <br />    ;==This are pointers to IUnknown interface <br />   .QueryInterface    resd 1<br />   .AddRef                resd 1<br />   .Release                resd 1<br />   ;==This are pointers to Methods (functions) of IAMTuner  <br />    .put_Channel resd 1 <br />    .get_Channel resd 1 <br />    .ChannelMinMax resd 1<br />    .put_CountryCode resd 1<br />    .get_CountryCode resd 1<br />    .put_TuningSpace resd 1<br />    .get_TuningSpace resd 1<br />    .Logon resd 1<br />    .Logout resd 1<br />    .SignalPresent resd 1<br />    .put_Mode resd 1<br />    .get_Mode resd 1<br />    .GetAvailableModes resd 1<br />    .RegisterNotificationCallBack resd 1<br />    .UnRegisterNotificationCallBack resd 1<br />   ;==This are pointers to Methods (functions) IAMTVtuner<br /> .get_AvailableTVFormats resd 1<br /> .get_TVFormat resd 1<br /> .AutoTune resd 1<br /> .StoreAutoTune resd 1<br /> .get_NumInputConnections resd 1 <br /> .put_InputType resd 1<br /> .get_InputType resd 1 <br /> .put_ConnectInput resd 1<br /> .get_ConnectInput resd 1<br /> .get_VideoFrequency resd 1<br /> .get_AudioFrequency resd 1<br />ENDSTRUC<br /><br /><br /><br />IID_IBaseFilter:<br />ISTRUC GUID<br />AT GUID.Data1 , dd   56a86895h<br />AT GUID.Data2 , dw  0ad4h<br />AT GUID.Data3 ,dw   11ceh<br />AT GUID.Data4 , db   0b0h, 3ah, 00h, 20h, 0afh, 0bh, 0a7h, 70h<br />IEND<br /><br />;==== IBaseFilter interface<br /><br />STRUC IBaseFilter<br />;==IUnknown methods<br />.QueryInterface  resd 1<br />.AddRef  resd 1<br />.Release  resd 1<br />;==IMediaFilter methods<br />.Stop  resd 1<br />.Pause resd 1<br />.Run resd 1<br />.GetState resd 1<br />.SetSyncSource resd 1<br />.GetSyncSource resd 1  <br />;==IBaseFilter methods<br />.EnumPins resd 1 <br />.FindPin resd 1<br />.QueryFilterInfo resd 1 <br />.JoinFilterGraph resd 1<br />.QueryVendorInfo resd 1<br />ENDSTRUC<br /><br /><br /><br /><br /><br />MEDIATYPE_Interleaved:<br />ISTRUC GUID<br />AT GUID.Data1 , dd   73766169h<br />AT GUID.Data2 , dw  0000h<br />AT GUID.Data3 ,dw   0010h<br />AT GUID.Data4 , db   80h,00h,00h,0aah,00h,38h,9bh,71h<br />IEND<br /><br />PIN_CATEGORY_CAPTURE:<br />ISTRUC GUID<br />AT GUID.Data1 , dd   0fb6c4281h<br />AT GUID.Data2 , dw  0353h<br />AT GUID.Data3 ,dw   11d1h<br />AT GUID.Data4 , db   90h,5fh,00h,00h,0c0h,0cch,16h,0bah<br />IEND</div>
    <div class="meta">Posted on 2003-11-27 19:21:25 by Nguga</div>
   </div>
   <div class="post" id="post-125848">
    <div class="subject"><a href="#post-125848">tvcap</a></div>
    <div class="body">Hi,<br /><br /> Below link opensource bt8xx chipset tv capture program. <br /><br /> <a target="_blank" href="http://btwincap.sourceforge.net/download.html">http://btwincap.sourceforge.net/download.html</a><br /><br /> Maybe help you,<br /><br /> Regards,</div>
    <div class="meta">Posted on 2003-11-28 13:14:27 by CYDONIA</div>
   </div>
   <div class="post" id="post-125955">
    <div class="subject"><a href="#post-125955">:)</a></div>
    <div class="body">Thanks ! <br /><br />i will see :) <br /><br /><br />but if some one has some experience on IAMTVTuner can help on this please<br /><br />:) example can be MASM or any other win32asm :)</div>
    <div class="meta">Posted on 2003-11-29 20:14:24 by Nguga</div>
   </div>
  </div>
 </body>
</html>