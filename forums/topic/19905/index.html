<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>ok dealing with VARIANTS and METHODS - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19905" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=19905">ok dealing with VARIANTS and METHODS</a></p>
   <div class="post" id="post-152803">
    <div class="subject"><a href="#post-152803">ok dealing with VARIANTS and METHODS</a></div>
    <div class="body">Hello, i'm some kind of new in com, i understand very well the model and have done some code using com interfaces, but i have some questions about it, that i would like to resolve:<br /><strong>1) Have i to call every time i discard an interface at the method Release?</strong><br />for example if i have an inteface of one object and i call to the QueryInterface and get other interface of the same object, should i call twice to the method Release over each interface? i think yes, but i see some code that didnt do it and i get confuse...<br /><br /><strong>2)</strong>This is more important, i read the especification of the interfaces of one library that was include in the resource section of the library, and there was some methods that have as parameter a variant, like this:<br />function item(out name: Variant; out index: Variant): IDispatch; stdcall;<br />i know that the variants are not passed by reference because when this happens the method is descripted like this:<br />function addBehavior(bstrUrl: BSTR; out pvarFactory: ^Variant): I4; stdcall;<br />and the parameter is descripted like &quot;^Variant&quot; representhing a pointer or a reference to the variant.<br /><strong>when the parameter is not descripted as a pointer, like in the first case, should i put all the structure of the variant in the stack??</strong>if someone can answer this it would be very helpfull, because is my main trouble with variants<br />3)Another unsolved problem, when i call an method and this return me a pointer to a variant, <strong>shoud i release the merory of the variant??</strong> or  this will be release by the object who has reserved previously???<br /><br />that is all for now with com and variants, and if U help me i promise U i will draw more problems to this board....<br /><br /><br />_______________________Mauricio Prado<br />sorry if my english is not too readable....</div>
    <div class="meta">Posted on 2004-11-12 20:13:46 by mauricioprado</div>
   </div>
   <div class="post" id="post-152819">
    <div class="subject"><a href="#post-152819">ok dealing with VARIANTS and METHODS</a></div>
    <div class="body">to 1.: yes<br />to 2.: yes, push 16 bytes for a variant parameter<br />to 3.: you should free the variant by calling VariantClear</div>
    <div class="meta">Posted on 2004-11-13 03:18:55 by japheth</div>
   </div>
  </div>
 </body>
</html>