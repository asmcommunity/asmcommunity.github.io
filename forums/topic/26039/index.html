<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>List of Serial Ports - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=26039" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=26039">List of Serial Ports</a></p>
   <div class="post" id="post-189733">
    <div class="subject"><a href="#post-189733">List of Serial Ports</a></div>
    <div class="body">Hi, how can I get the list of Serial comm ports of my pc?<br /><br />Thx.</div>
    <div class="meta">Posted on 2007-07-03 08:29:27 by _OuzO_</div>
   </div>
   <div class="post" id="post-189735">
    <div class="subject"><a href="#post-189735">Re: List of Serial Ports</a></div>
    <div class="body">QueryDosDevice - then walk through the com ones, even then though they might be virtual ports...<br /><br />if you&#39;re 2k or higher -&gt; look at this <a target="_blank" href="http://www.codeproject.com/system/setupdi.asp">http://www.codeproject.com/system/setupdi.asp</a><br /></div>
    <div class="meta">Posted on 2007-07-03 09:37:18 by evlncrn8</div>
   </div>
   <div class="post" id="post-189745">
    <div class="subject"><a href="#post-189745">Re: List of Serial Ports</a></div>
    <div class="body">Thanks alot, even if it&#39;s not exactly what I expected.<br /><br />I tried the code snippet you suggested which at first calls GetLogicalDriveStrings<br /><br />and then loops calling QueryDosDevice with the various logical drives of the PC (i.e. A:, C:, and so on).<br />It works, but it does not retrieve the list of serial comm ports.&nbsp; :sad:<br /><br />I tried with<br />INVOKE QueryDosDevice, null, szName, BUFSIZE&nbsp; ;&nbsp;  null as 1st param<br /><br />but the function fails and GetlastError returns 7Ah (which is array not sufficient, too short).<br /><br />Should I initialize in some way the destination array?<br />Any hint/code snippet is welcome. <br /><br />Cheers<br />_OuzO_<br /></div>
    <div class="meta">Posted on 2007-07-04 10:26:54 by _OuzO_</div>
   </div>
   <div class="post" id="post-189750">
    <div class="subject"><a href="#post-189750">Re: List of Serial Ports</a></div>
    <div class="body"><div class="quote"><br />I tried with<br />INVOKE QueryDosDevice, null, szName, BUFSIZE&nbsp; ;&nbsp;  null as 1st param<br /><br />but the function fails and GetlastError returns 7Ah (which is array not sufficient, too short).<br /><br />Should I initialize in some way the destination array?<br /></div><br /><br />make a bigger buffer then, keep calling until you get success or you get bored...<br />65kb or so should be sufficient...<br /><br />initialise the destination array.. sure, but i think the os does that anyway upon success<br /><br /><div class="quote"><br />Any hint/code snippet is welcome. <br /></div><br /><br />nope, clearly you didnt bother researching that api at all, go hit msdn...<br />read up on it, then you&#39;ll understand how to use it properly...<br /><br />it does report com ports for sure...<br /><br />example from my pc -&gt; COM1<br />\Device\Serial0<br /><br /><br /></div>
    <div class="meta">Posted on 2007-07-04 17:03:03 by evlncrn8</div>
   </div>
  </div>
 </body>
</html>