<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Get Window Handle - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8320" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=8320">Get Window Handle</a></p>
   <div class="post" id="post-60752">
    <div class="subject"><a href="#post-60752">Get Window Handle</a></div>
    <div class="body">Again a question...<br /><br />How do i get the handle of the main window <br />of the process that just called one of my own DLL function?<br /><br />without requiring it to be a parameter on my own DLL function.</div>
    <div class="meta">Posted on 2002-10-06 17:47:11 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-60755">
    <div class="subject"><a href="#post-60755">Get Window Handle</a></div>
    <div class="body">GetActiveWindow does what you want I think.</div>
    <div class="meta">Posted on 2002-10-06 18:18:45 by _js_</div>
   </div>
   <div class="post" id="post-60775">
    <div class="subject"><a href="#post-60775">Re: Get Window Handle</a></div>
    <div class="body"><div class="quote"><br />Again a question...<br /><br />How do i get the handle of the main window <br />of the process that just called one of my own DLL function?<br /><br />without requiring it to be a parameter on my own DLL function. </div><br /><br />Look into <a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=7962&amp;highlight=classname">this</a> thread.<br />You might need to pass the process ID of the calling process to the DLL and do EnumWindows with GetWindowThreadProcessId in EnumWindowsProc. Just compare the PIDs until you find the correct one and return the HWND.</div>
    <div class="meta">Posted on 2002-10-07 01:02:51 by bazik</div>
   </div>
   <div class="post" id="post-61464">
    <div class="subject"><a href="#post-61464">Get Window Handle</a></div>
    <div class="body">For whom might intrest:<br /><br />GetForegroundWindow() worked ... even if i first thought it will not :(<br /><br />Thanks bazik ... i was going to do what you suggested  but because it was more complicated i give the above function one last chance and it worked... however GetActiveWindow is not working. Good to know.</div>
    <div class="meta">Posted on 2002-10-12 14:51:37 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-61468">
    <div class="subject"><a href="#post-61468">Get Window Handle</a></div>
    <div class="body">Erm... and what happens, pray tell, if the window that called your DLL happens to not be in the foreground?  ;)<br /><br />I think Bazik's solution is the safest bet.</div>
    <div class="meta">Posted on 2002-10-12 15:29:12 by iblis</div>
   </div>
  </div>
 </body>
</html>