<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>System-wide DLL API hooking - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=19657" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=19657">System-wide DLL API hooking</a></p>
   <div class="post" id="post-151253">
    <div class="subject"><a href="#post-151253">System-wide DLL API hooking</a></div>
    <div class="body">A big hello to everyone on the board, this is my first posting.<br /><br />I'm experimenting with API hooking and have tried patching a DLL in a specific process in order to subvert a specific API. Because DLLs are up in shared memory, I assumed that any changes made would be reflected in other (subsequently loaded) processes which use the DLL in question.<br /><br />However, when I patch the DLL (either export address or actual code) the modifications appear to be confined to the process that I run my patch program in.<br /><br />Is it really going to be necessary for me to enumerate all processes in order to apply my patch ? Surely there must be a more elegant way in which I could exploit the dynamic linking mechanism / shared DLL memory ?<br /><br />Regards,<br />            code minstrel</div>
    <div class="meta">Posted on 2004-10-13 16:43:24 by code minstrel</div>
   </div>
   <div class="post" id="post-151377">
    <div class="subject"><a href="#post-151377">Vxdcall to open up inter-process shared memory ?</a></div>
    <div class="body">I have found an interesting program by OCY that is able to hook a DLL (winsock) in every process, without specifically patching the copy in each process (see attachment). While this appears to answer my question, I don't quite understand how it works.<br /><br />I believe it opens up inter-process shared memory by calling a ring0 VXD service ? There appears to be an API (or some invokation mechanism) called VxdCall4. However, I don't quite understand how this works or how one obtains the address of vxdcall.<br /><br />Any ideas ?<br /><br />Regards,<br />            Code minstrel</div>
    <div class="meta">Posted on 2004-10-17 13:36:32 by code minstrel</div>
   </div>
  </div>
 </body>
</html>