<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>About /OPT:REF - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10642" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10642">About /OPT:REF</a></p>
   <div class="post" id="post-80074">
    <div class="subject"><a href="#post-80074">About /OPT:REF</a></div>
    <div class="body">When I try to link an .obj file,I get the warning message:<br /><br />LINK : warning LNK4089: all references to &quot;user32.dll&quot; discarded by /OPT:REF<br /><br />Why I get this message? (I don't use  the /OPT switch)<br />If I don't use the user32.lib,the linker reports an unresolved external which refers to user32.dll<br />I think the only solution is to add the /IGNORE:4089 parameter.<br />Regards,<br /><br />Vortex</div>
    <div class="meta">Posted on 2003-02-05 13:03:36 by Vortex</div>
   </div>
   <div class="post" id="post-80124">
    <div class="subject"><a href="#post-80124">About /OPT:REF</a></div>
    <div class="body">You get this message if you include a lib but don't<br />call any functions in it. Did you remember to delete<br />reference to user32.inc AND user32.lib ?</div>
    <div class="meta">Posted on 2003-02-05 18:57:54 by anon</div>
   </div>
   <div class="post" id="post-80190">
    <div class="subject"><a href="#post-80190">About /OPT:REF</a></div>
    <div class="body">anon,thanks for your interest,I wrote:<br /><br />&gt;If I don't use the user32.lib,the linker reports an unresolved external which refers to user32.dll<br /><br />My program is using the masm32.lib.This library is calling a function from user32.dll,so I have to<br />use the user32.lib. The solution is very easy:Ignoring the warning by /IGNORE:4089<br /><br />Regards,<br /><br />Vortex</div>
    <div class="meta">Posted on 2003-02-06 08:23:16 by Vortex</div>
   </div>
  </div>
 </body>
</html>