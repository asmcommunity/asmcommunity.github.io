<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>RadAsm and TabStrips - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25492" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25492">RadAsm and TabStrips</a></p>
   <div class="post" id="post-186279">
    <div class="subject"><a href="#post-186279">RadAsm and TabStrips</a></div>
    <div class="body">Hi there,<br /><br />I&#39;m currently developping a project with graphical interface (with RadAsm), and I wanted to use some TabStrip control.<br />But I just can&#39;t understand how exactly it works, I didn&#39;t find anything on the web (just a topic but it was for EasyCode, and I don&#39;t want to change my IDE at this point of development).<br /><br />Could someone help me to deal with this TabStrips/Group controls?<br /><br />I&#39;d be very very grateful..<br /><br />ps:excuse my english, it&#39;s not my language (french)..</div>
    <div class="meta">Posted on 2006-10-31 08:08:27 by marc_</div>
   </div>
   <div class="post" id="post-186280">
    <div class="subject"><a href="#post-186280">Re: RadAsm and TabStrips</a></div>
    <div class="body">In RadAsm&#39;s Dialog Editor you can drop a &quot;Tab Strip&quot; Control just as easy as you would do an EditControl. <br /><br />You have to add the Tabs yourself though using the TCM_INSERTITEM message. In Win32.hlp the TabStrip is referred to as &quot; Tab Control &quot;. Maybe that&#39;s the confusion.<br /><br />Usually you create the Tabs, then upon the TCN_SELCHANGE (WM_NOTIFY) message you create or destroy dialogs which you superimpose into the Tab Control.<br /><br />Tell me if that&#39;s enough or if you need more detail :)<br /><br />Happy Halloween,<br />Jimmy</div>
    <div class="meta">Posted on 2006-10-31 08:33:52 by JimmyClif</div>
   </div>
   <div class="post" id="post-186288">
    <div class="subject"><a href="#post-186288">Re: RadAsm and TabStrips</a></div>
    <div class="body">hello JimmyClif,<br /><br />firstof all, thank you for replying this quick, I&#39;m really desperate because of these controls&nbsp; :P<br /><br />I understood what you wrote, but there&#39;s still a thing I don&#39;t understand:<br /> when I drop a TabStrip on my Dlg, there&#39;s only one tab on it, and I didn&#39;t found where I am supposed to add another one.<br />Maybe it&#39;s in a .rc file but couldn&#39;t find which one.<br />You talk about &quot;TCM_INSERTITEM message&quot; which add a tab, you mean when I have to send a TCM_INSERTITEM message just before the Dlg is initialized?<br /><br />And for the second point, the TCN_SELCHANGE message which change the current dialog, how does it works exactly?<br />Setting focus on a particular part of the Dlg ? or really destroying the current Dlg for putting a new one?<br />And where do I have to create the other Dlg?<br /><br />Sorry for all these newbie question but I really don&#39;t find any tuts on this and I&#39;d like to finalize my work ^^<br /><br />Thanks you<br /><br /></div>
    <div class="meta">Posted on 2006-10-31 10:28:44 by marc_</div>
   </div>
   <div class="post" id="post-186289">
    <div class="subject"><a href="#post-186289">Re: RadAsm and TabStrips</a></div>
    <div class="body">I was pondering on what would be faster - me writing a quick example or me trying to explain. I went for the first option. Attached is a working example. It is a little confusing but examine it carefully and it will all make sense.<br /><br /><br />If there are any further questions don&#39;t hesitate asking... I&#39;ll do my best explaining what I did.</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=2146" target="_blank">sss061031.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-10-31 11:46:26 by JimmyClif</div>
   </div>
   <div class="post" id="post-186331">
    <div class="subject"><a href="#post-186331">Re: RadAsm and TabStrips</a></div>
    <div class="body">hello JimmyClif,<br /><br />sorry to not answered earlier (I think ure laughing on my bad english ^^ don&#39;t hesitate to tell me what&#39;s wrong lol)<br /><br />Ok, so I tried your .exe, it works perfectly on my computer.<br /><br />BUT (there&#39;s always a &quot;but&quot;) I didn&#39;t understood everything..<br /><br />I&#39;ve read several times your .asm, .inc etc... and for YOUR .exe I understand what&#39;s going on: a SendDlgItem on the tabstrip when the DialogBox is initializing, and 3 differents tabs which you can activate by a simple click which send a SendDlgItem.<br /><br />But I tried to make the same thing for my project, and it don&#39;t works. It compiles without error, I made the right includes etc.<br />But when I run my .exe, I see the same DlgBox than without the strips.. nothing change, but a strange rect around my DlgBox.<br /><br />I think this is maybe a problem with the ID of the controls (the number like 1001, 2000, etc.), or maybe a problem with my compiler (I use the Masm32.ini and didn&#39;t change anything in it.. should I make some change in it?).<br /><br />Sorry to not understand, I appreciate you made a project for me, but after 2 days studying it I still don&#39;t understand everything.)<br /><br />Could you explain me <strong>the order</strong> of the things to add to an existing exe (with just one DlgBox) for having 3 tabstrips?<br /><br />Or anything that can help me lol <br /><br />Thank u and have a good day<br /></div>
    <div class="meta">Posted on 2006-11-03 10:25:19 by marc_</div>
   </div>
   <div class="post" id="post-186334">
    <div class="subject"><a href="#post-186334">Re: RadAsm and TabStrips</a></div>
    <div class="body"><u>How to use TabStrips</u><br /><br />First drop a TabStrip in your Dialog using RadAsm&#39;s DialogEditor.<br /><img src="http://img512.imageshack.us/img512/9470/dialoget2.th.gif" /><br /><br />Now you need to add Tabs to the control. This is done inside the WM_INITDIALOG handler of your main program. To add Tabs you need to populate the TC_ITEM structure with information about each Tab.<br /><br /><pre><code><br />mov tci.imask, TCIF_TEXT	<br />mov tci.pszText, ctxt(&quot;First Tab&quot;)<br />mov tci.cchTextMax,256<br />mov tci.lpReserved1, 0<br />mov tci.lpReserved2, 0<br />mov tci.iImage,0<br />mov tci.lParam,0<br /></code></pre><br /><br />Then we add the Tab using the TCM_INSERTITEM message:<br /><br /><pre><code><br />invoke SendDlgItemMessage,hWnd,1001,TCM_INSERTITEM,0,addr tci<br /></code></pre><br /><br />The second parameter (1001) is the ID of the TabStrip and the second last parameter of the SendDlgItemMessage call is the Tab Number. The First Tab is 0, the second will be 1 and the third will be 2.<br /><br />Now, I add two more tabs to the control. Our TC_ITEM structure is already filled with most of the information it needs - we only need to change the psztext parameter so that our next Tabs have different names.<br /><pre><code><br />mov tci.pszText, ctxt(&quot;Second Tab&quot;)<br />invoke SendDlgItemMessage,hWnd,1001,TCM_INSERTITEM,1,addr tci<br /><br />mov tci.pszText, ctxt(&quot;Third Tab&quot;)<br />invoke SendDlgItemMessage,hWnd,1001,TCM_INSERTITEM,2,addr tci<br /></code></pre><br /><br />// You could already compile now and have a look, the Tabs are there but when you click on them - nothing happens.<br /><br />So, let&#39;s have a look about how to receive notification if the User clicks on a Tab. This notification is send as a TCN_SELCHANGE message through the WM_NOTIFY handler. <br /><pre><code><br />.elseif eax==WM_NOTIFY<br />	mov eax, lParam<br />	.IF .NMHDR.code == TCN_SELCHANGE<br />		; User clicked a Tab. But which one?<br />	.ENDIF<br /></code></pre><br />To find out which Tab the User clicked we query the Tab Control itself and ask for the current tab ID.<br /><pre><code><br />invoke SendDlgItemMessage,hWnd,1001,TCM_GETCURSEL,0,0<br /></code></pre><br />Eax returns the Tab number.<br /><br />Now, the plan is as follows: When the User clicks on a Tab we have to show him some content. This content will be in a separate dialog which I created and named &quot;a.dlg&quot;. Now this dialog has very few features. It&#39;s style is Child &amp; Visible. Nothing else. On this dialog I dropped a Static Text saying &quot;Tab Number 0&quot; just for you to have something to see when it&#39;s there. As ID for this child dialog I chose 2000. (Important)<br /><img src="http://img527.imageshack.us/img527/4102/azr8.gif" /><br /><br />As we have three tabs, I created another two dialogs named b.dlg &amp; c.dlg. Having the same features as a.dlg and having as ID 2001 and 2002.<br /><br /><u>Now, it&#39;s about time to tie this whole thing together:</u><br /><br /><pre><code><br />.elseif eax==WM_NOTIFY<br />mov eax, lParam<br />.IF .NMHDR.code == TCN_SELCHANGE<br />	.IF hTab != 0<br />		invoke DestroyWindow,hTab<br />	.ENDIF<br />	invoke SendDlgItemMessage,hWnd,1001,TCM_GETCURSEL,0,0<br />	add eax, 2000<br />	invoke CreateDialogParam,hInstance,eax,hTabStrip,offset DialogProc,0<br />	invoke GetClientRect,hTabStrip,addr rect<br />	sub rect.bottom,25<br />	invoke MoveWindow,hTab,0,25,rect.right,rect.bottom,TRUE<br />.ENDIF<br /></code></pre><br /><br />First we see if there is a Dialog active using the:<br /><pre><code><br />.IF hTab != 0<br />	invoke DestroyWindow,hTab<br />.ENDIF<br /></code></pre><br />..and if there is - we destroy it. <br /><br />Then we ask which Tab it is. For the First Tab it will be 0, the second it will be 1 and the third it will be 2. Our Dialogs which we want to display have as ID&#39;s 2000, 2001 and 2002. Now after querying the Tab Control it returns either 0, 1 or 2 - then I add 2000 to that result which gives me the ID of the Dialog I want to display, which I immediately create using:<br /><pre><code><br />	invoke CreateDialogParam,hInstance,eax,hTabStrip,offset DialogProc,0<br /></code></pre><br />After creating the Dialog I quickly adjust it&#39;s size so that the Dialog doesn&#39;t overlap the Tab Buttons. This is done here:<br /><pre><code><br />invoke GetClientRect,hTabStrip,addr rect<br />sub rect.bottom,25<br />invoke MoveWindow,hTab,0,25,rect.right,rect.bottom,TRUE<br /></code></pre><br /><br />All input of the Dialog itself will be sent to the DialogProcedure here:<br /><pre><code><br />DialogProc proc hWin:HWND,uMsg:UINT,wParam:WPARAM,lParam:LPARAM<br />LOCAL rect:RECT<br /><br />	mov		eax,uMsg<br />	.if eax==WM_INITDIALOG<br />		push hWin<br />		pop hTab<br />	.elseif eax==WM_CLOSE<br />		invoke EndDialog,hWin,NULL<br />	.else<br />		mov		eax,FALSE<br />		ret<br />	.endif<br />	mov		eax,TRUE<br />	ret<br /><br />DialogProc endp<br /></code></pre><br /><br />Only thing left, if you compile and check it out after this point is that upon App start there is no dialog selected. Reason to add this code:<br /><pre><code><br />invoke CreateDialogParam,hInstance,2000,hTabStrip,offset DialogProc,0 ; first dialog for first tab<br />invoke GetClientRect,hTabStrip,addr rect<br />sub rect.bottom,25<br />invoke MoveWindow,hTab,0,25,rect.right,rect.bottom,TRUE<br /></code></pre><br />in the WM_INITDIALOG handler of the main application.<br /><br />As one last addition I set thsi code into the WM_SIZE handler to resize the TabStrip to the width and height of the main window. (This code could have been better as the width and height of the main window are passed in either lparam or wparam but I was lazy)<br /><pre><code><br />.elseif eax==WM_SIZE<br />	invoke GetClientRect,hWnd,addr rect<br />	invoke GetDlgItem,hWnd,1001 ; 1001 being the TabStrip<br />	invoke MoveWindow,eax,0,0,rect.right,rect.bottom,TRUE<br /></code></pre><br /><br /><hr /><br /><br />Only confusing thing which is left up to you is how to differentiate between tabs inside your Dialog Handler. You could create a separate DialogProcedure for each Tab using an array of DialogProc offsets like this:<br /><pre><code><br />.data<br />OffsetsHere dd offset Dialogproc, offset Dialogproc1, offset Dialogproc2<br /><br />; inside WM_NOTIFY<br />	invoke SendDlgItemMessage,hWnd,1001,TCM_GETCURSEL,0,0<br />	mov edx, dword ptr <br />	add eax, 2000<br />	invoke CreateDialogParam,hInstance,eax,hTabStrip,edx,0 ; first dialog for first tab<br /></code></pre><br />and have three different Dialogprocedures named Dialogproc, Dialogproc1 and Dialogproc2.<br /><br />Hope this helps somewhat out.</div>
    <div class="meta">Posted on 2006-11-03 11:43:11 by JimmyClif</div>
   </div>
   <div class="post" id="post-186340">
    <div class="subject"><a href="#post-186340">Re: RadAsm and TabStrips</a></div>
    <div class="body">Kudos&nbsp; 8)</div>
    <div class="meta">Posted on 2006-11-03 23:30:42 by Homer</div>
   </div>
   <div class="post" id="post-186388">
    <div class="subject"><a href="#post-186388">Re: RadAsm and TabStrips</a></div>
    <div class="body">Hello JimmyCliff,<br /><br />I&#39;m sorry but... even with your explanations..<strong> IT STILL DOESN&#39;T WORK!!</strong><br /><br />I really don&#39;t understand, I&#39;ve done all the things you wrote, but when I click on a tab it just happen nothing.<br /><br />I wonder if it could be a &quot;project type&quot; problem, you know when you create a project, you can choose &quot;<em>DlgApp</em>, <em>DlgAsMain</em>, <em>TabApp</em>&quot;.. I&#39;ve choosen <em>DlgApp</em> and it doesn&#39;t work. Maybe I have to chose <em>TabApp</em> ?<br />Though it should work anyway..<br /><br />I have another problem too, in my project I created 3 Dlg as you told me, I put some StaticCtrl on it, when I run my .exe it doesn&#39;t work but when I close my project and re-open it, my 3 tabs have disappeared !!! They&#39;re still in the ProjectFiles but they are very very very little and static controls disappeared! And so for the ID of the 3 dlg, their caption, etc..<br /><br />I&#39;m sorry to insist once more but I really think that God doesn&#39;t wanna me to finish my project..</div>
    <div class="meta">Posted on 2006-11-06 07:06:00 by marc_</div>
   </div>
   <div class="post" id="post-186389">
    <div class="subject"><a href="#post-186389">Re: RadAsm and TabStrips</a></div>
    <div class="body">Marc,<br /><br />I wish I could help you but at this point I can&#39;t. I chose as template the &quot;Dialog As Main&quot; which you can easily see in the zipfile&#39;s code I attached. I&#39;m afraid you have to try to copy my code 1-1 using the <em>tutorial and the code provided</em> until it works for you.<br /><br />I also don&#39;t know why your dialog is disappearing. Create a new thread describing your problem so that one of us can reproduce it.<br /><br /></div>
    <div class="meta">Posted on 2006-11-06 07:36:05 by JimmyClif</div>
   </div>
  </div>
 </body>
</html>