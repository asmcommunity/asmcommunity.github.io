<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Problems with IPicture and FindFirstFile - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=15011" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=15011">Problems with IPicture and FindFirstFile</a></p>
   <div class="post" id="post-116505">
    <div class="subject"><a href="#post-116505">Problems with IPicture and FindFirstFile</a></div>
    <div class="body">Hi<br />I was just reusing some of my region calculator code to make a simple slideshow app, when I noticed a bizarre bug. When I search the current folder for files (FindFirstFile/FindNextFile/FindClose) and try to load the images with the IPicture interface, OleLoadPictureFromPath sistematically fails. However if I launch a GetOpenFileName box and let the user pick a file, it works. :confused:<br />Is there any bug related to FindFirst and IPicture? Is it just my fault? Has anyone had a similar problem before?</div>
    <div class="meta">Posted on 2003-09-01 14:47:32 by QvasiModo</div>
   </div>
   <div class="post" id="post-116519">
    <div class="subject"><a href="#post-116519">Problems with IPicture and FindFirstFile</a></div>
    <div class="body">What is the error code from OleLoadPicturePath?</div>
    <div class="meta">Posted on 2003-09-01 17:35:40 by Morris</div>
   </div>
   <div class="post" id="post-116525">
    <div class="subject"><a href="#post-116525">Problems with IPicture and FindFirstFile</a></div>
    <div class="body">FindFirst and etc only return the filename in the structre, You need to combine that to the directory path to get the full path of the file.</div>
    <div class="meta">Posted on 2003-09-01 18:43:12 by EÃ³in</div>
   </div>
   <div class="post" id="post-116922">
    <div class="subject"><a href="#post-116922">Problems with IPicture and FindFirstFile</a></div>
    <div class="body">Thanks for your replies :)<br /><br />The error code is 0x80004007 (Get shared memory allocator failure).<br /><br />I have yet to try getting the full pathname to load the picture (that probably was the problem, I think OleLoadPctureFromPath requires a full pathname).</div>
    <div class="meta">Posted on 2003-09-04 12:45:14 by QvasiModo</div>
   </div>
  </div>
 </body>
</html>