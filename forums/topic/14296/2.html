<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Force only one instance - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14296" />
  <link rel="prev" href="../?id=14296&amp;page=1" />   </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14296">Force only one instance</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=14296&amp;page=1" style="">&laquo;</a><a href="../?id=14296&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="14296" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>   <div class="post" id="post-110812">
    <div class="subject"><a href="#post-110812">Force only one instance</a></div>
    <div class="body">Well, uh um.. I'll go away now and fall on my own sword!</div>
    <div class="meta">Posted on 2003-07-16 17:33:00 by Poimander</div>
   </div>
   <div class="post" id="post-110816">
    <div class="subject"><a href="#post-110816">Force only one instance</a></div>
    <div class="body"><strong>Poimander</strong>, stay here so we can poke you with toothpicks. :grin:</div>
    <div class="meta">Posted on 2003-07-16 17:46:31 by bitRAKE</div>
   </div>
   <div class="post" id="post-110835">
    <div class="subject"><a href="#post-110835">Force only one instance</a></div>
    <div class="body">One of the things about the Mutex method is you can place the Mutex in either the Global or Local namespace so you can force only one instance of the application on a Terminal Services machine (or Fast User switching in XP).  <br /><br />How does the shared section work with Terminal Services?</div>
    <div class="meta">Posted on 2003-07-16 20:53:06 by Mecurius</div>
   </div>
   <div class="post" id="post-110844">
    <div class="subject"><a href="#post-110844">Force only one instance</a></div>
    <div class="body"><div class="quote"><br />How does the shared section work with Terminal Services?</div>Memory in Shared Code Sections Is Not Shared Across Terminal Server Sessions (Q251045)</div>
    <div class="meta">Posted on 2003-07-16 22:04:28 by bitRAKE</div>
   </div>
   <div class="post" id="post-111122">
    <div class="subject"><a href="#post-111122">Force only one instance</a></div>
    <div class="body">Are there any provisos against employing the <strong>GlobalAddAtom</strong> and <strong>GlobalFindAtom</strong> apis (provided they are necessarily <em><strong>atomic</strong></em> operations) instead of the <strong>CreateMutex</strong> api?</div>
    <div class="meta">Posted on 2003-07-18 21:59:14 by Poimander</div>
   </div>
   <div class="post" id="post-111378">
    <div class="subject"><a href="#post-111378">Force only one instance</a></div>
    <div class="body">i use a macro to keep from opening multiple instances of my programs, works quit nice</div>
    <div class="meta">Posted on 2003-07-21 08:40:13 by sTonER_DeVIOUS</div>
   </div>
   <div class="post" id="post-111397">
    <div class="subject"><a href="#post-111397">Force only one instance</a></div>
    <div class="body">is it <strong>hutch's</strong> macro? :)<br /><br /><pre><code><br />  SingleInstanceOnly MACRO lpClassName<br />        invoke FindWindow,lpClassName,NULL<br />        cmp eax, 0<br />        je @F<br />          push eax<br />          invoke ShowWindow,eax,SW_RESTORE<br />          pop eax<br />          invoke SetForegroundWindow,eax<br />          mov eax, 0<br />          ret<br />        @@&#58;<br />      ENDM<br /></code></pre><br /><br />Which is the findow solution.</div>
    <div class="meta">Posted on 2003-07-21 12:32:34 by RobotBob</div>
   </div>
   <div class="post" id="post-111491">
    <div class="subject"><a href="#post-111491">Force only one instance</a></div>
    <div class="body">hmm yeah that looks familiar.. been a long time though</div>
    <div class="meta">Posted on 2003-07-22 07:16:38 by sTonER_DeVIOUS</div>
   </div>
   <div class="post" id="post-112825">
    <div class="subject"><a href="#post-112825">Force only one instance</a></div>
    <div class="body">Remember that these macros works only of I have a Window.<br />But if my app is a console only application?<br />I think the best way is synchronization (Mutex, Semaphores, ...)</div>
    <div class="meta">Posted on 2003-08-03 03:39:07 by greenant</div>
   </div>
   <div class="post" id="post-112826">
    <div class="subject"><a href="#post-112826">Force only one instance</a></div>
    <div class="body">Hi Greenant,<br /><br />I stick by the Mutex, it has never failed me and never failed to be released after a program crash. It works and doesn't require special linking or a window.</div>
    <div class="meta">Posted on 2003-08-03 03:58:35 by donkey</div>
   </div>
   <div class="post" id="post-112858">
    <div class="subject"><a href="#post-112858">Force only one instance</a></div>
    <div class="body">NAMED PIPE!<br />crate a named pipe in the first app a name unique like \pipe\97836490823-MYapp<br />a nother instanstance is opend, createfile to that pipe if it succeeds in obtaining a handle, the app is already open!</div>
    <div class="meta">Posted on 2003-08-03 15:41:42 by Qages</div>
   </div>
   <div class="post" id="post-112860">
    <div class="subject"><a href="#post-112860">Force only one instance</a></div>
    <div class="body"><div class="quote"><br />NAMED PIPE!<br />crate a named pipe in the first app a name unique like \pipe836490823-MYapp<br />a nother instanstance is opend, createfile to that pipe if it succeeds in obtaining a handle, the app is already open! </div><br />Original, but I don't see what advantages it has over the mutex approach. MS uses the mutex approach and documents it as the method for limiting an application to a single instance:<br /><div class="quote">Your WinMain function can also limit your application to a single instance. Create a named mutex using the CreateMutex function. If GetLastError returns ERROR_ALREADY_EXISTS, another instance of your application exists (it created the mutex) and you should exit WinMain.</div><br /><a target="_blank" href="http://www.msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/windows/aboutwindows.asp">http://www.msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/windowing/windows/aboutwindows.asp</a></div>
    <div class="meta">Posted on 2003-08-03 15:53:25 by donkey</div>
   </div>
   <div class="post" id="post-112863">
    <div class="subject"><a href="#post-112863">Force only one instance</a></div>
    <div class="body"><div class="quote">M<strong>$</strong> uses the mutex approach and documents it as the method for limiting an application to a single instance:</div> <br /> best reason why you shoudlnt use mutex. M<strong>$</strong>  probly knows who you are and where you live and what sites you like to visit, They are not to be trusted. but really there isnt much advantage in all these diffrent ways to 'Force one instance', only one is you have a choice! not what M<strong>$</strong> tells you to do.</div>
    <div class="meta">Posted on 2003-08-03 16:58:10 by Qages</div>
   </div>
   <div class="post" id="post-112866">
    <div class="subject"><a href="#post-112866">Force only one instance</a></div>
    <div class="body"><div class="quote"><br /> <br /> best reason why you shoudlnt use mutex. M<strong>$</strong>  probly knows who you are and where you live and what sites you like to visit, They are not to be trusted. but really there isnt much advantage in all these diffrent ways to 'Force one instance', only one is you have a choice! not what M<strong>$</strong> tells you to do. </div><br />Oh, sorry I didn't realize Mutexes were a politcial, socio-economic trojan horse designed to undermine my freedom of choice, I'll look more carefully next time I use CreateWindowEx as well :rolleyes:</div>
    <div class="meta">Posted on 2003-08-03 17:11:05 by donkey</div>
   </div>
   <div class="post" id="post-112872">
    <div class="subject"><a href="#post-112872">Force only one instance</a></div>
    <div class="body"><div class="quote"><br />NAMED PIPE!<br />crate a named pipe in the first app a name unique like \pipe836490823-MYapp<br />a nother instanstance is opend, createfile to that pipe if it succeeds in obtaining a handle, the app is already open! </div><br /><br />I have had problems with named pipes staying open after an application has crashed, so I would highly recommend NOT using named pipes for forcing only one instance.  Also, I do not think it is documented on whether CreateNamedPipe can cause a race condition if it is called from two applications at the same time.  CreateMutex does not have this problem.</div>
    <div class="meta">Posted on 2003-08-03 17:30:32 by Mecurius</div>
   </div>
   <div class="post" id="post-112982">
    <div class="subject"><a href="#post-112982">Force only one instance</a></div>
    <div class="body">Ok, I like this.<br /><br /><a target="_blank" href="http://www.flounder.com/nomultiples.htm">http://www.flounder.com/nomultiples.htm</a><br /><br />Has anyone done a port to MASM32 of his recommended Solution?<br /><br />Regards,  P1 :cool:</div>
    <div class="meta">Posted on 2003-08-04 11:18:56 by Pone</div>
   </div>
   <div class="post" id="post-113523">
    <div class="subject"><a href="#post-113523">Force only one instance</a></div>
    <div class="body">I have always used CreateEventA with a named EVENT_OBEJCT and then I call GetLastError and check if error is ERROR_ALREADY_EXIST ( 000000B7h ).<br /><br />By the way, I have recently seen this approach in comercial soft too ( it should be very similar to using ATOMs, MUTEXes, SEMAPHOREs... and this EVENT stuff is the same ).<br /><br /><br />MyEventObjectName   db 'PROGRAM_NAME_vX.X',0   ; just an example...<br /><br /><br />...<br /><br /><br />push MyEventObjectName ; MASM/TASM users use push offset MyEventObjectName<br />push FALSE                        ; it could be TRUE or nonzero, we dont care<br />push FALSE                        ; it could be TRUE or nonzero, we dont care<br />push NULL                          ; dont need to care about SECURITY_ATTRIBUTES...<br />call             ; MASM/TASM users use invoke/call CreateEventA<br /><br />call <br /><br />cmp eax,ERROR_ALREADY_EXISTS<br />jz WeAreAlreadyRunning<br /><br />...<br /><br />WeAreAlreadyRunning:<br />push 0<br />call <br /><br />Bye :D</div>
    <div class="meta">Posted on 2003-08-09 06:51:43 by sheroc</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=14296&amp;page=1" style="">&laquo;</a><a href="../?id=14296&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="14296" /><input type="number" name="page" min="1" max="2" step="1" value="2" onchange="this.form.submit();" /></form>  </div>
 </body>
</html>