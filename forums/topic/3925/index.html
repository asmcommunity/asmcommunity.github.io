<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>need help understanding source - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3925" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3925">need help understanding source</a></p>
   <div class="post" id="post-26729">
    <div class="subject"><a href="#post-26729">need help understanding source</a></div>
    <div class="body">hossa,<br /><br />i found a source made by zombie to scan for a registry key.<br />ok i dont understand the function but i like to use it ,dont know if its lame if i like to use something i dont know how it works.<br />what i know is that i realy like to see this function in my tool ,its much faster then windows regedit scan.<br /><br />also im shure if i spend more time on this i would understand it ,but i learn asm in my free time and im unable to learn all i like in this short time.<br /><br />so im &quot;crying&quot; for help :-)<br />i like to use the source without dosbox and like to insert the search result in a listbox ,thats not so hard.<br />my problem is that i dont know what happend to the searched keyname when the tool executes.<br /><br />you must start it like : regscan NAMETOSEARCH<br /><br />so the name comes from the comandline and i dont understand in what form....edi ,esi....???<br /><br />lets say i have a editfield and in this i like to insert the name of the key to search for ,i try to use this value as edi ,esi but i never get a result.<br /><br />what happend to the name here :<br /><br />getcmdline:             pusha<br /><br />                        callW   GetCommandLineA<br />                        xchg    esi, eax                    &lt;-- for this i thing its esi but.....<br /><br />                        mov     argc, 0<br />                        <br />                        lea     edx, argv0<br />                        call    getargv<br />                        lea     edx, argv1<br />                        call    getargv<br />                        lea     edx, argv2<br />                        call    getargv <br />                        lea     edx, argv3 &lt;------- whats this all ??<br />                        call    getargv   &lt;------- whats this all ??<br /><br />                        popa<br />                        retn<br /><br />getargv:                mov     edi, edx<br /><br />__1:                    lodsb<br />                        cmp     al, 0<br />                        je      __2<br />                        cmp     al, 32<br />                        je      __1<br />                        cmp     al, 9<br />                        je      __1<br />__2:                    dec     esi<br /><br />__3:                    lodsb<br />                        stosb<br />                        cmp     al, 32<br />                        je      __4<br />                        cmp     al, 9<br />                        je      __4<br />                        cmp     al, 0<br />                        jne     __3<br />__4:                    dec     esi<br /><br />                        sub     , al<br /><br />                        cmp     byte ptr , 0<br />                        setne   al<br />                        movzx   eax, al<br />                        add     argc, eax<br /><br />                        retn<br /><br />i attched the source code for tasm.<br /><br />if you think im not worth to help because i coded a trojan ,think about this : <br />1. the trojan never worked as real trojan ,only demonstration <br />2.if i never code this i would never know how a trojan work and how i can protect myself.<br />3.i can speak about what i code and have no problem to say that i coded a trojan ,whats better someone who say this public or somone who code trojans and dont say it.<br />all i actual know is in my security tool...i asked months ago if someone like to code with me on the security tool and i post a preversion of it ,so im telling the true !<br />and its not finished because im a newbie :-)<br /><br />so be a nice coder and help a lazy newbie ,thanks</div>
    <div class="meta">Posted on 2002-03-02 01:58:27 by Max</div>
   </div>
   <div class="post" id="post-26731">
    <div class="subject"><a href="#post-26731">need help understanding source</a></div>
    <div class="body">From the code I have seen from <strong>zombie</strong>, it is not beginer code - maybe you should try to understand something less convoluted first and then work your way to <strong>zombie</strong>'s code.  All this assuming you must find a way to use/understand his code.</div>
    <div class="meta">Posted on 2002-03-02 02:25:26 by bitRAKE</div>
   </div>
   <div class="post" id="post-26737">
    <div class="subject"><a href="#post-26737">need help understanding source</a></div>
    <div class="body">hossa<br /><br />thanks for the answer :)<br />i understand the way the source works ,but im unable to read all correct because i dont know all or better say enough about asm.<br /><br />i think after calling the exe the function i dont understand create the name to search for.<br />so i think first it &quot;copy&quot; the user input to a buffer...esi<br />but when i get the string from the editfield and make lstrcpy esi,offset buffer<br />i got endless search.<br /><br />so i ask if some can explain me what happend in the function exactly - i dont want that you code it for me :)</div>
    <div class="meta">Posted on 2002-03-02 05:45:36 by Max</div>
   </div>
   <div class="post" id="post-26870">
    <div class="subject"><a href="#post-26870">need help understanding source</a></div>
    <div class="body">Hi Max,<br /><br />Because zombie is a &quot;non standard&quot; Russian master of the size optimized and SMC code my advice is:<br /><br />- get a good debugger (as SI or TRW2000)<br />- play with code in the low level<br />- try to understand and rewrite his code with your non optimized code</div>
    <div class="meta">Posted on 2002-03-03 00:33:38 by buliaNaza</div>
   </div>
   <div class="post" id="post-26877">
    <div class="subject"><a href="#post-26877">need help understanding source</a></div>
    <div class="body">hossa,<br /><br />thanks for the answer :)<br />i start yesterday coding the function with was i know.<br />today the function is much bigger ,slower and at last im not finish with all keys.<br /><br />when i see first the source i think im on the wrong place !<br /><br />if i can learn coding like this ,i dont want code other ways.<br />im shure its hard and a long way to learn it.<br />buts very interresting to see.<br /><br />most masm source i have uses as example:<br /><br />.if eax==<br /><br />.else<br /><br />.endif<br /><br />and so on.....<br /><br />if i look in tasm the coder used:<br /><br />cmp eax,0<br /> je = if equal<br /> jnz ......<br /><br />what makes the same but need not much chars and if u look at the source its maybe not so easy to read for a beginner.....because all know &quot;if&quot; &quot;and&quot; &quot;or&quot; &quot;else&quot;  from basic :-)<br /><br />do you or another reader know more about : <br />size optimized and SMC code ????<br /><br />i mean examples ,tutorials ,help .....<br />any text about this would help :)<br /><br />and why are most russian coders top asm coders ?<br />is it because in europe and usa they have much money and then they shop delphi or stuff like it and in russia they have not much and start with asm ?<br /><br />i wounder why most asm coders ,i know from homepages ,are from russia ,bulgaria ,romania .......<br /><br />i know its off toppic but i like to ask :-)</div>
    <div class="meta">Posted on 2002-03-03 02:04:32 by Max</div>
   </div>
   <div class="post" id="post-26881">
    <div class="subject"><a href="#post-26881">Well</a></div>
    <div class="body">I do not know why TASM coders do NOT use &quot;standard&quot; MASM HLL constructs, they sure can do, i use:<br />.IF .ELSEIF .ELSE .ENDIF<br />or PROC STDCALL ,  ARG, LOCALS etc<br />quite a lot in the logical parts of my programs... i mean where optimization is not very important <strong>but clarity is</strong> but it looks like i am a &quot;rara avis&quot;<br /><br />I guess TASM is still mostly used by advanced VX coders a lot and they do not care for readabilty (esp for beginners as advanced users can still read their code with ease) but they care for size and speed more...<br /><br />However there are some (like me) that use TASM for big applications because its speed at compiling... definitivelt TASM is for advanced old guys, i suggest you try and find MASM sourcecode for your examples if you are a beginner :)<br /><br />Size optimization is not quite as fast today, scalar micro processors like many simple operations better than a single (small) one because they can break and manage the many ones much better and each internal unit can eventually execute each opcode at the same time making code faster (but not allways smaller)<br /><br />I am from Romania but i gues Hutch, Hiro,Iczelion and many others are not. <br /><br />Old eastern countrys have had a comunist system allmost until 10 yerars before so we naturally have something against &quot;systems&quot; we natively try to go underground, i guess things will change as (if ever) we get to trust systems again. <br /><br />I guess we have PCs that are a little slower that the ones you (western ppl) use so we try to make the best out of them... also we have much smaller money available to buy Delphi/VStudio/etc licences...<br /><br />IMHO whatever PC one has he should try to get each drop of computing power out of it. <br /><br />Do not get me wrong here (Romania i mean) are many HLL programmers as well using C++/MFC or VB of Acces or .NET or VisualFoxPro... but we use that for our jobs where we are forced to do so by the market trend and not by our inner belief...<br /><br />My soul is with ASM forever :)</div>
    <div class="meta">Posted on 2002-03-03 02:49:28 by BogdanOntanu</div>
   </div>
  </div>
 </body>
</html>