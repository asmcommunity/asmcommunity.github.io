<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Temp Directory for HLA .inc/.obj files - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10458" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=10458">Temp Directory for HLA .inc/.obj files</a></p>
   <div class="post" id="post-78530">
    <div class="subject"><a href="#post-78530">Temp Directory for HLA .inc/.obj files</a></div>
    <div class="body">I have been contemplating how to deal with the<br />issue of the temporary files that HLA produces.<br /><br />A &quot;Quick &amp; Dirty&quot; solution, of course, is to just add<br />a command line parameter (e.g. &quot;-t:&lt;path&gt;&quot;) to<br />specify where HLA should put the temporary files.<br />An environment variable (e.g., HLATEMP) could also<br />provide a default location for these things.<br /><br />However, it occurs to me that 95% of the time,<br />nobody really wants these things laying around<br />after a compile anyway.  So I'm wondering if it<br />wouldn't be a better idea to simply delete the<br />temporary files once compilation is complete.<br /><br />Of course, if you want the &quot;.asm&quot; and &quot;.inc&quot; files,<br />the -s (or -st, -sg, -sm, and soon, -sf) command<br />line options would leave them.  Doing this makes<br />so much sense that it's probably the way I will<br />go unless some people out there scream and holler.<br /><br />I'm assuming that, since compile to assembly source<br />is a relatively rare thing, that there would be no need<br />to put the temporary files in some other directory<br />if I clean up after myself (and if you specify one of the<br />source output options, getting the source in the current<br />directory isn't too bad).<br /><br />It wouldn't be too hard to change the -s options to<br />something like &quot;-s:&lt;path&gt;&quot; but before I bother, I should<br />probably see if the solution above wouldn't satisfy everyone.<br /><br />There is also the question of where to put the .obj file that<br />assembling the source file produces.  There's probably a need<br />to specify the destination of the .obj file independently of the<br />assembly source files (since someone is probably more likely<br />to want to keep the .OBJ files around, and probably not in a<br />catch-all &quot;temp&quot; directory).<br /><br />Any and all comments are welcome on this one.<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-01-26 18:34:02 by rhyde</div>
   </div>
   <div class="post" id="post-78555">
    <div class="subject"><a href="#post-78555">More Info on Temporary Directories</a></div>
    <div class="body">Okay, having looked a little closer...<br /><br />First, you cannot specify a single object file output name<br />from the HLA command line.  The reason is simple, HLA<br />allows you to specify multiple .HLA files on a single command<br />line.  In theory, I *could* allow the specification of an obj<br />output name for each .HLA name (or each .ASM or each<br />.RES or each .RC, etc.) on the command line, but this is<br />starting to get crazy.<br /><br /><br />Here's what I am currently implementing:<br /><br />If you specify a &quot;source&quot; output command line parameter<br />(-s, -st, -sm, -sf, -sg) then HLA will not clean up after<br />itself, all the .asm, .inc, and .link files will be present<br />after the compilation.<br /><br />If you specify the -c (compile and assemble to OBJ file) then<br />HLA will delete the .asm and .inc files after assembling the<br />file (note that if there is a bug in HLA's code generator and<br />the assembler generates an error, the .asm and .inc files will<br />not be deleted).  Note that when using the -c option, HLA<br />will not clean up the .link file (since the linker still needs this<br />file).<br /><br />HLA will delete the .link file after successfully linking the file<br />to produce an executable.<br /><br />In addition, I'm adding the following two command line parameters<br />to HLA.EXE:<br /><br />-p:&lt;path&gt;<br />-obj:&lt;path&gt;<br /><br />Also, HLA will recognize a new environment variable, HLATEMP.<br />The -p option specifies a path to some directory where HLA will<br />place all temporary files (.asm, .inc, and .link).  The HLATEMP environment<br />variable will also specify this path;  note, however, that the -p option<br />overrides the environment variable.  If neither option is specified, then<br />HLA puts all temporary files in the current directory.<br /><br />-obj:&lt;path&gt; specifies where HLA will store the output object files<br />from the current assembly.  There is no environment variable for this<br />item.  The default is the current directory.<br /><br />I'm also fixing up the problem that occurs if you try something like this<br /><br />hla somedir\src.hla<br /><br />(it places the obj file in the current directory and then tries to link in<br />the &quot;somedir&quot; directory, and fails to find the src.obj file).<br /><br />Hopefully, this will resolve the issues people have had with<br />HLA's inability to work with files across multiple directories.<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-01-26 23:06:15 by rhyde</div>
   </div>
   <div class="post" id="post-78558">
    <div class="subject"><a href="#post-78558">Temp Directory for HLA .inc/.obj files</a></div>
    <div class="body">You are doing such a good job talking to yourself that I decided to keep out of it.  <br /><br />Actually you decided to do what I would have liked to suggest (path -p, and environment variable), but didn't because I have no idea how much work is involved.<br /><br /><br />Best,<br />  Scott</div>
    <div class="meta">Posted on 2003-01-26 23:28:23 by SFinegan</div>
   </div>
   <div class="post" id="post-78562">
    <div class="subject"><a href="#post-78562">Temp Directory for HLA .inc/.obj files</a></div>
    <div class="body"><div class="quote"><br />You are doing such a good job talking to yourself that I decided to keep out of it.  <br /><br />Actually you decided to do what I would have liked to suggest (path -p, and environment variable), but didn't because I have no idea how much work is involved.<br /><br /><br />Best,<br />  Scott </div><br /><br />Actually, the truth is that these simple changes are *almost* easy enough<br />that anyone (well, any C programmer) would be able to do it themselves.<br />Most of the work takes place in HLA.C, which is a &quot;shell&quot; program that<br />runs HLAPARSE.EXE (the real HLA compiler), ML/FASM/GAS/whatever,<br />the resource compiler, and the linker.<br /><br />I am passing the -p and -obj parameters on to HLAPARSE, but I suspect<br />that I could have avoided this with some &quot;chdir&quot; trickery.<br />Thus far, I've fixed the problem with &quot;hla somedir\somefile.hla&quot; (this<br />one was easy) and now I'm about to start working on HLAPARSE<br />to handle the -p and -obj parameters I'm passing on down from HLA.EXE.<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-01-26 23:42:05 by rhyde</div>
   </div>
   <div class="post" id="post-78570">
    <div class="subject"><a href="#post-78570">Temp Directory for HLA .inc/.obj files</a></div>
    <div class="body">Randy,<br /><br />I usually try and keep all the stuff for one exe in one place so I wonder if you could write the temp files in the directory that the build ias done from and clean out what you think is worth removing after the build.<br /><br />I reliably ditch all of the OBJ files after I have built a library as there is no point in keeping them. In your case when an intermediate asm file is produced, perhaps just keep that and ditch the rest. It is at least tidy.<br /><br />It certainly could be done with a TEMP veriable but many of the younger programmers did not grow up with DOS style environments so it may be a little strange to some of them.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2003-01-27 01:26:08 by hutch--</div>
   </div>
   <div class="post" id="post-78607">
    <div class="subject"><a href="#post-78607">Temp Directory for HLA .inc/.obj files</a></div>
    <div class="body"><div class="quote"><br />It certainly could be done with a TEMP veriable but many of the younger programmers did not grow up with DOS style environments so it may be a little strange to some of them.</div><br /><br />Ahh, the generation gap. :)</div>
    <div class="meta">Posted on 2003-01-27 09:24:01 by comrade</div>
   </div>
   <div class="post" id="post-78702">
    <div class="subject"><a href="#post-78702">Temp Directory for HLA .inc/.obj files</a></div>
    <div class="body"><div class="quote"><br />Randy,<br /><br />I usually try and keep all the stuff for one exe in one place so I wonder if you could write the temp files in the directory that the build ias done from and clean out what you think is worth removing after the build.<br /><br />I reliably ditch all of the OBJ files after I have built a library as there is no point in keeping them. In your case when an intermediate asm file is produced, perhaps just keep that and ditch the rest. It is at least tidy.<br /><br />It certainly could be done with a TEMP veriable but many of the younger programmers did not grow up with DOS style environments so it may be a little strange to some of them.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a> </div><br /><br /><br />Definitely the way I'm headed right now is to allow<br />the OBJ and ASM/INC/LINK files to be put into separate (user-specifiable)<br />directories during compilation.  That's fairly easy.<br />I haven't *completely* thought through the issue of <br />deleting the ASM/INC/LINK files after a successful assembly yet.<br />On the surface, it sounds okay;  but I'm sure that as I dig a little<br />deeper into this, I discover some problems with the approach.<br /><br />Deleting OBJ files after a successful link operation has already<br />reared its ugly head as a problem -- there are too many MAKEFILEs<br />in this world that check the need to rebuild the system based on<br />the date/time of the obj files.  This realization has led me to be<br />wary of file deletion, in general, by the compiler.<br /><br />Of course, placing the files in a user-specified directory (local<br />or global depending on command line parameters or environment<br />variables) solves much of the problem.  The global solution (e.g.,<br />using an environment variable) has a few problems (what happens<br />if two different projects produce some temporary files that have the<br />same name?  If they wind up going into the same global directory this<br />could be a problem).<br /><br />When I first attacked this problem, it seemed trivial.<br />Like all trivial problems, it's starting to blow up on me :-(<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-01-27 21:33:26 by rhyde</div>
   </div>
   <div class="post" id="post-78821">
    <div class="subject"><a href="#post-78821">Temp Directory for HLA .inc/.obj files</a></div>
    <div class="body">Randy,<br /><br />I think as long as you seperate app specific files from shared files, you should not have any problems. Anything app specific is probably best left in the local app directory where shared files should not be subject to modification by an app.<br /><br />Libraries make this simple but where you want to seperate between a library of source code that is available for an app and the local files for an app, it should be no problem to do you own cleanup of local application files after a build. Perhaps an option to allow the user to leave what they need, the asm file for example and clean out what they don't want.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2003-01-28 15:31:10 by hutch--</div>
   </div>
   <div class="post" id="post-78830">
    <div class="subject"><a href="#post-78830">Temp Directory for HLA .inc/.obj files</a></div>
    <div class="body">You can always create a subdirectory to hold temporary files.  Make it local to the source directory.<br /><br />This is the way the IDE for VC works.<br /><br />Source file directory: ......\project<br />Object and exe files for debug version: .......\project\Debug<br />Object and exe files for release version: ......\project\Release<br /><br />It looks fairly straightforward to me.  This has the advantage that it separates the two kinds of ASM files -- those written or imported by a programmer, and those generated by a compiler -- while keeping everything local.</div>
    <div class="meta">Posted on 2003-01-28 15:59:13 by tenkey</div>
   </div>
   <div class="post" id="post-78880">
    <div class="subject"><a href="#post-78880">Temp Directory for HLA .inc/.obj files</a></div>
    <div class="body">Well, thus far I've gotten the<br />&quot;temporary files&quot; (.asm, .inc, .link) directory and the<br />&quot;object files&quot; (.obj, .res) directory options working in HLA v1.43.<br /><br />I'm thinking about holding off on the &quot;clean-up&quot; option.<br />After all, most people just want the compiler-produced<br />files out of the way so they don't clutter up the project directory.<br />Any clean-up that the programmer wants done during a build is<br />easy enough to put into a makefile or an IDE (using one of the<br />existing, programmable, editors).<br /><br />I'll probably revisit the issue of clean up later.<br /><br />The comments about creating the directory got me thinking though,<br />it would be nice if HLA created the temps automatically if one wasn't<br />specified by the user.  OTOH, that's going to break a lot of makefiles<br />(mine, if no one else's :-) ).<br />Randy Hyde</div>
    <div class="meta">Posted on 2003-01-28 23:18:01 by rhyde</div>
   </div>
  </div>
 </body>
</html>