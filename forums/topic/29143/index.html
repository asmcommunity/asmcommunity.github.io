<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Radasm Toolbar Creator and a custom bitmap does not show? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29143" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=29143">Radasm Toolbar Creator and a custom bitmap does not show?</a></p>
   <div class="post" id="post-205855">
    <div class="subject"><a href="#post-205855">Radasm Toolbar Creator and a custom bitmap does not show?</a></div>
    <div class="body">Below is the toolbar.rc file created by Radasm using Radasm Toolbar Creator and a bitmap from file. The problem is that the bitmap does not show when ran. I have looked for hours on this site and have not located a reasonable answer. I have seen a lot of places where an example file is supposed to be, but the links are missing.<br /><br /><pre><code><br /><br />Tbr=IDC_TBR1,1001,0<br />Bmp=Res\Add.bmp,IDB_ADD,16&nbsp; &nbsp; ; Here is the bitmap in the resource folder and the ID I gave it in the creator.<br />Mnu=<br />Size=16<br />0=IDC_TBB,1002,0,0<br /></code></pre><br /><br />Code to initialize the toolbar:<br /><br /><pre><code><br />.if eax==WM_INITDIALOG<br />		push	hWin<br />		pop		hWnd<br />		mov hToolBar,rv(GetDlgItem,hWnd,IDC_TBR1)<br />		invoke DoToolBar,hInstance,hWnd<br /></code></pre><br /><br />This is the code generated by Radasm Toolbar Creator export.<br /><br /><pre><code><br />DoToolBar proc hInst:DWORD,hOwner:HWND<br />	LOCAL	tbab:TBADDBITMAP<br />;	LOCAL	hToolBar:HWND<br /><br />	;Create the toolbar<br />;	invoke CreateWindowEx,0,addr szToolBarClass,0,WS_CHILD or WS_VISIBLE,0,0,0,0,hOwner,IDC_TBR1,hInst,0<br />;	mov		hToolBar,eax<br />	;Set toolbar struct size<br />	invoke SendMessage,hToolBar,TB_BUTTONSTRUCTSIZE,sizeof TBBUTTON,0<br />	;Set toolbar bitmap<br />	push	hInst<br />	pop		tbab.hInst<br />	mov		tbab.nID,IDB_ADD<br />	invoke SendMessage,hToolBar,TB_ADDBITMAP,16,addr tbab<br />	;Set toolbar buttons<br />	invoke SendMessage,hToolBar,TB_ADDBUTTONS,ntbrbtns,addr tbrbtns<br />	mov		eax,hToolBar<br />	ret<br /><br />DoToolBar endp<br /></code></pre><br /><br />Thanks...</div>
    <div class="meta">Posted on 2008-09-02 16:47:04 by green</div>
   </div>
   <div class="post" id="post-205863">
    <div class="subject"><a href="#post-205863">Re: Radasm Toolbar Creator and a custom bitmap does not show?</a></div>
    <div class="body">Decrease color depth of &quot;add.bmp&quot; or use ImageList.<br /><pre><code><br />;; a toolbar with 1 48x48 bmp button<br />DoToolBar proc hToolBar:HWND<br />	LOCAL himl:HIMAGELIST <br />	LOCAL tbab:TBADDBITMAP<br /><br />	;Set toolbar struct size<br />	invoke SendMessage,hToolBar,TB_BUTTONSTRUCTSIZE,sizeof TBBUTTON,0<br />	invoke SendMessage,hToolBar,TB_SETBUTTONSIZE,0,MAKELONG(48,48)<br />	invoke SendMessage,hToolBar,TB_SETBITMAPSIZE,0,MAKELONG(48,48)<br />	invoke SendMessage,hToolBar,TB_SETMAXTEXTROWS,0,0<br />	invoke GetModuleHandle,0<br />	;Set toolbar bitmaps<br />	invoke ImageList_LoadImage,eax,IDR_TBRBMP,48,1,RGB(255,0,255),IMAGE_BITMAP,LR_CREATEDIBSECTION<br />	mov himl,eax<br />	invoke SendMessage,hToolBar,TB_SETIMAGELIST,0,himl<br />	;Set toolbar buttons<br />	invoke SendMessage,hToolBar,TB_ADDBUTTONS,ntbrbtns,addr tbrbtns<br />	mov eax,hToolBar<br />	ret<br /><br />DoToolBar endp<br /></code></pre></div>
    <div class="meta">Posted on 2008-09-03 15:53:23 by drizz</div>
   </div>
  </div>
 </body>
</html>