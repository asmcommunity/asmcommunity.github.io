<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>arggh help please really annoying problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27122" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27122">arggh help please really annoying problem</a></p>
   <div class="post" id="post-194674">
    <div class="subject"><a href="#post-194674">arggh help please really annoying problem</a></div>
    <div class="body">I try this:
   
mov eax,offset newdir
push eax
Call SetCurrentDirectoryA



and it doest work.

in td32 eax always returns 1, never fails, eveb when i should hit root directory, which leads me to belive the direcory isnt changing
is there soemthing im forgetting to do that is also necessary to change dirs?

i use Tasm32.


im using windows 98 second edition.


i compile my source like this:

tasm32 /ml /m3 Sourcecode.asm

tlink32 /Tpe /aa /x SourceCode.obj,,,import32.lib


any help you guys could lend would be greatly apprecieated</div>
    <div class="meta">Posted on 2001-03-06 09:11:00 by Cell_</div>
   </div>
   <div class="post" id="post-194675">
    <div class="subject"><a href="#post-194675">arggh help please really annoying problem</a></div>
    <div class="body">According to the SDK,
SetCurrentDirectory returns 0 if it fails
and nonzero for success. So, it appears that
the function is working.</div>
    <div class="meta">Posted on 2001-03-06 09:49:00 by anon</div>
   </div>
   <div class="post" id="post-194676">
    <div class="subject"><a href="#post-194676">arggh help please really annoying problem</a></div>
    <div class="body">NO Its not
because even in root directory
function doesnt return 0!
like it sshould
its looping forever
why></div>
    <div class="meta">Posted on 2001-03-06 18:36:00 by Cell_</div>
   </div>
   <div class="post" id="post-194677">
    <div class="subject"><a href="#post-194677">arggh help please really annoying problem</a></div>
    <div class="body">What is it you are trying to do ?
Maybe you could post part of your code ?</div>
    <div class="meta">Posted on 2001-03-06 19:11:00 by anon</div>
   </div>
   <div class="post" id="post-194678">
    <div class="subject"><a href="#post-194678">arggh help please really annoying problem</a></div>
    <div class="body">is newdir null terminated? i think something like this should not return any errors (or will work well):

.data
newdir db "c:\windows",0  ; (c:\windows\<-???)
.code
push offset newdir
call SetCurrentDirectoryA</div>
    <div class="meta">Posted on 2001-03-07 21:42:00 by drcmda</div>
   </div>
  </div>
 </body>
</html>