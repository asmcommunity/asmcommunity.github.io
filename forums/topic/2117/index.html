<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>OLE drag&amp;drop: it's ALIVE!!! - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2117" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=2117">OLE drag&amp;drop: it's ALIVE!!!</a></p>
   <div class="post" id="post-13443">
    <div class="subject"><a href="#post-13443">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">Yuhuuuu<br /><br />I managed to implement in asm the interfaces for IDropSource, IDataObjcet and IEnumFORMATETC ... and now I have a working drag-drop server that allows me to drag files in Explorer!!<br />Need now to implement the IDropTarget class (easy) and will then post the source with a working example on how to use them! <br />This might take a while cauz I'm going on holiday in 2 days ...<br /><br /><br />Assuming of course that somebody is interested in OLE Drag-Drop that is.<br /><br /><br />I love asm<br /><br />Random</div>
    <div class="meta">Posted on 2001-11-29 02:55:24 by random</div>
   </div>
   <div class="post" id="post-13458">
    <div class="subject"><a href="#post-13458">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">that's awesome random :)<br /><br />good job :alright:</div>
    <div class="meta">Posted on 2001-11-29 05:36:16 by Hiroshimator</div>
   </div>
   <div class="post" id="post-13503">
    <div class="subject"><a href="#post-13503">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">Ok ... here it is (a bit earlier than I expected ;) )<br /><br /><br />There is not much in terms of explanations / comments, as I really hate writing those<br />Anyway, there are plenty of tutorials on the net covering OLE Drag/Drop in VC++ ... and if you don't know C++ then you shouldn't be reading this anyway ;)<br /><br /><br />What it is:<br />This are the iterfaces for IDataObject, IDropSource, IDropTarget and IEnumFORMATETC required to support basic OLE Drag Drop<br /><br />The classes have been written with file transfers between the application and the shell in mind (i.e. for the CF_HDROP shell data transfer format), but can easily be modified to support any other (e.g. CF_TEXT)<br /><br />There is also a little example on how to use the classes. It's a little utility that acts like a drag and drop staging area. You can drag files into the app from the Explorer, you can then drag them out back to the Explorer to be copied in the destination folder. Easy!!<br /><br />Note: I didn't use COLib because I really didn't have time to understand how it works (I started looking at COM on Monday, I got the original C++ sources on Tue and I'm posting this on Thursday ... give me a break ;) )<br /><br /><br /><br />Take care<br />Random</div>
    <div class="meta">Posted on 2001-11-29 15:24:19 by random</div>
   </div>
   <div class="post" id="post-13522">
    <div class="subject"><a href="#post-13522">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body"><strong>it's ALIVE!!! </strong></div>
    <div class="meta">Posted on 2001-11-29 21:11:37 by cmax</div>
   </div>
   <div class="post" id="post-13526">
    <div class="subject"><a href="#post-13526">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">Random,<br /><br />  Congratulations on a very nice serious bit of new work.<br /><br />  While I couldn't get the sample to work (not that I understood what it was doing), I know getting any of this working takes much skull work.<br /><br />  And no problem NOT using CoLib. I think it would please Bill to see how you used his work as a base.<br /><br />  EXCELLENT !!!</div>
    <div class="meta">Posted on 2001-11-29 21:36:23 by Ernie</div>
   </div>
   <div class="post" id="post-13532">
    <div class="subject"><a href="#post-13532">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">Hmm... im with Ernie on this one, it doesnt seem to do all that much... (nothing really)...<br /><br />Even tho i do get the cursor to change when i try to drag an drop something.. but thats all i see. ????<br /><br />Im using windows 98SE...<br /><br />However, im very curious as to the implications your work can offer....<br /><br />NaN</div>
    <div class="meta">Posted on 2001-11-29 22:29:21 by NaN</div>
   </div>
   <div class="post" id="post-13550">
    <div class="subject"><a href="#post-13550">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">Dunno ... it works on my 2 win2k machines, didn't have time to test it on a win98.<br />Maybe there is something in the example code (don't think in the interfaces) that doesn't work properly with w9x.<br /><br />In win2k, at least, just drag the files from the explorer and drop them in the test window, where a list of the dropped files will be displayed<br /><br />let me know<br /><br /><br />Random</div>
    <div class="meta">Posted on 2001-11-30 04:04:52 by random</div>
   </div>
   <div class="post" id="post-13556">
    <div class="subject"><a href="#post-13556">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">ya random, it don't work for 9x.  You got to test your work on both types before ever releasing anything i think ...Special work that looks as good as your does.  Made since to me, but who am i...</div>
    <div class="meta">Posted on 2001-11-30 07:42:37 by cmax</div>
   </div>
   <div class="post" id="post-13561">
    <div class="subject"><a href="#post-13561">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">Yeah well, I don't have win98 pcs ... anyone has a spare one ? :)<br /><br />And has any1 with win2k tested it yet?<br /><br /><br />Random<br />ps: it's not a release or anything ... just free code I'm sharing for the pleasure of sharing ;)</div>
    <div class="meta">Posted on 2001-11-30 09:38:25 by random</div>
   </div>
   <div class="post" id="post-13562">
    <div class="subject"><a href="#post-13562">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">random,<br /><br />I've tried it on 95, 98, NT and 2K, and the only one I got it to work on was 2K.<br /><br />I'll have to have a close look at your code and try to work out what I'm doing wrong in mine, thanks for sharing the source so quickly.<br /><br />Nick</div>
    <div class="meta">Posted on 2001-11-30 09:44:39 by Nick</div>
   </div>
   <div class="post" id="post-13565">
    <div class="subject"><a href="#post-13565">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">mmhhh ... do you get the window with the listview control?<br /><br />if not, just add InitCommonControls at WM_CREATE<br /><br />let's see ... it could be the RegisterClipboardFormat<br /><br />I'll try to get access to a win98 installation next week and with a debugger should take only few minutes to figure it out<br /><br /><br />Random</div>
    <div class="meta">Posted on 2001-11-30 09:53:40 by random</div>
   </div>
   <div class="post" id="post-13577">
    <div class="subject"><a href="#post-13577">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">tested on a win98se and it works ... can't explain<br /><br />that's it folks for this week<br /><br /><br />take care<br />Random</div>
    <div class="meta">Posted on 2001-11-30 13:07:30 by random</div>
   </div>
   <div class="post" id="post-13588">
    <div class="subject"><a href="#post-13588">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">If you edit in debug routines (vkim's stuff or what ever), to make an output log at evey key point, i will run and test it for you on my machine and send you back the log (if you think it will help..)<br /><br />NaN</div>
    <div class="meta">Posted on 2001-11-30 15:43:03 by NaN</div>
   </div>
   <div class="post" id="post-13592">
    <div class="subject"><a href="#post-13592">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">I tried at work on 2k machine.  It worked but when i got home on my 95 it did not.  At lease i now know that if i send something not completly tested i don't have to be shy about it.  It be great to see it working for 95 too.  It's to heavy for me, i don't know com yet. See ya</div>
    <div class="meta">Posted on 2001-11-30 16:36:44 by cmax</div>
   </div>
   <div class="post" id="post-13734">
    <div class="subject"><a href="#post-13734">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">very good job, random :alright: <br /><br />There seems t? be an error in structure FORMATETC.<br /><br />Old version:<br /><pre><code><br />FORMATETC STRUCT DWORD<br />        cfFormat        DWORD ?<br />        ptd             DWORD ?<br />        dwAspect        DWORD ?<br />        lindex          LONG ?<br />        tymed           DWORD ?<br />FORMATETC ENDS<br /></code></pre><br /><br />New version:<br /><pre><code><br />FORMATETC STRUCT DWORD<br />        cfFormat        WORD ?<br />        reserved        WORD ?<br />        ptd             DWORD ?<br />        dwAspect        DWORD ?<br />        lindex          LONG ?<br />        tymed           DWORD ?<br />FORMATETC ENDS<br /></code></pre><br /><br />After changing all places it works with Win9x<br /><br />Here is a version running with Win9x separated into several source files (thats for technical reasons because VC cannot properly handle included &quot;.ASM&quot; files).</div>
    <div class="meta">Posted on 2001-12-02 05:56:15 by japheth</div>
   </div>
   <div class="post" id="post-13758">
    <div class="subject"><a href="#post-13758">OLE drag&amp;drop: it's ALIVE!!!</a></div>
    <div class="body">That seems to be it.. works on 98SE now...<br /><br />Good eye Japheth...<br /><br />NaN</div>
    <div class="meta">Posted on 2001-12-02 11:44:07 by NaN</div>
   </div>
  </div>
 </body>
</html>