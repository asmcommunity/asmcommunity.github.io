<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Macros To use Masm with Visual C++ - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=2484" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=2484">Macros To use Masm with Visual C++</a></p>
   <div class="post" id="post-15651">
    <div class="subject"><a href="#post-15651">Macros To use Masm with Visual C++</a></div>
    <div class="body">Here are two macros for Visual Studio, one to add an existing asm file, and one to add a new asm file. (So one do not need to add the custom settings every time one adds a asm file to a project.)<br /><br />The macros names are:<br />AddExistingASM<br />AddNewAsm<br /><br />I would liked to add this to the File/New and File/Open of Visual, but I do not know how to. (If anyone knows I would like to hear about it). <br /><br />The file is a .dsm inside a .zip (because the board does not like .dsm file extension). <br /><br />BTW: Is there any way to tell Visual Studio to open another editor every time I double click a .asm file??</div>
    <div class="meta">Posted on 2001-12-21 13:11:00 by dxantos</div>
   </div>
   <div class="post" id="post-15985">
    <div class="subject"><a href="#post-15985">To does of you that dont know how to use the macro on VC++ i</a></div>
    <div class="body">1. Put the macro on Visual C++ Macro Directory, in my case:<br /><br /><pre><code><br />C&#58;\Program Files\Microsoft Visual Studio\Common\MSDev98\Macros<br /></code></pre><br /><br />2. Run Visual C++, and select the Menu item:<br />Tools<br />    Customize<br /><br />3. In the Customize dialog, select Add-ins and Macro files tab.<br /><br />4. Select the masm macro, and then press the Close Button.<br /><br />Now Visual C++ Knows about the AssNewAsm and AddExistingAsm Macros. But to use it, its convenient to have a shortcut button. To make the shortcuts:<br /><br />1. Go again to Tools/Customize Dialog. This Time select the Commands Tab.<br /><br />2. In the Category, select Macros.<br /><br />3. In Commands Select AddExistingAsm and drag it to a toolbar.<br /><br />4. Select the icon for the new button.<br /><br />5. Repeat steps 3 and 4 for AddNewAsm<br /><br />There you have it 2 shorcuts, 1 to add a new asm file, 1 to add an existing asm file.<br /><br />To use the macro.<br />1. Press the shortcut button.<br />2. Type in the name of the file.<br /><br />And thats it, the macro has taken care of add the customize settings to the asm project item. It even puts the .obj in the Debug (for debug builds) and in Release (for release build) directories.<br /><br />PS. I will really like to know is someone actually uses it <br />:tongue:</div>
    <div class="meta">Posted on 2001-12-24 10:58:53 by dxantos</div>
   </div>
   <div class="post" id="post-16150">
    <div class="subject"><a href="#post-16150">duh!</a></div>
    <div class="body">I meant AddNewAsm, not AssNewAsm</div>
    <div class="meta">Posted on 2001-12-25 20:18:53 by dxantos</div>
   </div>
   <div class="post" id="post-16182">
    <div class="subject"><a href="#post-16182">Macros To use Masm with Visual C++</a></div>
    <div class="body">Very nice macro ! It could be better with a &quot;Browse...&quot; button, the flag &quot;-W3&quot; added to the compile line and the properties set to &quot;C/C++&quot; (to enable limited syntax highlighting)</div>
    <div class="meta">Posted on 2001-12-26 06:20:34 by Dr. Manhattan</div>
   </div>
   <div class="post" id="post-16248">
    <div class="subject"><a href="#post-16248">Macros To use Masm with Visual C++</a></div>
    <div class="body">I wanted it to be on the File/Open File/New dialogs, but I dont know how to add an adding for doing that. (I have found info on various addins, and even on how to create a custom wizard, but no info on how to create an addin for the File/Open, File/New dialogs.<br /><br />It will be very usefull to be able to browse instead of writing the name of the file. But havent found a Function in the reference of VBA in the MSDN that would open a OpenFile Dialog. Since my expertise in on C++ and assembly, not Visual Basic, I will not be amazed if there is a simple way to do that. Its just that I dont know how.<br /><br />As for the -W3 option for increasing the warning level, its a matter of personal or institutional taste. Just edit the .dsm file and change the MasmRelease and MasmDebug strings at the beggining to add the options you want.<br /><br />Anyway, if someone outhere know how to invoke a FileOpen dialog from a VBA macro, it would be very helpful if that person could share the info.</div>
    <div class="meta">Posted on 2001-12-26 16:48:13 by dxantos</div>
   </div>
   <div class="post" id="post-16752">
    <div class="subject"><a href="#post-16752">Macros To use Masm with Visual C++</a></div>
    <div class="body">The funny thing is that even in VBA, you can just import a dll and use all the standard API calls. This example works in <br />Word 97 VBA, so I expect it to work in the Visual Studio VBA:<br /><br /><pre><code><br />' MessageBox&#40;&#41; Flags<br />Const MB_OK = &amp;H0&amp;<br />Const MB_ICONQUESTION = &amp;H20&amp;<br />Private Declare Function MessageBox Lib &quot;user32&quot; Alias &quot;MessageBoxA&quot; &#40;ByVal hwnd As Long, ByVal lpText As String, ByVal lpCaption As String, ByVal wType As Long&#41; As Long<br /><br />Sub Main&#40;&#41;<br />MessageBox 0, &quot;This is a test&quot;, &quot;Test&quot;, MB_OK + MB_ICONQUESTION<br /><br />End Sub<br /></code></pre><br /><br />You can find all the Const's and Declares in win32api.txt, search your HD for it. <br />Important: don't forget to add a &quot;Private&quot; in front of the declare, or VBA will give an error! <br />The text file was written for VB, not VBA.</div>
    <div class="meta">Posted on 2001-12-30 03:33:55 by Qweerdy</div>
   </div>
   <div class="post" id="post-18282">
    <div class="subject"><a href="#post-18282">Ups, my mistake.</a></div>
    <div class="body">VC++ uses VBS (Visual Basic Script), not VBA(Visual Basic For Applications) as I wrote before. Sorry, my mistake<br /><br />Reading the MSDN, a VBS application cannot call the Windows API, thus it would be better to make a pluging to handle this.</div>
    <div class="meta">Posted on 2002-01-08 22:35:48 by dxantos</div>
   </div>
   <div class="post" id="post-18289">
    <div class="subject"><a href="#post-18289">Macros To use Masm with Visual C++</a></div>
    <div class="body">I thought VBS can use COM?  I know there is an API wrapper for COM, that allows you to call any Win32 API from COM, but that is a fairly hacky way to do it.  I have a pluggin that someone wrote for using MASM from VC, and posted to the newsgroups, but I'd have to hunt it down.  Never could get it to work on VS6, but I think it was wrote for VC5?  Let me know and I'll hunt it down - that had to be a couple years ago that is was released, and then there was no support - I can't even remember who posted it?  I might not even have it? :tongue:</div>
    <div class="meta">Posted on 2002-01-08 23:34:21 by bitRAKE</div>
   </div>
  </div>
 </body>
</html>