<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>NN Chess AI - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=25653" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=25653">NN Chess AI</a></p>
   <div class="post" id="post-187214">
    <div class="subject"><a href="#post-187214">NN Chess AI</a></div>
    <div class="body">Just an idea..and enough code to make it workable.<br />We can show the NN the state of a chessboard..<br />Each cell of the 8x8 grid contains a &#39;chesspiece id&#39;, and each chesspiece id is represented as a series of floating point values (ie the binary string of each id value is represented by a floating string containing only 0.0 and 1.0).<br />Since we only have to represent 6 chess pieces (and an empty cell), we can do this with just three bits, ie, three floats, so I used Vec3.<br /><br />In this demo, I&#39;m teaching the NN what the board looks like for a new game of chess, and that when its inputs are shown a new game of chess, its outputs should ALSO show a new game of chess ... ie, NOP.<br /><br />It&#39;s VERY easy to teach this AI by letting it &#39;observe&#39; games between actual humans, while in &#39;training mode&#39;... heh.. in a loop, train it witht inputs=old chessboard and desired outputs=new chessboard, until its outputs=desired outputs.<br />Bad players will make it more stupid, but I mentioned the solution in another thread.<br /><br />Once the AI has had a little training, you can play against the computer, and/or let the computer make suggestions :)<br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=2206" target="_blank">NNChess061231.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-12-31 01:17:30 by Homer</div>
   </div>
   <div class="post" id="post-187215">
    <div class="subject"><a href="#post-187215">Re: NN Chess AI</a></div>
    <div class="body">Hi Homer,<br /><br />Board representation:<br />---------------------<br />In the representation of the board, I can see no difference between a white and a black piece.<br /><br />Suppose we have a position:<br />White: King e7, pawn d6<br />Black: King e5<br /><br />It&#39;s a big difference, whether the pawn at d6 is black or white.<br />It doesn&#39;t matter who&#39;s turn it is, but the one who is owning the pawn is going to win.<br /><br />It&#39;s also a big difference, if the King at e7 is black, instead of white. (The King at e5&nbsp; is white then ofcourse). If the pawn at d6 is white, the game will result in a draw.<br /><br />In all these situations we have the same representation of the board, but all having a different meaning, and outcome of the game.<br /><br />The NN shouldn&#39;t be confused by the colors of the pieces.<br />How would the NN know the difference?<br /><br /><br />Strong moves:<br />--------------<br />If I understand it well: You first want to see the result of the game. And you save the NN of the winning side.<br /><br />But in chess the following rule often applies:<br />The one who makes the LAST mistake, will lose.<br /><br />In other words: The losing side can have produced better moves than the winning side, until there was a turning point: The moment the losing side made his big mistake!<br /><br />The difficulty with chess is, that it exists of a sequence of moves.<br />Each of them can be (relatively) strong, or not. It depends on the evaluation of the resulting position.<br />So, we have to figure out a way to evaluate a position as good as possible. It can lead us to the right move. For it&#39;s the strong moves we are interested in. Not just who has won. Ofcourse there is a chance, that the winning side made all the right moves. But there is no guarantee.<br /><br />How can a Neural Network help us on this matter?<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2006-12-31 03:01:28 by mdevries</div>
   </div>
   <div class="post" id="post-187219">
    <div class="subject"><a href="#post-187219">Re: NN Chess AI</a></div>
    <div class="body">In any particular given chess position, the next move is what matters most... we have a selection of N moves, leading to a selection of N outcomes.<br />If we recall what moves lead to a win, we win :)<br /><br />Regarding the colors, you are right - I&#39;d recommend setting another bit to determine the colour, so we&#39;d work with Vec4 instead of Vec3.<br /><br />Anyway, this was not a serious project source, this was my half cocked response to your suggestion.<br />I&#39;ve not actually employed the NNet code in a serious project, but here we have a perfect example.<br /><br /></div>
    <div class="meta">Posted on 2006-12-31 08:48:30 by Homer</div>
   </div>
   <div class="post" id="post-187243">
    <div class="subject"><a href="#post-187243">Re: NN Chess AI</a></div>
    <div class="body">Actually, now I thought about this some more, you&#39;re wrong - theres NO NEED to distinguish between the colors of the chess pieces.<br />In fact, the AI requires NO KNOWLEDGE of chess or its rules.<br />The AI simply needs to know how to evolve the state of the chessboard when it has to make a move, and this experience is acquired through observing actual games between humans.<br /><br />If we train our NN properly, the AI will NEVER make illegal or stupid moves, so we ought not to need any code to check whether the AI&#39;s moves are legal or not - if trained correctly, it only knows how to make LEGAL moves (for example, it&#39;s never seen a game where a player takes his own piece, so it&#39;ll never produce such an outcome).<br /><br />If we DONT train our NN properly, it&#39;s going to do crazy things, it&#39;s going to make bad and/or illegal moves etc - we can write some code to enforce the rules of the game, but if we did our job as developers,&nbsp; and our betatesters did their job too, we&#39;d never need rules.<br /><br />It&#39;s actually quite strange when you think about it that an Expert System can operate effectively with no actual comprehension of what it is really doing, with no concept of limitations imposed on it etc, until you think about some of the PEOPLE you might know who seem to do this on a daily basis (my local member of parliament springs to mind).<br /></div>
    <div class="meta">Posted on 2007-01-01 12:45:06 by Homer</div>
   </div>
   <div class="post" id="post-187283">
    <div class="subject"><a href="#post-187283">Re: NN Chess AI</a></div>
    <div class="body">I don&#39;t think I get the idea of a NNet then.<br /><br />This is my understanding of a Neural Net:<br />You have an input layer, fed by the actual position. The actual position is formed by a certain amount of pieces scattered all over the board.<br />The stimuli coming from the input layer, generate a flow through zero or more hidden layers in the network, until the output layer is reached. For a Chess Neural Net the output layer could be a resulting position, or just a move, or whatever you want it to be.<br /><br />Now, what if we have the same position? Only the colors of some pieces differ, but we can&#39;t tell the difference. In both cases we have the SAME INPUT for the Neural Net, and I guess also the SAME OUTPUT. But we really don&#39;t want the same output. We want a DIFFERENT OUTPUT, depending on the colors of the pieces, not just on the kind of pieces. How is the Neural Net able to produce the right move, if he can&#39;t distinguish the colors?<br /><br />I think I am missing the point at the moment.<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2007-01-02 10:21:16 by mdevries</div>
   </div>
   <div class="post" id="post-187284">
    <div class="subject"><a href="#post-187284">Re: NN Chess AI</a></div>
    <div class="body">Forget about the colors of the pieces for the moment, and consider the state of the chessboard, with pieces here and there, regardless of their colors.<br /><br />If we exhaustively trained our NN.. show its inputs every possible combination of pieces in every possible position (ie every possible state of the board) and for EACH set of inputs show it one or more sets of desirable outputs, it can only produce those.<br /><br />If the NN is simplistic, it can only produce ONE move from any given chessboard state, but if its a little more elegant, it can choose from several.<br /><br />Typically, NN&#39;s produce one (set of) outputs for a given (set of) inputs, but that&#39;s not the way it has to be - after all, our biological NN (our brain) can produce decision making behaviours - what makes you think an NN can&#39;t do that also?<br /><br />If the NN is a &#39;single layered network&#39;, it can&#39;t choose - but we can have a smaller NN whose job is to make a selection from the outputs of several chess NNs - its weights are trained by progressive outcomes from previous attempts to use a given set of outputs.<br /><br />Now we have a two layered expert system, with a &#39;decision-making&#39; NN presiding over several &#39;past experience&#39; NNs - now we can implement behaviours such as &#39;fight or flee&#39; and other pseudobiological concepts.. now our AI can adjust its own behaviour - what ya think about that? Kinda scary eh?<br /></div>
    <div class="meta">Posted on 2007-01-02 11:27:23 by Homer</div>
   </div>
   <div class="post" id="post-187285">
    <div class="subject"><a href="#post-187285">Re: NN Chess AI</a></div>
    <div class="body"><br /><div class="quote">If we exhaustively trained our NN.. show its inputs every possible combination of pieces in every possible position (ie every possible state of the board) and for EACH set of inputs show it one or more sets of desirable outputs, it can only produce those.</div><br /><br />It&#39;s quite impossible to train the NN this way, because the amount of possible combinations of the pieces is just too great.<br />It seems there are more possible combinations then there are atoms in the universe.<br /><br />Besides, if you would be able to cycle through ALL the possible combinations (which is far too time consuming), and you could save them in a database (which is not possible given the amount of atoms you would need), you could use this database as a lookup table for the best move, which is far more simpler than using a NN.<br /><br /><div class="quote">If the NN is simplistic, it can only produce ONE move from any given chessboard state, but if its a little more elegant, it can choose from several.</div><br /><br />I agree it&#39;s possible to invoke a choosing system. That&#39;s ok as long as we are choosing a LEGAL move from it.<br />However, if the input is taken from an ambiguous position, there is a chance the system will choose an ILLEGAL move.<br /><br />I can&#39;t help rementioning the position, earlier in this thread:<br />White: King e7, pawn d6<br />Black: King e5<br /><br />The only legal move for the white pawn is to square d7.<br />Moving to d5 would be illegal.<br />But if the pawn was black, instead of white, the opposite would be true: Moving to d5 would be legal, and moving to d7 would be illegal.<br /><br />We surely don&#39;t want the NN to choose an illegal move. Those moves have to be discarded. How does the NN know what is illegal if it can&#39;t determine the color of the pawn?<br /><br />Friendly regards,<br />mdevries.</div>
    <div class="meta">Posted on 2007-01-02 14:08:18 by mdevries</div>
   </div>
  </div>
 </body>
</html>