<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>SQL in ASM - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=16073" />
  <link rel="prev" href="../?id=16073&amp;page=2" />  <link rel="next" href="../?id=16073&amp;page=4" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=16073">SQL in ASM</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=16073&amp;page=1" style="">&laquo;</a><a href="../?id=16073&amp;page=2" style="">&lt;</a><input type="hidden" name="id" value="16073" /><input type="number" name="page" min="1" max="4" step="1" value="3" onchange="this.form.submit();" /><a href="../?id=16073&amp;page=4">&gt;</a><a href="../?id=16073&amp;page=4">&raquo;</a></form>   <div class="post" id="post-125398">
    <div class="subject"><a href="#post-125398">SQL in ASM</a></div>
    <div class="body">hi Wayne,<br /><br />I try the code but I encounter a Record not found error so I change some buffers and <br />add a column in database which is <strong>numbers</strong> with Data Type number;<br /><span style="font-size:9px>invoke SQLBindCol, hStmt,1,SQL_C_CHAR, addr TheBook, sizeof TheBook,addr BooksLength<br />invoke SQLBindCol, hStmt,2,SQL_C_CHAR, addr TheVerse, sizeof TheVerse,addr VerseLength<br />invoke SQLBindCol, hStmt,3,SQL_C_CHAR, addr TheText, sizeof TheText,addr TextLength<br /><em>;invoke SQLBindCol, hStmt,4,SQL_C_ULONG, addr TheID, sizeof TheID,addr IDLength</em></span><br /><br />if i uncomment the TheID then the program is not running.<br /><br />I change also the SQL Statement <br /><br /><span style="font-size:9px>SQLStatement	db &quot;select * from AngBiblia &quot;,0<br />WhereStatement	db &quot;where ((books = ? and verse = ? ) or ID = ?) &quot;,0</span><br /><br />to <br /><br /><span style="font-size:9px>SQLStatement	db &quot;select * from AngBiblia &quot;,0<br />WhereStatement	db &quot;where books = ? and verse = ?  &quot;,0</span><br /><br />for the program to run.<br /><br /><span style="font-size:9px><br />invoke SQLBindParameter,hStmt,1,SQL_PARAM_INPUT,SQL_C_CHAR,SQL_CHAR,25,0,addr SearchName,25,addr StrLen<br />invoke SQLBindParameter,hStmt,2,SQL_PARAM_INPUT,SQL_C_CHAR,SQL_CHAR,25,0,addr SearchVerse,25,addr StrLen1<br /><em>;invoke SQLBindParameter,hStmt,3,SQL_PARAM_INPUT,SQL_C_ULONG,SQL_INTEGER,0,0,addr TheID,25,addr StrLen2</em></span><br /><br />also if I uncomment the above SQLBindParameter for TheID the program of the SQL Statement cannot found a record.<br /><br />i think the problem is in the TargetType..<br /><span style="font-size:9px>SQLRETURN SQLBindCol(<br />     SQLHSTMT     StatementHandle,<br />     SQLUSMALLINT     ColumnNumber,<br />     SQLSMALLINT     TargetType,<br />     SQLPOINTER     TargetValuePtr,<br />     SQLINTEGER     BufferLength,<br />     SQLLEN *     StrLen_or_Ind);</span><br /><br />What do you think?<br /><br /><br /><br /><br />regards,<br />coredump</div>
    <div class="meta">Posted on 2003-11-24 23:58:59 by coredump</div>
   </div>
   <div class="post" id="post-125403">
    <div class="subject"><a href="#post-125403">SQL in ASM</a></div>
    <div class="body">hi minor28,<br /><br />regarding in statement &quot;select * from AngBiblia WHERE text like '*?*' &quot;<br />is it ok if I create another QueryStrings proc like in order to bind the <br />statement?<br /><br /><br /><br />regards,<br />coredump</div>
    <div class="meta">Posted on 2003-11-25 01:26:44 by coredump</div>
   </div>
   <div class="post" id="post-125409">
    <div class="subject"><a href="#post-125409">SQL in ASM</a></div>
    <div class="body">My English is poor so I do not quite understand your question. I suppose you want to replace the question marks with seach parameters. Then you have to divide the string as follows.<br /><pre><code>.data<br />SQLStatement	db &quot;select * from AngBiblia &quot;,0<br />WhereStatement1	db &quot;where books = &quot;,0<br />WhereStatement2	db &quot; and verse = &quot;,0<br /><br />.code<br />invoke RtlZeroMemory,addr Conn,256<br />invoke lstrcpy,addr Conn,addr SQLStatement<br />invoke GetWindowText,hCombobox01,ADDR SearchName,25<br />invoke lstrcat,addr Conn,addr WhereStatement1<br />invoke lstrcat,addr Conn,addr SearchName<br />invoke lstrcat,addr Conn,addr WhereStatement2<br />invoke GetWindowText,hEdit02,ADDR SearchVerse,25<br />invoke lstrcat,addr Conn,addr SearchVerse</code></pre><br /><br />Regards</div>
    <div class="meta">Posted on 2003-11-25 03:53:43 by minor28</div>
   </div>
   <div class="post" id="post-125433">
    <div class="subject"><a href="#post-125433">SQL in ASM</a></div>
    <div class="body"><div class="quote"> I  try the code but I encounter a Record not found error so I change some buffers and add a column in database which is numbers with Data Type number.</div><br /><br />Are you sure you were using the database included in the zip file, it already had that field?<br /><br />Anyway, here is an example of what you need to do for searching. It will only search for 1 word but will give you  an idea how it's done. minor28's way will work also if you use SQLExecDirect.<br /><br />I  was lazy and jumbled everything into one SQL statement, you may want to create seperate SQL statements for &quot;Read&quot; &quot;Prev/Next&quot; and &quot;Search&quot; functions. It would just be cleaner.<br /><br />Also, in the Control Panel for ODBC you can turn tracing on, it helps a lot to see what is being sent to the ODBC driver.</div>
    <div class="meta">Posted on 2003-11-25 08:16:56 by Wayne</div>
   </div>
   <div class="post" id="post-125443">
    <div class="subject"><a href="#post-125443">SQL in ASM</a></div>
    <div class="body">I took a look at the MainWindow code. Added a MainMenu. Added a couple of 'Exodus' and '1:4' the mdn database.<br /><br />Parameters are legal only in certain places in SQL statements. For example, they are not allowed in the select list (quote SDK). Therefore you have to use SQLExecDirect.<br /><br />If you want to browse the recordset you can't close the cursor.</div>
    <div class="meta">Posted on 2003-11-25 10:37:40 by minor28</div>
   </div>
   <div class="post" id="post-125444">
    <div class="subject"><a href="#post-125444">SQL in ASM</a></div>
    <div class="body">Forgott to attach the code</div>
    <div class="meta">Posted on 2003-11-25 10:39:14 by minor28</div>
   </div>
   <div class="post" id="post-125544">
    <div class="subject"><a href="#post-125544">SQL in ASM</a></div>
    <div class="body">For scrolling: The cursor type must be changed from default &quot;forward only&quot; to &quot;static&quot;.<br /><pre><code>ODBCConnect proc hWnd&#58;DWORD<br />	invoke SQLAllocHandle,SQL_HANDLE_ENV,SQL_NULL_HANDLE,addr hEnv<br />	.IF ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />		invoke SQLSetEnvAttr,hEnv,SQL_ATTR_ODBC_VERSION,\<br />					SQL_OV_ODBC3,0<br />		.IF ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />			invoke SQLAllocHandle,SQL_HANDLE_DBC,hEnv,addr hConn<br />			.IF ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />				invoke lstrcpy,addr ConnectString,addr strConnect<br />				invoke lstrcat,addr ConnectString,addr ProgPath<br />				invoke lstrcat,addr ConnectString,addr DBName<br />				invoke SQLDriverConnect,hConn,hWnd,addr ConnectString,sizeof ConnectString,\<br />							addr Conn,sizeof Conn,addr StrLen,SQL_DRIVER_COMPLETE<br />				.IF ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />					invoke SwitchMenuState,TRUE<br />					invoke SetWindowText,hWnd,addr DBName<br />					invoke SQLAllocHandle,SQL_HANDLE_STMT,hConn,addr hStmt<br />					.if ax==SQL_SUCCESS || SQL_SUCCESS_WITH_INFO<br />						invoke SQLSetStmtAttr,hStmt,SQL_ATTR_CURSOR_TYPE,\<br />									SQL_CURSOR_STATIC,0<br />						invoke SwitchMenuState,TRUE<br />					.else<br />						invoke MessageBox,hWnd,addr AllocStmtFail,addr AppName,MB_OK+MB_ICONERROR<br />					.endif<br />				.ELSEIF<br />					invoke SQLFreeHandle,SQL_HANDLE_DBC,hConn<br />					invoke SQLFreeHandle,SQL_HANDLE_ENV,hEnv<br />					invoke MessageBox,hWnd,addr ConnFail,addr AppName,MB_OK+MB_ICONERROR<br />				.endif<br />			.ELSE<br />				invoke SQLFreeHandle,SQL_HANDLE_ENV,hEnv<br />				invoke MessageBox,hWnd,addr AllocConnFail,addr AppName,MB_OK+MB_ICONERROR<br />			.endif<br />		.ELSE<br />			invoke SQLFreeHandle,SQL_HANDLE_ENV,hEnv<br />			invoke MessageBox,hWnd,addr SetAttrFail,addr AppName,MB_OK+MB_ICONERROR<br />		.endif<br />	.ELSE<br />		invoke MessageBox,hWnd,addr AllocEnvFail,addr AppName,MB_OK+MB_ICONERROR	<br />	.endif<br />	ret<br />ODBCConnect endp</code></pre><br />Read a new statement:<br /><pre><code>.IF ax==Button01ID ;Read<br />	invoke RtlZeroMemory,addr Conn,256<br />	invoke lstrcpy,addr Conn,addr SQLStatement ;&quot;select * from AngBiblia&quot;<br />	invoke GetWindowText,hCombobox01,ADDR SearchName,25<br />	.if eax!=0<br />		invoke GetWindowText,hEdit02,ADDR SearchVerse,25<br />		.if eax!=0<br />			invoke lstrcat,addr Conn,addr WhereStatement1 ;&quot; where books = '&quot;<br />			invoke lstrcat,addr Conn,addr SearchName<br />			invoke lstrcat,addr Conn,addr AndStatement ;&quot; and verse = '&quot;<br />			invoke lstrcat,addr Conn,addr SearchVerse<br />			invoke lstrcat,addr Conn,addr EndStatement ;&quot;'&quot;<br />		.else<br />			invoke lstrcat,addr Conn,addr WhereStatement1 ;&quot; where books = '&quot;<br />			invoke lstrcat,addr Conn,addr SearchName<br />			invoke lstrcat,addr Conn,addr EndStatement ;&quot;'&quot;<br />		.endif<br />	.else<br />		invoke GetWindowText,hEdit02,ADDR SearchVerse,25<br />		.if eax!=0<br />			invoke lstrcat,addr Conn,addr WhereStatement2 ;&quot; where verse = '&quot;<br />			invoke lstrcat,addr Conn,addr SearchVerse<br />			invoke lstrcat,addr Conn,addr EndStatement ;&quot;'&quot;<br />		.endif<br />	.endif<br />	invoke lstrlen,addr Conn<br />	.IF ax==0<br />		invoke MessageBox,hWnd,addr NoData,addr AppName,MB_OK+MB_ICONERROR<br />		invoke SetFocus,eax<br />	.ELSE<br />		invoke SetWindowText,hEdit01,NULL<br />		invoke lstrlen,addr Conn<br />		invoke SQLExecDirect,hStmt,addr Conn,eax<br />		invoke SQLBindCol, hStmt,1,SQL_C_CHAR, addr TheBook, sizeof TheBook,addr TextLength<br />		invoke SQLBindCol, hStmt,2,SQL_C_CHAR, addr TheVerse, sizeof TheVerse,addr TextLength<br />		invoke SQLBindCol, hStmt,3,SQL_C_CHAR, addr TheText, sizeof TheText,addr TextLength<br />		invoke SQLBindCol, hStmt,4,SQL_C_SLONG, addr TheID, 0,addr TextLength<br />		invoke SQLFetch, hStmt<br />		.if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />			invoke SetWindowText,hEdit01, addr TheText<br />		.else<br />			invoke SetWindowText,hEdit01, addr TheError	<br />		.endif<br />	.endif</code></pre><br /><br />Scrolling:<br /><pre><code>.ELSEIF ax==Button03ID ;Previous	<br />	invoke SQLFetchScroll,hStmt,SQL_FETCH_PRIOR,0<br />	.if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />		invoke SetWindowText,hEdit01, addr TheText<br />		invoke SetWindowText,hEdit02, addr TheVerse<br />	.else<br />		invoke SetWindowText,hEdit01, addr TheError	<br />	.endif<br />.ELSEIF ax==Button04ID	;Next<br />	invoke SQLFetchScroll,hStmt,SQL_FETCH_NEXT,0<br />	.if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />		invoke SetWindowText,hEdit01, addr TheText<br />		invoke SetWindowText,hEdit02, addr TheVerse<br />	.else<br />		invoke SetWindowText,hEdit01, addr TheError	<br />	.endif</code></pre><br /><br />Regards</div>
    <div class="meta">Posted on 2003-11-26 04:54:33 by minor28</div>
   </div>
   <div class="post" id="post-125665">
    <div class="subject"><a href="#post-125665">SQL in ASM</a></div>
    <div class="body">hi minor28,<br /><br />Thank you!you give me an idea but i encounter a problem in READ button after I<br /> click the button the query is ok but if i change the value in Edit02 which is the verse the code always jump  to TheError message.<br /><br /><br /><br />regards,<br />coredump</div>
    <div class="meta">Posted on 2003-11-26 21:23:04 by coredump</div>
   </div>
   <div class="post" id="post-125690">
    <div class="subject"><a href="#post-125690">SQL in ASM</a></div>
    <div class="body">Add this.<pre><code>.IF ax==Button01ID ;Read<br />	invoke SQLFreeStmt,hStmt,SQL_CLOSE</code></pre><br />Regards</div>
    <div class="meta">Posted on 2003-11-27 01:29:00 by minor28</div>
   </div>
   <div class="post" id="post-125709">
    <div class="subject"><a href="#post-125709">SQL in ASM</a></div>
    <div class="body">thank you.the Next and Previous button also have a error message <br />Record not found<br /><br /><br /><br /><br /><br /><br />regards,<br />coredump</div>
    <div class="meta">Posted on 2003-11-27 03:01:40 by coredump</div>
   </div>
   <div class="post" id="post-125714">
    <div class="subject"><a href="#post-125714">SQL in ASM</a></div>
    <div class="body">The &quot;SQLFreeStmt&quot; closes the statement and the cursor before a new statement is executed which result in a recordset depending on where parameters. For example &quot;Select * from AngBiblia where verse = '1:18'&quot; give you a recordset of one row. If you push the next button (or the previous button) there are no more rows to goto. Therefore the error message &quot;Record not found&quot;. It is actually not an error it only tells you either the end or start of the recordset. I you don't want the error message you have to change your code to detect the start and the end of the recordset.</div>
    <div class="meta">Posted on 2003-11-27 04:17:13 by minor28</div>
   </div>
   <div class="post" id="post-125813">
    <div class="subject"><a href="#post-125813">SQL in ASM</a></div>
    <div class="body">hi minor28,<br /><br />Thank you.. i will try to find the problem...<br /><br /><br /><br /><br /><br /><br /><br /><br />regards,<br />coredump</div>
    <div class="meta">Posted on 2003-11-28 02:57:42 by coredump</div>
   </div>
   <div class="post" id="post-125849">
    <div class="subject"><a href="#post-125849">SQL in ASM</a></div>
    <div class="body">coredump, what's your problem?<br /><pre><code>.ELSEIF ax==Button03ID ;Previous	<br />	invoke SQLFetchScroll,hStmt,SQL_FETCH_PRIOR,0<br />	.if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />		invoke SetWindowText,hEdit01, addr TheText<br />		invoke SetWindowText,hEdit02, addr TheVerse<br />	.elseif ax==SQL_NO_DATA<br />		invoke SetWindowText,hEdit01, addr BOF ;.data	BOF	db &quot;Beginning of file&quot;,0	<br />	.else ;e.i. SQL_STILL_EXECUTING, SQL_ERROR, or SQL_INVALID_HANDLE<br />		invoke SetWindowText,hEdit01, addr TheError	<br />	.endif<br />.ELSEIF ax==Button04ID	;Next<br />	invoke SQLFetchScroll,hStmt,SQL_FETCH_NEXT,0<br />	.if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />		invoke SetWindowText,hEdit01, addr TheText<br />		invoke SetWindowText,hEdit02, addr TheVerse<br />	.elseif ax==SQL_NO_DATA<br />		invoke SetWindowText,hEdit01, addr EOF ;.data	EOF	db &quot;End of file&quot;,0	<br />	.else ;e.i. SQL_STILL_EXECUTING, SQL_ERROR, or SQL_INVALID_HANDLE<br />		invoke SetWindowText,hEdit01, addr TheError	<br />	.endif</code></pre></div>
    <div class="meta">Posted on 2003-11-28 15:08:20 by minor28</div>
   </div>
   <div class="post" id="post-125866">
    <div class="subject"><a href="#post-125866">SQL in ASM</a></div>
    <div class="body">hi minor28,<br /><br />Thanks.<br /><br /><pre><code>&#91;size=9&#93;.ELSEIF ax==Button04ID	;Next<br />invoke SQLFetchScroll,hStmt,SQL_FETCH_NEXT,0<br />   .if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />        invoke SetWindowText,hEdit01, addr TheText<br />        invoke SetWindowText,hEdit02, addr TheVerse<br />   .elseif ax==SQL_NO_DATA<br />        invoke SetWindowText,hEdit01, addr EOF ;.data	EOF	db &quot;End of file&quot;,0	<br />   .else ;e.i. SQL_STILL_EXECUTING, SQL_ERROR, or SQL_INVALID_HANDLE<br />        invoke SetWindowText,hEdit01, addr TheError	<br />   .endif&#91;/SIZE&#93;</code></pre><br /><br />if the Statement or the query is SQL_SUCCESS or SQL_SUCCESS_WITH_INFO<br />it will display the query result to hEdit01 and hEdit02 and if the query is <br />SQL_NO_DATA it will display the EOF of BOF but if the query has a problem or error<br />it will display in hEdit01 the value of TheError. My problem is there is a problem <br />in query because it always jump to the TheError. so it means to say that the <strong>ax</strong> is not equal to SQL_SUCCESS,SQL_SUCCESS_WITH_INFO AND SQL_NO_DATA.<br /><br /><br />Thanks in advanced<br /><br /><br /><br />regards,<br />coredump</div>
    <div class="meta">Posted on 2003-11-28 18:59:10 by coredump</div>
   </div>
   <div class="post" id="post-125900">
    <div class="subject"><a href="#post-125900">SQL in ASM</a></div>
    <div class="body">Is this what is happen?<br /><br />1) your connection is SQL_SUCCESS<br />2) your Read is SQL_SUCCESS and the first row of the recordset is shown in editbox.<br />3) pushing next or previous button is SQL_ERROR.<br /><br />If this is the situation the only thing I can think of is that you close the cursor in the read process. The cursor must be open as long as you are working with the recordset.<br /><br />If your connection is OK but the Read is not OK then your SQL statement is wrong.</div>
    <div class="meta">Posted on 2003-11-29 09:58:38 by minor28</div>
   </div>
   <div class="post" id="post-126060">
    <div class="subject"><a href="#post-126060">SQL in ASM</a></div>
    <div class="body">hi minor28,<br /><br />Good day!<br /><br />I change the SQL statement to &quot;select * from table&quot; in order to have all<br />records in the database.The program will display the first record in the database.<br />The Next button is now running but after pressing the Next button the previous<br />button cannot go back to the previous records.always jump to TheError message.<br /><br /><pre><code><br />&#91;size=9&#93;<br />.ELSEIF ax==Button03ID ;Previous<br />    invoke SQLFetchScroll,hStmt,SQL_FETCH_PRIOR,0<br />    .if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />           invoke SetWindowText,hEdit01, addr TheText<br />           invoke SetWindowText,hEdit02, addr TheVerse<br />    .elseif ax==SQL_NO_DATA<br />           invoke SetWindowText,hEdit01, addr BOF<br />    .else ;e.i. SQL_STILL_EXECUTING, SQL_ERROR, or SQL_INVALID_HANDLE<br />           invoke SetWindowText,hEdit01, addr TheError	<br />    .endif<br />.ELSEIF ax==Button04ID	;Next<br />invoke SQLFetchScroll,hStmt,SQL_FETCH_NEXT,0<br />    .if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />           invoke SetWindowText,hEdit01, addr TheText<br />           invoke SetWindowText,hEdit02, addr TheVerse<br />    .elseif ax==SQL_NO_DATA<br />           invoke SetWindowText,hEdit01, addr EOF 	<br />    .else ;e.i. SQL_STILL_EXECUTING, SQL_ERROR, or SQL_INVALID_HANDLE<br />           invoke SetWindowText,hEdit01, addr TheError	<br />    .endif<br />&#91;/size&#93;<br /></code></pre><br /><br />btw, Thank you so much..<br /><br />regards,<br />coredump</div>
    <div class="meta">Posted on 2003-11-30 20:27:02 by coredump</div>
   </div>
   <div class="post" id="post-126068">
    <div class="subject"><a href="#post-126068">SQL in ASM</a></div>
    <div class="body">Hello Wayne minor28,<br /><br />you got it!!! Thank you,,... i review all post reply today.. and i read your<br />reply..thank you...<br /><br /><br /><br />Regards,<br />coredump</div>
    <div class="meta">Posted on 2003-11-30 22:53:29 by coredump</div>
   </div>
   <div class="post" id="post-126093">
    <div class="subject"><a href="#post-126093">SQL in ASM</a></div>
    <div class="body">hi all,<br /><br />i create a FillDataList proc which will call if the search button will click<br />the statement is &quot;select * from table where text like '%word%' &quot;. all result<br />will fill in the listview with the columns  books and verse.the program can add the books<br />but the problem is the verse i cannot see the verse in listview only the last result <br />of the query in verse can show in the listview.<br /><br />what do you think the problem?<br /><br /><br /><br /><pre><code><br />FillDataList proc<br />	LOCAL row&#58;DWORD<br />	LOCAL lvi&#58;LV_ITEM<br />	<br />	invoke SQLBindCol, hStmt,1,SQL_C_CHAR, addr TheBook, sizeof TheBook,addr TextLength<br />	invoke SQLBindCol, hStmt,2,SQL_C_CHAR, addr TheVerse, sizeof TheVerse,addr TextLength<br />	invoke SQLBindCol, hStmt,3,SQL_C_CHAR, addr TheText, sizeof TheText,addr TextLength<br />	invoke SQLBindCol, hStmt,4,SQL_C_SLONG, addr TheID, 0,addr TextLength<br />	mov row,0<br />	.while TRUE<br />		mov byte ptr ds&#58;&#91;TheBook&#93;,0<br />		mov byte ptr ds&#58;&#91;TheVerse&#93;,0<br />		mov byte ptr ds&#58;&#91;TheText&#93;,0<br />		mov byte ptr ds&#58;&#91;TheID&#93;,0<br />		invoke SQLFetch, hStmt<br />		.if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />			mov lvi.imask,LVIF_TEXT+LVIF_PARAM<br />			push row<br />			pop lvi.iItem	<br />			mov lvi.iSubItem,0<br />			mov lvi.pszText, offset TheBook<br />			push row<br />			pop lvi.lParam<br />			invoke SendMessage,hList, LVM_INSERTITEM,0, addr lvi<br />			mov lvi.imask,LVIF_TEXT<br />			inc lvi.iSubItem<br />			mov lvi.pszText,offset TheVerse<br />			invoke SendMessage,hList,LVM_SETITEM, 0,addr lvi<br />			inc row<br />		.else<br />			.break<br />		.endif<br />	.endw<br />	ret<br /><br />FillDataList endp<br /><br /><br /></code></pre></div>
    <div class="meta">Posted on 2003-12-01 03:47:28 by coredump</div>
   </div>
   <div class="post" id="post-126108">
    <div class="subject"><a href="#post-126108">SQL in ASM</a></div>
    <div class="body">This should work<br /><pre><code>invoke SQLFetchScroll,hStmt,SQL_FETCH_NEXT,0<br />.if ax==SQL_SUCCESS || ax==SQL_SUCCESS_WITH_INFO<br />	mov lvi.imask,LVIF_TEXT<br />	push row<br />	pop lvi.iItem	<br />	mov lvi.iSubItem,0<br />	mov lvi.pszText, offset TheBook<br />	invoke SendMessage,hList, LVM_INSERTITEM,0, addr lvi<br />	inc lvi.iSubItem<br />	mov lvi.pszText,offset TheVerse<br />	invoke SendMessage,hList,LVM_SETITEM, 0,addr lvi<br />.else</code></pre><br /><br />Best regards<br /><br />Edit: Don't forget the first item</div>
    <div class="meta">Posted on 2003-12-01 05:36:53 by minor28</div>
   </div>
   <div class="post" id="post-126110">
    <div class="subject"><a href="#post-126110">SQL in ASM</a></div>
    <div class="body">hi minor28,<br /><br />Thank you so much. it works!!!<br /><br />this forum is great!!! <br /><br /><br />Thank you to all ASM coders..<br /><br /><br /><br /><br />regards,<br />coredump</div>
    <div class="meta">Posted on 2003-12-01 05:52:31 by coredump</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=16073&amp;page=1" style="">&laquo;</a><a href="../?id=16073&amp;page=2" style="">&lt;</a><input type="hidden" name="id" value="16073" /><input type="number" name="page" min="1" max="4" step="1" value="3" onchange="this.form.submit();" /><a href="../?id=16073&amp;page=4">&gt;</a><a href="../?id=16073&amp;page=4">&raquo;</a></form>  </div>
 </body>
</html>