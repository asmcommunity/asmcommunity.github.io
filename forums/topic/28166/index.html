<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Visual Basic & In-line Assembly - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=28166" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=28166">Visual Basic & In-line Assembly</a></p>
   <div class="post" id="post-199682">
    <div class="subject"><a href="#post-199682">Visual Basic & In-line Assembly</a></div>
    <div class="body">This is the second post of this question,
rewritten to make it clearer.

I am attempting to use in-line assembly within my VB apps
WITHOUT the use of COM files, DLLs etc.

Certain interrupts work, others don't.
(ie BIOS 'Get Time' Interrupt works,
DOS 'Get Time' Interrupt doesn't).

Following is the assembler code I use to execute the BIOS 'Get Time' Interrupt.

push ebp
mov ebp, esp
push ebx
mov ebx, 
mov al, 
cmp al, 1Ah
jne GETOUT
mov ah, 
int 1Ah
mov , ch
mov , cl
mov , dh
mov ,dl
pop ebx
mov esp, ebp
pop ebp
ret 16

I store the machine code equivalent of the above in a Visual Basic byte array.

The above code is executed in a standard VB module and
displays the result every 1/2 second.

As I stated before this BIOS time routine works flawlessly.

I use similar code to execute the DOS 'Get Time' Interrupt but get a GPF when it executes.



Any help would be greatly appreciated.</div>
    <div class="meta">Posted on 2001-05-24 15:22:00 by mms</div>
   </div>
   <div class="post" id="post-199683">
    <div class="subject"><a href="#post-199683">Visual Basic & In-line Assembly</a></div>
    <div class="body">You can't use real mode interrupts in windows.  You can however if you go through a VxD.</div>
    <div class="meta">Posted on 2001-05-24 16:58:00 by Jon Richardson</div>
   </div>
   <div class="post" id="post-199684">
    <div class="subject"><a href="#post-199684">Visual Basic & In-line Assembly</a></div>
    <div class="body">---------------------------------------------
to Jon Richardson

Any pointers as to how I go about doing that?


---------------------------------------------
to disease_2000

I set up a Sub in which I load the code thus:

Dim MachineCode(1 To 37) As Byte

<pre><code>
MachineCode(1) = &H55    'push ebp

MachineCode(2) = &H89    'mov ebp, esp
MachineCode(3) = &HE5

MachineCode(4) = &H53    'push ebx

MachineCode(5) = &H8B    'mov ebx, 
MachineCode(6) = &H5D    
MachineCode(7) = &H8

etc.
</code></pre>

Then in the body of my main program I call the Sub</div>
    <div class="meta">Posted on 2001-05-25 07:23:00 by mms</div>
   </div>
   <div class="post" id="post-199685">
    <div class="subject"><a href="#post-199685">Visual Basic & In-line Assembly</a></div>
    <div class="body"><pre><code>
 thanx MMS.

 wow, so simple that it blinded me from knowing. with that, i now
 accept that assembly is powerful!

 farewell
</code></pre></div>
    <div class="meta">Posted on 2001-05-27 19:32:00 by disease_2000</div>
   </div>
   <div class="post" id="post-199686">
    <div class="subject"><a href="#post-199686">Visual Basic & In-line Assembly</a></div>
    <div class="body">No, not off the top of my head I don't know how to.  I've seen it done before.  If I can find the source i'll let you know.  Check out Iczelions tuts on VxD programming though.</div>
    <div class="meta">Posted on 2001-05-28 00:02:00 by Jon Richardson</div>
   </div>
  </div>
 </body>
</html>