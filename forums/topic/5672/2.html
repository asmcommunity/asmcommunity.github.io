<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>anti-debug tricks  ?? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5672" />
  <link rel="prev" href="../?id=5672&amp;page=1" />  <link rel="next" href="../?id=5672&amp;page=3" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5672">anti-debug tricks  ??</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=5672&amp;page=1" style="">&laquo;</a><a href="../?id=5672&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="5672" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=5672&amp;page=3">&gt;</a><a href="../?id=5672&amp;page=3">&raquo;</a></form>   <div class="post" id="post-42307">
    <div class="subject"><a href="#post-42307">anti-debug tricks  ??</a></div>
    <div class="body"><div class="quote"><br />Best and only non-crackable protection:<br /><br /><strong>CRIPPLEWARE</strong> </div><br /><br />Lol. I've seen crackers go to the length of adding code to programs, in order to crack them. And we're not talking small amounts, but functions that were removed from the program.<br /><br />Crippleware is not a bad idea, but many typically use it badly (as in: function is still present in the file, just disabled)<br /><br />Regards<br />Fake</div>
    <div class="meta">Posted on 2002-06-10 05:57:52 by Fake51</div>
   </div>
   <div class="post" id="post-42315">
    <div class="subject"><a href="#post-42315">anti-debug tricks  ??</a></div>
    <div class="body"><div class="quote"><br />And then sombody buys the full version and mass distributes it on Kazaa.<br /><br />You can't win.  :)  :( </div><br /><br />Well, I do :)<br />I've written a program wich compiles my application individual for each customer. This program generates a 256bit hash of the licence key, the full name, the full address and the e-mail address and stores it multiple times in the compiled exe (splitted up in several parts). <br /><br />So I just need to load the exe I found on Kazaa (wich sucks! use edonkey, man! :) ) in my &quot;ReadOut&quot; app, get the checksum (they can't delete it. Even if they try to :) ) and compare it to the checksums stored in my customer database. Then I just send my lawyer the information and my Job is done.<br />BTW, my &quot;auto-compile&quot; program also move's the procs and declarations in the source code around. So even compiling two times with the same checksum to be inserted produces different files. That's my way to prevent two users from just comparing their registered exe files and override all differences with 00h :)<br /><br />And please don't say &quot;this is to much work&quot;. If I update the program, I just select the database, the source code and press the &quot;Start Batch&quot; button. Then I wait a couple of minutes and get the ready2send zip files.... unique for each customer.<br /><br />Just a question of organization....<br /><br /><br />regards,<br />bAZiK</div>
    <div class="meta">Posted on 2002-06-10 06:26:36 by bazik</div>
   </div>
   <div class="post" id="post-42318">
    <div class="subject"><a href="#post-42318">anti-debug tricks  ??</a></div>
    <div class="body"><div class="quote"><br /><br /><br />Lol. I've seen crackers go to the length of adding code to programs, in order to crack them. And we're not talking small amounts, but functions that were removed from the program.<br /><br />Crippleware is not a bad idea, but many typically use it badly (as in: function is still present in the file, just disabled)<br /><br />Regards<br />Fake </div><br /><br />My main Application is a managing system for bookstores. I sell it for ? 300 per licence (that's  $ 283.47  :) ) and sold about 50 licences yet. I really don't think, it's worth reverse engineer this application ;)<br /><br />And trust me... I am still young (huh!) and also have a &quot;h4x0r&quot; past... is AmoK a name you recognize? :)<br />Anyway, with the knowledge I gained there, it IS possible to write *uncrackable* Applications. <br /><br />Hehe, I can tell you one nice trick I use in the program to prevent them from just copying it to another computer: I read out hardware information... including the Barcode reader they use for adding the books to the list... :grin: :grin: :grin:</div>
    <div class="meta">Posted on 2002-06-10 06:36:25 by bazik</div>
   </div>
   <div class="post" id="post-42326">
    <div class="subject"><a href="#post-42326">anti-debug tricks  ??</a></div>
    <div class="body">thats what most protectors do... reading informations<br />out off your computer and stuff, however, everythings<br />crackable. your little protection scheme isn't as strong<br />as ... say flexLM and it HAS been cracked succesfully.<br />sure, checksums and some unique info can't be wrong<br />but we're talking about mass-compatible distributed<br />software so you can't make it THAT strong like you do<br />when coding a reverse-me or something like that...<br />i never heard about a uncrackable protection scheme<br />and i don't thing this will change in future.</div>
    <div class="meta">Posted on 2002-06-10 06:52:45 by mob</div>
   </div>
   <div class="post" id="post-42327">
    <div class="subject"><a href="#post-42327">anti-debug tricks  ??</a></div>
    <div class="body"><div class="quote"><br />i never heard about a uncrackable protection scheme<br />and i don't thing this will change in future. </div><br /><br />uncrackable doesnt exist as far as i'm concerned.<br /><br />the trick is to make it so difficult to crack its just easier and cheaper to buy my original version :-)<br /><br />and you can make something darn difficult to crack if you try. on one of my apps it got a bit out of hand, even with the source code I was struggling to get the thing to run after a small modification.....<br /><br />imagine not having the commented source - aarrrgggghhhh   just buy the thing :)</div>
    <div class="meta">Posted on 2002-06-10 06:59:08 by Terab</div>
   </div>
   <div class="post" id="post-42331">
    <div class="subject"><a href="#post-42331">anti-debug tricks  ??</a></div>
    <div class="body">There are ways to make a program harder to crack - but one has to realize that cracking can be done in many different ways.<br /><br />Best protection I've heard of is still IDA's - noone broke it, but it still got around. Funny thing is, it too was watermarked, but people figured out how to remove the marks.<br /><br />There's different ways to go about the job, one of which is to make sure only a limited amount of people are interested in your software ;)<br /><br />Point to the story is: if it'll run, it'll crack right open. Just a matter of time. And this is where the programmer should consider how much time she/he wants to spend in protecting the program:<br />- the time spent on protections could perhaps be spent on further development of the program, adding extra functionality and stuff like that, thus perhaps attracting extra customers<br />- chances are what you're gonna do (in way of protection) has been done before, and is described somewhere on the net. Thus, you risk using much time on something that won't take long to crack.<br /><br />I'm not saying that people shouldn't protect their stuff, just saying it'll always be a trade-off. Plus, there is ofcourse the odd chance, that if you come up with something really new, your program will be a hot target ;)<br /><br /><br />Fake</div>
    <div class="meta">Posted on 2002-06-10 07:23:04 by Fake51</div>
   </div>
   <div class="post" id="post-42398">
    <div class="subject"><a href="#post-42398">anti-debug tricks  ??</a></div>
    <div class="body">I agree with Terab, the best thing to do is make two versions of the code:<br />1) Fully comented for registerd user<br />2) Another coded in some kind of overbloated interpreter, using &quot;spaguetti&quot; logic, and bad-programming habits (it?s very difficult sometimes ;) though), for the share-ware version... that can be a nightmare to crack :)<br /><br />And to AmoK, I mean bAZiK, is it some kind of watermarking that you use?</div>
    <div class="meta">Posted on 2002-06-10 12:01:35 by slop</div>
   </div>
   <div class="post" id="post-42412">
    <div class="subject"><a href="#post-42412">anti-debug tricks  ??</a></div>
    <div class="body"><div class="quote"><br /><br />And to AmoK, I mean bAZiK, is it some kind of watermarking that you use? </div><br /><br />LOL!<br /><br />No, it isn't :)</div>
    <div class="meta">Posted on 2002-06-10 13:05:53 by bazik</div>
   </div>
   <div class="post" id="post-42416">
    <div class="subject"><a href="#post-42416">Emulation</a></div>
    <div class="body">Hi;<br />Everything is crackable on this world or this cosmos. Maybe not in century or this life :) but just crackable. <br />If you want to make your softwares protection harder just make your CPU emulation and use your codes. :alright: <br />A cracker if he/she is not crazy :) doesn't try to write an emulator for your own CPU. And if he/she try and write one this not effect your trade. coz u ll be already earn enough money from this software and u can change your CPU code or architect easily :)<br />but just know if you write a simple code this is not protect nothing. <br />This is just my idea, i share it with you. Maybe it helped.<br /><br />Regards</div>
    <div class="meta">Posted on 2002-06-10 13:16:03 by RvaZero</div>
   </div>
   <div class="post" id="post-42426">
    <div class="subject"><a href="#post-42426">anti-debug tricks  ??</a></div>
    <div class="body">bAZiK, may the source be with you too ;)<br /><br />If it?s not watermarking, what, some kind of CRC?<br /><br />RvaZero, yes, nice idea.<br />I was thinking of doing it with Knut?s pseudo-asm?<br />I'd be fun, and better: don?t have to translate the algos :)<br /><br />:)</div>
    <div class="meta">Posted on 2002-06-10 14:16:44 by slop</div>
   </div>
   <div class="post" id="post-49081">
    <div class="subject"><a href="#post-49081">anti-debug tricks  ??</a></div>
    <div class="body"><strong>bitRAKE</strong> , will using your code like this do me any good.  I am coming off of a .if button press statement.  Than want to do your code and jump to a PROC call... If this do help can i NOT  use the jmp ToNothing.... It working but i don't know if it really helping the way i am trying to do it..........also what are these values for... 0C201F083h...090900008h......<br /><br /><em>Thanks</em> <br /><br />pop eax <br />pop edx<br />pop ecx<br />push esp xchg ,eax<br />push 0 <br />push DWORD PTR <br />push DWORD PTR <br />push ecx <br />push edx<br /> push eax<br />mov DWORD PTR ,0C201F083h <br />mov DWORD PTR ,090900008h<br />jmp ToNothing<br /><br />Nothing:<br /><br />CALL MyProcedure <br /><br /><br />.endif</div>
    <div class="meta">Posted on 2002-07-20 23:29:44 by cmax</div>
   </div>
   <div class="post" id="post-49089">
    <div class="subject"><a href="#post-49089">anti-debug tricks  ??</a></div>
    <div class="body"><strong>cmax</strong>, those value are x86 instructions.  They are put on the stack and the address for them is put on the stack so that ReadFile will return to the stack!<pre><code>StreamInProc&#58;<br />	pop eax ; old return address<br />	pop edx<br />	pop ecx<br />	push esp ; new return address!!<br />	xchg &#91;esp&#93;,eax<br />	push 0<br />	push DWORD PTR &#91;eax+4&#93;<br />	push DWORD PTR &#91;eax&#93;<br />	push ecx<br />	push edx<br />	push eax ; return to stack memory!!<br />	; This is x86 code put on the stack&#58;<br />	;	xor eax,1<br />	;	ret 8<br />	;	nop<br />	;	nop<br />	mov DWORD PTR &#91;esp+&#40;4*7&#41;&#93;,0C201F083h<br />	mov DWORD PTR &#91;esp+&#40;4*8&#41;&#93;,090900008h<br />	jmp ReadFile</code></pre>This code is to stream in data to a RichEdit control - it is just an example of what is possible when you want to make sections of code hard to trace.  Using this code for something else doesn't help you much.  You have to use the technique - like a metaphor - aply it to your own code, but not directly.  I will do what I can to help you understand.</div>
    <div class="meta">Posted on 2002-07-21 02:14:59 by bitRAKE</div>
   </div>
   <div class="post" id="post-49093">
    <div class="subject"><a href="#post-49093">anti-debug tricks  ??</a></div>
    <div class="body">I think a good protection is what I described in two posts, that I report here:<br /><br />---<br /><br />If I can give you a quite obvious advice (I do so because other people here, beginners, may read too, and I've seen a problem in this regard many times) the best thing to do would be to make many check routines.. not just one. Cracking 10 of them is harder than cracking 1 of them. What about 1000? You (cr?cker) have to find them anyway, and remove them all. 1000 take some serious time. But one must not use the same code for all 1000, otherwise a simple pattern matching will find and remove all of them in one shot. Here having your own compiler helps a lot, I reckon. <br />Also, crypting your EXE (with your own crypter, not a standard/known one) and making use of self-modifying code to generate these check routines sure helps..<br />CRC-32 has been cracked anyway, so one should find a more secure algorithm (what about making your own? unknown algorithms are harder to cr?ck..  ), otherwise storing the checksum in a single DWORD becomes then the weak point..<br /><br />I can't disclose too many brainfarting ideas here.. but in my experience the above if applied correctly is enough for most situations. The hardest part is about EXE crypting and having your own protection_code generator (compiler) to avoid to write by hand 1000 original, sufficiently_different check routines.<br /><br />Also, be careful about the extreme weakness of standard solutions like CRC-32.<br /><br />---<br /><br />There's an inherent problem, though, which will be difficult to solve with standard tools.<br /><br />Even if you don't use a known CRC algo, the cracker can reverse engineer one single of your 1000 check routines, and thus deduce from the algorithm an &quot;acceptable&quot; checksum value and store it in the PE.. fooling the other 999 checkpoints.<br />So what will really work is to store the checksums 1000 times, i.e. in each of the check routines, as (obfuscated) immediate values. Then it will be *really* necessary (for any cr?cker) to cr?ck them all, one by one (assuming you don't make all of them identical, making them prone to a easy pattern matching attack).<br /><br />It's clear that you'll have to insert these 1000 immediate values (making sure they aren't all the same, otherwise finding them will be very easy.. you can add to them their current address, for example, or use a more sophisticated method) after you've assembled your program, and this thing is not trivial, at least with the usual tools.<br /><br />One thing you could make is to disseminate in your asm source code one-line statements like &quot;PROTECT&quot;, possibly not in your hyperoptimized gfx innerloops. :D<br />Then write an utility that gets in input your source file + PROTECT statements, and &quot;compiles&quot; them.. giving in output a pure asm sourcecode (a compiler, ain't it  ).<br />Then you assemble it, and produce a PE. The assembler outputs on a separate file the list of memory locations corresponding to the immediate value used by each protection statement. A final utility calculates the &quot;CRC&quot; and patches all of these immediate values I just mentioned. <br /><br />Here the advantage of having your own assembler/compiler is clear: you can extend it with functionality like the above, i.e. output the precise memory location that will need to be patched.. and state which kind of patching will it need (i.e. how to crypt that value).<br /><br />It's true that standard assemblers are uncapable of such flexibility, but short of writing your own assembler/compiler, you could modify FASM sourcecode, for example, to extend any special functionality you require.<br /><br />This is just one example of what I meant every time I stressed that having your own development tools is extremely useful and important, let away productive.</div>
    <div class="meta">Posted on 2002-07-21 02:52:49 by Maverick</div>
   </div>
   <div class="post" id="post-49261">
    <div class="subject"><a href="#post-49261">anti-debug tricks  ??</a></div>
    <div class="body">Thanks alot   <strong>bitRAKE</strong>  and  <strong> Maverick </strong>  i guest i got to get more serious now.  I might as well face it, learn this will take some time.  One question about FASM.... Do it support Un-Initized Data... all i see is an .data section and in my project i do not want to use a .data section...I don't have one at all right now and i would like to have that with FASM if i was to start learning FASM or another assembler.<br /><br /><span style="font-size:9px>These are the best ideas i hear so far as far as protection...I got to read the Intel Manual...</span> Thanks Guys</div>
    <div class="meta">Posted on 2002-07-22 01:56:24 by cmax</div>
   </div>
   <div class="post" id="post-49263">
    <div class="subject"><a href="#post-49263">anti-debug tricks  ??</a></div>
    <div class="body"><div class="quote"><br />One question about FASM.... Do it support Un-Initized Data... </div><br /><br />Yes. :)</div>
    <div class="meta">Posted on 2002-07-22 02:17:13 by bazik</div>
   </div>
   <div class="post" id="post-49267">
    <div class="subject"><a href="#post-49267">anti-debug tricks  ??</a></div>
    <div class="body"><strong>a - OK</strong><br /><br />Cash me in</div>
    <div class="meta">Posted on 2002-07-22 02:32:24 by cmax</div>
   </div>
   <div class="post" id="post-113930">
    <div class="subject"><a href="#post-113930">anti-debug tricks  ??</a></div>
    <div class="body">not *everything* is crackable,<br /><br />consider the encryption scheme, &quot;one time pad&quot; (<a target="_blank" href="http://searchsecurity.techtarget.com/gDefinition/0,294236,sid14_gci213673,00.html">http://searchsecurity.techtarget.com/gDefinition/0,294236,sid14_gci213673,00.html</a>). it is *uncrackable*.<br /><br />it could be used to encrypt the data on a per-client basis, such that<br />they can only decrypt &quot;full-version&quot; areas with their &quot;license key&quot;.<br /><br />if we assume that the client will not be aware of our random number generation<br />techniques, it is *impossible* for him to crack the code.</div>
    <div class="meta">Posted on 2003-08-14 22:15:58 by abc123</div>
   </div>
   <div class="post" id="post-113936">
    <div class="subject"><a href="#post-113936">anti-debug tricks  ??</a></div>
    <div class="body">Not sure i shoul'd post this since i have a litle experience<br /><br />Long time ago I've coded some protection for old 8bit box.<br />It wasn't easy, but it stops *every* debugger and some hardware crackers<br />Because <strong>it has full access to hardware and all the memory was used</strong><br /><br />On current multitasking OS (windos) i have no good ideas of protecting ring3 code w/o using KMD. <br /><br />As RvaZero said, &quot;just make your CPU emulation and use your codes. &quot;<br />Just let it be executed only with your KMD (no need for exe be really PE?)<br /><br />But even such protection can fail, it just can give some problems for debugging/tracking for them<br />who don't now much about ring0 programing (like me :grin: )<br />(what about XP protection?)<br /><br />And some protection mechanism (like encripting all the .exe) will slow down program since <br />NT maps files to memory instead of load them.<br /><br />P.S. my protection nowadays is easely crackeable with current PC and emulator of that old box :o</div>
    <div class="meta">Posted on 2003-08-15 00:15:36 by S.T.A.S.</div>
   </div>
   <div class="post" id="post-113937">
    <div class="subject"><a href="#post-113937">anti-debug tricks  ??</a></div>
    <div class="body">It's interesting how a thread can resurrect a year after it dies.</div>
    <div class="meta">Posted on 2003-08-15 00:31:24 by iblis</div>
   </div>
   <div class="post" id="post-113939">
    <div class="subject"><a href="#post-113939">anti-debug tricks  ??</a></div>
    <div class="body"><div class="quote"><br />It's interesting how a thread can resurrect a year after it dies. </div><br />initial question will live forever :alright:</div>
    <div class="meta">Posted on 2003-08-15 00:45:18 by S.T.A.S.</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=5672&amp;page=1" style="">&laquo;</a><a href="../?id=5672&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="5672" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=5672&amp;page=3">&gt;</a><a href="../?id=5672&amp;page=3">&raquo;</a></form>  </div>
 </body>
</html>