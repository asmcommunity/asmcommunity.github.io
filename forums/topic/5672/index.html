<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>anti-debug tricks  ?? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=5672" />
    <link rel="next" href="../?id=5672&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=5672">anti-debug tricks  ??</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=5672&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=5672&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="5672" /><input type="number" name="page" min="1" max="3" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=5672&amp;page=2">&gt;</a><a href="../?id=5672&amp;page=3">&raquo;</a></form>   <div class="post" id="post-40515">
    <div class="subject"><a href="#post-40515">anti-debug tricks  ??</a></div>
    <div class="body">Hello, hope all are fine.<br /><br />i have two qe. infact.<br /><br />First : i want a CD-Write program source code.<br />does any know any ??<br /><br />Second: I don't know if it is legal to mention it here .<br />i want to know a good ways to protect my program from crackers.<br />also i want to know anti-debug tricks , where can i find such . or could you plz share your experience ?<br /><br />to <strong>smurf</strong>:  I am <strong>Sorrryyyyy</strong> man I was so rude. I'm expressing my sorrow to you. hope you accept it .</div>
    <div class="meta">Posted on 2002-05-29 12:17:02 by Sa6ry</div>
   </div>
   <div class="post" id="post-40572">
    <div class="subject"><a href="#post-40572">anti-debug tricks  ??</a></div>
    <div class="body">I dunno if it's legal here either... but I can give you some ideas... if it isn't legal I wouldn't mind a moderator deleting this as long as I don't get deleted myself...<br /><br />Anyway...<br /><br />1) Self-modifying code can give a potential cracker quite a bit of a headache.<br />2) Try encrypting the code, and making the encrypter itself quite cryptic (jumps, compares that never get reached, etc.)<br />3) use bad programming habits (those things are hard to debug!)<br />4) Create a random data file, XOR it with the original code, and store the random data and the XOR'ed code somewhere.  To decrypt, XOR them again together and store the code into a code segment.</div>
    <div class="meta">Posted on 2002-05-29 21:02:57 by AmkG</div>
   </div>
   <div class="post" id="post-40599">
    <div class="subject"><a href="#post-40599">anti-debug tricks  ??</a></div>
    <div class="body">there are so many ways around to make cracking harder, but:<br /><br />1) if you use anti-debugging tricks, they get defeated. simply. only if you make really ****loads of code with anti-debugging, it will just slow down cracking<br /><br />2) if you use a good serial protection (strong encryption), your program will not be attacked on the serial, but it will be patched.<br /><br />protecting software from crackers is a waste of time imho, unless you have really a lot of time</div>
    <div class="meta">Posted on 2002-05-30 02:34:35 by roeldebikkel</div>
   </div>
   <div class="post" id="post-40603">
    <div class="subject"><a href="#post-40603">anti-debug tricks  ??</a></div>
    <div class="body">Guys,<br /><br />writing anti-cracking code or protection systems is a fully legitimate form of programming that is fully within the rules of this forum. While we will take a very dim view of any specifically cracking related code being posted here, as long as the questions and data are related directly to designing protection systems to slow down hacking, it is OK here.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-05-30 03:07:02 by hutch--</div>
   </div>
   <div class="post" id="post-40604">
    <div class="subject"><a href="#post-40604">anti-debug tricks  ??</a></div>
    <div class="body">I totally agree.<br />Even from the standpoint of a commercial programmer or software house, the notion of preventing cracking is flawed...<br /><br />The guys who go to the trouble of defeating simplistic protection mechanisms are not going to pay for the software, and they in fact help promote your software to those who WILL pay for it.<br /><br />Now we don't want EVERY MAN AND HIS DOG to have a freebie, and we should consider a separate compile for any demo rather than disabling functionality which could be re-enabled, but a few people running around with our software is not necessarily a bad thing from a marketing perspective.</div>
    <div class="meta">Posted on 2002-05-30 03:09:34 by Homer</div>
   </div>
   <div class="post" id="post-40615">
    <div class="subject"><a href="#post-40615">anti-debug tricks  ??</a></div>
    <div class="body">You can detect &quot;application level debuggers&quot; with 'IsDebuggerPresent&quot; API (Windows98+ &amp; Windows NT 4.0+)<br /><br />call IsDebuggerPresent<br /><br />eax = 0  &lt;- not running in the context of a debugger<br />eax != 0 &lt;- running in the context of a debugger<br /><br /><br />Try to 'hide' the call to this API ...<br /><br /><br /><br />Also more application debuggers simply die with SEH.<br /><br />There are lot of tricks more .. search the net.</div>
    <div class="meta">Posted on 2002-05-30 03:52:30 by hunter</div>
   </div>
   <div class="post" id="post-40619">
    <div class="subject"><a href="#post-40619">anti-debug tricks  ??</a></div>
    <div class="body">you can delete the debug registers and detect softice<br />in memory, there are 1000s of techniques out there.<br />maybe something like this is possible, i never saw it<br />before but i'm going to try it out sometime. <br /><br /><pre><code><br />- ask for password<br />- DEcrypt the code-block with the pw<br />- calculate new checksum on the c-block<br />- check if the  new crc matches the original one<br />- if no then quit<br />- jump to the DEcrypted code<br /><br />&#40;SEH FRAME START&#41;<br /><br />- the ENcrypted program code<br /><br />&#40;SEH FRAME ERROR HANDLER&#41;<br /><br />- quit<br /><br />&#40;SEH FRAME END&#41;<br /></code></pre><br /><br />(in this case even the seh frame is nonsense...)<br /><br />sure, the cracker can patch the crc check and the<br />prog will lead him to the code block, but with a wrong<br />pw the code should make no sense and will FOR SURE<br />crash.</div>
    <div class="meta">Posted on 2002-05-30 04:11:23 by mob</div>
   </div>
   <div class="post" id="post-40624">
    <div class="subject"><a href="#post-40624">anti-debug tricks  ??</a></div>
    <div class="body">mob, look at the &quot;Synchronize It! (WinSin)&quot; essay on my site.</div>
    <div class="meta">Posted on 2002-05-30 04:34:17 by f0dder</div>
   </div>
   <div class="post" id="post-40626">
    <div class="subject"><a href="#post-40626">anti-debug tricks  ??</a></div>
    <div class="body">Modify the return address of function calls!<br />If you then ever &quot;step over&quot; the call, the debugger will simply carry on going (until the next break point at least)!<br />Its a simple trick, but can annoy I'd suspect :)<br /><br />You could also use function calls as multiple option jumps if you worked out some complex (or not so complex ie table) system for holding the new return addresses.<br /><br />Mirno</div>
    <div class="meta">Posted on 2002-05-30 04:36:59 by Mirno</div>
   </div>
   <div class="post" id="post-40628">
    <div class="subject"><a href="#post-40628">anti-debug tricks  ??</a></div>
    <div class="body"><div class="quote"><br />mob, look at the &quot;Synchronize It! (WinSin)&quot; essay on my site.<br /></div><br /><br />i read your essay and i must say it was a very interesting read<br />but this demonstrates only that this method seems to be very<br />reliable if you take care of a few things (for example avoid these<br />last two bytes). mh i've got another idea that bases on the<br />first one, imagine this:<br /><br /><pre><code><br />- ask for password<br />- DEcrypt the code-block with the pw<br />- jump to the DEcrypted code<br /><br />&#40;SEH FRAME START&#41;<br /><br />    &#91;ENCRYPTED CODE-START&#93;<br />    ...<br />    ...<br />    ...<br />    return a value<br />    &#91;ENCRYPTED CODE-END&#93;<br /><br />    if we're here the code has been executed.<br />    so if the pw was wrong and still no exception<br />    occured &#40;besides i think thats impossible&#41; we <br />    can check the return value and know if the pw <br />    really was wrong &#40;because wrong Decrypted code<br />    will return a FALSE return-value&#41;<br /><br />&#40;SEH FRAME ERROR HANDLER&#41;<br /><br />    the code-block raised an exception,<br />    this means the pw was wrong -&gt; quit.<br /><br />&#40;SEH FRAME END&#41;<br /></code></pre><br /><br />first version<br />advantage - one can insert the whole prog code in the code-block<br />disadvantage - a few flaws (but can be fixed i think)<br /><br />2nd version<br />advantage - more secure (???)<br /><br />disabvantages:<br />- very dirty <br />- code block must be small<br />- uhh if a jump op is generated by the decryptor you have<br />  to wait until an exception occures...<br /><br />:o  damn... think the 1st one is better... :)</div>
    <div class="meta">Posted on 2002-05-30 05:03:22 by mob</div>
   </div>
   <div class="post" id="post-40663">
    <div class="subject"><a href="#post-40663">anti-debug tricks  ??</a></div>
    <div class="body">just want to give you some resources:<br /><br /><a target="_blank" href="http://www.anticrack.de">http://www.anticrack.de</a><br /><a target="_blank" href="http://daemon.anticrack.de">http://daemon.anticrack.de</a><br /><br />Most of the &quot;AntiCrack&quot; methods explained refers to the famous debugger &quot;S*CE&quot;.<br /><br />But is really IS a waste of time:<br /><br /> * packed exes can be unpacked with the use of a memory dumper<br /> * same thing with section-crypters<br /> * 99% of debugger-protections don't work if the cracker uses apps to hide his debugger<br /> * the rest of the protections can be patched<br /> * you can look for INT 3 (0CCh) that appears if a Breakpoint on execution appears but: breakpoint on memory-access can't be located this way.<br /> * etc.<br /><br />Maybe the best way is to leave out procedures that should not be available in the unregistered version. I have several ideas<br />to do this:<br /><br />* Use a DLL<br />* NOP your source-code that should not be available in the unregistered version and write it into a keyfile that the user who paid for your software will receive. That keyfile could contain user-information etc.<br />* make use of CRC!<br />* make use of cryptography<br />* API is easyer to crack then VCL or MFC<br />* ...<br /><br />Have a nice day</div>
    <div class="meta">Posted on 2002-05-30 11:35:51 by Rennsemmel</div>
   </div>
   <div class="post" id="post-40666">
    <div class="subject"><a href="#post-40666">anti-debug tricks  ??</a></div>
    <div class="body">I can give you just one advice:<br />     Please, don?t end up your extra-genial-unbreakable protection with a loony TEST AX,AX<br />It could be the best protection ever, the best encryption algo, but if then you spoil it with that... ;)</div>
    <div class="meta">Posted on 2002-05-30 12:03:30 by slop</div>
   </div>
   <div class="post" id="post-40669">
    <div class="subject"><a href="#post-40669">anti-debug tricks  ??</a></div>
    <div class="body">Okay, and there?s also a good anti-debug utility in Iczelion?s page,<br /> in sources,<br />its called Softkiller or killerice, or something like that.</div>
    <div class="meta">Posted on 2002-05-30 12:16:22 by slop</div>
   </div>
   <div class="post" id="post-40672">
    <div class="subject"><a href="#post-40672">anti-debug tricks  ??</a></div>
    <div class="body"><u>Any</u> linear approach is just a minor delay.  A distributed approach is much more effective.  There has to be a huge number of variables to track, and <strong>no where</strong> can the protection come down to a single branch.  It's not easy to design such a system, but you will be rewarded with a longer delay before your program is broken.<br /><br />What do people here think about software that has to be authorized regularly by web?  Automatically, of course, but still required.</div>
    <div class="meta">Posted on 2002-05-30 12:22:56 by bitRAKE</div>
   </div>
   <div class="post" id="post-40678">
    <div class="subject"><a href="#post-40678">anti-debug tricks  ??</a></div>
    <div class="body">I am of the view that every little bit helps, stuff the EXE file through an obscure compressor that messes up the sections so that a memory dump does not work directly without a lot of messy fixups. CRC the compressed EXE file and length check it as well. Makes the workload harder.<br /><br />Another trick, somewhere before the branch is required, try<br /><pre><code><br />    PUSH PROC ADDRESS<br />    ; procedure calls<br />    PUSH another proc address<br />    ; Some function calls<br />    PUSH RETURN_ADDRESS_OF_LABEL<br />    ; procedure calls<br />    RETN<br />    LABEL&#58;<br /></code></pre><br />This scruffy mess pushes a number of return addresses and then branches to the last one pushed by using the RETN mnemonic. If you put it at the end of a procedure, its real easy to mess up what is happening in a dead listing.<br /><br />With the chained return addresses, a dead listing does not show the code being called and will appear as an unreferenced function. You can track it in a debugger but its no joy to patch.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-05-30 12:49:46 by hutch--</div>
   </div>
   <div class="post" id="post-40681">
    <div class="subject"><a href="#post-40681">anti-debug tricks  ??</a></div>
    <div class="body">To bitRAKE:<br />I've seen those schemes, softwarew authorized by web, but think of it as a &quot;dongle&quot; protection: If you have the program you can unprotect it ;)<br />(It?s sort of funny: they claim that it?s an &quot;uncr***able&quot; scheme, do you remember how was it when first dongles appeared) :)</div>
    <div class="meta">Posted on 2002-05-30 13:10:14 by slop</div>
   </div>
   <div class="post" id="post-40682">
    <div class="subject"><a href="#post-40682">anti-debug tricks  ??</a></div>
    <div class="body">hutch?s quote: &quot;stuff the EXE file through an obscure compressor that messes up the sections so that a memory dump does not work directly &quot;<br /><br />Yo?re right, that works fine, most newbie-cr***ers stop there ;)<br /><br /><br />More quotes:&quot;<br /><br />. CRC the compressed EXE file and length check it as well. Makes the workload harder. <br /><br />Another trick, somewhere before the branch is required, try <br /><br /><br />code:--------------------------------------------------------------------------------<br />    PUSH PROC ADDRESS<br />    ; procedure calls<br />    PUSH another proc address<br />    ; Some function calls<br />    PUSH RETURN_ADDRESS_OF_LABEL<br />    ; procedure calls<br />    RETN<br />    LABEL:&quot;<br /><br />Have you heard about revirgin?<br />Great tool :))</div>
    <div class="meta">Posted on 2002-05-30 13:14:51 by slop</div>
   </div>
   <div class="post" id="post-42282">
    <div class="subject"><a href="#post-42282">anti-debug tricks  ??</a></div>
    <div class="body">Make all your code look like this. :grin:<pre><code>StreamInProc&#58;<br />	pop eax<br />	pop edx<br />	pop ecx<br />	push esp<br />	xchg &#91;esp&#93;,eax<br />	push 0<br />	push DWORD PTR &#91;eax+4&#93;<br />	push DWORD PTR &#91;eax&#93;<br />	push ecx<br />	push edx<br />	push eax<br />	mov DWORD PTR &#91;esp+&#40;4*7&#41;&#93;,0C201F083h<br />	mov DWORD PTR &#91;esp+&#40;4*8&#41;&#93;,090900008h<br />	jmp ReadFile<br /><br />&#91;b&#93;Instead of&#91;/b&#93;&#58;<br /><br />StreamInProc proc hFile&#58;DWORD, pBuffer&#58;DWORD, NumBytes&#58;DWORD, pBytesRead&#58;DWORD<br />	invoke ReadFile,hFile,pBuffer,NumBytes,pBytesRead,0<br />	xor	eax,1<br />	ret<br />StreamInProc endp</code></pre></div>
    <div class="meta">Posted on 2002-06-10 01:49:57 by bitRAKE</div>
   </div>
   <div class="post" id="post-42290">
    <div class="subject"><a href="#post-42290">anti-debug tricks  ??</a></div>
    <div class="body">Best and only non-crackable protection:<br /><br /><strong>CRIPPLEWARE</strong></div>
    <div class="meta">Posted on 2002-06-10 03:41:16 by bazik</div>
   </div>
   <div class="post" id="post-42300">
    <div class="subject"><a href="#post-42300">anti-debug tricks  ??</a></div>
    <div class="body">And then sombody buys the full version and mass distributes it on Kazaa.<br /><br />You can't win.  :)  :(</div>
    <div class="meta">Posted on 2002-06-10 05:22:20 by iblis</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=5672&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=5672&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="5672" /><input type="number" name="page" min="1" max="3" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=5672&amp;page=2">&gt;</a><a href="../?id=5672&amp;page=3">&raquo;</a></form>  </div>
 </body>
</html>