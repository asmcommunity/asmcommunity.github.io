<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Win32 COM file - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10993" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=10993">Win32 COM file</a></p>
   <div class="post" id="post-82817">
    <div class="subject"><a href="#post-82817">Win32 COM file</a></div>
    <div class="body">Hi all,<br />I remember having found on the net a long time ago something quite funny. It was a true Win32 app in COM file structure. Not talking about the modern COM stuff but the old DOS Com file. Not talking either about what has been used in the demo scene to pack PE files into COM files. Plain old Com file running in Windows! ;)<br /><br />I wanted to have a look again at the source but unfortunately can't find it anymore. Had a search on Google and here but didn't manage to find it again.<br /><br />Has anybody in here still a copy of that source? Would be very kind of you, I you have it, to post it here.<br /><br />Thank you very much.<br /><br />Why do I need it? Well, I'm very curious and I think it's nice to think about a old Com file able to &quot;host&quot; a modern Win32 app ;)<br /><br /><br />Ka.</div>
    <div class="meta">Posted on 2003-02-20 18:02:59 by KaSt</div>
   </div>
   <div class="post" id="post-82869">
    <div class="subject"><a href="#post-82869">Win32 COM file</a></div>
    <div class="body">KaSt,<br /><br />A COM file is a pure memory image that has no header at all and is loaded by the system loader at 100 hex with a DOS PSP in front of it written by the operating system.<br /><br />A PE 32 bit file for Windows must have the basic section information required to load it so what you are after is simply not possible.<br /><br />What both DOS COM files and 32 bit PE files have in common is that they are loaded into a single segment, a DOS COM file can only fit into a DOS 16 bit segment where a PE file can theoretically be any size up to the limit of a 32 bit segment even though in practice, it is restricted to 2 gig in size.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2003-02-20 23:27:14 by hutch--</div>
   </div>
   <div class="post" id="post-82891">
    <div class="subject"><a href="#post-82891">Win32 COM file</a></div>
    <div class="body">I tried to rename windows program calc.exe to calc.com -&gt; works also :) (at least with Win95)</div>
    <div class="meta">Posted on 2003-02-21 03:08:55 by beaster</div>
   </div>
   <div class="post" id="post-82918">
    <div class="subject"><a href="#post-82918">Win32 COM file</a></div>
    <div class="body">It works for all PE files.:stupid:</div>
    <div class="meta">Posted on 2003-02-21 06:42:06 by roticv</div>
   </div>
   <div class="post" id="post-82919">
    <div class="subject"><a href="#post-82919">Win32 COM file</a></div>
    <div class="body">That worked with old MZ exes as well. I think COMMAND.COM of Win9x is such an EXE file.</div>
    <div class="meta">Posted on 2003-02-21 06:46:11 by japheth</div>
   </div>
   <div class="post" id="post-82920">
    <div class="subject"><a href="#post-82920">Win32 COM file</a></div>
    <div class="body">Thanks Hutch for your comments but believe me  the source I had found made it possible.<br />Not sure if I remember well but the Header part had been manually put inside the source code, has once assembled &amp; linked, it would have been wrote on disk the way PE files are structured.<br />I'm learning Win32asm (and plain Asm as well) now, so my explanation can contain lot of mistakes but the example I had found worked.<br /><br />It used a trick, for sure, as COM and PE files have completely different structure. The COM file produced was actually a plain PE file but the source was in COM style. <br /><br />If I manage to put manually the required PE header at the beginning of my source, once compiled should give the same result as if I had compiled my Win32Asm proggy in EXE style, right?<br /><br />At least this is what the COM file example I had found was doing and this is what I'm looking to find again.<br /><br />Thanks for your help,<br /><br />Ka.</div>
    <div class="meta">Posted on 2003-02-21 06:49:53 by KaSt</div>
   </div>
   <div class="post" id="post-83052">
    <div class="subject"><a href="#post-83052">Win32 COM file</a></div>
    <div class="body">Sounds like something Sven Schreiber did way back when.  It's been a while since I looked at his WALK package, so I may be misremembering it.</div>
    <div class="meta">Posted on 2003-02-22 00:28:35 by tenkey</div>
   </div>
   <div class="post" id="post-83095">
    <div class="subject"><a href="#post-83095">Win32 COM file</a></div>
    <div class="body">KaSt,<br /><br />If you could post an example of Win32 COM file? :)</div>
    <div class="meta">Posted on 2003-02-22 06:19:27 by Vortex</div>
   </div>
   <div class="post" id="post-83306">
    <div class="subject"><a href="#post-83306">Win32 COM file</a></div>
    <div class="body">I've seen COM files that magically gets transformed into Win32 PE:s at runtime but you can't make a PE file look like a COM file. The PE files must follow the rules for the PE format (ie at least 512 byte per section etc.)</div>
    <div class="meta">Posted on 2003-02-23 12:27:29 by gliptic</div>
   </div>
   <div class="post" id="post-83550">
    <div class="subject"><a href="#post-83550">Win32 COM file</a></div>
    <div class="body">I agree with you that what I'm talking about seems impossible but I remember having seen it, had the source code on my screen. Only prob, can't find it back. :(<br /><br />Hoped someone in here had it in his &quot;code museum&quot;<br /><br />Thanks for your help,<br /><br />Ka.</div>
    <div class="meta">Posted on 2003-02-24 18:28:07 by KaSt</div>
   </div>
  </div>
 </body>
</html>