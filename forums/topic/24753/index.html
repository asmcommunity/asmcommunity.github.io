<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Desktop apps in the background - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=24753" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=24753">Desktop apps in the background</a></p>
   <div class="post" id="post-180799">
    <div class="subject"><a href="#post-180799">Desktop apps in the background</a></div>
    <div class="body">Hi Guys<br /><br />How to force a app to be showend in the background of the desktop ?<br /><br />I mean, on such a way that i can see the main window of the app (His contents etc), but, the icons on the desktop (and all other apps) be on the foreground ?<br /><br />I´m trying to force a app to work beind the desktop..The idea is similar to background images on the desktop, where we can move the mouse on the desktop over it, where the icons can be over it...but still we can see the main image...but we can´t change/move it. I´m trying to get the same effect with an app.<br /><br />The app shows a spining molecula,?&nbsp; but i want that it´s main window works behind the desktop area.<br /><br /><br />Best Regards,<br /><br />Guga</div>
    <div class="meta">Posted on 2006-05-21 05:24:59 by Beyond2000!</div>
   </div>
   <div class="post" id="post-180801">
    <div class="subject"><a href="#post-180801">Re: Desktop apps in the background</a></div>
    <div class="body">Hmm, good question.<br /><br />One way that ought to work is to set the desktop background color to some &quot;special&quot; value. Then use a color-keyed blit (probably requires DirectDraw?). I got a movie player to work that way :)<br /></div>
    <div class="meta">Posted on 2006-05-21 06:06:16 by f0dder</div>
   </div>
   <div class="post" id="post-180816">
    <div class="subject"><a href="#post-180816">Re: Desktop apps in the background</a></div>
    <div class="body">Hi F0dder<br /><br />Seting a color of the window ? Like making something similar to shape/skinned windows ?<br /><br />I don´t know..i was thinking in something different. Not exactly concerned with matching the background colors...But, putting the app really behind the desktop. I mean when you move a certain app or icon over the desktop the desktop oicons are &quot;hidden&quot; by them becauyse the app is in front of it.<br /><br />My idea was the opposite..making the app be behind the desktop.<br /><br />What movie player of yours does it ? Can u send me a link to see it working ?<br /><br />I was thinking in finding the thread of the desktop, and trying to work directly with the threads, insetad the colors.<br /><br />Best Regards,<br /><br />Guga</div>
    <div class="meta">Posted on 2006-05-21 11:38:27 by Beyond2000!</div>
   </div>
   <div class="post" id="post-180817">
    <div class="subject"><a href="#post-180817">Re: Desktop apps in the background</a></div>
    <div class="body"><div class="quote"><br />My idea was the opposite..making the app be behind the desktop.<br /></div><br />I don&#39;t really know if this is doable though, and probably not in a way that supports all windows versions and other shells (like blackbox, litestep, geoshell, ...)<br /><br />Let me try to explain the video player example a little further. It&#39;s based on something called overlay surfaces. Try taking a screenshot of a media player - if you have hardware acceleration, the screenshot file will not contain the image from the video, it will be a rectangle of some special color (often pink).<br /><br />This special color is the &quot;color key&quot;, and (rough description) defines the region where the overlay will be blitted. Any pixel that doesn&#39;t have this color will not be touched.<br /><br />So, the idea would be setting the desktop background color to this &quot;magic color&quot;, and use a color-key blit against the entire screen. Only the background will be touched (because it&#39;s the &quot;magic color&quot;), and it will give the impression that you&#39;re rendering to the desktop.<br /></div>
    <div class="meta">Posted on 2006-05-21 11:45:59 by f0dder</div>
   </div>
   <div class="post" id="post-180819">
    <div class="subject"><a href="#post-180819">Re: Desktop apps in the background</a></div>
    <div class="body">Hmm..interesting.<br /><br />Do you have any example of that ? I have no idea what is overlay surfaces, nor how to code something like this.<br /><br /><br />I juts found something (I guess) but it is for an OS called Symbian. I didn´t understood one single word of that..but..if you would like to take a lookto see if this can be something usefull..here it is:<br /><br />http://www.newlc.com/Moving-an-application-to.html<br /><br />Or..,maybe this ?<br /><br />http://www.everythingaccess.com/tutorials.asp?ID=Bring-an-external-application-window-to-the-foreground<br /><br />But the above we set tjhe app to the thread before the threadID of the desktop ?<br /><br /><br />Best Regards,<br /><br />Guga</div>
    <div class="meta">Posted on 2006-05-21 11:59:12 by Beyond2000!</div>
   </div>
   <div class="post" id="post-180835">
    <div class="subject"><a href="#post-180835">Re: Desktop apps in the background</a></div>
    <div class="body">You can try this... It is not exactly what you are after, but maybe it helps :)<br /><br />Just start Notepad and make it small window (not fullscreen) and then run Ghost Notepad.exe from the attachment. Your notepad should change to semi transparent and it should ignore keyboard and mouse input. All input is going thru Notepad&#39;s window to the window below it in Z order. Unfortunately, this does not make your app, or in this case Notepad to work below Desktop, but when it is semi transparent you can see desktop icons thru it. I tested this on XP SP2, it may work also on Windows 2000.<br /><br />This is a quick hack and thus you need to use Taskmanager to kill Notepad.exe after it is ghosted or change my prog to preserve old settings and make it restore them&nbsp; :D<br /><br />Best regards,<br />Sami</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1629" target="_blank">GhostNotepad.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-22 14:21:07 by SamiP</div>
   </div>
   <div class="post" id="post-180890">
    <div class="subject"><a href="#post-180890">Re: Desktop apps in the background</a></div>
    <div class="body">Tks SamiP<br /><br />But, this is not helping too much. I don´t want a transparent app..<br /><br />I looked for someway to do this on the function SetDeskWallpaper from user32. But it also don´t helps too much. I was trying to figure it out how windows manages to set desktop wallpapers. Maybe this could helped, but...i back to the gorund zero :sad:<br /><br /><br />I heard that OpenGL doesn&#39;t know what a window is. Instead, it renders into a context, which is simply a chunk of the screen.<br /><br />So i was thinking in how to setup a DeskTop context&nbsp; to the OpenGL Api be renderred onto(whatever that is ;) - Context = handle ?) creating on it a pixel format, creating a context, attaching the context to the desktop. <br /><br />I´m continuing searching it.<br /><br />Best Regards,<br /><br />Guga</div>
    <div class="meta">Posted on 2006-05-23 16:22:20 by Beyond2000!</div>
   </div>
   <div class="post" id="post-180900">
    <div class="subject"><a href="#post-180900">Re: Desktop apps in the background</a></div>
    <div class="body">Attach your window somehow, as shown in the image. Use CS_PARENTDC.<br />The ListView32 here is what shows your icons on the desktop. <br /><br />Haven&#39;t tried it, though, and haven&#39;t seen anyone do it except for microsoft ^^&quot;<br />So, pls try and share results :)</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1632" target="_blank">New Bitmap Image.gif</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-23 18:52:53 by Ultrano</div>
   </div>
   <div class="post" id="post-180918">
    <div class="subject"><a href="#post-180918">Re: Desktop apps in the background</a></div>
    <div class="body">I kinda succeeded, though it requires <strong>ActiveDesktop</strong> to be enabled, and dragging things over the window is ugly</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1634" target="_blank">test3.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-23 21:01:36 by Ultrano</div>
   </div>
   <div class="post" id="post-180927">
    <div class="subject"><a href="#post-180927">Re: Desktop apps in the background</a></div>
    <div class="body">Hi Ultrano<br /><br />Many TKS..It is working :)<br /><br />The problem of the icons being ugly maybe because we need to set a mask of the desktop color and the window color.<br /><br />I suceeded to make it work on my app using your code. Take a Look at the screenshot on my DeskTop, below.<br /><br />I´m reviewing the code a little and will post here in a couple of moments.<br /><br />There are minor problems with draging the icons that are over the &quot;behinded&quot; app, and also...Is it necessary to always use the active desktop ? I mean, here on Win2000 it automatically activates it..But i have no idea, on other OSes.<br /><br /><br />I´ll post the full code on a moments.<br /><br />Best Regards,<br /><br />Guga<br /><br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1636" target="_blank">Image1.jpg</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-24 00:52:00 by Beyond2000!</div>
   </div>
   <div class="post" id="post-180929">
    <div class="subject"><a href="#post-180929">Re: Desktop apps in the background</a></div>
    <div class="body">By &quot;and dragging things over the window is ugly&quot; I actually meant the problem you noticed, too - &quot;There are minor problems with draging the icons that are over the &#39;behinded&#39; app&quot;&nbsp;  :) ... it was just 5:00am for me here ^^&quot;<br /><br />I tried to solve the dragging problem, but my window wasn&#39;t getting any WM_ messages ... Prolly it&#39;s because of the listview&#39;s drag-drop file commands. <br /><br /></div>
    <div class="meta">Posted on 2006-05-24 03:49:12 by Ultrano</div>
   </div>
   <div class="post" id="post-180933">
    <div class="subject"><a href="#post-180933">Re: Desktop apps in the background</a></div>
    <div class="body">Ultrano,<br />Have you tired to subclass into the desktop&#39;s listview?<br />and look for the messages you need?<br /><br />Zcoder....</div>
    <div class="meta">Posted on 2006-05-24 04:17:55 by Zcoder</div>
   </div>
   <div class="post" id="post-180939">
    <div class="subject"><a href="#post-180939">Re: Desktop apps in the background</a></div>
    <div class="body">nope :)&nbsp; The listview is already subclassed once, btw :)</div>
    <div class="meta">Posted on 2006-05-24 06:01:15 by Ultrano</div>
   </div>
   <div class="post" id="post-180996">
    <div class="subject"><a href="#post-180996">Re: Desktop apps in the background</a></div>
    <div class="body">Hi Guys<br /><br />Here goes the file. I´m uploading the Source, and also the Executable file (With the source inside). Syntax is for RosAsm, but it is easy to follow.<br /><br />I faced some problems.<br /><br />I inserted a fadeIn/fadeOut effect (Tks for the idea ZCoder :) ), but insetad using the SetLayeredWindowAttributes Api, i used the AnimateWindow Api to make it posible to the effect shows also on Win98.<br /><br />But... the problem with FadeIN is that once teh effect is applyed i can´t see the molecule running, except if i minimize or maximize the window. (So to test, don´t?&nbsp; check the full screen mode or the background mode)<br /><br />The animatedwindow Api with OpenGL apps is described here:<br /><br />http://www.stephan-brumme.com/download/game%20programming/Games1.pdf<br /><br />But, i couldn´t understand what i´m doing wrong.<br /><br />Also.. on this version i removed the FadeOut effect, because it was not working....When the WM_DESTROY message was being set the blade effect was not showing.<br /><br />A couple of questions:<br /><br />1) What i´m doing wrong ?<br />2) How to make FadeIn and fadeOut work properly ?<br />3) The App is eating 8 to 20% of memory (From a total of 256) and i think that it is too much. I saw some other apps consuming a minor and more stabel rate (Around 1% or 2%). I´m quite sure i forgot to release some memory in one of the OpenGl apis...What i´m doing wrong ?<br />4) I made a small routine to check for the rpesence of the ActiveDeskTop. But...once it is detected, how to enable it automatically ?<br /><br /><br />Todo: Add a trayiconmenu to allow the app exits when it is on BackGround Mode.<br /><br />Best Regards,<br /><br />Guga</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=1644" target="_blank">Working3eFull_WithSrc.rar</a></li>
      <li><a href="../../attachments/?id=1645" target="_blank">Working3eSrcOnly.rar</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2006-05-24 18:30:09 by Beyond2000!</div>
   </div>
   <div class="post" id="post-181002">
    <div class="subject"><a href="#post-181002">Re: Desktop apps in the background</a></div>
    <div class="body">Hmm judging from the performance (0.5fps), this approach of using activedesktop is not good for anything animated :( . Instead, let&#39;s do it with overlays! :)<br /><br />So, the image route will be OpenGL-&gt;DDraw, GDI might have to serve as a medium. Just like in BSPlayer, you could have a view-window, and a control-panel (control-window). The view-window being able to be behind desktop, in a small window, or in fullscreen. <br /></div>
    <div class="meta">Posted on 2006-05-24 19:40:30 by Ultrano</div>
   </div>
   <div class="post" id="post-181003">
    <div class="subject"><a href="#post-181003">Re: Desktop apps in the background</a></div>
    <div class="body">0.5 ?????<br /><br />Hmm...I suppose you used the 1024*800 mode in the background mode, right ?<br /><br />If so..this is similar to what i have here.<br /><br />If i use 640*480 and BackGround Mode only checked. The Frame Rate is higher.<br /><br />What is the variance of Frame rate you got on your machine ?<br /><br /><div class="quote">So, the image route will be OpenGL-&gt;DDraw, GDI might have to serve as a medium. Just like in BSPlayer, you could have a view-window, and a control-panel (control-window). The view-window being able to be behind desktop, in a small window, or in fullscreen. </div> <br /><br />Sorry, i didn´t understood this. What is BSPlayer ? <br /><br />M&lt;aybe the better is allowing the background mode only uses 640*480. This should fix the farme rate problem in older machines. (And mine is an old one too :) )<br /><br />Best Regards,<br /><br />Guga</div>
    <div class="meta">Posted on 2006-05-24 19:48:09 by Beyond2000!</div>
   </div>
   <div class="post" id="post-181005">
    <div class="subject"><a href="#post-181005">Re: Desktop apps in the background</a></div>
    <div class="body">1024x768 32bpp, ran the app with only one box ticked: &quot;BackGround mode&quot;. <br />Sempron 2200+, FSB400, 512MB DDR400, Radeon9200 at AGP8, fastwrites on.<br />0.5fps up to 2.0 fps. ( the app renders a 640x480 rectangle, centered to screen, behind the SysListView32). Yet, I am not very sure how well my drivers are now. I&#39;m playing Sin:Emergence (released two weeks ago), and CSS with no probs - so I guess the drivers are ok, Direct3D-wise. <br /><br /><br /><br />BSPlayer is ... www.bsplayer.org :)&nbsp; (try pressing &quot;D&quot; while watching a video)</div>
    <div class="meta">Posted on 2006-05-24 20:01:00 by Ultrano</div>
   </div>
   <div class="post" id="post-181007">
    <div class="subject"><a href="#post-181007">Re: Desktop apps in the background</a></div>
    <div class="body"><div class="quote">So, the image route will be OpenGL-&gt;DDraw</div><br />Wouldn&#39;t it be wiser to use Direct3D9? Direct3d, DirectShow and DirectDraw are all 1, single entity in Directx9. You can render something 3d and blit it to a portion of the screen &#39;attached&#39; to the desktop&#39;s background. This way it&#39;ll be drawn after the wallpaper, but before the icons. You can also render it directly to the screen with alpha transparency.</div>
    <div class="meta">Posted on 2006-05-24 20:38:52 by ti_mo_n</div>
   </div>
   <div class="post" id="post-181012">
    <div class="subject"><a href="#post-181012">Re: Desktop apps in the background</a></div>
    <div class="body">Hi ti_mo_n<br /><br />Maybe not... Not everybody have DX9. Some people still have a 56 Kbps modem, or just don´t have DX9 installed.<br /><br />But....everybody that uses windows, have Opengl libraries<br /><br />Dx9 maybe easier, but also it wouldn´t be totally extensible to everyone.<br /><br />Also, i just tested a example using DX9 (Argh..i have to download DX9 again from here. 50 Mb or something, :) ), and the sped of the animation does not varies that much. The problem with the speed is inside my Code. I´m pretty sure i didn´t release memory fro some OpenGL api (Something called genlist or something)...Since i´m not used wiuth OpenGL programming, i´m unable to fix it alone.<br /><br />Best Regards,<br /><br />Guga</div>
    <div class="meta">Posted on 2006-05-24 22:50:55 by Beyond2000!</div>
   </div>
  </div>
 </body>
</html>