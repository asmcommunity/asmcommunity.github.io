<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>WIN32 MACRO's inside HLA (II) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=20322" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=20322">WIN32 MACRO's inside HLA (II)</a></p>
   <div class="post" id="post-155483">
    <div class="subject"><a href="#post-155483">WIN32 MACRO's inside HLA (II)</a></div>
    <div class="body">hi Arlequin and everyone !<br /><br />Hope you had fun in the last days...<br /><br />OK, let's now come again to our topic : <br />my last error was quickly corrected (I guess I was a bit tired  :oops: ), and after having been compiled, icons.exe actually brings changes to calc, but...<br />this is what happens :<br /><br />icons.exe does not subsitute the icon of calc by the one from Winmine, but instead of this <u>adds</u> another icon into the resource of calc, with the same icon #. That is : if I check after the operation, I see two icons with #1 (?), and of course, calc continues to use its own one, which continues to be displayed by the Explorer namely...<br /><br />This makes me think about what I did not until now : I work under Win2K Server, and perheaps don't you... in such case, maybe from there comes the difference between our results.<br /><br />Did you actually change the icon of calc in such way that your Explorer displays it ?<br />Under what OS do you work ?<br /><br /><br />until soon,<br /><br /><br /><br />Juan.</div>
    <div class="meta">Posted on 2005-01-10 07:25:38 by Juan</div>
   </div>
   <div class="post" id="post-155530">
    <div class="subject"><a href="#post-155530">WIN32 MACRO's inside HLA (II)</a></div>
    <div class="body">Hi All,<br /><br /><div class="quote">icons.exe does not subsitute the icon of calc by the one from Winmine, but instead of this adds another icon into the resource of calc</div><br /><br />UpdateResource can add,  deletes, or replaces a resource in an executable file. In your case, I suppose that winmine.exe language id is different from calc.exe then EndUpdateResource will add a new icon rather than to replace it.  Please, control that with <a target="_blank" href="http://www.users.on.net/johnson/resourcehacker/">Resource Hacker</a>. Open calc.exe and expand 'Icon Group' and the subdir. You'll see a number, the langid. Mine is 1036 because my OS language is french but you can find 1033 for US or any other number that represents a language. Do you remember MAKELANGID ? This macro makes this number. Now, compare winmine and calc, their langid must be identical. <br /><br /><div class="quote">I work under Win2K Server, and perheaps don't you... in such case, maybe from there comes the difference between our results. </div><br />I don't believe it, but I can be wrong.<br /><br /><div class="quote">Did you actually change the icon of calc in such way that your Explorer displays it ?</div><br />Yes, I did and it works.<br /><br /><div class="quote">Under what OS do you work ?</div><br />I work with XP<br /><br />Bon, je suis crev?, je vais me coucher, salut. A+</div>
    <div class="meta">Posted on 2005-01-10 17:54:42 by arlequin</div>
   </div>
  </div>
 </body>
</html>