<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>file name to hWnd - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=3051" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=3051">file name to hWnd</a></p>
   <div class="post" id="post-20008">
    <div class="subject"><a href="#post-20008">file name to hWnd</a></div>
    <div class="body">Hi.<br />Is there a way to get, given a process filename, its hWnd in case it has one (or more)?<br />What I want to do is kill some GUI app by sending it a WM_QUIT message instead of using TerminateProcess.<br />Thanks</div>
    <div class="meta">Posted on 2002-01-19 23:21:24 by GogetaSSJ4</div>
   </div>
   <div class="post" id="post-20023">
    <div class="subject"><a href="#post-20023">file name to hWnd</a></div>
    <div class="body">If you can get a valid window handle for the app you wish to close, try the following API function call to close it. I am not sure if this will work as a different app is in a different thread but its probably worth a try.<br /><pre><code><br />invoke SendMessage,hWnd,WM_SYSCOMMAND,SC_CLOSE,NULL<br /></code></pre><br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-01-20 02:48:45 by hutch--</div>
   </div>
   <div class="post" id="post-20044">
    <div class="subject"><a href="#post-20044">file name to hWnd</a></div>
    <div class="body">Hutch, stop posting while under influence of fine scotch :grin: .<br />Read the guys post again - his trouble is exefilename-&gt;hwnd...<br /><br />Gogeta, I'm not sure how you can go exename-&gt;hwnd, but if you<br />have the caption/classname of the window of the app you want to<br />terminate, you can use FindWindow or EnumWindows to find the<br />window handle.</div>
    <div class="meta">Posted on 2002-01-20 05:41:42 by f0dder</div>
   </div>
   <div class="post" id="post-20059">
    <div class="subject"><a href="#post-20059">file name to hWnd</a></div>
    <div class="body">Thanks to all.<br />Since I mainly want to close Outlook, yes, I can use FindWindow with the title.<br />But it would be better if I could use the program to kill any app with a GUI, so I still need to get the hWnd from the file name.<br />I reviewed an API list and found no way to do that yet, and I don't know if that is even posible.</div>
    <div class="meta">Posted on 2002-01-20 08:31:23 by GogetaSSJ4</div>
   </div>
   <div class="post" id="post-20061">
    <div class="subject"><a href="#post-20061">file name to hWnd</a></div>
    <div class="body">Big question is... why do you want to do this?</div>
    <div class="meta">Posted on 2002-01-20 08:54:56 by f0dder</div>
   </div>
   <div class="post" id="post-20096">
    <div class="subject"><a href="#post-20096">file name to hWnd</a></div>
    <div class="body">hi GogetaSSJ4 i was bored so i wrote this up for you. i didnt write any comments so if you cant follow my code let me know.</div>
    <div class="meta">Posted on 2002-01-20 14:04:46 by smurf</div>
   </div>
   <div class="post" id="post-20103">
    <div class="subject"><a href="#post-20103">file name to hWnd</a></div>
    <div class="body">You have to use the code written by Smurf and call for every top window the API GetWindowModuleFileName passing the window handle. Once you have the full executable path you can compare it with the one of the bad app and eventually kill it. Win95 doesn't support GetWindowModuleFileName.</div>
    <div class="meta">Posted on 2002-01-20 14:43:49 by LuHa</div>
   </div>
   <div class="post" id="post-20134">
    <div class="subject"><a href="#post-20134">file name to hWnd</a></div>
    <div class="body">f0dder,<br /><br />It seems a little knowledge on your part is dangerous, the original suggestion was to close the window by sending a WM_QUIT message, what I have suggested is sending a WM_SYSCOMMAND message to it as it is the normal way the operating system closes an application.<br /><br />As I am sure you already know, you get the window handle of an exterenal app (not in the same thread/process) with API calls like GetWindow() or alternatively you enumerate the windows that are running and select the one you want.<br /><br />    1. Get Window Handle.<br /><br />    2. Send SYSTEM message to close it.<br /><br />    3. See if it works !!!! :)<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-01-20 16:57:26 by hutch--</div>
   </div>
   <div class="post" id="post-20231">
    <div class="subject"><a href="#post-20231">file name to hWnd</a></div>
    <div class="body">Thanks to all. As soon as I have the time, I'll check all given options and post results in case someone cares.<br /><br />to f0dder: I want to kill Outlook without screwing its DBs (wich usually happens when you TerminateProcess it). It may also be usefull for other cases too.<br /><br />to hutch: what's the difference between WM_QUIT and WM_SYSCOMMAND?<br /><br />Thanks!!</div>
    <div class="meta">Posted on 2002-01-21 01:26:00 by GogetaSSJ4</div>
   </div>
  </div>
 </body>
</html>