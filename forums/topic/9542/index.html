<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Question ??? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=9542" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=9542">Question ???</a></p>
   <div class="post" id="post-70657">
    <div class="subject"><a href="#post-70657">Question ???</a></div>
    <div class="body">Ok.<br /><br />I have not ever attempted this yet but i need some help doing it.<br /><br />I'm a video game modder. I add functions like Anti Cheating, Punting, Banning and so on.<br /><br />Right Now i use Lord Pe To add the dll's that i create into the exe and then patch the exe to use<br />the dll the way i want it to.<br /><br />the main problem is. Is that windows 2000 systems can run the modded exe's.<br /><br />so what im looking to do is instead of modding the exe its self I want to for the dll into the memory of<br />the exe by a loader and then patch the exe in the memory to use the dll.<br /><br />i know to patch the exe in the memory you juse do a WriteProcessMemory.<br /><br />but what i dont know how to do is to force the dll into the memory.<br /><br />I got ahold of TSnoop from a friend that does it. but it requires ikernel32.lib iuser32.lib and i cant seem to find<br />those files anywere. <br /><br />so if you could help me get those files or help me find another way to get the dll into the memory of the game.</div>
    <div class="meta">Posted on 2002-12-12 18:03:26 by devilsclaw</div>
   </div>
   <div class="post" id="post-70658">
    <div class="subject"><a href="#post-70658">Question ???</a></div>
    <div class="body">Devilsclaw, there is nothing special with the libraries 'iuser32.lib' etc. You could<br />just change it to 'user32.lib' and changing the 'iWin32' commands to 'invoke'.<br />However, there is alot of command/macros used with those library's.<br /><br />So I would suggest that you download 'EliASM2' from this site: <br /><a target="_blank" href="http://www.anticracking.sk/EliCZ/infos.htm">http://www.anticracking.sk/EliCZ/infos.htm</a><br />He is the one who made those macros wich create/use the library files 'iuser32.lib'.<br />You'll probably find alot of other info/examples regarding your other question there <br />also.<br /><br />BTW: I would really like to see that source code you where talking about. So <br />could you attach it to a post? ( :) )<br /><br />Another thing, this topic is mainly for the MASM32 package. So any other question<br />regarding asembly etc. Should mainly be posted in 'Main', read the rules. ( ;) )</div>
    <div class="meta">Posted on 2002-12-12 18:13:45 by natas</div>
   </div>
   <div class="post" id="post-70662">
    <div class="subject"><a href="#post-70662">Question ???</a></div>
    <div class="body">trnsnpd.obj : error LNK2001: unresolved external symbol __imp__CreateFileA<br />trnsnpd.obj : error LNK2001: unresolved external symbol __imp__MessageBoxA<br />trnsnpd.obj : error LNK2001: unresolved external symbol __imp__lstrlenA<br />trnsnpd.obj : error LNK2001: unresolved external symbol __imp__WriteFile<br />trnsnpd.obj : error LNK2001: unresolved external symbol __imp__CloseHandle<br />trnsnpd.obj : error LNK2001: unresolved external symbol __imp__lstrcatA<br />trnsnpd.obj : error LNK2001: unresolved external symbol __imp__WinExec<br />trnsnpd.obj : error LNK2001: unresolved external symbol __imp__lstrcmpA<br />trnsnpd.obj : error LNK2001: unresolved external symbol __imp__GetProcAddress<br />trnsnpd.obj : error LNK2001: unresolved external symbol __imp__WriteProcessMemor<br /><br />is what i get when i change the iUSER.LIB and iKERNEL32.LIB<br /><br />and if i dont change it lol you know it just does not find it.<br /><br />thats what brought me to thinking the iUSER32.LIB were diff from the original.<br /><br />also the weird thing is that it does not use call or invoke in the actuall code its all in the macros</div>
    <div class="meta">Posted on 2002-12-12 18:34:10 by devilsclaw</div>
   </div>
   <div class="post" id="post-70663">
    <div class="subject"><a href="#post-70663">Question ???</a></div>
    <div class="body">oh now i feel dumb lol i think i should just add in the inc files. mainly was exspecting working code.<br /><br />i had to mod it a bit to get it this far im going to try it now. normaly i write my won code.<br />so i dont have this problem.</div>
    <div class="meta">Posted on 2002-12-12 18:42:32 by devilsclaw</div>
   </div>
   <div class="post" id="post-70664">
    <div class="subject"><a href="#post-70664">Question ???</a></div>
    <div class="body">Well he uses EliCZ macro's, and they are called things like 'iWin32'. (Not<br />'invoke/call'). Since the package wich i told you about above, uses alot of<br />macros etc. only available inside the whole package. I suggested that<br />you download and read the whole pack, to gain any undestanding.<br /><br />I am very tired right now so i forgot to say that the 'iuser32.lib' are different from <br />the other ones. They were made to be used by EliCZ macros.However, im pretty <br />shure that if you had changed the 'iuser32.lib' to 'user32.lib', and replaced 'iWin32' <br />to 'Invoke' you would not have gotten those messages.But do as i sayd and <br />download that package to understand what im talking about.<br /><br />And once again: could you post the source code? im interested in looking at it. :)<br /><br />-Cheers</div>
    <div class="meta">Posted on 2002-12-12 18:43:32 by natas</div>
   </div>
   <div class="post" id="post-70667">
    <div class="subject"><a href="#post-70667">Question ???</a></div>
    <div class="body">nope dangit umm not sure whats up still</div>
    <div class="meta">Posted on 2002-12-12 18:45:34 by devilsclaw</div>
   </div>
   <div class="post" id="post-70668">
    <div class="subject"><a href="#post-70668">Question ???</a></div>
    <div class="body">Well you say that you usually write your own code? then you do have<br />knowledge about the assembly language? well since it doesnt seem<br />like you want to read the package. Then post the code and ill convert<br />it to plain assembly using normal invoke or call if you want to.<br /><br />BDW: please compress the files to .zip if your going to post a long code. ( ;) )</div>
    <div class="meta">Posted on 2002-12-12 18:47:56 by natas</div>
   </div>
   <div class="post" id="post-70724">
    <div class="subject"><a href="#post-70724">Question ???</a></div>
    <div class="body">i looked at the code and it does not need converting so im going to convert the mac file from the site that i go the apihooks pack a while ago. as for the soure i dont know if im allowed to give it out. i was given to me by a friend and he got it from someone else.</div>
    <div class="meta">Posted on 2002-12-13 00:31:31 by devilsclaw</div>
   </div>
   <div class="post" id="post-70730">
    <div class="subject"><a href="#post-70730">Question ???</a></div>
    <div class="body">Well i got the exe to compile now i need to figure out the dll its a bit diff but thanks for the help and sorry about the source but it is not mine to give out.</div>
    <div class="meta">Posted on 2002-12-13 01:32:00 by devilsclaw</div>
   </div>
   <div class="post" id="post-70736">
    <div class="subject"><a href="#post-70736">Question ???</a></div>
    <div class="body">oh and quick referance i had to make my own DEF file from my dlls with iDEF and then Link them to a lib and i dont have import problems anymore with the exe now the dll is looking for a OldGetProcAddress and if i goto the Kernel32.inc and put OldGetProcAddress equ &lt;GetProcAddress&gt;<br /><br />i get past that one section yet comes up with other error with the same import but its using a new name again so it must be something else with the macro.</div>
    <div class="meta">Posted on 2002-12-13 02:05:29 by devilsclaw</div>
   </div>
   <div class="post" id="post-70753">
    <div class="subject"><a href="#post-70753">Question ???</a></div>
    <div class="body">Well Finaly got the dll to compile but it still didnt work untill i added a def with a fake export now it all work.<br /><br />man the guy sure made a person work for what he wants lol.</div>
    <div class="meta">Posted on 2002-12-13 04:31:02 by devilsclaw</div>
   </div>
   <div class="post" id="post-70757">
    <div class="subject"><a href="#post-70757">Question ???</a></div>
    <div class="body">Well too bad that you couldnt give out the source. But I understand<br />that you cannot. But it's good to hear that you finally got it running.<br /><br />-Cheers</div>
    <div class="meta">Posted on 2002-12-13 04:49:51 by natas</div>
   </div>
   <div class="post" id="post-70759">
    <div class="subject"><a href="#post-70759">Question ???</a></div>
    <div class="body">Well i looked in the zip and it had a readme.txt and it pointed to a email addy but i went to that site and its for download to the public so i guess i could send you the original source or give you the link to download it.<br /><br />well i will link you lol.<br /><br /><br />{LINK HAS BEEN REMOVED}<br /><br />its the trainer spy software called trnsnp.zip<br /><br />have fun getting it to work lol. if you dont figure it out on your own i can help you of course.</div>
    <div class="meta">Posted on 2002-12-13 05:04:01 by devilsclaw</div>
   </div>
   <div class="post" id="post-70760">
    <div class="subject"><a href="#post-70760">Question ???</a></div>
    <div class="body">ok new problem..... well not really a problem but the original exe has the ApiHooks.dll actually in the exe its self.<br /><br />well sort of for that fact there is no other MZ at the start so im not sure how it does not need the ApiHooks.dll<br /><br />but when you finaly get the source working it needs the dll and his does not. so if anyone can tell me how to put the dll into the exe its self i would be happy. ty</div>
    <div class="meta">Posted on 2002-12-13 05:08:10 by devilsclaw</div>
   </div>
   <div class="post" id="post-70762">
    <div class="subject"><a href="#post-70762">Question ???</a></div>
    <div class="body">Thanks for putting up the link to the source. ( :) ) This is going to sound <br />a little bit wierd, but you need to remove the link by using the 'edit' button.<br />Because it contains contents wich is illegal on this board(virii). So if you<br />dont remove it, im pretty shure the moderators will.<br /><br />Thanks for the source tho. ( ;) )</div>
    <div class="meta">Posted on 2002-12-13 05:09:38 by natas</div>
   </div>
   <div class="post" id="post-70765">
    <div class="subject"><a href="#post-70765">Question ???</a></div>
    <div class="body">np and link has been removed. also can you help me with loading the dll into the actually exe its self well the apihooks one at least.</div>
    <div class="meta">Posted on 2002-12-13 05:12:55 by devilsclaw</div>
   </div>
   <div class="post" id="post-70818">
    <div class="subject"><a href="#post-70818">Question ???</a></div>
    <div class="body">There are different ways of including a .dll file into an exe file. You can either<br />convert the contents to data/var(using a tool like 'BINTODB' found in the masm pack).<br />Or you could include it as a resource. Whatever you prefer. Since I dont think<br />I need to write the answer wich is already on this board, ill just point you to<br />the threads.  +more reading can be found by searching. ( ;) )<br /><a target="_blank" href="http://www.asmcommunity.net/board/showthread.php?threadid=9535">http://www.asmcommunity.net/board/showthread.php?threadid=9535</a><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=8699">http://www.asmcommunity.net/board/index.php?topic=8699</a><br /><a target="_blank" href="http://www.asmcommunity.net/board/showthread.php?threadid=845&amp;highlight=dll+resource">http://www.asmcommunity.net/board/showthread.php?threadid=845&amp;highlight=dll+resource</a><br /><br />Now thats outta the way, lets go back to the source in question. What do you<br />mean by the ApiHooks.dll? I have compiled the source code and I dont need<br />that .dll file to make it run. Since it uses the ApiHook  .lib files. The problem<br />is with the version of the hook libs/inc(and the linker i think).<br /><br />Well I wanted to show you that you dont need that .dll, so I decided to slap-it-<br />together for you. The zipped archive below contains everything you need!<br />Including .libs .linker etc. I changed the .bat files, other then that I didnt change a<br />thing in the source code. :alright: <a target="_blank" href="http://home.no/natasx/_trnsnp.zip">http://home.no/natasx/_trnsnp.zip</a></div>
    <div class="meta">Posted on 2002-12-13 10:47:00 by natas</div>
   </div>
   <div class="post" id="post-71020">
    <div class="subject"><a href="#post-71020">Question ???</a></div>
    <div class="body">hmm very interesting. i use MASM32 V7 and i had to mod the code and everything to get it to work. and when i did the dll and the exe both were 4k and the original that is in the zip is like 19k so im not sure why mine would not just compile. i tryed the 3.8 version and the 5.6 version it likes the older one better. did you have to do anything to make it work or did it just work and if it did can you send me you APIMACRO file mine might be out of date.</div>
    <div class="meta">Posted on 2002-12-14 17:26:51 by devilsclaw</div>
   </div>
   <div class="post" id="post-71021">
    <div class="subject"><a href="#post-71021">Question ???</a></div>
    <div class="body">The program was created to be used by the apihook version. 3.8. In the<br />new version alot of the macro's etc. have probably changed. I didnt<br />care to look into the changes in the new one tho. The only thing I changed<br />is within the .bat file as you will notice when you look at it. Nothing<br />else was done to the source code.<br /><br />Anyways, all of the files you need is inside the archive linked above. <br />The archive contains: source code,librarys,includes,linker,etc. Everything <br />you need to compile it. There is no other file you should need. ( ;) )</div>
    <div class="meta">Posted on 2002-12-14 17:50:09 by natas</div>
   </div>
   <div class="post" id="post-71052">
    <div class="subject"><a href="#post-71052">Question ???</a></div>
    <div class="body">ok thanks alot and i will look at the bat file and i see it works fine now that i downloaded it.</div>
    <div class="meta">Posted on 2002-12-15 01:44:10 by devilsclaw</div>
   </div>
  </div>
 </body>
</html>