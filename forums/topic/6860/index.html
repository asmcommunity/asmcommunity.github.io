<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>scan code -&gt; virtual key code (depending on shift state) - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6860" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6860">scan code -&gt; virtual key code (depending on shift state)</a></p>
   <div class="post" id="post-49524">
    <div class="subject"><a href="#post-49524">scan code -&gt; virtual key code (depending on shift state)</a></div>
    <div class="body">Hi.<br />How can i convert a scan code to a virtual key code taking into consideration the state of the shift-, ctrl- and alt states?<br />For example:<br />scan code 010h maps to 071h, which equals the ASCII letter 'q'. But if Shift is down, this would map to 051h, which, of course, equals 'Q'.<br />Will i have to do that mapping all on my own for each scan code out there or is there a function which does this for me? MapVirtualKey can't take into consideration the shift, alt, ctrl-states, can it?</div>
    <div class="meta">Posted on 2002-07-23 03:57:21 by darester</div>
   </div>
   <div class="post" id="post-49544">
    <div class="subject"><a href="#post-49544">scan code -&gt; virtual key code (depending on shift state)</a></div>
    <div class="body">Try GetAsynchKeyState using the WM_KEYDOWN message to trap Ctrl + Shift + key combinations. I thing from memory yopu have to trap the WM_SYSKEYDOWN message to get Alt + combinations.<br /><br />Regards,<br /><br /><a href="mailto:hutch@movsd.com">hutch@movsd.com</a></div>
    <div class="meta">Posted on 2002-07-23 06:27:10 by hutch--</div>
   </div>
   <div class="post" id="post-49545">
    <div class="subject"><a href="#post-49545">scan code -&gt; virtual key code (depending on shift state)</a></div>
    <div class="body">maybe i didn't explain it correct...<br />i have several scan codes and i know the states of the shift-, ctrl- and alt-keys for each scan code, at the time it was generated. now i have to generate virtual key codes from this information for all scan codes.</div>
    <div class="meta">Posted on 2002-07-23 06:39:47 by darester</div>
   </div>
   <div class="post" id="post-49549">
    <div class="subject"><a href="#post-49549">scan code -&gt; virtual key code (depending on shift state)</a></div>
    <div class="body">what i wanna do is write a program in which you can enter a scan code and set the shift-, ctrl- and alt-states and using this information it should convert to a virtual key code. so i'm not reacting to user input (so no WM_KEYDOWN / GetAsyncKeyState). how else can i map that stuff to virtual key codes?</div>
    <div class="meta">Posted on 2002-07-23 07:20:29 by darester</div>
   </div>
   <div class="post" id="post-49772">
    <div class="subject"><a href="#post-49772">scan code -&gt; virtual key code (depending on shift state)</a></div>
    <div class="body">A simple table will do it...<br /><br />Just use the state of Shift,Ctrl to select what table you will use XLAT instruction could also be helpfull..</div>
    <div class="meta">Posted on 2002-07-24 08:04:41 by BogdanOntanu</div>
   </div>
   <div class="post" id="post-49787">
    <div class="subject"><a href="#post-49787">scan code -&gt; virtual key code (depending on shift state)</a></div>
    <div class="body">MSDN says to us all:<br /><br /><div class="quote">The MapVirtualKey function translates (maps) a virtual-key code into a scan code or character value, or translates a scan code into a virtual-key code. </div><br /><br /><a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/winui/winui/windowsuserinterface/userinput/keyboardinput/keyboardinputreference/keyboardinputfunctions/mapvirtualkey.asp">MapVirtualKey f-n reference on MSDN</a> <br /><br />You can try this:<br /><br /><pre><code>invoke MapVirtualKey, VK_***, 1</code></pre> <br />to translate from scan-code to virtual-key code</div>
    <div class="meta">Posted on 2002-07-24 08:31:13 by Andycar</div>
   </div>
  </div>
 </body>
</html>