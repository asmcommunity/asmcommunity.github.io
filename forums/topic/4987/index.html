<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Can anybody try this? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=4987" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=4987">Can anybody try this?</a></p>
   <div class="post" id="post-35071">
    <div class="subject"><a href="#post-35071">Can anybody try this?</a></div>
    <div class="body">Here is a window with toolbar buttons listview header bar and status bar.  The buttons work and the menus under windows 9x/ME but when I give this to my friend who uses Windows XP to try he sends me back images of this program and there is no buttons, no listview header bar only menus and status bar.  Where did the buttons go?  Has anybody had any similar toolbar button experiences with program written under Win 98 ported to XP?<br /><br />Someone please take a look at the attachment the attachment has the program, source code and a toolbarbutton.jpg showing how window should look.<br /><br /><br />any help much appreciated.<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-04-25 15:23:17 by czDrillard</div>
   </div>
   <div class="post" id="post-35073">
    <div class="subject"><a href="#post-35073">Can anybody try this?</a></div>
    <div class="body">Looks like this on WinXP:</div>
    <div class="meta">Posted on 2002-04-25 15:30:58 by bazik</div>
   </div>
   <div class="post" id="post-35074">
    <div class="subject"><a href="#post-35074">Can anybody try this?</a></div>
    <div class="body">I get the same thing as BaZik on XP.<br /><br />Note that COLOR_BTNFACE+1 is actually COLOR_BTNSHADOW on my machine.  I'm not sure if you wanted BTNSHADOW and specified it weird, or if you wanted BTNFACE and specified it wrong.  :)<br /><br />Good luck,<br /><br />-Chalain</div>
    <div class="meta">Posted on 2002-04-25 15:40:13 by Chalain</div>
   </div>
   <div class="post" id="post-35079">
    <div class="subject"><a href="#post-35079">Can anybody try this?</a></div>
    <div class="body">Win2k SP2. First image when just opened, second one when clicked on the bottom of the toolbar.<br /><br />Thomas</div>
    <div class="meta">Posted on 2002-04-25 16:00:13 by Thomas</div>
   </div>
   <div class="post" id="post-35080">
    <div class="subject"><a href="#post-35080">Can anybody try this?</a></div>
    <div class="body">Ditto for what Thomas said, but I'm running winnt4 sp6.</div>
    <div class="meta">Posted on 2002-04-25 16:40:31 by Will</div>
   </div>
   <div class="post" id="post-35163">
    <div class="subject"><a href="#post-35163">Can anybody try this?</a></div>
    <div class="body">First, thanks very much to all you people who tested this for me.  It seems to look ok under win xp, just win nt buttons not showing.  Strange that my friend got similar results to the nt view when he tested it on xp.<br /><br />I don't know why button five is completely grayed.  It is supposed to be disabled and have grayed text only.<br /><br />I don't know if it makes any difference which to use:<br /><br />mov tbb.fsState,TBSTATE_INDETERMINATE  or<br />invoke SendMessage,hToolBar,TB_ENABLEBUTTON,405,FALSE<br /> <br />they both give proper results with win98<br /><br />thanks again, and best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-04-26 10:24:01 by czDrillard</div>
   </div>
   <div class="post" id="post-35179">
    <div class="subject"><a href="#post-35179">Can anybody try this?</a></div>
    <div class="body">hey!!!<br />I got the same thing as Thomas (still not me :-)))<br />I'm running under XP.<br /><br />But, I may have the solution (maybe) for the ones who can't see the images!!<br /><br />Just decompress the package in a directory, then execute the exe file. This should work. (maybe Thomas did not decompress the zip file, he may have executed it from Winrar or something like that).</div>
    <div class="meta">Posted on 2002-04-26 14:38:31 by Vom-bonjour:-()</div>
   </div>
   <div class="post" id="post-35192">
    <div class="subject"><a href="#post-35192">Can anybody try this?</a></div>
    <div class="body">Nope, that's what I had tried.  ....still the same under winnt4 sp6.<br /><br />sorry</div>
    <div class="meta">Posted on 2002-04-26 16:30:22 by Will</div>
   </div>
   <div class="post" id="post-35208">
    <div class="subject"><a href="#post-35208">Can anybody try this?</a></div>
    <div class="body">czDrillard, you have to properly initialise *all* structure members of your local variables, otherwise they'll be filled with random data, win nt/2k/xp is very picky here.</div>
    <div class="meta">Posted on 2002-04-26 17:49:21 by Tola</div>
   </div>
   <div class="post" id="post-35294">
    <div class="subject"><a href="#post-35294">Can anybody try this?</a></div>
    <div class="body">Again thanks for the replies, I feel guilty getting this free education :)<br /><br />Tola, I find your idea very interesting.  Could you please explain it at little more.  Specifically, I am using the following three structures:<br /><br />    <br /><br /><strong>LVITEM </strong> structure<br /><br /><br /><strong>TBADDBITMAP </strong> structure<br /><br /><br /><strong>TBBUTTON </strong> Structure<br /><br /><br />I have <u>not</u> initialized all members.  For example I don't use the members <em>iString, cColumns</em> or <em>iImage</em> among others.<br /><br />Should I be initializing <u>all</u> members to zero, whether I use them or not?<br /><br />best regards,<br /><br />czDrillard</div>
    <div class="meta">Posted on 2002-04-27 11:20:38 by czDrillard</div>
   </div>
   <div class="post" id="post-35298">
    <div class="subject"><a href="#post-35298">Can anybody try this?</a></div>
    <div class="body"><div class="quote">I have not initialized all members. For example I don't use the members iString, cColumns or iImage among others. <br /><br />Should I be initializing all members to zero, whether I use them or not?</div><br />yes. set them to zero individually or just clear the entire structure before using it and then set the members you're going to use.</div>
    <div class="meta">Posted on 2002-04-27 11:45:52 by Tola</div>
   </div>
   <div class="post" id="post-35593">
    <div class="subject"><a href="#post-35593">Can anybody try this?</a></div>
    <div class="body">I got the same as Thomas at win2000pro.</div>
    <div class="meta">Posted on 2002-04-29 12:38:04 by wolfao</div>
   </div>
  </div>
 </body>
</html>