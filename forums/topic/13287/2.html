<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>External function scanner for FASM - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13287" />
  <link rel="prev" href="../?id=13287&amp;page=1" />  <link rel="next" href="../?id=13287&amp;page=3" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=13287">External function scanner for FASM</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=13287&amp;page=1" style="">&laquo;</a><a href="../?id=13287&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="13287" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=13287&amp;page=3">&gt;</a><a href="../?id=13287&amp;page=3">&raquo;</a></form>   <div class="post" id="post-106761">
    <div class="subject"><a href="#post-106761">External function scanner for FASM</a></div>
    <div class="body">Oops! Sorry me JohnFound,<br /><br />I will think of using the scripting engine.Pelaillo started his new project,so<br />I think his engine will be a good one.What do you think about?</div>
    <div class="meta">Posted on 2003-06-11 08:57:19 by Vortex</div>
   </div>
   <div class="post" id="post-106770">
    <div class="subject"><a href="#post-106770">External function scanner for FASM</a></div>
    <div class="body">Hi Vortex.<br /><br />Hm, pellailo's script will be good tool I think, but let's wait him to fiinsh it. The version he postet today here not works on my machine, but I have no free time to check it more deeply.<br /><br />About your variant scan.exe. I am not trying to run it in console. I am simply double click it in explorer. So, the console appears, then disappears and process terminate at first look. But if you press ctrl+alt+del in task manager you will see process named &quot;scan&quot; that not responds.</div>
    <div class="meta">Posted on 2003-06-11 10:01:20 by JohnFound</div>
   </div>
   <div class="post" id="post-106831">
    <div class="subject"><a href="#post-106831">External function scanner for FASM</a></div>
    <div class="body">JohnFound,<br /><br />Once again,I made the same experiment on two different O.S:Win95b and Win XP.(double clicking in<br />the explorer) No any problem with the task manager.The application terminates safely.Even,I can<br />see the welcome screen in the flashing console.<br /><br />I think Pelaillo's tool will be successfull;but he needs more time to code it.<br /><br />Regards,<br /><br />Vortex</div>
    <div class="meta">Posted on 2003-06-12 01:08:21 by Vortex</div>
   </div>
   <div class="post" id="post-106837">
    <div class="subject"><a href="#post-106837">External function scanner for FASM</a></div>
    <div class="body">Hi Vortex. <br />About hanging. It's strange. I even can't load scan.exe in Olly debuger. So, maybe this is because of msvcrt.dll . I don't write on C at all, so maybe I have not the last version of this dll. My one (in windows/system ) is version: 6.00.8797.0</div>
    <div class="meta">Posted on 2003-06-12 02:18:58 by JohnFound</div>
   </div>
   <div class="post" id="post-106841">
    <div class="subject"><a href="#post-106841">External function scanner for FASM</a></div>
    <div class="body">Hi JohnFound,<br /><br />I guessed it's a problem about the msvcrt library.Now,I recompiled the source files,<br />the scanner uses now some functions from crtdll lib (more solid) instead of the msvcrt lib.<br /><br />I think the problem was about the __getmainargs C function. :) It's changed now to __GetMainArgs<br />from crtdll lib.<br /><br />Please check the attachment if it's functionning correctly on your system.<br /><br />John,you should get a new version of msvcrt.dll from the net,this system file is used by various<br />applications.<br /><br />Personnaly,I avoided as much as possible of using C run-time functions,but this __GetMainArgs<br />function is really a very powerfull one.<br /><br />John,can you download my example &quot;getmainargs in Fasm&quot; from the Fasm section to see if<br />there is some problems?</div>
    <div class="meta">Posted on 2003-06-12 02:51:48 by Vortex</div>
   </div>
   <div class="post" id="post-106849">
    <div class="subject"><a href="#post-106849">External function scanner for FASM</a></div>
    <div class="body">Sorry Vortex. It's still hangs, absolutely the same way. And did you know, I find your program is some kind strange. It have modified DOS header, and I still can't load it in any debugger I have. Is it possible you have some viruses on your computer? :confused:</div>
    <div class="meta">Posted on 2003-06-12 03:47:29 by JohnFound</div>
   </div>
   <div class="post" id="post-106851">
    <div class="subject"><a href="#post-106851">External function scanner for FASM</a></div>
    <div class="body">JohnFound,<br /><br />I am using Kaspersky AV and F-PROT:no any virus in my executables.<br /><br />Are you sure that your O.S. is functionning without problem? Which version of Windows<br />do you have?</div>
    <div class="meta">Posted on 2003-06-12 03:59:11 by Vortex</div>
   </div>
   <div class="post" id="post-106858">
    <div class="subject"><a href="#post-106858">External function scanner for FASM</a></div>
    <div class="body">So, I am with:<br /><br />Windows 95 osr2 with installed active desktop, diferent service packs and updates and IE5.5.<br /><br />I have no any problems with any installed software. <br />Only I can't install DX8.1 :grin: <br /><br />I made some other tests and IMO the problem with scan is not on the run stage, but on the load stage, and I find this very strange...furthermore, scan works fine when I start it from console. <br /><br />I will try to make some other tests, but I have no time right now.<br /><br />Regards.</div>
    <div class="meta">Posted on 2003-06-12 04:39:08 by JohnFound</div>
   </div>
   <div class="post" id="post-106859">
    <div class="subject"><a href="#post-106859">External function scanner for FASM</a></div>
    <div class="body">Scan.exe examined with LordPE<br />No any abnormality.</div>
    <div class="meta">Posted on 2003-06-12 04:41:48 by Vortex</div>
   </div>
   <div class="post" id="post-106860">
    <div class="subject"><a href="#post-106860">External function scanner for FASM</a></div>
    <div class="body">Hi JohnFound,<br /><br />I forgot to say:my app. is built on a Win95b system.<br /><br />I hope you will be able to discover the reason of this mysterious event.</div>
    <div class="meta">Posted on 2003-06-12 04:44:21 by Vortex</div>
   </div>
   <div class="post" id="post-107253">
    <div class="subject"><a href="#post-107253">Kernel32.dll exports unsorted !!</a></div>
    <div class="body">I've having some unexpected results due to the exported functions table.<br /><br />It seems that Micro$oft does not follow their own rules! I find a kernel32.dll on win ME that have some function names in the wrong place... so now I have a partially sorted names list: the worst possible thing at all!!!<br /><br />Now I am taking two ways: first one is to sort the table and then search. The second is to use a modified Boyer Moore to search the function on the unsorted names.<br /><br />It is common to find unsorted export functions in dlls?<br />Or there is a very abnormal kernel32.dll?</div>
    <div class="meta">Posted on 2003-06-16 06:15:46 by pelaillo</div>
   </div>
   <div class="post" id="post-107255">
    <div class="subject"><a href="#post-107255">External function scanner for FASM</a></div>
    <div class="body">Pelaillo,<br /><br />There is no any problem with the kernel32.dll provided by Win95b and Win XP.<br />These unsorted function names are  maybe specific to Win ME.</div>
    <div class="meta">Posted on 2003-06-16 07:32:10 by Vortex</div>
   </div>
   <div class="post" id="post-107581">
    <div class="subject"><a href="#post-107581">External function scanner for FASM</a></div>
    <div class="body">Vortex,<br /><br />Could you add support for indirect call (will be used with Link.exe)?<br /><br />for example MessageBox -&gt; '_MessageBoxA@16'<br />                   InitCommonControls -&gt; '_InitCommonControls@0'</div>
    <div class="meta">Posted on 2003-06-19 07:29:33 by Bi_Dark</div>
   </div>
   <div class="post" id="post-107698">
    <div class="subject"><a href="#post-107698">External function scanner for FASM</a></div>
    <div class="body">Bi_Dark,<br /><br />My tool inc2inc supports the use of Fasm with MS Link:<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/showthread.php?threadid=8994">http://www.asmcommunity.net/board/showthread.php?threadid=8994</a><br /><br />This tool creates special include files for Fasm from Hutch's masm32 include<br />file set.<br /><br />The latest release 1.03 is very simple to use.You can check the examples.<br /><br />The advantage inc2inc is that you can use static libraries such as masm32.lib<br />with Fasm.<br /><br />Regards,<br /><br />Vortex</div>
    <div class="meta">Posted on 2003-06-20 06:40:49 by Vortex</div>
   </div>
   <div class="post" id="post-107781">
    <div class="subject"><a href="#post-107781">External function scanner for FASM</a></div>
    <div class="body">Bi_Dark,<br /><br />Now,the scanner V2.0 supports the indirect call for Fasm+MS Link<br /><br />Here are two new include files for ther scanner.<br /><br />All you need:<br /><br />The scanner V2.0 included in the zip file- ( You cannot get the number of pushed API function <br />parameters from the system DLLs. :) This is why we need of the V2.0 )<br /><br />To use the scanner:<br /><br /><pre><code><br />scan sourcefile.asm -a<br /></code></pre><br /><br />You can check the example in the attachment.<br /><br />If you have any other questions,please let me know.<br /><br />Regards,<br /><br />Vortex</div>
    <div class="meta">Posted on 2003-06-21 03:41:54 by Vortex</div>
   </div>
   <div class="post" id="post-107837">
    <div class="subject"><a href="#post-107837">External function scanner for FASM</a></div>
    <div class="body">I didn't mean that....,<br /><br />I mean &quot;extrn '_MessageBoxA@16' as MessageBox&quot; &lt;--- no 'dword' appended<br /><br />and will be called via jump table<br /><br /><pre><code><br />  push 0<br />  push 0<br />  push 0<br />  push 0<br />  call MessageBox  &lt;--- not &#91;MessageBox&#93;<br /><br />MessageBox&#58;<br />jmp dword &#91;__imp_MessageBoxA@16&#93; &lt;--- Linker will do the indirect job for me<br /></code></pre><br /><br />coz I'm too lazy to type square bracket 'call ', that why I need it :tongue:</div>
    <div class="meta">Posted on 2003-06-21 19:44:16 by Bi_Dark</div>
   </div>
   <div class="post" id="post-107879">
    <div class="subject"><a href="#post-107879">External function scanner for FASM</a></div>
    <div class="body">Bi_Dark,<br /><br />O.K,I will add this future to the V2.0 :)</div>
    <div class="meta">Posted on 2003-06-22 09:03:13 by Vortex</div>
   </div>
   <div class="post" id="post-107951">
    <div class="subject"><a href="#post-107951">External function scanner for FASM</a></div>
    <div class="body">Bi_Dark,<br /><br />Here is for you the scanner now able to process indirect calls. :)<br />I modified stdcall.inc for the indirect method.<br />You can check the example in the attachment.</div>
    <div class="meta">Posted on 2003-06-23 04:32:44 by Vortex</div>
   </div>
   <div class="post" id="post-108062">
    <div class="subject"><a href="#post-108062">External function scanner for FASM</a></div>
    <div class="body">Vortex,<br /><br />Yo rock! :cool:</div>
    <div class="meta">Posted on 2003-06-24 01:29:30 by Bi_Dark</div>
   </div>
   <div class="post" id="post-108517">
    <div class="subject"><a href="#post-108517">External function scanner for FASM</a></div>
    <div class="body">Since fasm's forum allows the attachments now, you can also release it there.</div>
    <div class="meta">Posted on 2003-06-28 04:51:08 by Tomasz Grysztar</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=13287&amp;page=1" style="">&laquo;</a><a href="../?id=13287&amp;page=1" style="">&lt;</a><input type="hidden" name="id" value="13287" /><input type="number" name="page" min="1" max="3" step="1" value="2" onchange="this.form.submit();" /><a href="../?id=13287&amp;page=3">&gt;</a><a href="../?id=13287&amp;page=3">&raquo;</a></form>  </div>
 </body>
</html>