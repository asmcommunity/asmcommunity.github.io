<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Finding network device registry keys - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=10996" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=10996">Finding network device registry keys</a></p>
   <div class="post" id="post-82835">
    <div class="subject"><a href="#post-82835">Finding network device registry keys</a></div>
    <div class="body">Hi,<br /><br />OK, here goes, hope this is understandable!<br /><br />I have a combo box with a list of network devices and I want to be able to change the registry values (WinXP &amp; others) for the device selected from the combo box.<br /><br />I need to find the registry keys relevant to the network interface selected from the combo, so if someone chooses the first card, I can then change the registry values for that card, for example, the values might be at;<br /><br />HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\Interfaces\{0E1234A1-A567-1F23-4B1B-23B456F78ADD}<br /><br />I have searched everywhere, but can't find out how to retrieve the registry key for a specific device.<br /><br />A solution for any compiler will do, though I'm using Masm. If someone could point me in the right direction as to where to look, what functions, other relevant registry keys... anything!<br /><br />One app that achieves similar to what I require is DRTCP (which is written in VB so no use to me, I get lost in its bloated routines);<br /><br />The combo at the bottom :<br /><a target="_blank" href="http://www.dslreports.com/front/DRTCP021.zip">http://www.dslreports.com/front/DRTCP021.zip</a><br /><br />Thanks<br /><br />BTW: At the moment I'm getting the device values with GetIfTable but maybe I should be looking into the registry for the device list?<br />Seems I'm going about this wrongly?!</div>
    <div class="meta">Posted on 2003-02-20 19:28:22 by Drmres</div>
   </div>
   <div class="post" id="post-82837">
    <div class="subject"><a href="#post-82837">Finding network device registry keys</a></div>
    <div class="body">Download RegMon from Sysinternals first... then 1. run regmon, 2. run DRTCP and it will show you all the registry keys DRTCP opens and querys. :-)<br /><br />One thing.. BE CAREFUL!  Read the docs about what you are about to make.  If you do not understand the TCP protocal, you can really mess up the connections... Win9.x is much differant than Win NT.  and W2K/XP has hidden settings.... read, read, read... MS has some docs about this, you have to dig for them though..<br /><br />Have fun!</div>
    <div class="meta">Posted on 2003-02-20 19:48:16 by Gunner</div>
   </div>
   <div class="post" id="post-82848">
    <div class="subject"><a href="#post-82848">Finding network device registry keys</a></div>
    <div class="body">I have already tried this and found next to nothing (this is how I found the key in my original post). I have also gone through all msdn docs that I thought may shed some light (although their search facility is pathetic), IDAd and Ollyd DrTCP (but it's VB - say no more), googled 'til I can google no more and still no luck!<br /><br />This is what is puzzling me, it must be easy enough to do but I can't find a hint, I really have tried all I can think of, which leads me to think I'm looking at this the wrong way.<br /><br />It's finding the link between the adapter and the registry key that I can't work out - how to look up the correct key. :confused:</div>
    <div class="meta">Posted on 2003-02-20 20:45:11 by Drmres</div>
   </div>
   <div class="post" id="post-82852">
    <div class="subject"><a href="#post-82852">Finding network device registry keys</a></div>
    <div class="body">I don't think you RegMon'd DrTCP cause I just did and DrTCP accessed the registry 640 times.  Although much of it in non important because most of it is what windows looks up as it loads a program.  There are many &quot;network&quot; keys accessed!  It is not only 1 key but a few.  When I looked into what you are doing, a few years ago, I found many great docs about it.  Don't have any links right now, but basically, you get the value from one key, the value you get is another key, take that value and open the key and query what you want... it is kinda complicated but the docs helps... since you have been to dslr, check there, I think there were a few docs there, check <a target="_blank" href="http://www.winguides.com/registry/">http://www.winguides.com/registry/</a> it has a few settings described there and the keys... do a google and you WILL find the docs.</div>
    <div class="meta">Posted on 2003-02-20 21:13:41 by Gunner</div>
   </div>
   <div class="post" id="post-82854">
    <div class="subject"><a href="#post-82854">Finding network device registry keys</a></div>
    <div class="body">Obviously it doesn't access just 1 key!<br /><br />The key in my post is just an example - the location that I want to edit.<br /><br />I did regmon it when I started coding this particular procedure (wouldn't have said I had if I hadn't - there is no ignorance surrounding me) and backtraced to see if I could determine how it finds the location, I only ended up no further ahead. I am not a beginner!<br /><br />I didn't think of looking at Winguides though, I'll take a look.<br /><br />Thanks for the suggestions</div>
    <div class="meta">Posted on 2003-02-20 21:28:58 by Drmres</div>
   </div>
   <div class="post" id="post-83119">
    <div class="subject"><a href="#post-83119">Finding network device registry keys</a></div>
    <div class="body">Still no luck with this. Any ideas anyone... (please!) ?</div>
    <div class="meta">Posted on 2003-02-22 09:54:51 by Drmres</div>
   </div>
   <div class="post" id="post-84938">
    <div class="subject"><a href="#post-84938">Finding network device registry keys</a></div>
    <div class="body">hope the follwing link helps :<br /><br /><a target="_blank" href="http://www.corecom.com/html/boost.html">http://www.corecom.com/html/boost.html</a></div>
    <div class="meta">Posted on 2003-03-04 07:13:12 by himanshu</div>
   </div>
   <div class="post" id="post-84946">
    <div class="subject"><a href="#post-84946">Finding network device registry keys</a></div>
    <div class="body">another one :<br /><br /><a target="_blank" href="http://www.jsifaq.com/SUBI/tip4000/rh4015.htm">http://www.jsifaq.com/SUBI/tip4000/rh4015.htm</a></div>
    <div class="meta">Posted on 2003-03-04 07:27:58 by himanshu</div>
   </div>
  </div>
 </body>
</html>