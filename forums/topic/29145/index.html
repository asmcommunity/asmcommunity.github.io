<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Some questions about SEGMENT definition  - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29145" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=29145">Some questions about SEGMENT definition </a></p>
   <div class="post" id="post-205864">
    <div class="subject"><a href="#post-205864">Some questions about SEGMENT definition </a></div>
    <div class="body">Dear all:<br />&nbsp; &nbsp; For me, segment is a complex concept, and segment definition is a very difficult work. But segment is also a very important concept in assembly language. There are some basic questions puzzled me a long time:<br />&nbsp; &nbsp; 1. As i have known, a segment must start at address 0xxx0H, why can segment align type&nbsp; be&nbsp; BYTE,WORD, DWORD?<br />&nbsp; &nbsp; 2. In segment definiton, we can declare &#039;CLASS&#039; to control segments loading order, but when will we need to order the segments in memory?&nbsp;  <br />&nbsp; &nbsp; 3. We use GROUP directive to group two or more small segments into one physical segment, but when a segment is a member of segment group, but also assumed by it&#039;s own segment name with a segment register, how can we calculate the offser address in the segment.<br />&nbsp; &nbsp;  ------------------------------------------------------------------------<br />&nbsp; &nbsp;  .alpha <br />&nbsp; &nbsp;  gseg&nbsp;  group&nbsp;  dseg, eseg <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;  dseg&nbsp;  segment&nbsp;  <br />&nbsp; &nbsp;  szMsg1&nbsp;  db&nbsp;  &quot;This is the string in data segment!&quot;,13, 10, &#039;$&#039; <br />&nbsp; &nbsp;  szMsg3&nbsp;  db&nbsp;  13, 10, &#039;$&#039; <br />&nbsp; &nbsp;  dseg&nbsp; &nbsp; ends <br /><br />&nbsp; &nbsp;  eseg&nbsp;  segment&nbsp;  <br /><br />&nbsp; &nbsp;  szMsg2 db&nbsp; &#039;This is the string in extra segment!&#039;,13, 10, &#039;$&#039; <br />&nbsp; &nbsp;  i&nbsp; db&nbsp; &#039;M&#039; <br />&nbsp; &nbsp;  eseg ends <br /><br />&nbsp; &nbsp;  sseg&nbsp; &nbsp; segment stack&nbsp;  <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db 100h DUP(?)&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;  sseg&nbsp; &nbsp; ends <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp;  cseg segment&nbsp; <br />&nbsp; &nbsp;  assume cs:cseg,&nbsp; ss:sseg, es:eseg,ds:gseg <br />&nbsp; &nbsp;  start: <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ax, gseg <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ds, ax <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ax, eseg <br />&nbsp; &nbsp; &nbsp; &nbsp; mov es, ax <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; lea dx, szMsg1 <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ah, 9 <br />&nbsp; &nbsp; &nbsp; &nbsp; int 21h <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; lea dx, szMsg2 <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ah, 9 <br />&nbsp; &nbsp; &nbsp; &nbsp; int 21h <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ah, 02h <br />&nbsp; &nbsp; &nbsp; &nbsp; mov dl, i&nbsp; &nbsp; ?<strong>***** Please Note here  </strong> <br />&nbsp; &nbsp; &nbsp; int 21h <br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; lea dx, szMsg3 <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ah, 9 <br />&nbsp; &nbsp; &nbsp; &nbsp; int 21h <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ah, 1 <br />&nbsp; &nbsp; &nbsp; &nbsp; int 21h <br />&nbsp; &nbsp; &nbsp; &nbsp; mov ax, 4C00h <br />&nbsp; &nbsp; &nbsp; &nbsp; int 21h <br />&nbsp; &nbsp; cseg&nbsp; &nbsp; ends <br />&nbsp; &nbsp; end start <br />&nbsp; -------------------------------------------------------<br />In &quot;mov dl, i&quot;, what is the offset address&nbsp; of i?&nbsp; </div>
    <div class="meta">Posted on 2008-09-04 02:28:49 by qlmi</div>
   </div>
   <div class="post" id="post-205866">
    <div class="subject"><a href="#post-205866">Re: Some questions about SEGMENT definition </a></div>
    <div class="body">1. A segment doesn&#039;t need inevitably to start at address 0.<br />An alignment directive becomes important if a segment joins a previous memory area and the very first offset should have an appropriate aligned value. Default alignment should be 10h (PARA).<br /><br />2. The final ordering of memory locations is done by the linker. In general it uses the same ordering as the assembler does. I recommend reading the manual for the versatile OpenWatcom-linker WLINK (see directives &quot;OPTION DOSSEG&quot; and &quot;ORDER&quot;).<br /><br />3. With a GROUP directive several segments can be joined together as if they were only one. Start offsets of following segments will receive the last used offsets by previous segments plus the alignment value.<br /><br />The real number of the offset address of your variable &quot;i&quot; is unimportant. It will be a relative address calculated by the assembler and the linker.<br />If I am right it should have the relative value:<br />STARTOFS_dseg + ALIGNMENT_eseg + LENGTH_OF_STRING_szMsg2</div>
    <div class="meta">Posted on 2008-09-04 05:56:06 by TasmDev</div>
   </div>
   <div class="post" id="post-205869">
    <div class="subject"><a href="#post-205869">Re: Some questions about SEGMENT definition </a></div>
    <div class="body"><div class="quote"><br />1. A segment doesn&#039;t need inevitably to start at address 0.<br />An alignment directive becomes important if a segment joins a previous memory area and the very first offset should have an appropriate aligned value. Default alignment should be 10h (PARA).<br /><br />2. The final ordering of memory locations is done by the linker. In general it uses the same ordering as the assembler does. I recommend reading the manual for the versatile OpenWatcom-linker WLINK (see directives &quot;OPTION DOSSEG&quot; and &quot;ORDER&quot;).<br /><br />3. With a GROUP directive several segments can be joined together as if they were only one. Start offsets of following segments will receive the last used offsets by previous segments plus the alignment value.<br /><br />The real number of the offset address of your variable &quot;i&quot; is unimportant. It will be a relative address calculated by the assembler and the linker.<br />If I am right it should have the relative value:<br />STARTOFS_dseg + ALIGNMENT_eseg + LENGTH_OF_STRING_szMsg2<br /></div><br />Thanks for your help!<br />For the nomber 2&amp;3 questions, I have totally understood your answer. But I can&#039;t find the manual for the versatile OpenWatcom-linker WLINK, would you please send me a copy of this document via email: miquanlin@163.com?<br />&nbsp;  </div>
    <div class="meta">Posted on 2008-09-04 22:02:49 by qlmi</div>
   </div>
   <div class="post" id="post-205906">
    <div class="subject"><a href="#post-205906">Re: Some questions about SEGMENT definition </a></div>
    <div class="body">TasmDev :<br />&nbsp;  Please check your message box on this forum.</div>
    <div class="meta">Posted on 2008-09-11 10:39:17 by qlmi</div>
   </div>
  </div>
 </body>
</html>