<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Simple Code &quot;Check CRC32 from myself EXE&quot; - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=6270" />
    <link rel="next" href="../?id=6270&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=6270">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=6270&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=6270&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="6270" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=6270&amp;page=2">&gt;</a><a href="../?id=6270&amp;page=2">&raquo;</a></form>   <div class="post" id="post-45084">
    <div class="subject"><a href="#post-45084">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">Hello,<br /><br />Who Can help me.<br />I look of a simple Code i included and it compare<br />the File with the CRC32 or simple CRC.<br />I Can include CRC - Code manuell in compiled exe file with<br />hexeditor.<br /><br />I need a simple code.<br /><br />Thanks.</div>
    <div class="meta">Posted on 2002-06-25 05:42:27 by Fred556</div>
   </div>
   <div class="post" id="post-45086">
    <div class="subject"><a href="#post-45086">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">I?m not sure what u?re lookin for since i don?t understand ur question ..if u?re lookin for an CRC32 algo check the <br />Algorithms &amp; Source Code Part of the Forum there was recently a dicsussion about CRC32</div>
    <div class="meta">Posted on 2002-06-25 05:56:37 by Allanon</div>
   </div>
   <div class="post" id="post-45090">
    <div class="subject"><a href="#post-45090">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">Sorry for my bad english.<br /><br />I need a small source it check CRC in my EXE File.</div>
    <div class="meta">Posted on 2002-06-25 06:05:48 by Fred556</div>
   </div>
   <div class="post" id="post-45095">
    <div class="subject"><a href="#post-45095">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">Fred556,<br />Allanon already gave you the correct answer.<br />If you search for &quot;CRC&quot; in the &quot;Algorithm &amp; Source Code&quot; forum with the search engine of this board, you will come up with this thread:<br /><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=4628&amp;highlight=crc">http://www.asmcommunity.net/board/index.php?topic=4628&amp;highlight=crc</a><br /><br /><br />Regards,<br />bAZiK</div>
    <div class="meta">Posted on 2002-06-25 06:25:34 by bazik</div>
   </div>
   <div class="post" id="post-45448">
    <div class="subject"><a href="#post-45448">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">Store your CRC in an unused portion of the MZ header. Obviously<br />only calculate CRC from the end of MZ header to the end of file.<br />At runtime, read MZ header from disk (or access at IMAGEBASE from<br />memory), get the CRC32 value, and sum up the rest of the file.<br />Easy as eating pies :)</div>
    <div class="meta">Posted on 2002-06-27 13:31:25 by f0dder</div>
   </div>
   <div class="post" id="post-45472">
    <div class="subject"><a href="#post-45472">but...</a></div>
    <div class="body">someone will modify your program (crack,infect with virus...) and re-calculate the CRC .... or simply crack the code that performs the check .. or ... X). But what the hell ... its funny to learn protection schemes.</div>
    <div class="meta">Posted on 2002-06-27 16:52:59 by hunter</div>
   </div>
   <div class="post" id="post-45474">
    <div class="subject"><a href="#post-45474">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">And indeed hunter is right - most implementations of self-checks are<br />embarrasing to look at. Use standard routines, have a single point<br />of failure, etc. And often they don't do anything but bother the<br />legitimate users.</div>
    <div class="meta">Posted on 2002-06-27 16:57:34 by f0dder</div>
   </div>
   <div class="post" id="post-47736">
    <div class="subject"><a href="#post-47736">Re: but...</a></div>
    <div class="body"><div class="quote"><br />someone will modify your program (crack,infect with virus...) and re-calculate the CRC .... or simply crack the code that performs the check .. or ... X). But what the hell ... its funny to learn protection schemes. </div><br /><br />Yeah, but it is so much fun to slow them down and <br />you can often frustrate them.</div>
    <div class="meta">Posted on 2002-07-15 13:05:15 by skywalker</div>
   </div>
   <div class="post" id="post-47788">
    <div class="subject"><a href="#post-47788">Another question about crc...</a></div>
    <div class="body">Hello,<br /><br />can I use the same code that is used for creating file's CRCs for strings?<br /><br />Thanks,<br />sF</div>
    <div class="meta">Posted on 2002-07-15 16:37:04 by stealthFIGHTER</div>
   </div>
   <div class="post" id="post-47834">
    <div class="subject"><a href="#post-47834">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">Assuming your routine takes pointer to data and its size as input, then yes.</div>
    <div class="meta">Posted on 2002-07-15 22:56:29 by comrade</div>
   </div>
   <div class="post" id="post-47858">
    <div class="subject"><a href="#post-47858">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body"><div class="quote"><br />Store your CRC in an unused portion of the MZ header. Obviously<br />only calculate CRC from the end of MZ header to the end of file.<br />At runtime, read MZ header from disk (or access at IMAGEBASE from<br />memory), get the CRC32 value, and sum up the rest of the file.<br />Easy as eating pies :) </div><br /><br />Is this method *portable* and secure?<br />I mean, isn't it dangerous to put informations in unused room (reserved room?) of the MZ header (pe-header?)... I'm especially thinking about next windows versions...<br /><br />I didn't really worked on such headers for now... and your method to put some informations here is interesting me...<br /><br />Thanks.</div>
    <div class="meta">Posted on 2002-07-16 01:21:28 by JCP</div>
   </div>
   <div class="post" id="post-47868">
    <div class="subject"><a href="#post-47868">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">Hi <strong>Readiosys</strong>:<br /><br />Although f0dder (and others) knows surely better than me, from my own reasonings, these are absolutely sure:<br /><br />---<br /><br />WORD @ MajorImageVersion<br />WORD @ MinorImageVersion<br /><br />BYTE @ MajorLinkerVersion<br />BYTE @ MinorLinkerVersion<br /><br />and definitely a lot of places in the DOS stub ;) (which gets mapped by the Windows loader)<br /><br />---<br /><br />This one in the PE is probably sure too, but there's no absolute guarantee:<br /><br />DWORD @ Win32VersionValue (a.k.a. Reserved.. i.e. the DWORD just before SizeOfImage)<br /><br />---</div>
    <div class="meta">Posted on 2002-07-16 03:26:10 by Maverick</div>
   </div>
   <div class="post" id="post-47880">
    <div class="subject"><a href="#post-47880">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">Thanks a lot ;)<br /><br /><div class="quote">WORD @ MajorImageVersion<br />WORD @ MinorImageVersion<br /></div><br /><br />Seems really appropried to receive a 32-bit CRC. ;)</div>
    <div class="meta">Posted on 2002-07-16 05:03:49 by JCP</div>
   </div>
   <div class="post" id="post-47882">
    <div class="subject"><a href="#post-47882">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body"><pre><code><br /> IMAGE_OPTIONAL_HEADER&#58;<br /><br /> +-----------------------------------? --- +0000004Ch<br /> ?            Reserved1              ?       Size &#58; 1 DWORD<br /> +-----------------------------------?<br /></code></pre><br />i always use this one. and i think it IS secure. ms should<br />already know that many programs like exe-packers use<br />those &quot;reserved&quot; spaces. but yes, they could change it<br />in future so if you*'re really paranoid i think the original<br />MZ header is better suited for you :)<br /><br />(oops sorry maverick, you meant this one... :stupid: )<br /><br />to make this post a little bit &quot;usefull&quot; here's the code to<br />read your checksum:<br /><pre><code><br />        INVOKE          GetModuleHandle, NULL<br />        MOV             EDI, EAX<br /><br />        ADD             EDI, &#91; EDI + 03CH &#93;          <br />        MOV             EAX, &#91; EDI + 04CH &#93;     ; EAX -&gt; CRC32<br /></code></pre></div>
    <div class="meta">Posted on 2002-07-16 05:26:51 by mob</div>
   </div>
   <div class="post" id="post-47904">
    <div class="subject"><a href="#post-47904">Re: Another question about crc...</a></div>
    <div class="body"><div class="quote"><em>Originally posted by stealthFIGHTER </em><br /><strong>Hello,<br /><br />can I use the same code that is used for creating file's CRCs for strings?<br /><br />It should work for strings as well. Are you looking for a way to keep someone from changing text that your executable displays. I have some code that will encrypt strings and decrypt it at runtime. I found some other ways that really gives dissassemblers fits. They will give an assembly file that can produce an working executable, but it is twice the original size.</div>
    <div class="meta">Posted on 2002-07-16 07:55:59 by skywalker</div>
   </div>
   <div class="post" id="post-47905">
    <div class="subject"><a href="#post-47905">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body"><div class="quote"><em>Originally posted by Readiosys </em><br /><strong><br /><br />Is this method *portable* and secure?<br />I mean, isn't it dangerous to put informations in unused room (reserved room?) of the MZ header (pe-header?)... I'm especially thinking about next windows versions...<br /><br />I can't think of any valid reasons to store the CRC in the header. It would be safer to encrypt and store it in the code section. Putting dummy strings around it also makes disassembly much more <br />difficult. Use of the extended ASCII characters makes some of the code actually look like actual code to debug and IDAFW.</div>
    <div class="meta">Posted on 2002-07-16 08:02:00 by skywalker</div>
   </div>
   <div class="post" id="post-47919">
    <div class="subject"><a href="#post-47919">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body"><div class="quote"><br />Thanks a lot ;)<br /><br /><br /><br />Seems really appropried to receive a 32-bit CRC. ;) </div><br /><strong>Readiosys</strong>: good choice.. :)<br />If I can give you a quite obvious advice (I do so because other people here, beginners, may read too, and I've seen a problem in this regard many times) the best thing to do would be to make many check routines.. not just one. Cracking 10 of them is harder than cracking 1 of them. What about 1000? You (cr?cker) have to find them anyway, and remove them all. 1000 take some serious time. But one must not use the same code for all 1000, otherwise a simple pattern matching will find and remove all of them in one shot. Here having your own compiler helps a lot, I reckon. ;)<br />Also, crypting your EXE (with your own crypter, not a standard/known one) and making use of self-modifying code to generate these check routines sure helps..<br />CRC-32 has been cracked anyway, so one should find a more secure algorithm (what about making your own? unknown algorithms are harder to cr?ck.. :grin: ), otherwise storing the checksum in a single DWORD becomes then the weak point..<br /><br />I can't disclose too many brainfarting ideas here.. but in my experience the above if applied correctly is enough for most situations. The hardest part is about EXE crypting and having your own protection_code generator (compiler) to avoid to write by hand 1000 original, sufficiently_different check routines.<br /><br />Also, be careful about the extreme weakness of standard solutions like CRC-32.</div>
    <div class="meta">Posted on 2002-07-16 09:05:27 by Maverick</div>
   </div>
   <div class="post" id="post-47929">
    <div class="subject"><a href="#post-47929">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">I'd rather use the MZ header than the PE header for storing the<br />checksum. Mostly a matter of taste, I guess. There's lots of unused<br />room in the MZ header, and you can be pretty sure microsoft isn't<br />going to come up with uses for it - while that *might* (though not<br />very likely) happen with some of the PE fields.</div>
    <div class="meta">Posted on 2002-07-16 09:58:30 by f0dder</div>
   </div>
   <div class="post" id="post-47930">
    <div class="subject"><a href="#post-47930">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body">In one of my programms, I overwrite the stupid &quot;This program cannot be run in DOS mode&quot; message with a MD5 sum ;)</div>
    <div class="meta">Posted on 2002-07-16 10:01:44 by bazik</div>
   </div>
   <div class="post" id="post-47985">
    <div class="subject"><a href="#post-47985">Simple Code &quot;Check CRC32 from myself EXE&quot;</a></div>
    <div class="body"><div class="quote"><br />Assuming your routine takes pointer to data and its size as input, then yes. </div><br /><br />Hi,<br /><br />thank you for your reply. And please, can you provide little example how to use CRC on string?<br /><br />Regards,<br />sF</div>
    <div class="meta">Posted on 2002-07-16 15:35:09 by stealthFIGHTER</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=6270&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=6270&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="6270" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=6270&amp;page=2">&gt;</a><a href="../?id=6270&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>