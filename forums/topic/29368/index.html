<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>uFMOD and MASM32 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=29368" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=116">Windows</a> &raquo; <a href="../?id=29368">uFMOD and MASM32</a></p>
   <div class="post" id="post-207356">
    <div class="subject"><a href="#post-207356">uFMOD and MASM32</a></div>
    <div class="body">Hello everyone. As this is my first message on the boards, I want to warn you: I am a total coding and assembly noob. I am willing to learn, however, and I figured a good way of gaining knowledge is trying things for myself and asking around. This will probably be one of many noob questions, but since an assembly langiage messageboard if surely full of people who know this and that about this stuff, I hope answering me won&#039;t be a bother.<br /><br />So what is my problem? I downloaded and installed MASM32 and wanted to play around with uFMOD. I downloaded the uFMOD package containing the example files, also those for MASM32. I was interested in either the DirectX version, or the WinMM one.<br /><br />Basically all I wanted to do is exchange the default tune the program plays, but I have no idea how. The code for DirectX version is:<br /><br /><pre><code><br />; Setup actual sampling rate in Hz. (48KHz is the default value.)<br />uFMOD_MixRate EQU 48000<br /><br />.386<br />.model flat,stdcall<br /><br />; Win32 API<br />proto_stdcall_arg0 typedef PROTO<br />proto_stdcall_arg1 typedef PROTO :DWORD<br />proto_stdcall_arg3 typedef PROTO :DWORD,:DWORD,:DWORD<br />proto_stdcall_arg4 typedef PROTO :DWORD,:DWORD,:DWORD,:DWORD<br />externdef _imp__ExitProcess@4:PTR proto_stdcall_arg1<br />ExitProcess equ &lt;_imp__ExitProcess@4&gt;<br />externdef _imp__MessageBoxA@16:PTR proto_stdcall_arg4<br />MessageBox equ &lt;_imp__MessageBoxA@16&gt;<br />externdef _imp__GetForegroundWindow@0:PTR proto_stdcall_arg0<br />GetForegroundWindow equ &lt;_imp__GetForegroundWindow@0&gt;<br />externdef _imp__DirectSoundCreate@12:PTR proto_stdcall_arg3<br />DirectSoundCreate equ &lt;_imp__DirectSoundCreate@12&gt;<br />includelib kernel32.lib<br />includelib user32.lib<br />includelib dsound.lib<br /><br />; uFMOD (DirectX)<br />include dsufmod.inc<br /><br />.DATA<br /><br />; Let&#039;s place the stream right inside the data section.<br />xm_length EQU 905<br />xm LABEL BYTE<br />xm_unused_000 LABEL BYTE<br /><br />; *** The following 60 bytes are not used and<br />; *** we&#039;ll substitute them with useful data<br />; (the actual size and location of such gaps<br />; may be found out using the Eff utility)<br /><br />; Wave format descriptor used to configure the DirectSound buffer<br />pcm	dd 20001h &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; wFormatTag &lt;= WAVE_FORMAT_PCM, nChannels &lt;= 2<br />	dd uFMOD_MixRate<br />	dd uFMOD_MixRate*4<br />	dd 100004h &nbsp; &nbsp; &nbsp; &nbsp; ; wBitsPerSample &lt;= 16, nBlockAlign &lt;= 4<br />	dd 0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; cbSize &lt;= 0 (no extra info)<br /><br />; DirectSound buffer descriptor<br />bufDesc dd 20 ; DSBUFFERDESC1<br />	 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;; (for older DirectX versions compatibility)<br />	dd 14000h ; dwFlags &lt;= DSBCAPS_STICKYFOCUS OR DSBCAPS_GETCURRENTPOSITION2<br />	dd uFMOD_BUFFER_SIZE ; dwBufferBytes<br />	dd 0<br />	dd pcm &nbsp; &nbsp;; lpwfxFormat<br /><br />lpDS &nbsp; &nbsp;dd 0 ; -&gt; IDirectSound<br />lpDSBuf dd 0 ; -&gt; IDirectSoundBuffer<br /><br />; Error message<br />szError db &quot;DirectSound&quot;,0<br /><br />org xm_unused_000 + 60<br />	db 034h,000h,000h,000h,020h,000h,000h,000h,002h,000h,00Dh,000h,001h,000h,001h,000h<br />	db 00Ah,000h,091h,000h,000h,001h,002h,003h,004h,005h,006h,007h,000h,001h,002h,003h<br />	db 004h,005h,006h,007h,008h,009h,00Ah,00Bh,008h,009h,00Ch,00Bh,008h,009h,00Ah,00Bh<br />	db 008h,009h,00Ch,00Bh,009h,000h,000h,000h,000h,004h,000h,001h,000h,083h,016h,001h<br />	db 080h,080h,02Eh,001h,000h,00Eh,060h,080h,03Ah,001h,000h,00Eh,062h,081h,061h,083h<br />	db 035h,001h,009h,000h,000h,000h,000h,004h,000h,001h,000h,083h,016h,001h,080h,080h<br />	db 02Eh,001h,000h,00Eh,060h,080h,035h,001h,000h,00Eh,062h,081h,061h,083h,038h,001h<br />	db 009h,000h,000h,000h,000h,004h,000h,001h,000h,083h,016h,001h,080h,080h,02Eh,001h<br />	db 000h,00Eh,060h,080h,038h,001h,000h,00Eh,062h,080h,083h,033h,001h,009h,000h,000h<br />	db 000h,000h,006h,000h,001h,000h,083h,016h,001h,080h,080h,02Eh,001h,000h,00Eh,060h<br />	db 080h,033h,001h,000h,00Eh,061h,081h,061h,083h,035h,001h,083h,00Dh,001h,083h,036h<br />	db 001h,080h,083h,036h,001h,009h,000h,000h,000h,000h,004h,000h,001h,000h,083h,00Fh<br />	db 001h,080h,080h,02Eh,001h,000h,00Eh,060h,080h,036h,001h,000h,00Eh,062h,081h,061h<br />	db 083h,033h,001h,009h,000h,000h,000h,000h,006h,000h,001h,000h,083h,00Fh,001h,080h<br />	db 080h,02Eh,001h,000h,00Eh,060h,080h,033h,001h,000h,00Eh,061h,081h,061h,083h,02Eh<br />	db 001h,083h,012h,001h,083h,033h,001h,080h,083h,035h,001h,009h,000h,000h,000h,000h<br />	db 006h,000h,001h,000h,083h,016h,001h,080h,080h,02Eh,001h,000h,00Eh,060h,080h,035h<br />	db 001h,000h,00Eh,061h,081h,061h,083h,02Eh,001h,083h,00Dh,001h,083h,031h,001h,080h<br />	db 083h,02Eh,001h,009h,000h,000h,000h,000h,008h,000h,001h,000h,083h,012h,001h,098h<br />	db 00Ah,001h,083h,019h,001h,088h,00Ah,083h,01Eh,001h,081h,061h,083h,012h,001h,080h<br />	db 083h,014h,001h,080h,083h,01Bh,001h,080h,083h,020h,001h,080h,083h,014h,001h,080h<br />	db 009h,000h,000h,000h,000h,008h,000h,001h,000h,083h,012h,001h,081h,061h,083h,019h<br />	db 001h,080h,083h,01Eh,001h,080h,083h,012h,001h,080h,083h,019h,001h,083h,031h,001h<br />	db 083h,01Eh,001h,080h,083h,012h,001h,083h,031h,001h,083h,019h,001h,080h,009h,000h<br />	db 000h,000h,000h,008h,000h,001h,000h,083h,014h,001h,083h,033h,001h,083h,01Bh,001h<br />	db 080h,083h,020h,001h,083h,031h,001h,083h,014h,001h,080h,083h,01Bh,001h,083h,030h<br />	db 001h,083h,020h,001h,080h,083h,014h,001h,083h,031h,001h,083h,01Bh,001h,080h,009h<br />	db 000h,000h,000h,000h,008h,000h,001h,000h,083h,016h,001h,083h,030h,001h,083h,01Dh<br />	db 001h,083h,031h,001h,083h,022h,001h,083h,035h,001h,083h,016h,001h,098h,00Ah,001h<br />	db 083h,01Dh,001h,088h,00Ah,083h,022h,001h,081h,061h,083h,016h,001h,080h,083h,01Dh<br />	db 001h,080h,009h,000h,000h,000h,000h,008h,000h,001h,000h,083h,016h,001h,080h,083h<br />	db 01Dh,001h,080h,083h,022h,001h,080h,083h,016h,001h,080h,083h,018h,001h,080h,083h<br />	db 01Dh,001h,080h,083h,011h,001h,080h,083h,018h,001h,080h,009h,000h,000h,000h,000h<br />	db 008h,000h,001h,000h,083h,016h,001h,083h,030h,001h,083h,01Dh,001h,083h,031h,001h<br />	db 083h,019h,001h,083h,02Eh,001h,083h,016h,001h,098h,00Ah,001h,083h,01Dh,001h,088h<br />	db 00Ah,083h,019h,001h,081h,061h,083h,016h,001h,080h,083h,01Dh,001h,080h,0F1h,000h<br />	db 000h,000h<br />xm_unused_001 LABEL BYTE<br /><br />; The following 23 bytes are not used.<br />; So, let&#039;s place the MessageBox text and caption instead.<br />MsgBoxText db &quot;uFMOD ruleZ!&quot;,0<br />MsgCaption db &quot;MASM32&quot;,0<br /><br />org xm_unused_001 + 23<br />	db 001h,000h,012h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,040h,000h,008h,000h,02Ch,000h,00Eh,000h<br />	db 008h,000h,018h,000h,016h,000h,020h,000h,008h,000h,02Dh,000h,00Dh,000h,032h,000h<br />	db 004h,000h,03Ch,000h,007h,000h,044h,000h,004h,000h,05Ah,000h,000h,000h,064h,000h<br />	db 000h,000h,06Eh,000h,000h,000h,000h,000h,020h,000h,00Ah,000h,028h,000h,01Eh,000h<br />	db 018h,000h,032h,000h,020h,000h,03Ch,000h,020h,000h,046h,000h,020h,000h,050h,000h<br />	db 020h,000h,05Ah,000h,020h,000h,064h,000h,020h,000h,06Eh,000h,020h,000h,078h,000h<br />	db 020h,000h,082h,000h,020h,000h,009h,006h,001h,002h,004h,002h,003h,005h,001h,000h<br />	db 000h,000h,000h,000h,080h,000h,00Ch,000h,000h,000h,000h,000h,000h,000h,00Ch,000h<br />	db 000h,000h,040h,000h,001h,080h,0F9h,000h,0BFh,000h,0C3h,000h,00Ah,000h,057h,000h<br />	db 06Eh,000h,023h,000h<br /><br />.CODE<br /><br />start:<br />	; EBX = 0<br />	; ESI = IDirectSound<br />	mov esi,OFFSET lpDS<br />	xor ebx,ebx<br /><br />	; Request an instance of IDirectSound.<br />	invoke DirectSoundCreate,ebx,esi,ebx<br />	test eax,eax<br />	js ds_error<br /><br />	; It is important to set the cooperative level to at least<br />	; DSSCL_PRIORITY prior to creating 16-bit stereo buffers.<br />	invoke GetForegroundWindow<br />	push 2 &nbsp; ; DSSCL_PRIORITY<br />	push eax ; hWnd<br />	mov eax,<br />	mov ecx,<br />	push eax ; this<br />	call DWORD PTR  ; IDirectSound::SetCooperativeLevel<br />	test eax,eax<br />	js ds_error<br /><br />	; Create a secondary sound buffer.<br />	mov eax,<br />	push ebx ; pUnkOuter &lt;= 0<br />	push OFFSET lpDSBuf<br />	push OFFSET bufDesc<br />	mov ecx,<br />	push eax ; this<br />	call DWORD PTR  ; IDirectSound::CreateSoundBuffer<br />	test eax,eax<br />	js ds_error<br /><br />	; Start playback.<br />	invoke uFMOD_DSPlaySong,OFFSET xm,xm_length,XM_MEMORY,lpDSBuf<br />	test eax,eax<br />	js ds_error<br /><br />	; Wait for user input.<br />	invoke MessageBox,ebx,OFFSET MsgBoxText,OFFSET MsgCaption,ebx<br /><br />	; Stop playback.<br />	invoke uFMOD_DSPlaySong,ebx,ebx,ebx,ebx<br /><br />cleanup:<br />	; Release DirectSound instance and free all buffers.<br />	mov eax,<br />	test eax,eax<br />	jz exit<br />	mov ecx,<br />	push eax<br />	call DWORD PTR  ; IDirectSound::Release<br /><br />exit:<br />	invoke ExitProcess,ebx<br /><br />ds_error:<br />	; Report an error.<br />	invoke MessageBox,ebx,OFFSET szError,ebx,10h<br />	jmp cleanup<br /><br />END start<br /></code></pre><br /><br />The way I see it, there are two sections of data here: <strong>org xm_unused_000 + 60</strong> followed by <strong>org xm_unused_001 + 23</strong> - Is it correct to assume that the XM audio file, converted into a MASM hex dump is split between these sections? If so, why is that, and does it have to be like this? Was the author trying to use all the bytes available?<br /><br />Continuing on, uFMOD comes with a pair of tools to strip XM files of unnecessary data and to create hex dumps . I chose a tiny XM file to work with, opened it with eff.exe  and I ticked the &quot;Generate a hex dump file&quot; box only, choosing masm32/tasm as syntax.<br /><br />After clicking &quot;OK&quot;, the tool generates a pair of files: eff.inc and micromod.asm  - The data contained in these files is as follows:<br /><br />eff.inc<br /><pre><code><br />; XM-file: micromod.xm<br /><br />; uFMOD optional features:<br />INFO_API_ON &nbsp; &nbsp; equ 1 ; &nbsp;enable InfoAPI<br />NOLOOP_ON &nbsp; &nbsp; &nbsp; equ 1 ; &nbsp;enable XM_NOLOOP<br />PAUSE_RESUME_ON equ 1 ; &nbsp;enable pause/resume and XM_SUSPENDED<br />VOL_CONTROL_ON &nbsp;equ 1 ; &nbsp;enable volume control<br />JUMP_TO_PAT_ON &nbsp;equ 1 ; &nbsp;enable Jump2Pattern<br />XM_FILE_ON &nbsp; &nbsp; &nbsp;equ 1 ; &nbsp;enable file loading<br />XM_RC_ON &nbsp; &nbsp; &nbsp; &nbsp;equ 1 ; &nbsp;enable resource loading<br /><br />; Special flags:<br />INSTRUMENTVIBRATO_ON equ 1<br />VOLUMEENVELOPE_ON &nbsp; &nbsp;equ 1<br />PANENVELOPE_ON &nbsp; &nbsp; &nbsp; equ 0<br />VOLUMEBYTE_ON &nbsp; &nbsp; &nbsp; &nbsp;equ 1<br />ADPCM_ON &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; equ 0<br />AMIGAPERIODS_ON &nbsp; &nbsp; &nbsp;equ 0<br /><br />; XM effects:<br />ARPEGGIO_ON equ 0<br />PORTAUP_ON equ 0<br />PORTADOWN_ON equ 0<br />PORTATO_ON equ 0<br />VIBRATO_ON equ 0<br />PORTATOVOLSLIDE_ON equ 0<br />VIBRATOVOLSLIDE_ON equ 0<br />TREMOLO_ON equ 0<br />SETPANPOSITION_ON equ 0<br />SETSAMPLEOFFSET_ON equ 0<br />VOLUMESLIDE_ON equ 0<br />PATTERNJUMP_ON equ 0<br />SETVOLUME_ON equ 0<br />PATTERNBREAK_ON equ 0<br />SETSPEED_ON equ 1<br />SETGLOBALVOLUME_ON equ 0<br />GLOBALVOLSLIDE_ON equ 0<br />KEYOFF_ON equ 0<br />SETENVELOPEPOS_ON equ 0<br />PANSLIDE_ON equ 0<br />MULTIRETRIG_ON equ 0<br />TREMOR_ON equ 0<br />EXTRAFINEPORTA_ON equ 0<br />FINEPORTAUP_ON equ 0<br />FINEPORTADOWN_ON equ 0<br />SETVIBRATOWAVE_ON equ 0<br />SETFINETUNE_ON equ 0<br />PATTERNLOOP_ON equ 1<br />SETTREMOLOWAVE_ON equ 0<br />SETPANPOSITION16_ON equ 0<br />RETRIG_ON equ 0<br />NOTECUT_ON equ 0<br />NOTEDELAY_ON equ 1<br />PATTERNDELAY_ON equ 0<br />PORTAUP_OR_DOWN_ON equ 0<br />VIBRATO_OR_VOLSLIDE equ 0<br />VIBRATO_OR_TREMOLO equ 0<br />PORTATO_OR_VOLSLIDE equ 0<br />VOLUME_OR_PANENVELOPE equ 1<br />ROWCOMMANDS_ON equ 1<br />GLOBALVOL_ON equ 0<br />FINEVOLUMESLIDE_ON equ 0<br /></code></pre><br /><br />micromod.asm<br /><pre><code><br />xm_length EQU 1166<br />xm LABEL BYTE<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,04Dh,069h,06Eh,069h,06Dh,061h,06Ch,020h,062h,079h,020h,04Ah,06Fh,073h,053h<br />	db 073h,020h,020h,020h,020h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,015h,000h,000h,000h<br />	db 001h,000h,000h,000h,004h,000h,001h,000h,001h,000h,001h,000h,000h,000h,064h,000h<br />	db 000h,009h,000h,000h,000h,000h,041h,000h,0CDh,002h,038h,001h,000h,00Fh,014h,098h<br />	db 00Eh,060h,098h,00Fh,064h,080h,080h,083h,037h,001h,080h,080h,083h,035h,001h,080h<br />	db 080h,080h,080h,083h,030h,001h,080h,080h,083h,029h,001h,080h,080h,080h,080h,083h<br />	db 030h,001h,080h,080h,083h,035h,001h,080h,080h,080h,030h,001h,030h,00Eh,0DAh,033h<br />	db 001h,000h,00Eh,061h,080h,080h,038h,001h,000h,00Eh,060h,037h,001h,030h,00Eh,0DAh<br />	db 080h,080h,083h,033h,001h,035h,001h,030h,00Eh,0DAh,080h,080h,083h,02Ch,001h,080h<br />	db 080h,080h,080h,083h,031h,001h,080h,080h,083h,025h,001h,080h,080h,080h,031h,001h<br />	db 030h,00Eh,0DAh,083h,02Ch,001h,080h,080h,083h,038h,001h,037h,001h,030h,00Eh,0DAh<br />	db 080h,080h,033h,001h,000h,00Eh,061h,031h,001h,030h,00Eh,0DAh,080h,080h,083h,038h<br />	db 001h,030h,001h,024h,00Eh,0DAh,048h,001h,035h,00Eh,060h,080h,035h,001h,020h,00Eh<br />	db 0DAh,083h,037h,001h,080h,080h,083h,035h,001h,080h,080h,080h,035h,001h,030h,00Eh<br />	db 0DAh,083h,030h,001h,080h,080h,083h,029h,001h,080h,080h,087h,04Dh,001h,030h,029h<br />	db 001h,030h,00Eh,0DAh,083h,030h,001h,04Bh,001h,036h,00Eh,0DAh,080h,083h,035h,001h<br />	db 080h,080h,080h,030h,001h,030h,00Eh,0DAh,083h,033h,001h,098h,00Eh,061h,087h,046h<br />	db 001h,032h,038h,001h,000h,00Eh,060h,037h,001h,030h,00Eh,0DAh,087h,044h,001h,035h<br />	db 080h,083h,033h,001h,035h,001h,030h,00Eh,0DAh,080h,080h,083h,02Ch,001h,080h,080h<br />	db 080h,080h,083h,031h,001h,080h,080h,083h,025h,001h,080h,080h,080h,031h,001h,030h<br />	db 00Eh,0DAh,083h,02Ch,001h,080h,080h,083h,038h,001h,037h,001h,030h,00Eh,0DAh,080h<br />	db 080h,033h,001h,000h,00Eh,061h,031h,001h,030h,00Eh,0DAh,087h,046h,001h,030h,048h<br />	db 001h,024h,00Eh,0DAh,083h,038h,001h,030h,001h,024h,00Eh,0DAh,041h,001h,035h,00Eh<br />	db 060h,04Dh,001h,01Eh,00Eh,0DAh,035h,001h,020h,00Eh,0DAh,083h,037h,001h,087h,04Bh<br />	db 001h,030h,041h,001h,01Ah,00Eh,0DAh,083h,035h,001h,080h,044h,001h,030h,00Eh,0DAh<br />	db 087h,043h,001h,035h,035h,001h,030h,00Eh,0DAh,083h,030h,001h,080h,048h,001h,034h<br />	db 00Eh,0DAh,083h,029h,001h,080h,080h,080h,029h,001h,030h,00Eh,0DAh,083h,030h,001h<br />	db 04Bh,001h,036h,00Eh,0DAh,080h,083h,035h,001h,080h,080h,04Dh,001h,021h,00Eh,0DAh<br />	db 030h,001h,030h,00Eh,0DAh,083h,033h,001h,046h,001h,020h,00Eh,061h,048h,001h,022h<br />	db 00Eh,0DAh,038h,001h,000h,00Eh,060h,037h,001h,030h,00Eh,0DAh,087h,03Dh,001h,035h<br />	db 049h,001h,020h,00Eh,0DAh,083h,033h,001h,035h,001h,030h,00Eh,0DAh,087h,048h,001h<br />	db 040h,044h,001h,01Eh,00Eh,0DAh,083h,02Ch,001h,080h,087h,041h,001h,035h,044h,001h<br />	db 02Ah,00Eh,0DAh,080h,083h,031h,001h,087h,046h,001h,040h,041h,001h,026h,00Eh,0DAh<br />	db 083h,025h,001h,080h,080h,080h,031h,001h,030h,00Eh,0DAh,083h,02Ch,001h,080h,080h<br />	db 083h,038h,001h,037h,001h,030h,00Eh,0DAh,080h,080h,033h,001h,000h,00Eh,061h,031h<br />	db 001h,030h,00Eh,0DAh,087h,046h,001h,030h,048h,001h,024h,00Eh,0DAh,083h,038h,001h<br />	db 098h,00Eh,060h,083h,011h,001h,087h,041h,001h,035h,080h,083h,037h,001h,011h,001h<br />	db 000h,00Eh,0DAh,044h,001h,030h,00Eh,0DAh,083h,035h,001h,080h,083h,01Dh,001h,080h<br />	db 080h,083h,030h,001h,01Dh,001h,000h,00Eh,0DAh,080h,083h,029h,001h,080h,083h,011h<br />	db 001h,080h,080h,083h,030h,001h,011h,001h,000h,00Eh,0DAh,080h,083h,035h,001h,080h<br />	db 083h,01Dh,001h,087h,046h,001h,035h,030h,001h,030h,00Eh,0DAh,033h,001h,000h,00Eh<br />	db 061h,083h,01Bh,001h,087h,048h,001h,030h,038h,001h,000h,00Eh,060h,037h,001h,030h<br />	db 00Eh,0DAh,083h,019h,001h,087h,049h,001h,035h,083h,033h,001h,035h,001h,030h,00Eh<br />	db 0DAh,019h,001h,000h,00Eh,0DAh,048h,001h,026h,00Eh,0DAh,083h,02Ch,001h,080h,083h<br />	db 025h,001h,087h,044h,001h,035h,080h,083h,031h,001h,080h,087h,041h,001h,030h,083h<br />	db 025h,001h,080h,080h,080h,031h,001h,030h,00Eh,0DAh,083h,02Ch,001h,080h,080h,083h<br />	db 038h,001h,037h,001h,030h,00Eh,0DAh,083h,022h,001h,080h,033h,001h,000h,00Eh,061h<br />	db 031h,001h,030h,00Eh,0DAh,083h,020h,001h,080h,08Bh,035h,001h,00Fh,083h,029h,001h<br />	db 083h,01Dh,001h,087h,048h,001h,035h,0F1h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,01Fh,001h,000h,012h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,000h<br />	db 000h,000h,000h,000h,000h,000h,000h,000h,000h,000h,030h,000h,004h,000h,02Bh,000h<br />	db 009h,000h,01Eh,000h,00Dh,000h,018h,000h,013h,000h,012h,000h,01Bh,000h,00Eh,000h<br />	db 025h,000h,00Ah,000h,032h,000h,007h,000h,040h,000h,005h,000h,04Dh,000h,003h,000h<br />	db 08Dh,000h,000h,000h,000h,000h,030h,000h,000h,000h,020h,000h,044h,001h,020h,000h<br />	db 050h,000h,020h,000h,050h,000h,020h,000h,050h,000h,020h,000h,050h,000h,020h,000h<br />	db 050h,000h,020h,000h,05Ah,000h,020h,000h,064h,000h,020h,000h,06Eh,000h,020h,000h<br />	db 078h,000h,020h,000h,082h,000h,020h,000h,00Bh,002h,006h,001h,001h,001h,001h,001h<br />	db 001h,000h,000h,010h,00Bh,015h,080h,000h,064h,000h,000h,000h,000h,000h,000h,000h<br />	db 064h,000h,000h,000h,040h,0DCh,011h,080h,00Ah,011h,001h,0D0h,0B0h,003h,0AFh,003h<br />	db 0B0h,003h,0B0h,003h,0AFh,003h,0B0h,003h,0AFh,003h,0B1h,003h,0AFh,003h,0B0h,003h<br />	db 022h,04Bh,000h,000h,000h,0FEh,000h,000h,000h,0FBh,000h,0FEh,000h,0FAh,000h,0FBh<br />	db 000h,0FCh,000h,000h,000h,0FDh,000h,0F0h,000h,001h,000h,0FFh,000h,0FEh,000h,000h<br />	db 000h,0FEh,000h,000h,000h,0FFh,000h,000h,000h,0FEh,000h,000h,000h,000h,000h,000h<br />	db 000h,0FEh,000h,0FFh,000h,0FEh,000h,0FDh,000h,000h,0F2h,0EEh,050h,0FCh,050h,0FCh<br />	db 051h,0FCh,050h,0FCh,050h,0FCh,050h,0FCh,051h,0FCh,050h,0FCh,050h,0FCh<br /></code></pre><br /><br />I have noticed that aside from the hex data, there are two lines of code attached to the dump <strong>xm_length EQU 1166</strong> and <strong>xm LABEL BYTE</strong> - These are also present in the uFMOD program code, the only difference being the xm_length value . I tried replacing this value with the 1166 I got and placing my hex dump data over either one of the sections, but after compiling, the program is silent.<br /><br />This obviously is far beyond my understanding, as I don&#039;t know a first thing about assembly, and I wish that someone could explain to me how to get this working and more importantly, how to handle this in the future, with other XM files, so that I don&#039;t end up with a one time solution, but rather learn how this is done. <br /><br />Bare in mind that I&#039;m not even able to create a &quot;Hello World&quot; type of program, so if you&#039;re kind enough to explain these things to me, keep it simple so that I actually understand and won&#039;t keep asking you about same things over and over again. Haha.<br /><br />Sorry for just pasting all the data into the message, but I figured that would be the easiest way of showing you exactly what is it that is not working. I hope you don&#039;t ban noobs or anything, because if you are, I&#039;m pretty much gone already. Haha. <br /><br />Thanks again to anyone who is willing to help me out. Thanks for your time, your patience and your knowledge.<br /><br />P.S. - I attached a zip file with all the assembly uFMOD sources, but it&#039;s only MASM32 DirectX version I&#039;m interested in, unless you think I should go with WinMM. The zip file also contains the xm audio file I want to use. <br /></div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=2759" target="_blank">ufmod.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2009-04-20 15:22:02 by Canine</div>
   </div>
   <div class="post" id="post-207357">
    <div class="subject"><a href="#post-207357">Re: uFMOD and MASM32</a></div>
    <div class="body"><div class="quote"><br />The way I see it, there are two sections of data here: <strong>org xm_unused_000 + 60</strong> followed by <strong>org xm_unused_001 + 23</strong> - Is it correct to assume that the XM audio file, converted into a MASM hex dump is split between these sections? If so, why is that, and does it have to be like this? Was the author trying to use all the bytes available?<br /></div><br /><br />there&#039;s an option in eff that removes unused data, the mark and clear-out thing at the bottom, the xm data in the example you posted is generated with that on, that&#039;s why the xm data is split up into 2 parts, it removed the data that won&#039;t be used.. you can choose whichever you want, to remove that data or not.. anyways to use your own xm file, like the micromod.asm one you posted, <br /><br /><pre><code><br />include micromod.asm ; include the generated file somewhere in the .data section..<br /><br />pcm	dd 20001h&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ; wFormatTag &lt;= WAVE_FORMAT_PCM, nChannels &lt;= 2<br />	dd uFMOD_MixRate<br />&nbsp; &nbsp; &nbsp; &nbsp; .........<br /><br />bufDesc dd 20 ; DSBUFFERDESC1<br />	dd 14000h ; dwFlags &lt;= DSBCAPS_STICKYFOCUS OR DSBCAPS_GETCURRENTPOSITION2<br />&nbsp; &nbsp; &nbsp; &nbsp; .............<br /><br />MsgBoxText db &quot;uFMOD ruleZ!&quot;,0<br />MsgCaption db &quot;MASM32&quot;,0<br /></code></pre><br /></div>
    <div class="meta">Posted on 2009-04-20 16:20:04 by lone_samurai5</div>
   </div>
   <div class="post" id="post-207360">
    <div class="subject"><a href="#post-207360">Re: uFMOD and MASM32</a></div>
    <div class="body">Worked like a charm first time i tried it. Once the eff.exe produced a proper asm file, with the data split in two, I simply replaced the orginal information and it compiled just fine. You also mentioned using the &quot;include micromod.asm&quot;, but I&#039;m not entirely sure how to work with that. Like I said before, I have never coded in assembly in my life, ever.<br /><br />Another problem now is larger xm files. A 2.5 meg xm will produce a 14 meg hex dump and that&#039;s just not workable in notepad using copy and paste. Is that when you simply tell the compiler to include a asm file containing the hex dump?<br /><br />I would really like to see a complete example of how that would work. If you don&#039;t mind, could you simply re-post the whole uFMOD player code with your changes made to it? Thanks in advance.</div>
    <div class="meta">Posted on 2009-04-20 19:59:29 by Canine</div>
   </div>
   <div class="post" id="post-207362">
    <div class="subject"><a href="#post-207362">Re: uFMOD and MASM32</a></div>
    <div class="body">just move the generated asm file into the same directory your other code is in and include it.. pretty much the same as copy and pasting the hex data into the src file.. also don&#039;t include files that big, just get the xm filename during runtime and just play the file with uFMOD_DSPlaySong..</div>
    <div class="attachments">Attachments:
     <ul>
      <li><a href="../../attachments/?id=2760" target="_blank">mini_ds.zip</a></li>
     </ul>
    </div>
    <div class="meta">Posted on 2009-04-21 02:31:03 by lone_samurai5</div>
   </div>
  </div>
 </body>
</html>