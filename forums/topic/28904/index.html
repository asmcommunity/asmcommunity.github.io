<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>MapVirtualKey - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=28904" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=28904">MapVirtualKey</a></p>
   <div class="post" id="post-204351">
    <div class="subject"><a href="#post-204351">MapVirtualKey</a></div>
    <div class="body">Anybody got any code samples?</div>
    <div class="meta">Posted on 2008-01-03 15:17:58 by mrgone</div>
   </div>
   <div class="post" id="post-204352">
    <div class="subject"><a href="#post-204352">Re: MapVirtualKey</a></div>
    <div class="body">Well, I did a hotkey editor that converted a VKEY to a string...<br /><br /><pre><code>GetVKeyString proc uses edi KeyData:DWORD<br />	LOCAL buffer[32]	:BYTE<br />	LOCAL KeyCode		:BYTE<br />	LOCAL ModCode		:BYTE<br />	LOCAL ExtKey		:BYTE<br /><br />	; KeyData holds a virtual key code returned from HKM_GETHOTKEY<br /><br />	mov eax,KeyData<br /><br />	mov KeyCode,al<br />	mov ModCode,ah<br /><br />	movzx eax,KeyCode<br />	.IF eax &gt;= VK_PRIOR &amp;&amp; eax &lt;= VK_HELP<br />		mov ExtKey,1<br />	.ELSE<br />		mov ExtKey,0<br />	.endif<br /><br />	invoke MapVirtualKeyEx,eax,0,hKBLayout<br />	mov ah,ExtKey<br />	movzx edx,ax<br />	shl edx,16<br />	invoke GetKeyNameText,edx,ADDR buffer,32<br /><br />	mov edi,OFFSET VKeyName<br />	mov ,BYTE PTR &quot;V&quot;<br />	mov ,BYTE PTR &quot;K&quot;<br />	mov ,BYTE PTR &quot;_&quot;<br />	mov ,BYTE PTR 0<br /><br />	invoke lstrcat,OFFSET VKeyName,ADDR buffer<br />	ret<br /><br />GetVKeyString endp</code></pre><br /><br />It&#039;s in MASM so it&#039;s got to be pretty old but it&#039;s an example of usage.<br /><br />Donkey</div>
    <div class="meta">Posted on 2008-01-03 15:53:42 by donkey</div>
   </div>
   <div class="post" id="post-204357">
    <div class="subject"><a href="#post-204357">Re: MapVirtualKey</a></div>
    <div class="body">&nbsp; Hey thanks Donkey!&nbsp; :D I will save the code. Good to see you around. Does Nan get in here anymore? Hey, Happy New Year!</div>
    <div class="meta">Posted on 2008-01-04 17:18:12 by mrgone</div>
   </div>
   <div class="post" id="post-204362">
    <div class="subject"><a href="#post-204362">Re: MapVirtualKey</a></div>
    <div class="body">Happy new year to you too mrgone, haven&#039;t heard from NaN for a bit but I think he still pops in from time to time.<br /><br />Donkey</div>
    <div class="meta">Posted on 2008-01-05 04:36:38 by donkey</div>
   </div>
   <div class="post" id="post-204366">
    <div class="subject"><a href="#post-204366">Re: MapVirtualKey</a></div>
    <div class="body"><div class="quote"><br />Does Nan get in here anymore? Hey, Happy New Year!<br /></div><br /><br />Within my last communications with NaN, he is almost entirely out of the assembly scene now as he is busy with other life related things.<br /><br /></div>
    <div class="meta">Posted on 2008-01-05 11:35:03 by madprgmr</div>
   </div>
   <div class="post" id="post-204383">
    <div class="subject"><a href="#post-204383">Re: MapVirtualKey</a></div>
    <div class="body"> He&#039;ll be back. He will wake up one night in cold sweats with code racing through his head from the program he was sleep writing. That he will moan &amp; bewail how he misses arguing with fodder. <br /><br />Sorry fodder, I just used you because you love to engage an open debate. </div>
    <div class="meta">Posted on 2008-01-06 19:14:23 by mrgone</div>
   </div>
  </div>
 </body>
</html>