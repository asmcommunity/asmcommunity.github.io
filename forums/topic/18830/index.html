<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Shellsort - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=18830" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=18830">Shellsort</a></p>
   <div class="post" id="post-145805">
    <div class="subject"><a href="#post-145805">Shellsort</a></div>
    <div class="body">I need a sorting routine to use with my Virtual ListView.<br />Now I'm using shellsort but it has a problem: it is not stable.<br />I don't know if the term &quot;stable&quot; is the correct one. If I sort first the column A and then the column B, the elements that have the same value in the column B should be sorted according to the previous column A order<br /><br />The first algorithm I used was selection sort (stable algorithm) but it does (N^2)/2 comparison. My listview has about 5000 rows and contains only strings. I have no problems with exchanges, because I change pointers, but I need a low number of comparison.<br /><br />Shellsort, with knuth sequence (h = 3*h +1) is very good (less than N^ 3/2 comparison) but it is not stable.<br /><br />Can someone tell me a fast stable algorithm?</div>
    <div class="meta">Posted on 2004-07-10 08:13:55 by greenant</div>
   </div>
   <div class="post" id="post-145810">
    <div class="subject"><a href="#post-145810">Shellsort</a></div>
    <div class="body">Merge sort is stable (depending on the implementation), and is used in some C++ STL implementations of stable_sort.<br /><br />You could probably also keep your shell sort and use the current position index as a secondary key if two elements compare equal.</div>
    <div class="meta">Posted on 2004-07-10 09:32:47 by Jibz</div>
   </div>
   <div class="post" id="post-145811">
    <div class="subject"><a href="#post-145811">Shellsort</a></div>
    <div class="body">I will study mergesort. Thanks</div>
    <div class="meta">Posted on 2004-07-10 09:36:18 by greenant</div>
   </div>
  </div>
 </body>
</html>