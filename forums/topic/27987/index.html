<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>OLE automation - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=27987" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=27987">OLE automation</a></p>
   <div class="post" id="post-198913">
    <div class="subject"><a href="#post-198913">OLE automation</a></div>
    <div class="body">Hi to all COM warriors!

I just deal with a powerpoint import function.
At the moment I'm able to remote-launch powerpoint,
open a ppt file and enumerate all slides and the
elements (shapes) on the slides.

I get an IDispatch handle for every object, and can access the automation features with it.

What I cannot solve is - how to get the data out of the object?

If I insert an image (f.e. BMP or JPG) into PowerPoint, 
I find no way to get the image data out of the element.
I made a way over the clipoard with a "Copy" and "Paste"
operation, but this way I get only a bitmap and not the
original data stream.

beaster.
* lost in OLE spaces *</div>
    <div class="meta">Posted on 2001-05-09 05:26:00 by beaster</div>
   </div>
   <div class="post" id="post-198914">
    <div class="subject"><a href="#post-198914">OLE automation</a></div>
    <div class="body">I'm not familiar with Power Point, but in gerneral, to use any Automation server such as P Point you need to get it's documentation. The largest drawing will be the object hiarachy, which describes how the program's bits and pieces intereact with each other.

For example, in Excel, to get the contents of a particular cell, you need to route thru something like:

Val = Excel.Workbook(1).Cell(A1).Value

That's VBish. In asm, you need to do these calls independently, as in get the Excel Object (perobably from a LoadObject on an existing sheet), use the Workbook method to get the book 1 object, Get the Cell peoperty of that (returns another object), then query that cell object for it's value property.

Yes, it's many many steps.</div>
    <div class="meta">Posted on 2001-05-15 07:12:00 by Ernie</div>
   </div>
   <div class="post" id="post-198915">
    <div class="subject"><a href="#post-198915">OLE automation</a></div>
    <div class="body">thanks for reply.
I got so far, to have the lowest object I need, 
in my case Presentation.Slides.Item(1).Shapes.Item(1).

One of my example files contains a windows metafile
in a powerpoint slide. I inserted it with "Insert"->"Graphic"->"Clipart" in my slide.
I took one of the office default cliparts (flower.wmf). Internally it becomes an embedded OLE object.

If I now dive into the object structure, I get at the last step an OLE object handle, which represents my flower.wmf as an OLE object.

What I cannot solve is - how to get the original file data
out of the object? The object has no corresponding methods, like
GetData or GetRawData or something.

I think, this is not only a question of powerpoint, but a 
common question of OLE objects.</div>
    <div class="meta">Posted on 2001-05-16 05:24:00 by beaster</div>
   </div>
  </div>
 </body>
</html>