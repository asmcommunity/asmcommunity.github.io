<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>How to get the Window handle from a Process ID ? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7870" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7870">How to get the Window handle from a Process ID ?</a></p>
   <div class="post" id="post-57290">
    <div class="subject"><a href="#post-57290">How to get the Window handle from a Process ID ?</a></div>
    <div class="body">It was asked two or three times already on this Forum but I simply hate to use EnumWindows and compare the PID's (GetWindowThreadProcessID). Anyone has an idea of another way to get the handle of a window from a process ID ? The processes were started by ShellExecuteEx.<br /><br />Thanks in advance,<br />bazik</div>
    <div class="meta">Posted on 2002-09-12 07:46:14 by bazik</div>
   </div>
   <div class="post" id="post-57295">
    <div class="subject"><a href="#post-57295">How to get the Window handle from a Process ID ?</a></div>
    <div class="body">Use GetThreadDesktop from user32.dll.<br />here's the description,<br /><a target="_blank" href="http://leb.net/wine/WinDoc/msdn/sdk/platforms/doc/sdk/win32/func/src/f41_8.htm">http://leb.net/wine/WinDoc/msdn/sdk/platforms/doc/sdk/win32/func/src/f41_8.htm</a><br /><br />edit:<br />Oh sorry that's wrong...</div>
    <div class="meta">Posted on 2002-09-12 08:15:50 by C.Z.</div>
   </div>
   <div class="post" id="post-57297">
    <div class="subject"><a href="#post-57297">How to get the Window handle from a Process ID ?</a></div>
    <div class="body">Thanks for your reply, but it doesnt work.<br />Note that I have a <strong>process</strong> ID, not a <strong>thread</strong> ID :/</div>
    <div class="meta">Posted on 2002-09-12 08:32:20 by bazik</div>
   </div>
   <div class="post" id="post-57306">
    <div class="subject"><a href="#post-57306">How to get the Window handle from a Process ID ?</a></div>
    <div class="body">EnumThreadWindows<br /><br />I do think you have to get the thread ID beforehand, as windows are only entitled to the thread that created them, not the process.<br /><br />How do you get the process ID in your app, I wonder? If you use toolhelp functions, you can get the thread ID at the same time.<br /><br />I don't yet know how to get the main thread ID from a known process ID. But it's for sure that, if you use CreateProcess instead of ShellExecuteEx, threadid will be no problem.</div>
    <div class="meta">Posted on 2002-09-12 09:03:21 by C.Z.</div>
   </div>
  </div>
 </body>
</html>