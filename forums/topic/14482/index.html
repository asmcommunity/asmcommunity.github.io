<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>shell for dos app? - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14482" />
    <link rel="next" href="../?id=14482&amp;page=2" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=14482">shell for dos app?</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=14482&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=14482&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="14482" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=14482&amp;page=2">&gt;</a><a href="../?id=14482&amp;page=2">&raquo;</a></form>   <div class="post" id="post-112022">
    <div class="subject"><a href="#post-112022">shell for dos app?</a></div>
    <div class="body">hi, i did search this but havent found anything:( <br /><br />i have &quot;app.exe&quot; which is small dos file, running from ms-dos prompt.<br />you write as:<br />app.exe var1 var2 var3<br /><br />and it returns:<br />yourVar1= &quot;var1&quot;<br />yourVar2= &quot;var2&quot;<br />yourVar3= &quot;var3&quot;<br />followed by a list of 7 strings generated from the input variables.<br /><br />what i would like to do is make a gui/shell for this app..<br />with editbox for i/p and o/p of variables/strings<br /><br />how is this possible?<br />which api, and how to give/receive the values?<br /><br />tia</div>
    <div class="meta">Posted on 2003-07-27 08:54:39 by wilson</div>
   </div>
   <div class="post" id="post-112028">
    <div class="subject"><a href="#post-112028">shell for dos app?</a></div>
    <div class="body">Create a dialog box, with 3 single-line Edit controls, 1 multiline Edit control, and 1 button.<br />when the button gets pressed (on WM_COMMAND) , get the values from the first three Edit controls, using &quot;GetWindowText()&quot;. Process the data, as you processed it before in the dos app. Then use SetWindowText() with the handle to the multiline Edit control , to return the processed data. When the user wants to exit, he presses the <strong>x</strong> button on the top-right corner, and the message WM_CLOSE gets generated, on which you exit the app with ExitProcess(0).</div>
    <div class="meta">Posted on 2003-07-27 11:12:03 by Ultrano</div>
   </div>
   <div class="post" id="post-112031">
    <div class="subject"><a href="#post-112031">shell for dos app?</a></div>
    <div class="body">Here ya go, pal :grin:<br />I made the app you need. See attachment</div>
    <div class="meta">Posted on 2003-07-27 11:45:40 by Ultrano</div>
   </div>
   <div class="post" id="post-112032">
    <div class="subject"><a href="#post-112032">shell for dos app?</a></div>
    <div class="body">hi, thanks mate but its not really what i need :(<br />the dos app performs calulations on the input variables and returns 7 new strings based on those.<br />i cant reverse the algo in the original app so i hoped to just make a shell for it..<br /><br />appreciate your effort:alright:</div>
    <div class="meta">Posted on 2003-07-27 11:54:55 by wilson</div>
   </div>
   <div class="post" id="post-112037">
    <div class="subject"><a href="#post-112037">shell for dos app?</a></div>
    <div class="body">I gave you <em>only</em> the skeleton of an app. You have to code it further so that you achieve your exact goal, mate ;) . If you give me the code of the DOS app, I'll gladly make the whole app</div>
    <div class="meta">Posted on 2003-07-27 12:40:28 by Ultrano</div>
   </div>
   <div class="post" id="post-112045">
    <div class="subject"><a href="#post-112045">shell for dos app?</a></div>
    <div class="body">i can make that ;)<br />but to run the dos file from command prompt, with values passed from asm form, then have the calculated values put back in the asm app- is where i am stuck :)<br />with vb, you can do shell &quot;c:\dosapp.exe&quot;..<br /><br />anyway i uploaded the app here, hope you can see what i mean.<br />thanks man!</div>
    <div class="meta">Posted on 2003-07-27 13:45:58 by wilson</div>
   </div>
   <div class="post" id="post-112048">
    <div class="subject"><a href="#post-112048">shell for dos app?</a></div>
    <div class="body">ah :) I understand now (finally). I'm working on the problem....</div>
    <div class="meta">Posted on 2003-07-27 13:52:44 by Ultrano</div>
   </div>
   <div class="post" id="post-112049">
    <div class="subject"><a href="#post-112049">shell for dos app?</a></div>
    <div class="body">10x thanks:grin:</div>
    <div class="meta">Posted on 2003-07-27 14:10:09 by wilson</div>
   </div>
   <div class="post" id="post-112052">
    <div class="subject"><a href="#post-112052">shell for dos app?</a></div>
    <div class="body">I'm ready . Enjoy :alright:</div>
    <div class="meta">Posted on 2003-07-27 14:47:39 by Ultrano</div>
   </div>
   <div class="post" id="post-112084">
    <div class="subject"><a href="#post-112084">shell for dos app?</a></div>
    <div class="body">man, top work!<br />best i could ever hope for, working example for me to study :)<br /><br />i had guessed it was possible when first reading icezelions &quot;process&quot; chapter last night, but didnt see how to get the returned values in to an edit box..<br /><br />many thanks,<br />WBR:)</div>
    <div class="meta">Posted on 2003-07-27 17:54:02 by wilson</div>
   </div>
   <div class="post" id="post-112218">
    <div class="subject"><a href="#post-112218">shell for dos app?</a></div>
    <div class="body">attached is my finished work for today, i rewrite the whole this as i prefer to use window instead of dialog box..<br />at the moment, thats all i understand (thanks icezelion- not sarcastic) :)<br />thanks for the idea to use &quot;pipes&quot;</div>
    <div class="meta">Posted on 2003-07-28 16:33:55 by wilson</div>
   </div>
   <div class="post" id="post-112230">
    <div class="subject"><a href="#post-112230">shell for dos app?</a></div>
    <div class="body">It crashes on load on Win XP home edition sp1.<br /><br />I could give you the debugger dump if needed.</div>
    <div class="meta">Posted on 2003-07-28 17:37:07 by RobotBob</div>
   </div>
   <div class="post" id="post-112232">
    <div class="subject"><a href="#post-112232">shell for dos app?</a></div>
    <div class="body">yea someone else just told me that (win 2k..)<br />can you upload please?<br />any ideas why? like common causes in win98 code not running on xp?<br /><br />thanks..</div>
    <div class="meta">Posted on 2003-07-28 17:40:55 by wilson</div>
   </div>
   <div class="post" id="post-112235">
    <div class="subject"><a href="#post-112235">shell for dos app?</a></div>
    <div class="body">My debugger says the error is external, the result of an improper parameter to an api.<br />I could hunt this down for you.<br />I dont need the source, for this however.<br /><br />Gimme a few :)</div>
    <div class="meta">Posted on 2003-07-28 17:47:14 by RobotBob</div>
   </div>
   <div class="post" id="post-112237">
    <div class="subject"><a href="#post-112237">shell for dos app?</a></div>
    <div class="body">thanks mate :)<br /><br />just checked myself, maybe its the handle to menu (or lack of..)</div>
    <div class="meta">Posted on 2003-07-28 17:52:35 by wilson</div>
   </div>
   <div class="post" id="post-112240">
    <div class="subject"><a href="#post-112240">shell for dos app?</a></div>
    <div class="body">Its (you'll never believe this) the parameters being passed to LoadIcon.<br /><br />I altered this code (ehem :) ) and it loaded fine.<br />I could be wrong, it may also be a stack problem in that area since I see, alot of locals.<br /><br />either way your problem is in that block lol.<br /><br />RobotBob</div>
    <div class="meta">Posted on 2003-07-28 18:05:54 by RobotBob</div>
   </div>
   <div class="post" id="post-112242">
    <div class="subject"><a href="#post-112242">shell for dos app?</a></div>
    <div class="body">oops, i had<br />invoke loadicon,lpicon,IDC_APPLICATION :rolleyes: <br />can you try this please..</div>
    <div class="meta">Posted on 2003-07-28 18:13:02 by wilson</div>
   </div>
   <div class="post" id="post-112243">
    <div class="subject"><a href="#post-112243">shell for dos app?</a></div>
    <div class="body">Different problem this time.<br />You are passing as the second argument the resource ID of the icon right?<br />I edited it to push the resource ID and it worked fine. <br /><br /><br />Oh I just saw what is happening! you are passing a pointer to &quot;iconid&quot; string and not<br />the ID number. It should be  loadicon,hinstance,1001 ; if 1001 is the resource id of your icon.<br />The menu isnt displaying either and I suspect its the same problem.<br /><br />RobotBob</div>
    <div class="meta">Posted on 2003-07-28 18:21:14 by RobotBob</div>
   </div>
   <div class="post" id="post-112246">
    <div class="subject"><a href="#post-112246">shell for dos app?</a></div>
    <div class="body">hmm ok i see the hInstance push now, but the pointers are to the name as defined in the resource file. id's are put in there so i thought this should work?<br />i changed <em>offset</em> to menuname to <em>addr</em> as a last ditch for today (its 20 to 1 morning here, i started this at 10am yesterday lolz)<br /><br />appreciate the feedback, thanks:alright:</div>
    <div class="meta">Posted on 2003-07-28 18:34:25 by wilson</div>
   </div>
   <div class="post" id="post-112247">
    <div class="subject"><a href="#post-112247">shell for dos app?</a></div>
    <div class="body">BINGO! it works perfect. Sleep now :)</div>
    <div class="meta">Posted on 2003-07-28 18:38:59 by RobotBob</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=14482&amp;page=1" style="visibility:hidden;">&laquo;</a><a href="../?id=14482&amp;page=0" style="visibility:hidden;">&lt;</a><input type="hidden" name="id" value="14482" /><input type="number" name="page" min="1" max="2" step="1" value="1" onchange="this.form.submit();" /><a href="../?id=14482&amp;page=2">&gt;</a><a href="../?id=14482&amp;page=2">&raquo;</a></form>  </div>
 </body>
</html>