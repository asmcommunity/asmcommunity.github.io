<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Help on extracting resources - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=7940" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=3">MAIN</a> &raquo; <a href="../?id=7940">Help on extracting resources</a></p>
   <div class="post" id="post-57903">
    <div class="subject"><a href="#post-57903">Help on extracting resources</a></div>
    <div class="body">Hi,<br /><br />I am interested in extracting resources from other PE. I could not find much material on the net (I googled, etc), so I was wondering if anyone has some source code for me to view and understand. <br /><br />Thank you.</div>
    <div class="meta">Posted on 2002-09-15 07:11:05 by roticv</div>
   </div>
   <div class="post" id="post-57905">
    <div class="subject"><a href="#post-57905">Help on extracting resources</a></div>
    <div class="body"><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=318&amp;highlight=lockresource">http://www.asmcommunity.net/board/index.php?topic=318&amp;highlight=lockresource</a><br /><a target="_blank" href="http://www.asmcommunity.net/board/index.php?topic=1671&amp;highlight=lockresource">http://www.asmcommunity.net/board/index.php?topic=1671&amp;highlight=lockresource</a></div>
    <div class="meta">Posted on 2002-09-15 07:22:06 by bazik</div>
   </div>
   <div class="post" id="post-57934">
    <div class="subject"><a href="#post-57934">Help on extracting resources</a></div>
    <div class="body">roticv<br /><br />You can use GoBug my Win32 symbolic debugger to extract resources from a PE file.<br /><br />This is available from <a target="_blank" href="http://www.GoDevTool.com">www.GoDevTool.com</a> <br /><br />I'm afraid only the 95/98/ME version is available for on-line download.  However I do have an early NT/2000/XP evaluation version which I'm still working on.</div>
    <div class="meta">Posted on 2002-09-15 10:11:57 by jorgon</div>
   </div>
   <div class="post" id="post-58065">
    <div class="subject"><a href="#post-58065">Help on extracting resources</a></div>
    <div class="body">Hi,<br /><br />Is there any way to read directly from the section .rsrc to read through all the resources? I think Ewayne did it in his hexeditor, but i do not really understand his code.</div>
    <div class="meta">Posted on 2002-09-16 03:01:57 by roticv</div>
   </div>
   <div class="post" id="post-58117">
    <div class="subject"><a href="#post-58117">Help on extracting resources</a></div>
    <div class="body">It depends exactly what you want to do.  If you want to view the resources in the PE file, view the icons, cursors and bitmaps and read the text of written resources within their coded envelopes and extract any resource in a running exe and its loaded dlls then you can do this with GoBug.<br /><br />You can also view the .rsrc section in the context of the PE file without actually running the exe or dll file using <a target="_blank" href="http://www.magma.ca/~wjr/">Wayne Radburn's PEView</a>.<br /><br />There are also dump programs available which will dump the contents of a PE file including listing the resources.  Try for example TDUMP which comes with TASM.</div>
    <div class="meta">Posted on 2002-09-16 07:35:13 by jorgon</div>
   </div>
   <div class="post" id="post-58144">
    <div class="subject"><a href="#post-58144">Help on extracting resources</a></div>
    <div class="body">Hi,<br /><br />jorgon, you got my idea wrong. I want to get the source code of files that does not load pe into the kernel just to read the resource and not programs. I do know plenty of programs that does it execpt that they do not come with source code. So now i am interested in knowing the rersource part of PE. The rest i understood.<br /><br />Thanks anyway</div>
    <div class="meta">Posted on 2002-09-16 08:59:27 by roticv</div>
   </div>
   <div class="post" id="post-58170">
    <div class="subject"><a href="#post-58170">Help on extracting resources</a></div>
    <div class="body">If you want to look at source code of resource files (.rc files) then there are hundreds of examples available in the Windows SDK (Software Development Kit).<br />You can download this from <a target="_blank" href="http://msdn.microsoft.com/">Microsoft</a> (click on download the Platform SDK and make sure you ask for the &quot;samples&quot;).   It takes a long time - make sure you are not paying by the minute for your internet connection.</div>
    <div class="meta">Posted on 2002-09-16 12:33:18 by jorgon</div>
   </div>
   <div class="post" id="post-58199">
    <div class="subject"><a href="#post-58199">Help on extracting resources</a></div>
    <div class="body">What roticv mean is He want to extract something from resource directory of PE files ie icons bitmaps dialogs etc.I have found this.</div>
    <div class="meta">Posted on 2002-09-16 17:35:39 by LaptoniC</div>
   </div>
   <div class="post" id="post-58260">
    <div class="subject"><a href="#post-58260">Help on extracting resources</a></div>
    <div class="body">LaptoniC<br /><br />No I don't think that's what roticv wants to do.<br /><br />You can extract icons, cursors, bitmaps etc. with GoBug but that's no use to him.<br /><br />I believe he is learning about resources and wants to look at some RC files.<br /><br />Maybe roticv could let us know how he is getting on.<br /><br />Jeremy</div>
    <div class="meta">Posted on 2002-09-17 02:14:35 by jorgon</div>
   </div>
   <div class="post" id="post-58289">
    <div class="subject"><a href="#post-58289">Help on extracting resources</a></div>
    <div class="body">Hi,<br /><br />Thanks, LaptoniC for your source code. I think you got my meaning correct. Sorry for my confusing posts though.</div>
    <div class="meta">Posted on 2002-09-17 07:02:08 by roticv</div>
   </div>
   <div class="post" id="post-58421">
    <div class="subject"><a href="#post-58421">Help on extracting resources</a></div>
    <div class="body">roticv:<br /><br />I wrote some routines to explain how to dump useful resources from<br />a PE file. <br /><br />To dump icons:<br /><a target="_blank" href="http://mipagina.cantv.net/numetorl869/IcoHand.zip">http://mipagina.cantv.net/numetorl869/IcoHand.zip</a><br /><br />cursors:<br /><a target="_blank" href="http://mipagina.cantv.net/numetorl869/curdmp.zip">http://mipagina.cantv.net/numetorl869/curdmp.zip</a><br /><br />and bitmaps:<br /><br /><a target="_blank" href="http://mipagina.cantv.net/numetorl869/savebmp.zip">http://mipagina.cantv.net/numetorl869/savebmp.zip</a><br /><br />Necessarily, you have to know the PE header structure, especially<br />the .rsrc section. You need too info about the structure of each resource,<br />because the compiler splits the icons and cursors in two parts: the raw data<br />(hardware dependient: ICON) and data structure (hardware independient:<br />GROUP_ICON). To bitmaps, deletes it a part of the header.<br /><br />For dialogs and menus, you need to parse the data. In this .zip I include<br />info about the resource format. I used it write some PEs at hand :) with<br />NASM, without linker: great exercise!<br /><br /><a target="_blank" href="http://mipagina.cantv.net/numetorl869/rsflat_pe.zip">http://mipagina.cantv.net/numetorl869/rsflat_pe.zip</a><br /><br />---------------------------<br /><br />Jeremy<br /><br />Your work is extraordinary. Go ahead. I'm waiting the win2k Gobug version.<br /><br />----------------------------<br /><br />[ nmt ]</div>
    <div class="meta">Posted on 2002-09-17 21:45:40 by n u M I T_o r</div>
   </div>
  </div>
 </body>
</html>