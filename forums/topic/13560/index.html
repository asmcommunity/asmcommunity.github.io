<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Exports - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=13560" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=47">Assemblers</a> &raquo; <a href="../?id=13560">Exports</a></p>
   <div class="post" id="post-105033">
    <div class="subject"><a href="#post-105033">Exports</a></div>
    <div class="body">Hello!<br /><br />How to make DLL with MASM7/8, with EXPORT by name and ordinal?<br />like: Ord: 023h, Name: SomeFunctionA<br /><br />in .DEF file its:<br /><br />EXPORTS FuncName<br /><br />Now, how to add Ordinal value to this Export?</div>
    <div class="meta">Posted on 2003-05-27 17:48:41 by Qu4rX</div>
   </div>
   <div class="post" id="post-105036">
    <div class="subject"><a href="#post-105036">Exports</a></div>
    <div class="body"><div class="quote"><em>MSDN</em><br />EXPORTS<br />definitions<br />The EXPORTS statement introduces a section of one or more definitions that are exported functions or data. Each definition must be on a separate line. The EXPORTS keyword can be on the same line as the first definition or on a preceding line. The .def file can contain one or more EXPORTS statements.<br /><br />The syntax for export definitions is:<br /><br />entryname[=internalname] [@ordinal ]  <br />entryname is the function or variable name that you want to export. This is required. If the name you export is different from the name in the DLL, specify the export's name in the DLL with internalname. For example, if your DLL exports a function, func1() and you want it to be used as func2(), you would specify:<br /><br />EXPORTS<br />func2=func1<br />@ordinal lets you specify that a number, and not the function name, will go into the DLL's export table. This can help you minimize the size of your DLL. The .LIB file will contain the mapping between the ordinal and the function, which allows you to use the function name as you normally would in projects that use the DLL.<br /><br />The optional NONAME keyword allows you to export by ordinal only and reduce the size of the export table in the resulting DLL. However, if you want to use GetProcAddress on the DLL, you must know the ordinal because the name will not be valid.<br /><br />The optional keyword PRIVATE prevents entryname from being placed in the import library generated by LINK. It has no effect on the export in the image also generated by LINK.<br /><br />The optional keyword DATA specifies that an export is data, not code. For example, you could export a data variable as follows:<br /><br />EXPORTS<br />i DATA<br />When you use PRIVATE and DATA for the same export, PRIVATE must precede DATA.<br /><br />The following is an example EXPORTS section:<br /><br />EXPORTS<br />   DllCanUnloadNow      @1     PRIVATE   DATA<br />   DllWindowName = Name        DATA<br />   DllGetClassObject    @4 NONAME   PRIVATE<br />   DllRegisterServer    @7<br />   DllUnregisterServer</div></div>
    <div class="meta">Posted on 2003-05-27 18:33:24 by donkey</div>
   </div>
  </div>
 </body>
</html>