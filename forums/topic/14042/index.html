<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Internet Connect problem - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=14042" />
     </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=8">Networking</a> &raquo; <a href="../?id=14042">Internet Connect problem</a></p>
   <div class="post" id="post-108451">
    <div class="subject"><a href="#post-108451">Internet Connect problem</a></div>
    <div class="body">Anyone know why this is failing (returning 0):<br /><br />invoke InternetConnect,addr hOpen,addr FTPAddr,INTERNET_DEFAULT_FTP_PORT,addr FTPUser,addr FTPPass,INTERNET_SERVICE_FTP,INTERNET_FLAG_PASSIVE,addr crap<br /><br />InternetOpen works, but the code above doesn't even try to connect, i think there might be something wrong with the params. (<a target="_blank" href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wininet/wininet/internetconnect.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/wininet/wininet/internetconnect.asp</a>)<br /><br />ftpaddr, pass, user are null terminated strings, hOpen is ok, crap i dunno what's used for, it's a dword.<br /><br />Thanks.</div>
    <div class="meta">Posted on 2003-06-27 13:15:48 by Ghirai</div>
   </div>
   <div class="post" id="post-108506">
    <div class="subject"><a href="#post-108506">Internet Connect problem</a></div>
    <div class="body">i don't have a documentation about this api, but i can't believe that you have to pass the address of a handle (very unusual):<br /><br /><pre><code><br />invoke InternetConnect,&#91;b&#93;addr hOpen&#91;/b&#93;,addr FTPAddr,INTERNET_DEFAULT_FTP_PORT,addr FTPUser,addr FTPPass,INTERNET_SERVICE_FTP,INTERNET_FLAG_PASSIVE,addr crap<br /></code></pre><br />try this one<br /><pre><code><br />invoke InternetConnect,&#91;b&#93;hOpen&#91;/b&#93;,addr FTPAddr,INTERNET_DEFAULT_FTP_PORT,addr FTPUser,addr FTPPass,INTERNET_SERVICE_FTP,INTERNET_FLAG_PASSIVE,addr crap<br /></code></pre></div>
    <div class="meta">Posted on 2003-06-28 01:22:26 by hartyl</div>
   </div>
   <div class="post" id="post-108672">
    <div class="subject"><a href="#post-108672">Internet Connect problem</a></div>
    <div class="body">Cool, i'll try, thanks.<br /><br />Yup, works great. How did you know?</div>
    <div class="meta">Posted on 2003-06-29 10:48:18 by Ghirai</div>
   </div>
  </div>
 </body>
</html>