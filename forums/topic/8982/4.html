<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8" />
  <title>Opcode #3 - Forums - ASM Community</title>
  <link rel="stylesheet" type="text/css" href="../../../style.css" />
  <link rel="canonical" href="../?id=8982" />
  <link rel="prev" href="../?id=8982&amp;page=3" />  <link rel="next" href="../?id=8982&amp;page=5" /> </head>
 <body>
  <div id="header">
   <h1><a href="../../../">ASM Community</a></h1>
  </div>
  <div id="content">
   <p class="breadcrumbs"><a href="../../../">Home</a> &raquo; <a href="../../">Forums</a> &raquo; <a href="../../board/?id=5">Algorithms &amp; Source Code</a> &raquo; <a href="../?id=8982">Opcode #3</a></p>
<form class="pagination" action="../" method="get"><a href="../?id=8982&amp;page=1" style="">&laquo;</a><a href="../?id=8982&amp;page=3" style="">&lt;</a><input type="hidden" name="id" value="8982" /><input type="number" name="page" min="1" max="5" step="1" value="4" onchange="this.form.submit();" /><a href="../?id=8982&amp;page=5">&gt;</a><a href="../?id=8982&amp;page=5">&raquo;</a></form>   <div class="post" id="post-67268">
    <div class="subject"><a href="#post-67268">Opcode #3</a></div>
    <div class="body">I'm toying with writing a brute-forcer in MSVC.<br /><br />It will use the Win2k/XP VectoredExceptionHandler() APIs for easy SEH.<br /><br />When the program finishes, the possible opcodes will be in some text file and you can check them out individually.   What I'm having a hard time with is the possibility of the 5 bytes of code massively crashing the computer, so I'm somewhat hesitant to write it.</div>
    <div class="meta">Posted on 2002-11-24 19:01:57 by iblis</div>
   </div>
   <div class="post" id="post-67288">
    <div class="subject"><a href="#post-67288">Opcode #3</a></div>
    <div class="body"><div class="quote"><br />n = 2<br /><br />(n+1)^2 = 9<br /><br />Sum of digits (base 3) = 1<br /><br />n(n-1)/2 = 1<br /><br />------------------------------------------<br /><br />n = 2<br /><br />(n+1)^2 = 9<br /><br />Sum of digits (base 9) = 1<br /><br />n(n-1)/2 = 1<br /><br /><br />Thank you :) </div><br />Very well.<br />If I were you I'd spell those numbers for illustration:<br />9=10(base 9)<br />3=100(base 3)<br /><br />iblis and bitRake if you have solutions to last task,please, post it.<br /><br /><br />I just wanted to check if your statemt,iblis, was true<br />I mean that people on the board are very good in solving that kind of task and the only fact along  that nobody found the answer could be enough to prove that there is no answer.<br />Now you can see, when I asked you and bitRake remane silence, nobody actually posted the answer to much easier task.<br />(I mean the same task but with one additional condition: that it is known that sign bit in eax = 1)<br />There was even more easier job - enumarate all possible short ways to set all bits in eax.<br />I'm sure on that one that there a lots of people that are capable to do it. But none even start.<br />All I wanted was that people start working with either hands or brain, otherwise tutorials are useless.<br />Who here is brave enough to enum. at least<br />5 methods to set all bits in eax <br />each of method &lt;=3 bytes in size?<br />opcode and mnemonic.</div>
    <div class="meta">Posted on 2002-11-25 00:21:55 by The Svin</div>
   </div>
   <div class="post" id="post-67292">
    <div class="subject"><a href="#post-67292">Opcode #3</a></div>
    <div class="body">Hmm...<br /><br />or eax, -1<br /><br /><br />xor eax, eax<br />dec eax<br /><br />Eh, i'm out. I'll post more later when I have some kind of assembler near me.</div>
    <div class="meta">Posted on 2002-11-25 00:53:40 by gliptic</div>
   </div>
   <div class="post" id="post-67300">
    <div class="subject"><a href="#post-67300">Opcode #3</a></div>
    <div class="body">gliptic,<br />Good for a start.<br />But, please, write opcode also.<br />It is opcode tutorials.</div>
    <div class="meta">Posted on 2002-11-25 02:08:52 by The Svin</div>
   </div>
   <div class="post" id="post-67306">
    <div class="subject"><a href="#post-67306">Opcode #3</a></div>
    <div class="body"><div class="quote"><br />I just wanted to check if your statemt,iblis, was true<br />I mean that people on the board are very good in solving that kind of task and the only fact along  that nobody found the answer could be enough to prove that there is no answer.</div><br /><br />You are misquoting me.   I never said &quot;prove&quot; - I said that it increases the likelihood that there is no answer.  Big difference.  ;)<br /><br />Edit: n/m</div>
    <div class="meta">Posted on 2002-11-25 02:52:44 by iblis</div>
   </div>
   <div class="post" id="post-67308">
    <div class="subject"><a href="#post-67308">Opcode #3</a></div>
    <div class="body">Agreed.<br />Have you got solution for the last task?</div>
    <div class="meta">Posted on 2002-11-25 03:16:11 by The Svin</div>
   </div>
   <div class="post" id="post-67310">
    <div class="subject"><a href="#post-67310">Opcode #3</a></div>
    <div class="body">If you have your values pre-set in regs, you can do it in 5 bytes :grin: <br /><pre><code><br />	mov ebx,-1<br />0040116B BB FF FF FF FF   mov         ebx,0FFFFFFFFh <br />	mov edx,0FFFFh<br />00401170 BA FF FF 00 00   mov         edx,0FFFFh <br />	<br />	mov eax,edx<br />00401175 8B C2            mov         eax,edx <br />	cmovp eax,ebx<br />00401177 0F 4A C3         cmovp       eax,ebx <br /></code></pre><br /><br />Thats about as clever as I'm gonna get.</div>
    <div class="meta">Posted on 2002-11-25 03:22:48 by ThoughtCriminal</div>
   </div>
   <div class="post" id="post-67316">
    <div class="subject"><a href="#post-67316">Opcode #3</a></div>
    <div class="body">I'm glad to see one more brave man :)<br />Wellcome to discussion.<br /><br />Well, please, read the tut carefully - you'll see that you need preset <br />values in one reg not in two.<br />assume you have value FFFFFFFFh in edx<br />then:<br />7A 01 66 8B C2<br /><br />If PF (7:short jcc A(tttn):  PF =1)<br />jmp over (01 in 7A01) one byte.<br />the byte is prefix 66 which change 32bit operands to 16bit<br />in other words<br />66 8B C2 = mov ax,dx<br />8B C2 = mov eax,edx<br />if not PF then <br />66 8B C2 executed<br />else (jmp over 66 byte will occure and:)<br />8B C2 will be executed.<br /><br />But if it is known that sign bit in eax = 1 then you can do it 5 bytes without<br />having -1 in other register.<br />and having one register (for example edx) with -1<br />you can do it it 4 bytes:<br />7A 01 66 92<br /><br />I recommend to have tttn.exe utility to get used to <br />tttn values in jcc</div>
    <div class="meta">Posted on 2002-11-25 03:53:54 by The Svin</div>
   </div>
   <div class="post" id="post-67320">
    <div class="subject"><a href="#post-67320">Opcode #3</a></div>
    <div class="body">Yes, I did not read the tut too carefully.  <br /><br />Because of 66h I had to use 2 regs.  These would go over 5 bytes:<br /><pre><code><br />	mov eax,edx<br />00401175 66 8B C2            mov         ax,dx <br />	cmovp eax,ebx<br />00401177 0F 4A C3         cmovp       eax,ebx <br /><br />or<br /><br />	mov eax,edx<br />00401175 8B C2            mov         eax,edx <br />	cmovp ax,bx<br />00401177 66 0F 4A C3      cmovp       ax,bx <br /></code></pre><br /><br />I am assuming I can setup a working state.<br /><br /><pre><code><br />	mov edx,-1<br />00401175 BA FF FF FF FF   mov         edx,0FFFFFFFFh <br />	jp $+3<br />0040117A 7A 01            jp          main+0E1h &#40;40117Dh&#41; <br />	mov ax,dx<br />0040117C 66 8B C2         mov         ax,dx <br /></code></pre><br />This will do it in 5 bytes.  4 bytes if PF=1.<br /><br /><div class="quote">But if it is known that sign bit in eax = 1 then you can do it 5 bytes without<br />having -1 in other register.<br /></div> <br /><br />Gonna have to work on that one.</div>
    <div class="meta">Posted on 2002-11-25 04:50:03 by ThoughtCriminal</div>
   </div>
   <div class="post" id="post-67324">
    <div class="subject"><a href="#post-67324">Opcode #3</a></div>
    <div class="body">I think this works for the sign bit in eax:<br /><br /><pre><code><br />	mov eax,0FFFFFFFEh<br />0040116B B8 FE FF FF FF   mov         eax,0FFFFFFFEh <br />	jp $+3<br />00401170 7A 01            jp          main+0D7h &#40;401173h&#41; <br />	inc ax<br />00401172 66 40            inc         ax   <br /></code></pre><br /><br />Only executes 3 or 4 bytes.</div>
    <div class="meta">Posted on 2002-11-25 05:17:42 by ThoughtCriminal</div>
   </div>
   <div class="post" id="post-67338">
    <div class="subject"><a href="#post-67338">Opcode #3</a></div>
    <div class="body">Your opcode is 9 bytes.<br />It's possible to do with 5.<br />It doesn't matter if opcodes executed or not,<br />the matter is size of whole opcodes written to perform the task.<br />And it work incorrectly<br />task is set all bits in eax if PF<br />else set all bits in ax (don't touch upper bits)<br />Your code works:<br />IF PF=1<br />set all bits in eax to 0<br />ELSE<br />set upper 16 bitts in eax, to 1<br />set low 16 bits to zero.<br />It is not what is requered.<br />And I don't see how you used additional condition<br />that sign bit in eax = 1<br /><br />your first instruction mov eax,-1<br />make it already impossible to preserve upper 16 bits in eax in case of PF=0<br /><br />Now about seting bits in eax:<br />I can't understand why do you use most uneffective<br />way to set bits with move:<br />read posts above - there are several ways to set all<br />bits with 3 bytes opcode not 5 bytes as in <br />mov eax,-1 method.</div>
    <div class="meta">Posted on 2002-11-25 06:48:56 by The Svin</div>
   </div>
   <div class="post" id="post-67345">
    <div class="subject"><a href="#post-67345">Opcode #3</a></div>
    <div class="body">I believe that <strong>The Svin</strong>'s math genious at the end will come with some fancy math trick that will make all fit into 5 bytes, but will be nearly unreadable for those less math-inclined than him (read: probably all of us). :)</div>
    <div class="meta">Posted on 2002-11-25 07:28:42 by Maverick</div>
   </div>
   <div class="post" id="post-67365">
    <div class="subject"><a href="#post-67365">Opcode #3</a></div>
    <div class="body"><div class="quote"><br />your first instruction mov eax,-1<br />make it already impossible to preserve upper 16 bits in eax in case of PF=0<br /></div> <br />Have to put the sign flag in eax somehow....<br /><div class="quote"><br />Now about seting bits in eax:<br />I can't understand why do you use most uneffective<br />way to set bits with move:<br />read posts above - there are several ways to set all<br />bits with 3 bytes opcode not 5 bytes as in <br />mov eax,-1 method.</div> <br />eax is not set to -1, it is set to 0FFFFFFFEh<br />THe upper 16 bits are preserved to. They remain FFFF :grin: <br /><br />It was not clear to me if the setup was included or not.  I guess you are including the setup.</div>
    <div class="meta">Posted on 2002-11-25 08:22:31 by ThoughtCriminal</div>
   </div>
   <div class="post" id="post-67373">
    <div class="subject"><a href="#post-67373">Opcode #3</a></div>
    <div class="body">If the sign-bit is set, then wouldn't SAR be able to fill eax with 1? <br />But that wouldn't work for ax, since the eax sign bit isn't the same as the ax sign bit...</div>
    <div class="meta">Posted on 2002-11-25 09:36:12 by scientica</div>
   </div>
   <div class="post" id="post-67395">
    <div class="subject"><a href="#post-67395">Opcode #3</a></div>
    <div class="body">ThoughtCriminal,<br />value in eax in unknown but &lt; 0 (anything from 80000000h to FFFFFFFFh)<br />Maverik,<br />in the last task there is nothing special about math.<br /><br />99 7A 01 66 92<br /><br />5 bytes.<br />I hate to submit it, but lately we talked more about me then about opcode.</div>
    <div class="meta">Posted on 2002-11-25 11:10:02 by The Svin</div>
   </div>
   <div class="post" id="post-67408">
    <div class="subject"><a href="#post-67408">Opcode #3</a></div>
    <div class="body">Hmmm, thats interesting.  According to the MASM32 opcodes help, there is no instruction with the opcode 92h<br /><br />According to this old TASM quick ref I have:<br /><pre><code><br />86 /r  XCHG r/m8,r8<br />86 /r  XCHG r8/r,m8<br />87 /r  XCHG r/m16,r16<br />87 /r  XCHG r16/r,m16<br />87 /r  XCHG r/m32,r32<br />87 /r  XCHG r32,r/m32<br />90+ r XCHG AX,r16<br />90+ r XCHG r16,AX<br />90+ r XCHG EAX,r32<br />90+ r XCHG r32,EAX<br /></code></pre><br />Is all the forms of XCHG.<br /><br />I going to guess the value of EDX/DX is 2, so we get 92h.  I was not aware that any opcodes contained data in the same byte.  I guess thats what that SIB thing is about.</div>
    <div class="meta">Posted on 2002-11-25 12:01:25 by ThoughtCriminal</div>
   </div>
   <div class="post" id="post-67423">
    <div class="subject"><a href="#post-67423">Opcode #3</a></div>
    <div class="body">You don't need to guess anything.<br />Read tuts starting from #1 and do all exersizes.<br />You can know opcode by two keystrikes</div>
    <div class="meta">Posted on 2002-11-25 13:56:53 by The Svin</div>
   </div>
   <div class="post" id="post-67775">
    <div class="subject"><a href="#post-67775">Opcode #3</a></div>
    <div class="body">Ok, these are my five ways to set EAX to -1 in less than 4 bytes:<br /><br /><pre><code><br />83C8FF		or eax, -1<br /><br />33C0		xor eax, eax<br />48		dec eax<br /><br />2BC0		sub eax, eax<br />48		dec eax<br /><br />F9		stc<br />1BC0		sbb eax, eax<br /><br />6AFF		push 0FF<br />58		pop eax<br /></code></pre><br /><br />I have some 4 byters laying somewhere also.</div>
    <div class="meta">Posted on 2002-11-27 09:36:57 by gliptic</div>
   </div>
   <div class="post" id="post-67821">
    <div class="subject"><a href="#post-67821">Opcode #3</a></div>
    <div class="body"><strong>gliptic</strong>, you forget :<br /><pre><code><br />and eax,0<br />dec eax<br /></code></pre><br />;)</div>
    <div class="meta">Posted on 2002-11-27 15:03:41 by Nexo</div>
   </div>
   <div class="post" id="post-67875">
    <div class="subject"><a href="#post-67875">Opcode #3</a></div>
    <div class="body">Hi, Nexo.<br />I'm glad you are in discussion.<br />But <br />    83E0 00        AND EAX,0<br />    48             DEC EAX<br />is &gt; then 3 bytes opcode</div>
    <div class="meta">Posted on 2002-11-27 23:42:11 by The Svin</div>
   </div>
<form class="pagination" action="../" method="get"><a href="../?id=8982&amp;page=1" style="">&laquo;</a><a href="../?id=8982&amp;page=3" style="">&lt;</a><input type="hidden" name="id" value="8982" /><input type="number" name="page" min="1" max="5" step="1" value="4" onchange="this.form.submit();" /><a href="../?id=8982&amp;page=5">&gt;</a><a href="../?id=8982&amp;page=5">&raquo;</a></form>  </div>
 </body>
</html>